const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-Bsl8SCUW.js","assets/vendor-DB9HQzDI.js","assets/ui-BfstmIjQ.js"])))=>i.map(i=>d[i]);
var qW=Object.defineProperty;var OI=s=>{throw TypeError(s)};var VW=(s,t,r)=>t in s?qW(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r;var dn=(s,t,r)=>VW(s,typeof t!="symbol"?t+"":t,r),Lw=(s,t,r)=>t.has(s)||OI("Cannot "+r);var xt=(s,t,r)=>(Lw(s,t,"read from private field"),r?r.call(s):t.get(s)),Ar=(s,t,r)=>t.has(s)?OI("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,r),Qs=(s,t,r,n)=>(Lw(s,t,"write to private field"),n?n.call(s,r):t.set(s,r),r),Nn=(s,t,r)=>(Lw(s,t,"access private method"),r);var qy=(s,t,r,n)=>({set _(a){Qs(s,t,a,r)},get _(){return xt(s,t,n)}});import{j as e,c as MR,u as Zx,P as Tc,R as l5,a as c5,O as Xv,C as Qv,b as WW,T as d5,D as u5,d as LR,e as Yb,f as $R,A as h5,h as m5,g as f5,i as BR,k as UR,l as HW,m as GW,n as KW,o as YW,I as JW,S as XW,L as QW,p as x5,q as zR,r as ZW,s as eH,t as tH,v as qR,w as sH,x as rH,y as VR,z as RI}from"./ui-BfstmIjQ.js";import{b as $m,r as x,a as Zv,c as ey,R as xe,d as v0,g as Ca}from"./vendor-DB9HQzDI.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var VS={},FI=$m;VS.createRoot=FI.createRoot,VS.hydrateRoot=FI.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ev(){return ev=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},ev.apply(this,arguments)}var dm;(function(s){s.Pop="POP",s.Push="PUSH",s.Replace="REPLACE"})(dm||(dm={}));const MI="popstate";function nH(s){s===void 0&&(s={});function t(n,a){let{pathname:i,search:o,hash:l}=n.location;return WS("",{pathname:i,search:o,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:Kj(a)}return iH(t,r,null,s)}function Vi(s,t){if(s===!1||s===null||typeof s>"u")throw new Error(t)}function WR(s,t){if(!s){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function aH(){return Math.random().toString(36).substr(2,8)}function LI(s,t){return{usr:s.state,key:s.key,idx:t}}function WS(s,t,r,n){return r===void 0&&(r=null),ev({pathname:typeof s=="string"?s:s.pathname,search:"",hash:""},typeof t=="string"?fg(t):t,{state:r,key:t&&t.key||n||aH()})}function Kj(s){let{pathname:t="/",search:r="",hash:n=""}=s;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function fg(s){let t={};if(s){let r=s.indexOf("#");r>=0&&(t.hash=s.substr(r),s=s.substr(0,r));let n=s.indexOf("?");n>=0&&(t.search=s.substr(n),s=s.substr(0,n)),s&&(t.pathname=s)}return t}function iH(s,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:i=!1}=n,o=a.history,l=dm.Pop,c=null,d=u();d==null&&(d=0,o.replaceState(ev({},o.state,{idx:d}),""));function u(){return(o.state||{idx:null}).idx}function h(){l=dm.Pop;let v=u(),y=v==null?null:v-d;d=v,c&&c({action:l,location:g.location,delta:y})}function f(v,y){l=dm.Push;let j=WS(g.location,v,y);d=u()+1;let b=LI(j,d),w=g.createHref(j);try{o.pushState(b,"",w)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;a.location.assign(w)}i&&c&&c({action:l,location:g.location,delta:1})}function m(v,y){l=dm.Replace;let j=WS(g.location,v,y);d=u();let b=LI(j,d),w=g.createHref(j);o.replaceState(b,"",w),i&&c&&c({action:l,location:g.location,delta:0})}function p(v){let y=a.location.origin!=="null"?a.location.origin:a.location.href,j=typeof v=="string"?v:Kj(v);return j=j.replace(/ $/,"%20"),Vi(y,"No window.location.(origin|href) available to create URL for href: "+j),new URL(j,y)}let g={get action(){return l},get location(){return s(a,o)},listen(v){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(MI,h),c=v,()=>{a.removeEventListener(MI,h),c=null}},createHref(v){return t(a,v)},createURL:p,encodeLocation(v){let y=p(v);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:f,replace:m,go(v){return o.go(v)}};return g}var $I;(function(s){s.data="data",s.deferred="deferred",s.redirect="redirect",s.error="error"})($I||($I={}));function oH(s,t,r){return r===void 0&&(r="/"),lH(s,t,r)}function lH(s,t,r,n){let a=typeof t=="string"?fg(t):t,i=p5(a.pathname||"/",r);if(i==null)return null;let o=HR(s);cH(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let d=bH(i);l=vH(o[c],d)}return l}function HR(s,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(Vi(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=jm([n,c.relativePath]),u=r.concat(c);i.children&&i.children.length>0&&(Vi(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),HR(i.children,t,u,d)),!(i.path==null&&!i.index)&&t.push({path:d,score:pH(d,i.index),routesMeta:u})};return s.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))a(i,o);else for(let c of GR(i.path))a(i,o,c)}),t}function GR(s){let t=s.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let o=GR(n.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),a&&l.push(...o),l.map(c=>s.startsWith("/")&&c===""?"/":c)}function cH(s){s.sort((t,r)=>t.score!==r.score?r.score-t.score:gH(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const dH=/^:[\w-]+$/,uH=3,hH=2,mH=1,fH=10,xH=-2,BI=s=>s==="*";function pH(s,t){let r=s.split("/"),n=r.length;return r.some(BI)&&(n+=xH),t&&(n+=hH),r.filter(a=>!BI(a)).reduce((a,i)=>a+(dH.test(i)?uH:i===""?mH:fH),n)}function gH(s,t){return s.length===t.length&&s.slice(0,-1).every((n,a)=>n===t[a])?s[s.length-1]-t[t.length-1]:0}function vH(s,t,r){let{routesMeta:n}=s,a={},i="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],d=l===n.length-1,u=i==="/"?t:t.slice(i.length)||"/",h=yH({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),f=c.route;if(!h)return null;Object.assign(a,h.params),o.push({params:a,pathname:jm([i,h.pathname]),pathnameBase:CH(jm([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=jm([i,h.pathnameBase]))}return o}function yH(s,t){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[r,n]=jH(s.path,s.caseSensitive,s.end),a=t.match(r);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((d,u,h)=>{let{paramName:f,isOptional:m}=u;if(f==="*"){let g=l[h]||"";o=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const p=l[h];return m&&!p?d[f]=void 0:d[f]=(p||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:s}}function jH(s,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),WR(s==="*"||!s.endsWith("*")||s.endsWith("/*"),'Route path "'+s+'" will be treated as if it were '+('"'+s.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+s.replace(/\*$/,"/*")+'".'));let n=[],a="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return s.endsWith("*")?(n.push({paramName:"*"}),a+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":s!==""&&s!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function bH(s){try{return s.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return WR(!1,'The URL path "'+s+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),s}}function p5(s,t){if(t==="/")return s;if(!s.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=s.charAt(r);return n&&n!=="/"?null:s.slice(r)||"/"}function NH(s,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof s=="string"?fg(s):s;return{pathname:r?r.startsWith("/")?r:wH(r,t):t,search:AH(n),hash:EH(a)}}function wH(s,t){let r=t.replace(/\/+$/,"").split("/");return s.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function $w(s,t,r,n){return"Cannot include a '"+s+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function SH(s){return s.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function g5(s,t){let r=SH(s);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function v5(s,t,r,n){n===void 0&&(n=!1);let a;typeof s=="string"?a=fg(s):(a=ev({},s),Vi(!a.pathname||!a.pathname.includes("?"),$w("?","pathname","search",a)),Vi(!a.pathname||!a.pathname.includes("#"),$w("#","pathname","hash",a)),Vi(!a.search||!a.search.includes("#"),$w("#","search","hash",a)));let i=s===""||a.pathname==="",o=i?"/":a.pathname,l;if(o==null)l=r;else{let h=t.length-1;if(!n&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;a.pathname=f.join("/")}l=h>=0?t[h]:"/"}let c=NH(a,l),d=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}const jm=s=>s.join("/").replace(/\/\/+/g,"/"),CH=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),AH=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,EH=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function IH(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}const KR=["post","put","patch","delete"];new Set(KR);const PH=["get",...KR];new Set(PH);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function tv(){return tv=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},tv.apply(this,arguments)}const y5=x.createContext(null),_H=x.createContext(null),Bm=x.createContext(null),Jb=x.createContext(null),xh=x.createContext({outlet:null,matches:[],isDataRoute:!1}),YR=x.createContext(null);function kH(s,t){let{relative:r}=t===void 0?{}:t;xg()||Vi(!1);let{basename:n,navigator:a}=x.useContext(Bm),{hash:i,pathname:o,search:l}=XR(s,{relative:r}),c=o;return n!=="/"&&(c=o==="/"?n:jm([n,o])),a.createHref({pathname:c,search:l,hash:i})}function xg(){return x.useContext(Jb)!=null}function pu(){return xg()||Vi(!1),x.useContext(Jb).location}function JR(s){x.useContext(Bm).static||x.useLayoutEffect(s)}function id(){let{isDataRoute:s}=x.useContext(xh);return s?HH():TH()}function TH(){xg()||Vi(!1);let s=x.useContext(y5),{basename:t,future:r,navigator:n}=x.useContext(Bm),{matches:a}=x.useContext(xh),{pathname:i}=pu(),o=JSON.stringify(g5(a,r.v7_relativeSplatPath)),l=x.useRef(!1);return JR(()=>{l.current=!0}),x.useCallback(function(d,u){if(u===void 0&&(u={}),!l.current)return;if(typeof d=="number"){n.go(d);return}let h=v5(d,JSON.parse(o),i,u.relative==="path");s==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:jm([t,h.pathname])),(u.replace?n.replace:n.push)(h,u.state,u)},[t,n,o,i,s])}const DH=x.createContext(null);function OH(s){let t=x.useContext(xh).outlet;return t&&x.createElement(DH.Provider,{value:s},t)}function XR(s,t){let{relative:r}=t===void 0?{}:t,{future:n}=x.useContext(Bm),{matches:a}=x.useContext(xh),{pathname:i}=pu(),o=JSON.stringify(g5(a,n.v7_relativeSplatPath));return x.useMemo(()=>v5(s,JSON.parse(o),i,r==="path"),[s,o,i,r])}function RH(s,t){return FH(s,t)}function FH(s,t,r,n){xg()||Vi(!1);let{navigator:a}=x.useContext(Bm),{matches:i}=x.useContext(xh),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d=pu(),u;if(t){var h;let v=typeof t=="string"?fg(t):t;c==="/"||(h=v.pathname)!=null&&h.startsWith(c)||Vi(!1),u=v}else u=d;let f=u.pathname||"/",m=f;if(c!=="/"){let v=c.replace(/^\//,"").split("/");m="/"+f.replace(/^\//,"").split("/").slice(v.length).join("/")}let p=oH(s,{pathname:m}),g=UH(p&&p.map(v=>Object.assign({},v,{params:Object.assign({},l,v.params),pathname:jm([c,a.encodeLocation?a.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?c:jm([c,a.encodeLocation?a.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),i,r,n);return t&&g?x.createElement(Jb.Provider,{value:{location:tv({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:dm.Pop}},g):g}function MH(){let s=WH(),t=IH(s)?s.status+" "+s.statusText:s instanceof Error?s.message:JSON.stringify(s),r=s instanceof Error?s.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return x.createElement(x.Fragment,null,x.createElement("h2",null,"Unexpected Application Error!"),x.createElement("h3",{style:{fontStyle:"italic"}},t),r?x.createElement("pre",{style:a},r):null,null)}const LH=x.createElement(MH,null);class $H extends x.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?x.createElement(xh.Provider,{value:this.props.routeContext},x.createElement(YR.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function BH(s){let{routeContext:t,match:r,children:n}=s,a=x.useContext(y5);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),x.createElement(xh.Provider,{value:t},n)}function UH(s,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),s==null){var i;if(!r)return null;if(r.errors)s=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)s=r.matches;else return null}let o=s,l=(a=r)==null?void 0:a.errors;if(l!=null){let u=o.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);u>=0||Vi(!1),o=o.slice(0,Math.min(o.length,u+1))}let c=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<o.length;u++){let h=o[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=u),h.route.id){let{loaderData:f,errors:m}=r,p=h.route.loader&&f[h.route.id]===void 0&&(!m||m[h.route.id]===void 0);if(h.route.lazy||p){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((u,h,f)=>{let m,p=!1,g=null,v=null;r&&(m=l&&h.route.id?l[h.route.id]:void 0,g=h.route.errorElement||LH,c&&(d<0&&f===0?(GH("route-fallback"),p=!0,v=null):d===f&&(p=!0,v=h.route.hydrateFallbackElement||null)));let y=t.concat(o.slice(0,f+1)),j=()=>{let b;return m?b=g:p?b=v:h.route.Component?b=x.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=u,x.createElement(BH,{match:h,routeContext:{outlet:u,matches:y,isDataRoute:r!=null},children:b})};return r&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?x.createElement($H,{location:r.location,revalidation:r.revalidation,component:g,error:m,children:j(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):j()},null)}var QR=function(s){return s.UseBlocker="useBlocker",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s}(QR||{}),ZR=function(s){return s.UseBlocker="useBlocker",s.UseLoaderData="useLoaderData",s.UseActionData="useActionData",s.UseRouteError="useRouteError",s.UseNavigation="useNavigation",s.UseRouteLoaderData="useRouteLoaderData",s.UseMatches="useMatches",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s.UseRouteId="useRouteId",s}(ZR||{});function zH(s){let t=x.useContext(y5);return t||Vi(!1),t}function qH(s){let t=x.useContext(_H);return t||Vi(!1),t}function VH(s){let t=x.useContext(xh);return t||Vi(!1),t}function eF(s){let t=VH(),r=t.matches[t.matches.length-1];return r.route.id||Vi(!1),r.route.id}function WH(){var s;let t=x.useContext(YR),r=qH(),n=eF();return t!==void 0?t:(s=r.errors)==null?void 0:s[n]}function HH(){let{router:s}=zH(QR.UseNavigateStable),t=eF(ZR.UseNavigateStable),r=x.useRef(!1);return JR(()=>{r.current=!0}),x.useCallback(function(a,i){i===void 0&&(i={}),r.current&&(typeof a=="number"?s.navigate(a):s.navigate(a,tv({fromRouteId:t},i)))},[s,t])}const UI={};function GH(s,t,r){UI[s]||(UI[s]=!0)}function KH(s,t){s==null||s.v7_startTransition,s==null||s.v7_relativeSplatPath}function zI(s){let{to:t,replace:r,state:n,relative:a}=s;xg()||Vi(!1);let{future:i,static:o}=x.useContext(Bm),{matches:l}=x.useContext(xh),{pathname:c}=pu(),d=id(),u=v5(t,g5(l,i.v7_relativeSplatPath),c,a==="path"),h=JSON.stringify(u);return x.useEffect(()=>d(JSON.parse(h),{replace:r,state:n,relative:a}),[d,h,a,r,n]),null}function YH(s){return OH(s.context)}function Qr(s){Vi(!1)}function JH(s){let{basename:t="/",children:r=null,location:n,navigationType:a=dm.Pop,navigator:i,static:o=!1,future:l}=s;xg()&&Vi(!1);let c=t.replace(/^\/*/,"/"),d=x.useMemo(()=>({basename:c,navigator:i,static:o,future:tv({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof n=="string"&&(n=fg(n));let{pathname:u="/",search:h="",hash:f="",state:m=null,key:p="default"}=n,g=x.useMemo(()=>{let v=p5(u,c);return v==null?null:{location:{pathname:v,search:h,hash:f,state:m,key:p},navigationType:a}},[c,u,h,f,m,p,a]);return g==null?null:x.createElement(Bm.Provider,{value:d},x.createElement(Jb.Provider,{children:r,value:g}))}function XH(s){let{children:t,location:r}=s;return RH(HS(t),r)}new Promise(()=>{});function HS(s,t){t===void 0&&(t=[]);let r=[];return x.Children.forEach(s,(n,a)=>{if(!x.isValidElement(n))return;let i=[...t,a];if(n.type===x.Fragment){r.push.apply(r,HS(n.props.children,i));return}n.type!==Qr&&Vi(!1),!n.props.index||!n.props.children||Vi(!1);let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=HS(n.props.children,i)),r.push(o)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function GS(){return GS=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},GS.apply(this,arguments)}function QH(s,t){if(s==null)return{};var r={},n=Object.keys(s),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=s[a]);return r}function ZH(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function eG(s,t){return s.button===0&&(!t||t==="_self")&&!ZH(s)}function KS(s){return s===void 0&&(s=""),new URLSearchParams(typeof s=="string"||Array.isArray(s)||s instanceof URLSearchParams?s:Object.keys(s).reduce((t,r)=>{let n=s[r];return t.concat(Array.isArray(n)?n.map(a=>[r,a]):[[r,n]])},[]))}function tG(s,t){let r=KS(s);return t&&t.forEach((n,a)=>{r.has(a)||t.getAll(a).forEach(i=>{r.append(a,i)})}),r}const sG=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],rG="6";try{window.__reactRouterVersion=rG}catch{}const nG="startTransition",qI=Zv[nG];function aG(s){let{basename:t,children:r,future:n,window:a}=s,i=x.useRef();i.current==null&&(i.current=nH({window:a,v5Compat:!0}));let o=i.current,[l,c]=x.useState({action:o.action,location:o.location}),{v7_startTransition:d}=n||{},u=x.useCallback(h=>{d&&qI?qI(()=>c(h)):c(h)},[c,d]);return x.useLayoutEffect(()=>o.listen(u),[o,u]),x.useEffect(()=>KH(n),[n]),x.createElement(JH,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:o,future:n})}const iG=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",oG=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,yp=x.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:i,replace:o,state:l,target:c,to:d,preventScrollReset:u,viewTransition:h}=t,f=QH(t,sG),{basename:m}=x.useContext(Bm),p,g=!1;if(typeof d=="string"&&oG.test(d)&&(p=d,iG))try{let b=new URL(window.location.href),w=d.startsWith("//")?new URL(b.protocol+d):new URL(d),N=p5(w.pathname,m);w.origin===b.origin&&N!=null?d=N+w.search+w.hash:g=!0}catch{}let v=kH(d,{relative:a}),y=lG(d,{replace:o,state:l,target:c,preventScrollReset:u,relative:a,viewTransition:h});function j(b){n&&n(b),b.defaultPrevented||y(b)}return x.createElement("a",GS({},f,{href:p||v,onClick:g||i?n:j,ref:r,target:c}))});var VI;(function(s){s.UseScrollRestoration="useScrollRestoration",s.UseSubmit="useSubmit",s.UseSubmitFetcher="useSubmitFetcher",s.UseFetcher="useFetcher",s.useViewTransitionState="useViewTransitionState"})(VI||(VI={}));var WI;(function(s){s.UseFetcher="useFetcher",s.UseFetchers="useFetchers",s.UseScrollRestoration="useScrollRestoration"})(WI||(WI={}));function lG(s,t){let{target:r,replace:n,state:a,preventScrollReset:i,relative:o,viewTransition:l}=t===void 0?{}:t,c=id(),d=pu(),u=XR(s,{relative:o});return x.useCallback(h=>{if(eG(h,r)){h.preventDefault();let f=n!==void 0?n:Kj(d)===Kj(u);c(s,{replace:f,state:a,preventScrollReset:i,relative:o,viewTransition:l})}},[d,c,u,n,a,r,s,i,o,l])}function j5(s){let t=x.useRef(KS(s)),r=x.useRef(!1),n=pu(),a=x.useMemo(()=>tG(n.search,r.current?null:t.current),[n.search]),i=id(),o=x.useCallback((l,c)=>{const d=KS(typeof l=="function"?l(a):l);r.current=!0,i("?"+d,c)},[i,a]);return[a,o]}var pg=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(s){return this.listeners.add(s),this.onSubscribe(),()=>{this.listeners.delete(s),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},cG={setTimeout:(s,t)=>setTimeout(s,t),clearTimeout:s=>clearTimeout(s),setInterval:(s,t)=>setInterval(s,t),clearInterval:s=>clearInterval(s)},em,o5,AR,dG=(AR=class{constructor(){Ar(this,em,cG);Ar(this,o5,!1)}setTimeoutProvider(s){Qs(this,em,s)}setTimeout(s,t){return xt(this,em).setTimeout(s,t)}clearTimeout(s){xt(this,em).clearTimeout(s)}setInterval(s,t){return xt(this,em).setInterval(s,t)}clearInterval(s){xt(this,em).clearInterval(s)}},em=new WeakMap,o5=new WeakMap,AR),yf=new dG;function uG(s){setTimeout(s,0)}var Gf=typeof window>"u"||"Deno"in globalThis;function El(){}function hG(s,t){return typeof s=="function"?s(t):s}function YS(s){return typeof s=="number"&&s>=0&&s!==1/0}function tF(s,t){return Math.max(s+(t||0)-Date.now(),0)}function bm(s,t){return typeof s=="function"?s(t):s}function Gc(s,t){return typeof s=="function"?s(t):s}function HI(s,t){const{type:r="all",exact:n,fetchStatus:a,predicate:i,queryKey:o,stale:l}=s;if(o){if(n){if(t.queryHash!==b5(o,t.options))return!1}else if(!sv(t.queryKey,o))return!1}if(r!=="all"){const c=t.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||a&&a!==t.state.fetchStatus||i&&!i(t))}function GI(s,t){const{exact:r,status:n,predicate:a,mutationKey:i}=s;if(i){if(!t.options.mutationKey)return!1;if(r){if(Kf(t.options.mutationKey)!==Kf(i))return!1}else if(!sv(t.options.mutationKey,i))return!1}return!(n&&t.state.status!==n||a&&!a(t))}function b5(s,t){return((t==null?void 0:t.queryKeyHashFn)||Kf)(s)}function Kf(s){return JSON.stringify(s,(t,r)=>JS(r)?Object.keys(r).sort().reduce((n,a)=>(n[a]=r[a],n),{}):r)}function sv(s,t){return s===t?!0:typeof s!=typeof t?!1:s&&t&&typeof s=="object"&&typeof t=="object"?Object.keys(t).every(r=>sv(s[r],t[r])):!1}var mG=Object.prototype.hasOwnProperty;function sF(s,t){if(s===t)return s;const r=KI(s)&&KI(t);if(!r&&!(JS(s)&&JS(t)))return t;const a=(r?s:Object.keys(s)).length,i=r?t:Object.keys(t),o=i.length,l=r?new Array(o):{};let c=0;for(let d=0;d<o;d++){const u=r?d:i[d],h=s[u],f=t[u];if(h===f){l[u]=h,(r?d<a:mG.call(s,u))&&c++;continue}if(h===null||f===null||typeof h!="object"||typeof f!="object"){l[u]=f;continue}const m=sF(h,f);l[u]=m,m===h&&c++}return a===o&&c===a?s:l}function Yj(s,t){if(!t||Object.keys(s).length!==Object.keys(t).length)return!1;for(const r in s)if(s[r]!==t[r])return!1;return!0}function KI(s){return Array.isArray(s)&&s.length===Object.keys(s).length}function JS(s){if(!YI(s))return!1;const t=s.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!YI(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(s)!==Object.prototype)}function YI(s){return Object.prototype.toString.call(s)==="[object Object]"}function fG(s){return new Promise(t=>{yf.setTimeout(t,s)})}function XS(s,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(s,t):r.structuralSharing!==!1?sF(s,t):t}function xG(s,t,r=0){const n=[...s,t];return r&&n.length>r?n.slice(1):n}function pG(s,t,r=0){const n=[t,...s];return r&&n.length>r?n.slice(0,-1):n}var N5=Symbol();function rF(s,t){return!s.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!s.queryFn||s.queryFn===N5?()=>Promise.reject(new Error(`Missing queryFn: '${s.queryHash}'`)):s.queryFn}function nF(s,t){return typeof s=="function"?s(...t):!!s}var Pf,tm,op,ER,gG=(ER=class extends pg{constructor(){super();Ar(this,Pf);Ar(this,tm);Ar(this,op);Qs(this,op,t=>{if(!Gf&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){xt(this,tm)||this.setEventListener(xt(this,op))}onUnsubscribe(){var t;this.hasListeners()||((t=xt(this,tm))==null||t.call(this),Qs(this,tm,void 0))}setEventListener(t){var r;Qs(this,op,t),(r=xt(this,tm))==null||r.call(this),Qs(this,tm,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){xt(this,Pf)!==t&&(Qs(this,Pf,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof xt(this,Pf)=="boolean"?xt(this,Pf):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Pf=new WeakMap,tm=new WeakMap,op=new WeakMap,ER),w5=new gG;function QS(){let s,t;const r=new Promise((a,i)=>{s=a,t=i});r.status="pending",r.catch(()=>{});function n(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{n({status:"fulfilled",value:a}),s(a)},r.reject=a=>{n({status:"rejected",reason:a}),t(a)},r}var vG=uG;function yG(){let s=[],t=0,r=l=>{l()},n=l=>{l()},a=vG;const i=l=>{t?s.push(l):a(()=>{r(l)})},o=()=>{const l=s;s=[],l.length&&a(()=>{n(()=>{l.forEach(c=>{r(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||o()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{a=l}}}var jo=yG(),lp,sm,cp,IR,jG=(IR=class extends pg{constructor(){super();Ar(this,lp,!0);Ar(this,sm);Ar(this,cp);Qs(this,cp,t=>{if(!Gf&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){xt(this,sm)||this.setEventListener(xt(this,cp))}onUnsubscribe(){var t;this.hasListeners()||((t=xt(this,sm))==null||t.call(this),Qs(this,sm,void 0))}setEventListener(t){var r;Qs(this,cp,t),(r=xt(this,sm))==null||r.call(this),Qs(this,sm,t(this.setOnline.bind(this)))}setOnline(t){xt(this,lp)!==t&&(Qs(this,lp,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return xt(this,lp)}},lp=new WeakMap,sm=new WeakMap,cp=new WeakMap,IR),Jj=new jG;function bG(s){return Math.min(1e3*2**s,3e4)}function aF(s){return(s??"online")==="online"?Jj.isOnline():!0}var ZS=class extends Error{constructor(s){super("CancelledError"),this.revert=s==null?void 0:s.revert,this.silent=s==null?void 0:s.silent}};function iF(s){let t=!1,r=0,n;const a=QS(),i=()=>a.status!=="pending",o=g=>{var v;if(!i()){const y=new ZS(g);f(y),(v=s.onCancel)==null||v.call(s,y)}},l=()=>{t=!0},c=()=>{t=!1},d=()=>w5.isFocused()&&(s.networkMode==="always"||Jj.isOnline())&&s.canRun(),u=()=>aF(s.networkMode)&&s.canRun(),h=g=>{i()||(n==null||n(),a.resolve(g))},f=g=>{i()||(n==null||n(),a.reject(g))},m=()=>new Promise(g=>{var v;n=y=>{(i()||d())&&g(y)},(v=s.onPause)==null||v.call(s)}).then(()=>{var g;n=void 0,i()||(g=s.onContinue)==null||g.call(s)}),p=()=>{if(i())return;let g;const v=r===0?s.initialPromise:void 0;try{g=v??s.fn()}catch(y){g=Promise.reject(y)}Promise.resolve(g).then(h).catch(y=>{var C;if(i())return;const j=s.retry??(Gf?0:3),b=s.retryDelay??bG,w=typeof b=="function"?b(r,y):b,N=j===!0||typeof j=="number"&&r<j||typeof j=="function"&&j(r,y);if(t||!N){f(y);return}r++,(C=s.onFail)==null||C.call(s,r,y),fG(w).then(()=>d()?void 0:m()).then(()=>{t?f(y):p()})})};return{promise:a,status:()=>a.status,cancel:o,continue:()=>(n==null||n(),a),cancelRetry:l,continueRetry:c,canStart:u,start:()=>(u()?p():m().then(p),a)}}var _f,PR,oF=(PR=class{constructor(){Ar(this,_f)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),YS(this.gcTime)&&Qs(this,_f,yf.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(s){this.gcTime=Math.max(this.gcTime||0,s??(Gf?1/0:5*60*1e3))}clearGcTimeout(){xt(this,_f)&&(yf.clearTimeout(xt(this,_f)),Qs(this,_f,void 0))}},_f=new WeakMap,PR),kf,dp,Wc,Tf,Oo,Gv,Df,yd,Fu,_R,NG=(_R=class extends oF{constructor(t){super();Ar(this,yd);Ar(this,kf);Ar(this,dp);Ar(this,Wc);Ar(this,Tf);Ar(this,Oo);Ar(this,Gv);Ar(this,Df);Qs(this,Df,!1),Qs(this,Gv,t.defaultOptions),this.setOptions(t.options),this.observers=[],Qs(this,Tf,t.client),Qs(this,Wc,xt(this,Tf).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Qs(this,kf,JI(this.options)),this.state=t.state??xt(this,kf),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=xt(this,Oo))==null?void 0:t.promise}setOptions(t){if(this.options={...xt(this,Gv),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=JI(this.options);r.data!==void 0&&(this.setData(r.data,{updatedAt:r.dataUpdatedAt,manual:!0}),Qs(this,kf,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&xt(this,Wc).remove(this)}setData(t,r){const n=XS(this.state.data,t,this.options);return Nn(this,yd,Fu).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){Nn(this,yd,Fu).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,a;const r=(n=xt(this,Oo))==null?void 0:n.promise;return(a=xt(this,Oo))==null||a.cancel(t),r?r.then(El).catch(El):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(xt(this,kf))}isActive(){return this.observers.some(t=>Gc(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===N5||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>bm(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!tF(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=xt(this,Oo))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=xt(this,Oo))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),xt(this,Wc).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(xt(this,Oo)&&(xt(this,Df)?xt(this,Oo).cancel({revert:!0}):xt(this,Oo).cancelRetry()),this.scheduleGc()),xt(this,Wc).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Nn(this,yd,Fu).call(this,{type:"invalidate"})}async fetch(t,r){var c,d,u,h,f,m,p,g,v,y,j,b;if(this.state.fetchStatus!=="idle"&&((c=xt(this,Oo))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(xt(this,Oo))return xt(this,Oo).continueRetry(),xt(this,Oo).promise}if(t&&this.setOptions(t),!this.options.queryFn){const w=this.observers.find(N=>N.options.queryFn);w&&this.setOptions(w.options)}const n=new AbortController,a=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(Qs(this,Df,!0),n.signal)})},i=()=>{const w=rF(this.options,r),C=(()=>{const S={client:xt(this,Tf),queryKey:this.queryKey,meta:this.meta};return a(S),S})();return Qs(this,Df,!1),this.options.persister?this.options.persister(w,C,this):w(C)},l=(()=>{const w={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:xt(this,Tf),state:this.state,fetchFn:i};return a(w),w})();(d=this.options.behavior)==null||d.onFetch(l,this),Qs(this,dp,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=l.fetchOptions)==null?void 0:u.meta))&&Nn(this,yd,Fu).call(this,{type:"fetch",meta:(h=l.fetchOptions)==null?void 0:h.meta}),Qs(this,Oo,iF({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,onCancel:w=>{w instanceof ZS&&w.revert&&this.setState({...xt(this,dp),fetchStatus:"idle"}),n.abort()},onFail:(w,N)=>{Nn(this,yd,Fu).call(this,{type:"failed",failureCount:w,error:N})},onPause:()=>{Nn(this,yd,Fu).call(this,{type:"pause"})},onContinue:()=>{Nn(this,yd,Fu).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const w=await xt(this,Oo).start();if(w===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(w),(m=(f=xt(this,Wc).config).onSuccess)==null||m.call(f,w,this),(g=(p=xt(this,Wc).config).onSettled)==null||g.call(p,w,this.state.error,this),w}catch(w){if(w instanceof ZS){if(w.silent)return xt(this,Oo).promise;if(w.revert){if(this.state.data===void 0)throw w;return this.state.data}}throw Nn(this,yd,Fu).call(this,{type:"error",error:w}),(y=(v=xt(this,Wc).config).onError)==null||y.call(v,w,this),(b=(j=xt(this,Wc).config).onSettled)==null||b.call(j,this.state.data,w,this),w}finally{this.scheduleGc()}}},kf=new WeakMap,dp=new WeakMap,Wc=new WeakMap,Tf=new WeakMap,Oo=new WeakMap,Gv=new WeakMap,Df=new WeakMap,yd=new WeakSet,Fu=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...lF(n.data,this.options),fetchMeta:t.meta??null};case"success":const a={...n,data:t.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Qs(this,dp,t.manual?a:void 0),a;case"error":const i=t.error;return{...n,error:i,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),jo.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),xt(this,Wc).notify({query:this,type:"updated",action:t})})},_R);function lF(s,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:aF(t.networkMode)?"fetching":"paused",...s===void 0&&{error:null,status:"pending"}}}function JI(s){const t=typeof s.initialData=="function"?s.initialData():s.initialData,r=t!==void 0,n=r?typeof s.initialDataUpdatedAt=="function"?s.initialDataUpdatedAt():s.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var Kl,zn,Kv,Cl,Of,up,Bu,rm,Yv,hp,mp,Rf,Ff,nm,fp,fa,y0,eC,tC,sC,rC,nC,aC,iC,cF,kR,wG=(kR=class extends pg{constructor(t,r){super();Ar(this,fa);Ar(this,Kl);Ar(this,zn);Ar(this,Kv);Ar(this,Cl);Ar(this,Of);Ar(this,up);Ar(this,Bu);Ar(this,rm);Ar(this,Yv);Ar(this,hp);Ar(this,mp);Ar(this,Rf);Ar(this,Ff);Ar(this,nm);Ar(this,fp,new Set);this.options=r,Qs(this,Kl,t),Qs(this,rm,null),Qs(this,Bu,QS()),this.bindMethods(),this.setOptions(r)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(xt(this,zn).addObserver(this),XI(xt(this,zn),this.options)?Nn(this,fa,y0).call(this):this.updateResult(),Nn(this,fa,rC).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return oC(xt(this,zn),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return oC(xt(this,zn),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Nn(this,fa,nC).call(this),Nn(this,fa,aC).call(this),xt(this,zn).removeObserver(this)}setOptions(t){const r=this.options,n=xt(this,zn);if(this.options=xt(this,Kl).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Gc(this.options.enabled,xt(this,zn))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Nn(this,fa,iC).call(this),xt(this,zn).setOptions(this.options),r._defaulted&&!Yj(this.options,r)&&xt(this,Kl).getQueryCache().notify({type:"observerOptionsUpdated",query:xt(this,zn),observer:this});const a=this.hasListeners();a&&QI(xt(this,zn),n,this.options,r)&&Nn(this,fa,y0).call(this),this.updateResult(),a&&(xt(this,zn)!==n||Gc(this.options.enabled,xt(this,zn))!==Gc(r.enabled,xt(this,zn))||bm(this.options.staleTime,xt(this,zn))!==bm(r.staleTime,xt(this,zn)))&&Nn(this,fa,eC).call(this);const i=Nn(this,fa,tC).call(this);a&&(xt(this,zn)!==n||Gc(this.options.enabled,xt(this,zn))!==Gc(r.enabled,xt(this,zn))||i!==xt(this,nm))&&Nn(this,fa,sC).call(this,i)}getOptimisticResult(t){const r=xt(this,Kl).getQueryCache().build(xt(this,Kl),t),n=this.createResult(r,t);return CG(this,n)&&(Qs(this,Cl,n),Qs(this,up,this.options),Qs(this,Of,xt(this,zn).state)),n}getCurrentResult(){return xt(this,Cl)}trackResult(t,r){return new Proxy(t,{get:(n,a)=>(this.trackProp(a),r==null||r(a),a==="promise"&&!this.options.experimental_prefetchInRender&&xt(this,Bu).status==="pending"&&xt(this,Bu).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(n,a))})}trackProp(t){xt(this,fp).add(t)}getCurrentQuery(){return xt(this,zn)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const r=xt(this,Kl).defaultQueryOptions(t),n=xt(this,Kl).getQueryCache().build(xt(this,Kl),r);return n.fetch().then(()=>this.createResult(n,r))}fetch(t){return Nn(this,fa,y0).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),xt(this,Cl)))}createResult(t,r){var k;const n=xt(this,zn),a=this.options,i=xt(this,Cl),o=xt(this,Of),l=xt(this,up),d=t!==n?t.state:xt(this,Kv),{state:u}=t;let h={...u},f=!1,m;if(r._optimisticResults){const F=this.hasListeners(),A=!F&&XI(t,r),T=F&&QI(t,n,r,a);(A||T)&&(h={...h,...lF(u.data,t.options)}),r._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:p,errorUpdatedAt:g,status:v}=h;m=h.data;let y=!1;if(r.placeholderData!==void 0&&m===void 0&&v==="pending"){let F;i!=null&&i.isPlaceholderData&&r.placeholderData===(l==null?void 0:l.placeholderData)?(F=i.data,y=!0):F=typeof r.placeholderData=="function"?r.placeholderData((k=xt(this,mp))==null?void 0:k.state.data,xt(this,mp)):r.placeholderData,F!==void 0&&(v="success",m=XS(i==null?void 0:i.data,F,r),f=!0)}if(r.select&&m!==void 0&&!y)if(i&&m===(o==null?void 0:o.data)&&r.select===xt(this,Yv))m=xt(this,hp);else try{Qs(this,Yv,r.select),m=r.select(m),m=XS(i==null?void 0:i.data,m,r),Qs(this,hp,m),Qs(this,rm,null)}catch(F){Qs(this,rm,F)}xt(this,rm)&&(p=xt(this,rm),m=xt(this,hp),g=Date.now(),v="error");const j=h.fetchStatus==="fetching",b=v==="pending",w=v==="error",N=b&&j,C=m!==void 0,_={status:v,fetchStatus:h.fetchStatus,isPending:b,isSuccess:v==="success",isError:w,isInitialLoading:N,isLoading:N,data:m,dataUpdatedAt:h.dataUpdatedAt,error:p,errorUpdatedAt:g,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>d.dataUpdateCount||h.errorUpdateCount>d.errorUpdateCount,isFetching:j,isRefetching:j&&!b,isLoadingError:w&&!C,isPaused:h.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:w&&C,isStale:S5(t,r),refetch:this.refetch,promise:xt(this,Bu),isEnabled:Gc(r.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const F=V=>{_.status==="error"?V.reject(_.error):_.data!==void 0&&V.resolve(_.data)},A=()=>{const V=Qs(this,Bu,_.promise=QS());F(V)},T=xt(this,Bu);switch(T.status){case"pending":t.queryHash===n.queryHash&&F(T);break;case"fulfilled":(_.status==="error"||_.data!==T.value)&&A();break;case"rejected":(_.status!=="error"||_.error!==T.reason)&&A();break}}return _}updateResult(){const t=xt(this,Cl),r=this.createResult(xt(this,zn),this.options);if(Qs(this,Of,xt(this,zn).state),Qs(this,up,this.options),xt(this,Of).data!==void 0&&Qs(this,mp,xt(this,zn)),Yj(r,t))return;Qs(this,Cl,r);const n=()=>{if(!t)return!0;const{notifyOnChangeProps:a}=this.options,i=typeof a=="function"?a():a;if(i==="all"||!i&&!xt(this,fp).size)return!0;const o=new Set(i??xt(this,fp));return this.options.throwOnError&&o.add("error"),Object.keys(xt(this,Cl)).some(l=>{const c=l;return xt(this,Cl)[c]!==t[c]&&o.has(c)})};Nn(this,fa,cF).call(this,{listeners:n()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Nn(this,fa,rC).call(this)}},Kl=new WeakMap,zn=new WeakMap,Kv=new WeakMap,Cl=new WeakMap,Of=new WeakMap,up=new WeakMap,Bu=new WeakMap,rm=new WeakMap,Yv=new WeakMap,hp=new WeakMap,mp=new WeakMap,Rf=new WeakMap,Ff=new WeakMap,nm=new WeakMap,fp=new WeakMap,fa=new WeakSet,y0=function(t){Nn(this,fa,iC).call(this);let r=xt(this,zn).fetch(this.options,t);return t!=null&&t.throwOnError||(r=r.catch(El)),r},eC=function(){Nn(this,fa,nC).call(this);const t=bm(this.options.staleTime,xt(this,zn));if(Gf||xt(this,Cl).isStale||!YS(t))return;const n=tF(xt(this,Cl).dataUpdatedAt,t)+1;Qs(this,Rf,yf.setTimeout(()=>{xt(this,Cl).isStale||this.updateResult()},n))},tC=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(xt(this,zn)):this.options.refetchInterval)??!1},sC=function(t){Nn(this,fa,aC).call(this),Qs(this,nm,t),!(Gf||Gc(this.options.enabled,xt(this,zn))===!1||!YS(xt(this,nm))||xt(this,nm)===0)&&Qs(this,Ff,yf.setInterval(()=>{(this.options.refetchIntervalInBackground||w5.isFocused())&&Nn(this,fa,y0).call(this)},xt(this,nm)))},rC=function(){Nn(this,fa,eC).call(this),Nn(this,fa,sC).call(this,Nn(this,fa,tC).call(this))},nC=function(){xt(this,Rf)&&(yf.clearTimeout(xt(this,Rf)),Qs(this,Rf,void 0))},aC=function(){xt(this,Ff)&&(yf.clearInterval(xt(this,Ff)),Qs(this,Ff,void 0))},iC=function(){const t=xt(this,Kl).getQueryCache().build(xt(this,Kl),this.options);if(t===xt(this,zn))return;const r=xt(this,zn);Qs(this,zn,t),Qs(this,Kv,t.state),this.hasListeners()&&(r==null||r.removeObserver(this),t.addObserver(this))},cF=function(t){jo.batch(()=>{t.listeners&&this.listeners.forEach(r=>{r(xt(this,Cl))}),xt(this,Kl).getQueryCache().notify({query:xt(this,zn),type:"observerResultsUpdated"})})},kR);function SG(s,t){return Gc(t.enabled,s)!==!1&&s.state.data===void 0&&!(s.state.status==="error"&&t.retryOnMount===!1)}function XI(s,t){return SG(s,t)||s.state.data!==void 0&&oC(s,t,t.refetchOnMount)}function oC(s,t,r){if(Gc(t.enabled,s)!==!1&&bm(t.staleTime,s)!=="static"){const n=typeof r=="function"?r(s):r;return n==="always"||n!==!1&&S5(s,t)}return!1}function QI(s,t,r,n){return(s!==t||Gc(n.enabled,s)===!1)&&(!r.suspense||s.state.status!=="error")&&S5(s,r)}function S5(s,t){return Gc(t.enabled,s)!==!1&&s.isStaleByTime(bm(t.staleTime,s))}function CG(s,t){return!Yj(s.getCurrentResult(),t)}function ZI(s){return{onFetch:(t,r)=>{var u,h,f,m,p;const n=t.options,a=(f=(h=(u=t.fetchOptions)==null?void 0:u.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((m=t.state.data)==null?void 0:m.pages)||[],o=((p=t.state.data)==null?void 0:p.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const d=async()=>{let g=!1;const v=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(t.signal.aborted?g=!0:t.signal.addEventListener("abort",()=>{g=!0}),t.signal)})},y=rF(t.options,t.fetchOptions),j=async(b,w,N)=>{if(g)return Promise.reject();if(w==null&&b.pages.length)return Promise.resolve(b);const S=(()=>{const A={client:t.client,queryKey:t.queryKey,pageParam:w,direction:N?"backward":"forward",meta:t.options.meta};return v(A),A})(),_=await y(S),{maxPages:k}=t.options,F=N?pG:xG;return{pages:F(b.pages,_,k),pageParams:F(b.pageParams,w,k)}};if(a&&i.length){const b=a==="backward",w=b?AG:e6,N={pages:i,pageParams:o},C=w(n,N);l=await j(N,C,b)}else{const b=s??i.length;do{const w=c===0?o[0]??n.initialPageParam:e6(n,l);if(c>0&&w==null)break;l=await j(l,w),c++}while(c<b)}return l};t.options.persister?t.fetchFn=()=>{var g,v;return(v=(g=t.options).persister)==null?void 0:v.call(g,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=d}}}function e6(s,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?s.getNextPageParam(t[n],t,r[n],r):void 0}function AG(s,{pages:t,pageParams:r}){var n;return t.length>0?(n=s.getPreviousPageParam)==null?void 0:n.call(s,t[0],t,r[0],r):void 0}var Jd,Al,Mf,Xd,zh,TR,EG=(TR=class extends oF{constructor(t){super();Ar(this,Xd);Ar(this,Jd);Ar(this,Al);Ar(this,Mf);this.mutationId=t.mutationId,Qs(this,Al,t.mutationCache),Qs(this,Jd,[]),this.state=t.state||dF(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){xt(this,Jd).includes(t)||(xt(this,Jd).push(t),this.clearGcTimeout(),xt(this,Al).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Qs(this,Jd,xt(this,Jd).filter(r=>r!==t)),this.scheduleGc(),xt(this,Al).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){xt(this,Jd).length||(this.state.status==="pending"?this.scheduleGc():xt(this,Al).remove(this))}continue(){var t;return((t=xt(this,Mf))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,o,l,c,d,u,h,f,m,p,g,v,y,j,b,w,N,C,S,_;const r=()=>{Nn(this,Xd,zh).call(this,{type:"continue"})};Qs(this,Mf,iF({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(k,F)=>{Nn(this,Xd,zh).call(this,{type:"failed",failureCount:k,error:F})},onPause:()=>{Nn(this,Xd,zh).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>xt(this,Al).canRun(this)}));const n=this.state.status==="pending",a=!xt(this,Mf).canStart();try{if(n)r();else{Nn(this,Xd,zh).call(this,{type:"pending",variables:t,isPaused:a}),await((o=(i=xt(this,Al).config).onMutate)==null?void 0:o.call(i,t,this));const F=await((c=(l=this.options).onMutate)==null?void 0:c.call(l,t));F!==this.state.context&&Nn(this,Xd,zh).call(this,{type:"pending",context:F,variables:t,isPaused:a})}const k=await xt(this,Mf).start();return await((u=(d=xt(this,Al).config).onSuccess)==null?void 0:u.call(d,k,t,this.state.context,this)),await((f=(h=this.options).onSuccess)==null?void 0:f.call(h,k,t,this.state.context)),await((p=(m=xt(this,Al).config).onSettled)==null?void 0:p.call(m,k,null,this.state.variables,this.state.context,this)),await((v=(g=this.options).onSettled)==null?void 0:v.call(g,k,null,t,this.state.context)),Nn(this,Xd,zh).call(this,{type:"success",data:k}),k}catch(k){try{throw await((j=(y=xt(this,Al).config).onError)==null?void 0:j.call(y,k,t,this.state.context,this)),await((w=(b=this.options).onError)==null?void 0:w.call(b,k,t,this.state.context)),await((C=(N=xt(this,Al).config).onSettled)==null?void 0:C.call(N,void 0,k,this.state.variables,this.state.context,this)),await((_=(S=this.options).onSettled)==null?void 0:_.call(S,void 0,k,t,this.state.context)),k}finally{Nn(this,Xd,zh).call(this,{type:"error",error:k})}}finally{xt(this,Al).runNext(this)}}},Jd=new WeakMap,Al=new WeakMap,Mf=new WeakMap,Xd=new WeakSet,zh=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),jo.batch(()=>{xt(this,Jd).forEach(n=>{n.onMutationUpdate(t)}),xt(this,Al).notify({mutation:this,type:"updated",action:t})})},TR);function dF(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Uu,jd,Jv,DR,IG=(DR=class extends pg{constructor(t={}){super();Ar(this,Uu);Ar(this,jd);Ar(this,Jv);this.config=t,Qs(this,Uu,new Set),Qs(this,jd,new Map),Qs(this,Jv,0)}build(t,r,n){const a=new EG({mutationCache:this,mutationId:++qy(this,Jv)._,options:t.defaultMutationOptions(r),state:n});return this.add(a),a}add(t){xt(this,Uu).add(t);const r=Vy(t);if(typeof r=="string"){const n=xt(this,jd).get(r);n?n.push(t):xt(this,jd).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(xt(this,Uu).delete(t)){const r=Vy(t);if(typeof r=="string"){const n=xt(this,jd).get(r);if(n)if(n.length>1){const a=n.indexOf(t);a!==-1&&n.splice(a,1)}else n[0]===t&&xt(this,jd).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=Vy(t);if(typeof r=="string"){const n=xt(this,jd).get(r),a=n==null?void 0:n.find(i=>i.state.status==="pending");return!a||a===t}else return!0}runNext(t){var n;const r=Vy(t);if(typeof r=="string"){const a=(n=xt(this,jd).get(r))==null?void 0:n.find(i=>i!==t&&i.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){jo.batch(()=>{xt(this,Uu).forEach(t=>{this.notify({type:"removed",mutation:t})}),xt(this,Uu).clear(),xt(this,jd).clear()})}getAll(){return Array.from(xt(this,Uu))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>GI(r,n))}findAll(t={}){return this.getAll().filter(r=>GI(t,r))}notify(t){jo.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return jo.batch(()=>Promise.all(t.map(r=>r.continue().catch(El))))}},Uu=new WeakMap,jd=new WeakMap,Jv=new WeakMap,DR);function Vy(s){var t;return(t=s.options.scope)==null?void 0:t.id}var am,im,Yl,zu,ih,Rj,lC,OR,PG=(OR=class extends pg{constructor(r,n){super();Ar(this,ih);Ar(this,am);Ar(this,im);Ar(this,Yl);Ar(this,zu);Qs(this,am,r),this.setOptions(n),this.bindMethods(),Nn(this,ih,Rj).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(r){var a;const n=this.options;this.options=xt(this,am).defaultMutationOptions(r),Yj(this.options,n)||xt(this,am).getMutationCache().notify({type:"observerOptionsUpdated",mutation:xt(this,Yl),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&Kf(n.mutationKey)!==Kf(this.options.mutationKey)?this.reset():((a=xt(this,Yl))==null?void 0:a.state.status)==="pending"&&xt(this,Yl).setOptions(this.options)}onUnsubscribe(){var r;this.hasListeners()||(r=xt(this,Yl))==null||r.removeObserver(this)}onMutationUpdate(r){Nn(this,ih,Rj).call(this),Nn(this,ih,lC).call(this,r)}getCurrentResult(){return xt(this,im)}reset(){var r;(r=xt(this,Yl))==null||r.removeObserver(this),Qs(this,Yl,void 0),Nn(this,ih,Rj).call(this),Nn(this,ih,lC).call(this)}mutate(r,n){var a;return Qs(this,zu,n),(a=xt(this,Yl))==null||a.removeObserver(this),Qs(this,Yl,xt(this,am).getMutationCache().build(xt(this,am),this.options)),xt(this,Yl).addObserver(this),xt(this,Yl).execute(r)}},am=new WeakMap,im=new WeakMap,Yl=new WeakMap,zu=new WeakMap,ih=new WeakSet,Rj=function(){var n;const r=((n=xt(this,Yl))==null?void 0:n.state)??dF();Qs(this,im,{...r,isPending:r.status==="pending",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset})},lC=function(r){jo.batch(()=>{var n,a,i,o,l,c,d,u;if(xt(this,zu)&&this.hasListeners()){const h=xt(this,im).variables,f=xt(this,im).context;(r==null?void 0:r.type)==="success"?((a=(n=xt(this,zu)).onSuccess)==null||a.call(n,r.data,h,f),(o=(i=xt(this,zu)).onSettled)==null||o.call(i,r.data,null,h,f)):(r==null?void 0:r.type)==="error"&&((c=(l=xt(this,zu)).onError)==null||c.call(l,r.error,h,f),(u=(d=xt(this,zu)).onSettled)==null||u.call(d,void 0,r.error,h,f))}this.listeners.forEach(h=>{h(xt(this,im))})})},OR),Qd,RR,_G=(RR=class extends pg{constructor(t={}){super();Ar(this,Qd);this.config=t,Qs(this,Qd,new Map)}build(t,r,n){const a=r.queryKey,i=r.queryHash??b5(a,r);let o=this.get(i);return o||(o=new NG({client:t,queryKey:a,queryHash:i,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(a)}),this.add(o)),o}add(t){xt(this,Qd).has(t.queryHash)||(xt(this,Qd).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=xt(this,Qd).get(t.queryHash);r&&(t.destroy(),r===t&&xt(this,Qd).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){jo.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return xt(this,Qd).get(t)}getAll(){return[...xt(this,Qd).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>HI(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>HI(t,n)):r}notify(t){jo.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){jo.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){jo.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Qd=new WeakMap,RR),Ai,om,lm,xp,pp,cm,gp,vp,FR,kG=(FR=class{constructor(s={}){Ar(this,Ai);Ar(this,om);Ar(this,lm);Ar(this,xp);Ar(this,pp);Ar(this,cm);Ar(this,gp);Ar(this,vp);Qs(this,Ai,s.queryCache||new _G),Qs(this,om,s.mutationCache||new IG),Qs(this,lm,s.defaultOptions||{}),Qs(this,xp,new Map),Qs(this,pp,new Map),Qs(this,cm,0)}mount(){qy(this,cm)._++,xt(this,cm)===1&&(Qs(this,gp,w5.subscribe(async s=>{s&&(await this.resumePausedMutations(),xt(this,Ai).onFocus())})),Qs(this,vp,Jj.subscribe(async s=>{s&&(await this.resumePausedMutations(),xt(this,Ai).onOnline())})))}unmount(){var s,t;qy(this,cm)._--,xt(this,cm)===0&&((s=xt(this,gp))==null||s.call(this),Qs(this,gp,void 0),(t=xt(this,vp))==null||t.call(this),Qs(this,vp,void 0))}isFetching(s){return xt(this,Ai).findAll({...s,fetchStatus:"fetching"}).length}isMutating(s){return xt(this,om).findAll({...s,status:"pending"}).length}getQueryData(s){var r;const t=this.defaultQueryOptions({queryKey:s});return(r=xt(this,Ai).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(s){const t=this.defaultQueryOptions(s),r=xt(this,Ai).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(s):(s.revalidateIfStale&&r.isStaleByTime(bm(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(s){return xt(this,Ai).findAll(s).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(s,t,r){const n=this.defaultQueryOptions({queryKey:s}),a=xt(this,Ai).get(n.queryHash),i=a==null?void 0:a.state.data,o=hG(t,i);if(o!==void 0)return xt(this,Ai).build(this,n).setData(o,{...r,manual:!0})}setQueriesData(s,t,r){return jo.batch(()=>xt(this,Ai).findAll(s).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(s){var r;const t=this.defaultQueryOptions({queryKey:s});return(r=xt(this,Ai).get(t.queryHash))==null?void 0:r.state}removeQueries(s){const t=xt(this,Ai);jo.batch(()=>{t.findAll(s).forEach(r=>{t.remove(r)})})}resetQueries(s,t){const r=xt(this,Ai);return jo.batch(()=>(r.findAll(s).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...s},t)))}cancelQueries(s,t={}){const r={revert:!0,...t},n=jo.batch(()=>xt(this,Ai).findAll(s).map(a=>a.cancel(r)));return Promise.all(n).then(El).catch(El)}invalidateQueries(s,t={}){return jo.batch(()=>(xt(this,Ai).findAll(s).forEach(r=>{r.invalidate()}),(s==null?void 0:s.refetchType)==="none"?Promise.resolve():this.refetchQueries({...s,type:(s==null?void 0:s.refetchType)??(s==null?void 0:s.type)??"active"},t)))}refetchQueries(s,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=jo.batch(()=>xt(this,Ai).findAll(s).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let i=a.fetch(void 0,r);return r.throwOnError||(i=i.catch(El)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(El)}fetchQuery(s){const t=this.defaultQueryOptions(s);t.retry===void 0&&(t.retry=!1);const r=xt(this,Ai).build(this,t);return r.isStaleByTime(bm(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(s){return this.fetchQuery(s).then(El).catch(El)}fetchInfiniteQuery(s){return s.behavior=ZI(s.pages),this.fetchQuery(s)}prefetchInfiniteQuery(s){return this.fetchInfiniteQuery(s).then(El).catch(El)}ensureInfiniteQueryData(s){return s.behavior=ZI(s.pages),this.ensureQueryData(s)}resumePausedMutations(){return Jj.isOnline()?xt(this,om).resumePausedMutations():Promise.resolve()}getQueryCache(){return xt(this,Ai)}getMutationCache(){return xt(this,om)}getDefaultOptions(){return xt(this,lm)}setDefaultOptions(s){Qs(this,lm,s)}setQueryDefaults(s,t){xt(this,xp).set(Kf(s),{queryKey:s,defaultOptions:t})}getQueryDefaults(s){const t=[...xt(this,xp).values()],r={};return t.forEach(n=>{sv(s,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(s,t){xt(this,pp).set(Kf(s),{mutationKey:s,defaultOptions:t})}getMutationDefaults(s){const t=[...xt(this,pp).values()],r={};return t.forEach(n=>{sv(s,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(s){if(s._defaulted)return s;const t={...xt(this,lm).queries,...this.getQueryDefaults(s.queryKey),...s,_defaulted:!0};return t.queryHash||(t.queryHash=b5(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===N5&&(t.enabled=!1),t}defaultMutationOptions(s){return s!=null&&s._defaulted?s:{...xt(this,lm).mutations,...(s==null?void 0:s.mutationKey)&&this.getMutationDefaults(s.mutationKey),...s,_defaulted:!0}}clear(){xt(this,Ai).clear(),xt(this,om).clear()}},Ai=new WeakMap,om=new WeakMap,lm=new WeakMap,xp=new WeakMap,pp=new WeakMap,cm=new WeakMap,gp=new WeakMap,vp=new WeakMap,FR),uF=x.createContext(void 0),hi=s=>{const t=x.useContext(uF);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},TG=({client:s,children:t})=>(x.useEffect(()=>(s.mount(),()=>{s.unmount()}),[s]),e.jsx(uF.Provider,{value:s,children:t})),hF=x.createContext(!1),DG=()=>x.useContext(hF);hF.Provider;function OG(){let s=!1;return{clearReset:()=>{s=!1},reset:()=>{s=!0},isReset:()=>s}}var RG=x.createContext(OG()),FG=()=>x.useContext(RG),MG=(s,t)=>{(s.suspense||s.throwOnError||s.experimental_prefetchInRender)&&(t.isReset()||(s.retryOnMount=!1))},LG=s=>{x.useEffect(()=>{s.clearReset()},[s])},$G=({result:s,errorResetBoundary:t,throwOnError:r,query:n,suspense:a})=>s.isError&&!t.isReset()&&!s.isFetching&&n&&(a&&s.data===void 0||nF(r,[s.error,n])),BG=s=>{if(s.suspense){const r=a=>a==="static"?a:Math.max(a??1e3,1e3),n=s.staleTime;s.staleTime=typeof n=="function"?(...a)=>r(n(...a)):r(n),typeof s.gcTime=="number"&&(s.gcTime=Math.max(s.gcTime,1e3))}},UG=(s,t)=>s.isLoading&&s.isFetching&&!t,zG=(s,t)=>(s==null?void 0:s.suspense)&&t.isPending,t6=(s,t,r)=>t.fetchOptimistic(s).catch(()=>{r.clearReset()});function qG(s,t,r){var h,f,m,p,g;const n=DG(),a=FG(),i=hi(),o=i.defaultQueryOptions(s);(f=(h=i.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||f.call(h,o),o._optimisticResults=n?"isRestoring":"optimistic",BG(o),MG(o,a),LG(a);const l=!i.getQueryCache().get(o.queryHash),[c]=x.useState(()=>new t(i,o)),d=c.getOptimisticResult(o),u=!n&&s.subscribed!==!1;if(x.useSyncExternalStore(x.useCallback(v=>{const y=u?c.subscribe(jo.batchCalls(v)):El;return c.updateResult(),y},[c,u]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),x.useEffect(()=>{c.setOptions(o)},[o,c]),zG(o,d))throw t6(o,c,a);if($G({result:d,errorResetBoundary:a,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw d.error;if((p=(m=i.getDefaultOptions().queries)==null?void 0:m._experimental_afterQuery)==null||p.call(m,o,d),o.experimental_prefetchInRender&&!Gf&&UG(d,n)){const v=l?t6(o,c,a):(g=i.getQueryCache().get(o.queryHash))==null?void 0:g.promise;v==null||v.catch(El).finally(()=>{c.updateResult()})}return o.notifyOnChangeProps?d:c.trackResult(d)}function ys(s,t){return qG(s,wG)}function Rs(s,t){const r=hi(),[n]=x.useState(()=>new PG(r,s));x.useEffect(()=>{n.setOptions(s)},[n,s]);const a=x.useSyncExternalStore(x.useCallback(o=>n.subscribe(jo.batchCalls(o)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),i=x.useCallback((o,l)=>{n.mutate(o,l).catch(El)},[n]);if(a.error&&nF(n.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:i,mutateAsync:a.mutate}}function VG({children:s}){const[t]=x.useState(()=>new kG);return e.jsx(TG,{client:t,children:s})}const mF=x.createContext({isKeyboardUser:!1,focusedElement:null,setFocusedElement:()=>{}}),fF=()=>x.useContext(mF);function WG({children:s}){const[t,r]=x.useState(!1),[n,a]=x.useState(null),[i,o]=x.useState(!1);return x.useEffect(()=>{o(!0)},[]),x.useEffect(()=>{if(!i)return;const l=d=>{if(d.key==="Tab"&&r(!0),d.ctrlKey||d.metaKey)switch(d.key){case"k":d.preventDefault();const u=document.querySelector("[data-search-input]");u&&(u.focus(),u.select());break;case"n":d.preventDefault();const h=document.querySelector("[data-quick-add]");h&&h.click();break;case"/":d.preventDefault();const f=document.querySelector("[data-sidebar-search]");f&&f.focus();break;case"e":d.preventDefault(),window.location.href="/purchases";break;case"i":d.preventDefault(),window.location.href="/sales";break;case"r":d.preventDefault(),window.location.href="/reports";break;case"a":d.preventDefault(),window.location.href="/ai-insights";break;case",":d.preventDefault(),window.location.href="/settings";break}if(d.key==="Escape"){const u=document.querySelector('[data-modal][data-state="open"]');if(u){const h=u.querySelector("[data-close]");h&&h.click()}}},c=()=>{r(!1)};return document.addEventListener("keydown",l),document.addEventListener("mousedown",c),()=>{document.removeEventListener("keydown",l),document.removeEventListener("mousedown",c)}},[i]),e.jsx(mF.Provider,{value:{isKeyboardUser:t,focusedElement:n,setFocusedElement:a},children:e.jsx("div",{className:t?"keyboard-user":"",children:s})})}const HG=()=>"https://urutiq-backend-enhanced-bco4.onrender.com",s6=HG(),qi={api:{baseUrl:s6,baseUrlWithoutApi:s6,timeout:3e4},auth:{jwtSecret:"dev-secret"},demo:{tenantId:"tenant_demo",companyId:"seed-company-1"},app:{name:"UrutiIQ",version:"1.0.0",environment:"production"}},un=(s="")=>{const t=qi.api.baseUrl.replace(/\/$/,""),r=s.replace(/^\//,"");return r?`${t}/${r}`:t},cC=()=>({"Content-Type":"application/json","x-tenant-id":Ii()}),zs=()=>{if(typeof window<"u"){const s=localStorage.getItem("company_id"),t=localStorage.getItem("companyId"),r=localStorage.getItem("company"),n=s||t||r;if(n)return n;throw new Error("Company ID not found in localStorage")}throw new Error("Company ID not available in server environment")},Ii=()=>{if(typeof window<"u"){const s=localStorage.getItem("tenant_id");if(s)return s;const t=localStorage.getItem("auth_token");if(t)try{const r=JSON.parse(Buffer.from(t.split(".")[1],"base64").toString());if(r.tenantId)return localStorage.setItem("tenant_id",r.tenantId),r.tenantId}catch{}return"tenant_demo"}throw new Error("Tenant ID not available in server environment")};class GG{constructor(){dn(this,"baseUrl");dn(this,"token");dn(this,"tenantId");dn(this,"refreshTokenValue");this.baseUrl=qi.api.baseUrl,console.log("API Service initialized with base URL:",this.baseUrl)}setAuth(t,r){this.token=t,this.tenantId=r}setRefreshToken(t){this.refreshTokenValue=t}async request(t,r={}){var u;const n=t.startsWith("/api")||t.startsWith("/journal-hub")?t:`/api${t}`,a=`${this.baseUrl}${n}`;try{if(typeof window<"u"){if(!this.token){const h=localStorage.getItem("auth_token");h&&(this.token=h)}if(!this.tenantId){const h=localStorage.getItem("tenant_id");h&&(this.tenantId=h)}if(!this.refreshTokenValue){const h=localStorage.getItem("refresh_token");h&&(this.refreshTokenValue=h)}console.log("=== API REQUEST DEBUG ==="),console.log("URL:",a),console.log("apiService.token:",this.token?"Set":"Missing"),console.log("apiService.tenantId:",this.tenantId),console.log("localStorage auth_token:",localStorage.getItem("auth_token")?"Set":"Missing"),console.log("localStorage tenant_id:",localStorage.getItem("tenant_id"))}}catch{}const i={...r.headers};r.body instanceof FormData||(i["Content-Type"]="application/json"),this.token&&(i.Authorization=`Bearer ${this.token}`),i["x-tenant-id"]=this.tenantId||Ii();try{if(typeof window<"u"){const h=localStorage.getItem("company_id")||localStorage.getItem("companyId")||localStorage.getItem("company");h&&(i["x-company-id"]=h)}}catch{}console.log("Final headers being sent:",i),n.includes("/unified-approvals/")&&console.log(" API Request Debug:",{url:n,method:r.method||"GET",headers:{"x-tenant-id":i["x-tenant-id"],Authorization:i.Authorization?"Bearer ***":"None","x-company-id":i["x-company-id"]||"None"},token:this.token?"Present":"Missing",tenantId:this.tenantId||"Using fallback"});const o=async()=>fetch(a,{...r,headers:i});let l=await o();if(l.status===401)try{if(!this.refreshTokenValue&&typeof window<"u")try{const f=localStorage.getItem("refresh_token");f&&(this.refreshTokenValue=f)}catch{}if(!this.token&&typeof window<"u")try{const f=localStorage.getItem("auth_token");f&&(this.token=f)}catch{}let h=!1;if(this.refreshTokenValue){const f=await fetch(`${this.baseUrl}/api/auth/refresh`,{method:"POST",headers:{"Content-Type":"application/json","x-tenant-id":Ii()},body:JSON.stringify({refreshToken:this.refreshTokenValue})});if(f.ok){const m=await f.json(),p=((u=m.data)==null?void 0:u.accessToken)||m.accessToken;if(p){this.token=p;try{localStorage.setItem("auth_token",p)}catch{}i.Authorization=`Bearer ${p}`,l=await o(),h=!0}}}if(!h&&l.status===401)try{const f=await fetch(`${this.baseUrl}/api/auth/demo-token`,{method:"POST",headers:{"Content-Type":"application/json","x-tenant-id":Ii()},body:JSON.stringify({sub:"demo_user",roles:["admin","accountant"]})});if(f.ok){const{token:m}=await f.json();if(m){this.token=m;try{localStorage.setItem("auth_token",m)}catch{}i.Authorization=`Bearer ${m}`,l=await o()}}}catch{}}catch{}if(!l.ok){let h=`HTTP ${l.status}`,f=null;try{const p=await l.text();if(p)try{f=JSON.parse(p),f.message?h=f.message:f.error&&typeof f.error=="string"?h=f.error:f.error&&f.error.message&&(h=f.error.message)}catch{h=p,f={raw:p}}}catch{}const m=new Error(h);throw m.status=l.status,m.response={status:l.status,data:f},m.data=f,m}const c=await l.text();let d={};if(c&&c.length>0)try{d=JSON.parse(c)}catch(h){console.error("JSON parsing error:",h),console.error("Raw text that failed to parse:",c),d=c}return d}async get(t,r={}){const n=await this.request(t,{...r,method:r.method||"GET"});return n.data??n??{}}async post(t,r,n={}){let a=r,i={...n};r instanceof FormData?a=r:r?a=JSON.stringify(r):a=n.body;const o=await this.request(t,{method:"POST",body:a,...i});return o.data??o??{}}async put(t,r,n={}){const a=await this.request(t,{method:"PUT",body:r?JSON.stringify(r):n.body,...n});return a.data??a??{}}async delete(t,r={}){const n=await this.request(t,{method:"DELETE",...r});return n.data??n??{}}async getDemoToken(t,r=["admin"]){const n=await this.request("/api/auth/demo-token",{method:"POST",body:JSON.stringify({sub:t,roles:r})});return(n.data??n)||{token:""}}async register(t){const r=await this.request("/api/auth/register",{method:"POST",body:JSON.stringify(t)});return(r.data??r)||{id:"",email:""}}async registerWithCompany(t){const r=await this.request("/api/companies",{method:"POST",body:JSON.stringify(t)});return(r.data??r)||{id:"",name:""}}async getUsers(){return(await this.request("/api/auth/users",{method:"GET"})).data||{users:[],totalCount:0}}async createUser(t){const r=await this.request("/api/auth/users",{method:"POST",body:JSON.stringify(t)});return r.data||r.data}async updateUser(t,r){const n=await this.request(`/api/auth/users/${t}`,{method:"PUT",body:JSON.stringify(r)});return n.data||n.data}async deleteUser(t){const r=await this.request(`/api/auth/users/${t}`,{method:"DELETE"});return r.data||r.data}async login(t,r){const n=await this.request("/api/auth/login",{method:"POST",body:JSON.stringify({email:t,password:r})});return(n.data??n)||{accessToken:"",refreshToken:"",tokenType:"Bearer",expiresIn:3600}}async loginMfa(t,r){var c;const n=`${this.baseUrl}/api/auth/login`,a=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json","x-tenant-id":Ii()},body:JSON.stringify({email:t,password:r})}),i=await a.text();let o={};try{o=i?JSON.parse(i):{}}catch{}if(a.status===200&&o){const d=o.data??o;return d.tokens?{ok:!0,tokens:d.tokens}:d.token&&d.user?{ok:!0,tokens:{accessToken:d.token,refreshToken:"refresh-"+Date.now(),tokenType:"Bearer",expiresIn:3600,user:d.user}}:{ok:!0,tokens:d}}if(a.status===401&&o&&(o.challengeRequired||o.challengeToken))return{ok:!1,challengeToken:(o.data??o).challengeToken};const l=o&&(((c=o.error)==null?void 0:c.message)||o.message)||`HTTP ${a.status}`;throw new Error(l)}async verifyMfaLogin(t,r){var c;const n=`${this.baseUrl}/api/auth/mfa/login/verify`,a=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json","x-tenant-id":Ii()},body:JSON.stringify({challengeToken:t,code:r})}),i=await a.text();let o={};try{o=i?JSON.parse(i):{}}catch{}if(!a.ok){const d=o&&(((c=o.error)==null?void 0:c.message)||o.message)||`HTTP ${a.status}`;throw new Error(d)}return o.data??o}async refresh(t){const r=await this.request("/api/auth/refresh",{method:"POST",body:JSON.stringify({refreshToken:t})});return(r.data??r)||{accessToken:"",tokenType:"Bearer",expiresIn:3600}}async logout(t){await this.request("/api/auth/logout",{method:"POST",body:JSON.stringify({refreshToken:t})})}async getCompanies(t){const r=new URLSearchParams;t!=null&&t.page&&r.append("page",t.page.toString()),t!=null&&t.pageSize&&r.append("pageSize",t.pageSize.toString()),t!=null&&t.country&&r.append("country",t.country),t!=null&&t.currency&&r.append("currency",t.currency),t!=null&&t.q&&r.append("q",t.q);const n=r.toString();return this.request(`/api/companies${n?`?${n}`:""}`)}async getCompany(t){return await this.request(`/api/companies/${t}`)||{id:"",name:"",createdAt:"",updatedAt:""}}async createCompany(t){const r=await this.request("/api/companies",{method:"POST",body:JSON.stringify(t)});return r.data||r.data||{id:"",name:"",createdAt:"",updatedAt:""}}async updateCompany(t,r){const n=await this.request(`/api/companies/${t}`,{method:"PUT",body:JSON.stringify(r)});return n.data||n.data||{id:"",name:"",createdAt:"",updatedAt:""}}async deleteCompany(t){await this.request(`/api/companies/${t}`,{method:"DELETE"})}async uploadCompanyLogo(t,r){const n=new FormData;n.append("logo",r);const a=await this.request(`/api/companies/${t}/logo`,{method:"POST",body:n});return console.log("Raw API response:",a),console.log("Response data:",a.data),a.data||a.data||{id:"",name:"",createdAt:"",updatedAt:""}}async getInvoices(t){const r=new URLSearchParams;return t!=null&&t.page&&r.append("page",t.page.toString()),t!=null&&t.pageSize&&r.append("pageSize",t.pageSize.toString()),t!=null&&t.companyId&&r.append("companyId",t.companyId),t!=null&&t.status&&r.append("status",t.status),t!=null&&t.q&&r.append("q",t.q),this.request(`/api/invoices?${r.toString()}`)}async createInvoice(t){return(await this.request("/api/invoices",{method:"POST",body:JSON.stringify(t)})).data||{id:"",companyId:"",customerId:"",invoiceNumber:"",issueDate:"",totalAmount:0,balanceDue:0,status:"",createdAt:"",updatedAt:""}}async postInvoice(t){return(await this.request(`/api/invoices/${t}/post`,{method:"POST"})).data||{id:"",companyId:"",customerId:"",invoiceNumber:"",issueDate:"",totalAmount:0,balanceDue:0,status:"",createdAt:"",updatedAt:""}}async updateInvoice(t,r){return(await this.request(`/api/invoices/${t}`,{method:"PUT",body:JSON.stringify(r)})).data||{id:"",companyId:"",customerId:"",invoiceNumber:"",issueDate:"",totalAmount:0,balanceDue:0,status:"",createdAt:"",updatedAt:""}}async getNextInvoiceNumber(t){const r=new URLSearchParams;t&&r.append("companyId",t);const n=await this.request(`/api/invoices/next-number?${r.toString()}`),a=(n==null?void 0:n.data)??n;return a&&a.invoiceNumber?a:{invoiceNumber:`INV-${Date.now().toString().slice(-6)}`}}async sendInvoiceEmail(t,r){var n,a;if(console.log(" API Service Debug:",{hasPdfBlob:!!r.pdfBlob,pdfBlobSize:(n=r.pdfBlob)==null?void 0:n.size,pdfBlobType:(a=r.pdfBlob)==null?void 0:a.type,attachPdf:r.attachPdf}),r.pdfBlob){console.log(" API Service: Using frontend PDF");const i=new FormData;i.append("to",r.to),r.subject&&i.append("subject",r.subject),r.message&&i.append("message",r.message),i.append("attachPdf","true"),i.append("pdf",r.pdfBlob,`invoice-${t}.pdf`),console.log(" API Service: Sending FormData with PDF"),console.log(" FormData entries:",Array.from(i.entries()));const o=await fetch(`/api/invoices/${t}/send`,{method:"POST",body:i,headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"","x-company-id":localStorage.getItem("company_id")||""}});if(!o.ok)throw new Error(`Email failed: ${o.statusText}`);return await o.json()}else{console.log(" API Service: Using backend PDF (no pdfBlob provided)");const i=await this.request(`/api/invoices/${t}/send`,{method:"POST",body:JSON.stringify(r)});return((i==null?void 0:i.data)??i)||{ok:!0}}}async processInvoicePayment(t){console.log(" processInvoicePayment called with invoiceId:",t);const r=`/api/sales-accounting/process-payment/${t}`;console.log(" Calling URL:",r);try{const n=await this.request(r,{method:"POST"});return console.log(" processInvoicePayment response:",n),n.data||{journalEntryId:"",inventoryMovements:[],success:!1}}catch(n){if(console.error(" processInvoicePayment error:",n),n.message){if(n.message.includes("Company with ID")&&n.message.includes("not found"))throw new Error("Company not found. Please ensure the company exists and is active.");if(n.message.includes("Failed to create account"))throw new Error("Account setup required. Please ensure the company has proper accounting accounts configured.");if(n.message.includes("Transaction already closed")||n.message.includes("timeout"))throw new Error("Processing timeout. The operation took too long. Please try again.");if(n.message.includes("Insufficient inventory"))throw new Error(n.message)}throw new Error(`Failed to process invoice payment: ${n.message||"Unknown error"}`)}}async getInvoiceAccountingEntries(t){return(await this.request(`/api/sales-accounting/invoice/${t}/entries`)).data||[]}async getInvoiceInventoryMovements(t){return(await this.request(`/api/sales-accounting/invoice/${t}/inventory-movements`)).data||[]}async getInvoicePdf(t){const r={"x-tenant-id":this.tenantId||Ii()};this.token&&(r.Authorization=`Bearer ${this.token}`);const n=await fetch(`${this.baseUrl}/api/invoices/${t}/pdf`,{headers:r});if(!n.ok)throw new Error("Failed to fetch PDF");return await n.blob()}async createPaymentLink(t,r){const n=await this.request(`/api/invoices/${t}/payment-link`,{method:"POST",body:JSON.stringify(r||{})}),a=(n==null?void 0:n.data)??n;return a&&a.url?a:{url:`${this.baseUrl}/pay/${t}`,expiresAt:new Date,amount:0,currency:"USD"}}async createPaymentIntent(t,r){const n=await this.request(`/api/invoices/${t}/payment-intent`,{method:"POST",body:JSON.stringify(r||{})});return(n==null?void 0:n.data)??n}async getPaymentStatus(t){const r=await this.request(`/api/invoices/${t}/payment-status`);return(r==null?void 0:r.data)??r}async createCustomerPortalSession(t,r){const n=await this.request("/api/customer-portal",{method:"POST",body:JSON.stringify({customerEmail:t,returnUrl:r})});return(n==null?void 0:n.data)??n}async getExchangeRate(t,r){try{const n={"x-tenant-id":this.tenantId||Ii()};this.token&&(n.Authorization=`Bearer ${this.token}`);const a=await fetch(`${this.baseUrl}/fx/rate?base=${encodeURIComponent(t)}&target=${encodeURIComponent(r)}`,{headers:n});if(!a.ok)throw new Error("rate_error");const i=await a.json().catch(()=>({})),o=i.data??i;if(o&&typeof o.rate=="number")return{rate:o.rate}}catch{}return{rate:1}}async getInvoiceActivity(t){return this.get(`/api/invoices/${t}/activity`)}async addInvoiceActivity(t,r){return this.post(`/api/invoices/${t}/activity`,r)}async getInvoiceAttachments(t){return this.get(`/api/invoices/${t}/attachments`)}async addInvoiceAttachment(t,r){return this.post(`/api/invoices/${t}/attachments`,r)}async getInvoicePayments(t){return this.get(`/api/invoices/${t}/payments`)}async addInvoicePayment(t,r){return this.post(`/api/invoices/${t}/payments`,r)}async getInvoiceReminders(t){return this.get(`/api/invoices/${t}/reminders`)}async sendInvoiceReminder(t,r){return this.post(`/api/invoices/${t}/reminders`,r)}async getEstimates(t){const r=new URLSearchParams;return t!=null&&t.page&&r.append("page",t.page.toString()),t!=null&&t.pageSize&&r.append("pageSize",t.pageSize.toString()),t!=null&&t.companyId&&r.append("companyId",t.companyId),t!=null&&t.status&&r.append("status",t.status),t!=null&&t.q&&r.append("q",t.q),this.request(`/api/estimates?${r.toString()}`)}async createEstimate(t){return(await this.request("/api/estimates",{method:"POST",body:JSON.stringify(t)})).data||{id:"",companyId:"",customerId:"",estimateNumber:"",issueDate:"",totalAmount:0,currency:"USD",status:"",createdAt:"",updatedAt:""}}async updateEstimate(t,r){return(await this.request(`/api/estimates/${t}`,{method:"PUT",body:JSON.stringify(r)})).data||{id:"",companyId:"",customerId:"",estimateNumber:"",issueDate:"",totalAmount:0,currency:"USD",status:"",createdAt:"",updatedAt:""}}async convertEstimateToInvoice(t){return(await this.request(`/api/estimates/${t}/convert`,{method:"POST"})).data||{id:"",companyId:"",customerId:"",invoiceNumber:"",issueDate:"",totalAmount:0,balanceDue:0,status:"",createdAt:"",updatedAt:""}}async getNextEstimateNumber(t){const r=new URLSearchParams;t&&r.append("companyId",t);const n=await this.request(`/api/estimates/next-number?${r.toString()}`),a=(n==null?void 0:n.data)??n;return a&&a.estimateNumber?a:{estimateNumber:`EST-${Date.now().toString().slice(-6)}`}}async getEstimatePdf(t){const r={"x-tenant-id":this.tenantId||Ii()};this.token&&(r.Authorization=`Bearer ${this.token}`);const n=await fetch(`${this.baseUrl}/api/estimates/${t}/pdf`,{headers:r});if(!n.ok)throw new Error("Failed to fetch PDF");return await n.blob()}async getRecurringInvoices(t){const r=new URLSearchParams;return t!=null&&t.page&&r.set("page",t.page.toString()),t!=null&&t.pageSize&&r.set("pageSize",t.pageSize.toString()),t!=null&&t.companyId&&r.set("companyId",t.companyId),t!=null&&t.status&&r.set("status",t.status),t!=null&&t.q&&r.set("q",t.q),this.get(`/api/recurring-invoices?${r.toString()}`)}async createRecurringInvoice(t){return this.post("/api/recurring-invoices",t)}async updateRecurringInvoice(t,r){return this.put(`/api/recurring-invoices/${t}`,r)}async getRecurringInvoice(t){return this.get(`/api/recurring-invoices/${t}`)}async deleteRecurringInvoice(t){return this.delete(`/api/recurring-invoices/${t}`)}async generateInvoiceFromRecurring(t,r){return this.post(`/api/recurring-invoices/${t}/generate`,{issueDate:r})}async updateRecurringInvoiceStatus(t,r){return this.put(`/api/recurring-invoices/${t}/status`,{status:r})}async getRecurringInvoiceHistory(t,r=1,n=20){return this.get(`/api/recurring-invoices/${t}/history?page=${r}&pageSize=${n}`)}async processPayment(t){return this.post("/api/accounts-payable/payments/process",t)}async getBills(t){const r=new URLSearchParams;t!=null&&t.companyId&&r.append("companyId",t.companyId),t!=null&&t.status&&r.append("status",t.status),t!=null&&t.page&&r.append("page",String(t.page)),t!=null&&t.pageSize&&r.append("pageSize",String(t.pageSize));const n=await this.get(`/api/bills${r.toString()?`?${r.toString()}`:""}`),a=(n==null?void 0:n.items)||(n==null?void 0:n.bills)||(Array.isArray(n)?n:[]),i=(n==null?void 0:n.pagination)??{page:(n==null?void 0:n.page)??1,pageSize:(n==null?void 0:n.pageSize)??a.length,total:(n==null?void 0:n.total)??a.length,totalPages:(n==null?void 0:n.totalPages)??1};return{items:(a||[]).map(l=>{var c,d;return{id:l.id,billNumber:l.billNumber||l.number||l.reference||"",vendor:{name:((c=l.vendor)==null?void 0:c.name)||l.vendorName||((d=l.supplier)==null?void 0:d.name)||"Unknown Vendor"},totalAmount:Number(l.totalAmount??l.amount??0),balanceDue:Number(l.balanceDue??l.outstandingAmount??l.totalAmount??0),status:l.status||"pending",dueDate:l.dueDate||l.paymentDueDate||l.billDate||new Date().toISOString(),invoiceDate:l.invoiceDate||l.billDate||l.createdAt||new Date().toISOString()}}),pagination:i}}async createBill(t){return this.post("/api/bills",t)}async postBill(t){return this.post(`/bills/${t}/post`)}async getCustomers(t){const r=new URLSearchParams;return t!=null&&t.page&&r.append("page",t.page.toString()),t!=null&&t.pageSize&&r.append("pageSize",t.pageSize.toString()),t!=null&&t.companyId&&r.append("companyId",t.companyId),t!=null&&t.q&&r.append("q",t.q),this.get(`/api/customers?${r.toString()}`)}async createCustomer(t){return this.post("/api/customers",t)}async getCustomer(t){return this.get(`/api/customers/${t}`)}async updateCustomer(t,r){return this.put(`/api/customers/${t}`,r)}async getCustomerContacts(t){return this.get(`/api/customers/${t}/contacts`)}async addCustomerContact(t,r){return this.post(`/api/customers/${t}/contacts`,r)}async getCustomerAddresses(t){return this.get(`/api/customers/${t}/addresses`)}async addCustomerAddress(t,r){return this.post(`/api/customers/${t}/addresses`,r)}async getCustomerActivities(t){return this.get(`/api/customers/${t}/activities`)}async addCustomerActivity(t,r){return this.post(`/api/customers/${t}/activities`,r)}async getVendors(t){const r=new URLSearchParams;return t!=null&&t.page&&r.append("page",t.page.toString()),t!=null&&t.pageSize&&r.append("pageSize",t.pageSize.toString()),t!=null&&t.companyId&&r.append("companyId",t.companyId),t!=null&&t.q&&r.append("q",t.q),this.get(`/vendors?${r.toString()}`)}async createVendor(t){return this.post("/api/vendors",t)}async getTransactions(t){const r=new URLSearchParams;return t!=null&&t.page&&r.append("page",t.page.toString()),t!=null&&t.pageSize&&r.append("pageSize",t.pageSize.toString()),t!=null&&t.companyId&&r.append("companyId",t.companyId),t!=null&&t.type&&r.append("type",t.type),t!=null&&t.status&&r.append("status",t.status),t!=null&&t.q&&r.append("q",t.q),this.get(`/transactions?${r.toString()}`)}async getAIInsights(t){const r=new URLSearchParams;return t!=null&&t.companyId&&r.append("companyId",t.companyId),t!=null&&t.category&&r.append("category",t.category),t!=null&&t.priority&&r.append("priority",t.priority),this.get(`/ai/insights?${r.toString()}`)}async generateAIInsights(t){return this.post("/ai/insights/generate",{companyId:t})}async getAIAnomalies(t){const r=new URLSearchParams;return t!=null&&t.companyId&&r.append("companyId",t.companyId),t!=null&&t.status&&r.append("status",t.status),this.get(`/ai/anomalies?${r.toString()}`)}async detectAIAnomalies(t){return this.post("/ai/anomalies/detect",{companyId:t})}async getAIRecommendations(t){const r=new URLSearchParams;return t!=null&&t.companyId&&r.append("companyId",t.companyId),t!=null&&t.status&&r.append("status",t.status),t!=null&&t.type&&r.append("type",t.type),this.get(`/ai/recommendations?${r.toString()}`)}async generateAIRecommendations(t){return this.post("/ai/recommendations/generate",{companyId:t})}async healthCheck(){return this.get("/api/health")}async listTaxRates(t){const r=new URLSearchParams;return t!=null&&t.companyId&&r.append("companyId",t.companyId),(t==null?void 0:t.isActive)!==void 0&&r.append("isActive",String(t.isActive)),t!=null&&t.taxName&&r.append("taxName",t.taxName),t!=null&&t.appliesTo&&r.append("appliesTo",t.appliesTo),t!=null&&t.page&&r.append("page",String(t.page)),t!=null&&t.limit&&r.append("limit",String(t.limit)),this.get(`/api/tax/rates?${r.toString()}`)}async createTaxRate(t){return this.post("/api/tax/rates",t)}async updateTaxRate(t,r){return this.request(`/tax/rates/${t}`,{method:"PUT",body:JSON.stringify(r)})}async deleteTaxRate(t){return this.request(`/tax/rates/${t}`,{method:"DELETE"})}async calculateTax(t){return this.post("/api/tax/calculate",t)}async previewReportBuilder(t){return this.request("/api/reports/builder/preview",{method:"POST",body:JSON.stringify(t)})}async saveReportBuilderTemplate(t){return this.request("/api/reports/builder/templates",{method:"POST",body:JSON.stringify({name:t.name,type:t.type,category:t.category??"custom",description:t.description,isPublic:t.isPublic??!1,spec:t.spec})})}async getAccounts(t,r=!1){const n=new URLSearchParams;return t&&n.append("companyId",t),r&&n.append("includeInactive","true"),await this.request(`/api/accounts?${n.toString()}`)??{accounts:[],flat:[],total:0}}async getAccountTypes(t){const r=new URLSearchParams;return t&&r.append("companyId",t),await this.request(`/api/account-types?${r.toString()}`)??[]}async getProducts(t){const r=new URLSearchParams;return t!=null&&t.companyId&&r.append("companyId",t.companyId),t!=null&&t.type&&r.append("type",t.type),await this.request(`/api/products?${r.toString()}`)??[]}async getTrialBalance(t,r){const n=new URLSearchParams;return n.append("companyId",t),r&&n.append("asOf",r),this.request(`/api/journal/trial-balance?${n.toString()}`)}async getGeneralLedger(t){const r=new URLSearchParams;return r.append("companyId",t.companyId),t.startDate&&r.append("startDate",t.startDate),t.endDate&&r.append("endDate",t.endDate),t.accountId&&r.append("accountId",t.accountId),t.accountType&&r.append("accountType",t.accountType),t.page&&r.append("page",String(t.page)),t.pageSize&&r.append("pageSize",String(t.pageSize)),this.request(`/api/journal/general-ledger?${r.toString()}`)}async listReportSchedules(t){const r=await this.request(`/reports/${t}/schedules`);return(r==null?void 0:r.data)??[]}async createReportSchedule(t,r){const n=await this.request(`/reports/${t}/schedules`,{method:"POST",body:JSON.stringify(r)});return(n==null?void 0:n.data)??n}async updateReportSchedule(t,r,n){const a=await this.request(`/reports/${t}/schedules/${r}`,{method:"PUT",body:JSON.stringify(n)});return(a==null?void 0:a.data)??a}async deleteReportSchedule(t,r){await this.request(`/reports/${t}/schedules/${r}`,{method:"DELETE"})}async listReports(t){const r=new URLSearchParams;return t!=null&&t.type&&r.append("type",t.type),(t==null?void 0:t.isTemplate)!==void 0&&r.append("isTemplate",String(t.isTemplate)),(t==null?void 0:t.isPublic)!==void 0&&r.append("isPublic",String(t.isPublic)),t!=null&&t.page&&r.append("page",String(t.page)),t!=null&&t.limit&&r.append("limit",String(t.limit)),t!=null&&t.search&&r.append("search",t.search),await this.request(`/reports?${r.toString()}`)}async createReportFromBuilder(t){const r={name:t.name,type:t.type,description:t.description,isTemplate:!1,isPublic:!1,items:t.items.map((a,i)=>({name:a.name,type:a.type,order:a.order??i,configuration:a.configuration?JSON.stringify(a.configuration):void 0,formula:a.formula,accountIds:a.accountIds&&a.accountIds.length?a.accountIds.join(","):void 0}))},n=await this.request("/api/reports",{method:"POST",body:JSON.stringify(r)});return n??n}async deliverReport(t,r){const n=await this.request(`/reports/${t}/deliver`,{method:"POST",body:JSON.stringify(r)});return n??n}async getReportItemLineage(t,r){return this.request(`/reports/${t}/items/${r}/lineage`)}async getReportItemAudit(t,r){return this.request(`/reports/${t}/items/${r}/audit`)}async createJournalEntryOld(t){return this.request("/api/journal",{method:"POST",body:JSON.stringify(t)})}async sendPaymentReminder(t,r="overdue"){const n=await this.request(`/api/invoices/${t}/send-reminder`,{method:"POST",body:JSON.stringify({type:r})});return(n==null?void 0:n.data)??n}async sendInvoiceNotification(t,r="sent"){const n=await this.request(`/api/invoices/${t}/send-notification`,{method:"POST",body:JSON.stringify({type:r})});return(n==null?void 0:n.data)??n}async sendPaymentConfirmation(t,r){const n=await this.request(`/api/invoices/${t}/send-confirmation`,{method:"POST",body:JSON.stringify({paymentData:r})});return(n==null?void 0:n.data)??n}async sendBulkReminders(t,r="overdue"){const n=await this.request("/api/invoices/send-bulk-reminders",{method:"POST",body:JSON.stringify({invoiceIds:t,type:r})});return(n==null?void 0:n.data)??n}async getNotificationTemplates(){const t=await this.request("/api/notification-templates");return(t==null?void 0:t.data)??t}async createInvoiceApprovalWorkflow(t){const r=await this.request("/api/approval-workflows",{method:"POST",body:JSON.stringify(t)});return(r==null?void 0:r.data)??r}async triggerInvoiceApproval(t,r){const n=await this.request(`/api/invoices/${t}/trigger-approval`,{method:"POST",body:JSON.stringify({workflowId:r})});return(n==null?void 0:n.data)??n}async processApprovalAction(t,r,n,a){const i=await this.request(`/approvals/${t}/action`,{method:"POST",body:JSON.stringify({action:r,comments:n,escalationReason:a})});return(i==null?void 0:i.data)??i}async getPendingApprovalsOld(){const t=await this.request("/approvals/pending");return(t==null?void 0:t.data)??t}async getInvoiceApprovalStatus(t){const r=await this.request(`/api/invoices/${t}/approval-status`);return(r==null?void 0:r.data)??r}async processInvoiceDocument(t,r,n){const a=await this.request("/invoices/process-document",{method:"POST",body:JSON.stringify({fileData:t,fileName:r,mimeType:n})});return(a==null?void 0:a.data)??a}async createInvoiceFromOCR(t){const r=await this.request("/invoices/create-from-ocr",{method:"POST",body:JSON.stringify(t)});return(r==null?void 0:r.data)??r}async matchExpensesToInvoice(t){const r=await this.request(`/invoices/${t}/match-expenses`);return(r==null?void 0:r.data)??r}async applyExpenseMatches(t,r){const n=await this.request(`/invoices/${t}/apply-expense-matches`,{method:"POST",body:JSON.stringify({matches:r})});return(n==null?void 0:n.data)??n}async parseInvoiceText(t){const r=await this.request("/invoices/parse-text",{method:"POST",body:JSON.stringify(t)});return(r==null?void 0:r.data)??r}async createInvoiceFromText(t){const r=await this.request("/invoices/create-from-text",{method:"POST",body:JSON.stringify(t)});return(r==null?void 0:r.data)??r}async getInvoiceSuggestions(t,r){const n=new URLSearchParams({companyId:t});r&&n.append("text",r);const a=await this.request(`/invoices/suggestions?${n}`);return(a==null?void 0:a.data)??a}async validateParsedData(t){const r=await this.request("/invoices/validate-parsed-data",{method:"POST",body:JSON.stringify({parsedData:t})});return(r==null?void 0:r.data)??r}async sendChatMessage(t){const r=await this.request("/ai-chat/message",{method:"POST",body:JSON.stringify(t)});return(r==null?void 0:r.data)??r}async executeChatAction(t){const r=await this.request("/ai-chat/execute-action",{method:"POST",body:JSON.stringify({action:t})});return(r==null?void 0:r.data)??r}async getChatHistory(t,r){const n=new URLSearchParams;r&&n.append("limit",r.toString());const a=await this.request(`/ai-chat/history/${t}?${n}`);return(a==null?void 0:a.data)??a}async getFinancialInsights(t){const r=await this.request(`/ai-chat/insights/${t}`);return(r==null?void 0:r.data)??r}async startChatSession(t){const r=await this.request("/ai-chat/start-session",{method:"POST",body:JSON.stringify({companyId:t})});return(r==null?void 0:r.data)??r}async getReconciliationStatus(t){const r=new URLSearchParams;return r.append("companyId",t.companyId),r.append("bankAccountId",t.bankAccountId),this.get(`/api/reconciliation/status?${r.toString()}`)}async getReconciliationCandidates(t){const r=new URLSearchParams;return r.append("companyId",t.companyId),r.append("bankAccountId",t.bankAccountId),t.startDate&&r.append("startDate",t.startDate),t.endDate&&r.append("endDate",t.endDate),this.get(`/api/reconciliation/candidates?${r.toString()}`)}async reconciliationMatch(t){return this.post("/api/reconciliation/match",t)}async reconciliationUnmatch(t){return this.post("/api/reconciliation/unmatch",t)}async getAIStats(){return this.get("/api/ai-intelligence/stats")}async searchDocuments(t,r){return this.post("/api/ai-intelligence/search",{query:t,filters:r})}async getQualityAnalysis(){return this.get("/api/ai-intelligence/quality-analysis")}async getCategorizationSuggestions(){return this.get("/api/ai-intelligence/categorization-suggestions")}async getAITags(){return this.get("/api/ai-intelligence/tags")}async getAIExtractions(){return this.get("/api/ai-intelligence/extractions")}async getAISummaries(){return this.get("/api/ai-intelligence/summaries")}async generateAISummary(t,r){return this.post("/api/ai-intelligence/summaries/generate",{type:t,documentIds:r})}async getWorkflows(){const t=await this.request("/api/workflows");return t.data||t}async getWorkflowStats(){const t=await this.request("/api/workflows/stats");return t.data||t}async getWorkflowTemplates(){const t=await this.request("/api/workflows/templates");return t.data||t.data||t}async createWorkflow(t){const r=await this.request("/api/workflows",{method:"POST",body:JSON.stringify(t)});return r.data||r.data||r}async getJournalEntryTypes(t){const r=await this.request("/journal-hub/entry-types");return(r==null?void 0:r.data)||{entryTypes:[]}}async createJournalEntryType(t){return await this.request("/journal-hub/entry-types",{method:"POST",body:JSON.stringify(t)})}async getJournalEntries(t){const r=new URLSearchParams;return Object.entries(t).forEach(([a,i])=>{i!=null&&i!==""&&r.append(a,String(i))}),await this.request(`/journal-hub/entries?${r.toString()}`)||{entries:[],pagination:{}}}async createJournalEntry(t){return await this.request("/journal-hub/entries",{method:"POST",body:JSON.stringify(t)})}async updateJournalEntry(t,r){return await this.request(`/journal-hub/entries/${t}`,{method:"PUT",body:JSON.stringify(r)})}async deleteJournalEntry(t){await this.request(`/journal-hub/entries/${t}`,{method:"DELETE"})}async postJournalEntry(t){return await this.request(`/journal-hub/entries/${t}/post`,{method:"POST"})}async getJournalTemplates(t){const r=await this.request("/journal-hub/templates");return(r==null?void 0:r.data)||{templates:[]}}async createJournalTemplate(t){return await this.request("/journal-hub/templates",{method:"POST",body:JSON.stringify(t)})}async createTemplateFromEntry(t,r){return await this.request(`/journal-hub/templates/from-entry/${t}`,{method:"POST",body:JSON.stringify(r)})}async getJournalSummary(t){const r=new URLSearchParams;return Object.entries(t).forEach(([a,i])=>{i!=null&&i!==""&&r.append(a,String(i))}),await this.request(`/journal-hub/summary?${r.toString()}`)}async getPendingApprovals(){const t=await this.request("/journal-hub/pending-approvals");return(t==null?void 0:t.data)||{pendingApprovals:[]}}async approveJournalEntry(t,r){return await this.request(`/journal-hub/approvals/${t}/approve`,{method:"POST",body:JSON.stringify(r)})}async rejectJournalEntry(t,r){return await this.request(`/journal-hub/approvals/${t}/reject`,{method:"POST",body:JSON.stringify(r)})}async getRecurringEntries(t){const r=await this.request("/journal-hub/recurring");return(r==null?void 0:r.data)||{recurringEntries:[]}}async processRecurringEntries(t){return await this.request("/journal-hub/recurring/process",{method:"POST",body:JSON.stringify(t)})}async getJournalEntryAudit(t){const r=await this.request(`/journal-hub/entries/${t}/audit`);return(r==null?void 0:r.data)||{auditTrail:[]}}async reverseJournalEntry(t,r){return await this.request(`/journal-hub/entries/${t}/reverse`,{method:"POST",body:JSON.stringify(r)})}async adjustJournalEntry(t,r){return await this.request(`/journal-hub/entries/${t}/adjust`,{method:"POST",body:JSON.stringify(r)})}async requestJournalApproval(t,r){return await this.request(`/journal-hub/entries/${t}/request-approval`,{method:"POST",body:JSON.stringify(r)})}async getJournalPermissions(t,r){const n=new URLSearchParams;r&&n.append("companyId",r);const a=await this.request(`/journal-hub/permissions/${t}?${n.toString()}`);return(a==null?void 0:a.data)||{permissions:{}}}async getJournalMetrics(t){const r=new URLSearchParams;t.companyId&&r.append("companyId",t.companyId),t.startDate&&r.append("startDate",t.startDate),t.endDate&&r.append("endDate",t.endDate);const n=await this.request(`/journal-hub/metrics?${r.toString()}`);return(n==null?void 0:n.data)||{metrics:{}}}async batchCreateJournalEntries(t){const r=await this.request("/journal-hub/entries/batch",{method:"POST",body:JSON.stringify(t)});return(r==null?void 0:r.data)||{success:!1,message:"Unknown error",data:null}}async batchApproveJournalEntries(t){const r=await this.request("/journal-hub/entries/batch/approve",{method:"POST",body:JSON.stringify(t)});return(r==null?void 0:r.data)||{success:!1,message:"Unknown error",data:null}}async batchPostJournalEntries(t){const r=await this.request("/journal-hub/entries/batch/post",{method:"POST",body:JSON.stringify(t)});return(r==null?void 0:r.data)||{success:!1,message:"Unknown error",data:null}}async batchReverseJournalEntries(t){const r=await this.request("/journal-hub/entries/batch/reverse",{method:"POST",body:JSON.stringify(t)});return(r==null?void 0:r.data)||{success:!1,message:"Unknown error",data:null}}async getBatchProcessingStatus(t){const r=await this.request(`/journal-hub/entries/batch/status/${t}`);return(r==null?void 0:r.data)||{batchId:t,status:"unknown",message:"Status not found"}}async exportJournalEntriesCsv(t){const r=new URLSearchParams;t.companyId&&r.append("companyId",t.companyId),t.dateFrom&&r.append("dateFrom",t.dateFrom),t.dateTo&&r.append("dateTo",t.dateTo),t.status&&r.append("status",t.status),t.entryType&&r.append("entryType",t.entryType),t.format&&r.append("format",t.format);const n=await fetch(`${this.baseUrl}/journal-hub/entries/export/csv?${r.toString()}`,{headers:{Authorization:`Bearer ${this.token}`,"Content-Type":"application/json"}});if(!n.ok)throw new Error("Failed to export CSV");return n.blob()}async exportJournalEntriesExcel(t){const r=new URLSearchParams;t.companyId&&r.append("companyId",t.companyId),t.dateFrom&&r.append("dateFrom",t.dateFrom),t.dateTo&&r.append("dateTo",t.dateTo),t.status&&r.append("status",t.status),t.entryType&&r.append("entryType",t.entryType),t.format&&r.append("format",t.format);const n=await fetch(`${this.baseUrl}/journal-hub/entries/export/excel?${r.toString()}`,{headers:{Authorization:`Bearer ${this.token}`,"Content-Type":"application/json"}});if(!n.ok)throw new Error("Failed to export Excel");return n.blob()}async importJournalEntriesCsv(t){const r=await this.request("/journal-hub/entries/import/csv",{method:"POST",body:JSON.stringify(t)});return(r==null?void 0:r.data)||{success:!1,message:"Unknown error",data:null}}async downloadImportTemplate(t="csv"){const r=await fetch(`${this.baseUrl}/journal-hub/entries/import/template?format=${t}`,{headers:{Authorization:`Bearer ${this.token}`,"Content-Type":"application/json"}});if(!r.ok)throw new Error("Failed to download template");return r.blob()}async searchJournalEntriesAdvanced(t){const r=new URLSearchParams;Object.entries(t).forEach(([a,i])=>{i!=null&&i!==""&&r.append(a,i.toString())});const n=await this.request(`/journal-hub/entries/search/advanced?${r.toString()}`);return(n==null?void 0:n.data)||{success:!1,data:null}}async saveJournalSearch(t){const r=await this.request("/journal-hub/search/save",{method:"POST",body:JSON.stringify(t)});return(r==null?void 0:r.data)||{success:!1,message:"Unknown error",data:null}}async getSavedJournalSearches(t=!0){const r=await this.request(`/journal-hub/search/saved?includePublic=${t}`);return(r==null?void 0:r.data)||{success:!1,data:[]}}async updateJournalSearch(t,r){const n=await this.request(`/journal-hub/search/saved/${t}`,{method:"PUT",body:JSON.stringify(r)});return(n==null?void 0:n.data)||{success:!1,message:"Unknown error",data:null}}async deleteJournalSearch(t){const r=await this.request(`/journal-hub/search/saved/${t}`,{method:"DELETE"});return(r==null?void 0:r.data)||{success:!1,message:"Unknown error"}}async getJournalSearchSuggestions(t,r){const n=await this.request(`/journal-hub/search/suggestions?field=${t}&query=${encodeURIComponent(r)}`);return(n==null?void 0:n.data)||{success:!1,data:[]}}async generateJournalEntryPDF(t,r){const n=new URLSearchParams;(r==null?void 0:r.includeAuditTrail)!==void 0&&n.append("includeAuditTrail",r.includeAuditTrail.toString()),(r==null?void 0:r.includeCompanyHeader)!==void 0&&n.append("includeCompanyHeader",r.includeCompanyHeader.toString()),r!=null&&r.format&&n.append("format",r.format);const a={"Content-Type":"application/json"};try{const o=Ii(),l=this.token||(typeof window<"u"?localStorage.getItem("auth_token"):""),c=(typeof window<"u"?localStorage.getItem("company_id")||localStorage.getItem("companyId")||localStorage.getItem("company"):"")||"";o&&(a["x-tenant-id"]=o),l&&(a.Authorization=`Bearer ${l}`),c&&(a["x-company-id"]=c)}catch{}const i=await fetch(`${this.baseUrl}/journal-hub/entries/${t}/pdf?${n.toString()}`,{headers:a});if(!i.ok)throw new Error("Failed to generate PDF");return i.blob()}async generateBatchJournalEntryPDF(t,r){const n=await this.request("/journal-hub/entries/pdf/batch",{method:"POST",body:JSON.stringify({entryIds:t,includeAuditTrail:(r==null?void 0:r.includeAuditTrail)??!0,includeCompanyHeader:(r==null?void 0:r.includeCompanyHeader)??!0,format:(r==null?void 0:r.format)??"detailed"})});if(!(n!=null&&n.success))throw new Error((n==null?void 0:n.message)||"Failed to generate batch PDF");return new Blob(["Mock PDF content"],{type:"application/pdf"})}async getJournalEntryPreview(t,r){const n=new URLSearchParams;(r==null?void 0:r.includeAuditTrail)!==void 0&&n.append("includeAuditTrail",r.includeAuditTrail.toString()),(r==null?void 0:r.includeCompanyHeader)!==void 0&&n.append("includeCompanyHeader",r.includeCompanyHeader.toString()),r!=null&&r.format&&n.append("format",r.format);const a=await fetch(`${this.baseUrl}/journal-hub/entries/${t}/preview?${n.toString()}`,{headers:{Authorization:`Bearer ${this.token}`,"Content-Type":"application/json"}});if(!a.ok)throw new Error("Failed to generate preview");return a.text()}async getSupplierProfile(t){return await this.request(`/api/supplier-portal/profile/${t}`)}async updateSupplierProfile(t,r){return await this.request(`/api/supplier-portal/profile/${t}`,{method:"PUT",body:JSON.stringify(r)})}async getSupplierStats(t){return await this.request(`/api/supplier-portal/stats/${t}`)}async getSupplierInvoices(t,r){var i;const n=new URLSearchParams;r!=null&&r.status&&n.append("status",r.status),r!=null&&r.dateFrom&&n.append("dateFrom",r.dateFrom),r!=null&&r.dateTo&&n.append("dateTo",r.dateTo),r!=null&&r.page&&n.append("page",r.page.toString()),r!=null&&r.pageSize&&n.append("pageSize",r.pageSize.toString());const a=await this.request(`/api/supplier-portal/invoices/${t}?${n.toString()}`);return((i=a==null?void 0:a.data)==null?void 0:i.invoices)||(a==null?void 0:a.invoices)||[]}async getSupplierPayments(t,r){var i;const n=new URLSearchParams;r!=null&&r.status&&n.append("status",r.status),r!=null&&r.dateFrom&&n.append("dateFrom",r.dateFrom),r!=null&&r.dateTo&&n.append("dateTo",r.dateTo),r!=null&&r.page&&n.append("page",r.page.toString()),r!=null&&r.pageSize&&n.append("pageSize",r.pageSize.toString());const a=await this.request(`/api/supplier-portal/payments/${t}?${n.toString()}`);return((i=a==null?void 0:a.data)==null?void 0:i.payments)||(a==null?void 0:a.payments)||[]}async downloadInvoicePDF(t,r){const n=await fetch(`${this.baseUrl}/api/supplier-portal/invoices/${t}/${r}/pdf`,{headers:{Authorization:`Bearer ${this.token}`,"x-tenant-id":Ii()}});if(!n.ok)throw new Error("Failed to download invoice PDF");return n.blob()}async getInvoiceDetails(t,r){return await this.request(`/api/supplier-portal/invoices/${t}/${r}`)}async getPaymentDetails(t,r){return await this.request(`/api/supplier-portal/payments/${t}/${r}`)}async updateSupplierSettings(t,r){return await this.request(`/api/supplier-portal/settings/${t}`,{method:"PUT",body:JSON.stringify(r)})}async getSupplierNotifications(t){var n;const r=await this.request(`/api/supplier-portal/notifications/${t}`);return((n=r==null?void 0:r.data)==null?void 0:n.notifications)||(r==null?void 0:r.notifications)||[]}async markNotificationAsRead(t,r){return await this.request(`/api/supplier-portal/notifications/${t}/${r}/read`,{method:"PUT"})}}const de=new GG;function KG(s){const t=s.replace(/-/g,"+").replace(/_/g,"/"),r=t.padEnd(t.length+(4-t.length%4)%4,"=");return typeof window>"u"?Buffer.from(r,"base64").toString("utf-8"):atob(r)}function lf(s){try{const[,t]=s.split(".");return JSON.parse(KG(t))}catch{return null}}function YG(s,t=5){const r=lf(s);if(!(r!=null&&r.exp))return!0;const n=Date.now()/1e3;return r.exp-n<t*60}const xF=x.createContext(void 0);function JG({children:s}){const[t,r]=x.useState(null),[n,a]=x.useState(!0),[i,o]=x.useState(!1),[l,c]=x.useState(!1),d=hi(),u=id();x.useEffect(()=>{l&&console.log(" AuthProvider: Component mounted and ready")},[l]);const h=async S=>{try{const _=localStorage.getItem("company_id")||localStorage.getItem("companyId")||localStorage.getItem("company");await new Promise(T=>setTimeout(T,200));const k=await de.getCompanies({page:1,pageSize:1}),F=(k==null?void 0:k.data)||k||[],A=Array.isArray(F)?F[0]:void 0;if(A!=null&&A.id){const T=_===qi.demo.companyId;(!_||F.length===1||_!==A.id||T)&&(localStorage.setItem("company_id",A.id),A.name&&localStorage.setItem("company_name",A.name))}}catch(_){console.log("Failed to fetch companies for company ID setup:",_)}},f=async()=>{var k;if(typeof window>"u"||i)return!1;const S=localStorage.getItem("refresh_token"),_=localStorage.getItem("tenant_id");if(!S||!_)return!1;o(!0);try{const{accessToken:F}=await de.refresh(S),A=lf(F);if(!A)throw new Error("Invalid JWT received on refresh");localStorage.setItem("auth_token",F),localStorage.setItem("tenant_id",A.tenantId),de.setAuth(F,A.tenantId),de.setRefreshToken(S),await h(A);const T=localStorage.getItem("company_name")||"My Company";return r({id:A.sub,email:A.sub,firstName:"User",lastName:"",companyName:T,role:((k=A.roles)==null?void 0:k[0])||"employee",isEmailVerified:!0,createdAt:new Date().toISOString(),tenantId:A.tenantId}),console.log("Tokens refreshed successfully"),!0}catch(F){return console.error("Token refresh failed",F),!1}finally{o(!1)}},m=async()=>{if(typeof window>"u")return!1;const S=localStorage.getItem("auth_token");return S?YG(S)?(console.log("Token expired, refreshing before API call"),await f()):!0:!1},p=async()=>{console.log("Handling authentication error, attempting token refresh");const S=await f();return S||(console.log("Token refresh failed, logging out user"),await w()),S},g=async()=>{var S;if(console.log(" checkAuthStatus called"),typeof window>"u"){console.log(" checkAuthStatus: SSR, setting loading false"),a(!1);return}try{const _=localStorage.getItem("auth_token"),k=localStorage.getItem("tenant_id");if(console.log(" checkAuthStatus: token present:",!!_,"tenantId present:",!!k),!_||!k){console.log(" checkAuthStatus: no token or tenantId, logging out"),await w();return}const F=lf(_);if(!F){await w();return}const A=Date.now()/1e3,T=F.exp&&F.exp-A<300;if(F.exp&&(A>=F.exp||T)){console.warn("Access token expired or expiring soon, attempting refresh"),await f()||(console.warn("Token refresh failed, logging out"),await w());return}de.setAuth(_,k);try{const V=localStorage.getItem("refresh_token");V&&de.setRefreshToken(V)}catch{}await new Promise(V=>setTimeout(V,100)),await h(F),r({id:F.sub,email:F.sub,firstName:"User",lastName:"",companyName:localStorage.getItem("company_name")||"My Company",role:((S=F.roles)==null?void 0:S[0])||"employee",isEmailVerified:!0,createdAt:new Date().toISOString(),tenantId:k})}catch(_){console.error("Auth check failed",_),await w()}finally{console.log(" checkAuthStatus: setting isLoading to false"),a(!1)}},v=async(S,_)=>{var k,F,A,T;a(!0);try{try{typeof window<"u"&&localStorage.removeItem("disable_demo_auth")}catch{}console.log(" Login attempt for:",S),console.log(" Making API call to login endpoint...");const V=await de.loginMfa(S,_);if(!V.ok){const Q=typeof window<"u"?window.prompt("Enter your MFA code or a backup code:"):"";if(!Q)throw new Error("MFA code is required");const P=await de.verifyMfaLogin(V.challengeToken,Q),q=lf(P.accessToken);if(!q)throw new Error("Invalid JWT received");const D=q.tenantId||"tenant_default";try{localStorage.setItem("auth_token",P.accessToken)}catch{}try{P.refreshToken&&localStorage.setItem("refresh_token",P.refreshToken)}catch{}try{localStorage.setItem("tenant_id",D)}catch{}de.setAuth(P.accessToken,D),P.refreshToken&&de.setRefreshToken(P.refreshToken),await h(q),r({id:q.sub,email:S,firstName:"User",lastName:"",companyName:localStorage.getItem("company_name")||"My Company",role:((k=q.roles)==null?void 0:k[0])||"employee",isEmailVerified:!0,createdAt:new Date().toISOString(),tenantId:D});return}const M=V.tokens;console.log(" Login API call successful, raw response:",M);const G=M.accessToken??M.access_token??M.token??((F=M.data)==null?void 0:F.accessToken),L=M.refreshToken??M.refresh_token??((A=M.data)==null?void 0:A.refreshToken)??M.refreshToken;if(console.log(" Access token received:",!!G),console.log(" Refresh token received:",!!L),!G||typeof G!="string")throw console.error("Login response missing access token or token is not a string",M),new Error("Invalid JWT received");if(!G.includes(".")||G.split(".").length!==3)throw console.error("Access token does not look like a JWT (missing dot separators)",G),new Error("Invalid JWT received");const J=lf(G);if(!J)throw console.error("Failed to parse JWT payload for token",G.substring(0,32)),new Error("Invalid JWT received");const z=J.tenantId||"tenant_default";try{localStorage.setItem("auth_token",G)}catch{}try{L&&localStorage.setItem("refresh_token",L)}catch{}try{localStorage.setItem("tenant_id",z)}catch{}de.setAuth(G,z),L&&de.setRefreshToken(L),await h(J);const U=localStorage.getItem("company_name")||"My Company",oe={id:J.sub,email:S,firstName:"User",lastName:"",companyName:U,role:((T=J.roles)==null?void 0:T[0])||"employee",isEmailVerified:!0,createdAt:new Date().toISOString(),tenantId:z};console.log(" Login successful, setting user data:",oe),r(oe),console.log(" User state updated, isAuthenticated should now be:",!!oe)}catch(V){throw console.error(" Login failed:",V),V}finally{a(!1)}},y=async(S,_=["admin"])=>{var k;a(!0);try{try{typeof window<"u"&&localStorage.removeItem("disable_demo_auth")}catch{}const{token:F}=await de.getDemoToken(S,_),A=lf(F);if(!A)throw new Error("Invalid demo JWT");localStorage.setItem("auth_token",F),localStorage.setItem("tenant_id",A.tenantId),de.setAuth(F,A.tenantId),await h(A),r({id:A.sub,email:A.sub,firstName:"Demo",lastName:"User",companyName:localStorage.getItem("company_name")||"My Company",role:((k=A.roles)==null?void 0:k[0])||"admin",isEmailVerified:!0,createdAt:new Date().toISOString(),tenantId:A.tenantId})}finally{a(!1)}},j=async S=>{throw new Error("Registration not implemented yet.")},b=()=>{if(!(typeof window>"u"))try{const S=Object.keys(localStorage),_=["disable_demo_auth"];S.forEach(k=>{if(!_.includes(k))try{localStorage.removeItem(k)}catch(F){console.warn(`Failed to remove ${k} from localStorage:`,F)}}),console.log("All user data cleared from localStorage")}catch(S){console.error("Failed to clear localStorage:",S)}},w=async()=>{if(typeof window>"u"){r(null);return}try{const S=localStorage.getItem("refresh_token");S&&await de.logout(S)}catch(S){console.error("Logout failed",S)}finally{b();try{localStorage.setItem("disable_demo_auth","true")}catch(S){console.warn("Failed to set disable_demo_auth:",S)}de.setAuth("",""),r(null);try{await d.clear()}catch{}try{u("/")}catch{}}},N=async S=>{t&&r({...t,...S})};x.useEffect(()=>{c(!0)},[]),x.useEffect(()=>{l&&(console.log(" AuthProvider: Checking auth status..."),g())},[l]),x.useEffect(()=>{if(typeof window>"u"||!l||!t)return;const S=()=>{const k=localStorage.getItem("auth_token");if(!k)return;const F=lf(k);if(!(F!=null&&F.exp))return;const A=Date.now()/1e3;F.exp-A<600&&(console.log("Token expiring soon, proactively refreshing"),f().catch(V=>{console.error("Proactive token refresh failed:",V)}))},_=setInterval(S,2*60*1e3);return S(),()=>clearInterval(_)},[t,l]);const C={user:t,isLoading:n,isAuthenticated:!!t,isRefreshing:i,login:v,loginWithDemo:y,register:j,logout:w,updateUser:N,refreshTokens:f,ensureValidToken:m,handleAuthError:p,clearAllData:b};return e.jsx(xF.Provider,{value:C,children:s})}function Ua(){const s=x.useContext(xF);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s}const pF=x.createContext(void 0);function XG({children:s}){const[t,r]=x.useState(!1),n=()=>{r(!t)};return e.jsx(pF.Provider,{value:{isCollapsed:t,setIsCollapsed:r,toggleSidebar:n},children:s})}function C5(){const s=x.useContext(pF);if(s===void 0)throw new Error("useSidebar must be used within a SidebarProvider");return s}class QG extends x.Component{constructor(){super(...arguments);dn(this,"state",{hasError:!1})}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,n){console.error("ErrorBoundary caught an error:",r,n)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"max-w-md w-full bg-white shadow-lg rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-8 w-8 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Something went wrong"})})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("p",{children:"An unexpected error occurred. Please refresh the page or contact support if the problem persists."}),this.state.error&&e.jsxs("details",{className:"mt-4",children:[e.jsx("summary",{className:"cursor-pointer text-gray-800 font-medium",children:"Error Details"}),e.jsx("pre",{className:"mt-2 text-xs text-gray-500 bg-gray-100 p-2 rounded overflow-auto",children:this.state.error.message})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Refresh Page"})})]})}):this.props.children}}const ZG=1,eK=1e6;let Bw=0;function tK(){return Bw=(Bw+1)%Number.MAX_SAFE_INTEGER,Bw.toString()}const Uw=new Map,r6=s=>{if(Uw.has(s))return;const t=setTimeout(()=>{Uw.delete(s),I0({type:"REMOVE_TOAST",toastId:s})},eK);Uw.set(s,t)},sK=(s,t)=>{switch(t.type){case"ADD_TOAST":return{...s,toasts:[t.toast,...s.toasts].slice(0,ZG)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?r6(r):s.toasts.forEach(n=>{r6(n.id)}),{...s,toasts:s.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(r=>r.id!==t.toastId)}}},Fj=[];let Mj={toasts:[]};function I0(s){Mj=sK(Mj,s),Fj.forEach(t=>{t(Mj)})}function rK({...s}){const t=tK(),r=a=>I0({type:"UPDATE_TOAST",toast:{...a,id:t}}),n=()=>I0({type:"DISMISS_TOAST",toastId:t});return I0({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:a=>{a||n()}}}),{id:t,dismiss:n,update:r}}function za(){const[s,t]=x.useState(Mj);return x.useEffect(()=>(Fj.push(t),()=>{const r=Fj.indexOf(t);r>-1&&Fj.splice(r,1)}),[s]),{...s,toast:rK,dismiss:r=>I0({type:"DISMISS_TOAST",toastId:r})}}function Sc(s,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(s==null||s(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function n6(s,t){if(typeof s=="function")return s(t);s!=null&&(s.current=t)}function gF(...s){return t=>{let r=!1;const n=s.map(a=>{const i=n6(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():n6(s[a],null)}}}}function ty(...s){return x.useCallback(gF(...s),s)}function nK(s,t=[]){let r=[];function n(i,o){const l=x.createContext(o),c=r.length;r=[...r,o];const d=h=>{var y;const{scope:f,children:m,...p}=h,g=((y=f==null?void 0:f[s])==null?void 0:y[c])||l,v=x.useMemo(()=>p,Object.values(p));return e.jsx(g.Provider,{value:v,children:m})};d.displayName=i+"Provider";function u(h,f){var g;const m=((g=f==null?void 0:f[s])==null?void 0:g[c])||l,p=x.useContext(m);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[d,u]}const a=()=>{const i=r.map(o=>x.createContext(o));return function(l){const c=(l==null?void 0:l[s])||i;return x.useMemo(()=>({[`__scope${s}`]:{...l,[s]:c}}),[l,c])}};return a.scopeName=s,[n,aK(a,...t)]}function aK(...s){const t=s[0];if(s.length===1)return t;const r=()=>{const n=s.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=n.reduce((l,{useScope:c,scopeName:d})=>{const h=c(i)[`__scope${d}`];return{...l,...h}},{});return x.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}var vF=x.forwardRef((s,t)=>{const{children:r,...n}=s,a=x.Children.toArray(r),i=a.find(oK);if(i){const o=i.props.children,l=a.map(c=>c===i?x.Children.count(o)>1?x.Children.only(null):x.isValidElement(o)?o.props.children:null:c);return e.jsx(dC,{...n,ref:t,children:x.isValidElement(o)?x.cloneElement(o,void 0,l):null})}return e.jsx(dC,{...n,ref:t,children:r})});vF.displayName="Slot";var dC=x.forwardRef((s,t)=>{const{children:r,...n}=s;if(x.isValidElement(r)){const a=cK(r);return x.cloneElement(r,{...lK(n,r.props),ref:t?gF(t,a):a})}return x.Children.count(r)>1?x.Children.only(null):null});dC.displayName="SlotClone";var iK=({children:s})=>e.jsx(e.Fragment,{children:s});function oK(s){return x.isValidElement(s)&&s.type===iK}function lK(s,t){const r={...t};for(const n in t){const a=s[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...l)=>{i(...l),a(...l)}:a&&(r[n]=a):n==="style"?r[n]={...a,...i}:n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return{...s,...r}}function cK(s){var n,a;let t=(n=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}var dK=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],ph=dK.reduce((s,t)=>{const r=x.forwardRef((n,a)=>{const{asChild:i,...o}=n,l=i?vF:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(l,{...o,ref:a})});return r.displayName=`Primitive.${t}`,{...s,[t]:r}},{});function yF(s,t){s&&$m.flushSync(()=>s.dispatchEvent(t))}function oh(s){const t=x.useRef(s);return x.useEffect(()=>{t.current=s}),x.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function uK(s,t=globalThis==null?void 0:globalThis.document){const r=oh(s);x.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var hK="DismissableLayer",uC="dismissableLayer.update",mK="dismissableLayer.pointerDownOutside",fK="dismissableLayer.focusOutside",a6,jF=x.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),bF=x.forwardRef((s,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:o,onDismiss:l,...c}=s,d=x.useContext(jF),[u,h]=x.useState(null),f=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=x.useState({}),p=ty(t,S=>h(S)),g=Array.from(d.layers),[v]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),y=g.indexOf(v),j=u?g.indexOf(u):-1,b=d.layersWithOutsidePointerEventsDisabled.size>0,w=j>=y,N=pK(S=>{const _=S.target,k=[...d.branches].some(F=>F.contains(_));!w||k||(a==null||a(S),o==null||o(S),S.defaultPrevented||l==null||l())},f),C=gK(S=>{const _=S.target;[...d.branches].some(F=>F.contains(_))||(i==null||i(S),o==null||o(S),S.defaultPrevented||l==null||l())},f);return uK(S=>{j===d.layers.size-1&&(n==null||n(S),!S.defaultPrevented&&l&&(S.preventDefault(),l()))},f),x.useEffect(()=>{if(u)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(a6=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(u)),d.layers.add(u),i6(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=a6)}},[u,f,r,d]),x.useEffect(()=>()=>{u&&(d.layers.delete(u),d.layersWithOutsidePointerEventsDisabled.delete(u),i6())},[u,d]),x.useEffect(()=>{const S=()=>m({});return document.addEventListener(uC,S),()=>document.removeEventListener(uC,S)},[]),e.jsx(ph.div,{...c,ref:p,style:{pointerEvents:b?w?"auto":"none":void 0,...s.style},onFocusCapture:Sc(s.onFocusCapture,C.onFocusCapture),onBlurCapture:Sc(s.onBlurCapture,C.onBlurCapture),onPointerDownCapture:Sc(s.onPointerDownCapture,N.onPointerDownCapture)})});bF.displayName=hK;var xK="DismissableLayerBranch",NF=x.forwardRef((s,t)=>{const r=x.useContext(jF),n=x.useRef(null),a=ty(t,n);return x.useEffect(()=>{const i=n.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),e.jsx(ph.div,{...s,ref:a})});NF.displayName=xK;function pK(s,t=globalThis==null?void 0:globalThis.document){const r=oh(s),n=x.useRef(!1),a=x.useRef(()=>{});return x.useEffect(()=>{const i=l=>{if(l.target&&!n.current){let c=function(){wF(mK,r,d,{discrete:!0})};const d={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=c,t.addEventListener("click",a.current,{once:!0})):c()}else t.removeEventListener("click",a.current);n.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",i),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function gK(s,t=globalThis==null?void 0:globalThis.document){const r=oh(s),n=x.useRef(!1);return x.useEffect(()=>{const a=i=>{i.target&&!n.current&&wF(fK,r,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function i6(){const s=new CustomEvent(uC);document.dispatchEvent(s)}function wF(s,t,r,{discrete:n}){const a=r.originalEvent.target,i=new CustomEvent(s,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(s,t,{once:!0}),n?yF(a,i):a.dispatchEvent(i)}var vK=bF,yK=NF,Xj=globalThis!=null&&globalThis.document?x.useLayoutEffect:()=>{},jK="Portal",SF=x.forwardRef((s,t)=>{var l;const{container:r,...n}=s,[a,i]=x.useState(!1);Xj(()=>i(!0),[]);const o=r||a&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?ey.createPortal(e.jsx(ph.div,{...n,ref:t}),o):null});SF.displayName=jK;function bK(s,t){return x.useReducer((r,n)=>t[r][n]??r,s)}var CF=s=>{const{present:t,children:r}=s,n=NK(t),a=typeof r=="function"?r({present:n.isPresent}):x.Children.only(r),i=ty(n.ref,wK(a));return typeof r=="function"||n.isPresent?x.cloneElement(a,{ref:i}):null};CF.displayName="Presence";function NK(s){const[t,r]=x.useState(),n=x.useRef({}),a=x.useRef(s),i=x.useRef("none"),o=s?"mounted":"unmounted",[l,c]=bK(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return x.useEffect(()=>{const d=Wy(n.current);i.current=l==="mounted"?d:"none"},[l]),Xj(()=>{const d=n.current,u=a.current;if(u!==s){const f=i.current,m=Wy(d);s?c("MOUNT"):m==="none"||(d==null?void 0:d.display)==="none"?c("UNMOUNT"):c(u&&f!==m?"ANIMATION_OUT":"UNMOUNT"),a.current=s}},[s,c]),Xj(()=>{if(t){let d;const u=t.ownerDocument.defaultView??window,h=m=>{const g=Wy(n.current).includes(m.animationName);if(m.target===t&&g&&(c("ANIMATION_END"),!a.current)){const v=t.style.animationFillMode;t.style.animationFillMode="forwards",d=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=v)})}},f=m=>{m.target===t&&(i.current=Wy(n.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",h),t.addEventListener("animationend",h),()=>{u.clearTimeout(d),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",h),t.removeEventListener("animationend",h)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:x.useCallback(d=>{d&&(n.current=getComputedStyle(d)),r(d)},[])}}function Wy(s){return(s==null?void 0:s.animationName)||"none"}function wK(s){var n,a;let t=(n=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}function SK({prop:s,defaultProp:t,onChange:r=()=>{}}){const[n,a]=CK({defaultProp:t,onChange:r}),i=s!==void 0,o=i?s:n,l=oh(r),c=x.useCallback(d=>{if(i){const h=typeof d=="function"?d(s):d;h!==s&&l(h)}else a(d)},[i,s,a,l]);return[o,c]}function CK({defaultProp:s,onChange:t}){const r=x.useState(s),[n]=r,a=x.useRef(n),i=oh(t);return x.useEffect(()=>{a.current!==n&&(i(n),a.current=n)},[n,a,i]),r}function o6(s,t){if(typeof s=="function")return s(t);s!=null&&(s.current=t)}function AK(...s){return t=>{let r=!1;const n=s.map(a=>{const i=o6(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():o6(s[a],null)}}}}var AF=x.forwardRef((s,t)=>{const{children:r,...n}=s,a=x.Children.toArray(r),i=a.find(IK);if(i){const o=i.props.children,l=a.map(c=>c===i?x.Children.count(o)>1?x.Children.only(null):x.isValidElement(o)?o.props.children:null:c);return e.jsx(hC,{...n,ref:t,children:x.isValidElement(o)?x.cloneElement(o,void 0,l):null})}return e.jsx(hC,{...n,ref:t,children:r})});AF.displayName="Slot";var hC=x.forwardRef((s,t)=>{const{children:r,...n}=s;if(x.isValidElement(r)){const a=_K(r);return x.cloneElement(r,{...PK(n,r.props),ref:t?AK(t,a):a})}return x.Children.count(r)>1?x.Children.only(null):null});hC.displayName="SlotClone";var EK=({children:s})=>e.jsx(e.Fragment,{children:s});function IK(s){return x.isValidElement(s)&&s.type===EK}function PK(s,t){const r={...t};for(const n in t){const a=s[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...l)=>{i(...l),a(...l)}:a&&(r[n]=a):n==="style"?r[n]={...a,...i}:n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return{...s,...r}}function _K(s){var n,a;let t=(n=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}var kK=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],TK=kK.reduce((s,t)=>{const r=x.forwardRef((n,a)=>{const{asChild:i,...o}=n,l=i?AF:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(l,{...o,ref:a})});return r.displayName=`Primitive.${t}`,{...s,[t]:r}},{}),DK="VisuallyHidden",Xb=x.forwardRef((s,t)=>e.jsx(TK.span,{...s,ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...s.style}}));Xb.displayName=DK;var A5="ToastProvider",[E5,OK,RK]=MR("Toast"),[EF]=nK("Toast",[RK]),[FK,Qb]=EF(A5),IF=s=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:a="right",swipeThreshold:i=50,children:o}=s,[l,c]=x.useState(null),[d,u]=x.useState(0),h=x.useRef(!1),f=x.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${A5}\`. Expected non-empty \`string\`.`),e.jsx(E5.Provider,{scope:t,children:e.jsx(FK,{scope:t,label:r,duration:n,swipeDirection:a,swipeThreshold:i,toastCount:d,viewport:l,onViewportChange:c,onToastAdd:x.useCallback(()=>u(m=>m+1),[]),onToastRemove:x.useCallback(()=>u(m=>m-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:f,children:o})})};IF.displayName=A5;var PF="ToastViewport",MK=["F8"],mC="toast.viewportPause",fC="toast.viewportResume",_F=x.forwardRef((s,t)=>{const{__scopeToast:r,hotkey:n=MK,label:a="Notifications ({hotkey})",...i}=s,o=Qb(PF,r),l=OK(r),c=x.useRef(null),d=x.useRef(null),u=x.useRef(null),h=x.useRef(null),f=ty(t,h,o.onViewportChange),m=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=o.toastCount>0;x.useEffect(()=>{const v=y=>{var b;n.length!==0&&n.every(w=>y[w]||y.code===w)&&((b=h.current)==null||b.focus())};return document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[n]),x.useEffect(()=>{const v=c.current,y=h.current;if(p&&v&&y){const j=()=>{if(!o.isClosePausedRef.current){const C=new CustomEvent(mC);y.dispatchEvent(C),o.isClosePausedRef.current=!0}},b=()=>{if(o.isClosePausedRef.current){const C=new CustomEvent(fC);y.dispatchEvent(C),o.isClosePausedRef.current=!1}},w=C=>{!v.contains(C.relatedTarget)&&b()},N=()=>{v.contains(document.activeElement)||b()};return v.addEventListener("focusin",j),v.addEventListener("focusout",w),v.addEventListener("pointermove",j),v.addEventListener("pointerleave",N),window.addEventListener("blur",j),window.addEventListener("focus",b),()=>{v.removeEventListener("focusin",j),v.removeEventListener("focusout",w),v.removeEventListener("pointermove",j),v.removeEventListener("pointerleave",N),window.removeEventListener("blur",j),window.removeEventListener("focus",b)}}},[p,o.isClosePausedRef]);const g=x.useCallback(({tabbingDirection:v})=>{const j=l().map(b=>{const w=b.ref.current,N=[w,...JK(w)];return v==="forwards"?N:N.reverse()});return(v==="forwards"?j.reverse():j).flat()},[l]);return x.useEffect(()=>{const v=h.current;if(v){const y=j=>{var N,C,S;const b=j.altKey||j.ctrlKey||j.metaKey;if(j.key==="Tab"&&!b){const _=document.activeElement,k=j.shiftKey;if(j.target===v&&k){(N=d.current)==null||N.focus();return}const T=g({tabbingDirection:k?"backwards":"forwards"}),V=T.findIndex(M=>M===_);zw(T.slice(V+1))?j.preventDefault():k?(C=d.current)==null||C.focus():(S=u.current)==null||S.focus()}};return v.addEventListener("keydown",y),()=>v.removeEventListener("keydown",y)}},[l,g]),e.jsxs(yK,{ref:c,role:"region","aria-label":a.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:p?void 0:"none"},children:[p&&e.jsx(xC,{ref:d,onFocusFromOutsideViewport:()=>{const v=g({tabbingDirection:"forwards"});zw(v)}}),e.jsx(E5.Slot,{scope:r,children:e.jsx(ph.ol,{tabIndex:-1,...i,ref:f})}),p&&e.jsx(xC,{ref:u,onFocusFromOutsideViewport:()=>{const v=g({tabbingDirection:"backwards"});zw(v)}})]})});_F.displayName=PF;var kF="ToastFocusProxy",xC=x.forwardRef((s,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...a}=s,i=Qb(kF,r);return e.jsx(Xb,{"aria-hidden":!0,tabIndex:0,...a,ref:t,style:{position:"fixed"},onFocus:o=>{var d;const l=o.relatedTarget;!((d=i.viewport)!=null&&d.contains(l))&&n()}})});xC.displayName=kF;var Zb="Toast",LK="toast.swipeStart",$K="toast.swipeMove",BK="toast.swipeCancel",UK="toast.swipeEnd",TF=x.forwardRef((s,t)=>{const{forceMount:r,open:n,defaultOpen:a,onOpenChange:i,...o}=s,[l=!0,c]=SK({prop:n,defaultProp:a,onChange:i});return e.jsx(CF,{present:r||l,children:e.jsx(VK,{open:l,...o,ref:t,onClose:()=>c(!1),onPause:oh(s.onPause),onResume:oh(s.onResume),onSwipeStart:Sc(s.onSwipeStart,d=>{d.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Sc(s.onSwipeMove,d=>{const{x:u,y:h}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","move"),d.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:Sc(s.onSwipeCancel,d=>{d.currentTarget.setAttribute("data-swipe","cancel"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Sc(s.onSwipeEnd,d=>{const{x:u,y:h}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","end"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),c(!1)})})})});TF.displayName=Zb;var[zK,qK]=EF(Zb,{onClose(){}}),VK=x.forwardRef((s,t)=>{const{__scopeToast:r,type:n="foreground",duration:a,open:i,onClose:o,onEscapeKeyDown:l,onPause:c,onResume:d,onSwipeStart:u,onSwipeMove:h,onSwipeCancel:f,onSwipeEnd:m,...p}=s,g=Qb(Zb,r),[v,y]=x.useState(null),j=ty(t,M=>y(M)),b=x.useRef(null),w=x.useRef(null),N=a||g.duration,C=x.useRef(0),S=x.useRef(N),_=x.useRef(0),{onToastAdd:k,onToastRemove:F}=g,A=oh(()=>{var G;(v==null?void 0:v.contains(document.activeElement))&&((G=g.viewport)==null||G.focus()),o()}),T=x.useCallback(M=>{!M||M===1/0||(window.clearTimeout(_.current),C.current=new Date().getTime(),_.current=window.setTimeout(A,M))},[A]);x.useEffect(()=>{const M=g.viewport;if(M){const G=()=>{T(S.current),d==null||d()},L=()=>{const J=new Date().getTime()-C.current;S.current=S.current-J,window.clearTimeout(_.current),c==null||c()};return M.addEventListener(mC,L),M.addEventListener(fC,G),()=>{M.removeEventListener(mC,L),M.removeEventListener(fC,G)}}},[g.viewport,N,c,d,T]),x.useEffect(()=>{i&&!g.isClosePausedRef.current&&T(N)},[i,N,g.isClosePausedRef,T]),x.useEffect(()=>(k(),()=>F()),[k,F]);const V=x.useMemo(()=>v?$F(v):null,[v]);return g.viewport?e.jsxs(e.Fragment,{children:[V&&e.jsx(WK,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:V}),e.jsx(zK,{scope:r,onClose:A,children:$m.createPortal(e.jsx(E5.ItemSlot,{scope:r,children:e.jsx(vK,{asChild:!0,onEscapeKeyDown:Sc(l,()=>{g.isFocusedToastEscapeKeyDownRef.current||A(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:e.jsx(ph.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":g.swipeDirection,...p,ref:j,style:{userSelect:"none",touchAction:"none",...s.style},onKeyDown:Sc(s.onKeyDown,M=>{M.key==="Escape"&&(l==null||l(M.nativeEvent),M.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,A()))}),onPointerDown:Sc(s.onPointerDown,M=>{M.button===0&&(b.current={x:M.clientX,y:M.clientY})}),onPointerMove:Sc(s.onPointerMove,M=>{if(!b.current)return;const G=M.clientX-b.current.x,L=M.clientY-b.current.y,J=!!w.current,z=["left","right"].includes(g.swipeDirection),U=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,oe=z?U(0,G):0,Q=z?0:U(0,L),P=M.pointerType==="touch"?10:2,q={x:oe,y:Q},D={originalEvent:M,delta:q};J?(w.current=q,Hy($K,h,D,{discrete:!1})):l6(q,g.swipeDirection,P)?(w.current=q,Hy(LK,u,D,{discrete:!1}),M.target.setPointerCapture(M.pointerId)):(Math.abs(G)>P||Math.abs(L)>P)&&(b.current=null)}),onPointerUp:Sc(s.onPointerUp,M=>{const G=w.current,L=M.target;if(L.hasPointerCapture(M.pointerId)&&L.releasePointerCapture(M.pointerId),w.current=null,b.current=null,G){const J=M.currentTarget,z={originalEvent:M,delta:G};l6(G,g.swipeDirection,g.swipeThreshold)?Hy(UK,m,z,{discrete:!0}):Hy(BK,f,z,{discrete:!0}),J.addEventListener("click",U=>U.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),WK=s=>{const{__scopeToast:t,children:r,...n}=s,a=Qb(Zb,t),[i,o]=x.useState(!1),[l,c]=x.useState(!1);return KK(()=>o(!0)),x.useEffect(()=>{const d=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(d)},[]),l?null:e.jsx(SF,{asChild:!0,children:e.jsx(Xb,{...n,children:i&&e.jsxs(e.Fragment,{children:[a.label," ",r]})})})},HK="ToastTitle",DF=x.forwardRef((s,t)=>{const{__scopeToast:r,...n}=s;return e.jsx(ph.div,{...n,ref:t})});DF.displayName=HK;var GK="ToastDescription",OF=x.forwardRef((s,t)=>{const{__scopeToast:r,...n}=s;return e.jsx(ph.div,{...n,ref:t})});OF.displayName=GK;var RF="ToastAction",FF=x.forwardRef((s,t)=>{const{altText:r,...n}=s;return r.trim()?e.jsx(LF,{altText:r,asChild:!0,children:e.jsx(I5,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${RF}\`. Expected non-empty \`string\`.`),null)});FF.displayName=RF;var MF="ToastClose",I5=x.forwardRef((s,t)=>{const{__scopeToast:r,...n}=s,a=qK(MF,r);return e.jsx(LF,{asChild:!0,children:e.jsx(ph.button,{type:"button",...n,ref:t,onClick:Sc(s.onClick,a.onClose)})})});I5.displayName=MF;var LF=x.forwardRef((s,t)=>{const{__scopeToast:r,altText:n,...a}=s;return e.jsx(ph.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...a,ref:t})});function $F(s){const t=[];return Array.from(s.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),YK(n)){const a=n.ariaHidden||n.hidden||n.style.display==="none",i=n.dataset.radixToastAnnounceExclude==="";if(!a)if(i){const o=n.dataset.radixToastAnnounceAlt;o&&t.push(o)}else t.push(...$F(n))}}),t}function Hy(s,t,r,{discrete:n}){const a=r.originalEvent.currentTarget,i=new CustomEvent(s,{bubbles:!0,cancelable:!0,detail:r});t&&a.addEventListener(s,t,{once:!0}),n?yF(a,i):a.dispatchEvent(i)}var l6=(s,t,r=0)=>{const n=Math.abs(s.x),a=Math.abs(s.y),i=n>a;return t==="left"||t==="right"?i&&n>r:!i&&a>r};function KK(s=()=>{}){const t=oh(s);Xj(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function YK(s){return s.nodeType===s.ELEMENT_NODE}function JK(s){const t=[],r=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function zw(s){const t=document.activeElement;return s.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var XK=IF,BF=_F,UF=TF,zF=DF,qF=OF,VF=FF,WF=I5;function HF(s){var t,r,n="";if(typeof s=="string"||typeof s=="number")n+=s;else if(typeof s=="object")if(Array.isArray(s)){var a=s.length;for(t=0;t<a;t++)s[t]&&(r=HF(s[t]))&&(n&&(n+=" "),n+=r)}else for(r in s)s[r]&&(n&&(n+=" "),n+=r);return n}function Jr(){for(var s,t,r=0,n="",a=arguments.length;r<a;r++)(s=arguments[r])&&(t=HF(s))&&(n&&(n+=" "),n+=t);return n}const c6=s=>typeof s=="boolean"?`${s}`:s===0?"0":s,d6=Jr,sy=(s,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return d6(s,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:i}=t,o=Object.keys(a).map(d=>{const u=r==null?void 0:r[d],h=i==null?void 0:i[d];if(u===null)return null;const f=c6(u)||c6(h);return a[d][f]}),l=r&&Object.entries(r).reduce((d,u)=>{let[h,f]=u;return f===void 0||(d[h]=f),d},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((d,u)=>{let{class:h,className:f,...m}=u;return Object.entries(m).every(p=>{let[g,v]=p;return Array.isArray(v)?v.includes({...i,...l}[g]):{...i,...l}[g]===v})?[...d,h,f]:d},[]);return d6(s,o,c,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QK=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),GF=(...s)=>s.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ZK={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eY=x.forwardRef(({color:s="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:o,...l},c)=>x.createElement("svg",{ref:c,...ZK,width:t,height:t,stroke:s,strokeWidth:n?Number(r)*24/Number(t):r,className:GF("lucide",a),...l},[...o.map(([d,u])=>x.createElement(d,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=(s,t)=>{const r=x.forwardRef(({className:n,...a},i)=>x.createElement(eY,{ref:i,iconNode:t,className:GF(`lucide-${QK(s)}`,n),...a}));return r.displayName=`${s}`,r};/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const or=Wt("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u6=Wt("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gh=Wt("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tY=Wt("ArrowDownWideNarrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KF=Wt("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YF=Wt("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qw=Wt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wd=Wt("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lj=Wt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wu=Wt("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sY=Wt("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lu=Wt("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JF=Wt("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P5=Wt("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hu=Wt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ml=Wt("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rY=Wt("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jp=Wt("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=Wt("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nY=Wt("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=Wt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lf=Wt("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yn=Wt("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qj=Wt("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xn=Wt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aY=Wt("CameraOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16",key:"qmtpty"}],["path",{d:"M9.5 4h5L17 7h3a2 2 0 0 1 2 2v7.5",key:"1ufyfc"}],["path",{d:"M14.121 15.121A3 3 0 1 1 9.88 10.88",key:"11zox6"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zj=Wt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iY=Wt("ChartBar",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M7 16h8",key:"srdodz"}],["path",{d:"M7 11h12",key:"127s9w"}],["path",{d:"M7 6h3",key:"w9rmul"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=Wt("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eN=Wt("ChartLine",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oY=Wt("ChartNoAxesColumnIncreasing",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eo=Wt("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ro=Wt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tc=Wt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tN=Wt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tm=Wt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const um=Wt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XF=Wt("ChevronsLeft",[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QF=Wt("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ln=Wt("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=Wt("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h6=Wt("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _5=Wt("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nc=Wt("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZF=Wt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lY=Wt("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cY=Wt("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cr=Wt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m6=Wt("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ac=Wt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ef=Wt("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=Wt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f6=Wt("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e1=Wt("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=Wt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=Wt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x6=Wt("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gy=Wt("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eM=Wt("Euro",[["path",{d:"M4 10h12",key:"1y6xl8"}],["path",{d:"M4 14h9",key:"1loblj"}],["path",{d:"M19 6a7.7 7.7 0 0 0-5.2-2A7.9 7.9 0 0 0 6 12c0 4.4 3.5 8 7.8 8 2 0 3.8-.8 5.2-2",key:"1j6lzo"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nm=Wt("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bp=Wt("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ir=Wt("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p6=Wt("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dY=Wt("FileImage",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"12",r:"2",key:"737tya"}],["path",{d:"m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22",key:"wt3hpn"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yf=Wt("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=Wt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uY=Wt("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ic=Wt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t1=Wt("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hY=Wt("FolderPlus",[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vw=Wt("FolderTree",[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qu=Wt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mY=Wt("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fY=Wt("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xY=Wt("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tM=Wt("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sN=Wt("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zl=Wt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cf=Wt("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pC=Wt("Keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kh=Wt("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ic=Wt("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s1=Wt("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pY=Wt("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const On=Wt("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wm=Wt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gY=Wt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dd=Wt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pa=Wt("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vY=Wt("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sM=Wt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=Wt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yY=Wt("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jY=Wt("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rM=Wt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jf=Wt("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=Wt("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bY=Wt("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NY=Wt("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r1=Wt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const po=Wt("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=Wt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nM=Wt("PoundSterling",[["path",{d:"M18 7c0-5.333-8-5.333-8 0",key:"1prm2n"}],["path",{d:"M10 7v14",key:"18tmcs"}],["path",{d:"M6 21h12",key:"4dkmi1"}],["path",{d:"M6 13h10",key:"ybwr4a"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k5=Wt("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dl=Wt("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lh=Wt("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=Wt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gC=Wt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Od=Wt("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wY=Wt("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ww=Wt("Scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=Wt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wd=Wt("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SY=Wt("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const en=Wt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T5=Wt("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hm=Wt("Share",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kn=Wt("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CY=Wt("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gu=Wt("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sd=Wt("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Np=Wt("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=Wt("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aM=Wt("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const go=Wt("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AY=Wt("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hw=Wt("Tablet",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["line",{x1:"12",x2:"12.01",y1:"18",y2:"18",key:"1dp563"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EY=Wt("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=Wt("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g6=Wt("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v6=Wt("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gw=Wt("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=Wt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IY=Wt("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $o=Wt("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=Wt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=Wt("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PY=Wt("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y6=Wt("Unlink",[["path",{d:"m18.84 12.25 1.72-1.71h-.02a5.004 5.004 0 0 0-.12-7.07 5.006 5.006 0 0 0-6.95 0l-1.72 1.71",key:"yqzxt4"}],["path",{d:"m5.17 11.75-1.71 1.71a5.004 5.004 0 0 0 .12 7.07 5.006 5.006 0 0 0 6.95 0l1.71-1.71",key:"4qinb0"}],["line",{x1:"8",x2:"8",y1:"2",y2:"5",key:"1041cp"}],["line",{x1:"2",x2:"5",y1:"8",y2:"8",key:"14m1p5"}],["line",{x1:"16",x2:"16",y1:"19",y2:"22",key:"rzdirn"}],["line",{x1:"19",x2:"22",y1:"16",y2:"16",key:"ox905f"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pl=Wt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D5=Wt("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bo=Wt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=Wt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _Y=Wt("VideoOff",[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.5l5.248-3.062A.5.5 0 0 1 22 7.87v8.196",key:"w8jjjt"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2",key:"1xawa7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kY=Wt("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TY=Wt("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DY=Wt("VolumeX",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iM=Wt("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OY=Wt("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tf=Wt("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=Wt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=Wt("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),O5="-",RY=s=>{const t=MY(s),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=s;return{getClassGroupId:o=>{const l=o.split(O5);return l[0]===""&&l.length!==1&&l.shift(),oM(l,t)||FY(o)},getConflictingClassGroupIds:(o,l)=>{const c=r[o]||[];return l&&n[o]?[...c,...n[o]]:c}}},oM=(s,t)=>{var o;if(s.length===0)return t.classGroupId;const r=s[0],n=t.nextPart.get(r),a=n?oM(s.slice(1),n):void 0;if(a)return a;if(t.validators.length===0)return;const i=s.join(O5);return(o=t.validators.find(({validator:l})=>l(i)))==null?void 0:o.classGroupId},j6=/^\[(.+)\]$/,FY=s=>{if(j6.test(s)){const t=j6.exec(s)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},MY=s=>{const{theme:t,prefix:r}=s,n={nextPart:new Map,validators:[]};return $Y(Object.entries(s.classGroups),r).forEach(([i,o])=>{vC(o,n,i,t)}),n},vC=(s,t,r,n)=>{s.forEach(a=>{if(typeof a=="string"){const i=a===""?t:b6(t,a);i.classGroupId=r;return}if(typeof a=="function"){if(LY(a)){vC(a(n),t,r,n);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([i,o])=>{vC(o,b6(t,i),r,n)})})},b6=(s,t)=>{let r=s;return t.split(O5).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},LY=s=>s.isThemeGetter,$Y=(s,t)=>t?s.map(([r,n])=>{const a=n.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,l])=>[t+o,l])):i);return[r,a]}):s,BY=s=>{if(s<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const a=(i,o)=>{r.set(i,o),t++,t>s&&(t=0,n=r,r=new Map)};return{get(i){let o=r.get(i);if(o!==void 0)return o;if((o=n.get(i))!==void 0)return a(i,o),o},set(i,o){r.has(i)?r.set(i,o):a(i,o)}}},lM="!",UY=s=>{const{separator:t,experimentalParseClassName:r}=s,n=t.length===1,a=t[0],i=t.length,o=l=>{const c=[];let d=0,u=0,h;for(let v=0;v<l.length;v++){let y=l[v];if(d===0){if(y===a&&(n||l.slice(v,v+i)===t)){c.push(l.slice(u,v)),u=v+i;continue}if(y==="/"){h=v;continue}}y==="["?d++:y==="]"&&d--}const f=c.length===0?l:l.substring(u),m=f.startsWith(lM),p=m?f.substring(1):f,g=h&&h>u?h-u:void 0;return{modifiers:c,hasImportantModifier:m,baseClassName:p,maybePostfixModifierPosition:g}};return r?l=>r({className:l,parseClassName:o}):o},zY=s=>{if(s.length<=1)return s;const t=[];let r=[];return s.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},qY=s=>({cache:BY(s.cacheSize),parseClassName:UY(s),...RY(s)}),VY=/\s+/,WY=(s,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a}=t,i=[],o=s.trim().split(VY);let l="";for(let c=o.length-1;c>=0;c-=1){const d=o[c],{modifiers:u,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:m}=r(d);let p=!!m,g=n(p?f.substring(0,m):f);if(!g){if(!p){l=d+(l.length>0?" "+l:l);continue}if(g=n(f),!g){l=d+(l.length>0?" "+l:l);continue}p=!1}const v=zY(u).join(":"),y=h?v+lM:v,j=y+g;if(i.includes(j))continue;i.push(j);const b=a(g,p);for(let w=0;w<b.length;++w){const N=b[w];i.push(y+N)}l=d+(l.length>0?" "+l:l)}return l};function HY(){let s=0,t,r,n="";for(;s<arguments.length;)(t=arguments[s++])&&(r=cM(t))&&(n&&(n+=" "),n+=r);return n}const cM=s=>{if(typeof s=="string")return s;let t,r="";for(let n=0;n<s.length;n++)s[n]&&(t=cM(s[n]))&&(r&&(r+=" "),r+=t);return r};function GY(s,...t){let r,n,a,i=o;function o(c){const d=t.reduce((u,h)=>h(u),s());return r=qY(d),n=r.cache.get,a=r.cache.set,i=l,l(c)}function l(c){const d=n(c);if(d)return d;const u=WY(c,r);return a(c,u),u}return function(){return i(HY.apply(null,arguments))}}const ai=s=>{const t=r=>r[s]||[];return t.isThemeGetter=!0,t},dM=/^\[(?:([a-z-]+):)?(.+)\]$/i,KY=/^\d+\/\d+$/,YY=new Set(["px","full","screen"]),JY=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,XY=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,QY=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,ZY=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,eJ=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Pu=s=>ep(s)||YY.has(s)||KY.test(s),Oh=s=>gg(s,"length",lJ),ep=s=>!!s&&!Number.isNaN(Number(s)),Kw=s=>gg(s,"number",ep),Jg=s=>!!s&&Number.isInteger(Number(s)),tJ=s=>s.endsWith("%")&&ep(s.slice(0,-1)),gn=s=>dM.test(s),Rh=s=>JY.test(s),sJ=new Set(["length","size","percentage"]),rJ=s=>gg(s,sJ,uM),nJ=s=>gg(s,"position",uM),aJ=new Set(["image","url"]),iJ=s=>gg(s,aJ,dJ),oJ=s=>gg(s,"",cJ),Xg=()=>!0,gg=(s,t,r)=>{const n=dM.exec(s);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},lJ=s=>XY.test(s)&&!QY.test(s),uM=()=>!1,cJ=s=>ZY.test(s),dJ=s=>eJ.test(s),uJ=()=>{const s=ai("colors"),t=ai("spacing"),r=ai("blur"),n=ai("brightness"),a=ai("borderColor"),i=ai("borderRadius"),o=ai("borderSpacing"),l=ai("borderWidth"),c=ai("contrast"),d=ai("grayscale"),u=ai("hueRotate"),h=ai("invert"),f=ai("gap"),m=ai("gradientColorStops"),p=ai("gradientColorStopPositions"),g=ai("inset"),v=ai("margin"),y=ai("opacity"),j=ai("padding"),b=ai("saturate"),w=ai("scale"),N=ai("sepia"),C=ai("skew"),S=ai("space"),_=ai("translate"),k=()=>["auto","contain","none"],F=()=>["auto","hidden","clip","visible","scroll"],A=()=>["auto",gn,t],T=()=>[gn,t],V=()=>["",Pu,Oh],M=()=>["auto",ep,gn],G=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],L=()=>["solid","dashed","dotted","double","none"],J=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],z=()=>["start","end","center","between","around","evenly","stretch"],U=()=>["","0",gn],oe=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Q=()=>[ep,gn];return{cacheSize:500,separator:":",theme:{colors:[Xg],spacing:[Pu,Oh],blur:["none","",Rh,gn],brightness:Q(),borderColor:[s],borderRadius:["none","","full",Rh,gn],borderSpacing:T(),borderWidth:V(),contrast:Q(),grayscale:U(),hueRotate:Q(),invert:U(),gap:T(),gradientColorStops:[s],gradientColorStopPositions:[tJ,Oh],inset:A(),margin:A(),opacity:Q(),padding:T(),saturate:Q(),scale:Q(),sepia:U(),skew:Q(),space:T(),translate:T()},classGroups:{aspect:[{aspect:["auto","square","video",gn]}],container:["container"],columns:[{columns:[Rh]}],"break-after":[{"break-after":oe()}],"break-before":[{"break-before":oe()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...G(),gn]}],overflow:[{overflow:F()}],"overflow-x":[{"overflow-x":F()}],"overflow-y":[{"overflow-y":F()}],overscroll:[{overscroll:k()}],"overscroll-x":[{"overscroll-x":k()}],"overscroll-y":[{"overscroll-y":k()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Jg,gn]}],basis:[{basis:A()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",gn]}],grow:[{grow:U()}],shrink:[{shrink:U()}],order:[{order:["first","last","none",Jg,gn]}],"grid-cols":[{"grid-cols":[Xg]}],"col-start-end":[{col:["auto",{span:["full",Jg,gn]},gn]}],"col-start":[{"col-start":M()}],"col-end":[{"col-end":M()}],"grid-rows":[{"grid-rows":[Xg]}],"row-start-end":[{row:["auto",{span:[Jg,gn]},gn]}],"row-start":[{"row-start":M()}],"row-end":[{"row-end":M()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",gn]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",gn]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...z()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...z(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...z(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[j]}],px:[{px:[j]}],py:[{py:[j]}],ps:[{ps:[j]}],pe:[{pe:[j]}],pt:[{pt:[j]}],pr:[{pr:[j]}],pb:[{pb:[j]}],pl:[{pl:[j]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[S]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[S]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",gn,t]}],"min-w":[{"min-w":[gn,t,"min","max","fit"]}],"max-w":[{"max-w":[gn,t,"none","full","min","max","fit","prose",{screen:[Rh]},Rh]}],h:[{h:[gn,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[gn,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[gn,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[gn,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Rh,Oh]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Kw]}],"font-family":[{font:[Xg]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",gn]}],"line-clamp":[{"line-clamp":["none",ep,Kw]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Pu,gn]}],"list-image":[{"list-image":["none",gn]}],"list-style-type":[{list:["none","disc","decimal",gn]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[s]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[s]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...L(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Pu,Oh]}],"underline-offset":[{"underline-offset":["auto",Pu,gn]}],"text-decoration-color":[{decoration:[s]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:T()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",gn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",gn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...G(),nJ]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",rJ]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},iJ]}],"bg-color":[{bg:[s]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:[...L(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:L()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...L()]}],"outline-offset":[{"outline-offset":[Pu,gn]}],"outline-w":[{outline:[Pu,Oh]}],"outline-color":[{outline:[s]}],"ring-w":[{ring:V()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[s]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[Pu,Oh]}],"ring-offset-color":[{"ring-offset":[s]}],shadow:[{shadow:["","inner","none",Rh,oJ]}],"shadow-color":[{shadow:[Xg]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":[...J(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":J()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Rh,gn]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[b]}],sepia:[{sepia:[N]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[N]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",gn]}],duration:[{duration:Q()}],ease:[{ease:["linear","in","out","in-out",gn]}],delay:[{delay:Q()}],animate:[{animate:["none","spin","ping","pulse","bounce",gn]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[w]}],"scale-x":[{"scale-x":[w]}],"scale-y":[{"scale-y":[w]}],rotate:[{rotate:[Jg,gn]}],"translate-x":[{"translate-x":[_]}],"translate-y":[{"translate-y":[_]}],"skew-x":[{"skew-x":[C]}],"skew-y":[{"skew-y":[C]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",gn]}],accent:[{accent:["auto",s]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",gn]}],"caret-color":[{caret:[s]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":T()}],"scroll-mx":[{"scroll-mx":T()}],"scroll-my":[{"scroll-my":T()}],"scroll-ms":[{"scroll-ms":T()}],"scroll-me":[{"scroll-me":T()}],"scroll-mt":[{"scroll-mt":T()}],"scroll-mr":[{"scroll-mr":T()}],"scroll-mb":[{"scroll-mb":T()}],"scroll-ml":[{"scroll-ml":T()}],"scroll-p":[{"scroll-p":T()}],"scroll-px":[{"scroll-px":T()}],"scroll-py":[{"scroll-py":T()}],"scroll-ps":[{"scroll-ps":T()}],"scroll-pe":[{"scroll-pe":T()}],"scroll-pt":[{"scroll-pt":T()}],"scroll-pr":[{"scroll-pr":T()}],"scroll-pb":[{"scroll-pb":T()}],"scroll-pl":[{"scroll-pl":T()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",gn]}],fill:[{fill:[s,"none"]}],"stroke-w":[{stroke:[Pu,Oh,Kw]}],stroke:[{stroke:[s,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},hJ=GY(uJ);function ns(...s){return hJ(Jr(s))}function Fh(s,t="USD"){return new Intl.NumberFormat("en-US",{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:0}).format(s)}const mJ=XK,hM=x.forwardRef(({className:s,...t},r)=>e.jsx(BF,{ref:r,className:ns("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...t}));hM.displayName=BF.displayName;const fJ=sy("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),mM=x.forwardRef(({className:s,variant:t,...r},n)=>e.jsx(UF,{ref:n,className:ns(fJ({variant:t}),s),...r}));mM.displayName=UF.displayName;const xJ=x.forwardRef(({className:s,...t},r)=>e.jsx(VF,{ref:r,className:ns("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...t}));xJ.displayName=VF.displayName;const fM=x.forwardRef(({className:s,...t},r)=>e.jsx(WF,{ref:r,className:ns("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...t,children:e.jsx(ma,{className:"h-4 w-4"})}));fM.displayName=WF.displayName;const xM=x.forwardRef(({className:s,...t},r)=>e.jsx(zF,{ref:r,className:ns("text-sm font-semibold",s),...t}));xM.displayName=zF.displayName;const pM=x.forwardRef(({className:s,...t},r)=>e.jsx(qF,{ref:r,className:ns("text-sm opacity-90",s),...t}));pM.displayName=qF.displayName;function gM(){const{toasts:s}=za();return e.jsxs(mJ,{children:[s.map(function({id:t,title:r,description:n,action:a,...i}){return e.jsxs(mM,{...i,children:[e.jsxs("div",{className:"grid gap-1",children:[r&&e.jsx(xM,{children:r}),n&&e.jsx(pM,{children:n})]}),a,e.jsx(fM,{})]},t)}),e.jsx(hM,{})]})}var pJ=(s,t,r,n,a,i,o,l)=>{let c=document.documentElement,d=["light","dark"];function u(m){(Array.isArray(s)?s:[s]).forEach(p=>{let g=p==="class",v=g&&i?a.map(y=>i[y]||y):a;g?(c.classList.remove(...v),c.classList.add(i&&i[m]?i[m]:m)):c.setAttribute(p,m)}),h(m)}function h(m){l&&d.includes(m)&&(c.style.colorScheme=m)}function f(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(n)u(n);else try{let m=localStorage.getItem(t)||r,p=o&&m==="system"?f():m;u(p)}catch{}},gJ=x.createContext(void 0),vJ={setTheme:s=>{},themes:[]},yJ=()=>{var s;return(s=x.useContext(gJ))!=null?s:vJ};x.memo(({forcedTheme:s,storageKey:t,attribute:r,enableSystem:n,enableColorScheme:a,defaultTheme:i,value:o,themes:l,nonce:c,scriptProps:d})=>{let u=JSON.stringify([r,t,i,s,l,o,n,a]).slice(1,-1);return x.createElement("script",{...d,suppressHydrationWarning:!0,nonce:typeof window>"u"?c:"",dangerouslySetInnerHTML:{__html:`(${pJ.toString()})(${u})`}})});var jJ=s=>{switch(s){case"success":return wJ;case"info":return CJ;case"warning":return SJ;case"error":return AJ;default:return null}},bJ=Array(12).fill(0),NJ=({visible:s,className:t})=>xe.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":s},xe.createElement("div",{className:"sonner-spinner"},bJ.map((r,n)=>xe.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),wJ=xe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},xe.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),SJ=xe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},xe.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),CJ=xe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},xe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),AJ=xe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},xe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),EJ=xe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},xe.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),xe.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),IJ=()=>{let[s,t]=xe.useState(document.hidden);return xe.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),s},yC=1,PJ=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let r=this.subscribers.indexOf(t);this.subscribers.splice(r,1)}),this.publish=t=>{this.subscribers.forEach(r=>r(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var r;let{message:n,...a}=t,i=typeof(t==null?void 0:t.id)=="number"||((r=t.id)==null?void 0:r.length)>0?t.id:yC++,o=this.toasts.find(c=>c.id===i),l=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),o?this.toasts=this.toasts.map(c=>c.id===i?(this.publish({...c,...t,id:i,title:n}),{...c,...t,id:i,dismissible:l,title:n}):c):this.addToast({title:n,...a,dismissible:l,id:i}),i},this.dismiss=t=>(this.dismissedToasts.add(t),t||this.toasts.forEach(r=>{this.subscribers.forEach(n=>n({id:r.id,dismiss:!0}))}),this.subscribers.forEach(r=>r({id:t,dismiss:!0})),t),this.message=(t,r)=>this.create({...r,message:t}),this.error=(t,r)=>this.create({...r,message:t,type:"error"}),this.success=(t,r)=>this.create({...r,type:"success",message:t}),this.info=(t,r)=>this.create({...r,type:"info",message:t}),this.warning=(t,r)=>this.create({...r,type:"warning",message:t}),this.loading=(t,r)=>this.create({...r,type:"loading",message:t}),this.promise=(t,r)=>{if(!r)return;let n;r.loading!==void 0&&(n=this.create({...r,promise:t,type:"loading",message:r.loading,description:typeof r.description!="function"?r.description:void 0}));let a=t instanceof Promise?t:t(),i=n!==void 0,o,l=a.then(async d=>{if(o=["resolve",d],xe.isValidElement(d))i=!1,this.create({id:n,type:"default",message:d});else if(kJ(d)&&!d.ok){i=!1;let u=typeof r.error=="function"?await r.error(`HTTP error! status: ${d.status}`):r.error,h=typeof r.description=="function"?await r.description(`HTTP error! status: ${d.status}`):r.description;this.create({id:n,type:"error",message:u,description:h})}else if(r.success!==void 0){i=!1;let u=typeof r.success=="function"?await r.success(d):r.success,h=typeof r.description=="function"?await r.description(d):r.description;this.create({id:n,type:"success",message:u,description:h})}}).catch(async d=>{if(o=["reject",d],r.error!==void 0){i=!1;let u=typeof r.error=="function"?await r.error(d):r.error,h=typeof r.description=="function"?await r.description(d):r.description;this.create({id:n,type:"error",message:u,description:h})}}).finally(()=>{var d;i&&(this.dismiss(n),n=void 0),(d=r.finally)==null||d.call(r)}),c=()=>new Promise((d,u)=>l.then(()=>o[0]==="reject"?u(o[1]):d(o[1])).catch(u));return typeof n!="string"&&typeof n!="number"?{unwrap:c}:Object.assign(n,{unwrap:c})},this.custom=(t,r)=>{let n=(r==null?void 0:r.id)||yC++;return this.create({jsx:t(n),id:n,...r}),n},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Xl=new PJ,_J=(s,t)=>{let r=(t==null?void 0:t.id)||yC++;return Xl.addToast({title:s,...t,id:r}),r},kJ=s=>s&&typeof s=="object"&&"ok"in s&&typeof s.ok=="boolean"&&"status"in s&&typeof s.status=="number",TJ=_J,DJ=()=>Xl.toasts,OJ=()=>Xl.getActiveToasts(),ze=Object.assign(TJ,{success:Xl.success,info:Xl.info,warning:Xl.warning,error:Xl.error,custom:Xl.custom,message:Xl.message,promise:Xl.promise,dismiss:Xl.dismiss,loading:Xl.loading},{getHistory:DJ,getToasts:OJ});function RJ(s,{insertAt:t}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=s:n.appendChild(document.createTextNode(s))}RJ(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Ky(s){return s.label!==void 0}var FJ=3,MJ="32px",LJ="16px",N6=4e3,$J=356,BJ=14,UJ=20,zJ=200;function fd(...s){return s.filter(Boolean).join(" ")}function qJ(s){let[t,r]=s.split("-"),n=[];return t&&n.push(t),r&&n.push(r),n}var VJ=s=>{var t,r,n,a,i,o,l,c,d,u,h;let{invert:f,toast:m,unstyled:p,interacting:g,setHeights:v,visibleToasts:y,heights:j,index:b,toasts:w,expanded:N,removeToast:C,defaultRichColors:S,closeButton:_,style:k,cancelButtonStyle:F,actionButtonStyle:A,className:T="",descriptionClassName:V="",duration:M,position:G,gap:L,loadingIcon:J,expandByDefault:z,classNames:U,icons:oe,closeButtonAriaLabel:Q="Close toast",pauseWhenPageIsHidden:P}=s,[q,D]=xe.useState(null),[se,he]=xe.useState(null),[be,pe]=xe.useState(!1),[Ae,Ee]=xe.useState(!1),[$e,O]=xe.useState(!1),[te,re]=xe.useState(!1),[le,Z]=xe.useState(!1),[K,X]=xe.useState(0),[ce,Y]=xe.useState(0),ue=xe.useRef(m.duration||M||N6),ve=xe.useRef(null),Le=xe.useRef(null),Me=b===0,tt=b+1<=y,fe=m.type,ct=m.dismissible!==!1,dt=m.className||"",pt=m.descriptionClassName||"",qe=xe.useMemo(()=>j.findIndex(ft=>ft.toastId===m.id)||0,[j,m.id]),mt=xe.useMemo(()=>{var ft;return(ft=m.closeButton)!=null?ft:_},[m.closeButton,_]),Rt=xe.useMemo(()=>m.duration||M||N6,[m.duration,M]),_e=xe.useRef(0),Xe=xe.useRef(0),At=xe.useRef(0),st=xe.useRef(null),[$t,fs]=G.split("-"),zt=xe.useMemo(()=>j.reduce((ft,He,Je)=>Je>=qe?ft:ft+He.height,0),[j,qe]),St=IJ(),js=m.invert||f,et=fe==="loading";Xe.current=xe.useMemo(()=>qe*L+zt,[qe,zt]),xe.useEffect(()=>{ue.current=Rt},[Rt]),xe.useEffect(()=>{pe(!0)},[]),xe.useEffect(()=>{let ft=Le.current;if(ft){let He=ft.getBoundingClientRect().height;return Y(He),v(Je=>[{toastId:m.id,height:He,position:m.position},...Je]),()=>v(Je=>Je.filter(It=>It.toastId!==m.id))}},[v,m.id]),xe.useLayoutEffect(()=>{if(!be)return;let ft=Le.current,He=ft.style.height;ft.style.height="auto";let Je=ft.getBoundingClientRect().height;ft.style.height=He,Y(Je),v(It=>It.find(Gt=>Gt.toastId===m.id)?It.map(Gt=>Gt.toastId===m.id?{...Gt,height:Je}:Gt):[{toastId:m.id,height:Je,position:m.position},...It])},[be,m.title,m.description,v,m.id]);let lt=xe.useCallback(()=>{Ee(!0),X(Xe.current),v(ft=>ft.filter(He=>He.toastId!==m.id)),setTimeout(()=>{C(m)},zJ)},[m,C,v,Xe]);xe.useEffect(()=>{if(m.promise&&fe==="loading"||m.duration===1/0||m.type==="loading")return;let ft;return N||g||P&&St?(()=>{if(At.current<_e.current){let He=new Date().getTime()-_e.current;ue.current=ue.current-He}At.current=new Date().getTime()})():ue.current!==1/0&&(_e.current=new Date().getTime(),ft=setTimeout(()=>{var He;(He=m.onAutoClose)==null||He.call(m,m),lt()},ue.current)),()=>clearTimeout(ft)},[N,g,m,fe,P,St,lt]),xe.useEffect(()=>{m.delete&&lt()},[lt,m.delete]);function Fe(){var ft,He,Je;return oe!=null&&oe.loading?xe.createElement("div",{className:fd(U==null?void 0:U.loader,(ft=m==null?void 0:m.classNames)==null?void 0:ft.loader,"sonner-loader"),"data-visible":fe==="loading"},oe.loading):J?xe.createElement("div",{className:fd(U==null?void 0:U.loader,(He=m==null?void 0:m.classNames)==null?void 0:He.loader,"sonner-loader"),"data-visible":fe==="loading"},J):xe.createElement(NJ,{className:fd(U==null?void 0:U.loader,(Je=m==null?void 0:m.classNames)==null?void 0:Je.loader),visible:fe==="loading"})}return xe.createElement("li",{tabIndex:0,ref:Le,className:fd(T,dt,U==null?void 0:U.toast,(t=m==null?void 0:m.classNames)==null?void 0:t.toast,U==null?void 0:U.default,U==null?void 0:U[fe],(r=m==null?void 0:m.classNames)==null?void 0:r[fe]),"data-sonner-toast":"","data-rich-colors":(n=m.richColors)!=null?n:S,"data-styled":!(m.jsx||m.unstyled||p),"data-mounted":be,"data-promise":!!m.promise,"data-swiped":le,"data-removed":Ae,"data-visible":tt,"data-y-position":$t,"data-x-position":fs,"data-index":b,"data-front":Me,"data-swiping":$e,"data-dismissible":ct,"data-type":fe,"data-invert":js,"data-swipe-out":te,"data-swipe-direction":se,"data-expanded":!!(N||z&&be),style:{"--index":b,"--toasts-before":b,"--z-index":w.length-b,"--offset":`${Ae?K:Xe.current}px`,"--initial-height":z?"auto":`${ce}px`,...k,...m.style},onDragEnd:()=>{O(!1),D(null),st.current=null},onPointerDown:ft=>{et||!ct||(ve.current=new Date,X(Xe.current),ft.target.setPointerCapture(ft.pointerId),ft.target.tagName!=="BUTTON"&&(O(!0),st.current={x:ft.clientX,y:ft.clientY}))},onPointerUp:()=>{var ft,He,Je,It;if(te||!ct)return;st.current=null;let Gt=Number(((ft=Le.current)==null?void 0:ft.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),qt=Number(((He=Le.current)==null?void 0:He.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),As=new Date().getTime()-((Je=ve.current)==null?void 0:Je.getTime()),Ht=q==="x"?Gt:qt,xs=Math.abs(Ht)/As;if(Math.abs(Ht)>=UJ||xs>.11){X(Xe.current),(It=m.onDismiss)==null||It.call(m,m),he(q==="x"?Gt>0?"right":"left":qt>0?"down":"up"),lt(),re(!0),Z(!1);return}O(!1),D(null)},onPointerMove:ft=>{var He,Je,It,Gt;if(!st.current||!ct||((He=window.getSelection())==null?void 0:He.toString().length)>0)return;let qt=ft.clientY-st.current.y,As=ft.clientX-st.current.x,Ht=(Je=s.swipeDirections)!=null?Je:qJ(G);!q&&(Math.abs(As)>1||Math.abs(qt)>1)&&D(Math.abs(As)>Math.abs(qt)?"x":"y");let xs={x:0,y:0};q==="y"?(Ht.includes("top")||Ht.includes("bottom"))&&(Ht.includes("top")&&qt<0||Ht.includes("bottom")&&qt>0)&&(xs.y=qt):q==="x"&&(Ht.includes("left")||Ht.includes("right"))&&(Ht.includes("left")&&As<0||Ht.includes("right")&&As>0)&&(xs.x=As),(Math.abs(xs.x)>0||Math.abs(xs.y)>0)&&Z(!0),(It=Le.current)==null||It.style.setProperty("--swipe-amount-x",`${xs.x}px`),(Gt=Le.current)==null||Gt.style.setProperty("--swipe-amount-y",`${xs.y}px`)}},mt&&!m.jsx?xe.createElement("button",{"aria-label":Q,"data-disabled":et,"data-close-button":!0,onClick:et||!ct?()=>{}:()=>{var ft;lt(),(ft=m.onDismiss)==null||ft.call(m,m)},className:fd(U==null?void 0:U.closeButton,(a=m==null?void 0:m.classNames)==null?void 0:a.closeButton)},(i=oe==null?void 0:oe.close)!=null?i:EJ):null,m.jsx||x.isValidElement(m.title)?m.jsx?m.jsx:typeof m.title=="function"?m.title():m.title:xe.createElement(xe.Fragment,null,fe||m.icon||m.promise?xe.createElement("div",{"data-icon":"",className:fd(U==null?void 0:U.icon,(o=m==null?void 0:m.classNames)==null?void 0:o.icon)},m.promise||m.type==="loading"&&!m.icon?m.icon||Fe():null,m.type!=="loading"?m.icon||(oe==null?void 0:oe[fe])||jJ(fe):null):null,xe.createElement("div",{"data-content":"",className:fd(U==null?void 0:U.content,(l=m==null?void 0:m.classNames)==null?void 0:l.content)},xe.createElement("div",{"data-title":"",className:fd(U==null?void 0:U.title,(c=m==null?void 0:m.classNames)==null?void 0:c.title)},typeof m.title=="function"?m.title():m.title),m.description?xe.createElement("div",{"data-description":"",className:fd(V,pt,U==null?void 0:U.description,(d=m==null?void 0:m.classNames)==null?void 0:d.description)},typeof m.description=="function"?m.description():m.description):null),x.isValidElement(m.cancel)?m.cancel:m.cancel&&Ky(m.cancel)?xe.createElement("button",{"data-button":!0,"data-cancel":!0,style:m.cancelButtonStyle||F,onClick:ft=>{var He,Je;Ky(m.cancel)&&ct&&((Je=(He=m.cancel).onClick)==null||Je.call(He,ft),lt())},className:fd(U==null?void 0:U.cancelButton,(u=m==null?void 0:m.classNames)==null?void 0:u.cancelButton)},m.cancel.label):null,x.isValidElement(m.action)?m.action:m.action&&Ky(m.action)?xe.createElement("button",{"data-button":!0,"data-action":!0,style:m.actionButtonStyle||A,onClick:ft=>{var He,Je;Ky(m.action)&&((Je=(He=m.action).onClick)==null||Je.call(He,ft),!ft.defaultPrevented&&lt())},className:fd(U==null?void 0:U.actionButton,(h=m==null?void 0:m.classNames)==null?void 0:h.actionButton)},m.action.label):null))};function w6(){if(typeof window>"u"||typeof document>"u")return"ltr";let s=document.documentElement.getAttribute("dir");return s==="auto"||!s?window.getComputedStyle(document.documentElement).direction:s}function WJ(s,t){let r={};return[s,t].forEach((n,a)=>{let i=a===1,o=i?"--mobile-offset":"--offset",l=i?LJ:MJ;function c(d){["top","right","bottom","left"].forEach(u=>{r[`${o}-${u}`]=typeof d=="number"?`${d}px`:d})}typeof n=="number"||typeof n=="string"?c(n):typeof n=="object"?["top","right","bottom","left"].forEach(d=>{n[d]===void 0?r[`${o}-${d}`]=l:r[`${o}-${d}`]=typeof n[d]=="number"?`${n[d]}px`:n[d]}):c(l)}),r}var HJ=x.forwardRef(function(s,t){let{invert:r,position:n="bottom-right",hotkey:a=["altKey","KeyT"],expand:i,closeButton:o,className:l,offset:c,mobileOffset:d,theme:u="light",richColors:h,duration:f,style:m,visibleToasts:p=FJ,toastOptions:g,dir:v=w6(),gap:y=BJ,loadingIcon:j,icons:b,containerAriaLabel:w="Notifications",pauseWhenPageIsHidden:N}=s,[C,S]=xe.useState([]),_=xe.useMemo(()=>Array.from(new Set([n].concat(C.filter(P=>P.position).map(P=>P.position)))),[C,n]),[k,F]=xe.useState([]),[A,T]=xe.useState(!1),[V,M]=xe.useState(!1),[G,L]=xe.useState(u!=="system"?u:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),J=xe.useRef(null),z=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),U=xe.useRef(null),oe=xe.useRef(!1),Q=xe.useCallback(P=>{S(q=>{var D;return(D=q.find(se=>se.id===P.id))!=null&&D.delete||Xl.dismiss(P.id),q.filter(({id:se})=>se!==P.id)})},[]);return xe.useEffect(()=>Xl.subscribe(P=>{if(P.dismiss){S(q=>q.map(D=>D.id===P.id?{...D,delete:!0}:D));return}setTimeout(()=>{ey.flushSync(()=>{S(q=>{let D=q.findIndex(se=>se.id===P.id);return D!==-1?[...q.slice(0,D),{...q[D],...P},...q.slice(D+1)]:[P,...q]})})})}),[]),xe.useEffect(()=>{if(u!=="system"){L(u);return}if(u==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?L("dark"):L("light")),typeof window>"u")return;let P=window.matchMedia("(prefers-color-scheme: dark)");try{P.addEventListener("change",({matches:q})=>{L(q?"dark":"light")})}catch{P.addListener(({matches:D})=>{try{L(D?"dark":"light")}catch(se){console.error(se)}})}},[u]),xe.useEffect(()=>{C.length<=1&&T(!1)},[C]),xe.useEffect(()=>{let P=q=>{var D,se;a.every(he=>q[he]||q.code===he)&&(T(!0),(D=J.current)==null||D.focus()),q.code==="Escape"&&(document.activeElement===J.current||(se=J.current)!=null&&se.contains(document.activeElement))&&T(!1)};return document.addEventListener("keydown",P),()=>document.removeEventListener("keydown",P)},[a]),xe.useEffect(()=>{if(J.current)return()=>{U.current&&(U.current.focus({preventScroll:!0}),U.current=null,oe.current=!1)}},[J.current]),xe.createElement("section",{ref:t,"aria-label":`${w} ${z}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},_.map((P,q)=>{var D;let[se,he]=P.split("-");return C.length?xe.createElement("ol",{key:P,dir:v==="auto"?w6():v,tabIndex:-1,ref:J,className:l,"data-sonner-toaster":!0,"data-theme":G,"data-y-position":se,"data-lifted":A&&C.length>1&&!i,"data-x-position":he,style:{"--front-toast-height":`${((D=k[0])==null?void 0:D.height)||0}px`,"--width":`${$J}px`,"--gap":`${y}px`,...m,...WJ(c,d)},onBlur:be=>{oe.current&&!be.currentTarget.contains(be.relatedTarget)&&(oe.current=!1,U.current&&(U.current.focus({preventScroll:!0}),U.current=null))},onFocus:be=>{be.target instanceof HTMLElement&&be.target.dataset.dismissible==="false"||oe.current||(oe.current=!0,U.current=be.relatedTarget)},onMouseEnter:()=>T(!0),onMouseMove:()=>T(!0),onMouseLeave:()=>{V||T(!1)},onDragEnd:()=>T(!1),onPointerDown:be=>{be.target instanceof HTMLElement&&be.target.dataset.dismissible==="false"||M(!0)},onPointerUp:()=>M(!1)},C.filter(be=>!be.position&&q===0||be.position===P).map((be,pe)=>{var Ae,Ee;return xe.createElement(VJ,{key:be.id,icons:b,index:pe,toast:be,defaultRichColors:h,duration:(Ae=g==null?void 0:g.duration)!=null?Ae:f,className:g==null?void 0:g.className,descriptionClassName:g==null?void 0:g.descriptionClassName,invert:r,visibleToasts:p,closeButton:(Ee=g==null?void 0:g.closeButton)!=null?Ee:o,interacting:V,position:P,style:g==null?void 0:g.style,unstyled:g==null?void 0:g.unstyled,classNames:g==null?void 0:g.classNames,cancelButtonStyle:g==null?void 0:g.cancelButtonStyle,actionButtonStyle:g==null?void 0:g.actionButtonStyle,removeToast:Q,toasts:C.filter($e=>$e.position==be.position),heights:k.filter($e=>$e.position==be.position),setHeights:F,expandByDefault:i,gap:y,loadingIcon:j,expanded:A,pauseWhenPageIsHidden:N,swipeDirections:s.swipeDirections})})):null}))});const GJ=({...s})=>{const{theme:t="system"}=yJ();return e.jsx(HJ,{theme:t,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...s})},KJ={recentlyUsed:["Invoices","Expenses","Accounts Payable","AI Smart Insights","AI Powered Features","Client Portal","Bank Accounts & Reconciliation","Enhanced Financial Reports","Advanced Analytics Dashboard","AI Financial Coach","Fixed Assets"]},S6=[{name:"Dashboard",icon:sN,href:"/dashboard",favorite:!0},{name:"Sales & Invoicing",icon:Gu,href:"/dashboard/sales",badge:"Core"},{name:"Point of Sale",icon:$a,href:"/dashboard/pos",badge:"New",favorite:!0},{name:"Expenses & Purchases",icon:lh,href:"/dashboard/expenses",favorite:!0,recent:!0},{name:"Purchase Orders",icon:CY,href:"/dashboard/purchase-orders",badge:"Procurement",favorite:!0},{name:"Accounts Payable",icon:iM,href:"/dashboard/enhanced-accounts-payable",badge:"Enhanced",favorite:!0},{name:"Supplier Portal",icon:vn,href:"/dashboard/supplier-portal",badge:"New",favorite:!0},{name:"Banking & Cash",icon:P5,href:"/dashboard/banking",favorite:!0},{name:"Inventory & Products",icon:Hr,href:"/dashboard/inventory"},{name:"Tax Management",icon:yn,href:"/dashboard/tax",badge:"Enhanced"},{name:"Tax Calculation",icon:yn,href:"/dashboard/tax-calculation",badge:"New"},{name:"Accounting",icon:Zt,href:"/dashboard/accounting",favorite:!0},{name:"Fixed Assets",icon:vn,href:"/dashboard/fixed-assets",badge:"Assets",favorite:!0},{name:"Journal Entries Hub",icon:ml,href:"/dashboard/journal-hub",badge:"New",favorite:!0},{name:"Approval Hub",icon:D5,href:"/dashboard/approval-hub",badge:"New",favorite:!0},{name:"Smart Ledger",icon:La,href:"/dashboard/enhanced-journal-management",badge:"Smart"},{name:"Reports & Analytics",icon:lr,href:"/dashboard/reports",favorite:!0},{name:"AI Insights",icon:sa,href:"/dashboard/ai-insights",badge:"AI",favorite:!0},{name:"AI Powered Features",icon:Za,href:"/dashboard/llama-ai",badge:"AI+",favorite:!0},{name:"Documents",icon:t1,href:"/dashboard/documents"},{name:"Companies",icon:vn,href:"/dashboard/companies"},{name:"Client Portal",icon:Sa,href:"/dashboard/clients",badge:"Portal",favorite:!0},{name:"Settings",icon:en,href:"/dashboard/settings"},{name:"Help & Support",icon:_5,href:"/dashboard/help-support"}];function YJ(){const s=pu(),{isCollapsed:t,setIsCollapsed:r}=C5(),[n,a]=x.useState(-1),{setFocusedElement:i}=fF();return x.useEffect(()=>{const o=l=>{var c,d,u;if((c=document.activeElement)!=null&&c.closest("[data-sidebar]")){const h=document.querySelectorAll("[data-sidebar-item]");if(l.key==="ArrowDown"){l.preventDefault();const f=Math.min(n+1,h.length-1);a(f),(d=h[f])==null||d.focus()}else if(l.key==="ArrowUp"){l.preventDefault();const f=Math.max(n-1,0);a(f),(u=h[f])==null||u.focus()}}};return document.addEventListener("keydown",o),()=>document.removeEventListener("keydown",o)},[n]),e.jsxs("div",{className:ns("fixed left-0 top-0 bg-sidebar border-r border-sidebar-border transition-all duration-300 z-40 hidden lg:flex lg:flex-col","h-screen min-h-screen max-h-screen","flex-shrink-0","lg:h-screen xl:h-screen 2xl:h-screen",t?"w-16":"w-64"),"data-sidebar":!0,role:"navigation","aria-label":"Main navigation",style:{height:"100vh",maxHeight:"100vh",minHeight:"100vh"},children:[e.jsx("div",{className:"p-4 border-b border-sidebar-border flex-shrink-0",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-primary rounded-lg flex items-center justify-center",children:e.jsx(sa,{className:"w-5 h-5 text-primary-foreground"})}),!t&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-sidebar-foreground",children:"UrutiIQ"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"AI Accounting"})]}),e.jsx("button",{onClick:()=>r(!t),className:"ml-auto p-1 hover:bg-sidebar-accent/50 rounded focus:ring-2 focus:ring-cyan-500 focus:ring-offset-2","aria-label":t?"Expand sidebar":"Collapse sidebar","aria-expanded":!t,children:e.jsx(Tm,{className:ns("w-4 h-4 transition-transform",t?"rotate-0":"rotate-180")})})]})}),!t&&e.jsxs("div",{className:"px-3 py-2 border-b border-sidebar-border flex-shrink-0",children:[e.jsx("h3",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Quick Access"}),e.jsx("div",{className:"space-y-1",role:"list","aria-label":"Quick access items",children:KJ.recentlyUsed.slice(0,4).map(o=>{const l=S6.find(c=>c.name===o);return l?e.jsxs(yp,{to:l.href,className:"flex items-center gap-2 px-2 py-1.5 text-xs rounded-md hover:bg-sidebar-accent/30 text-muted-foreground hover:text-sidebar-foreground focus:ring-2 focus:ring-cyan-500 focus:ring-offset-1","data-sidebar-item":!0,role:"listitem","aria-label":`Quick access: ${o}`,onFocus:()=>i("quick-access"),children:[e.jsx(l.icon,{className:"w-3 h-3"}),e.jsx("span",{className:"truncate",children:o})]},o):null})})]}),e.jsx("nav",{className:"flex-1 overflow-y-auto px-3 py-4 space-y-1 sidebar-scrollbar min-h-0 max-h-full",role:"navigation","aria-label":"Main menu",children:S6.map(o=>{var c,d;const l=s.pathname===o.href||((c=o.href)==null?void 0:c.includes("?"))&&s.pathname===((d=o.href)==null?void 0:d.split("?")[0]);return e.jsxs(yp,{to:o.href,className:ns("flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-lg transition-colors focus:ring-2 focus:ring-cyan-500 focus:ring-offset-1",l?"bg-blue-100 text-blue-700 font-medium border-l-2 border-blue-500":"text-sidebar-foreground hover:bg-sidebar-accent/50 hover:text-sidebar-accent-foreground"),"data-sidebar-item":!0,"aria-current":l?"page":void 0,"aria-label":o.name,onFocus:()=>i("nav-item"),children:[e.jsx(o.icon,{className:"w-5 h-5 flex-shrink-0"}),!t&&e.jsx("span",{className:"flex-1",children:o.name})]},o.name)})}),e.jsx("div",{className:"p-4 border-t border-sidebar-border flex-shrink-0",children:t?e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{className:"w-8 h-8 bg-muted rounded-full flex items-center justify-center focus:ring-2 focus:ring-cyan-500 focus:ring-offset-1","aria-label":"User profile: John Doe","data-sidebar-item":!0,children:e.jsx("span",{className:"text-xs font-medium",children:"JD"})})}):e.jsx("div",{className:"bg-card p-3 rounded-lg border border-border",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-muted rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-medium",children:"JD"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:"John Doe"}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:"Senior Accountant"})]}),e.jsx("button",{className:"p-1 hover:bg-muted rounded focus:ring-2 focus:ring-cyan-500 focus:ring-offset-1","aria-label":"User settings","data-sidebar-item":!0,children:e.jsx(en,{className:"w-4 h-4"})})]})})})]})}function C6(s,t){if(typeof s=="function")return s(t);s!=null&&(s.current=t)}function JJ(...s){return t=>{let r=!1;const n=s.map(a=>{const i=C6(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():C6(s[a],null)}}}}var rN=x.forwardRef((s,t)=>{const{children:r,...n}=s,a=x.Children.toArray(r),i=a.find(QJ);if(i){const o=i.props.children,l=a.map(c=>c===i?x.Children.count(o)>1?x.Children.only(null):x.isValidElement(o)?o.props.children:null:c);return e.jsx(jC,{...n,ref:t,children:x.isValidElement(o)?x.cloneElement(o,void 0,l):null})}return e.jsx(jC,{...n,ref:t,children:r})});rN.displayName="Slot";var jC=x.forwardRef((s,t)=>{const{children:r,...n}=s;if(x.isValidElement(r)){const a=eX(r);return x.cloneElement(r,{...ZJ(n,r.props),ref:t?JJ(t,a):a})}return x.Children.count(r)>1?x.Children.only(null):null});jC.displayName="SlotClone";var XJ=({children:s})=>e.jsx(e.Fragment,{children:s});function QJ(s){return x.isValidElement(s)&&s.type===XJ}function ZJ(s,t){const r={...t};for(const n in t){const a=s[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...l)=>{i(...l),a(...l)}:a&&(r[n]=a):n==="style"?r[n]={...a,...i}:n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return{...s,...r}}function eX(s){var n,a;let t=(n=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}const rv=sy("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),I=x.forwardRef(({className:s,variant:t,size:r,asChild:n=!1,...a},i)=>{const o=n?rN:"button";return e.jsx(o,{className:ns(rv({variant:t,size:r,className:s})),ref:i,...a})});I.displayName="Button";var A6=1,tX=.9,sX=.8,rX=.17,Yw=.1,Jw=.999,nX=.9999,aX=.99,iX=/[\\\/_+.#"@\[\(\{&]/,oX=/[\\\/_+.#"@\[\(\{&]/g,lX=/[\s-]/,vM=/[\s-]/g;function bC(s,t,r,n,a,i,o){if(i===t.length)return a===s.length?A6:aX;var l=`${a},${i}`;if(o[l]!==void 0)return o[l];for(var c=n.charAt(i),d=r.indexOf(c,a),u=0,h,f,m,p;d>=0;)h=bC(s,t,r,n,d+1,i+1,o),h>u&&(d===a?h*=A6:iX.test(s.charAt(d-1))?(h*=sX,m=s.slice(a,d-1).match(oX),m&&a>0&&(h*=Math.pow(Jw,m.length))):lX.test(s.charAt(d-1))?(h*=tX,p=s.slice(a,d-1).match(vM),p&&a>0&&(h*=Math.pow(Jw,p.length))):(h*=rX,a>0&&(h*=Math.pow(Jw,d-a))),s.charAt(d)!==t.charAt(i)&&(h*=nX)),(h<Yw&&r.charAt(d-1)===n.charAt(i+1)||n.charAt(i+1)===n.charAt(i)&&r.charAt(d-1)!==n.charAt(i))&&(f=bC(s,t,r,n,d+1,i+2,o),f*Yw>h&&(h=f*Yw)),h>u&&(u=h),d=r.indexOf(c,d+1);return o[l]=u,u}function E6(s){return s.toLowerCase().replace(vM," ")}function cX(s,t,r){return s=r&&r.length>0?`${s+" "+r.join(" ")}`:s,bC(s,t,E6(s),E6(t),0,0,{})}var yM={exports:{}},jM={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wp=x;function dX(s,t){return s===t&&(s!==0||1/s===1/t)||s!==s&&t!==t}var uX=typeof Object.is=="function"?Object.is:dX,hX=wp.useState,mX=wp.useEffect,fX=wp.useLayoutEffect,xX=wp.useDebugValue;function pX(s,t){var r=t(),n=hX({inst:{value:r,getSnapshot:t}}),a=n[0].inst,i=n[1];return fX(function(){a.value=r,a.getSnapshot=t,Xw(a)&&i({inst:a})},[s,r,t]),mX(function(){return Xw(a)&&i({inst:a}),s(function(){Xw(a)&&i({inst:a})})},[s]),xX(r),r}function Xw(s){var t=s.getSnapshot;s=s.value;try{var r=t();return!uX(s,r)}catch{return!0}}function gX(s,t){return t()}var vX=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?gX:pX;jM.useSyncExternalStore=wp.useSyncExternalStore!==void 0?wp.useSyncExternalStore:vX;yM.exports=jM;var yX=yM.exports,Qg='[cmdk-group=""]',Qw='[cmdk-group-items=""]',jX='[cmdk-group-heading=""]',R5='[cmdk-item=""]',I6=`${R5}:not([aria-disabled="true"])`,NC="cmdk-item-select",pf="data-value",bX=(s,t,r)=>cX(s,t,r),bM=x.createContext(void 0),ry=()=>x.useContext(bM),NM=x.createContext(void 0),F5=()=>x.useContext(NM),wM=x.createContext(void 0),SM=x.forwardRef((s,t)=>{let r=Bx(()=>{var P,q;return{search:"",value:(q=(P=s.value)!=null?P:s.defaultValue)!=null?q:"",filtered:{count:0,items:new Map,groups:new Set}}}),n=Bx(()=>new Set),a=Bx(()=>new Map),i=Bx(()=>new Map),o=Bx(()=>new Set),l=CM(s),{label:c,children:d,value:u,onValueChange:h,filter:f,shouldFilter:m,loop:p,disablePointerSelection:g=!1,vimBindings:v=!0,...y}=s,j=Zx(),b=Zx(),w=Zx(),N=x.useRef(null),C=TX();Jf(()=>{if(u!==void 0){let P=u.trim();r.current.value=P,S.emit()}},[u]),Jf(()=>{C(6,V)},[]);let S=x.useMemo(()=>({subscribe:P=>(o.current.add(P),()=>o.current.delete(P)),snapshot:()=>r.current,setState:(P,q,D)=>{var se,he,be;if(!Object.is(r.current[P],q)){if(r.current[P]=q,P==="search")T(),F(),C(1,A);else if(P==="value"&&(D||C(5,V),((se=l.current)==null?void 0:se.value)!==void 0)){let pe=q??"";(be=(he=l.current).onValueChange)==null||be.call(he,pe);return}S.emit()}},emit:()=>{o.current.forEach(P=>P())}}),[]),_=x.useMemo(()=>({value:(P,q,D)=>{var se;q!==((se=i.current.get(P))==null?void 0:se.value)&&(i.current.set(P,{value:q,keywords:D}),r.current.filtered.items.set(P,k(q,D)),C(2,()=>{F(),S.emit()}))},item:(P,q)=>(n.current.add(P),q&&(a.current.has(q)?a.current.get(q).add(P):a.current.set(q,new Set([P]))),C(3,()=>{T(),F(),r.current.value||A(),S.emit()}),()=>{i.current.delete(P),n.current.delete(P),r.current.filtered.items.delete(P);let D=M();C(4,()=>{T(),(D==null?void 0:D.getAttribute("id"))===P&&A(),S.emit()})}),group:P=>(a.current.has(P)||a.current.set(P,new Set),()=>{i.current.delete(P),a.current.delete(P)}),filter:()=>l.current.shouldFilter,label:c||s["aria-label"],getDisablePointerSelection:()=>l.current.disablePointerSelection,listId:j,inputId:w,labelId:b,listInnerRef:N}),[]);function k(P,q){var D,se;let he=(se=(D=l.current)==null?void 0:D.filter)!=null?se:bX;return P?he(P,r.current.search,q):0}function F(){if(!r.current.search||l.current.shouldFilter===!1)return;let P=r.current.filtered.items,q=[];r.current.filtered.groups.forEach(se=>{let he=a.current.get(se),be=0;he.forEach(pe=>{let Ae=P.get(pe);be=Math.max(Ae,be)}),q.push([se,be])});let D=N.current;G().sort((se,he)=>{var be,pe;let Ae=se.getAttribute("id"),Ee=he.getAttribute("id");return((be=P.get(Ee))!=null?be:0)-((pe=P.get(Ae))!=null?pe:0)}).forEach(se=>{let he=se.closest(Qw);he?he.appendChild(se.parentElement===he?se:se.closest(`${Qw} > *`)):D.appendChild(se.parentElement===D?se:se.closest(`${Qw} > *`))}),q.sort((se,he)=>he[1]-se[1]).forEach(se=>{var he;let be=(he=N.current)==null?void 0:he.querySelector(`${Qg}[${pf}="${encodeURIComponent(se[0])}"]`);be==null||be.parentElement.appendChild(be)})}function A(){let P=G().find(D=>D.getAttribute("aria-disabled")!=="true"),q=P==null?void 0:P.getAttribute(pf);S.setState("value",q||void 0)}function T(){var P,q,D,se;if(!r.current.search||l.current.shouldFilter===!1){r.current.filtered.count=n.current.size;return}r.current.filtered.groups=new Set;let he=0;for(let be of n.current){let pe=(q=(P=i.current.get(be))==null?void 0:P.value)!=null?q:"",Ae=(se=(D=i.current.get(be))==null?void 0:D.keywords)!=null?se:[],Ee=k(pe,Ae);r.current.filtered.items.set(be,Ee),Ee>0&&he++}for(let[be,pe]of a.current)for(let Ae of pe)if(r.current.filtered.items.get(Ae)>0){r.current.filtered.groups.add(be);break}r.current.filtered.count=he}function V(){var P,q,D;let se=M();se&&(((P=se.parentElement)==null?void 0:P.firstChild)===se&&((D=(q=se.closest(Qg))==null?void 0:q.querySelector(jX))==null||D.scrollIntoView({block:"nearest"})),se.scrollIntoView({block:"nearest"}))}function M(){var P;return(P=N.current)==null?void 0:P.querySelector(`${R5}[aria-selected="true"]`)}function G(){var P;return Array.from(((P=N.current)==null?void 0:P.querySelectorAll(I6))||[])}function L(P){let q=G()[P];q&&S.setState("value",q.getAttribute(pf))}function J(P){var q;let D=M(),se=G(),he=se.findIndex(pe=>pe===D),be=se[he+P];(q=l.current)!=null&&q.loop&&(be=he+P<0?se[se.length-1]:he+P===se.length?se[0]:se[he+P]),be&&S.setState("value",be.getAttribute(pf))}function z(P){let q=M(),D=q==null?void 0:q.closest(Qg),se;for(;D&&!se;)D=P>0?_X(D,Qg):kX(D,Qg),se=D==null?void 0:D.querySelector(I6);se?S.setState("value",se.getAttribute(pf)):J(P)}let U=()=>L(G().length-1),oe=P=>{P.preventDefault(),P.metaKey?U():P.altKey?z(1):J(1)},Q=P=>{P.preventDefault(),P.metaKey?L(0):P.altKey?z(-1):J(-1)};return x.createElement(Tc.div,{ref:t,tabIndex:-1,...y,"cmdk-root":"",onKeyDown:P=>{var q;if((q=y.onKeyDown)==null||q.call(y,P),!P.defaultPrevented)switch(P.key){case"n":case"j":{v&&P.ctrlKey&&oe(P);break}case"ArrowDown":{oe(P);break}case"p":case"k":{v&&P.ctrlKey&&Q(P);break}case"ArrowUp":{Q(P);break}case"Home":{P.preventDefault(),L(0);break}case"End":{P.preventDefault(),U();break}case"Enter":if(!P.nativeEvent.isComposing&&P.keyCode!==229){P.preventDefault();let D=M();if(D){let se=new Event(NC);D.dispatchEvent(se)}}}}},x.createElement("label",{"cmdk-label":"",htmlFor:_.inputId,id:_.labelId,style:OX},c),nN(s,P=>x.createElement(NM.Provider,{value:S},x.createElement(bM.Provider,{value:_},P))))}),NX=x.forwardRef((s,t)=>{var r,n;let a=Zx(),i=x.useRef(null),o=x.useContext(wM),l=ry(),c=CM(s),d=(n=(r=c.current)==null?void 0:r.forceMount)!=null?n:o==null?void 0:o.forceMount;Jf(()=>{if(!d)return l.item(a,o==null?void 0:o.id)},[d]);let u=AM(a,i,[s.value,s.children,i],s.keywords),h=F5(),f=Xf(C=>C.value&&C.value===u.current),m=Xf(C=>d||l.filter()===!1?!0:C.search?C.filtered.items.get(a)>0:!0);x.useEffect(()=>{let C=i.current;if(!(!C||s.disabled))return C.addEventListener(NC,p),()=>C.removeEventListener(NC,p)},[m,s.onSelect,s.disabled]);function p(){var C,S;g(),(S=(C=c.current).onSelect)==null||S.call(C,u.current)}function g(){h.setState("value",u.current,!0)}if(!m)return null;let{disabled:v,value:y,onSelect:j,forceMount:b,keywords:w,...N}=s;return x.createElement(Tc.div,{ref:nv([i,t]),...N,id:a,"cmdk-item":"",role:"option","aria-disabled":!!v,"aria-selected":!!f,"data-disabled":!!v,"data-selected":!!f,onPointerMove:v||l.getDisablePointerSelection()?void 0:g,onClick:v?void 0:p},s.children)}),wX=x.forwardRef((s,t)=>{let{heading:r,children:n,forceMount:a,...i}=s,o=Zx(),l=x.useRef(null),c=x.useRef(null),d=Zx(),u=ry(),h=Xf(m=>a||u.filter()===!1?!0:m.search?m.filtered.groups.has(o):!0);Jf(()=>u.group(o),[]),AM(o,l,[s.value,s.heading,c]);let f=x.useMemo(()=>({id:o,forceMount:a}),[a]);return x.createElement(Tc.div,{ref:nv([l,t]),...i,"cmdk-group":"",role:"presentation",hidden:h?void 0:!0},r&&x.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:d},r),nN(s,m=>x.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?d:void 0},x.createElement(wM.Provider,{value:f},m))))}),SX=x.forwardRef((s,t)=>{let{alwaysRender:r,...n}=s,a=x.useRef(null),i=Xf(o=>!o.search);return!r&&!i?null:x.createElement(Tc.div,{ref:nv([a,t]),...n,"cmdk-separator":"",role:"separator"})}),CX=x.forwardRef((s,t)=>{let{onValueChange:r,...n}=s,a=s.value!=null,i=F5(),o=Xf(u=>u.search),l=Xf(u=>u.value),c=ry(),d=x.useMemo(()=>{var u;let h=(u=c.listInnerRef.current)==null?void 0:u.querySelector(`${R5}[${pf}="${encodeURIComponent(l)}"]`);return h==null?void 0:h.getAttribute("id")},[]);return x.useEffect(()=>{s.value!=null&&i.setState("search",s.value)},[s.value]),x.createElement(Tc.input,{ref:t,...n,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":d,id:c.inputId,type:"text",value:a?s.value:o,onChange:u=>{a||i.setState("search",u.target.value),r==null||r(u.target.value)}})}),AX=x.forwardRef((s,t)=>{let{children:r,label:n="Suggestions",...a}=s,i=x.useRef(null),o=x.useRef(null),l=ry();return x.useEffect(()=>{if(o.current&&i.current){let c=o.current,d=i.current,u,h=new ResizeObserver(()=>{u=requestAnimationFrame(()=>{let f=c.offsetHeight;d.style.setProperty("--cmdk-list-height",f.toFixed(1)+"px")})});return h.observe(c),()=>{cancelAnimationFrame(u),h.unobserve(c)}}},[]),x.createElement(Tc.div,{ref:nv([i,t]),...a,"cmdk-list":"",role:"listbox","aria-label":n,id:l.listId},nN(s,c=>x.createElement("div",{ref:nv([o,l.listInnerRef]),"cmdk-list-sizer":""},c)))}),EX=x.forwardRef((s,t)=>{let{open:r,onOpenChange:n,overlayClassName:a,contentClassName:i,container:o,...l}=s;return x.createElement(l5,{open:r,onOpenChange:n},x.createElement(c5,{container:o},x.createElement(Xv,{"cmdk-overlay":"",className:a}),x.createElement(Qv,{"aria-label":s.label,"cmdk-dialog":"",className:i},x.createElement(SM,{ref:t,...l}))))}),IX=x.forwardRef((s,t)=>Xf(r=>r.filtered.count===0)?x.createElement(Tc.div,{ref:t,...s,"cmdk-empty":"",role:"presentation"}):null),PX=x.forwardRef((s,t)=>{let{progress:r,children:n,label:a="Loading...",...i}=s;return x.createElement(Tc.div,{ref:t,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},nN(s,o=>x.createElement("div",{"aria-hidden":!0},o)))}),vg=Object.assign(SM,{List:AX,Item:NX,Input:CX,Group:wX,Separator:SX,Dialog:EX,Empty:IX,Loading:PX});function _X(s,t){let r=s.nextElementSibling;for(;r;){if(r.matches(t))return r;r=r.nextElementSibling}}function kX(s,t){let r=s.previousElementSibling;for(;r;){if(r.matches(t))return r;r=r.previousElementSibling}}function CM(s){let t=x.useRef(s);return Jf(()=>{t.current=s}),t}var Jf=typeof window>"u"?x.useEffect:x.useLayoutEffect;function Bx(s){let t=x.useRef();return t.current===void 0&&(t.current=s()),t}function nv(s){return t=>{s.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}function Xf(s){let t=F5(),r=()=>s(t.snapshot());return yX.useSyncExternalStore(t.subscribe,r,r)}function AM(s,t,r,n=[]){let a=x.useRef(),i=ry();return Jf(()=>{var o;let l=(()=>{var d;for(let u of r){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(d=u.current.textContent)==null?void 0:d.trim():a.current}})(),c=n.map(d=>d.trim());i.value(s,l,c),(o=t.current)==null||o.setAttribute(pf,l),a.current=l}),a}var TX=()=>{let[s,t]=x.useState(),r=Bx(()=>new Map);return Jf(()=>{r.current.forEach(n=>n()),r.current=new Map},[s]),(n,a)=>{r.current.set(n,a),t({})}};function DX(s){let t=s.type;return typeof t=="function"?t(s.props):"render"in t?t.render(s.props):s}function nN({asChild:s,children:t},r){return s&&x.isValidElement(t)?x.cloneElement(DX(t),{ref:t.ref},r(t.props.children)):r(t)}var OX={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function ts({...s}){return e.jsx(l5,{"data-slot":"dialog",...s})}function ki({...s}){return e.jsx(LR,{"data-slot":"dialog-trigger",...s})}function RX({...s}){return e.jsx(c5,{"data-slot":"dialog-portal",...s})}const EM=x.forwardRef(({className:s,...t},r)=>e.jsx(Xv,{ref:r,"data-slot":"dialog-overlay",className:ns("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...t}));EM.displayName=Xv.displayName;const ss=x.forwardRef(({className:s,children:t,showCloseButton:r=!0,...n},a)=>e.jsxs(RX,{"data-slot":"dialog-portal",children:[e.jsx(EM,{}),e.jsxs(Qv,{ref:a,"data-slot":"dialog-content",className:ns("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] max-w-screen-xl translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200",s),...n,children:[t,r&&e.jsxs(WW,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[e.jsx(ma,{}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ss.displayName=Qv.displayName;function as({className:s,...t}){return e.jsx("div",{"data-slot":"dialog-header",className:ns("flex flex-col gap-2 text-center sm:text-left",s),...t})}function Xr({className:s,...t}){return e.jsx("div",{"data-slot":"dialog-footer",className:ns("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",s),...t})}function is({className:s,...t}){return e.jsx(d5,{"data-slot":"dialog-title",className:ns("text-lg leading-none font-semibold",s),...t})}function Ks({className:s,...t}){return e.jsx(u5,{"data-slot":"dialog-description",className:ns("text-muted-foreground text-sm",s),...t})}function FX({className:s,...t}){return e.jsx(vg,{"data-slot":"command",className:ns("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",s),...t})}function MX({className:s,...t}){return e.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[e.jsx(Rn,{className:"size-4 shrink-0 opacity-50"}),e.jsx(vg.Input,{"data-slot":"command-input",className:ns("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",s),...t})]})}function LX({className:s,...t}){return e.jsx(vg.List,{"data-slot":"command-list",className:ns("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",s),...t})}function $X({...s}){return e.jsx(vg.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...s})}function Zw({className:s,...t}){return e.jsx(vg.Group,{"data-slot":"command-group",className:ns("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",s),...t})}function e2({className:s,...t}){return e.jsx(vg.Item,{"data-slot":"command-item",className:ns("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...t})}function Sm(s,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(s==null||s(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function P6(s,t){if(typeof s=="function")return s(t);s!=null&&(s.current=t)}function IM(...s){return t=>{let r=!1;const n=s.map(a=>{const i=P6(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():P6(s[a],null)}}}}function yg(...s){return x.useCallback(IM(...s),s)}function BX(s,t=[]){let r=[];function n(i,o){const l=x.createContext(o),c=r.length;r=[...r,o];const d=h=>{var y;const{scope:f,children:m,...p}=h,g=((y=f==null?void 0:f[s])==null?void 0:y[c])||l,v=x.useMemo(()=>p,Object.values(p));return e.jsx(g.Provider,{value:v,children:m})};d.displayName=i+"Provider";function u(h,f){var g;const m=((g=f==null?void 0:f[s])==null?void 0:g[c])||l,p=x.useContext(m);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[d,u]}const a=()=>{const i=r.map(o=>x.createContext(o));return function(l){const c=(l==null?void 0:l[s])||i;return x.useMemo(()=>({[`__scope${s}`]:{...l,[s]:c}}),[l,c])}};return a.scopeName=s,[n,UX(a,...t)]}function UX(...s){const t=s[0];if(s.length===1)return t;const r=()=>{const n=s.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=n.reduce((l,{useScope:c,scopeName:d})=>{const h=c(i)[`__scope${d}`];return{...l,...h}},{});return x.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}var M5=x.forwardRef((s,t)=>{const{children:r,...n}=s,a=x.Children.toArray(r),i=a.find(qX);if(i){const o=i.props.children,l=a.map(c=>c===i?x.Children.count(o)>1?x.Children.only(null):x.isValidElement(o)?o.props.children:null:c);return e.jsx(wC,{...n,ref:t,children:x.isValidElement(o)?x.cloneElement(o,void 0,l):null})}return e.jsx(wC,{...n,ref:t,children:r})});M5.displayName="Slot";var wC=x.forwardRef((s,t)=>{const{children:r,...n}=s;if(x.isValidElement(r)){const a=WX(r);return x.cloneElement(r,{...VX(n,r.props),ref:t?IM(t,a):a})}return x.Children.count(r)>1?x.Children.only(null):null});wC.displayName="SlotClone";var zX=({children:s})=>e.jsx(e.Fragment,{children:s});function qX(s){return x.isValidElement(s)&&s.type===zX}function VX(s,t){const r={...t};for(const n in t){const a=s[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...l)=>{i(...l),a(...l)}:a&&(r[n]=a):n==="style"?r[n]={...a,...i}:n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return{...s,...r}}function WX(s){var n,a;let t=(n=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}var HX=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],jg=HX.reduce((s,t)=>{const r=x.forwardRef((n,a)=>{const{asChild:i,...o}=n,l=i?M5:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(l,{...o,ref:a})});return r.displayName=`Primitive.${t}`,{...s,[t]:r}},{});function GX(s,t){s&&$m.flushSync(()=>s.dispatchEvent(t))}function Qf(s){const t=x.useRef(s);return x.useEffect(()=>{t.current=s}),x.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function KX(s,t=globalThis==null?void 0:globalThis.document){const r=Qf(s);x.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var YX="DismissableLayer",SC="dismissableLayer.update",JX="dismissableLayer.pointerDownOutside",XX="dismissableLayer.focusOutside",_6,PM=x.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),_M=x.forwardRef((s,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:o,onDismiss:l,...c}=s,d=x.useContext(PM),[u,h]=x.useState(null),f=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=x.useState({}),p=yg(t,S=>h(S)),g=Array.from(d.layers),[v]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),y=g.indexOf(v),j=u?g.indexOf(u):-1,b=d.layersWithOutsidePointerEventsDisabled.size>0,w=j>=y,N=eQ(S=>{const _=S.target,k=[...d.branches].some(F=>F.contains(_));!w||k||(a==null||a(S),o==null||o(S),S.defaultPrevented||l==null||l())},f),C=tQ(S=>{const _=S.target;[...d.branches].some(F=>F.contains(_))||(i==null||i(S),o==null||o(S),S.defaultPrevented||l==null||l())},f);return KX(S=>{j===d.layers.size-1&&(n==null||n(S),!S.defaultPrevented&&l&&(S.preventDefault(),l()))},f),x.useEffect(()=>{if(u)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(_6=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(u)),d.layers.add(u),k6(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=_6)}},[u,f,r,d]),x.useEffect(()=>()=>{u&&(d.layers.delete(u),d.layersWithOutsidePointerEventsDisabled.delete(u),k6())},[u,d]),x.useEffect(()=>{const S=()=>m({});return document.addEventListener(SC,S),()=>document.removeEventListener(SC,S)},[]),e.jsx(jg.div,{...c,ref:p,style:{pointerEvents:b?w?"auto":"none":void 0,...s.style},onFocusCapture:Sm(s.onFocusCapture,C.onFocusCapture),onBlurCapture:Sm(s.onBlurCapture,C.onBlurCapture),onPointerDownCapture:Sm(s.onPointerDownCapture,N.onPointerDownCapture)})});_M.displayName=YX;var QX="DismissableLayerBranch",ZX=x.forwardRef((s,t)=>{const r=x.useContext(PM),n=x.useRef(null),a=yg(t,n);return x.useEffect(()=>{const i=n.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),e.jsx(jg.div,{...s,ref:a})});ZX.displayName=QX;function eQ(s,t=globalThis==null?void 0:globalThis.document){const r=Qf(s),n=x.useRef(!1),a=x.useRef(()=>{});return x.useEffect(()=>{const i=l=>{if(l.target&&!n.current){let c=function(){kM(JX,r,d,{discrete:!0})};const d={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=c,t.addEventListener("click",a.current,{once:!0})):c()}else t.removeEventListener("click",a.current);n.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",i),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function tQ(s,t=globalThis==null?void 0:globalThis.document){const r=Qf(s),n=x.useRef(!1);return x.useEffect(()=>{const a=i=>{i.target&&!n.current&&kM(XX,r,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function k6(){const s=new CustomEvent(SC);document.dispatchEvent(s)}function kM(s,t,r,{discrete:n}){const a=r.originalEvent.target,i=new CustomEvent(s,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(s,t,{once:!0}),n?GX(a,i):a.dispatchEvent(i)}var t2=0;function sQ(){x.useEffect(()=>{const s=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",s[0]??T6()),document.body.insertAdjacentElement("beforeend",s[1]??T6()),t2++,()=>{t2===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),t2--}},[])}function T6(){const s=document.createElement("span");return s.setAttribute("data-radix-focus-guard",""),s.tabIndex=0,s.style.outline="none",s.style.opacity="0",s.style.position="fixed",s.style.pointerEvents="none",s}var s2="focusScope.autoFocusOnMount",r2="focusScope.autoFocusOnUnmount",D6={bubbles:!1,cancelable:!0},rQ="FocusScope",TM=x.forwardRef((s,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:i,...o}=s,[l,c]=x.useState(null),d=Qf(a),u=Qf(i),h=x.useRef(null),f=yg(t,g=>c(g)),m=x.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;x.useEffect(()=>{if(n){let g=function(b){if(m.paused||!l)return;const w=b.target;l.contains(w)?h.current=w:qh(h.current,{select:!0})},v=function(b){if(m.paused||!l)return;const w=b.relatedTarget;w!==null&&(l.contains(w)||qh(h.current,{select:!0}))},y=function(b){if(document.activeElement===document.body)for(const N of b)N.removedNodes.length>0&&qh(l)};document.addEventListener("focusin",g),document.addEventListener("focusout",v);const j=new MutationObserver(y);return l&&j.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",v),j.disconnect()}}},[n,l,m.paused]),x.useEffect(()=>{if(l){R6.add(m);const g=document.activeElement;if(!l.contains(g)){const y=new CustomEvent(s2,D6);l.addEventListener(s2,d),l.dispatchEvent(y),y.defaultPrevented||(nQ(cQ(DM(l)),{select:!0}),document.activeElement===g&&qh(l))}return()=>{l.removeEventListener(s2,d),setTimeout(()=>{const y=new CustomEvent(r2,D6);l.addEventListener(r2,u),l.dispatchEvent(y),y.defaultPrevented||qh(g??document.body,{select:!0}),l.removeEventListener(r2,u),R6.remove(m)},0)}}},[l,d,u,m]);const p=x.useCallback(g=>{if(!r&&!n||m.paused)return;const v=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,y=document.activeElement;if(v&&y){const j=g.currentTarget,[b,w]=aQ(j);b&&w?!g.shiftKey&&y===w?(g.preventDefault(),r&&qh(b,{select:!0})):g.shiftKey&&y===b&&(g.preventDefault(),r&&qh(w,{select:!0})):y===j&&g.preventDefault()}},[r,n,m.paused]);return e.jsx(jg.div,{tabIndex:-1,...o,ref:f,onKeyDown:p})});TM.displayName=rQ;function nQ(s,{select:t=!1}={}){const r=document.activeElement;for(const n of s)if(qh(n,{select:t}),document.activeElement!==r)return}function aQ(s){const t=DM(s),r=O6(t,s),n=O6(t.reverse(),s);return[r,n]}function DM(s){const t=[],r=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function O6(s,t){for(const r of s)if(!iQ(r,{upTo:t}))return r}function iQ(s,{upTo:t}){if(getComputedStyle(s).visibility==="hidden")return!0;for(;s;){if(t!==void 0&&s===t)return!1;if(getComputedStyle(s).display==="none")return!0;s=s.parentElement}return!1}function oQ(s){return s instanceof HTMLInputElement&&"select"in s}function qh(s,{select:t=!1}={}){if(s&&s.focus){const r=document.activeElement;s.focus({preventScroll:!0}),s!==r&&oQ(s)&&t&&s.select()}}var R6=lQ();function lQ(){let s=[];return{add(t){const r=s[0];t!==r&&(r==null||r.pause()),s=F6(s,t),s.unshift(t)},remove(t){var r;s=F6(s,t),(r=s[0])==null||r.resume()}}}function F6(s,t){const r=[...s],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function cQ(s){return s.filter(t=>t.tagName!=="A")}var n1=globalThis!=null&&globalThis.document?x.useLayoutEffect:()=>{},dQ=Zv.useId||(()=>{}),uQ=0;function hQ(s){const[t,r]=x.useState(dQ());return n1(()=>{r(n=>n??String(uQ++))},[s]),s||(t?`radix-${t}`:"")}var mQ="Portal",OM=x.forwardRef((s,t)=>{var l;const{container:r,...n}=s,[a,i]=x.useState(!1);n1(()=>i(!0),[]);const o=r||a&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?ey.createPortal(e.jsx(jg.div,{...n,ref:t}),o):null});OM.displayName=mQ;function fQ(s,t){return x.useReducer((r,n)=>t[r][n]??r,s)}var L5=s=>{const{present:t,children:r}=s,n=xQ(t),a=typeof r=="function"?r({present:n.isPresent}):x.Children.only(r),i=yg(n.ref,pQ(a));return typeof r=="function"||n.isPresent?x.cloneElement(a,{ref:i}):null};L5.displayName="Presence";function xQ(s){const[t,r]=x.useState(),n=x.useRef({}),a=x.useRef(s),i=x.useRef("none"),o=s?"mounted":"unmounted",[l,c]=fQ(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return x.useEffect(()=>{const d=Yy(n.current);i.current=l==="mounted"?d:"none"},[l]),n1(()=>{const d=n.current,u=a.current;if(u!==s){const f=i.current,m=Yy(d);s?c("MOUNT"):m==="none"||(d==null?void 0:d.display)==="none"?c("UNMOUNT"):c(u&&f!==m?"ANIMATION_OUT":"UNMOUNT"),a.current=s}},[s,c]),n1(()=>{if(t){let d;const u=t.ownerDocument.defaultView??window,h=m=>{const g=Yy(n.current).includes(m.animationName);if(m.target===t&&g&&(c("ANIMATION_END"),!a.current)){const v=t.style.animationFillMode;t.style.animationFillMode="forwards",d=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=v)})}},f=m=>{m.target===t&&(i.current=Yy(n.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",h),t.addEventListener("animationend",h),()=>{u.clearTimeout(d),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",h),t.removeEventListener("animationend",h)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:x.useCallback(d=>{d&&(n.current=getComputedStyle(d)),r(d)},[])}}function Yy(s){return(s==null?void 0:s.animationName)||"none"}function pQ(s){var n,a;let t=(n=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}function gQ({prop:s,defaultProp:t,onChange:r=()=>{}}){const[n,a]=vQ({defaultProp:t,onChange:r}),i=s!==void 0,o=i?s:n,l=Qf(r),c=x.useCallback(d=>{if(i){const h=typeof d=="function"?d(s):d;h!==s&&l(h)}else a(d)},[i,s,a,l]);return[o,c]}function vQ({defaultProp:s,onChange:t}){const r=x.useState(s),[n]=r,a=x.useRef(n),i=Qf(t);return x.useEffect(()=>{a.current!==n&&(i(n),a.current=n)},[n,a,i]),r}var $5="Popover",[RM]=BX($5,[Yb]),ny=Yb(),[yQ,Um]=RM($5),FM=s=>{const{__scopePopover:t,children:r,open:n,defaultOpen:a,onOpenChange:i,modal:o=!1}=s,l=ny(t),c=x.useRef(null),[d,u]=x.useState(!1),[h=!1,f]=gQ({prop:n,defaultProp:a,onChange:i});return e.jsx($R,{...l,children:e.jsx(yQ,{scope:t,contentId:hQ(),triggerRef:c,open:h,onOpenChange:f,onOpenToggle:x.useCallback(()=>f(m=>!m),[f]),hasCustomAnchor:d,onCustomAnchorAdd:x.useCallback(()=>u(!0),[]),onCustomAnchorRemove:x.useCallback(()=>u(!1),[]),modal:o,children:r})})};FM.displayName=$5;var MM="PopoverAnchor",jQ=x.forwardRef((s,t)=>{const{__scopePopover:r,...n}=s,a=Um(MM,r),i=ny(r),{onCustomAnchorAdd:o,onCustomAnchorRemove:l}=a;return x.useEffect(()=>(o(),()=>l()),[o,l]),e.jsx(h5,{...i,...n,ref:t})});jQ.displayName=MM;var LM="PopoverTrigger",$M=x.forwardRef((s,t)=>{const{__scopePopover:r,...n}=s,a=Um(LM,r),i=ny(r),o=yg(t,a.triggerRef),l=e.jsx(jg.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":VM(a.open),...n,ref:o,onClick:Sm(s.onClick,a.onOpenToggle)});return a.hasCustomAnchor?l:e.jsx(h5,{asChild:!0,...i,children:l})});$M.displayName=LM;var B5="PopoverPortal",[bQ,NQ]=RM(B5,{forceMount:void 0}),BM=s=>{const{__scopePopover:t,forceMount:r,children:n,container:a}=s,i=Um(B5,t);return e.jsx(bQ,{scope:t,forceMount:r,children:e.jsx(L5,{present:r||i.open,children:e.jsx(OM,{asChild:!0,container:a,children:n})})})};BM.displayName=B5;var Sp="PopoverContent",UM=x.forwardRef((s,t)=>{const r=NQ(Sp,s.__scopePopover),{forceMount:n=r.forceMount,...a}=s,i=Um(Sp,s.__scopePopover);return e.jsx(L5,{present:n||i.open,children:i.modal?e.jsx(wQ,{...a,ref:t}):e.jsx(SQ,{...a,ref:t})})});UM.displayName=Sp;var wQ=x.forwardRef((s,t)=>{const r=Um(Sp,s.__scopePopover),n=x.useRef(null),a=yg(t,n),i=x.useRef(!1);return x.useEffect(()=>{const o=n.current;if(o)return m5(o)},[]),e.jsx(f5,{as:M5,allowPinchZoom:!0,children:e.jsx(zM,{...s,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Sm(s.onCloseAutoFocus,o=>{var l;o.preventDefault(),i.current||(l=r.triggerRef.current)==null||l.focus()}),onPointerDownOutside:Sm(s.onPointerDownOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,d=l.button===2||c;i.current=d},{checkForDefaultPrevented:!1}),onFocusOutside:Sm(s.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),SQ=x.forwardRef((s,t)=>{const r=Um(Sp,s.__scopePopover),n=x.useRef(!1),a=x.useRef(!1);return e.jsx(zM,{...s,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=s.onCloseAutoFocus)==null||o.call(s,i),i.defaultPrevented||(n.current||(l=r.triggerRef.current)==null||l.focus(),i.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:i=>{var c,d;(c=s.onInteractOutside)==null||c.call(s,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;((d=r.triggerRef.current)==null?void 0:d.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),zM=x.forwardRef((s,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:u,...h}=s,f=Um(Sp,r),m=ny(r);return sQ(),e.jsx(TM,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:i,children:e.jsx(_M,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:u,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:d,onDismiss:()=>f.onOpenChange(!1),children:e.jsx(BR,{"data-state":VM(f.open),role:"dialog",id:f.contentId,...m,...h,ref:t,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),qM="PopoverClose",CQ=x.forwardRef((s,t)=>{const{__scopePopover:r,...n}=s,a=Um(qM,r);return e.jsx(jg.button,{type:"button",...n,ref:t,onClick:Sm(s.onClick,()=>a.onOpenChange(!1))})});CQ.displayName=qM;var AQ="PopoverArrow",EQ=x.forwardRef((s,t)=>{const{__scopePopover:r,...n}=s,a=ny(r);return e.jsx(UR,{...a,...n,ref:t})});EQ.displayName=AQ;function VM(s){return s?"open":"closed"}var IQ=FM,PQ=$M,_Q=BM,kQ=UM;function CC({...s}){return e.jsx(IQ,{"data-slot":"popover",...s})}function AC({...s}){return e.jsx(PQ,{"data-slot":"popover-trigger",...s})}function EC({className:s,align:t="center",sideOffset:r=4,...n}){return e.jsx(_Q,{children:e.jsx(kQ,{"data-slot":"popover-content",align:t,sideOffset:r,className:ns("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",s),...n})})}const M6=sy("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}}),Oe=x.forwardRef(({className:s,variant:t,asChild:r=!1,...n},a)=>{const i=r?rN:"span";return r?e.jsx(i,{"data-slot":"badge",className:ns(M6({variant:t}),s),...n}):e.jsx(i,{ref:a,"data-slot":"badge",className:ns(M6({variant:t}),s),...n})});Oe.displayName="Badge";const L6=[{id:"expense",icon:yn,label:"Record expense",category:"Quick Actions",shortcut:"Ctrl+E",action:"expense",type:"action"},{id:"invoice",icon:Zt,label:"Create invoice",category:"Quick Actions",shortcut:"Ctrl+I",action:"invoice",type:"action"},{id:"client",icon:Sa,label:"Add new client",category:"Quick Actions",shortcut:"Ctrl+N",action:"client",type:"action"},{id:"tx1",icon:$a,label:"Office supplies - $245.50",category:"Transactions",date:"2024-01-15",amount:245.5,client:"Acme Corp",type:"transaction"},{id:"tx2",icon:Mr,label:"Consulting payment - $2,500.00",category:"Transactions",date:"2024-01-14",amount:2500,client:"TechStart Inc",type:"transaction"},{id:"tx3",icon:$a,label:"Software subscription - $99.00",category:"Transactions",date:"2024-01-13",amount:99,client:"Local Bakery",type:"transaction"},{id:"client1",icon:vn,label:"Acme Corp",category:"Clients",type:"client",status:"active"},{id:"client2",icon:vn,label:"TechStart Inc",category:"Clients",type:"client",status:"active"},{id:"client3",icon:vn,label:"Local Bakery",category:"Clients",type:"client",status:"pending"},{id:"report1",icon:$s,label:"Profit & Loss Report",category:"Reports",type:"report"},{id:"report2",icon:Zt,label:"Balance Sheet",category:"Reports",type:"report"},{id:"report3",icon:yn,label:"Tax Summary",category:"Reports",type:"report"},{id:"ai1",icon:ic,label:"AI insights for Acme Corp",category:"AI Suggestions",action:"insights",type:"ai"},{id:"ai2",icon:ic,label:"Duplicate expense detected",category:"AI Suggestions",action:"duplicate",type:"ai"}];function TQ(){const[s,t]=x.useState(!1),[r,n]=x.useState(""),[a,i]=x.useState(""),[o,l]=x.useState([]),[c,d]=x.useState([]),[u,h]=x.useState({category:[],dateRange:"",amountRange:"",client:[]}),[f,m]=x.useState(!1),{setFocusedElement:p}=fF(),g=x.useMemo(()=>{if(!a.trim())return L6.slice(0,10);const C=a.toLowerCase().split(" ");return L6.map(S=>{let _=0;const k=`${S.label} ${S.category}`.toLowerCase();if(k.includes(a.toLowerCase())&&(_+=10),C.forEach(F=>{k.includes(F)&&(_+=5),k.includes(F.slice(0,-1))&&F.length>3&&(_+=2)}),u.category.length>0&&!u.category.includes(S.category)&&(_=0),u.client.length>0&&S.client&&!u.client.includes(S.client)&&(_=0),u.amountRange&&S.amount){const[F,A]=u.amountRange.split("-").map(Number);(S.amount<F||S.amount>A)&&(_=0)}return{...S,score:_}}).filter(S=>S.score>0).sort((S,_)=>_.score-S.score).slice(0,20)},[a,u]);x.useEffect(()=>{const C=S=>{(S.ctrlKey||S.metaKey)&&S.key==="k"&&(S.preventDefault(),t(!0))};return document.addEventListener("keydown",C),()=>document.removeEventListener("keydown",C)},[]);const v=(C,S)=>{n(C),t(!1),l(_=>[C,..._.filter(F=>F!==C)].slice(0,5)),S&&console.log(`[v0] Executing action: ${S}`)},y=(C,S)=>{h(_=>({..._,[C]:Array.isArray(_[C])?[..._[C],S]:S}))},j=(C,S)=>{h(_=>({..._,[C]:Array.isArray(_[C])?_[C].filter(k=>k!==S):""}))},b=()=>{h({category:[],dateRange:"",amountRange:"",client:[]})},w=()=>{const C=`Filter ${c.length+1}`;d(S=>[...S,{name:C,filters:u}])},N=Object.values(u).some(C=>Array.isArray(C)?C.length>0:C!=="");return e.jsxs(CC,{open:s,onOpenChange:t,children:[e.jsx(AC,{asChild:!0,children:e.jsxs(I,{variant:"outline",role:"combobox","aria-expanded":s,"aria-label":"Global search - Press Ctrl+K to open","data-search-input":!0,className:"w-80 justify-start text-muted-foreground hover:text-foreground hover:bg-muted hover:border-border relative",onFocus:()=>p("global-search"),onBlur:()=>p(null),children:[e.jsx(Rn,{className:"mr-2 h-4 w-4"}),"Search anything... (Ctrl+K)",N&&e.jsx(Oe,{variant:"secondary",className:"ml-auto text-xs",children:Object.values(u).flat().filter(Boolean).length})]})}),e.jsx(EC,{className:"w-96 p-0",align:"start",children:e.jsxs(FX,{shouldFilter:!1,children:[e.jsxs("div",{className:"flex items-center border-b border-border",children:[e.jsx(MX,{placeholder:"Search transactions, clients, reports...","aria-label":"Search input",className:"flex-1 focus:ring-0 focus:border-transparent border-0",value:a,onValueChange:i}),e.jsxs(I,{variant:"ghost",size:"sm",onClick:()=>m(!f),className:"mr-2 gap-1",children:[e.jsx(Ic,{className:"w-4 h-4"}),e.jsx(tc,{className:`w-3 h-3 transition-transform ${f?"rotate-180":""}`})]})]}),f&&e.jsx("div",{className:"p-4 border-b border-border bg-muted/20",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-muted-foreground",children:"Categories"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:["Transactions","Clients","Reports","Quick Actions"].map(C=>e.jsx(I,{variant:u.category.includes(C)?"default":"outline",size:"sm",className:"h-6 text-xs",onClick:()=>u.category.includes(C)?j("category",C):y("category",C),children:C},C))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-muted-foreground",children:"Amount Range"}),e.jsx("div",{className:"flex gap-1 mt-1",children:["0-100","100-500","500-1000","1000+"].map(C=>e.jsxs(I,{variant:u.amountRange===C?"default":"outline",size:"sm",className:"h-6 text-xs",onClick:()=>u.amountRange===C?j("amountRange"):h(S=>({...S,amountRange:C})),children:["$",C]},C))})]}),e.jsxs("div",{className:"flex gap-2",children:[N&&e.jsx(I,{variant:"outline",size:"sm",onClick:b,className:"h-6 text-xs bg-transparent",children:"Clear All"}),N&&e.jsx(I,{variant:"outline",size:"sm",onClick:w,className:"h-6 text-xs bg-transparent",children:"Save Filter"})]})]})}),N&&e.jsx("div",{className:"p-2 border-b border-border",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[u.category.map(C=>e.jsxs(Oe,{variant:"secondary",className:"text-xs gap-1",children:[C,e.jsx(ma,{className:"w-3 h-3 cursor-pointer",onClick:()=>j("category",C)})]},C)),u.amountRange&&e.jsxs(Oe,{variant:"secondary",className:"text-xs gap-1",children:["$",u.amountRange,e.jsx(ma,{className:"w-3 h-3 cursor-pointer",onClick:()=>j("amountRange")})]})]})}),e.jsxs(LX,{children:[e.jsx($X,{children:e.jsxs("div",{className:"py-6 text-center text-sm text-muted-foreground",children:['No results found for "',a,'"',e.jsx("div",{className:"mt-2 text-xs",children:"Try adjusting your search terms or filters"})]})}),c.length>0&&a===""&&e.jsx(Zw,{heading:"Saved Filters",children:c.map((C,S)=>e.jsx(e2,{onSelect:()=>h(C.filters),className:"flex items-center justify-between focus:bg-muted focus:text-foreground",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ic,{className:"mr-2 h-4 w-4 text-muted-foreground"}),C.name]})},`filter-${S}`))}),o.length>0&&a===""&&e.jsx(Zw,{heading:"Recent Searches",children:o.map((C,S)=>e.jsx(e2,{value:C,onSelect:()=>{i(C),v(C)},className:"flex items-center justify-between focus:bg-muted focus:text-foreground",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Rn,{className:"mr-2 h-4 w-4 text-muted-foreground"}),C]})},`recent-${S}`))}),Object.entries(g.reduce((C,S)=>(C[S.category]||(C[S.category]=[]),C[S.category].push(S),C),{})).map(([C,S])=>e.jsx(Zw,{heading:C,children:S.map(_=>e.jsxs(e2,{value:_.label,onSelect:()=>v(_.label,_.action),className:"flex items-center justify-between focus:bg-muted focus:text-foreground cursor-pointer",role:"option",children:[e.jsxs("div",{className:"flex items-center flex-1 min-w-0",children:[e.jsx(_.icon,{className:"mr-2 h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:"truncate",children:_.label})]}),e.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[_.client&&e.jsx(Oe,{variant:"outline",className:"text-xs",children:_.client}),_.shortcut&&e.jsx("kbd",{className:"text-xs text-muted-foreground bg-muted px-1.5 py-0.5 rounded font-mono",children:_.shortcut})]})]},_.id))},C))]})]})})]})}const DQ=l5,OQ=LR,RQ=c5,WM=x.forwardRef(({className:s,...t},r)=>e.jsx(Xv,{className:ns("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...t,ref:r}));WM.displayName=Xv.displayName;const FQ=sy("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),HM=x.forwardRef(({side:s="right",className:t,children:r,...n},a)=>e.jsxs(RQ,{children:[e.jsx(WM,{}),e.jsx(Qv,{ref:a,className:ns(FQ({side:s}),t),...n,children:r})]}));HM.displayName=Qv.displayName;const MQ=x.forwardRef(({className:s,...t},r)=>e.jsx(d5,{ref:r,className:ns("text-lg font-semibold text-foreground",s),...t}));MQ.displayName=d5.displayName;const LQ=x.forwardRef(({className:s,...t},r)=>e.jsx(u5,{ref:r,className:ns("text-sm text-muted-foreground",s),...t}));LQ.displayName=u5.displayName;const $Q=[{name:"Dashboard",icon:sN,href:"/",current:!0},{name:"Sales & Invoicing",icon:Gu,href:"/sales"},{name:"Purchases & Expenses",icon:lh,href:"/purchases"},{name:"Banking & Cash",icon:P5,href:"/banking"},{name:"Inventory & Products",icon:Hr,href:"/inventory"},{name:"Reports & Analytics",icon:lr,href:"/reports"},{name:"AI Insights",icon:sa,href:"/ai-insights"},{name:"Settings",icon:en,href:"/settings"}];function BQ(){const[s,t]=x.useState(!1);return e.jsxs(DQ,{open:s,onOpenChange:t,children:[e.jsx(OQ,{asChild:!0,children:e.jsxs(I,{variant:"ghost",size:"sm",className:"lg:hidden",children:[e.jsx(sM,{className:"h-5 w-5"}),e.jsx("span",{className:"sr-only",children:"Open navigation menu"})]})}),e.jsx(HM,{side:"right",className:"w-80 p-0",children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"p-4 border-b border-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-primary rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-primary-foreground font-bold text-sm",children:"U"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-foreground",children:"UrutiIQ"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"AI Accounting"})]})]}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>t(!1),children:e.jsx(ma,{className:"h-4 w-4"})})]})}),e.jsx("nav",{className:"flex-1 overflow-y-auto p-4",children:e.jsx("div",{className:"space-y-2",children:$Q.map(r=>e.jsxs("a",{href:r.href,className:ns("flex items-center gap-3 px-3 py-3 text-sm rounded-lg transition-colors",r.current?"bg-primary text-primary-foreground font-medium":"text-muted-foreground hover:bg-muted hover:text-foreground"),onClick:()=>t(!1),children:[e.jsx(r.icon,{className:"w-5 h-5"}),r.name]},r.name))})}),e.jsx("div",{className:"p-4 border-t border-border",children:e.jsx("div",{className:"bg-card p-3 rounded-lg border border-border",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-muted rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs font-medium",children:"JD"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:"John Doe"}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:"Senior Accountant"})]})]})})})]})})]})}function UQ(s,t=[]){let r=[];function n(i,o){const l=x.createContext(o),c=r.length;r=[...r,o];const d=h=>{var y;const{scope:f,children:m,...p}=h,g=((y=f==null?void 0:f[s])==null?void 0:y[c])||l,v=x.useMemo(()=>p,Object.values(p));return e.jsx(g.Provider,{value:v,children:m})};d.displayName=i+"Provider";function u(h,f){var g;const m=((g=f==null?void 0:f[s])==null?void 0:g[c])||l,p=x.useContext(m);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[d,u]}const a=()=>{const i=r.map(o=>x.createContext(o));return function(l){const c=(l==null?void 0:l[s])||i;return x.useMemo(()=>({[`__scope${s}`]:{...l,[s]:c}}),[l,c])}};return a.scopeName=s,[n,zQ(a,...t)]}function zQ(...s){const t=s[0];if(s.length===1)return t;const r=()=>{const n=s.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=n.reduce((l,{useScope:c,scopeName:d})=>{const h=c(i)[`__scope${d}`];return{...l,...h}},{});return x.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}function qQ(s){const t=x.useRef(s);return x.useEffect(()=>{t.current=s}),x.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}var GM=globalThis!=null&&globalThis.document?x.useLayoutEffect:()=>{};function $6(s,t){if(typeof s=="function")return s(t);s!=null&&(s.current=t)}function VQ(...s){return t=>{let r=!1;const n=s.map(a=>{const i=$6(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():$6(s[a],null)}}}}var KM=x.forwardRef((s,t)=>{const{children:r,...n}=s,a=x.Children.toArray(r),i=a.find(HQ);if(i){const o=i.props.children,l=a.map(c=>c===i?x.Children.count(o)>1?x.Children.only(null):x.isValidElement(o)?o.props.children:null:c);return e.jsx(IC,{...n,ref:t,children:x.isValidElement(o)?x.cloneElement(o,void 0,l):null})}return e.jsx(IC,{...n,ref:t,children:r})});KM.displayName="Slot";var IC=x.forwardRef((s,t)=>{const{children:r,...n}=s;if(x.isValidElement(r)){const a=KQ(r);return x.cloneElement(r,{...GQ(n,r.props),ref:t?VQ(t,a):a})}return x.Children.count(r)>1?x.Children.only(null):null});IC.displayName="SlotClone";var WQ=({children:s})=>e.jsx(e.Fragment,{children:s});function HQ(s){return x.isValidElement(s)&&s.type===WQ}function GQ(s,t){const r={...t};for(const n in t){const a=s[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...l)=>{i(...l),a(...l)}:a&&(r[n]=a):n==="style"?r[n]={...a,...i}:n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return{...s,...r}}function KQ(s){var n,a;let t=(n=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}var YQ=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],U5=YQ.reduce((s,t)=>{const r=x.forwardRef((n,a)=>{const{asChild:i,...o}=n,l=i?KM:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(l,{...o,ref:a})});return r.displayName=`Primitive.${t}`,{...s,[t]:r}},{}),z5="Avatar",[JQ]=UQ(z5),[XQ,YM]=JQ(z5),JM=x.forwardRef((s,t)=>{const{__scopeAvatar:r,...n}=s,[a,i]=x.useState("idle");return e.jsx(XQ,{scope:r,imageLoadingStatus:a,onImageLoadingStatusChange:i,children:e.jsx(U5.span,{...n,ref:t})})});JM.displayName=z5;var XM="AvatarImage",QM=x.forwardRef((s,t)=>{const{__scopeAvatar:r,src:n,onLoadingStatusChange:a=()=>{},...i}=s,o=YM(XM,r),l=QQ(n,i.referrerPolicy),c=qQ(d=>{a(d),o.onImageLoadingStatusChange(d)});return GM(()=>{l!=="idle"&&c(l)},[l,c]),l==="loaded"?e.jsx(U5.img,{...i,ref:t,src:n}):null});QM.displayName=XM;var ZM="AvatarFallback",eL=x.forwardRef((s,t)=>{const{__scopeAvatar:r,delayMs:n,...a}=s,i=YM(ZM,r),[o,l]=x.useState(n===void 0);return x.useEffect(()=>{if(n!==void 0){const c=window.setTimeout(()=>l(!0),n);return()=>window.clearTimeout(c)}},[n]),o&&i.imageLoadingStatus!=="loaded"?e.jsx(U5.span,{...a,ref:t}):null});eL.displayName=ZM;function QQ(s,t){const[r,n]=x.useState("idle");return GM(()=>{if(!s){n("error");return}let a=!0;const i=new window.Image,o=l=>()=>{a&&n(l)};return n("loading"),i.onload=o("loaded"),i.onerror=o("error"),i.src=s,t&&(i.referrerPolicy=t),()=>{a=!1}},[s,t]),r}var ZQ=JM,eZ=QM,tZ=eL;function Kc({className:s,...t}){return e.jsx(ZQ,{"data-slot":"avatar",className:ns("relative flex size-8 shrink-0 overflow-hidden rounded-full",s),...t})}function P0({className:s,...t}){return e.jsx(eZ,{"data-slot":"avatar-image",className:ns("aspect-square size-full",s),...t})}function Yc({className:s,...t}){return e.jsx(tZ,{"data-slot":"avatar-fallback",className:ns("bg-muted flex size-full items-center justify-center rounded-full",s),...t})}function tu({...s}){return e.jsx(HW,{"data-slot":"dropdown-menu",...s})}function su({...s}){return e.jsx(GW,{"data-slot":"dropdown-menu-trigger",...s})}function ru({className:s,sideOffset:t=4,...r}){return e.jsx(KW,{children:e.jsx(YW,{"data-slot":"dropdown-menu-content",sideOffset:t,className:ns("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",s),...r})})}function Pn({className:s,inset:t,variant:r="default",...n}){return e.jsx(JW,{"data-slot":"dropdown-menu-item","data-inset":t,"data-variant":r,className:ns("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...n})}function sZ({className:s,inset:t,...r}){return e.jsx(QW,{"data-slot":"dropdown-menu-label","data-inset":t,className:ns("px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",s),...r})}function a1({className:s,...t}){return e.jsx(XW,{"data-slot":"dropdown-menu-separator",className:ns("bg-border -mx-1 my-1 h-px",s),...t})}function rZ(){const{user:s,logout:t,isAuthenticated:r,isLoading:n}=Ua(),{isCollapsed:a}=C5(),[i,o]=xe.useState(!1);xe.useEffect(()=>o(!0),[]),hi(),xe.useEffect(()=>{console.log(" Header - Auth state:",{isAuthenticated:r,user:s,isLoading:n})},[r,s,n]);const{data:l}=ys({queryKey:["companies"],queryFn:async()=>{const f=await de.getCompanies();return console.log(" Header - Companies API response:",f),Array.isArray(f)?(console.log(" Header - Returning array directly:",f.length,"companies"),f):f!=null&&f.data&&Array.isArray(f.data)?(console.log(" Header - Returning result.data:",f.data.length,"companies"),f.data):f!=null&&f.items&&Array.isArray(f.items)?(console.log(" Header - Returning result.items:",f.items.length,"companies"),f.items):(console.log(" Header - No companies found, returning empty array"),[])},enabled:r}),c=xe.useMemo(()=>{if(console.log(" Header - companiesList memo:",l),!l)return[];let f=[];if(Array.isArray(l))f=l;else if(l.data&&Array.isArray(l.data))f=l.data;else return[];const m=f.filter(p=>p.id==="seed-company-1");return console.log(" Header - Filtered to show only seed-company-1:",m),m},[l]),[d,u]=xe.useState("seed-company-1");xe.useEffect(()=>{if(i)try{localStorage.setItem("company_id","seed-company-1"),localStorage.setItem("companyId","seed-company-1"),localStorage.setItem("company","seed-company-1"),u("seed-company-1"),console.log(" Forced company ID to seed-company-1 in localStorage")}catch(f){console.error(" Error setting company ID:",f)}},[i]),xe.useEffect(()=>{const f=setInterval(()=>{try{(localStorage.getItem("company_id")||localStorage.getItem("companyId")||localStorage.getItem("company"))!=="seed-company-1"&&(console.log(" Detected unauthorized company change, forcing back to seed-company-1"),localStorage.setItem("company_id","seed-company-1"),localStorage.setItem("companyId","seed-company-1"),localStorage.setItem("company","seed-company-1"),u("seed-company-1"))}catch(m){console.error(" Error checking company ID:",m)}},1e3);return()=>clearInterval(f)},[]);const h=f=>{const m=f.target.value;console.log(" Attempted company change from",d,"to",m),console.log(" Company changes are disabled. Forcing back to seed-company-1"),u("seed-company-1");try{localStorage.setItem("company_id","seed-company-1"),localStorage.setItem("companyId","seed-company-1"),localStorage.setItem("company","seed-company-1"),console.log(" Forced localStorage to seed-company-1")}catch(p){console.error(" Error saving company ID:",p)}console.log(" Company change blocked - no cache clearing needed")};return i?n?e.jsxs("header",{className:"h-16 bg-white border-b border-gray-200 px-4 flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx("div",{className:"h-8 w-8 bg-gray-200 rounded animate-pulse"})}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx("div",{className:"h-8 w-8 bg-gray-200 rounded-full animate-pulse"})})]}):e.jsx("header",{className:`fixed top-0 right-0 z-50 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b border-border transition-all duration-300 ${a?"left-16":"left-64"}`,children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 lg:px-6 lg:py-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-primary rounded-lg flex items-center justify-center",children:e.jsx(sa,{className:"w-5 h-5 text-primary-foreground"})}),e.jsxs("div",{className:"hidden sm:block",children:[e.jsx("h1",{className:"text-lg font-bold text-foreground",children:"UrutiIQ"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"AI Accounting"})]})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-4 flex-1 max-w-2xl mx-8",children:[e.jsx("div",{className:"flex-1",children:e.jsx(TQ,{})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(wm,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("select",{value:d,onChange:h,className:"px-3 py-2 bg-card border border-border rounded-lg text-sm focus:ring-2 focus:ring-border focus:border-border min-w-[200px] opacity-75 cursor-not-allowed",disabled:!0,title:"Company selection is locked to UrutiQ Demo Company",children:c.map(f=>e.jsxs("option",{value:f.id,children:[f.name," (Locked)"]},f.id))}),!c.length&&e.jsx(I,{size:"sm",variant:"outline",onClick:()=>{localStorage.setItem("company_id","seed-company-1"),localStorage.setItem("company_name","Demo Company"),localStorage.setItem("tenant_id","tenant_demo"),console.log(" Set default company for testing"),window.location.reload()},className:"text-xs",children:"Set Demo"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"p-2 hover:bg-muted rounded-lg transition-colors",children:e.jsx(Rn,{className:"w-4 h-4 md:hidden"})}),e.jsxs("button",{className:"p-2 hover:bg-muted rounded-lg transition-colors relative",children:[e.jsx(Hu,{className:"w-4 h-4"}),e.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]}),e.jsx("button",{className:"p-2 hover:bg-muted rounded-lg transition-colors",children:e.jsx(en,{className:"w-4 h-4"})}),s?e.jsxs(tu,{children:[e.jsx(su,{asChild:!0,children:e.jsx(I,{variant:"ghost",className:"relative h-8 w-8 rounded-full",children:e.jsxs(Kc,{className:"h-8 w-8",children:[e.jsx(P0,{src:"",alt:s.firstName}),e.jsxs(Yc,{children:[s.firstName.charAt(0),s.lastName.charAt(0)]})]})})}),e.jsxs(ru,{className:"w-56",align:"end",forceMount:!0,children:[e.jsx(sZ,{className:"font-normal",children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsxs("p",{className:"text-sm font-medium leading-none",children:[s.firstName," ",s.lastName]}),e.jsx("p",{className:"text-xs leading-none text-muted-foreground",children:s.email}),e.jsx("p",{className:"text-xs leading-none text-muted-foreground",children:s.companyName})]})}),e.jsx(a1,{}),e.jsxs(Pn,{children:[e.jsx(bo,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Profile"})]}),e.jsxs(Pn,{children:[e.jsx(en,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Settings"})]}),e.jsx(a1,{}),e.jsxs(Pn,{onClick:()=>t(),children:[e.jsx(gY,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Log out"})]})]})]}):e.jsx(I,{variant:"ghost",size:"sm",children:e.jsx(bo,{className:"w-4 h-4"})}),e.jsx("div",{className:"md:hidden",children:e.jsx(BQ,{})})]})]})}):e.jsx("header",{className:`fixed top-0 right-0 z-50 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 border-b border-border transition-all duration-300 ${a?"left-16":"left-64"}`,suppressHydrationWarning:!0,children:e.jsx("div",{className:"h-14 lg:h-16"})})}function nZ(){const{isCollapsed:s}=C5(),r=pu().pathname==="/pos";return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(YJ,{}),e.jsxs("div",{className:`flex flex-col min-h-screen transition-all duration-300 ${s?"ml-16":"ml-64"}`,children:[e.jsx(rZ,{}),e.jsx("main",{className:r?"flex-1 overflow-hidden pt-20 h-screen":"flex-1 overflow-y-auto pb-6 pt-20",id:"main-content",children:e.jsx(YH,{})})]})]})}function aZ(){const{isAuthenticated:s,isLoading:t}=Ua(),r=id();return x.useEffect(()=>{t||r(s?"/dashboard":"/login")},[s,t,r]),e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-cyan-50 to-blue-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading..."})]})})}const ne=x.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:ns("rounded-xl border bg-card text-card-foreground shadow",s),...t}));ne.displayName="Card";const we=x.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:ns("flex flex-col space-y-1.5 p-6",s),...t}));we.displayName="CardHeader";const Se=x.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:ns("font-semibold leading-none tracking-tight",s),...t}));Se.displayName="CardTitle";const Vt=x.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:ns("text-sm text-muted-foreground",s),...t}));Vt.displayName="CardDescription";const ie=x.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:ns("p-6 pt-0",s),...t}));ie.displayName="CardContent";const iZ=x.forwardRef(({className:s,...t},r)=>e.jsx("div",{ref:r,className:ns("flex items-center p-6 pt-0",s),...t}));iZ.displayName="CardFooter";function n2({className:s,children:t}){return e.jsx("div",{className:ns("bg-card border border-border rounded-lg p-6",s),children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"h-6 bg-muted rounded w-1/3"}),e.jsx("div",{className:"h-4 bg-muted rounded w-16"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-4 bg-muted rounded w-full"}),e.jsx("div",{className:"h-4 bg-muted rounded w-5/6"}),e.jsx("div",{className:"h-4 bg-muted rounded w-4/6"})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsx("div",{className:"h-8 bg-muted rounded w-20"}),e.jsx("div",{className:"h-8 bg-muted rounded w-24"})]}),t]})})}function sh({children:s,requiredRole:t}){const{user:r,isLoading:n,isAuthenticated:a}=Ua(),i=id(),o=()=>{if(!t||(r==null?void 0:r.role)===t)return!0;try{const l=localStorage.getItem("auth_token")||"",[,c]=l.split(".");if(!c)return!1;const d=JSON.parse(atob(c.replace(/-/g,"+").replace(/_/g,"/")));return(Array.isArray(d==null?void 0:d.roles)?d.roles:[]).includes(t)}catch{return!1}};return x.useEffect(()=>{!n&&!a&&i("/login")},[n,a,i]),x.useEffect(()=>{r&&t&&!o()&&i("/unauthorized")},[r,t,i]),n?e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(n2,{className:"h-8 w-64"}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[...Array(4)].map((l,c)=>e.jsx(n2,{className:"h-32"},c))}),e.jsx(n2,{className:"h-96"})]})}):!a||t&&!o()?null:e.jsx(e.Fragment,{children:s})}function PC(s,[t,r]){return Math.min(r,Math.max(t,s))}function to(s,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(s==null||s(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function B6(s,t){if(typeof s=="function")return s(t);s!=null&&(s.current=t)}function tL(...s){return t=>{let r=!1;const n=s.map(a=>{const i=B6(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():B6(s[a],null)}}}}function Dc(...s){return x.useCallback(tL(...s),s)}function oZ(s,t=[]){let r=[];function n(i,o){const l=x.createContext(o),c=r.length;r=[...r,o];const d=h=>{var y;const{scope:f,children:m,...p}=h,g=((y=f==null?void 0:f[s])==null?void 0:y[c])||l,v=x.useMemo(()=>p,Object.values(p));return e.jsx(g.Provider,{value:v,children:m})};d.displayName=i+"Provider";function u(h,f){var g;const m=((g=f==null?void 0:f[s])==null?void 0:g[c])||l,p=x.useContext(m);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[d,u]}const a=()=>{const i=r.map(o=>x.createContext(o));return function(l){const c=(l==null?void 0:l[s])||i;return x.useMemo(()=>({[`__scope${s}`]:{...l,[s]:c}}),[l,c])}};return a.scopeName=s,[n,lZ(a,...t)]}function lZ(...s){const t=s[0];if(s.length===1)return t;const r=()=>{const n=s.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=n.reduce((l,{useScope:c,scopeName:d})=>{const h=c(i)[`__scope${d}`];return{...l,...h}},{});return x.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}var q5=x.forwardRef((s,t)=>{const{children:r,...n}=s,a=x.Children.toArray(r),i=a.find(dZ);if(i){const o=i.props.children,l=a.map(c=>c===i?x.Children.count(o)>1?x.Children.only(null):x.isValidElement(o)?o.props.children:null:c);return e.jsx(_C,{...n,ref:t,children:x.isValidElement(o)?x.cloneElement(o,void 0,l):null})}return e.jsx(_C,{...n,ref:t,children:r})});q5.displayName="Slot";var _C=x.forwardRef((s,t)=>{const{children:r,...n}=s;if(x.isValidElement(r)){const a=hZ(r);return x.cloneElement(r,{...uZ(n,r.props),ref:t?tL(t,a):a})}return x.Children.count(r)>1?x.Children.only(null):null});_C.displayName="SlotClone";var cZ=({children:s})=>e.jsx(e.Fragment,{children:s});function dZ(s){return x.isValidElement(s)&&s.type===cZ}function uZ(s,t){const r={...t};for(const n in t){const a=s[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...l)=>{i(...l),a(...l)}:a&&(r[n]=a):n==="style"?r[n]={...a,...i}:n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return{...s,...r}}function hZ(s){var n,a;let t=(n=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}var mZ=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],fl=mZ.reduce((s,t)=>{const r=x.forwardRef((n,a)=>{const{asChild:i,...o}=n,l=i?q5:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(l,{...o,ref:a})});return r.displayName=`Primitive.${t}`,{...s,[t]:r}},{});function fZ(s,t){s&&$m.flushSync(()=>s.dispatchEvent(t))}function Dm(s){const t=x.useRef(s);return x.useEffect(()=>{t.current=s}),x.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function xZ(s,t=globalThis==null?void 0:globalThis.document){const r=Dm(s);x.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var pZ="DismissableLayer",kC="dismissableLayer.update",gZ="dismissableLayer.pointerDownOutside",vZ="dismissableLayer.focusOutside",U6,sL=x.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),rL=x.forwardRef((s,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:o,onDismiss:l,...c}=s,d=x.useContext(sL),[u,h]=x.useState(null),f=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=x.useState({}),p=Dc(t,S=>h(S)),g=Array.from(d.layers),[v]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),y=g.indexOf(v),j=u?g.indexOf(u):-1,b=d.layersWithOutsidePointerEventsDisabled.size>0,w=j>=y,N=bZ(S=>{const _=S.target,k=[...d.branches].some(F=>F.contains(_));!w||k||(a==null||a(S),o==null||o(S),S.defaultPrevented||l==null||l())},f),C=NZ(S=>{const _=S.target;[...d.branches].some(F=>F.contains(_))||(i==null||i(S),o==null||o(S),S.defaultPrevented||l==null||l())},f);return xZ(S=>{j===d.layers.size-1&&(n==null||n(S),!S.defaultPrevented&&l&&(S.preventDefault(),l()))},f),x.useEffect(()=>{if(u)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(U6=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(u)),d.layers.add(u),z6(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=U6)}},[u,f,r,d]),x.useEffect(()=>()=>{u&&(d.layers.delete(u),d.layersWithOutsidePointerEventsDisabled.delete(u),z6())},[u,d]),x.useEffect(()=>{const S=()=>m({});return document.addEventListener(kC,S),()=>document.removeEventListener(kC,S)},[]),e.jsx(fl.div,{...c,ref:p,style:{pointerEvents:b?w?"auto":"none":void 0,...s.style},onFocusCapture:to(s.onFocusCapture,C.onFocusCapture),onBlurCapture:to(s.onBlurCapture,C.onBlurCapture),onPointerDownCapture:to(s.onPointerDownCapture,N.onPointerDownCapture)})});rL.displayName=pZ;var yZ="DismissableLayerBranch",jZ=x.forwardRef((s,t)=>{const r=x.useContext(sL),n=x.useRef(null),a=Dc(t,n);return x.useEffect(()=>{const i=n.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),e.jsx(fl.div,{...s,ref:a})});jZ.displayName=yZ;function bZ(s,t=globalThis==null?void 0:globalThis.document){const r=Dm(s),n=x.useRef(!1),a=x.useRef(()=>{});return x.useEffect(()=>{const i=l=>{if(l.target&&!n.current){let c=function(){nL(gZ,r,d,{discrete:!0})};const d={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=c,t.addEventListener("click",a.current,{once:!0})):c()}else t.removeEventListener("click",a.current);n.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",i),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function NZ(s,t=globalThis==null?void 0:globalThis.document){const r=Dm(s),n=x.useRef(!1);return x.useEffect(()=>{const a=i=>{i.target&&!n.current&&nL(vZ,r,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function z6(){const s=new CustomEvent(kC);document.dispatchEvent(s)}function nL(s,t,r,{discrete:n}){const a=r.originalEvent.target,i=new CustomEvent(s,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(s,t,{once:!0}),n?fZ(a,i):a.dispatchEvent(i)}var a2=0;function wZ(){x.useEffect(()=>{const s=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",s[0]??q6()),document.body.insertAdjacentElement("beforeend",s[1]??q6()),a2++,()=>{a2===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),a2--}},[])}function q6(){const s=document.createElement("span");return s.setAttribute("data-radix-focus-guard",""),s.tabIndex=0,s.style.outline="none",s.style.opacity="0",s.style.position="fixed",s.style.pointerEvents="none",s}var i2="focusScope.autoFocusOnMount",o2="focusScope.autoFocusOnUnmount",V6={bubbles:!1,cancelable:!0},SZ="FocusScope",aL=x.forwardRef((s,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:i,...o}=s,[l,c]=x.useState(null),d=Dm(a),u=Dm(i),h=x.useRef(null),f=Dc(t,g=>c(g)),m=x.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;x.useEffect(()=>{if(n){let g=function(b){if(m.paused||!l)return;const w=b.target;l.contains(w)?h.current=w:Vh(h.current,{select:!0})},v=function(b){if(m.paused||!l)return;const w=b.relatedTarget;w!==null&&(l.contains(w)||Vh(h.current,{select:!0}))},y=function(b){if(document.activeElement===document.body)for(const N of b)N.removedNodes.length>0&&Vh(l)};document.addEventListener("focusin",g),document.addEventListener("focusout",v);const j=new MutationObserver(y);return l&&j.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",v),j.disconnect()}}},[n,l,m.paused]),x.useEffect(()=>{if(l){H6.add(m);const g=document.activeElement;if(!l.contains(g)){const y=new CustomEvent(i2,V6);l.addEventListener(i2,d),l.dispatchEvent(y),y.defaultPrevented||(CZ(_Z(iL(l)),{select:!0}),document.activeElement===g&&Vh(l))}return()=>{l.removeEventListener(i2,d),setTimeout(()=>{const y=new CustomEvent(o2,V6);l.addEventListener(o2,u),l.dispatchEvent(y),y.defaultPrevented||Vh(g??document.body,{select:!0}),l.removeEventListener(o2,u),H6.remove(m)},0)}}},[l,d,u,m]);const p=x.useCallback(g=>{if(!r&&!n||m.paused)return;const v=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,y=document.activeElement;if(v&&y){const j=g.currentTarget,[b,w]=AZ(j);b&&w?!g.shiftKey&&y===w?(g.preventDefault(),r&&Vh(b,{select:!0})):g.shiftKey&&y===b&&(g.preventDefault(),r&&Vh(w,{select:!0})):y===j&&g.preventDefault()}},[r,n,m.paused]);return e.jsx(fl.div,{tabIndex:-1,...o,ref:f,onKeyDown:p})});aL.displayName=SZ;function CZ(s,{select:t=!1}={}){const r=document.activeElement;for(const n of s)if(Vh(n,{select:t}),document.activeElement!==r)return}function AZ(s){const t=iL(s),r=W6(t,s),n=W6(t.reverse(),s);return[r,n]}function iL(s){const t=[],r=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function W6(s,t){for(const r of s)if(!EZ(r,{upTo:t}))return r}function EZ(s,{upTo:t}){if(getComputedStyle(s).visibility==="hidden")return!0;for(;s;){if(t!==void 0&&s===t)return!1;if(getComputedStyle(s).display==="none")return!0;s=s.parentElement}return!1}function IZ(s){return s instanceof HTMLInputElement&&"select"in s}function Vh(s,{select:t=!1}={}){if(s&&s.focus){const r=document.activeElement;s.focus({preventScroll:!0}),s!==r&&IZ(s)&&t&&s.select()}}var H6=PZ();function PZ(){let s=[];return{add(t){const r=s[0];t!==r&&(r==null||r.pause()),s=G6(s,t),s.unshift(t)},remove(t){var r;s=G6(s,t),(r=s[0])==null||r.resume()}}}function G6(s,t){const r=[...s],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function _Z(s){return s.filter(t=>t.tagName!=="A")}var mu=globalThis!=null&&globalThis.document?x.useLayoutEffect:()=>{},kZ=Zv.useId||(()=>{}),TZ=0;function V5(s){const[t,r]=x.useState(kZ());return mu(()=>{r(n=>n??String(TZ++))},[s]),s||(t?`radix-${t}`:"")}var DZ="Portal",oL=x.forwardRef((s,t)=>{var l;const{container:r,...n}=s,[a,i]=x.useState(!1);mu(()=>i(!0),[]);const o=r||a&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?ey.createPortal(e.jsx(fl.div,{...n,ref:t}),o):null});oL.displayName=DZ;function K6({prop:s,defaultProp:t,onChange:r=()=>{}}){const[n,a]=OZ({defaultProp:t,onChange:r}),i=s!==void 0,o=i?s:n,l=Dm(r),c=x.useCallback(d=>{if(i){const h=typeof d=="function"?d(s):d;h!==s&&l(h)}else a(d)},[i,s,a,l]);return[o,c]}function OZ({defaultProp:s,onChange:t}){const r=x.useState(s),[n]=r,a=x.useRef(n),i=Dm(t);return x.useEffect(()=>{a.current!==n&&(i(n),a.current=n)},[n,a,i]),r}function RZ(s){const t=x.useRef({value:s,previous:s});return x.useMemo(()=>(t.current.value!==s&&(t.current.previous=t.current.value,t.current.value=s),t.current.previous),[s])}var FZ=[" ","Enter","ArrowUp","ArrowDown"],MZ=[" ","Enter"],ay="Select",[aN,iN,LZ]=MR(ay),[bg]=oZ(ay,[LZ,Yb]),oN=Yb(),[$Z,zm]=bg(ay),[BZ,UZ]=bg(ay),lL=s=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:a,onOpenChange:i,value:o,defaultValue:l,onValueChange:c,dir:d,name:u,autoComplete:h,disabled:f,required:m,form:p}=s,g=oN(t),[v,y]=x.useState(null),[j,b]=x.useState(null),[w,N]=x.useState(!1),C=x5(d),[S=!1,_]=K6({prop:n,defaultProp:a,onChange:i}),[k,F]=K6({prop:o,defaultProp:l,onChange:c}),A=x.useRef(null),T=v?p||!!v.closest("form"):!0,[V,M]=x.useState(new Set),G=Array.from(V).map(L=>L.props.value).join(";");return e.jsx($R,{...g,children:e.jsxs($Z,{required:m,scope:t,trigger:v,onTriggerChange:y,valueNode:j,onValueNodeChange:b,valueNodeHasChildren:w,onValueNodeHasChildrenChange:N,contentId:V5(),value:k,onValueChange:F,open:S,onOpenChange:_,dir:C,triggerPointerDownPosRef:A,disabled:f,children:[e.jsx(aN.Provider,{scope:t,children:e.jsx(BZ,{scope:s.__scopeSelect,onNativeOptionAdd:x.useCallback(L=>{M(J=>new Set(J).add(L))},[]),onNativeOptionRemove:x.useCallback(L=>{M(J=>{const z=new Set(J);return z.delete(L),z})},[]),children:r})}),T?e.jsxs(kL,{"aria-hidden":!0,required:m,tabIndex:-1,name:u,autoComplete:h,value:k,onChange:L=>F(L.target.value),disabled:f,form:p,children:[k===void 0?e.jsx("option",{value:""}):null,Array.from(V)]},G):null]})})};lL.displayName=ay;var cL="SelectTrigger",dL=x.forwardRef((s,t)=>{const{__scopeSelect:r,disabled:n=!1,...a}=s,i=oN(r),o=zm(cL,r),l=o.disabled||n,c=Dc(t,o.onTriggerChange),d=iN(r),u=x.useRef("touch"),[h,f,m]=TL(g=>{const v=d().filter(b=>!b.disabled),y=v.find(b=>b.value===o.value),j=DL(v,g,y);j!==void 0&&o.onValueChange(j.value)}),p=g=>{l||(o.onOpenChange(!0),m()),g&&(o.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)})};return e.jsx(h5,{asChild:!0,...i,children:e.jsx(fl.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":_L(o.value)?"":void 0,...a,ref:c,onClick:to(a.onClick,g=>{g.currentTarget.focus(),u.current!=="mouse"&&p(g)}),onPointerDown:to(a.onPointerDown,g=>{u.current=g.pointerType;const v=g.target;v.hasPointerCapture(g.pointerId)&&v.releasePointerCapture(g.pointerId),g.button===0&&g.ctrlKey===!1&&g.pointerType==="mouse"&&(p(g),g.preventDefault())}),onKeyDown:to(a.onKeyDown,g=>{const v=h.current!=="";!(g.ctrlKey||g.altKey||g.metaKey)&&g.key.length===1&&f(g.key),!(v&&g.key===" ")&&FZ.includes(g.key)&&(p(),g.preventDefault())})})})});dL.displayName=cL;var uL="SelectValue",hL=x.forwardRef((s,t)=>{const{__scopeSelect:r,className:n,style:a,children:i,placeholder:o="",...l}=s,c=zm(uL,r),{onValueNodeHasChildrenChange:d}=c,u=i!==void 0,h=Dc(t,c.onValueNodeChange);return mu(()=>{d(u)},[d,u]),e.jsx(fl.span,{...l,ref:h,style:{pointerEvents:"none"},children:_L(c.value)?e.jsx(e.Fragment,{children:o}):i})});hL.displayName=uL;var zZ="SelectIcon",mL=x.forwardRef((s,t)=>{const{__scopeSelect:r,children:n,...a}=s;return e.jsx(fl.span,{"aria-hidden":!0,...a,ref:t,children:n||""})});mL.displayName=zZ;var qZ="SelectPortal",fL=s=>e.jsx(oL,{asChild:!0,...s});fL.displayName=qZ;var Zf="SelectContent",xL=x.forwardRef((s,t)=>{const r=zm(Zf,s.__scopeSelect),[n,a]=x.useState();if(mu(()=>{a(new DocumentFragment)},[]),!r.open){const i=n;return i?$m.createPortal(e.jsx(pL,{scope:s.__scopeSelect,children:e.jsx(aN.Slot,{scope:s.__scopeSelect,children:e.jsx("div",{children:s.children})})}),i):null}return e.jsx(gL,{...s,ref:t})});xL.displayName=Zf;var vd=10,[pL,qm]=bg(Zf),VZ="SelectContentImpl",gL=x.forwardRef((s,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:i,onPointerDownOutside:o,side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:p,hideWhenDetached:g,avoidCollisions:v,...y}=s,j=zm(Zf,r),[b,w]=x.useState(null),[N,C]=x.useState(null),S=Dc(t,be=>w(be)),[_,k]=x.useState(null),[F,A]=x.useState(null),T=iN(r),[V,M]=x.useState(!1),G=x.useRef(!1);x.useEffect(()=>{if(b)return m5(b)},[b]),wZ();const L=x.useCallback(be=>{const[pe,...Ae]=T().map(O=>O.ref.current),[Ee]=Ae.slice(-1),$e=document.activeElement;for(const O of be)if(O===$e||(O==null||O.scrollIntoView({block:"nearest"}),O===pe&&N&&(N.scrollTop=0),O===Ee&&N&&(N.scrollTop=N.scrollHeight),O==null||O.focus(),document.activeElement!==$e))return},[T,N]),J=x.useCallback(()=>L([_,b]),[L,_,b]);x.useEffect(()=>{V&&J()},[V,J]);const{onOpenChange:z,triggerPointerDownPosRef:U}=j;x.useEffect(()=>{if(b){let be={x:0,y:0};const pe=Ee=>{var $e,O;be={x:Math.abs(Math.round(Ee.pageX)-((($e=U.current)==null?void 0:$e.x)??0)),y:Math.abs(Math.round(Ee.pageY)-(((O=U.current)==null?void 0:O.y)??0))}},Ae=Ee=>{be.x<=10&&be.y<=10?Ee.preventDefault():b.contains(Ee.target)||z(!1),document.removeEventListener("pointermove",pe),U.current=null};return U.current!==null&&(document.addEventListener("pointermove",pe),document.addEventListener("pointerup",Ae,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",pe),document.removeEventListener("pointerup",Ae,{capture:!0})}}},[b,z,U]),x.useEffect(()=>{const be=()=>z(!1);return window.addEventListener("blur",be),window.addEventListener("resize",be),()=>{window.removeEventListener("blur",be),window.removeEventListener("resize",be)}},[z]);const[oe,Q]=TL(be=>{const pe=T().filter($e=>!$e.disabled),Ae=pe.find($e=>$e.ref.current===document.activeElement),Ee=DL(pe,be,Ae);Ee&&setTimeout(()=>Ee.ref.current.focus())}),P=x.useCallback((be,pe,Ae)=>{const Ee=!G.current&&!Ae;(j.value!==void 0&&j.value===pe||Ee)&&(k(be),Ee&&(G.current=!0))},[j.value]),q=x.useCallback(()=>b==null?void 0:b.focus(),[b]),D=x.useCallback((be,pe,Ae)=>{const Ee=!G.current&&!Ae;(j.value!==void 0&&j.value===pe||Ee)&&A(be)},[j.value]),se=n==="popper"?TC:vL,he=se===TC?{side:l,sideOffset:c,align:d,alignOffset:u,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:p,hideWhenDetached:g,avoidCollisions:v}:{};return e.jsx(pL,{scope:r,content:b,viewport:N,onViewportChange:C,itemRefCallback:P,selectedItem:_,onItemLeave:q,itemTextRefCallback:D,focusSelectedItem:J,selectedItemText:F,position:n,isPositioned:V,searchRef:oe,children:e.jsx(f5,{as:q5,allowPinchZoom:!0,children:e.jsx(aL,{asChild:!0,trapped:j.open,onMountAutoFocus:be=>{be.preventDefault()},onUnmountAutoFocus:to(a,be=>{var pe;(pe=j.trigger)==null||pe.focus({preventScroll:!0}),be.preventDefault()}),children:e.jsx(rL,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:be=>be.preventDefault(),onDismiss:()=>j.onOpenChange(!1),children:e.jsx(se,{role:"listbox",id:j.contentId,"data-state":j.open?"open":"closed",dir:j.dir,onContextMenu:be=>be.preventDefault(),...y,...he,onPlaced:()=>M(!0),ref:S,style:{display:"flex",flexDirection:"column",outline:"none",...y.style},onKeyDown:to(y.onKeyDown,be=>{const pe=be.ctrlKey||be.altKey||be.metaKey;if(be.key==="Tab"&&be.preventDefault(),!pe&&be.key.length===1&&Q(be.key),["ArrowUp","ArrowDown","Home","End"].includes(be.key)){let Ee=T().filter($e=>!$e.disabled).map($e=>$e.ref.current);if(["ArrowUp","End"].includes(be.key)&&(Ee=Ee.slice().reverse()),["ArrowUp","ArrowDown"].includes(be.key)){const $e=be.target,O=Ee.indexOf($e);Ee=Ee.slice(O+1)}setTimeout(()=>L(Ee)),be.preventDefault()}})})})})})})});gL.displayName=VZ;var WZ="SelectItemAlignedPosition",vL=x.forwardRef((s,t)=>{const{__scopeSelect:r,onPlaced:n,...a}=s,i=zm(Zf,r),o=qm(Zf,r),[l,c]=x.useState(null),[d,u]=x.useState(null),h=Dc(t,S=>u(S)),f=iN(r),m=x.useRef(!1),p=x.useRef(!0),{viewport:g,selectedItem:v,selectedItemText:y,focusSelectedItem:j}=o,b=x.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&d&&g&&v&&y){const S=i.trigger.getBoundingClientRect(),_=d.getBoundingClientRect(),k=i.valueNode.getBoundingClientRect(),F=y.getBoundingClientRect();if(i.dir!=="rtl"){const $e=F.left-_.left,O=k.left-$e,te=S.left-O,re=S.width+te,le=Math.max(re,_.width),Z=window.innerWidth-vd,K=PC(O,[vd,Math.max(vd,Z-le)]);l.style.minWidth=re+"px",l.style.left=K+"px"}else{const $e=_.right-F.right,O=window.innerWidth-k.right-$e,te=window.innerWidth-S.right-O,re=S.width+te,le=Math.max(re,_.width),Z=window.innerWidth-vd,K=PC(O,[vd,Math.max(vd,Z-le)]);l.style.minWidth=re+"px",l.style.right=K+"px"}const A=f(),T=window.innerHeight-vd*2,V=g.scrollHeight,M=window.getComputedStyle(d),G=parseInt(M.borderTopWidth,10),L=parseInt(M.paddingTop,10),J=parseInt(M.borderBottomWidth,10),z=parseInt(M.paddingBottom,10),U=G+L+V+z+J,oe=Math.min(v.offsetHeight*5,U),Q=window.getComputedStyle(g),P=parseInt(Q.paddingTop,10),q=parseInt(Q.paddingBottom,10),D=S.top+S.height/2-vd,se=T-D,he=v.offsetHeight/2,be=v.offsetTop+he,pe=G+L+be,Ae=U-pe;if(pe<=D){const $e=A.length>0&&v===A[A.length-1].ref.current;l.style.bottom="0px";const O=d.clientHeight-g.offsetTop-g.offsetHeight,te=Math.max(se,he+($e?q:0)+O+J),re=pe+te;l.style.height=re+"px"}else{const $e=A.length>0&&v===A[0].ref.current;l.style.top="0px";const te=Math.max(D,G+g.offsetTop+($e?P:0)+he)+Ae;l.style.height=te+"px",g.scrollTop=pe-D+g.offsetTop}l.style.margin=`${vd}px 0`,l.style.minHeight=oe+"px",l.style.maxHeight=T+"px",n==null||n(),requestAnimationFrame(()=>m.current=!0)}},[f,i.trigger,i.valueNode,l,d,g,v,y,i.dir,n]);mu(()=>b(),[b]);const[w,N]=x.useState();mu(()=>{d&&N(window.getComputedStyle(d).zIndex)},[d]);const C=x.useCallback(S=>{S&&p.current===!0&&(b(),j==null||j(),p.current=!1)},[b,j]);return e.jsx(GZ,{scope:r,contentWrapper:l,shouldExpandOnScrollRef:m,onScrollButtonChange:C,children:e.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:w},children:e.jsx(fl.div,{...a,ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});vL.displayName=WZ;var HZ="SelectPopperPosition",TC=x.forwardRef((s,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:a=vd,...i}=s,o=oN(r);return e.jsx(BR,{...o,...i,ref:t,align:n,collisionPadding:a,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});TC.displayName=HZ;var[GZ,W5]=bg(Zf,{}),DC="SelectViewport",yL=x.forwardRef((s,t)=>{const{__scopeSelect:r,nonce:n,...a}=s,i=qm(DC,r),o=W5(DC,r),l=Dc(t,i.onViewportChange),c=x.useRef(0);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),e.jsx(aN.Slot,{scope:r,children:e.jsx(fl.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:to(a.onScroll,d=>{const u=d.currentTarget,{contentWrapper:h,shouldExpandOnScrollRef:f}=o;if(f!=null&&f.current&&h){const m=Math.abs(c.current-u.scrollTop);if(m>0){const p=window.innerHeight-vd*2,g=parseFloat(h.style.minHeight),v=parseFloat(h.style.height),y=Math.max(g,v);if(y<p){const j=y+m,b=Math.min(p,j),w=j-b;h.style.height=b+"px",h.style.bottom==="0px"&&(u.scrollTop=w>0?w:0,h.style.justifyContent="flex-end")}}}c.current=u.scrollTop})})})]})});yL.displayName=DC;var jL="SelectGroup",[KZ,YZ]=bg(jL),JZ=x.forwardRef((s,t)=>{const{__scopeSelect:r,...n}=s,a=V5();return e.jsx(KZ,{scope:r,id:a,children:e.jsx(fl.div,{role:"group","aria-labelledby":a,...n,ref:t})})});JZ.displayName=jL;var bL="SelectLabel",XZ=x.forwardRef((s,t)=>{const{__scopeSelect:r,...n}=s,a=YZ(bL,r);return e.jsx(fl.div,{id:a.id,...n,ref:t})});XZ.displayName=bL;var i1="SelectItem",[QZ,NL]=bg(i1),wL=x.forwardRef((s,t)=>{const{__scopeSelect:r,value:n,disabled:a=!1,textValue:i,...o}=s,l=zm(i1,r),c=qm(i1,r),d=l.value===n,[u,h]=x.useState(i??""),[f,m]=x.useState(!1),p=Dc(t,j=>{var b;return(b=c.itemRefCallback)==null?void 0:b.call(c,j,n,a)}),g=V5(),v=x.useRef("touch"),y=()=>{a||(l.onValueChange(n),l.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return e.jsx(QZ,{scope:r,value:n,disabled:a,textId:g,isSelected:d,onItemTextChange:x.useCallback(j=>{h(b=>b||((j==null?void 0:j.textContent)??"").trim())},[]),children:e.jsx(aN.ItemSlot,{scope:r,value:n,disabled:a,textValue:u,children:e.jsx(fl.div,{role:"option","aria-labelledby":g,"data-highlighted":f?"":void 0,"aria-selected":d&&f,"data-state":d?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...o,ref:p,onFocus:to(o.onFocus,()=>m(!0)),onBlur:to(o.onBlur,()=>m(!1)),onClick:to(o.onClick,()=>{v.current!=="mouse"&&y()}),onPointerUp:to(o.onPointerUp,()=>{v.current==="mouse"&&y()}),onPointerDown:to(o.onPointerDown,j=>{v.current=j.pointerType}),onPointerMove:to(o.onPointerMove,j=>{var b;v.current=j.pointerType,a?(b=c.onItemLeave)==null||b.call(c):v.current==="mouse"&&j.currentTarget.focus({preventScroll:!0})}),onPointerLeave:to(o.onPointerLeave,j=>{var b;j.currentTarget===document.activeElement&&((b=c.onItemLeave)==null||b.call(c))}),onKeyDown:to(o.onKeyDown,j=>{var w;((w=c.searchRef)==null?void 0:w.current)!==""&&j.key===" "||(MZ.includes(j.key)&&y(),j.key===" "&&j.preventDefault())})})})})});wL.displayName=i1;var j0="SelectItemText",SL=x.forwardRef((s,t)=>{const{__scopeSelect:r,className:n,style:a,...i}=s,o=zm(j0,r),l=qm(j0,r),c=NL(j0,r),d=UZ(j0,r),[u,h]=x.useState(null),f=Dc(t,y=>h(y),c.onItemTextChange,y=>{var j;return(j=l.itemTextRefCallback)==null?void 0:j.call(l,y,c.value,c.disabled)}),m=u==null?void 0:u.textContent,p=x.useMemo(()=>e.jsx("option",{value:c.value,disabled:c.disabled,children:m},c.value),[c.disabled,c.value,m]),{onNativeOptionAdd:g,onNativeOptionRemove:v}=d;return mu(()=>(g(p),()=>v(p)),[g,v,p]),e.jsxs(e.Fragment,{children:[e.jsx(fl.span,{id:c.textId,...i,ref:f}),c.isSelected&&o.valueNode&&!o.valueNodeHasChildren?$m.createPortal(i.children,o.valueNode):null]})});SL.displayName=j0;var CL="SelectItemIndicator",AL=x.forwardRef((s,t)=>{const{__scopeSelect:r,...n}=s;return NL(CL,r).isSelected?e.jsx(fl.span,{"aria-hidden":!0,...n,ref:t}):null});AL.displayName=CL;var OC="SelectScrollUpButton",EL=x.forwardRef((s,t)=>{const r=qm(OC,s.__scopeSelect),n=W5(OC,s.__scopeSelect),[a,i]=x.useState(!1),o=Dc(t,n.onScrollButtonChange);return mu(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollTop>0;i(d)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),a?e.jsx(PL,{...s,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});EL.displayName=OC;var RC="SelectScrollDownButton",IL=x.forwardRef((s,t)=>{const r=qm(RC,s.__scopeSelect),n=W5(RC,s.__scopeSelect),[a,i]=x.useState(!1),o=Dc(t,n.onScrollButtonChange);return mu(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollHeight-c.clientHeight,u=Math.ceil(c.scrollTop)<d;i(u)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),a?e.jsx(PL,{...s,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});IL.displayName=RC;var PL=x.forwardRef((s,t)=>{const{__scopeSelect:r,onAutoScroll:n,...a}=s,i=qm("SelectScrollButton",r),o=x.useRef(null),l=iN(r),c=x.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return x.useEffect(()=>()=>c(),[c]),mu(()=>{var u;const d=l().find(h=>h.ref.current===document.activeElement);(u=d==null?void 0:d.ref.current)==null||u.scrollIntoView({block:"nearest"})},[l]),e.jsx(fl.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:to(a.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(n,50))}),onPointerMove:to(a.onPointerMove,()=>{var d;(d=i.onItemLeave)==null||d.call(i),o.current===null&&(o.current=window.setInterval(n,50))}),onPointerLeave:to(a.onPointerLeave,()=>{c()})})}),ZZ="SelectSeparator",eee=x.forwardRef((s,t)=>{const{__scopeSelect:r,...n}=s;return e.jsx(fl.div,{"aria-hidden":!0,...n,ref:t})});eee.displayName=ZZ;var FC="SelectArrow",tee=x.forwardRef((s,t)=>{const{__scopeSelect:r,...n}=s,a=oN(r),i=zm(FC,r),o=qm(FC,r);return i.open&&o.position==="popper"?e.jsx(UR,{...a,...n,ref:t}):null});tee.displayName=FC;function _L(s){return s===""||s===void 0}var kL=x.forwardRef((s,t)=>{const{value:r,...n}=s,a=x.useRef(null),i=Dc(t,a),o=RZ(r);return x.useEffect(()=>{const l=a.current,c=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(c,"value").set;if(o!==r&&u){const h=new Event("change",{bubbles:!0});u.call(l,r),l.dispatchEvent(h)}},[o,r]),e.jsx(Xb,{asChild:!0,children:e.jsx("select",{...n,ref:i,defaultValue:r})})});kL.displayName="BubbleSelect";function TL(s){const t=Dm(s),r=x.useRef(""),n=x.useRef(0),a=x.useCallback(o=>{const l=r.current+o;t(l),function c(d){r.current=d,window.clearTimeout(n.current),d!==""&&(n.current=window.setTimeout(()=>c(""),1e3))}(l)},[t]),i=x.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return x.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,a,i]}function DL(s,t,r){const a=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,i=r?s.indexOf(r):-1;let o=see(s,Math.max(i,0));a.length===1&&(o=o.filter(d=>d!==r));const c=o.find(d=>d.textValue.toLowerCase().startsWith(a.toLowerCase()));return c!==r?c:void 0}function see(s,t){return s.map((r,n)=>s[(t+n)%s.length])}var ree=lL,nee=dL,aee=hL,iee=mL,oee=fL,lee=xL,cee=yL,dee=wL,uee=SL,hee=AL,mee=EL,fee=IL;function rt({...s}){return e.jsx(ree,{"data-slot":"select",...s})}function it({...s}){return e.jsx(aee,{"data-slot":"select-value",...s})}function nt({className:s,size:t="default",children:r,...n}){return e.jsxs(nee,{"data-slot":"select-trigger","data-size":t,className:ns("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...n,children:[r,e.jsx(iee,{asChild:!0,children:e.jsx(tc,{className:"size-4 opacity-50"})})]})}function at({className:s,children:t,position:r="popper",...n}){return e.jsx(oee,{children:e.jsxs(lee,{"data-slot":"select-content",className:ns("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:r,...n,children:[e.jsx(xee,{}),e.jsx(cee,{className:ns("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),e.jsx(pee,{})]})})}function W({className:s,children:t,...r}){return e.jsxs(dee,{"data-slot":"select-item",className:ns("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",s),...r,children:[e.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:e.jsx(hee,{children:e.jsx(Ro,{className:"size-4"})})}),e.jsx(uee,{children:t})]})}function xee({className:s,...t}){return e.jsx(mee,{"data-slot":"select-scroll-up-button",className:ns("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(um,{className:"size-4"})})}function pee({className:s,...t}){return e.jsx(fee,{"data-slot":"select-scroll-down-button",className:ns("flex cursor-default items-center justify-center py-1",s),...t,children:e.jsx(tc,{className:"size-4"})})}function OL(s,t=30){const[r,n]=x.useState(null),[a,i]=x.useState(!0),[o,l]=x.useState(null),{user:c}=Ua(),d=async()=>{var h;if(console.log("=== DASHBOARD DATA FETCH DEBUG ==="),console.log("companyId received:",s),console.log("companyId type:",typeof s),console.log("companyId length:",s==null?void 0:s.length),console.log("period:",t),!s){console.log(" No companyId provided, aborting fetch"),l("Company ID is required"),i(!1);return}i(!0),l(null);try{const f=localStorage.getItem("auth_token"),m=Ii();if(console.log("Auth token exists:",!!f),console.log("Tenant ID:",m),!f)throw new Error("No authentication token found");const p=`${un()}/api/dashboard?companyId=${s}&period=${t}`;console.log("Making API call to:",p);const g=await fetch(p,{headers:{Authorization:`Bearer ${f}`,"x-tenant-id":m,"Content-Type":"application/json"}});if(!g.ok){const y=await g.json();throw new Error(y.message||`HTTP error! status: ${g.status}`)}const v=await g.json();console.log(" Dashboard data received:",v),console.log("Revenue from API:",(h=v==null?void 0:v.metrics)==null?void 0:h.totalRevenue),n(v)}catch(f){console.error(" Error fetching dashboard data:",f),l(f instanceof Error?f.message:"Failed to fetch dashboard data")}finally{i(!1)}};return x.useEffect(()=>{d()},[s,t]),{data:r,loading:a,error:o,refetch:()=>{d()}}}const gee=[{title:"Total Revenue",value:"$2,847,392",change:"+12.5%",trend:"up",icon:Mr,color:"text-green-600",description:"vs. last month"},{title:"Total Expenses",value:"$1,923,847",change:"+8.2%",trend:"up",icon:$o,color:"text-orange-600",description:"vs. last month"},{title:"Net Profit",value:"$923,545",change:"+18.7%",trend:"up",icon:$s,color:"text-blue-600",description:"vs. last month"},{title:"Profit Margin",value:"32.4%",change:"+4.2%",trend:"up",icon:wa,color:"text-purple-600",description:"vs. last month"},{title:"Active Clients",value:"47",change:"+3",trend:"up",icon:Sa,color:"text-cyan-600",description:"new this month"},{title:"Pending Invoices",value:"$184,293",change:"-8.2%",trend:"down",icon:Zt,color:"text-red-600",description:"vs. last month"},{title:"Cash Flow",value:"$456,789",change:"+15.3%",trend:"up",icon:or,color:"text-emerald-600",description:"vs. last month"},{title:"AI Anomalies",value:"12",change:"+4",trend:"up",icon:Ln,color:"text-amber-600",description:"detected this month"}],Jy=[{month:"Jan",revenue:185e3,expenses:142e3,profit:43e3},{month:"Feb",revenue:192e3,expenses:148e3,profit:44e3},{month:"Mar",revenue:198e3,expenses:151e3,profit:47e3},{month:"Apr",revenue:205e3,expenses:155e3,profit:5e4},{month:"May",revenue:212e3,expenses:158e3,profit:54e3},{month:"Jun",revenue:218e3,expenses:162e3,profit:56e3},{month:"Jul",revenue:225e3,expenses:165e3,profit:6e4},{month:"Aug",revenue:232e3,expenses:168e3,profit:64e3},{month:"Sep",revenue:238e3,expenses:172e3,profit:66e3},{month:"Oct",revenue:245e3,expenses:175e3,profit:7e4},{month:"Nov",revenue:252e3,expenses:178e3,profit:74e3},{month:"Dec",revenue:259e3,expenses:182e3,profit:77e3}],vee=[{name:"Consulting Services",revenue:"$892,456",percentage:31.3,trend:"up"},{name:"Software Licenses",revenue:"$567,234",percentage:19.9,trend:"up"},{name:"Training & Support",revenue:"$445,123",percentage:15.6,trend:"up"},{name:"Custom Development",revenue:"$334,567",percentage:11.8,trend:"down"},{name:"Maintenance",revenue:"$223,456",percentage:7.9,trend:"neutral"}],yee=[{id:"TXN-001",description:"Invoice #INV-2024-001",amount:"$12,500",type:"revenue",date:"2 hours ago"},{id:"TXN-002",description:"Office Supplies",amount:"$1,250",type:"expense",date:"4 hours ago"},{id:"TXN-003",description:"Client Payment - ABC Corp",amount:"$8,750",type:"revenue",date:"1 day ago"},{id:"TXN-004",description:"Software Subscription",amount:"$2,100",type:"expense",date:"2 days ago"},{id:"TXN-005",description:"Consulting Fee",amount:"$15,000",type:"revenue",date:"3 days ago"}];function jee({companyId:s}){var C,S,_,k,F;const{data:t,loading:r,error:n}=OL(s),[a,i]=x.useState(1),[o,l]=x.useState(2),c=t?{revenue:t.metrics.totalRevenue,expenses:t.metrics.totalExpenses,profit:t.metrics.netProfit}:Jy[Jy.length-1],d=((C=t==null?void 0:t.monthlyTrend)==null?void 0:C[t.monthlyTrend.length-2])||Jy[Jy.length-2],u=(A,T)=>!isFinite(A)||!isFinite(T)||T===0?0:(A-T)/T*100,h=((S=t==null?void 0:t.changes)==null?void 0:S.revenue)??u(c.revenue,d.revenue),f=((_=t==null?void 0:t.changes)==null?void 0:_.expenses)??u(c.expenses,d.expenses),m=((k=t==null?void 0:t.changes)==null?void 0:k.profit)??u(c.profit,d.profit),p=t?[{title:"Total Revenue",value:`$${t.metrics.totalRevenue.toLocaleString()}`,change:`${h>0?"+":""}${h.toFixed(1)}%`,trend:h>0?"up":h<0?"down":"neutral",icon:Mr,color:"text-green-600",description:"vs. last period"},{title:"Total Expenses",value:`$${t.metrics.totalExpenses.toLocaleString()}`,change:`${f>0?"+":""}${f.toFixed(1)}%`,trend:f>0?"up":f<0?"down":"neutral",icon:$o,color:"text-orange-600",description:"vs. last period"},{title:"Net Profit",value:`$${t.metrics.netProfit.toLocaleString()}`,change:`${m>0?"+":""}${m.toFixed(1)}%`,trend:m>0?"up":m<0?"down":"neutral",icon:$s,color:"text-blue-600",description:"vs. last period"},{title:"Profit Margin",value:`${t.metrics.profitMargin.toFixed(1)}%`,change:`${m>0?"+":""}${m.toFixed(1)}%`,trend:m>0?"up":m<0?"down":"neutral",icon:wa,color:"text-purple-600",description:"vs. last period"},{title:"Active Clients",value:t.metrics.activeCustomers.toString(),change:"+0",trend:"neutral",icon:Sa,color:"text-cyan-600",description:"total customers"},{title:"Pending Invoices",value:`$${t.metrics.pendingInvoices.toLocaleString()}`,change:"-0%",trend:"neutral",icon:Zt,color:"text-red-600",description:"awaiting payment"},{title:"Cash Flow",value:`$${t.metrics.netProfit.toLocaleString()}`,change:`${m>0?"+":""}${m.toFixed(1)}%`,trend:m>0?"up":m<0?"down":"neutral",icon:or,color:"text-emerald-600",description:"vs. last period"},{title:"Overdue Invoices",value:`$${t.metrics.overdueInvoices.toLocaleString()}`,change:"+0",trend:"neutral",icon:Ln,color:"text-amber-600",description:"past due"}]:gee,g=(t==null?void 0:t.revenueSources)||vee,v=((F=t==null?void 0:t.recentActivity)==null?void 0:F.map(A=>({id:A.id,description:A.title,amount:`$${A.amount.toLocaleString()}`,type:A.type==="journal_entry"?"revenue":"expense",date:new Date(A.date).toLocaleDateString()})))||yee,y=v.length,j=Math.ceil(y/o),b=(a-1)*o,w=b+o,N=v.slice(b,w);return r?e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx(On,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Loading financial data..."})]}):n?e.jsxs("div",{className:"flex items-center justify-center h-64 text-red-600",children:[e.jsx(Ln,{className:"h-8 w-8 mr-2"}),e.jsxs("span",{children:["Error loading financial data: ",(n==null?void 0:n.message)||(n==null?void 0:n.toString())||"Unknown error"]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"px-6 pt-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Financial Overview"}),e.jsx("p",{className:"text-muted-foreground",children:"Comprehensive view of your financial performance and key metrics"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(Xn,{className:"w-4 h-4 mr-2"}),"This Month"]}),e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(lr,{className:"w-4 h-4 mr-2"}),"Export Report"]})]})]}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4 px-8 py-2",children:p.slice(0,4).map((A,T)=>{const V=["from-green-50 to-emerald-100 border-green-200","from-orange-50 to-amber-100 border-orange-200","from-blue-50 to-cyan-100 border-blue-200","from-purple-50 to-indigo-100 border-purple-200"][T]||"from-gray-50 to-slate-100 border-gray-200";return e.jsxs(ne,{className:`bg-gradient-to-br ${V} hover:shadow-xl transition-all duration-300 transform hover:scale-105 border-2`,children:[e.jsx(we,{className:"flex flex-row items-center justify-between space-y-0 pb-3",children:e.jsxs("div",{children:[e.jsx(Se,{className:"text-sm font-semibold text-slate-700",children:A.title}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:e.jsx("div",{className:`p-2 rounded-lg ${A.color.includes("green")?"bg-green-500":A.color.includes("orange")?"bg-orange-500":A.color.includes("blue")?"bg-blue-500":"bg-purple-500"}`,children:e.jsx(A.icon,{className:"w-4 h-4 text-white"})})})]})}),e.jsxs(ie,{className:"pt-0",children:[e.jsx("div",{className:"text-3xl font-bold text-slate-900 mb-2",children:A.value}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[A.trend==="up"?e.jsxs("div",{className:"flex items-center gap-1 text-green-600 bg-green-100 px-2 py-1 rounded-full",children:[e.jsx(Lu,{className:"w-3 h-3"}),e.jsx("span",{className:"font-semibold",children:A.change})]}):A.trend==="down"?e.jsxs("div",{className:"flex items-center gap-1 text-red-600 bg-red-100 px-2 py-1 rounded-full",children:[e.jsx(Gh,{className:"w-3 h-3"}),e.jsx("span",{className:"font-semibold",children:A.change})]}):e.jsx("div",{className:"flex items-center gap-1 text-slate-600 bg-slate-100 px-2 py-1 rounded-full",children:e.jsx("span",{className:"font-semibold",children:A.change})}),e.jsx("span",{className:"text-slate-600 font-medium",children:A.description})]})]})]},A.title)})}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4  px-6",children:p.slice(4).map(A=>e.jsxs(ne,{className:"hover:shadow-md transition-shadow",children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium text-muted-foreground",children:A.title}),e.jsx(A.icon,{className:`w-4 h-4 ${A.color}`})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:A.value}),e.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[A.trend==="up"?e.jsx(Lu,{className:"w-3 h-3 text-green-500"}):A.trend==="down"?e.jsx(Gh,{className:"w-3 h-3 text-red-500"}):e.jsx("div",{className:"w-3 h-3"}),e.jsx("span",{className:A.trend==="up"?"text-green-500":A.trend==="down"?"text-red-500":"text-muted-foreground",children:A.change}),e.jsx("span",{className:"text-muted-foreground",children:A.description})]})]})]},A.title))}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Eo,{className:"w-5 h-5"}),"Top Revenue Sources"]}),e.jsx(Vt,{children:"Breakdown of revenue by business line"})]}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:g.length>0?g.map((A,T)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:A.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[A.percentage,"% of total"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium text-sm",children:["$",typeof A.revenue=="number"?A.revenue.toLocaleString():A.revenue]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[A.trend==="up"?e.jsx(Lu,{className:"w-3 h-3 text-green-500"}):A.trend==="down"?e.jsx(Gh,{className:"w-3 h-3 text-red-500"}):e.jsx("div",{className:"w-3 h-3"}),e.jsx("span",{className:A.trend==="up"?"text-green-500":A.trend==="down"?"text-red-500":"text-muted-foreground",children:A.trend==="up"?"+":A.trend==="down"?"-":"0"})]})]})]},`${A.name}-${T}`)):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Eo,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No revenue data available"}),e.jsx("p",{className:"text-xs",children:"Revenue sources will appear here once you have paid invoices"})]})})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(or,{className:"w-5 h-5"}),"Recent Transactions"]}),e.jsx(Vt,{children:"Latest financial activities"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[N.map(A=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${A.type==="revenue"?"bg-green-500":"bg-red-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:A.description}),e.jsx("p",{className:"text-xs text-muted-foreground",children:A.id})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`font-medium text-sm ${A.type==="revenue"?"text-green-600":"text-red-600"}`,children:[A.type==="revenue"?"+":"-",A.amount]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:A.date})]})]},A.id)),j>1&&e.jsxs("div",{className:"flex items-center justify-between mt-6 pt-6 border-t border-border",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",b+1," to ",Math.min(w,y)," of ",y," transactions"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{variant:"outline",size:"sm",onClick:()=>i(1),disabled:a===1,children:e.jsx(XF,{className:"h-4 w-4"})}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>i(a-1),disabled:a===1,children:e.jsx(tN,{className:"h-4 w-4"})}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Page ",a," of ",j]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>i(a+1),disabled:a===j,children:e.jsx(Tm,{className:"h-4 w-4"})}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>i(j),disabled:a===j,children:e.jsx(QF,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Page size:"}),e.jsxs(rt,{value:o.toString(),onValueChange:A=>{l(parseInt(A)),i(1)},children:[e.jsx(nt,{className:"w-20",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"3",children:"3"}),e.jsx(W,{value:"5",children:"5"}),e.jsx(W,{value:"10",children:"10"}),e.jsx(W,{value:"20",children:"20"})]})]})]})]})]})})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx($s,{className:"w-5 h-5"}),"Monthly Performance Summary"]}),e.jsx(Vt,{children:"Key metrics comparison with previous month"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"text-center p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Revenue"}),e.jsxs("p",{className:"text-2xl font-bold text-foreground",children:["$",c.revenue.toLocaleString()]}),e.jsxs("div",{className:"flex items-center justify-center gap-1 text-sm",children:[parseFloat(h.toString())>0?e.jsx(Lu,{className:"w-4 h-4 text-green-500"}):e.jsx(Gh,{className:"w-4 h-4 text-red-500"}),e.jsxs("span",{className:parseFloat(h.toString())>0?"text-green-500":"text-red-500",children:[h,"%"]}),e.jsx("span",{className:"text-muted-foreground",children:"vs last month"})]})]}),e.jsxs("div",{className:"text-center p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Expenses"}),e.jsxs("p",{className:"text-2xl font-bold text-foreground",children:["$",c.expenses.toLocaleString()]}),e.jsxs("div",{className:"flex items-center justify-center gap-1 text-sm",children:[parseFloat(f.toString())>0?e.jsx(Lu,{className:"w-4 h-4 text-orange-500"}):e.jsx(Gh,{className:"w-4 h-4 text-green-500"}),e.jsxs("span",{className:parseFloat(f.toString())>0?"text-orange-500":"text-green-500",children:[f,"%"]}),e.jsx("span",{className:"text-muted-foreground",children:"vs last month"})]})]}),e.jsxs("div",{className:"text-center p-4 rounded-lg border",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Net Profit"}),e.jsxs("p",{className:"text-2xl font-bold text-foreground",children:["$",c.profit.toLocaleString()]}),e.jsxs("div",{className:"flex items-center justify-center gap-1 text-sm",children:[parseFloat(m.toString())>0?e.jsx(Lu,{className:"w-4 h-4 text-green-500"}):e.jsx(Gh,{className:"w-4 h-4 text-red-500"}),e.jsxs("span",{className:parseFloat(m.toString())>0?"text-green-500":"text-red-500",children:[m,"%"]}),e.jsx("span",{className:"text-muted-foreground",children:"vs last month"})]})]})]})})]})]})}function RL(){const[s,t]=x.useState([]),[r,n]=x.useState(!0),[a,i]=x.useState(null),o=c=>{try{const d=JSON.parse(c);return{type:d.type||"general",description:d.description||c,confidence:d.confidence||.7,impact:d.impact||"medium"}}catch{return{type:"general",description:c,confidence:.7,impact:"medium"}}},l=async()=>{const c=zs();if(!c){i("Company ID is required"),n(!1);return}try{n(!0),i(null);const d=localStorage.getItem("auth_token")||localStorage.getItem("token");if(!d)throw new Error("No authentication token found");const u=await fetch(`${un()}/api/ai/insights?companyId=${c}`,{headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json","x-tenant-id":Ii(),"x-company-id":c}});if(!u.ok){const m=await u.json();throw new Error(m.message||`HTTP error! status: ${u.status}`)}const f=(await u.json()).map(m=>{const p=o(m.insightText);return{id:m.id,category:m.category,priority:m.priority,generatedAt:m.generatedAt,type:p.type||"general",description:p.description||m.insightText,confidence:p.confidence||.7,impact:p.impact||"medium"}}).filter(m=>m.description&&m.description.length>10).sort((m,p)=>{const g={high:3,medium:2,low:1};return g[m.priority]!==g[p.priority]?g[p.priority]-g[m.priority]:new Date(p.generatedAt).getTime()-new Date(m.generatedAt).getTime()}).slice(0,10);t(f)}catch(d){i(d instanceof Error?d.message:"Failed to fetch AI insights")}finally{n(!1)}};return x.useEffect(()=>{l()},[]),{insights:s,loading:r,error:a,refetch:l}}function bee({maxItems:s=3,showHeader:t=!0,compact:r=!1,showViewAll:n=!0}){const{insights:a,loading:i,error:o,refetch:l}=RL(),[c,d]=x.useState(null),[u,h]=x.useState(!1),f=j=>{switch(j.toLowerCase()){case"revenue":return e.jsx($s,{className:"h-4 w-4"});case"cash_flow":return e.jsx(Mr,{className:"h-4 w-4"});case"expenses":return e.jsx(Za,{className:"h-4 w-4"});case"risk":return e.jsx(Is,{className:"h-4 w-4"});default:return e.jsx(sa,{className:"h-4 w-4"})}},m=j=>{switch(j){case"high":return"bg-red-100 text-red-800 border-red-200";case"medium":return"bg-amber-100 text-amber-800 border-amber-200";case"low":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},p=j=>{switch(j==null?void 0:j.toLowerCase()){case"high":return"text-red-600";case"medium":return"text-amber-600";case"low":return"text-blue-600";default:return"text-gray-600"}},g=j=>{const b=new Date(j),N=Math.floor((new Date().getTime()-b.getTime())/(1e3*60*60));return N<1?"Just now":N<24?`${N}h ago`:N<48?"Yesterday":b.toLocaleDateString()},v=u?a:a.slice(0,s),y=a.length>s;return i?e.jsxs(ne,{children:[t&&e.jsx(we,{className:"pb-3",children:e.jsxs(Se,{className:"text-lg flex items-center gap-2",children:[e.jsx(sa,{className:"h-5 w-5 text-blue-600"}),"AI Insights"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(Ts,{className:"h-4 w-4 animate-spin mr-2"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Loading AI insights..."})]})})]}):o?e.jsxs(ne,{children:[t&&e.jsx(we,{className:"pb-3",children:e.jsxs(Se,{className:"text-lg flex items-center gap-2",children:[e.jsx(sa,{className:"h-5 w-5 text-blue-600"}),"AI Insights"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"flex items-center justify-center py-8 text-red-600",children:[e.jsx(Is,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"text-sm",children:"Error loading insights"}),e.jsx(I,{variant:"ghost",size:"sm",onClick:l,className:"ml-2",children:e.jsx(Ts,{className:"h-3 w-3"})})]})})]}):e.jsxs(ne,{children:[t&&e.jsx(we,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(Se,{className:"text-lg flex items-center gap-2",children:[e.jsx(sa,{className:"h-5 w-5 text-blue-600"}),"AI Insights",e.jsx(Oe,{variant:"secondary",className:"ml-2",children:a.length})]}),e.jsx(Vt,{children:"AI-powered financial insights and recommendations"})]}),e.jsx(I,{variant:"ghost",size:"sm",onClick:l,children:e.jsx(Ts,{className:"h-4 w-4"})})]})}),e.jsx(ie,{className:"space-y-3",children:v.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(sa,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No AI insights available"}),e.jsx("p",{className:"text-xs",children:"AI is analyzing your financial data"})]}):e.jsxs(e.Fragment,{children:[v.map(j=>e.jsx("div",{className:`p-3 rounded-lg border transition-all hover:shadow-sm ${j.priority==="high"?"border-red-200 bg-red-50":j.priority==="medium"?"border-amber-200 bg-amber-50":"border-blue-200 bg-blue-50"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-1 rounded-full ${m(j.priority)}`,children:f(j.category)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Oe,{variant:"outline",className:"text-xs",children:j.category.replace("_"," ").toUpperCase()}),e.jsx(Oe,{variant:"secondary",className:`text-xs ${m(j.priority)}`,children:j.priority.toUpperCase()}),j.confidence&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:[Math.round(j.confidence*100),"% confidence"]})]}),e.jsx("p",{className:`text-sm font-medium mb-1 ${r?"line-clamp-2":"line-clamp-3"}`,children:j.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:g(j.generatedAt)}),j.impact&&e.jsxs("span",{className:`font-medium ${p(j.impact)}`,children:[j.impact.toUpperCase()," IMPACT"]})]}),!r&&j.description.length>100&&e.jsx(I,{variant:"ghost",size:"sm",className:"mt-2 h-6 px-2 text-xs",onClick:()=>d(c===j.id?null:j.id),children:c===j.id?"Show less":"Show more"}),c===j.id&&e.jsx("div",{className:"mt-2 p-2 bg-white/50 rounded border text-xs",children:e.jsxs("p",{className:"text-muted-foreground",children:[e.jsx("strong",{children:"Type:"})," ",j.type,e.jsx("br",{}),e.jsx("strong",{children:"Confidence:"})," ",Math.round(j.confidence*100),"%",e.jsx("br",{}),e.jsx("strong",{children:"Impact:"})," ",j.impact]})})]}),e.jsx(I,{variant:"ghost",size:"sm",className:"opacity-0 group-hover:opacity-100",children:e.jsx(ir,{className:"h-3 w-3"})})]})},j.id)),n&&y&&e.jsx("div",{className:"pt-2 border-t",children:e.jsx(I,{variant:"ghost",size:"sm",className:"w-full text-xs",onClick:()=>h(!u),children:u?e.jsxs(e.Fragment,{children:[e.jsx(um,{className:"h-3 w-3 mr-1"}),"View Less (",s," of ",a.length,")"]}):e.jsxs(e.Fragment,{children:[e.jsx(tc,{className:"h-3 w-3 mr-1"}),"View All ",a.length," Insights"]})})})]})})]})}const Nee={sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8",xl:"h-12 w-12"},wee={sm:"w-1 h-1",md:"w-1.5 h-1.5",lg:"w-2 h-2",xl:"w-3 h-3"},Y6={teal:{ring:"border-teal-200",dot:"bg-teal-500"},blue:{ring:"border-blue-200",dot:"bg-blue-500"},green:{ring:"border-green-200",dot:"bg-green-500"},purple:{ring:"border-purple-200",dot:"bg-purple-500"},gray:{ring:"border-gray-200",dot:"bg-gray-500"}},kr=({size:s="md",className:t="",color:r="teal"})=>{const n=Nee[s],a=wee[s],i=Y6[r]||Y6.teal;return e.jsxs("div",{className:`relative ${n} ${t}`,children:[e.jsx("div",{className:`absolute inset-0 rounded-full border-2 ${i.ring}`}),e.jsx("div",{className:`absolute top-0 left-1/2 transform -translate-x-1/2 ${a} ${i.dot} rounded-full`,style:{animation:"moonLoaderRotate 1s linear infinite",transformOrigin:"50% 200%"}}),e.jsx("style",{dangerouslySetInnerHTML:{__html:`
          @keyframes moonLoaderRotate {
            0% {
              transform: translateX(-50%) rotate(0deg);
            }
            100% {
              transform: translateX(-50%) rotate(360deg);
            }
          }
        `}})]})};function See({companyId:s,onNavigate:t,showQuickStats:r=!0,showRecentActivity:n=!0,compact:a=!1}){const{isAuthenticated:i}=Ua(),o=s||zs();console.log(" Journal Navigation Bridge - Company Context:",{propCompanyId:s,currentCompanyId:o,isAuthenticated:i,showQuickStats:r,showRecentActivity:n,localStorage:{company_id:localStorage.getItem("company_id"),companyId:localStorage.getItem("companyId"),company:localStorage.getItem("company"),tenant_id:localStorage.getItem("tenant_id"),auth_token:localStorage.getItem("auth_token")?"present":"missing"}}),console.log(" Journal Navigation Bridge - Query Enablement:",{quickStatsEnabled:!!o&&i&&r,recentActivityEnabled:!!o&&i&&n,reasons:{hasCompanyId:!!o,isAuthenticated:i,showQuickStats:r,showRecentActivity:n}});const[d,u]=x.useState("overview"),{data:h,isLoading:f}=ys({queryKey:["journal-quick-stats",o],queryFn:()=>(console.log(" Fetching journal quick stats for company:",o),de.getJournalSummary({companyId:o})),enabled:!!o&&i&&r,onError:v=>{console.error(" Journal quick stats query error:",v)}}),{data:m,isLoading:p}=ys({queryKey:["journal-recent-activity",o],queryFn:async()=>{console.log(" Fetching journal recent activity for company:",o);const[v,y]=await Promise.all([de.getJournalEntries({companyId:o,pageSize:3,sortBy:"createdAt",sortOrder:"desc"}),de.getPendingApprovals()]);return console.log(" Journal Navigation Bridge - API Response:",{entries:v,entriesType:typeof v,entriesIsArray:Array.isArray(v),entriesEntries:v==null?void 0:v.entries,entriesEntriesType:typeof(v==null?void 0:v.entries),entriesEntriesIsArray:Array.isArray(v==null?void 0:v.entries),approvals:y,approvalsType:typeof y,approvalsIsArray:Array.isArray(y)}),{entries:Array.isArray(v==null?void 0:v.entries)?v.entries:Array.isArray(v)?v:[],approvals:Array.isArray(y)?y:[]}},enabled:!!o&&i&&n,onError:v=>{console.error(" Journal recent activity query error:",v)}}),g=v=>{t?t(v):window.location.href=v};return o?i?a?e.jsx(ne,{className:"w-full",children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ml,{className:"w-5 h-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:"Journal Entries Hub"}),e.jsx("p",{className:"text-xs text-gray-500",children:f?"Loading...":`${(h==null?void 0:h.totalEntries)||0} entries`})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[(h==null?void 0:h.pendingApprovals)>0&&e.jsxs(Oe,{className:"bg-yellow-100 text-yellow-800",children:[h.pendingApprovals," pending"]}),e.jsx(I,{size:"sm",onClick:()=>g("/dashboard/journal-hub"),children:e.jsx(Lj,{className:"w-4 h-4"})})]})]})})}):e.jsxs("div",{className:"space-y-6",children:[r&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Entries"}),e.jsx("p",{className:"text-2xl font-bold",children:f?"...":(h==null?void 0:h.totalEntries)||0})]}),e.jsx(ml,{className:"w-8 h-8 text-blue-500"})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:f?"...":(h==null?void 0:h.pendingApprovals)||0})]}),e.jsx(Cr,{className:"w-8 h-8 text-yellow-500"})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Drafts"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:f?"...":(h==null?void 0:h.draftEntries)||0})]}),e.jsx(ln,{className:"w-8 h-8 text-blue-500"})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Posted Today"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:f?"...":(h==null?void 0:h.postedToday)||0})]}),e.jsx(bs,{className:"w-8 h-8 text-green-500"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(ne,{className:"hover:shadow-md transition-shadow cursor-pointer",onClick:()=>g("/dashboard/journal-hub"),children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(ml,{className:"w-8 h-8 text-blue-500"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Journal Entries Hub"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Centralized journal management"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Complete journal workflow"}),e.jsx(Lj,{className:"w-4 h-4 text-gray-400"})]})]})}),e.jsx(ne,{className:"hover:shadow-md transition-shadow cursor-pointer",onClick:()=>g("/dashboard/enhanced-journal-management"),children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(sa,{className:"w-8 h-8 text-purple-500"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Smart Journal"}),e.jsx("p",{className:"text-sm text-gray-600",children:"AI-powered journal creation"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"AI assistance & automation"}),e.jsx(Lj,{className:"w-4 h-4 text-gray-400"})]})]})}),e.jsx(ne,{className:"hover:shadow-md transition-shadow",children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(Za,{className:"w-8 h-8 text-orange-500"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Quick Actions"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Fast journal operations"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(I,{size:"sm",variant:"outline",className:"w-full justify-start",onClick:()=>g("/dashboard/journal-hub?action=create"),children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"New Entry"]}),e.jsxs(I,{size:"sm",variant:"outline",className:"w-full justify-start",onClick:()=>g("/dashboard/journal-hub?tab=templates"),children:[e.jsx(Zt,{className:"w-4 h-4 mr-2"}),"Use Template"]})]})]})})]}),n&&e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(or,{className:"w-5 h-5"}),"Recent Activity"]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>g("/dashboard/journal-hub"),children:["View All",e.jsx(Nm,{className:"w-4 h-4 ml-1"})]})]})}),e.jsx(ie,{children:p?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx(kr,{size:"sm",color:"teal"})}):e.jsx("div",{className:"space-y-3",children:Array.isArray(m==null?void 0:m.entries)&&m.entries.length>0?m.entries.map(v=>{var y;return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ss,{className:"w-4 h-4 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:v.reference}),e.jsx("p",{className:"text-xs text-gray-500",children:v.memo}),e.jsx("p",{className:"text-xs text-gray-400",children:new Date(v.createdAt).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:v.status==="POSTED"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800",children:v.status}),e.jsxs("span",{className:"text-sm font-medium",children:["$",((y=v.totalAmount)==null?void 0:y.toFixed(2))||"0.00"]})]})]},v.id)}):e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No recent activity"})})})]})]}):null:e.jsx("div",{className:"space-y-4",children:e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(ml,{className:"w-5 h-5"}),"Journal Hub"]}),e.jsx(CardDescription,{children:"Quick access to journal entries and accounting tools"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(vn,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Company Selected"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Please select a company to view journal entries and accounting data."}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsxs(I,{onClick:()=>g("/companies"),className:"flex items-center gap-2",children:[e.jsx(vn,{className:"w-4 h-4"}),"Go to Companies"]}),e.jsxs(I,{variant:"outline",onClick:()=>{localStorage.setItem("company_id","seed-company-1"),localStorage.setItem("company_name","Demo Company"),localStorage.setItem("tenant_id","tenant_demo"),console.log(" Set default company for testing"),window.location.reload()},className:"flex items-center gap-2",children:[e.jsx(vn,{className:"w-4 h-4"}),"Set Demo Company"]})]}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-md",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Note:"}),' If the backend is not connected to the database, you can use the "Set Demo Company" button to test the frontend functionality.']})})]})})]})})}const Cee={"/dashboard":[{label:"Dashboard",href:"/dashboard",icon:sN}],"/sales":[{label:"Sales & Invoicing",href:"/sales"},{label:"Invoices",href:"/sales"}],"/purchases":[{label:"Purchases & Expenses",href:"/purchases"},{label:"Expenses",href:"/purchases"}],"/banking":[{label:"Banking & Cash",href:"/banking"},{label:"Bank Accounts",href:"/banking"}],"/accounting":[{label:"Accounting",href:"/accounting"},{label:"Chart of Accounts",href:"/accounting"}],"/reports":[{label:"Reports & Analytics",href:"/reports"},{label:"Standard Reports",href:"/reports"}],"/ai-insights":[{label:"AI Insights",href:"/ai-insights"},{label:"AI Dashboard",href:"/ai-insights"}],"/settings":[{label:"System Settings",href:"/settings"},{label:"General Settings",href:"/settings"}],"/inventory":[{label:"Inventory & Products",href:"/inventory"},{label:"Products & Services",href:"/inventory"}],"/tax":[{label:"Tax Management",href:"/tax"},{label:"Tax Dashboard",href:"/tax"}],"/payroll":[{label:"Payroll & HR",href:"/payroll"},{label:"Payroll Dashboard",href:"/payroll"}],"/projects":[{label:"Projects & Time",href:"/projects"},{label:"Project Dashboard",href:"/projects"}],"/clients":[{label:"Client Portal",href:"/clients"},{label:"Client Dashboard",href:"/clients"}],"/documents":[{label:"Documents",href:"/documents"},{label:"Document Center",href:"/documents"}],"/security":[{label:"Security",href:"/security"},{label:"Security Dashboard",href:"/security"}],"/international":[{label:"International",href:"/international"},{label:"Multi-Currency Dashboard",href:"/international"}],"/enhanced-transaction-processing":[{label:"Enhanced Transaction Processing",href:"/enhanced-transaction-processing"},{label:"AI-Powered Processing",href:"/enhanced-transaction-processing"}],"/llama-ai":[{label:"Llama AI Intelligence",href:"/llama-ai"},{label:"AI-Powered Features",href:"/llama-ai"}]};function Aee({customBreadcrumbs:s}){const r=pu().pathname,n=s||Cee[r]||[{label:"Dashboard",href:"/dashboard",icon:sN}];return n.length<=1?null:e.jsx("nav",{className:"flex items-center space-x-1 text-sm text-muted-foreground mb-4","aria-label":"Breadcrumb",children:n.map((a,i)=>e.jsxs("div",{className:"flex items-center",children:[i>0&&e.jsx(Tm,{className:"h-4 w-4 mx-1"}),a.href?e.jsxs(yp,{to:a.href,className:ns("flex items-center gap-1 hover:text-foreground transition-colors",i===n.length-1&&"text-foreground font-medium"),children:[a.icon&&e.jsx(a.icon,{className:"h-4 w-4"}),a.label]}):e.jsxs("span",{className:ns("flex items-center gap-1",i===n.length-1&&"text-foreground font-medium"),children:[a.icon&&e.jsx(a.icon,{className:"h-4 w-4"}),a.label]})]},i))})}const J6=[{key:"Ctrl + /",description:"Search sidebar menu",category:"Navigation",icon:Rn},{key:"Ctrl + K",description:"Open global search",category:"Navigation",icon:Rn},{key:"Ctrl + N",description:"Quick add transaction",category:"Navigation",icon:Ss},{key:"Ctrl + E",description:"Record expense",category:"Quick Actions",icon:yn},{key:"Ctrl + I",description:"Create invoice",category:"Quick Actions",icon:Zt},{key:"Ctrl + R",description:"Generate report",category:"Quick Actions",icon:lr},{key:"Ctrl + A",description:"Open AI insights",category:"AI Features",icon:sa},{key:"Ctrl + ,",description:"Open settings",category:"System",icon:en},{key:"Escape",description:"Close modal/dialog",category:"System",icon:en}],Eee=["Navigation","Quick Actions","AI Features","System"];function Iee(){const[s,t]=x.useState(!1),[r,n]=x.useState("all"),a=r==="all"?J6:J6.filter(i=>i.category===r);return e.jsxs(ts,{open:s,onOpenChange:t,children:[e.jsx(ki,{asChild:!0,children:e.jsxs(I,{variant:"ghost",size:"sm",className:"text-xs",children:[e.jsx(pC,{className:"h-3 w-3 mr-1"}),"Shortcuts"]})}),e.jsxs(ss,{className:"max-w-2xl",children:[e.jsx(as,{children:e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(pC,{className:"h-5 w-5"}),"Keyboard Shortcuts"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{variant:r==="all"?"default":"outline",size:"sm",onClick:()=>n("all"),children:"All"}),Eee.map(i=>e.jsx(I,{variant:r===i?"default":"outline",size:"sm",onClick:()=>n(i),children:i},i))]}),e.jsx("div",{className:"grid gap-3",children:a.map((i,o)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-primary/10 rounded-lg flex items-center justify-center",children:e.jsx(i.icon,{className:"h-4 w-4 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:i.description}),e.jsx(Oe,{variant:"outline",className:"text-xs mt-1",children:i.category})]})]}),e.jsx("kbd",{className:"text-xs bg-muted px-2 py-1 rounded font-mono",children:i.key})]},o))}),e.jsxs("div",{className:"p-4 bg-cyan-50 border border-cyan-200 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-cyan-800 mb-2",children:" Tips"}),e.jsxs("ul",{className:"text-sm text-cyan-700 space-y-1",children:[e.jsx("li",{children:" Use Ctrl + / to quickly search the sidebar menu"}),e.jsx("li",{children:" Press Ctrl + K to open global search from anywhere"}),e.jsx("li",{children:" Most shortcuts work from any page in the application"}),e.jsx("li",{children:" Hover over buttons to see tooltips with shortcuts"})]})]})]})]})]})}function Kr({children:s,showBreadcrumbs:t=!0,title:r,description:n,breadcrumbs:a}){const[i,o]=xe.useState(!1);return xe.useEffect(()=>o(!0),[]),i?e.jsxs("div",{className:"space-y-6 px-6 py-4",children:[(r||n)&&e.jsxs("div",{className:"space-y-2",children:[r&&e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:r}),n&&e.jsx("p",{className:"text-muted-foreground",children:n})]}),t&&e.jsx(Aee,{customBreadcrumbs:a}),e.jsx("div",{className:"fixed bottom-6 right-6 z-50",children:e.jsx(Iee,{})}),s]}):e.jsx("div",{className:"min-h-screen bg-background",children:e.jsx("main",{className:"flex-1 overflow-hidden pt-8 pl-0 pl-0",id:"main-content",children:e.jsx("div",{className:"flex-1 space-y-6 px-4 py-6",children:e.jsx("div",{className:"h-5 w-40 bg-muted rounded"})})})})}function Pee(){var l,c,d,u,h,f,m,p,g,v,y,j,b,w,N,C,S;const{user:s}=Ua(),t=id(),[r,n]=x.useState(zs()),{data:a,loading:i,error:o}=OL(r);return x.useEffect(()=>{const _=()=>{const F=zs();F&&F!==r&&(console.log(" Dashboard page - Company changed from",r,"to",F),n(F))};window.addEventListener("storage",_);const k=F=>{const A=F.detail.companyId;A&&A!==r&&(console.log(" Dashboard page - Company changed via custom event from",r,"to",A),n(A))};return window.addEventListener("companyChanged",k),()=>{window.removeEventListener("storage",_),window.removeEventListener("companyChanged",k)}},[r]),e.jsx(sh,{children:e.jsx(Kr,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between bg-gradient-to-r from-cyan-50 to-blue-50 rounded-xl p-6 border border-cyan-100",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold tracking-tight bg-gradient-to-r from-cyan-600 to-blue-600 bg-clip-text text-transparent",children:"Dashboard"}),e.jsx("p",{className:"text-muted-foreground mt-1 text-lg",children:"Financial Overview & Analytics"}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),"System Healthy"]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Last updated: ",new Date().toLocaleTimeString()]})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs(I,{variant:"outline",className:"hover:bg-cyan-50 hover:border-cyan-200",onClick:()=>t("/dashboard/reports"),children:[e.jsx(or,{className:"mr-2 h-4 w-4"}),"Export Report"]}),e.jsxs(I,{className:"bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-700 hover:to-blue-700 shadow-lg",onClick:()=>t("/dashboard/reports?tab=analytics"),children:[e.jsx(lr,{className:"mr-2 h-4 w-4"}),"View Analytics"]})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300",children:e.jsx(jee,{companyId:r})}),e.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-300",children:e.jsx(See,{companyId:r,onNavigate:_=>t(_),showQuickStats:!0,showRecentActivity:!0,compact:!1})}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(ne,{className:"h-full",children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Ss,{className:"h-5 w-5 text-blue-600"}),"Quick Actions"]}),e.jsx(Vt,{children:"Common tasks and shortcuts to get you started"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:[e.jsxs(I,{variant:"outline",className:"h-32 flex-col gap-3 hover:bg-gradient-to-br hover:from-blue-50 hover:to-cyan-50 hover:border-blue-300 hover:shadow-md transition-all duration-300 p-4 group",onClick:()=>t("/dashboard/settings"),children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg group-hover:bg-blue-200 transition-colors",children:e.jsx(Lf,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"font-semibold text-sm text-gray-900 block",children:"New Company"}),e.jsx("span",{className:"text-xs text-gray-600 leading-tight",children:"Set up new business"})]})]}),e.jsxs(I,{variant:"outline",className:"h-32 flex-col gap-3 hover:bg-gradient-to-br hover:from-green-50 hover:to-emerald-50 hover:border-green-300 hover:shadow-md transition-all duration-300 p-4 group",onClick:()=>t("/dashboard/sales"),children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg group-hover:bg-green-200 transition-colors",children:e.jsx(Mr,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"font-semibold text-sm text-gray-900 block",children:"Create Invoice"}),e.jsx("span",{className:"text-xs text-gray-600 leading-tight",children:"Generate invoice"})]})]}),e.jsxs(I,{variant:"outline",className:"h-32 flex-col gap-3 hover:bg-gradient-to-br hover:from-purple-50 hover:to-indigo-50 hover:border-purple-300 hover:shadow-md transition-all duration-300 p-4 group",onClick:()=>t("/dashboard/reports"),children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg group-hover:bg-purple-200 transition-colors",children:e.jsx($s,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"font-semibold text-sm text-gray-900 block",children:"View Reports"}),e.jsx("span",{className:"text-xs text-gray-600 leading-tight",children:"Financial reports"})]})]}),e.jsxs(I,{variant:"outline",className:"h-32 flex-col gap-3 hover:bg-gradient-to-br hover:from-orange-50 hover:to-amber-50 hover:border-orange-300 hover:shadow-md transition-all duration-300 p-4 group",onClick:()=>t("/dashboard/ai-insights"),children:[e.jsx("div",{className:"p-2 bg-orange-100 rounded-lg group-hover:bg-orange-200 transition-colors",children:e.jsx(sa,{className:"h-6 w-6 text-orange-600"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"font-semibold text-sm text-gray-900 block",children:"AI Insights"}),e.jsx("span",{className:"text-xs text-gray-600 leading-tight",children:"AI recommendations"})]})]}),e.jsxs(I,{variant:"outline",className:"h-32 flex-col gap-3 hover:bg-gradient-to-br hover:from-indigo-50 hover:to-purple-50 hover:border-indigo-300 hover:shadow-md transition-all duration-300 p-4 group",onClick:()=>t("/dashboard/accounting"),children:[e.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg group-hover:bg-indigo-200 transition-colors",children:e.jsx(yn,{className:"h-6 w-6 text-indigo-600"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"font-semibold text-sm text-gray-900 block",children:"Chart of Accounts"}),e.jsx("span",{className:"text-xs text-gray-600 leading-tight",children:"Manage accounts"})]})]}),e.jsxs(I,{variant:"outline",className:"h-32 flex-col gap-3 hover:bg-gradient-to-br hover:from-teal-50 hover:to-cyan-50 hover:border-teal-300 hover:shadow-md transition-all duration-300 p-4 group",onClick:()=>t("/dashboard/journal/new"),children:[e.jsx("div",{className:"p-2 bg-teal-100 rounded-lg group-hover:bg-teal-200 transition-colors",children:e.jsx(Zt,{className:"h-6 w-6 text-teal-600"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"font-semibold text-sm text-gray-900 block",children:"New Journal Entry"}),e.jsx("span",{className:"text-xs text-gray-600 leading-tight",children:"Record transactions"})]})]}),e.jsxs(I,{variant:"outline",className:"h-32 flex-col gap-3 hover:bg-gradient-to-br hover:from-amber-50 hover:to-yellow-50 hover:border-amber-300 hover:shadow-md transition-all duration-300 p-4 group",onClick:()=>t("/dashboard/accounting?tab=trial-balance"),children:[e.jsx("div",{className:"p-2 bg-amber-100 rounded-lg group-hover:bg-amber-200 transition-colors",children:e.jsx(yn,{className:"h-6 w-6 text-amber-600"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"font-semibold text-sm text-gray-900 block",children:"Trial Balance"}),e.jsx("span",{className:"text-xs text-gray-600 leading-tight",children:"View balances"})]})]})]})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ne,{children:[e.jsx(we,{className:"pb-3",children:e.jsxs(Se,{className:"text-lg flex items-center gap-2",children:[e.jsx($s,{className:"h-5 w-5 text-green-600"}),"This Month"]})}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Revenue"}),e.jsxs("span",{className:`font-semibold ${(((l=a==null?void 0:a.metrics)==null?void 0:l.totalRevenue)||0)>0?"text-green-600":"text-gray-600"}`,children:["$",(((c=a==null?void 0:a.metrics)==null?void 0:c.totalRevenue)||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Expenses"}),e.jsxs("span",{className:`font-semibold ${(((d=a==null?void 0:a.metrics)==null?void 0:d.totalExpenses)||0)>0?"text-orange-600":"text-gray-600"}`,children:["$",(((u=a==null?void 0:a.metrics)==null?void 0:u.totalExpenses)||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Profit"}),e.jsxs("span",{className:`font-semibold ${(((h=a==null?void 0:a.metrics)==null?void 0:h.netProfit)||0)>0?"text-blue-600":(((f=a==null?void 0:a.metrics)==null?void 0:f.netProfit)||0)<0?"text-red-600":"text-gray-600"}`,children:["$",(((m=a==null?void 0:a.metrics)==null?void 0:m.netProfit)||0).toLocaleString()]})]}),e.jsx("div",{className:"pt-3 border-t",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Net Growth"}),e.jsxs("span",{className:`text-lg font-bold ${(((p=a==null?void 0:a.metrics)==null?void 0:p.netProfit)||0)>0?"text-green-600":"text-red-600"}`,children:[(((g=a==null?void 0:a.metrics)==null?void 0:g.netProfit)||0)>0?"+":"","$",(((v=a==null?void 0:a.metrics)==null?void 0:v.netProfit)||0).toLocaleString()]})]})})]})]}),e.jsxs(ne,{children:[e.jsx(we,{className:"pb-3",children:e.jsxs(Se,{className:"text-lg flex items-center gap-2",children:[e.jsx(Is,{className:"h-5 w-5 text-amber-600"}),"Alerts"]})}),e.jsxs(ie,{className:"space-y-3",children:[(((y=a==null?void 0:a.metrics)==null?void 0:y.overdueInvoices)||0)>0&&e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-amber-50 rounded-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-amber-500 rounded-full"}),e.jsxs("span",{className:"text-sm text-amber-700",children:["$",(((j=a==null?void 0:a.metrics)==null?void 0:j.overdueInvoices)||0).toLocaleString()," in overdue invoices"]})]}),(((b=a==null?void 0:a.metrics)==null?void 0:b.pendingInvoices)||0)>0&&e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsxs("span",{className:"text-sm text-blue-700",children:["$",(((w=a==null?void 0:a.metrics)==null?void 0:w.pendingInvoices)||0).toLocaleString()," in pending invoices"]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-2 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("span",{className:"text-sm text-green-700",children:[((N=a==null?void 0:a.metrics)==null?void 0:N.activeCustomers)||0," active customers"]})]})]})]})]})]}),e.jsx(bee,{maxItems:3,compact:!0,showViewAll:!0}),e.jsxs(ne,{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(or,{className:"h-5 w-5 text-gray-600"}),"Recent Activity"]}),e.jsx(Vt,{children:"Latest updates and changes across your account"})]}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:i?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(On,{className:"h-6 w-6 animate-spin mr-2"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Loading recent activity..."})]}):o?e.jsxs("div",{className:"flex items-center justify-center py-8 text-red-600",children:[e.jsx(Is,{className:"h-6 w-6 mr-2"}),e.jsx("span",{className:"text-sm",children:"Error loading activity"})]}):(((C=a==null?void 0:a.recentActivity)==null?void 0:C.length)||0)>0?(S=a==null?void 0:a.recentActivity)==null?void 0:S.slice(0,4).map(_=>e.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-lg border border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-full ${_.type==="journal_entry"?"bg-purple-100":"bg-blue-100"}`,children:_.type==="journal_entry"?e.jsx(lh,{className:"w-4 h-4 text-purple-600"}):e.jsx(Zt,{className:"w-4 h-4 text-blue-600"})}),e.jsx("div",{className:`w-3 h-3 rounded-full ${_.status==="posted"?"bg-green-500":_.status==="draft"?"bg-yellow-500":"bg-blue-500"}`})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:_.title}),e.jsx("p",{className:"text-xs text-gray-600",children:_.description}),e.jsxs("p",{className:"text-xs text-gray-500 capitalize",children:[_.type.replace("_"," "),"  ",_.status]})]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(_.date).toLocaleDateString()})]},_.id)):e.jsxs("div",{className:"flex items-center justify-center py-8 text-gray-500",children:[e.jsx(or,{className:"h-6 w-6 mr-2"}),e.jsx("span",{className:"text-sm",children:"No recent activity"})]})})})]})]})})})}function l2(s,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(s==null||s(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function _ee(s,t=[]){let r=[];function n(i,o){const l=x.createContext(o),c=r.length;r=[...r,o];const d=h=>{var y;const{scope:f,children:m,...p}=h,g=((y=f==null?void 0:f[s])==null?void 0:y[c])||l,v=x.useMemo(()=>p,Object.values(p));return e.jsx(g.Provider,{value:v,children:m})};d.displayName=i+"Provider";function u(h,f){var g;const m=((g=f==null?void 0:f[s])==null?void 0:g[c])||l,p=x.useContext(m);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[d,u]}const a=()=>{const i=r.map(o=>x.createContext(o));return function(l){const c=(l==null?void 0:l[s])||i;return x.useMemo(()=>({[`__scope${s}`]:{...l,[s]:c}}),[l,c])}};return a.scopeName=s,[n,kee(a,...t)]}function kee(...s){const t=s[0];if(s.length===1)return t;const r=()=>{const n=s.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=n.reduce((l,{useScope:c,scopeName:d})=>{const h=c(i)[`__scope${d}`];return{...l,...h}},{});return x.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}function X6(s,t){if(typeof s=="function")return s(t);s!=null&&(s.current=t)}function FL(...s){return t=>{let r=!1;const n=s.map(a=>{const i=X6(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():X6(s[a],null)}}}}function Tee(...s){return x.useCallback(FL(...s),s)}var MC=globalThis!=null&&globalThis.document?x.useLayoutEffect:()=>{};function Dee(s,t){return x.useReducer((r,n)=>t[r][n]??r,s)}var ML=s=>{const{present:t,children:r}=s,n=Oee(t),a=typeof r=="function"?r({present:n.isPresent}):x.Children.only(r),i=Tee(n.ref,Ree(a));return typeof r=="function"||n.isPresent?x.cloneElement(a,{ref:i}):null};ML.displayName="Presence";function Oee(s){const[t,r]=x.useState(),n=x.useRef({}),a=x.useRef(s),i=x.useRef("none"),o=s?"mounted":"unmounted",[l,c]=Dee(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return x.useEffect(()=>{const d=Xy(n.current);i.current=l==="mounted"?d:"none"},[l]),MC(()=>{const d=n.current,u=a.current;if(u!==s){const f=i.current,m=Xy(d);s?c("MOUNT"):m==="none"||(d==null?void 0:d.display)==="none"?c("UNMOUNT"):c(u&&f!==m?"ANIMATION_OUT":"UNMOUNT"),a.current=s}},[s,c]),MC(()=>{if(t){let d;const u=t.ownerDocument.defaultView??window,h=m=>{const g=Xy(n.current).includes(m.animationName);if(m.target===t&&g&&(c("ANIMATION_END"),!a.current)){const v=t.style.animationFillMode;t.style.animationFillMode="forwards",d=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=v)})}},f=m=>{m.target===t&&(i.current=Xy(n.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",h),t.addEventListener("animationend",h),()=>{u.clearTimeout(d),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",h),t.removeEventListener("animationend",h)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:x.useCallback(d=>{d&&(n.current=getComputedStyle(d)),r(d)},[])}}function Xy(s){return(s==null?void 0:s.animationName)||"none"}function Ree(s){var n,a;let t=(n=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}var LL=x.forwardRef((s,t)=>{const{children:r,...n}=s,a=x.Children.toArray(r),i=a.find(Mee);if(i){const o=i.props.children,l=a.map(c=>c===i?x.Children.count(o)>1?x.Children.only(null):x.isValidElement(o)?o.props.children:null:c);return e.jsx(LC,{...n,ref:t,children:x.isValidElement(o)?x.cloneElement(o,void 0,l):null})}return e.jsx(LC,{...n,ref:t,children:r})});LL.displayName="Slot";var LC=x.forwardRef((s,t)=>{const{children:r,...n}=s;if(x.isValidElement(r)){const a=$ee(r);return x.cloneElement(r,{...Lee(n,r.props),ref:t?FL(t,a):a})}return x.Children.count(r)>1?x.Children.only(null):null});LC.displayName="SlotClone";var Fee=({children:s})=>e.jsx(e.Fragment,{children:s});function Mee(s){return x.isValidElement(s)&&s.type===Fee}function Lee(s,t){const r={...t};for(const n in t){const a=s[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...l)=>{i(...l),a(...l)}:a&&(r[n]=a):n==="style"?r[n]={...a,...i}:n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return{...s,...r}}function $ee(s){var n,a;let t=(n=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}var Bee=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],lN=Bee.reduce((s,t)=>{const r=x.forwardRef((n,a)=>{const{asChild:i,...o}=n,l=i?LL:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(l,{...o,ref:a})});return r.displayName=`Primitive.${t}`,{...s,[t]:r}},{});function $L(s){const t=x.useRef(s);return x.useEffect(()=>{t.current=s}),x.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function Uee({prop:s,defaultProp:t,onChange:r=()=>{}}){const[n,a]=zee({defaultProp:t,onChange:r}),i=s!==void 0,o=i?s:n,l=$L(r),c=x.useCallback(d=>{if(i){const h=typeof d=="function"?d(s):d;h!==s&&l(h)}else a(d)},[i,s,a,l]);return[o,c]}function zee({defaultProp:s,onChange:t}){const r=x.useState(s),[n]=r,a=x.useRef(n),i=$L(t);return x.useEffect(()=>{a.current!==n&&(i(n),a.current=n)},[n,a,i]),r}var qee=Zv.useId||(()=>{}),Vee=0;function Wee(s){const[t,r]=x.useState(qee());return MC(()=>{r(n=>n??String(Vee++))},[s]),s||(t?`radix-${t}`:"")}var H5="Tabs",[Hee]=_ee(H5,[zR]),BL=zR(),[Gee,G5]=Hee(H5),UL=x.forwardRef((s,t)=>{const{__scopeTabs:r,value:n,onValueChange:a,defaultValue:i,orientation:o="horizontal",dir:l,activationMode:c="automatic",...d}=s,u=x5(l),[h,f]=Uee({prop:n,onChange:a,defaultProp:i});return e.jsx(Gee,{scope:r,baseId:Wee(),value:h,onValueChange:f,orientation:o,dir:u,activationMode:c,children:e.jsx(lN.div,{dir:u,"data-orientation":o,...d,ref:t})})});UL.displayName=H5;var zL="TabsList",qL=x.forwardRef((s,t)=>{const{__scopeTabs:r,loop:n=!0,...a}=s,i=G5(zL,r),o=BL(r);return e.jsx(ZW,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:n,children:e.jsx(lN.div,{role:"tablist","aria-orientation":i.orientation,...a,ref:t})})});qL.displayName=zL;var VL="TabsTrigger",WL=x.forwardRef((s,t)=>{const{__scopeTabs:r,value:n,disabled:a=!1,...i}=s,o=G5(VL,r),l=BL(r),c=KL(o.baseId,n),d=YL(o.baseId,n),u=n===o.value;return e.jsx(eH,{asChild:!0,...l,focusable:!a,active:u,children:e.jsx(lN.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":d,"data-state":u?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:c,...i,ref:t,onMouseDown:l2(s.onMouseDown,h=>{!a&&h.button===0&&h.ctrlKey===!1?o.onValueChange(n):h.preventDefault()}),onKeyDown:l2(s.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&o.onValueChange(n)}),onFocus:l2(s.onFocus,()=>{const h=o.activationMode!=="manual";!u&&!a&&h&&o.onValueChange(n)})})})});WL.displayName=VL;var HL="TabsContent",GL=x.forwardRef((s,t)=>{const{__scopeTabs:r,value:n,forceMount:a,children:i,...o}=s,l=G5(HL,r),c=KL(l.baseId,n),d=YL(l.baseId,n),u=n===l.value,h=x.useRef(u);return x.useEffect(()=>{const f=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(f)},[]),e.jsx(ML,{present:a||u,children:({present:f})=>e.jsx(lN.div,{"data-state":u?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!f,id:d,tabIndex:0,...o,ref:t,style:{...s.style,animationDuration:h.current?"0s":void 0},children:f&&i})})});GL.displayName=HL;function KL(s,t){return`${s}-trigger-${t}`}function YL(s,t){return`${s}-content-${t}`}var Kee=UL,Yee=qL,Jee=WL,Xee=GL;function an({className:s,variant:t="default",size:r="md",...n}){return e.jsx(Kee,{"data-slot":"tabs","data-variant":t,"data-size":r,className:ns("flex flex-col",{"gap-2":t==="default"||t==="pills","gap-0":t==="underline"||t==="bordered"},s),...n})}function on({className:s,variant:t="default",size:r="md",...n}){const a="inline-flex items-center justify-center transition-all duration-200",i={default:"bg-muted text-muted-foreground rounded-lg p-[3px] shadow-sm",pills:"bg-gray-100 dark:bg-gray-800 rounded-full p-1 shadow-inner",underline:"border-b border-border bg-transparent",bordered:"border border-border rounded-lg bg-card shadow-sm p-1"},o={sm:"h-8 text-xs",md:"h-10 text-sm",lg:"h-12 text-base"};return e.jsx(Yee,{"data-slot":"tabs-list",className:ns(a,i[t],o[r],"w-fit",s),...n})}function vt({className:s,children:t,variant:r="default",size:n="md",icon:a,badge:i,...o}){const l=ns("inline-flex items-center justify-center gap-2 font-medium transition-all duration-200","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","disabled:pointer-events-none disabled:opacity-50","whitespace-nowrap relative"),c={default:ns("rounded-md border border-transparent px-3 py-1.5","text-muted-foreground hover:text-foreground","data-[state=active]:bg-background data-[state=active]:text-foreground","data-[state=active]:shadow-sm data-[state=active]:border-border/50","hover:bg-muted/50"),pills:ns("rounded-full px-4 py-2 border border-transparent","text-gray-600 dark:text-gray-400 hover:text-foreground","data-[state=active]:bg-white dark:data-[state=active]:bg-gray-700","data-[state=active]:text-foreground data-[state=active]:shadow-md","hover:bg-white/50 dark:hover:bg-gray-700/50"),underline:ns("border-b-2 border-transparent px-4 py-3 -mb-px","text-muted-foreground hover:text-foreground","data-[state=active]:border-primary data-[state=active]:text-primary","hover:border-border"),bordered:ns("rounded-md px-3 py-2 border border-transparent","text-muted-foreground hover:text-foreground","data-[state=active]:bg-primary/10 data-[state=active]:text-primary","data-[state=active]:border-primary/20","hover:bg-muted/30")},d={sm:"h-7 px-2 text-xs gap-1.5",md:"h-9 px-3 text-sm gap-2",lg:"h-11 px-4 text-base gap-2.5"};return e.jsxs(Jee,{"data-slot":"tabs-trigger",className:ns(l,c[r],d[n],s),...o,children:[a&&e.jsx("span",{className:"flex items-center justify-center [&_svg]:size-4",children:a}),e.jsx("span",{className:"flex-1",children:t}),i&&e.jsx("span",{className:ns("inline-flex items-center justify-center rounded-full","bg-primary/20 text-primary text-xs font-semibold min-w-[18px] h-[18px] px-1.5","data-[state=active]:bg-primary data-[state=active]:text-primary-foreground"),children:i})]})}function yt({className:s,animated:t=!0,...r}){return e.jsx(Xee,{"data-slot":"tabs-content",className:ns("flex-1 outline-none",t&&"data-[state=active]:animate-in data-[state=active]:fade-in-0 data-[state=active]:zoom-in-95",t&&"data-[state=inactive]:animate-out data-[state=inactive]:fade-out-0 data-[state=inactive]:zoom-out-95",t&&"duration-200",s),...r})}const Qee=x.forwardRef(({items:s,variant:t="default",size:r="md",className:n,...a},i)=>e.jsxs(an,{ref:i,variant:t,size:r,className:n,...a,children:[e.jsx(on,{variant:t,size:r,children:s.map(o=>e.jsx(vt,{value:o.value,variant:t,size:r,icon:o.icon,badge:o.badge,disabled:o.disabled,children:o.label},o.value))}),s.map(o=>e.jsx(yt,{value:o.value,children:o.content},o.value))]}));Qee.displayName="TabsGroup";const Ps=()=>{const s=Ii(),t=zs();console.log(" getHeaders() - tenantId:",s,"companyId:",t);const r={"Content-Type":"application/json","x-tenant-id":s,"x-company-id":t};if(typeof window<"u"){const n=localStorage.getItem("auth_token");n&&(r.Authorization=`Bearer ${n}`)}return r},Zee={getAll:async s=>{const t=new URLSearchParams;return(s||DEFAULT_COMPANY_ID)&&t.append("companyId",s||DEFAULT_COMPANY_ID),await de.get(`/api/account-types?${t.toString()}`,{headers:Ps()})},getById:async s=>await de.get(`/api/account-types/${s}`,{headers:Ps()}),create:async s=>{const t=s.companyId||(typeof window<"u"?localStorage.getItem("company_id"):null);return await de.post("/api/account-types",{...s,companyId:t},{headers:Ps()})},update:async(s,t)=>await de.put(`/api/account-types/${s}`,t,{headers:Ps()}),delete:async s=>{await de.delete(`/api/account-types/${s}`,{headers:Ps()})}},JL={getAll:async(s,t=!1,r,n)=>{const a=new URLSearchParams;(s||DEFAULT_COMPANY_ID)&&a.append("companyId",s||DEFAULT_COMPANY_ID),t&&a.append("includeInactive","true"),r&&a.append("page",r.toString()),n&&a.append("pageSize",n.toString());const i=await de.get(`/api/accounts?${a.toString()}`,{headers:Ps()});if(Array.isArray(i)){const o={page:1,pageSize:i.length,totalPages:1,hasNext:!1,hasPrev:!1,totalCount:i.length};return{accounts:i,pagination:o}}return{accounts:(i==null?void 0:i.accounts)||[],pagination:(i==null?void 0:i.pagination)||{page:1,pageSize:0,totalPages:1,hasNext:!1,hasPrev:!1,totalCount:0}}},getById:async s=>await de.get(`/api/accounts/${s}`,{headers:Ps()}),create:async s=>{const t={...s,companyId:s.companyId||DEFAULT_COMPANY_ID};return await de.post("/api/accounts",t,{headers:Ps()})},update:async(s,t)=>await de.put(`/api/accounts/${s}`,t,{headers:Ps()}),delete:async s=>{await de.delete(`/api/accounts/${s}`,{headers:Ps()})},getBalance:async(s,t)=>{const r=new URLSearchParams;return t&&r.append("asOf",t),await de.get(`/accounts/${s}/balance?${r.toString()}`,{headers:Ps()})},getSummary:async s=>{const t=new URLSearchParams;return(s||DEFAULT_COMPANY_ID)&&t.append("companyId",s||DEFAULT_COMPANY_ID),await de.get(`/accounts/summary?${t.toString()}`,{headers:Ps()})}},ete={getAll:async(s,t,r)=>{const n=new URLSearchParams;(s||DEFAULT_COMPANY_ID)&&n.append("companyId",s||DEFAULT_COMPANY_ID),t&&n.append("page",t.toString()),r&&n.append("pageSize",r.toString());const a=await de.get(`/api/journal?${n.toString()}`,{headers:Ps()}),i=(a==null?void 0:a.entries)||a||[],o=(a==null?void 0:a.pagination)||{page:t||1,pageSize:i.length,totalPages:1,hasNext:!1,hasPrev:!!t&&t>1,totalCount:i.length};return{entries:i,pagination:o}},getById:async s=>await de.get(`/api/journal/${s}`,{headers:Ps()}),create:async s=>await de.post("/api/journal",{...s,companyId:s.companyId||DEFAULT_COMPANY_ID},{headers:Ps()}),update:async(s,t)=>await de.put(`/api/journal/${s}`,t,{headers:Ps()}),delete:async s=>{await de.delete(`/api/journal/${s}`,{headers:Ps()})},post:async s=>{await de.post(`/api/journal/${s}/post`,{},{headers:Ps()})}},tte={getAll:async s=>{const t=new URLSearchParams;return(s||DEFAULT_COMPANY_ID)&&t.append("companyId",s||DEFAULT_COMPANY_ID),await de.get(`/account-mappings?${t.toString()}`,{headers:Ps()})},create:async s=>await de.post("/api/account-mappings",{...s,companyId:s.companyId||DEFAULT_COMPANY_ID},{headers:Ps()})},ste={getTrialBalance:async(s,t,r,n)=>{const a=new URLSearchParams;return a.append("asOf",s),(t||DEFAULT_COMPANY_ID)&&a.append("companyId",t||DEFAULT_COMPANY_ID),r&&a.append("page",r.toString()),n&&a.append("pageSize",n.toString()),await de.get(`/api/journal/trial-balance?${a.toString()}`,{headers:Ps()})}},o1={getJournalEntries:async s=>await de.get(`/api/expenses/${s}/journal-entries`,{headers:Ps()}),createJournalEntry:async s=>await de.post("/journal-hub/entries",s,{headers:Ps()}),postJournalEntry:async s=>await de.post(`/journal-hub/entries/${s}/post`,{},{headers:Ps()})},rte={getGeneralLedger:async s=>{const t=new URLSearchParams;return t.append("startDate",s.startDate),t.append("endDate",s.endDate),s.accountId&&t.append("accountId",s.accountId),s.accountType&&t.append("accountType",s.accountType),(s.companyId||DEFAULT_COMPANY_ID)&&t.append("companyId",s.companyId||DEFAULT_COMPANY_ID),s.page&&t.append("page",s.page.toString()),s.pageSize&&t.append("pageSize",s.pageSize.toString()),await de.get(`/api/journal/general-ledger?${t.toString()}`,{headers:Ps()})}},Hc={getVendors:async s=>{const t=new URLSearchParams;(s||DEFAULT_COMPANY_ID)&&t.append("companyId",s||DEFAULT_COMPANY_ID),t.append("pageSize","100");const r=await de.get(`/api/vendors?${t.toString()}`,{headers:Ps()});return(r==null?void 0:r.items)||[]},createVendor:async s=>await de.post("/api/vendors",{...s,companyId:s.companyId||DEFAULT_COMPANY_ID},{headers:Ps()}),updateVendor:async(s,t)=>(await de.put(`/api/vendors/${s}`,t,{headers:Ps()})).data,deleteVendor:async s=>{await de.delete(`/api/vendors/${s}`,{headers:Ps()})},getBills:async(s,t,r,n)=>{const a=new URLSearchParams;return(s||DEFAULT_COMPANY_ID)&&a.append("companyId",s||DEFAULT_COMPANY_ID),t&&a.append("status",t),r&&a.append("page",r.toString()),n&&a.append("pageSize",n.toString()),await de.get(`/bills?${a.toString()}`,{headers:Ps()})},getBillById:async s=>await de.get(`/bills/${s}`,{headers:Ps()}),createBill:async s=>await de.post("/api/bills",{...s,companyId:s.companyId||DEFAULT_COMPANY_ID},{headers:Ps()}),updateBill:async(s,t)=>(await de.put(`/api/bills/${s}`,t,{headers:Ps()})).data,deleteBill:async s=>{await de.delete(`/api/bills/${s}`,{headers:Ps()})},postBill:async(s,t=!0)=>(await de.post(`/api/bills/${s}/post`,{createTransaction:t},{headers:Ps()})).data,getProducts:async(s,t)=>{const r=new URLSearchParams;return(s||DEFAULT_COMPANY_ID)&&r.append("companyId",s||DEFAULT_COMPANY_ID),t&&r.append("type",t),await de.get(`/products?${r.toString()}`,{headers:Ps()})},createProduct:async s=>await de.post("/api/products",{...s,companyId:s.companyId||DEFAULT_COMPANY_ID},{headers:Ps()}),updateProduct:async(s,t)=>(await de.put(`/api/products/${s}`,t,{headers:Ps()})).data,deleteProduct:async s=>{await de.delete(`/api/products/${s}`,{headers:Ps()})},getPurchaseOrders:async(s,t)=>{const r=new URLSearchParams;return(s||DEFAULT_COMPANY_ID)&&r.append("companyId",s||DEFAULT_COMPANY_ID),t&&r.append("status",t),r.append("pageSize","100"),(await de.get(`/api/purchase-orders?${r.toString()}`,{headers:Ps()})).items||[]},getPurchaseOrderById:async s=>await de.get(`/api/purchase-orders/${s}`,{headers:Ps()}),createPurchaseOrder:async s=>await de.post("/api/purchase-orders",{...s,companyId:s.companyId||DEFAULT_COMPANY_ID},{headers:Ps()}),updatePurchaseOrder:async(s,t)=>(await de.put(`/api/purchase-orders/${s}`,t,{headers:Ps()})).data,deletePurchaseOrder:async s=>{await de.delete(`/api/purchase-orders/${s}`,{headers:Ps()})},createReceipt:async(s,t)=>await de.post(`/api/purchase-orders/${s}/receipts`,t,{headers:Ps()}),markAsDelivered:async(s,t)=>await de.post(`/api/purchase-orders/${s}/deliver`,t,{headers:Ps()}),getDeliveryStatus:async s=>await de.get(`/api/purchase-orders/${s}/delivery-status`,{headers:Ps()}),downloadGoodReceiptPDF:async s=>{const t=await fetch(un(`api/good-receipts/purchase-orders/${s}/good-receipt/pdf`),{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("token")||localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"demo-tenant","x-company-id":localStorage.getItem("company_id")||"demo-company"}});if(!t.ok){const r=await t.json();throw new Error(r.message||`Failed to download good receipt: ${t.status} ${t.statusText}`)}return await t.blob()}},la={getExpenseCategories:async s=>{const t=new URLSearchParams,r=(s==null?void 0:s.companyId)||zs();return r&&t.append("companyId",r),s!=null&&s.q&&t.append("q",s.q),await de.get(`/api/expense-categories?${t.toString()}`,{headers:Ps()})},createExpenseCategory:async s=>await de.post("/api/expense-categories",{...s,companyId:s.companyId||zs()},{headers:Ps()}),updateExpenseCategory:async(s,t)=>await de.put(`/api/expense-categories/${s}`,{...t,companyId:t.companyId||zs()},{headers:Ps()}),getExpenseRules:async s=>{const t=new URLSearchParams,r=s||zs();return r&&t.append("companyId",r),await de.get(`/api/expense-rules?${t.toString()}`,{headers:Ps()})},createExpenseRule:async s=>await de.post("/api/expense-rules",{...s,companyId:s.companyId||zs()},{headers:Ps()}),updateExpenseRule:async(s,t)=>await de.put(`/api/expense-rules/${s}`,t,{headers:Ps()}),deleteExpenseRule:async s=>{await de.delete(`/api/expense-rules/${s}`,{headers:Ps()})},getExpenses:async(s,t,r)=>{const n=new URLSearchParams,a=s||zs();return a&&n.append("companyId",a),t&&n.append("status",t),r&&n.append("categoryId",r),(await de.get(`/api/expenses?${n.toString()}`,{headers:Ps()})).items||[]},getExpenseById:async s=>await de.get(`/api/expenses/${s}`,{headers:Ps()}),rejectExpense:async(s,t)=>await de.post(`/api/expenses/${s}/reject`,{reason:t},{headers:Ps()}),createExpense:async s=>{var t,r;try{return await de.post("/api/expenses",{...s,companyId:s.companyId||zs()},{headers:Ps()})}catch(n){throw((r=(t=n.response)==null?void 0:t.data)==null?void 0:r.code)==="BUDGET_EXCEEDED"?new Error(`Budget exceeded: ${n.response.data.details||"Insufficient budget available"}`):n}},updateExpense:async(s,t)=>{var r,n;try{return await de.put(`/api/expenses/${s}`,t,{headers:Ps()})}catch(a){throw((n=(r=a.response)==null?void 0:r.data)==null?void 0:n.code)==="BUDGET_EXCEEDED"?new Error(`Budget exceeded: ${a.response.data.details||"Insufficient budget available"}`):a}},deleteExpense:async s=>{var t,r;try{await de.delete(`/api/expenses/${s}`,{headers:Ps()})}catch(n){throw((r=(t=n.response)==null?void 0:t.data)==null?void 0:r.code)==="BUDGET_EXCEEDED"?new Error(`Budget exceeded: ${n.response.data.details||"Insufficient budget available"}`):n}},submitExpense:async s=>await de.post(`/api/expenses/${s}/submit`,{},{headers:Ps()}),approveExpense:async s=>await de.post(`/api/expenses/${s}/approve`,{},{headers:Ps()}),getBudgets:async s=>{const t=new URLSearchParams,r=s||zs();return r&&t.append("companyId",r),await de.get(`/api/budgets?${t.toString()}`,{headers:Ps()})},createBudget:async s=>await de.post("/api/budgets",{...s,companyId:s.companyId||zs()},{headers:Ps()}),updateBudget:async(s,t)=>await de.put(`/api/budgets/${s}`,{...t,companyId:t.companyId||zs()},{headers:Ps()}),getBudgetAnalytics:async s=>{const t=new URLSearchParams,r=s||zs();return r&&t.append("companyId",r),await de.get(`/api/budgets/analytics?${t.toString()}`,{headers:Ps()})}},cN={getCompanies:async()=>await de.get("/api/companies",{headers:Ps()})},ll={accountTypesApi:{},chartOfAccountsApi:{},journalEntriesApi:{},accountMappingsApi:{},trialBalanceApi:{},generalLedgerApi:{},purchaseApi:{},expenseApi:{},companiesApi:{}};Object.assign(ll,{accountTypesApi:Zee,chartOfAccountsApi:JL,journalEntriesApi:ete,accountMappingsApi:tte,trialBalanceApi:ste,generalLedgerApi:rte,purchaseApi:Hc,expenseApi:la,companiesApi:cN});const _u={listPeriods:async s=>await de.get(`/api/period-close/${s}/periods`,{headers:Ps()}),lock:async(s,t)=>await de.post(`/api/period-close/${s}/${t}/lock`,{},{headers:Ps()}),unlock:async(s,t)=>await de.post(`/api/period-close/${s}/${t}/unlock`,{},{headers:Ps()}),getChecklist:async(s,t)=>await de.get(`/api/period-close/${s}/${t}/checklist`,{headers:Ps()}),updateChecklist:async(s,t,r,n)=>await de.put(`/api/period-close/${s}/${t}/checklist/${r}`,n,{headers:Ps()}),runRecurring:async(s,t)=>await de.post(`/api/period-close/${s}/${t}/run/recurring`,{},{headers:Ps()}),runAllocations:async(s,t)=>await de.post(`/api/period-close/${s}/${t}/run/allocations`,{},{headers:Ps()}),runFxReval:async(s,t,r="USD")=>await de.post(`/api/period-close/${s}/${t}/run/fx-reval`,{baseCurrency:r},{headers:Ps()}),startClose:async(s,t)=>await de.post(`/api/period-close/${s}/${t}/lock`,{},{headers:Ps()}),completeClose:async(s,t)=>await de.post(`/api/period-close/${s}/${t}/complete`,{},{headers:Ps()}),getFxPreview:async(s,t,r="USD")=>await de.get(`/api/period-close/${s}/${t}/fx-preview?baseCurrency=${r}`,{headers:Ps()}),getFxHistory:async(s,t)=>await de.get(`/api/period-close/${s}/${t}/fx-history`,{headers:Ps()}),getAccounts:async s=>await de.get(`/api/accounts?companyId=${s}`,{headers:Ps()}),getRuns:async(s,t)=>await de.get(`/api/period-close/${s}/${t}/runs`,{headers:Ps()}),rollbackRun:async(s,t,r)=>await de.post(`/api/period-close/${s}/${t}/rollback`,{runId:r},{headers:Ps()}),previewFxRevaluation:async(s,t,r="USD")=>await de.post(`/api/period-close/${s}/${t}/fx-reval/preview`,{baseCurrency:r},{headers:Ps()}),postFxRevaluation:async(s,t,r="USD")=>await de.post(`/api/period-close/${s}/${t}/fx-reval/post`,{baseCurrency:r},{headers:Ps()}),postPriorPeriodAdjustment:async(s,t,r)=>await de.post(`/api/period-close/${s}/${t}/adjustments/prior-period`,r,{headers:Ps()})},$C={getSchedules:async s=>{const t=s||DEFAULT_COMPANY_ID;return await de.get(`/api/revenue-recognition/${t}/schedules`,{headers:Ps()}).then(r=>(r==null?void 0:r.items)||[])},createSchedule:async(s,t)=>await de.post(`/api/revenue-recognition/${s}/schedules`,t,{headers:Ps()}),runRecognition:async(s,t,r)=>await de.post(`/api/revenue-recognition/${s}/run`,{periodStart:t,periodEnd:r},{headers:Ps()}),getContracts:async s=>{const t=await $C.getSchedules(s);return[...new Set(t.map(n=>n.contractId).filter(Boolean))].map(n=>({id:n,name:`Contract ${n}`}))}},XL={importTransactions:async(s,t)=>await de.post("/card-transactions/import",{companyId:t||DEFAULT_COMPANY_ID,rows:s},{headers:Ps()}),getExceptions:async s=>{const t=new URLSearchParams;s!=null&&s.reason&&t.append("reason",s.reason);const r=t.toString(),n=await de.get(`/card-exceptions${r?`?${r}`:""}`,{headers:Ps()});return(n==null?void 0:n.exceptions)||[]},resolveCreate:async(s,t)=>await de.post(`/card-exceptions/${s}/resolve-create`,{receiptDataUrl:t==null?void 0:t.receiptDataUrl},{headers:Ps()}),resolveMatch:async(s,t)=>await de.post(`/card-exceptions/${s}/resolve-match`,{expenseId:t},{headers:Ps()}),dismiss:async s=>await de.delete(`/card-exceptions/${s}`,{headers:Ps()})};function nte(s,t){const{asOf:r,companyId:n,page:a,pageSize:i}=s;return ys({queryKey:["trial-balance",{asOf:r,companyId:n,page:a,pageSize:i}],queryFn:async()=>await ll.trialBalanceApi.getTrialBalance(r,n,a,i),staleTime:6e4,...t})}function ate(s,t){const{companyId:r,includeInactive:n,page:a,pageSize:i}=s;return ys({queryKey:["accounts",{companyId:r,includeInactive:n,page:a,pageSize:i}],queryFn:async()=>(await ll.chartOfAccountsApi.getAll(r,!!n,a,i)).accounts,staleTime:6e4,...t})}function ite(s,t){const{companyId:r,page:n,pageSize:a}=s;return ys({queryKey:["journal-entries",{companyId:r,page:n,pageSize:a}],queryFn:async()=>await ll.journalEntriesApi.getAll(r,n,a),staleTime:3e4,...t})}function ote(s,t){const r=x.useMemo(()=>({companyId:s.companyId,startDate:s.startDate,endDate:s.endDate,accountId:s.accountId||void 0,page:s.page||1,pageSize:s.pageSize||10}),[s.companyId,s.startDate,s.endDate,s.accountId,s.page,s.pageSize]);return ys({queryKey:["general-ledger",r],queryFn:async()=>await ll.generalLedgerApi.getGeneralLedger(r),staleTime:3e4,placeholderData:n=>n,...t})}function gu(s="demo"){const[t,r]=x.useState(!1),[n,a]=x.useState(!1);return x.useEffect(()=>{a(!0)},[]),x.useEffect(()=>{if(!n)return;let i=!1;return(async()=>{try{if(typeof window<"u"&&localStorage.getItem("disable_demo_auth")==="true"){r(!1);return}const o=typeof window<"u"&&localStorage.getItem("tenant_id")||"tenant_demo";de.setAuth("",o);const l=await de.getDemoToken(s,["admin","accountant"]);if(i)return;if(l!=null&&l.token){try{localStorage.setItem("auth_token",l.token)}catch{}de.setAuth(l.token,o),i||r(!0)}}catch{}})(),()=>{i=!0}},[s,n]),{ready:t}}const ge=x.forwardRef(({className:s,type:t,...r},n)=>e.jsx("input",{type:t,className:ns("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:n,...r}));ge.displayName="Input";function Q6(s,t){if(typeof s=="function")return s(t);s!=null&&(s.current=t)}function lte(...s){return t=>{let r=!1;const n=s.map(a=>{const i=Q6(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():Q6(s[a],null)}}}}var QL=x.forwardRef((s,t)=>{const{children:r,...n}=s,a=x.Children.toArray(r),i=a.find(dte);if(i){const o=i.props.children,l=a.map(c=>c===i?x.Children.count(o)>1?x.Children.only(null):x.isValidElement(o)?o.props.children:null:c);return e.jsx(BC,{...n,ref:t,children:x.isValidElement(o)?x.cloneElement(o,void 0,l):null})}return e.jsx(BC,{...n,ref:t,children:r})});QL.displayName="Slot";var BC=x.forwardRef((s,t)=>{const{children:r,...n}=s;if(x.isValidElement(r)){const a=hte(r);return x.cloneElement(r,{...ute(n,r.props),ref:t?lte(t,a):a})}return x.Children.count(r)>1?x.Children.only(null):null});BC.displayName="SlotClone";var cte=({children:s})=>e.jsx(e.Fragment,{children:s});function dte(s){return x.isValidElement(s)&&s.type===cte}function ute(s,t){const r={...t};for(const n in t){const a=s[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...l)=>{i(...l),a(...l)}:a&&(r[n]=a):n==="style"?r[n]={...a,...i}:n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return{...s,...r}}function hte(s){var n,a;let t=(n=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}var mte=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],fte=mte.reduce((s,t)=>{const r=x.forwardRef((n,a)=>{const{asChild:i,...o}=n,l=i?QL:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(l,{...o,ref:a})});return r.displayName=`Primitive.${t}`,{...s,[t]:r}},{}),xte="Label",ZL=x.forwardRef((s,t)=>e.jsx(fte.label,{...s,ref:t,onMouseDown:r=>{var a;r.target.closest("button, input, select, textarea")||((a=s.onMouseDown)==null||a.call(s,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));ZL.displayName=xte;var pte=ZL;function B({className:s,...t}){return e.jsx(pte,{"data-slot":"label",className:ns("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",s),...t})}function Xs({className:s,...t}){return e.jsx("textarea",{"data-slot":"textarea",className:ns("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),...t})}function gte(s,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(s==null||s(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function Z6(s,t){if(typeof s=="function")return s(t);s!=null&&(s.current=t)}function e7(...s){return t=>{let r=!1;const n=s.map(a=>{const i=Z6(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():Z6(s[a],null)}}}}function vte(...s){return x.useCallback(e7(...s),s)}function yte(s,t=[]){let r=[];function n(i,o){const l=x.createContext(o),c=r.length;r=[...r,o];const d=h=>{var y;const{scope:f,children:m,...p}=h,g=((y=f==null?void 0:f[s])==null?void 0:y[c])||l,v=x.useMemo(()=>p,Object.values(p));return e.jsx(g.Provider,{value:v,children:m})};d.displayName=i+"Provider";function u(h,f){var g;const m=((g=f==null?void 0:f[s])==null?void 0:g[c])||l,p=x.useContext(m);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[d,u]}const a=()=>{const i=r.map(o=>x.createContext(o));return function(l){const c=(l==null?void 0:l[s])||i;return x.useMemo(()=>({[`__scope${s}`]:{...l,[s]:c}}),[l,c])}};return a.scopeName=s,[n,jte(a,...t)]}function jte(...s){const t=s[0];if(s.length===1)return t;const r=()=>{const n=s.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=n.reduce((l,{useScope:c,scopeName:d})=>{const h=c(i)[`__scope${d}`];return{...l,...h}},{});return x.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}function t7(s){const t=x.useRef(s);return x.useEffect(()=>{t.current=s}),x.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function bte({prop:s,defaultProp:t,onChange:r=()=>{}}){const[n,a]=Nte({defaultProp:t,onChange:r}),i=s!==void 0,o=i?s:n,l=t7(r),c=x.useCallback(d=>{if(i){const h=typeof d=="function"?d(s):d;h!==s&&l(h)}else a(d)},[i,s,a,l]);return[o,c]}function Nte({defaultProp:s,onChange:t}){const r=x.useState(s),[n]=r,a=x.useRef(n),i=t7(t);return x.useEffect(()=>{a.current!==n&&(i(n),a.current=n)},[n,a,i]),r}function wte(s){const t=x.useRef({value:s,previous:s});return x.useMemo(()=>(t.current.value!==s&&(t.current.previous=t.current.value,t.current.value=s),t.current.previous),[s])}var Ste=globalThis!=null&&globalThis.document?x.useLayoutEffect:()=>{};function Cte(s){const[t,r]=x.useState(void 0);return Ste(()=>{if(s){r({width:s.offsetWidth,height:s.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const i=a[0];let o,l;if("borderBoxSize"in i){const c=i.borderBoxSize,d=Array.isArray(c)?c[0]:c;o=d.inlineSize,l=d.blockSize}else o=s.offsetWidth,l=s.offsetHeight;r({width:o,height:l})});return n.observe(s,{box:"border-box"}),()=>n.unobserve(s)}else r(void 0)},[s]),t}var s7=x.forwardRef((s,t)=>{const{children:r,...n}=s,a=x.Children.toArray(r),i=a.find(Ete);if(i){const o=i.props.children,l=a.map(c=>c===i?x.Children.count(o)>1?x.Children.only(null):x.isValidElement(o)?o.props.children:null:c);return e.jsx(UC,{...n,ref:t,children:x.isValidElement(o)?x.cloneElement(o,void 0,l):null})}return e.jsx(UC,{...n,ref:t,children:r})});s7.displayName="Slot";var UC=x.forwardRef((s,t)=>{const{children:r,...n}=s;if(x.isValidElement(r)){const a=Pte(r);return x.cloneElement(r,{...Ite(n,r.props),ref:t?e7(t,a):a})}return x.Children.count(r)>1?x.Children.only(null):null});UC.displayName="SlotClone";var Ate=({children:s})=>e.jsx(e.Fragment,{children:s});function Ete(s){return x.isValidElement(s)&&s.type===Ate}function Ite(s,t){const r={...t};for(const n in t){const a=s[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...l)=>{i(...l),a(...l)}:a&&(r[n]=a):n==="style"?r[n]={...a,...i}:n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return{...s,...r}}function Pte(s){var n,a;let t=(n=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}var _te=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],r7=_te.reduce((s,t)=>{const r=x.forwardRef((n,a)=>{const{asChild:i,...o}=n,l=i?s7:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(l,{...o,ref:a})});return r.displayName=`Primitive.${t}`,{...s,[t]:r}},{}),K5="Switch",[kte]=yte(K5),[Tte,Dte]=kte(K5),n7=x.forwardRef((s,t)=>{const{__scopeSwitch:r,name:n,checked:a,defaultChecked:i,required:o,disabled:l,value:c="on",onCheckedChange:d,form:u,...h}=s,[f,m]=x.useState(null),p=vte(t,b=>m(b)),g=x.useRef(!1),v=f?u||!!f.closest("form"):!0,[y=!1,j]=bte({prop:a,defaultProp:i,onChange:d});return e.jsxs(Tte,{scope:r,checked:y,disabled:l,children:[e.jsx(r7.button,{type:"button",role:"switch","aria-checked":y,"aria-required":o,"data-state":o7(y),"data-disabled":l?"":void 0,disabled:l,value:c,...h,ref:p,onClick:gte(s.onClick,b=>{j(w=>!w),v&&(g.current=b.isPropagationStopped(),g.current||b.stopPropagation())})}),v&&e.jsx(Ote,{control:f,bubbles:!g.current,name:n,value:c,checked:y,required:o,disabled:l,form:u,style:{transform:"translateX(-100%)"}})]})});n7.displayName=K5;var a7="SwitchThumb",i7=x.forwardRef((s,t)=>{const{__scopeSwitch:r,...n}=s,a=Dte(a7,r);return e.jsx(r7.span,{"data-state":o7(a.checked),"data-disabled":a.disabled?"":void 0,...n,ref:t})});i7.displayName=a7;var Ote=s=>{const{control:t,checked:r,bubbles:n=!0,...a}=s,i=x.useRef(null),o=wte(r),l=Cte(t);return x.useEffect(()=>{const c=i.current,d=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(d,"checked").set;if(o!==r&&h){const f=new Event("click",{bubbles:n});h.call(c,r),c.dispatchEvent(f)}},[o,r,n]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:i,style:{...s.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function o7(s){return s?"checked":"unchecked"}var Rte=n7,Fte=i7;function ro({className:s,...t}){return e.jsx(Rte,{"data-slot":"switch",className:ns("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...t,children:e.jsx(Fte,{"data-slot":"switch-thumb",className:ns("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}function Mte(s){const t=x.useRef({value:s,previous:s});return x.useMemo(()=>(t.current.value!==s&&(t.current.previous=t.current.value,t.current.value=s),t.current.previous),[s])}function Lte(s){const[t,r]=x.useState(void 0);return tH(()=>{if(s){r({width:s.offsetWidth,height:s.offsetHeight});const n=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const i=a[0];let o,l;if("borderBoxSize"in i){const c=i.borderBoxSize,d=Array.isArray(c)?c[0]:c;o=d.inlineSize,l=d.blockSize}else o=s.offsetWidth,l=s.offsetHeight;r({width:o,height:l})});return n.observe(s,{box:"border-box"}),()=>n.unobserve(s)}else r(void 0)},[s]),t}var dN="Checkbox",[$te]=qR(dN),[Bte,Y5]=$te(dN);function Ute(s){const{__scopeCheckbox:t,checked:r,children:n,defaultChecked:a,disabled:i,form:o,name:l,onCheckedChange:c,required:d,value:u="on",internal_do_not_use_render:h}=s,[f,m]=rH({prop:r,defaultProp:a??!1,onChange:c,caller:dN}),[p,g]=x.useState(null),[v,y]=x.useState(null),j=x.useRef(!1),b=p?!!o||!!p.closest("form"):!0,w={checked:f,disabled:i,setChecked:m,control:p,setControl:g,name:l,form:o,value:u,hasConsumerStoppedPropagationRef:j,required:d,defaultChecked:Cm(a)?!1:a,isFormControl:b,bubbleInput:v,setBubbleInput:y};return e.jsx(Bte,{scope:t,...w,children:zte(h)?h(w):n})}var l7="CheckboxTrigger",c7=x.forwardRef(({__scopeCheckbox:s,onKeyDown:t,onClick:r,...n},a)=>{const{control:i,value:o,disabled:l,checked:c,required:d,setControl:u,setChecked:h,hasConsumerStoppedPropagationRef:f,isFormControl:m,bubbleInput:p}=Y5(l7,s),g=VR(a,u),v=x.useRef(c);return x.useEffect(()=>{const y=i==null?void 0:i.form;if(y){const j=()=>h(v.current);return y.addEventListener("reset",j),()=>y.removeEventListener("reset",j)}},[i,h]),e.jsx(Tc.button,{type:"button",role:"checkbox","aria-checked":Cm(c)?"mixed":c,"aria-required":d,"data-state":f7(c),"data-disabled":l?"":void 0,disabled:l,value:o,...n,ref:g,onKeyDown:RI(t,y=>{y.key==="Enter"&&y.preventDefault()}),onClick:RI(r,y=>{h(j=>Cm(j)?!0:!j),p&&m&&(f.current=y.isPropagationStopped(),f.current||y.stopPropagation())})})});c7.displayName=l7;var J5=x.forwardRef((s,t)=>{const{__scopeCheckbox:r,name:n,checked:a,defaultChecked:i,required:o,disabled:l,value:c,onCheckedChange:d,form:u,...h}=s;return e.jsx(Ute,{__scopeCheckbox:r,checked:a,defaultChecked:i,disabled:l,required:o,onCheckedChange:d,name:n,form:u,value:c,internal_do_not_use_render:({isFormControl:f})=>e.jsxs(e.Fragment,{children:[e.jsx(c7,{...h,ref:t,__scopeCheckbox:r}),f&&e.jsx(m7,{__scopeCheckbox:r})]})})});J5.displayName=dN;var d7="CheckboxIndicator",u7=x.forwardRef((s,t)=>{const{__scopeCheckbox:r,forceMount:n,...a}=s,i=Y5(d7,r);return e.jsx(sH,{present:n||Cm(i.checked)||i.checked===!0,children:e.jsx(Tc.span,{"data-state":f7(i.checked),"data-disabled":i.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...s.style}})})});u7.displayName=d7;var h7="CheckboxBubbleInput",m7=x.forwardRef(({__scopeCheckbox:s,...t},r)=>{const{control:n,hasConsumerStoppedPropagationRef:a,checked:i,defaultChecked:o,required:l,disabled:c,name:d,value:u,form:h,bubbleInput:f,setBubbleInput:m}=Y5(h7,s),p=VR(r,m),g=Mte(i),v=Lte(n);x.useEffect(()=>{const j=f;if(!j)return;const b=window.HTMLInputElement.prototype,N=Object.getOwnPropertyDescriptor(b,"checked").set,C=!a.current;if(g!==i&&N){const S=new Event("click",{bubbles:C});j.indeterminate=Cm(i),N.call(j,Cm(i)?!1:i),j.dispatchEvent(S)}},[f,g,i,a]);const y=x.useRef(Cm(i)?!1:i);return e.jsx(Tc.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??y.current,required:l,disabled:c,name:d,value:u,form:h,...t,tabIndex:-1,ref:p,style:{...t.style,...v,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});m7.displayName=h7;function zte(s){return typeof s=="function"}function Cm(s){return s==="indeterminate"}function f7(s){return Cm(s)?"indeterminate":s?"checked":"unchecked"}const ka=x.forwardRef(({className:s,...t},r)=>e.jsx(J5,{ref:r,className:ns("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...t,children:e.jsx(u7,{className:ns("flex items-center justify-center text-current"),children:e.jsx(Ro,{className:"h-4 w-4"})})}));ka.displayName=J5.displayName;const qte=sy("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function ua({className:s,variant:t,...r}){return e.jsx("div",{"data-slot":"alert",role:"alert",className:ns(qte({variant:t}),s),...r})}function ha({className:s,...t}){return e.jsx("div",{"data-slot":"alert-description",className:ns("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",s),...t})}function eP(s,t){if(typeof s=="function")return s(t);s!=null&&(s.current=t)}function Vte(...s){return t=>{let r=!1;const n=s.map(a=>{const i=eP(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():eP(s[a],null)}}}}var x7=x.forwardRef((s,t)=>{const{children:r,...n}=s,a=x.Children.toArray(r),i=a.find(Hte);if(i){const o=i.props.children,l=a.map(c=>c===i?x.Children.count(o)>1?x.Children.only(null):x.isValidElement(o)?o.props.children:null:c);return e.jsx(zC,{...n,ref:t,children:x.isValidElement(o)?x.cloneElement(o,void 0,l):null})}return e.jsx(zC,{...n,ref:t,children:r})});x7.displayName="Slot";var zC=x.forwardRef((s,t)=>{const{children:r,...n}=s;if(x.isValidElement(r)){const a=Kte(r);return x.cloneElement(r,{...Gte(n,r.props),ref:t?Vte(t,a):a})}return x.Children.count(r)>1?x.Children.only(null):null});zC.displayName="SlotClone";var Wte=({children:s})=>e.jsx(e.Fragment,{children:s});function Hte(s){return x.isValidElement(s)&&s.type===Wte}function Gte(s,t){const r={...t};for(const n in t){const a=s[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...l)=>{i(...l),a(...l)}:a&&(r[n]=a):n==="style"?r[n]={...a,...i}:n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return{...s,...r}}function Kte(s){var n,a;let t=(n=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}var Yte=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Jte=Yte.reduce((s,t)=>{const r=x.forwardRef((n,a)=>{const{asChild:i,...o}=n,l=i?x7:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(l,{...o,ref:a})});return r.displayName=`Primitive.${t}`,{...s,[t]:r}},{}),Xte="Separator",tP="horizontal",Qte=["horizontal","vertical"],p7=x.forwardRef((s,t)=>{const{decorative:r,orientation:n=tP,...a}=s,i=Zte(n)?n:tP,l=r?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return e.jsx(Jte.div,{"data-orientation":i,...l,...a,ref:t})});p7.displayName=Xte;function Zte(s){return Qte.includes(s)}var ese=p7;function Jc({className:s,orientation:t="horizontal",decorative:r=!0,...n}){return e.jsx(ese,{"data-slot":"separator",decorative:r,orientation:t,className:ns("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",s),...n})}function tse(s){return s.name==="TypeError"&&s.message.includes("fetch")?{title:" Network Error",message:"Unable to connect to the server. Please check your internet connection and try again."}:s.name==="AbortError"||s.message.includes("timeout")?{title:" Timeout Error",message:"The request took too long to complete. Please try again."}:s.details&&Array.isArray(s.details)?{title:" Validation Error",message:"Please fix the following errors:",details:s.details.map(n=>`${n.field}: ${n.message}`).join(`
`)}:s.message?s.message.includes("validation_error")||s.message.includes("Invalid request body")?{title:" Validation Error",message:"Please check your input and try again."}:s.message.includes("ACCOUNT_CODE_EXISTS")||s.message.includes("duplicate_entry")||s.message.includes("already exists")||s.message.includes("Account with this code already exists")?{title:" Duplicate Account Code",message:"An account with this code already exists. Please use a different code."}:s.message.includes("not_found")?{title:" Not Found",message:"The requested resource was not found."}:s.message.includes("forbidden")||s.status===403?{title:" Access Denied",message:"You do not have permission to perform this action."}:s.message.includes("invalid_token")||s.status===401?{title:" Authentication Error",message:"Please log in again to continue."}:s.status===500?{title:" Server Error",message:"An internal server error occurred. Please try again later."}:{title:" Error",message:s.message}:{title:" Unknown Error",message:"An unexpected error occurred. Please try again."}}function sse(){gu("chart-of-accounts");const{toast:s}=za(),[t,r]=x.useState([]),[n,a]=x.useState([]),[i,o]=x.useState(null),[l,c]=x.useState([]),[d,u]=x.useState(null),[h,f]=x.useState(!0),[m,p]=x.useState(null),[g,v]=x.useState(""),[y,j]=x.useState("all"),[b,w]=x.useState("all"),[N,C]=x.useState(!1),[S,_]=x.useState(new Set),[k,F]=x.useState(!1),[A,T]=x.useState(null),[V,M]=x.useState(!1),[G,L]=x.useState(!1),[J,z]=x.useState(!1),[U,oe]=x.useState(null),[Q,P]=x.useState(null),[q,D]=x.useState("list"),[se,he]=x.useState(new Set),[be,pe]=x.useState(1),[Ae,Ee]=x.useState(20),[$e,O]=x.useState({name:"",code:"",description:"",accountTypeId:void 0,parentId:void 0,isActive:!0}),[te,re]=x.useState(null),[le,Z]=x.useState(!1),[K,X]=x.useState({code:"",name:"",description:"",normalBalance:"debit",category:""});x.useEffect(()=>{V&&!U&&t.length>0&&!$e.accountTypeId&&O(et=>({...et,accountTypeId:t[0].id}))},[V,U,t,$e.accountTypeId]);const ce=et=>{const lt=new Map,Fe=[];return et.forEach(ft=>{lt.set(ft.id,{...ft,children:[],level:0,isExpanded:se.has(ft.id)})}),et.forEach(ft=>{const He=lt.get(ft.id);if(He)if(ft.parentId&&lt.has(ft.parentId)){const Je=lt.get(ft.parentId);Je.children.push(He),He.level=Je.level+1}else Fe.push(He)}),Fe},Y=x.useCallback(async()=>{try{f(!0),p(null);const et=localStorage.getItem("company_id")||localStorage.getItem("companyId")||localStorage.getItem("company")||void 0,[lt,Fe]=await Promise.all([ll.accountTypesApi.getAll(et),ll.chartOfAccountsApi.getAll(et,N)]);r(Array.isArray(lt)?lt:[]);const ft=Array.isArray(Fe)?Fe:(Fe==null?void 0:Fe.accounts)??[];o(null),a(ft),u({totalAccounts:ft.length,activeAccounts:ft.filter(Je=>Je.isActive!==!1).length,totalAccountTypes:Array.isArray(lt)?lt.length:0,maxDepth:3,lastUpdated:new Date().toLocaleDateString()});const He=ce(ft);c(He)}catch(et){p(et instanceof Error?et.message:"Failed to load data")}finally{f(!1)}},[N,be,Ae,se]),ue=[{id:"activate",label:"Activate",icon:e.jsx(bs,{className:"h-4 w-4"}),action:Le},{id:"deactivate",label:"Deactivate",icon:e.jsx(nc,{className:"h-4 w-4"}),action:Me},{id:"export",label:"Export Selected",icon:e.jsx(An,{className:"h-4 w-4"}),action:tt},{id:"delete",label:"Delete",icon:e.jsx(hn,{className:"h-4 w-4"}),action:fe,destructive:!0}];x.useEffect(()=>{Y()},[Y]);const ve=x.useMemo(()=>n?n.filter(et=>{var lt;if(g){const Fe=g.toLowerCase();if(!(et.name.toLowerCase().includes(Fe)||et.code.toLowerCase().includes(Fe)||((lt=et.description)==null?void 0:lt.toLowerCase().includes(Fe))||et.accountType&&et.accountType.toLowerCase().includes(Fe)))return!1}return!(y!=="all"&&et.typeId!==y||b==="active"&&!et.isActive||b==="inactive"&&et.isActive)}):[],[n,g,y,b]);async function Le(et){try{T(null),await Promise.all(et.map(lt=>ll.chartOfAccountsApi.update(lt,{isActive:!0}))),await Y(),_(new Set),F(!1)}catch(lt){const Fe=lt instanceof Error?lt.message:"Failed to activate accounts";T(Fe),console.error("Failed to activate accounts:",lt)}}async function Me(et){try{T(null),await Promise.all(et.map(lt=>ll.chartOfAccountsApi.update(lt,{isActive:!1}))),await Y(),_(new Set),F(!1)}catch(lt){const Fe=lt instanceof Error?lt.message:"Failed to deactivate accounts";T(Fe),console.error("Failed to deactivate accounts:",lt)}}async function tt(et){try{T(null);const lt=n.filter(ft=>et.includes(ft.id)),Fe=ct(lt);dt(Fe,"chart-of-accounts.csv"),_(new Set),F(!1)}catch(lt){const Fe=lt instanceof Error?lt.message:"Failed to export accounts";T(Fe),console.error("Failed to export accounts:",lt)}}async function fe(et){if(confirm(`Are you sure you want to delete ${et.length} accounts? This action cannot be undone.`))try{T(null),await Promise.all(et.map(lt=>ll.chartOfAccountsApi.delete(lt))),await Y(),_(new Set),F(!1)}catch(lt){const Fe=lt instanceof Error?lt.message:"Failed to delete accounts";T(Fe),console.error("Failed to delete accounts:",lt)}}const ct=et=>{const lt=["Code","Name","Type","Parent","Description","Status"],Fe=et.map(ft=>{var He;return[ft.code,ft.name,ft.accountType||"",((He=ft.parent)==null?void 0:He.name)||"",ft.description||"",ft.isActive?"Active":"Inactive"]});return[lt,...Fe].map(ft=>ft.map(He=>`"${He}"`).join(",")).join(`
`)},dt=(et,lt)=>{const Fe=new Blob([et],{type:"text/csv"}),ft=URL.createObjectURL(Fe),He=document.createElement("a");He.href=ft,He.download=lt,He.click(),URL.revokeObjectURL(ft)},pt=async et=>{if(!et.accountTypeId)throw new Error("Account type is required.");if(!et.code||!et.name)throw new Error("Account code and name are required.");const lt=localStorage.getItem("company_id")||localStorage.getItem("companyId")||localStorage.getItem("company"),Fe={code:et.code.trim(),name:et.name.trim(),typeId:et.accountTypeId,parentId:et.parentId||void 0,companyId:lt};return await ll.chartOfAccountsApi.create(Fe)},qe=async et=>{et.preventDefault(),re(null),Z(!0);try{if(U){const lt={code:$e.code.trim(),name:$e.name.trim(),typeId:$e.accountTypeId,parentId:$e.parentId||void 0,isActive:$e.isActive};await ll.chartOfAccountsApi.update(U.id,lt)}else await pt($e);await Y(),M(!1),oe(null),O({name:"",code:"",description:"",accountTypeId:void 0,parentId:void 0,isActive:!0})}catch(lt){console.error("Failed to save account:",lt),console.error("Error details:",{message:lt.message,status:lt.status,details:lt.details,stack:lt.stack});const{title:Fe,message:ft,details:He}=tse(lt);let Je=ft,It=Fe;ft.includes("ACCOUNT_CODE_EXISTS")||ft.includes("duplicate")||ft.includes("already exists")||ft.includes("code already exists")?(It="Duplicate Account Code",Je="An account with this code already exists. Please use a different code."):ft.includes("validation_error")||ft.includes("Invalid input")||ft.includes("expected string, received undefined")?It="Validation Error":He&&(Je+=`

Details:
${He}`),re(Je),s({title:It,description:Je,variant:"destructive",duration:6e3})}finally{Z(!1)}},[mt,Rt]=x.useState(null),_e=async et=>{var lt,Fe,ft,He,Je,It,Gt,qt,As,Ht,xs,Ct;et.preventDefault(),Rt(null);try{if(!K.code||!K.name)throw new Error("Type code and name are required.");const ke={code:K.code,name:K.name};Q?await ll.accountTypesApi.update(Q.id,ke):await ll.accountTypesApi.create(ke),await Y(),L(!1),P(null),X({code:"",name:"",description:"",normalBalance:"debit",category:""})}catch(ke){let gt="Failed to save account type.";if(((ft=(Fe=(lt=ke==null?void 0:ke.response)==null?void 0:lt.data)==null?void 0:Fe.error)==null?void 0:ft.code)==="ACCOUNT_TYPE_EXISTS")gt="Account type code already exists. Please use a different code.";else if(((It=(Je=(He=ke==null?void 0:ke.response)==null?void 0:He.data)==null?void 0:Je.error)==null?void 0:It.code)==="invalid_body"){const us=(As=(qt=(Gt=ke==null?void 0:ke.response)==null?void 0:Gt.data)==null?void 0:qt.error)==null?void 0:As.details;us?gt=`Validation error: ${Object.entries(us.fieldErrors||{}).map(([Et,Pt])=>`${Et}: ${Array.isArray(Pt)?Pt.join(", "):Pt}`).join("; ")}`:gt="Invalid data provided. Please check all required fields."}else(Ct=(xs=(Ht=ke==null?void 0:ke.response)==null?void 0:Ht.data)==null?void 0:xs.error)!=null&&Ct.message?gt=ke.response.data.error.message:ke instanceof Error&&(gt=ke.message);Rt(gt),console.error("Failed to save account type:",ke)}},Xe=et=>{oe(et),O({name:et.name,code:et.code,description:et.description||"",accountTypeId:et.typeId,parentId:et.parentId||void 0,isActive:et.isActive}),M(!0)},At=et=>{P(et),X({code:et.code||"",name:et.name,description:et.description||"",normalBalance:et.normalBalance,category:et.category||""}),L(!0)},st=async et=>{if(confirm("Are you sure you want to delete this account?"))try{await ll.chartOfAccountsApi.delete(et),await Y()}catch(lt){const Fe=lt instanceof Error?lt.message:"Failed to delete account";p(Fe),console.error("Failed to delete account:",lt)}},$t=async et=>{if(confirm("Are you sure you want to delete this account type?"))try{await ll.accountTypesApi.delete(et),await Y()}catch(lt){const Fe=lt instanceof Error?lt.message:"Failed to delete account type";p(Fe),console.error("Failed to delete account type:",lt)}},fs=et=>{const lt=new Set(S);lt.has(et)?lt.delete(et):lt.add(et),_(lt),F(lt.size>0)},zt=()=>{S.size===ve.length?(_(new Set),F(!1)):(_(new Set(ve.map(et=>et.id))),F(!0))},St=et=>{const lt=new Set(se);lt.has(et)?lt.delete(et):lt.add(et),he(lt)},js=et=>{var He;const lt=et.children.length>0,Fe=se.has(et.id),ft=S.has(et.id);return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:`flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-50 ${ft?"bg-blue-50 border-blue-200":""}`,style:{paddingLeft:`${et.level*20+8}px`},children:[lt&&e.jsx(I,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>St(et.id),children:Fe?e.jsx(tc,{className:"h-4 w-4"}):e.jsx(Tm,{className:"h-4 w-4"})}),!lt&&e.jsx("div",{className:"w-6"}),e.jsx(ka,{checked:ft,onCheckedChange:()=>fs(et.id)}),e.jsxs("div",{className:"flex-1 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium",children:et.code}),e.jsx("span",{children:et.name}),!et.isActive&&e.jsx(Oe,{variant:"secondary",children:"Inactive"})]}),et.description&&et.description!==""&&e.jsx("p",{className:"text-sm text-gray-600",children:et.description})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Oe,{variant:"outline",children:((He=t.find(Je=>Je.id===et.typeId))==null?void 0:He.name)||"Unknown Type"}),e.jsxs(tu,{children:[e.jsx(su,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(Gy,{className:"h-4 w-4"})})}),e.jsxs(ru,{align:"end",children:[e.jsxs(Pn,{onClick:()=>Xe(et),children:[e.jsx(ln,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(Pn,{onClick:()=>{},children:[e.jsx(ac,{className:"mr-2 h-4 w-4"}),"Duplicate"]}),e.jsxs(Pn,{onClick:()=>{},children:[e.jsx(ir,{className:"mr-2 h-4 w-4"}),"View Transactions"]}),e.jsx(a1,{}),e.jsxs(Pn,{onClick:()=>st(et.id),className:"text-red-600",children:[e.jsx(hn,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})]})]}),lt&&Fe&&e.jsx("div",{className:"space-y-1",children:et.children.map(Je=>js(Je))})]},et.id)};return h?e.jsx("div",{className:"min-h-[400px] flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(kr,{size:"xl",color:"teal"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Loading Chart of Accounts"}),e.jsx("p",{className:"text-gray-500",children:"Please wait while we fetch your account data..."})]})]})}):m?e.jsx("div",{className:"min-h-[400px] flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center space-y-4 max-w-md",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(Ln,{className:"h-8 w-8 text-red-600"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Something went wrong"}),e.jsx("p",{className:"text-gray-500",children:m})]}),e.jsxs(I,{onClick:Y,variant:"outline",className:"mt-4",children:[e.jsx(Ts,{className:"h-4 w-4 mr-2"}),"Try Again"]})]})}):e.jsxs("div",{className:"space-y-6",children:[d&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(ne,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200 hover:shadow-md transition-all duration-200",children:[e.jsx(we,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{className:"text-sm font-medium text-blue-800",children:"Total Accounts"}),e.jsx(vn,{className:"h-5 w-5 text-blue-600"})]})}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-3xl font-bold text-blue-900",children:d.totalAccounts}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("p",{className:"text-sm text-blue-700",children:[d.activeAccounts," active accounts"]})]})]})]}),e.jsxs(ne,{className:"bg-gradient-to-br from-green-50 to-green-100 border-green-200 hover:shadow-md transition-all duration-200",children:[e.jsx(we,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{className:"text-sm font-medium text-green-800",children:"Account Types"}),e.jsx(Kh,{className:"h-5 w-5 text-green-600"})]})}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-3xl font-bold text-green-900",children:d.totalAccountTypes}),e.jsx("p",{className:"text-sm text-green-700 mt-2",children:"Categories defined"})]})]}),e.jsxs(ne,{className:"bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200 hover:shadow-md transition-all duration-200",children:[e.jsx(we,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{className:"text-sm font-medium text-purple-800",children:"Hierarchy Levels"}),e.jsx(t1,{className:"h-5 w-5 text-purple-600"})]})}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-3xl font-bold text-purple-900",children:d.maxDepth}),e.jsx("p",{className:"text-sm text-purple-700 mt-2",children:"Maximum depth"})]})]}),e.jsxs(ne,{className:"bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200 hover:shadow-md transition-all duration-200",children:[e.jsx(we,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{className:"text-sm font-medium text-orange-800",children:"Last Updated"}),e.jsx(Cr,{className:"h-5 w-5 text-orange-600"})]})}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-900",children:d.lastUpdated}),e.jsx("p",{className:"text-sm text-orange-700 mt-2",children:"Recent activity"})]})]})]}),e.jsx(ne,{className:"bg-gradient-to-r from-slate-50 to-gray-50 border-slate-200",children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Za,{className:"h-4 w-4 text-amber-500"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Quick Actions"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>M(!0),children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"New Account"]}),e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>L(!0),children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"New Type"]}),e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>z(!0),children:[e.jsx(Pl,{className:"h-4 w-4 mr-2"}),"Import"]})]})]})})})]}),e.jsxs(an,{defaultValue:"accounts",className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-lg border border-slate-200 p-1 shadow-sm",children:e.jsxs(on,{className:"grid w-full grid-cols-3 bg-transparent",children:[e.jsxs(vt,{value:"accounts",className:"data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700 data-[state=active]:shadow-sm",children:[e.jsx(lr,{className:"h-4 w-4 mr-2"}),"Accounts"]}),e.jsxs(vt,{value:"types",className:"data-[state=active]:bg-green-50 data-[state=active]:text-green-700 data-[state=active]:shadow-sm",children:[e.jsx(Kh,{className:"h-4 w-4 mr-2"}),"Account Types"]}),e.jsxs(vt,{value:"settings",className:"data-[state=active]:bg-purple-50 data-[state=active]:text-purple-700 data-[state=active]:shadow-sm",children:[e.jsx(en,{className:"h-4 w-4 mr-2"}),"Settings"]})]})}),e.jsx(yt,{value:"accounts",className:"space-y-6",children:e.jsxs(ne,{className:"shadow-sm border-slate-200",children:[e.jsx(we,{className:"bg-gradient-to-r from-slate-50 to-gray-50 border-b border-slate-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs(Se,{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(lr,{className:"h-5 w-5 text-blue-600"}),"Chart of Accounts"]}),e.jsx(Vt,{className:"text-gray-600 mt-1",children:"Manage your organization's account structure and hierarchy"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Oe,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:[ve.length," accounts"]}),e.jsxs(Oe,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[n.filter(et=>et.isActive).length," active"]})]})]})}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Rn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(ge,{placeholder:"Search accounts by name, code, description, or type...",value:g,onChange:et=>v(et.target.value),className:"pl-10 h-12 text-base"}),g&&e.jsx(I,{variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-8 w-8 p-0",onClick:()=>v(""),children:e.jsx(nc,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ic,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Filters:"})]}),e.jsxs(rt,{value:y,onValueChange:j,children:[e.jsx(nt,{className:"w-[160px]",children:e.jsx(it,{placeholder:"Account Type"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Types"}),t.filter(et=>et.id&&et.id!=="").map(et=>e.jsx(W,{value:et.id,children:et.name||et.code},et.id))]})]}),e.jsxs(rt,{value:b,onValueChange:w,children:[e.jsx(nt,{className:"w-[140px]",children:e.jsx(it,{placeholder:"Status"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Status"}),e.jsx(W,{value:"active",children:"Active"}),e.jsx(W,{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ro,{id:"show-inactive",checked:N,onCheckedChange:C}),e.jsx(B,{htmlFor:"show-inactive",className:"text-sm",children:"Show Inactive"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"View:"}),e.jsx("div",{className:"flex bg-gray-100 rounded-lg p-1",children:["list","tree","grid"].map(et=>e.jsxs(I,{variant:q===et?"default":"ghost",size:"sm",onClick:()=>D(et),className:"h-8 px-3 text-xs",children:[et==="list"&&e.jsx(Zt,{className:"h-3 w-3 mr-1"}),et==="tree"&&e.jsx(t1,{className:"h-3 w-3 mr-1"}),et==="grid"&&e.jsx(Kh,{className:"h-3 w-3 mr-1"}),et.charAt(0).toUpperCase()+et.slice(1)]},et))})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(I,{variant:"outline",size:"sm",onClick:Y,disabled:h,children:[e.jsx(Ts,{className:`h-4 w-4 mr-2 ${h?"animate-spin":""}`}),"Refresh"]})})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 p-4 bg-gradient-to-r from-slate-50 to-gray-50 rounded-lg border border-slate-200",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs(I,{onClick:()=>M(!0),className:"bg-blue-600 hover:bg-blue-700 text-white shadow-sm",children:[e.jsx(Ss,{className:"mr-2 h-4 w-4"}),"Add Account"]}),e.jsxs(I,{variant:"outline",onClick:()=>L(!0),className:"border-green-200 text-green-700 hover:bg-green-50",children:[e.jsx(Ss,{className:"mr-2 h-4 w-4"}),"Add Type"]}),e.jsxs(I,{variant:"outline",onClick:()=>z(!0),className:"border-purple-200 text-purple-700 hover:bg-purple-50",children:[e.jsx(Pl,{className:"mr-2 h-4 w-4"}),"Import"]}),e.jsxs(I,{variant:"outline",onClick:()=>tt(n.map(et=>et.id)),className:"border-orange-200 text-orange-700 hover:bg-orange-50",children:[e.jsx(An,{className:"mr-2 h-4 w-4"}),"Export All"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[S.size>0&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-blue-100 text-blue-800 rounded-full",children:[e.jsx(bs,{className:"h-4 w-4"}),e.jsxs("span",{className:"text-sm font-medium",children:[S.size," selected"]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[ve.length," of ",n.length," accounts"]})]})]}),k&&e.jsxs("div",{className:"space-y-3",children:[A&&e.jsxs(ua,{variant:"destructive",children:[e.jsx(Ln,{className:"h-4 w-4"}),e.jsx(ha,{children:A})]}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200 p-4 shadow-sm",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-blue-100 text-blue-800 rounded-full",children:[e.jsx(bs,{className:"h-4 w-4"}),e.jsxs("span",{className:"font-medium",children:[S.size," accounts selected"]})]}),e.jsx("span",{className:"text-sm text-blue-700",children:"Choose an action to perform on selected accounts"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[ue.map(et=>e.jsxs(I,{variant:et.destructive?"destructive":"outline",size:"sm",onClick:()=>et.action(Array.from(S)),className:et.destructive?"bg-red-600 hover:bg-red-700":"hover:shadow-sm",children:[et.icon,e.jsx("span",{className:"ml-2",children:et.label})]},et.id)),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>{_(new Set),F(!1),T(null)},className:"text-gray-600 hover:text-gray-800",children:"Clear Selection"})]})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-slate-50 to-gray-50 rounded-lg border border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ka,{checked:S.size===ve.length&&ve.length>0,onCheckedChange:zt,className:"h-5 w-5"}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Select All (",ve.length," accounts)"]}),S.size>0&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[S.size," of ",ve.length," selected"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[e.jsx("span",{children:"View:"}),e.jsx("span",{className:"font-medium",children:q.charAt(0).toUpperCase()+q.slice(1)})]})]}),q==="tree"?e.jsx("div",{className:"space-y-1",children:l.map(et=>js(et))}):q==="grid"?e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:ve.map(et=>{var lt;return e.jsxs(ne,{className:`cursor-pointer transition-colors ${S.has(et.id)?"border-blue-500 bg-blue-50":""}`,children:[e.jsxs(we,{className:"pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ka,{checked:S.has(et.id),onCheckedChange:()=>fs(et.id)}),e.jsx(Oe,{variant:"outline",children:et.code})]}),e.jsxs(tu,{children:[e.jsx(su,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(Gy,{className:"h-4 w-4"})})}),e.jsxs(ru,{children:[e.jsxs(Pn,{onClick:()=>Xe(et),children:[e.jsx(ln,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(Pn,{onClick:()=>st(et.id),children:[e.jsx(hn,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]}),e.jsx(Se,{className:"text-lg",children:et.name})]}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Type"}),e.jsx(Oe,{variant:"secondary",children:((lt=t.find(Fe=>Fe.id===et.typeId))==null?void 0:lt.name)||"Unknown Type"})]}),et.description&&et.description!==""&&e.jsx("p",{className:"text-sm text-muted-foreground",children:et.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Status"}),e.jsx(Oe,{variant:et.isActive?"default":"secondary",children:et.isActive?"Active":"Inactive"})]})]})})]},et.id)})}):e.jsx("div",{className:"space-y-2",children:ve.map(et=>{var lt;return e.jsxs("div",{className:`flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 ${S.has(et.id)?"border-blue-500 bg-blue-50":""}`,children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ka,{checked:S.has(et.id),onCheckedChange:()=>fs(et.id)}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium",children:et.code}),e.jsx("span",{children:et.name}),!et.isActive&&e.jsx(Oe,{variant:"secondary",children:"Inactive"})]}),et.description&&et.description!==""&&e.jsx("p",{className:"text-sm text-muted-foreground",children:et.description})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Oe,{variant:"outline",children:((lt=t.find(Fe=>Fe.id===et.typeId))==null?void 0:lt.name)||"Unknown Type"}),e.jsxs(tu,{children:[e.jsx(su,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(Gy,{className:"h-4 w-4"})})}),e.jsxs(ru,{align:"end",children:[e.jsxs(Pn,{onClick:()=>Xe(et),children:[e.jsx(ln,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(Pn,{onClick:()=>{},children:[e.jsx(ac,{className:"mr-2 h-4 w-4"}),"Duplicate"]}),e.jsxs(Pn,{onClick:()=>{},children:[e.jsx(ir,{className:"mr-2 h-4 w-4"}),"View Transactions"]}),e.jsx(a1,{}),e.jsxs(Pn,{onClick:()=>st(et.id),className:"text-red-600",children:[e.jsx(hn,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})]},et.id)})})]}),i&&i.pagination&&e.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-gray-50 rounded-lg border border-slate-200 p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(Zt,{className:"h-4 w-4"}),e.jsxs("span",{children:["Showing ",e.jsx("span",{className:"font-medium text-gray-900",children:(i.pagination.page-1)*i.pagination.pageSize+1})," to ",e.jsx("span",{className:"font-medium text-gray-900",children:Math.min(i.pagination.page*i.pagination.pageSize,i.pagination.totalCount)})," of ",e.jsx("span",{className:"font-medium text-gray-900",children:i.pagination.totalCount})," accounts"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{variant:"outline",size:"sm",onClick:()=>pe(1),disabled:!i.pagination.hasPrev,className:"h-8 w-8 p-0 hover:bg-blue-50 hover:border-blue-200",children:e.jsx(XF,{className:"h-4 w-4"})}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>pe(be-1),disabled:!i.pagination.hasPrev,className:"h-8 w-8 p-0 hover:bg-blue-50 hover:border-blue-200",children:e.jsx(tN,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex items-center gap-1 px-3 py-1 bg-white border border-slate-200 rounded-md",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["Page ",i.pagination.page]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["of ",i.pagination.totalPages]})]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>pe(be+1),disabled:!i.pagination.hasNext,className:"h-8 w-8 p-0 hover:bg-blue-50 hover:border-blue-200",children:e.jsx(Tm,{className:"h-4 w-4"})}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>pe(i.pagination.totalPages),disabled:!i.pagination.hasNext,className:"h-8 w-8 p-0 hover:bg-blue-50 hover:border-blue-200",children:e.jsx(QF,{className:"h-4 w-4"})})]})]})})]})]})}),e.jsx(yt,{value:"types",className:"space-y-6",children:e.jsxs(ne,{className:"shadow-sm border-slate-200",children:[e.jsx(we,{className:"bg-gradient-to-r from-green-50 to-emerald-50 border-b border-green-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs(Se,{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(Kh,{className:"h-5 w-5 text-green-600"}),"Account Types"]}),e.jsx(Vt,{className:"text-gray-600 mt-1",children:"Manage account categories and their normal balance behavior"})]}),e.jsxs(I,{onClick:()=>L(!0),className:"bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Add Type"]})]})}),e.jsx(ie,{className:"p-6",children:t.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Kh,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No account types yet"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Create your first account type to get started"}),e.jsxs(I,{onClick:()=>L(!0),children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Create Account Type"]})]}):e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:t.map(et=>e.jsxs(ne,{className:"hover:shadow-md transition-all duration-200 border-slate-200",children:[e.jsx(we,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{className:"text-lg text-gray-900",children:et.name}),e.jsxs(tu,{children:[e.jsx(su,{asChild:!0,children:e.jsx(I,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-slate-100",children:e.jsx(Gy,{className:"h-4 w-4"})})}),e.jsxs(ru,{children:[e.jsxs(Pn,{onClick:()=>At(et),children:[e.jsx(ln,{className:"mr-2 h-4 w-4"}),"Edit"]}),e.jsxs(Pn,{onClick:()=>$t(et.id),className:"text-red-600",children:[e.jsx(hn,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 bg-slate-50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Normal Balance"}),e.jsx(Oe,{variant:et.normalBalance==="debit"?"default":"secondary",className:et.normalBalance==="debit"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800",children:et.normalBalance==="debit"?"Debit":"Credit"})]}),et.description&&et.description!==""&&e.jsx("div",{className:"p-2 bg-slate-50 rounded-lg",children:e.jsx("p",{className:"text-sm text-gray-600",children:et.description})}),et.category&&et.category!==""&&e.jsxs("div",{className:"flex items-center justify-between p-2 bg-slate-50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Category"}),e.jsx(Oe,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:et.category})]})]})})]},et.id))})})]})}),e.jsx(yt,{value:"settings",className:"space-y-6",children:e.jsxs(ne,{className:"shadow-sm border-slate-200",children:[e.jsx(we,{className:"bg-gradient-to-r from-purple-50 to-violet-50 border-b border-purple-200",children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:e.jsxs("div",{children:[e.jsxs(Se,{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(en,{className:"h-5 w-5 text-purple-600"}),"Chart of Accounts Settings"]}),e.jsx(Vt,{className:"text-gray-600 mt-1",children:"Configure general settings and preferences for your chart of accounts"})]})})}),e.jsx(ie,{className:"p-6",children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Display Options"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-base font-medium",children:"Show Account Codes"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Display account codes alongside names for better identification"})]}),e.jsx(ro,{defaultChecked:!0})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-base font-medium",children:"Show Inactive Accounts"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Include inactive accounts in lists and searches"})]}),e.jsx(ro,{checked:N,onCheckedChange:C})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-base font-medium",children:"Auto-expand Tree"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Automatically expand account hierarchy when switching to tree view"})]}),e.jsx(ro,{})]})]})]}),e.jsx(Jc,{className:"bg-slate-200"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Import/Export"})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(ne,{className:"border-slate-200 hover:shadow-md transition-all duration-200",children:[e.jsxs(we,{className:"pb-3",children:[e.jsxs(Se,{className:"text-base flex items-center gap-2",children:[e.jsx(Pl,{className:"h-4 w-4 text-blue-600"}),"Import Accounts"]}),e.jsx(Vt,{children:"Upload a CSV file to import accounts in bulk"})]}),e.jsx(ie,{children:e.jsxs(I,{className:"w-full bg-blue-600 hover:bg-blue-700",onClick:()=>z(!0),children:[e.jsx(Pl,{className:"mr-2 h-4 w-4"}),"Import CSV"]})})]}),e.jsxs(ne,{className:"border-slate-200 hover:shadow-md transition-all duration-200",children:[e.jsxs(we,{className:"pb-3",children:[e.jsxs(Se,{className:"text-base flex items-center gap-2",children:[e.jsx(An,{className:"h-4 w-4 text-green-600"}),"Export Accounts"]}),e.jsx(Vt,{children:"Download your complete chart of accounts"})]}),e.jsx(ie,{children:e.jsxs(I,{className:"w-full bg-green-600 hover:bg-green-700",onClick:()=>tt(n.map(et=>et.id)),children:[e.jsx(An,{className:"mr-2 h-4 w-4"}),"Export CSV"]})})]})]})]}),e.jsx(Jc,{className:"bg-slate-200"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"System Information"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"p-4 bg-slate-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(yn,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Accounts"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n.length})]}),e.jsxs("div",{className:"p-4 bg-slate-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Kh,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Account Types"})]}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.length})]})]})]})]})})]})})]}),e.jsx(ts,{open:V,onOpenChange:M,children:e.jsxs(ss,{className:"sm:max-w-[600px]",children:[e.jsxs(as,{children:[e.jsx(is,{children:U?"Edit Account":"Add New Account"}),e.jsx(Ks,{children:U?"Update account information":"Create a new account in your chart of accounts"})]}),(()=>{var et;try{return e.jsxs("form",{onSubmit:qe,className:"space-y-4",children:[te&&e.jsxs(ua,{variant:"destructive",children:[e.jsx(Ln,{className:"h-4 w-4"}),e.jsx(ha,{children:te})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"account-code",children:"Account Code"}),e.jsx(ge,{id:"account-code",value:$e.code||"",onChange:lt=>O({...$e,code:lt.target.value}),placeholder:"e.g., 1000",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"account-name",children:"Account Name"}),e.jsx(ge,{id:"account-name",value:$e.name||"",onChange:lt=>O({...$e,name:lt.target.value}),placeholder:"e.g., Cash",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"account-type",children:"Account Type"}),t.filter(lt=>lt.id).length>0?e.jsxs("select",{id:"account-type",className:"w-full border rounded px-2 py-2",value:$e.accountTypeId||((et=t.filter(lt=>lt.id)[0])==null?void 0:et.id)||"placeholder",onChange:lt=>O({...$e,accountTypeId:lt.target.value==="placeholder"?void 0:lt.target.value}),required:!0,children:[e.jsx("option",{value:"placeholder",disabled:!0,children:"Select an account type"}),t.filter(lt=>lt.id).map(lt=>e.jsx("option",{value:lt.id,children:lt.name||lt.code},lt.id))]}):e.jsx("div",{className:"text-sm text-red-500",children:"No account types available. Please add an account type first."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"parent-account",children:"Parent Account (Optional)"}),e.jsxs("select",{id:"parent-account",className:"w-full border rounded px-2 py-2",value:$e.parentId||"none",onChange:lt=>O({...$e,parentId:lt.target.value==="none"?void 0:lt.target.value}),children:[e.jsx("option",{value:"none",children:"No Parent"}),n.filter(lt=>lt.id&&lt.id!==(U==null?void 0:U.id)).map(lt=>e.jsxs("option",{value:lt.id,children:[lt.code||""," - ",lt.name||""]},lt.id))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"account-description",children:"Description (Optional)"}),e.jsx(Xs,{id:"account-description",value:$e.description||"",onChange:lt=>O({...$e,description:lt.target.value}),placeholder:"Account description..."})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ro,{id:"account-active",checked:!!$e.isActive,onCheckedChange:lt=>O({...$e,isActive:lt})}),e.jsx(B,{htmlFor:"account-active",children:"Account is active"})]}),e.jsxs(Xr,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>M(!1),disabled:le,children:"Cancel"}),e.jsxs(I,{type:"submit",disabled:le,children:[le&&e.jsx(Ts,{className:"mr-2 h-4 w-4 animate-spin"}),le?"Saving...":U?"Update Account":"Create Account"]})]})]})}catch{return e.jsxs(ua,{variant:"destructive",children:[e.jsx(Ln,{className:"h-4 w-4"}),e.jsx(ha,{children:"Something went wrong rendering the account form. Please check your form state and try again."})]})}})()]})}),e.jsx(ts,{open:G,onOpenChange:L,children:e.jsxs(ss,{children:[e.jsxs(as,{children:[e.jsx(is,{children:Q?"Edit Account Type":"Add New Account Type"}),e.jsx(Ks,{children:Q?"Update account type information":"Create a new account type"})]}),e.jsxs("form",{onSubmit:_e,className:"space-y-4",children:[mt&&e.jsxs(ua,{variant:"destructive",children:[e.jsx(Ln,{className:"h-4 w-4"}),e.jsx(ha,{children:mt})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"type-code",children:"Type Code"}),e.jsx(ge,{id:"type-code",value:K.code,onChange:et=>X({...K,code:et.target.value}),placeholder:"e.g., ASSET",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"type-name",children:"Type Name"}),e.jsx(ge,{id:"type-name",value:K.name,onChange:et=>X({...K,name:et.target.value}),placeholder:"e.g., Assets",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"normal-balance",children:"Normal Balance"}),e.jsxs(rt,{value:K.normalBalance||"debit",onValueChange:et=>X({...K,normalBalance:et}),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"debit",children:"Debit"}),e.jsx(W,{value:"credit",children:"Credit"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"type-category",children:"Category (Optional)"}),e.jsx(ge,{id:"type-category",value:K.category,onChange:et=>X({...K,category:et.target.value}),placeholder:"e.g., Current Assets"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"type-description",children:"Description (Optional)"}),e.jsx(Xs,{id:"type-description",value:K.description,onChange:et=>X({...K,description:et.target.value}),placeholder:"Type description..."})]}),e.jsxs(Xr,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>L(!1),children:"Cancel"}),e.jsx(I,{type:"submit",children:Q?"Update Type":"Create Type"})]})]})]})}),e.jsx(ts,{open:J,onOpenChange:z,children:e.jsxs(ss,{children:[e.jsxs(as,{children:[e.jsx(is,{children:"Import Accounts"}),e.jsx(Ks,{children:"Upload a CSV file to import accounts. The file should include columns for Code, Name, Type, Parent, Description, and Status."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx(Pl,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsxs("div",{children:[e.jsx(I,{variant:"outline",children:"Choose File"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"or drag and drop your CSV file here"})]})]}),e.jsxs(ua,{children:[e.jsx(Ln,{className:"h-4 w-4"}),e.jsx(ha,{children:"Make sure your CSV file follows the correct format. Download our template for reference."})]})]}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:()=>z(!1),children:"Cancel"}),e.jsxs(I,{variant:"outline",children:[e.jsx(An,{className:"mr-2 h-4 w-4"}),"Download Template"]}),e.jsx(I,{children:"Import Accounts"})]})]})})]})}const rse=1,nse=1e6;let c2=0;function ase(){return c2=(c2+1)%Number.MAX_SAFE_INTEGER,c2.toString()}const d2=new Map,sP=s=>{if(d2.has(s))return;const t=setTimeout(()=>{d2.delete(s),_0({type:"REMOVE_TOAST",toastId:s})},nse);d2.set(s,t)},ise=(s,t)=>{switch(t.type){case"ADD_TOAST":return{...s,toasts:[t.toast,...s.toasts].slice(0,rse)};case"UPDATE_TOAST":return{...s,toasts:s.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?sP(r):s.toasts.forEach(n=>{sP(n.id)}),{...s,toasts:s.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...s,toasts:[]}:{...s,toasts:s.toasts.filter(r=>r.id!==t.toastId)}}},$j=[];let Bj={toasts:[]};function _0(s){Bj=ise(Bj,s),$j.forEach(t=>{t(Bj)})}function Uc({...s}){const t=ase(),r=a=>_0({type:"UPDATE_TOAST",toast:{...a,id:t}}),n=()=>_0({type:"DISMISS_TOAST",toastId:t});return _0({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:a=>{a||n()}}}),{id:t,dismiss:n,update:r}}function X5(){const[s,t]=x.useState(Bj);return x.useEffect(()=>($j.push(t),()=>{const r=$j.indexOf(t);r>-1&&$j.splice(r,1)}),[s]),{...s,toast:Uc,dismiss:r=>_0({type:"DISMISS_TOAST",toastId:r})}}function Qy({reportType:s,reportData:t,companyId:r,disabled:n=!1}){const[a,i]=x.useState(!1),{toast:o}=X5(),l=async c=>{if(!t){o({title:"No Data Available",description:"Please generate a report before exporting.",variant:"destructive"});return}i(!0);try{const d=localStorage.getItem("auth_token"),u=localStorage.getItem("tenant_id"),h=await fetch(`${qi.api.baseUrl}/api/enhanced-financial-reports/export`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`,"x-tenant-id":u||"tenant_demo"},body:JSON.stringify({report:(t==null?void 0:t.data)||t,format:c})});if(!h.ok)throw new Error(`Export failed: ${h.status} ${h.statusText}`);const f=await h.blob(),m=window.URL.createObjectURL(f),p=document.createElement("a");p.href=m;const g=new Date().toISOString().split("T")[0],v=s.replace("-","_").toUpperCase();p.download=`${v}_${r}_${g}.${c}`,document.body.appendChild(p),p.click(),p.remove(),window.URL.revokeObjectURL(m),o({title:"Export Successful",description:`${v} exported successfully as ${c.toUpperCase()}`})}catch(d){console.error("Export error:",d),o({title:"Export Failed",description:`Failed to export report: ${d instanceof Error?d.message:"Unknown error"}`,variant:"destructive"})}finally{i(!1)}};return e.jsxs(tu,{children:[e.jsx(su,{asChild:!0,children:e.jsxs(I,{variant:"outline",disabled:n||a||!t,className:"flex items-center gap-2",children:[e.jsx(An,{className:"h-4 w-4"}),a?"Exporting...":"Export"]})}),e.jsxs(ru,{align:"end",children:[e.jsxs(Pn,{onClick:()=>l("pdf"),disabled:n||a||!t,className:"flex items-center gap-2",children:[e.jsx(Zt,{className:"h-4 w-4"}),"Export as PDF"]}),e.jsxs(Pn,{onClick:()=>l("excel"),disabled:n||a||!t,className:"flex items-center gap-2",children:[e.jsx(Yf,{className:"h-4 w-4"}),"Export as Excel"]}),e.jsxs(Pn,{onClick:()=>l("csv"),disabled:n||a||!t,className:"flex items-center gap-2",children:[e.jsx(AY,{className:"h-4 w-4"}),"Export as CSV"]})]})]})}function l1({selectedCompany:s,defaultReportType:t,initialData:r}={}){const[n,a]=x.useState(s||zs()||""),[i,o]=x.useState([]),[l,c]=x.useState({startDate:new Date(new Date().getFullYear(),0,1).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0]}),[d,u]=x.useState(new Date().toISOString().split("T")[0]),[h,f]=x.useState(t||"balance-sheet"),[m,p]=x.useState(!1),[g,v]=x.useState(null),[y,j]=x.useState(null),[b,w]=x.useState(null),[N,C]=x.useState(null),{toast:S}=X5();x.useEffect(()=>{_()},[]);const _=async()=>{try{const J=await de.getCompanies({page:1,pageSize:50}),z=(J==null?void 0:J.data)||J||[];o(Array.isArray(z)?z:[])}catch(J){console.error("Error loading companies:",J);const z=zs();z&&o([{id:z,name:"Current Company"}])}};x.useEffect(()=>{r&&(r["balance-sheet"]&&v(r["balance-sheet"]),r["profit-loss"]&&j(r["profit-loss"]),r["cash-flow"]&&w(r["cash-flow"]))},[r]),x.useEffect(()=>{const J=()=>{h==="balance-sheet"?k():h==="profit-loss"?F():h==="cash-flow"&&A()};return window.addEventListener("journalEntryCreated",J),()=>window.removeEventListener("journalEntryCreated",J)},[h]);const k=async()=>{p(!0);try{console.log("Generating balance sheet for company:",n,"as of:",d);const J=await de.get(`/api/enhanced-financial-reports/balance-sheet?companyId=${n}&asOfDate=${d}`);console.log("Balance sheet data received:",J);const z=(J==null?void 0:J.data)||J;console.log("Setting fresh balance sheet data:",z),v(z),S({title:"Success",description:"Balance sheet generated successfully"})}catch(J){console.error("Balance sheet error:",J),S({title:"Error",description:`Failed to generate balance sheet: ${J instanceof Error?J.message:"Unknown error"}`,variant:"destructive"})}finally{p(!1)}},F=async()=>{p(!0);try{const J=await de.get(`/api/enhanced-financial-reports/profit-loss?companyId=${n}&startDate=${l.startDate}&endDate=${l.endDate}`);j((J==null?void 0:J.data)||J),S({title:"Success",description:"Profit & Loss statement generated successfully"})}catch(J){console.error("Profit & Loss error:",J),S({title:"Error",description:"Failed to generate Profit & Loss statement",variant:"destructive"})}finally{p(!1)}},A=async()=>{p(!0);try{const J=await de.get(`/api/enhanced-financial-reports/cash-flow?companyId=${n}&startDate=${l.startDate}&endDate=${l.endDate}`);w((J==null?void 0:J.data)||J),S({title:"Success",description:"Cash flow statement generated successfully"})}catch(J){console.error("Cash flow error:",J),S({title:"Error",description:"Failed to generate cash flow statement",variant:"destructive"})}finally{p(!1)}},T=async()=>{var J;p(!0);try{const z=await de.get(`/api/enhanced-financial-reports/ratios?companyId=${n}&asOfDate=${d}`);C(((J=z==null?void 0:z.data)==null?void 0:J.ratios)||(z==null?void 0:z.ratios)||{}),S({title:"Success",description:"Financial ratios calculated successfully"})}catch(z){console.error("Financial ratios error:",z),S({title:"Error",description:"Failed to calculate financial ratios",variant:"destructive"})}finally{p(!1)}},V=()=>{var J,z,U,oe,Q,P,q,D,se,he,be;return g?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(ne,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(Se,{className:"text-sm font-medium text-green-600",children:"Total Assets"})}),e.jsx(ie,{children:e.jsxs("div",{className:"text-2xl font-bold",children:["$",g.totalAssets.toLocaleString()]})})]}),e.jsxs(ne,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(Se,{className:"text-sm font-medium text-red-600",children:"Total Liabilities"})}),e.jsx(ie,{children:e.jsxs("div",{className:"text-2xl font-bold",children:["$",g.totalLiabilities.toLocaleString()]})})]}),e.jsxs(ne,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(Se,{className:"text-sm font-medium text-blue-600",children:"Total Equity"})}),e.jsx(ie,{children:e.jsxs("div",{className:"text-2xl font-bold",children:["$",g.totalEquity.toLocaleString()]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Eo,{className:"h-5 w-5"}),"Assets"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-green-600",children:"Current Assets"}),e.jsxs("div",{className:"text-lg font-semibold",children:["$",g.assets.totalCurrentAssets.toLocaleString()]}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 mt-2 space-y-1",children:g.assets.currentAssets.map(pe=>e.jsxs("li",{children:[pe.accountName," (",pe.accountNumber,"): $",pe.balance.toLocaleString()]},pe.accountId))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-green-600",children:"Fixed Assets"}),e.jsxs("div",{className:"text-lg font-semibold",children:["$",g.assets.totalFixedAssets.toLocaleString()]}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 mt-2 space-y-1",children:g.assets.fixedAssets.map(pe=>e.jsxs("li",{children:[pe.accountName," (",pe.accountNumber,"): $",pe.balance.toLocaleString()]},pe.accountId))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-green-600",children:"Other Assets"}),e.jsxs("div",{className:"text-lg font-semibold",children:["$",g.assets.totalOtherAssets.toLocaleString()]}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 mt-2 space-y-1",children:g.assets.otherAssets.map(pe=>e.jsxs("li",{children:[pe.accountName," (",pe.accountNumber,"): $",pe.balance.toLocaleString()]},pe.accountId))})]})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(lr,{className:"h-5 w-5"}),"Liabilities & Equity"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-red-600",children:"Current Liabilities"}),e.jsxs("div",{className:"text-lg font-semibold",children:["$",g.liabilities.totalCurrentLiabilities.toLocaleString()]}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 mt-2 space-y-1",children:g.liabilities.currentLiabilities.map(pe=>e.jsxs("li",{children:[pe.accountName," (",pe.accountNumber,"): $",pe.balance.toLocaleString()]},pe.accountId))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-red-600",children:"Long-term Liabilities"}),e.jsxs("div",{className:"text-lg font-semibold",children:["$",g.liabilities.totalLongTermLiabilities.toLocaleString()]}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 mt-2 space-y-1",children:g.liabilities.longTermLiabilities.map(pe=>e.jsxs("li",{children:[pe.accountName," (",pe.accountNumber,"): $",pe.balance.toLocaleString()]},pe.accountId))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-blue-600",children:"Equity"}),e.jsxs("div",{className:"text-lg font-semibold",children:["$",g.equity.totalContributedCapital.toLocaleString()]}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 mt-2 space-y-1",children:g.equity.contributedCapital.map(pe=>e.jsxs("li",{children:[pe.accountName," (",pe.accountNumber,"): $",pe.balance.toLocaleString()]},pe.accountId))})]})]})})]})]}),g.changes&&e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx($s,{className:"h-5 w-5"}),"Changes Summary"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Assets Change"}),e.jsxs("div",{className:`text-lg font-semibold ${g.changes.assetsChange>=0?"text-green-600":"text-red-600"}`,children:["$",((J=g.changes.assetsChange)==null?void 0:J.toLocaleString())||"0"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Liabilities Change"}),e.jsxs("div",{className:`text-lg font-semibold ${g.changes.liabilitiesChange>=0?"text-red-600":"text-green-600"}`,children:["$",((z=g.changes.liabilitiesChange)==null?void 0:z.toLocaleString())||"0"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Equity Change"}),e.jsxs("div",{className:`text-lg font-semibold ${g.changes.equityChange>=0?"text-green-600":"text-red-600"}`,children:["$",((U=g.changes.equityChange)==null?void 0:U.toLocaleString())||"0"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Working Capital Change"}),e.jsxs("div",{className:`text-lg font-semibold ${g.changes.workingCapitalChange>=0?"text-green-600":"text-red-600"}`,children:["$",((oe=g.changes.workingCapitalChange)==null?void 0:oe.toLocaleString())||"0"]})]})]})})]}),g.ratios&&e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(yn,{className:"h-5 w-5"}),"Financial Ratios"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Current Ratio"}),e.jsx("div",{className:"text-lg font-semibold",children:((Q=g.ratios.currentRatio)==null?void 0:Q.toFixed(2))||"N/A"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Quick Ratio"}),e.jsx("div",{className:"text-lg font-semibold",children:((P=g.ratios.quickRatio)==null?void 0:P.toFixed(2))||"N/A"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Debt to Equity"}),e.jsx("div",{className:"text-lg font-semibold",children:((q=g.ratios.debtToEquityRatio)==null?void 0:q.toFixed(2))||"N/A"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Equity Multiplier"}),e.jsx("div",{className:"text-lg font-semibold",children:((D=g.ratios.equityMultiplier)==null?void 0:D.toFixed(2))||"N/A"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Return on Assets"}),e.jsxs("div",{className:"text-lg font-semibold",children:[((se=g.ratios.returnOnAssets)==null?void 0:se.toFixed(2))||"N/A","%"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Return on Equity"}),e.jsxs("div",{className:"text-lg font-semibold",children:[((he=g.ratios.returnOnEquity)==null?void 0:he.toFixed(2))||"N/A","%"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Asset Turnover"}),e.jsx("div",{className:"text-lg font-semibold",children:((be=g.ratios.assetTurnover)==null?void 0:be.toFixed(2))||"N/A"})]})]})})]})]}):e.jsx("div",{className:"text-center text-gray-500",children:"Generate a balance sheet to view data"})},M=()=>{var J,z,U,oe,Q,P,q,D,se,he,be,pe,Ae,Ee,$e,O,te,re,le,Z,K,X,ce,Y,ue,ve,Le,Me,tt,fe,ct,dt,pt,qe,mt,Rt,_e,Xe,At,st,$t,fs,zt,St,js,et,lt,Fe,ft,He,Je,It,Gt,qt,As,Ht,xs,Ct,ke,gt,us,We,Et,Pt,rs,ms,Bs,Vs,Ws,Ns,er,Ir,jn,Hs,qr,qn,In,Yr,$r,Vr,wn,Vn,De,ut,Pe,_t;return y?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(ne,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(Se,{className:"text-sm font-medium text-green-600",children:"Total Revenue"})}),e.jsx(ie,{children:e.jsxs("div",{className:"text-2xl font-bold",children:["$",((z=(J=y.revenue)==null?void 0:J.totalRevenue)==null?void 0:z.toLocaleString())||"0"]})})]}),e.jsxs(ne,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(Se,{className:"text-sm font-medium text-orange-600",children:"Gross Profit"})}),e.jsxs(ie,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",((U=y.grossProfit)==null?void 0:U.toLocaleString())||"0"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[((Q=(oe=y.margins)==null?void 0:oe.grossMargin)==null?void 0:Q.toFixed(1))||"0","% margin"]})]})]}),e.jsxs(ne,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(Se,{className:"text-sm font-medium text-blue-600",children:"Operating Income"})}),e.jsxs(ie,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",((P=y.operatingIncome)==null?void 0:P.toLocaleString())||"0"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[((D=(q=y.margins)==null?void 0:q.operatingMargin)==null?void 0:D.toFixed(1))||"0","% margin"]})]})]}),e.jsxs(ne,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(Se,{className:"text-sm font-medium text-purple-600",children:"Net Income"})}),e.jsxs(ie,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",((se=y.netIncome)==null?void 0:se.toLocaleString())||"0"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[((be=(he=y.margins)==null?void 0:he.netMargin)==null?void 0:be.toFixed(1))||"0","% margin"]})]})]})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx($s,{className:"h-5 w-5"}),"Revenue Breakdown"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-green-600",children:"Sales Revenue"}),e.jsxs("div",{className:"text-lg font-semibold",children:["$",((Ee=(Ae=(pe=y.revenue)==null?void 0:pe.salesRevenue)==null?void 0:Ae.reduce((bt,ps)=>bt+ps.balance,0))==null?void 0:Ee.toLocaleString())||"0"]}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 mt-2 space-y-1",children:(O=($e=y.revenue)==null?void 0:$e.salesRevenue)==null?void 0:O.map(bt=>e.jsxs("li",{children:[bt.accountName," (",bt.accountNumber,"): $",bt.balance.toLocaleString()]},bt.accountId))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-green-600",children:"Service Revenue"}),e.jsxs("div",{className:"text-lg font-semibold",children:["$",((le=(re=(te=y.revenue)==null?void 0:te.serviceRevenue)==null?void 0:re.reduce((bt,ps)=>bt+ps.balance,0))==null?void 0:le.toLocaleString())||"0"]}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 mt-2 space-y-1",children:(K=(Z=y.revenue)==null?void 0:Z.serviceRevenue)==null?void 0:K.map(bt=>e.jsxs("li",{children:[bt.accountName," (",bt.accountNumber,"): $",bt.balance.toLocaleString()]},bt.accountId))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-green-600",children:"Other Revenue"}),e.jsxs("div",{className:"text-lg font-semibold",children:["$",((Y=(ce=(X=y.revenue)==null?void 0:X.otherRevenue)==null?void 0:ce.reduce((bt,ps)=>bt+ps.balance,0))==null?void 0:Y.toLocaleString())||"0"]}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 mt-2 space-y-1",children:(ve=(ue=y.revenue)==null?void 0:ue.otherRevenue)==null?void 0:ve.map(bt=>e.jsxs("li",{children:[bt.accountName," (",bt.accountNumber,"): $",bt.balance.toLocaleString()]},bt.accountId))})]})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(lr,{className:"h-5 w-5"}),"Cost of Goods Sold"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-red-600",children:"Direct Materials"}),e.jsxs("div",{className:"text-lg font-semibold",children:["$",((tt=(Me=(Le=y.costOfGoodsSold)==null?void 0:Le.directMaterials)==null?void 0:Me.reduce((bt,ps)=>bt+ps.balance,0))==null?void 0:tt.toLocaleString())||"0"]}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 mt-2 space-y-1",children:(ct=(fe=y.costOfGoodsSold)==null?void 0:fe.directMaterials)==null?void 0:ct.map(bt=>e.jsxs("li",{children:[bt.accountName," (",bt.accountNumber,"): $",bt.balance.toLocaleString()]},bt.accountId))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-red-600",children:"Direct Labor"}),e.jsxs("div",{className:"text-lg font-semibold",children:["$",((qe=(pt=(dt=y.costOfGoodsSold)==null?void 0:dt.directLabor)==null?void 0:pt.reduce((bt,ps)=>bt+ps.balance,0))==null?void 0:qe.toLocaleString())||"0"]}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 mt-2 space-y-1",children:(Rt=(mt=y.costOfGoodsSold)==null?void 0:mt.directLabor)==null?void 0:Rt.map(bt=>e.jsxs("li",{children:[bt.accountName," (",bt.accountNumber,"): $",bt.balance.toLocaleString()]},bt.accountId))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-red-600",children:"Overhead"}),e.jsxs("div",{className:"text-lg font-semibold",children:["$",((At=(Xe=(_e=y.costOfGoodsSold)==null?void 0:_e.overhead)==null?void 0:Xe.reduce((bt,ps)=>bt+ps.balance,0))==null?void 0:At.toLocaleString())||"0"]}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 mt-2 space-y-1",children:($t=(st=y.costOfGoodsSold)==null?void 0:st.overhead)==null?void 0:$t.map(bt=>e.jsxs("li",{children:[bt.accountName," (",bt.accountNumber,"): $",bt.balance.toLocaleString()]},bt.accountId))})]}),e.jsxs("div",{className:"border-t pt-2",children:[e.jsx("div",{className:"font-bold text-red-600",children:"Total COGS"}),e.jsxs("div",{className:"text-xl font-bold",children:["$",((zt=(fs=y.costOfGoodsSold)==null?void 0:fs.totalCOGS)==null?void 0:zt.toLocaleString())||"0"]})]})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Eo,{className:"h-5 w-5"}),"Operating Expenses"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-red-600",children:"Selling Expenses"}),e.jsxs("div",{className:"text-lg font-semibold",children:["$",((et=(js=(St=y.operatingExpenses)==null?void 0:St.sellingExpenses)==null?void 0:js.reduce((bt,ps)=>bt+ps.balance,0))==null?void 0:et.toLocaleString())||"0"]}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 mt-2 space-y-1",children:(Fe=(lt=y.operatingExpenses)==null?void 0:lt.sellingExpenses)==null?void 0:Fe.map(bt=>e.jsxs("li",{children:[bt.accountName," (",bt.accountNumber,"): $",bt.balance.toLocaleString()]},bt.accountId))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-red-600",children:"Administrative Expenses"}),e.jsxs("div",{className:"text-lg font-semibold",children:["$",((Je=(He=(ft=y.operatingExpenses)==null?void 0:ft.administrativeExpenses)==null?void 0:He.reduce((bt,ps)=>bt+ps.balance,0))==null?void 0:Je.toLocaleString())||"0"]}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 mt-2 space-y-1",children:(Gt=(It=y.operatingExpenses)==null?void 0:It.administrativeExpenses)==null?void 0:Gt.map(bt=>e.jsxs("li",{children:[bt.accountName," (",bt.accountNumber,"): $",bt.balance.toLocaleString()]},bt.accountId))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-red-600",children:"Research & Development"}),e.jsxs("div",{className:"text-lg font-semibold",children:["$",((Ht=(As=(qt=y.operatingExpenses)==null?void 0:qt.researchExpenses)==null?void 0:As.reduce((bt,ps)=>bt+ps.balance,0))==null?void 0:Ht.toLocaleString())||"0"]}),e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-700 mt-2 space-y-1",children:(Ct=(xs=y.operatingExpenses)==null?void 0:xs.researchExpenses)==null?void 0:Ct.map(bt=>e.jsxs("li",{children:[bt.accountName," (",bt.accountNumber,"): $",bt.balance.toLocaleString()]},bt.accountId))})]}),e.jsxs("div",{className:"border-t pt-2",children:[e.jsx("div",{className:"font-bold text-red-600",children:"Total Operating Expenses"}),e.jsxs("div",{className:"text-xl font-bold",children:["$",((gt=(ke=y.operatingExpenses)==null?void 0:ke.totalOperatingExpenses)==null?void 0:gt.toLocaleString())||"0"]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx($s,{className:"h-5 w-5"}),"Other Income"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-green-600",children:"Interest Income"}),e.jsxs("div",{className:"text-lg font-semibold",children:["$",((Et=(We=(us=y.otherIncome)==null?void 0:us.interestIncome)==null?void 0:We.reduce((bt,ps)=>bt+ps.balance,0))==null?void 0:Et.toLocaleString())||"0"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-green-600",children:"Investment Income"}),e.jsxs("div",{className:"text-lg font-semibold",children:["$",((ms=(rs=(Pt=y.otherIncome)==null?void 0:Pt.investmentIncome)==null?void 0:rs.reduce((bt,ps)=>bt+ps.balance,0))==null?void 0:ms.toLocaleString())||"0"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-green-600",children:"Other Income"}),e.jsxs("div",{className:"text-lg font-semibold",children:["$",((Ws=(Vs=(Bs=y.otherIncome)==null?void 0:Bs.otherIncome)==null?void 0:Vs.reduce((bt,ps)=>bt+ps.balance,0))==null?void 0:Ws.toLocaleString())||"0"]})]}),e.jsxs("div",{className:"border-t pt-2",children:[e.jsx("div",{className:"font-bold text-green-600",children:"Total Other Income"}),e.jsxs("div",{className:"text-xl font-bold",children:["$",((er=(Ns=y.otherIncome)==null?void 0:Ns.totalOtherIncome)==null?void 0:er.toLocaleString())||"0"]})]})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(lr,{className:"h-5 w-5"}),"Other Expenses"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-red-600",children:"Interest Expense"}),e.jsxs("div",{className:"text-lg font-semibold",children:["$",((Hs=(jn=(Ir=y.otherExpenses)==null?void 0:Ir.interestExpense)==null?void 0:jn.reduce((bt,ps)=>bt+ps.balance,0))==null?void 0:Hs.toLocaleString())||"0"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-red-600",children:"Taxes"}),e.jsxs("div",{className:"text-lg font-semibold",children:["$",((In=(qn=(qr=y.otherExpenses)==null?void 0:qr.taxes)==null?void 0:qn.reduce((bt,ps)=>bt+ps.balance,0))==null?void 0:In.toLocaleString())||"0"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-red-600",children:"Other Expenses"}),e.jsxs("div",{className:"text-lg font-semibold",children:["$",((Vr=($r=(Yr=y.otherExpenses)==null?void 0:Yr.otherExpenses)==null?void 0:$r.reduce((bt,ps)=>bt+ps.balance,0))==null?void 0:Vr.toLocaleString())||"0"]})]}),e.jsxs("div",{className:"border-t pt-2",children:[e.jsx("div",{className:"font-bold text-red-600",children:"Total Other Expenses"}),e.jsxs("div",{className:"text-xl font-bold",children:["$",((Vn=(wn=y.otherExpenses)==null?void 0:wn.totalOtherExpenses)==null?void 0:Vn.toLocaleString())||"0"]})]})]})})]})]}),y.changes&&e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx($s,{className:"h-5 w-5"}),"Period Changes"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Revenue Change"}),e.jsxs("div",{className:`text-lg font-semibold ${y.changes.revenueChange>=0?"text-green-600":"text-red-600"}`,children:["$",((De=y.changes.revenueChange)==null?void 0:De.toLocaleString())||"0"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Expense Change"}),e.jsxs("div",{className:`text-lg font-semibold ${y.changes.expenseChange>=0?"text-red-600":"text-green-600"}`,children:["$",((ut=y.changes.expenseChange)==null?void 0:ut.toLocaleString())||"0"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Net Income Change"}),e.jsxs("div",{className:`text-lg font-semibold ${y.changes.netIncomeChange>=0?"text-green-600":"text-red-600"}`,children:["$",((Pe=y.changes.netIncomeChange)==null?void 0:Pe.toLocaleString())||"0"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Gross Profit Change"}),e.jsxs("div",{className:`text-lg font-semibold ${y.changes.grossProfitChange>=0?"text-green-600":"text-red-600"}`,children:["$",((_t=y.changes.grossProfitChange)==null?void 0:_t.toLocaleString())||"0"]})]})]})})]})]}):e.jsx("div",{className:"text-center text-gray-500",children:"Generate a Profit & Loss statement to view data"})},G=()=>b?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(ne,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(Se,{className:"text-sm font-medium text-green-600",children:"Operating Cash Flow"})}),e.jsx(ie,{children:e.jsxs("div",{className:"text-2xl font-bold",children:["$",b.operatingActivities.netCashFlow.toLocaleString()]})})]}),e.jsxs(ne,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(Se,{className:"text-sm font-medium text-blue-600",children:"Investing Cash Flow"})}),e.jsx(ie,{children:e.jsxs("div",{className:"text-2xl font-bold",children:["$",b.investingActivities.netCashFlow.toLocaleString()]})})]}),e.jsxs(ne,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(Se,{className:"text-sm font-medium text-purple-600",children:"Financing Cash Flow"})}),e.jsx(ie,{children:e.jsxs("div",{className:"text-2xl font-bold",children:["$",b.financingActivities.netCashFlow.toLocaleString()]})})]}),e.jsxs(ne,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(Se,{className:"text-sm font-medium text-orange-600",children:"Net Cash Flow"})}),e.jsx(ie,{children:e.jsxs("div",{className:"text-2xl font-bold",children:["$",b.netCashFlow.toLocaleString()]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx($s,{className:"h-5 w-5"}),"Operating Activities"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Cash Inflows"}),e.jsxs("span",{className:"font-semibold",children:["$",b.operatingActivities.inflows.reduce((J,z)=>J+z.amount,0).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Cash Outflows"}),e.jsxs("span",{className:"font-semibold",children:["$",b.operatingActivities.outflows.reduce((J,z)=>J+z.amount,0).toLocaleString()]})]}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("div",{className:"flex justify-between font-bold",children:[e.jsx("span",{children:"Net Operating"}),e.jsxs("span",{children:["$",b.operatingActivities.netCashFlow.toLocaleString()]})]})})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(lr,{className:"h-5 w-5"}),"Investing Activities"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Cash Inflows"}),e.jsxs("span",{className:"font-semibold",children:["$",b.investingActivities.inflows.reduce((J,z)=>J+z.amount,0).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Cash Outflows"}),e.jsxs("span",{className:"font-semibold",children:["$",b.investingActivities.outflows.reduce((J,z)=>J+z.amount,0).toLocaleString()]})]}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("div",{className:"flex justify-between font-bold",children:[e.jsx("span",{children:"Net Investing"}),e.jsxs("span",{children:["$",b.investingActivities.netCashFlow.toLocaleString()]})]})})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Mr,{className:"h-5 w-5"}),"Cash Position"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Beginning Cash"}),e.jsxs("span",{className:"font-semibold",children:["$",b.beginningCash.toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Net Cash Flow"}),e.jsxs("span",{className:"font-semibold",children:["$",b.netCashFlow.toLocaleString()]})]}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("div",{className:"flex justify-between font-bold",children:[e.jsx("span",{children:"Ending Cash"}),e.jsxs("span",{children:["$",b.endingCash.toLocaleString()]})]})})]})})]})]})]}):e.jsx("div",{className:"text-center text-gray-500",children:"Generate a Cash Flow statement to view data"}),L=()=>N?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(ne,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(Se,{className:"text-sm font-medium",children:"Current Ratio"})}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:N.currentRatio.toFixed(2)}),e.jsx("div",{className:"text-sm text-gray-600",children:"Liquidity measure"})]})]}),e.jsxs(ne,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(Se,{className:"text-sm font-medium",children:"Quick Ratio"})}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:N.quickRatio.toFixed(2)}),e.jsx("div",{className:"text-sm text-gray-600",children:"Acid test ratio"})]})]}),e.jsxs(ne,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(Se,{className:"text-sm font-medium",children:"Debt to Equity"})}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:N.debtToEquityRatio.toFixed(2)}),e.jsx("div",{className:"text-sm text-gray-600",children:"Leverage ratio"})]})]}),e.jsxs(ne,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(Se,{className:"text-sm font-medium",children:"ROA"})}),e.jsxs(ie,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[N.returnOnAssets.toFixed(2),"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Return on assets"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs(ne,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(Se,{className:"text-sm font-medium",children:"ROE"})}),e.jsxs(ie,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[N.returnOnEquity.toFixed(2),"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Return on equity"})]})]}),e.jsxs(ne,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(Se,{className:"text-sm font-medium",children:"Asset Turnover"})}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:N.assetTurnover.toFixed(2)}),e.jsx("div",{className:"text-sm text-gray-600",children:"Efficiency ratio"})]})]}),e.jsxs(ne,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(Se,{className:"text-sm font-medium",children:"Gross Margin"})}),e.jsxs(ie,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[N.grossProfitMargin.toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Profitability"})]})]}),e.jsxs(ne,{children:[e.jsx(we,{className:"pb-2",children:e.jsx(Se,{className:"text-sm font-medium",children:"Net Margin"})}),e.jsxs(ie,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[N.netProfitMargin.toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Net profitability"})]})]})]})]}):e.jsx("div",{className:"text-center text-gray-500",children:"Calculate financial ratios to view data"});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Enhanced Financial Reports"}),e.jsx("p",{className:"text-gray-600",children:"Advanced financial reporting with real-time analysis and export capabilities"})]}),e.jsxs(Oe,{variant:"secondary",className:"flex items-center gap-1",children:[e.jsx(iY,{className:"h-3 w-3"}),"Phase 1.1"]})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Report Configuration"})}),e.jsx(ie,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Company"}),e.jsxs(rt,{value:n,onValueChange:a,children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsx(at,{children:i.length>0?i.map(J=>e.jsx(W,{value:J.id,children:J.name},J.id)):e.jsx(W,{value:n||zs()||"",children:"Current Company"})})]})]}),(h==="balance-sheet"||h==="ratios")&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"As of Date"}),e.jsx(ge,{type:"date",value:d,onChange:J=>u(J.target.value),placeholder:"Select date"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:h==="balance-sheet"?"Financial position at this date":"Ratios calculated as of this date"})]}),(h==="profit-loss"||h==="cash-flow")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Start Date"}),e.jsx(ge,{type:"date",value:l.startDate,onChange:J=>c(z=>({...z,startDate:J.target.value})),placeholder:"Start date"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Period start"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"End Date"}),e.jsx(ge,{type:"date",value:l.endDate,onChange:J=>c(z=>({...z,endDate:J.target.value})),placeholder:"End date"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:h==="profit-loss"?"Income & expenses period":"Cash flow period"})]})]}),h==="custom"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"As of Date"}),e.jsx(ge,{type:"date",value:d,onChange:J=>u(J.target.value),placeholder:"Select date"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Start Date"}),e.jsx(ge,{type:"date",value:l.startDate,onChange:J=>c(z=>({...z,startDate:J.target.value})),placeholder:"Start date"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"End Date"}),e.jsx(ge,{type:"date",value:l.endDate,onChange:J=>c(z=>({...z,endDate:J.target.value})),placeholder:"End date"})]})]})]})})]}),e.jsxs(an,{value:h,onValueChange:f,variant:"pills",children:[e.jsxs(on,{variant:"pills",className:"grid w-full grid-cols-5",children:[e.jsx(vt,{value:"balance-sheet",variant:"pills",icon:e.jsx(Eo,{className:"h-4 w-4"}),children:"Balance Sheet"}),e.jsx(vt,{value:"profit-loss",variant:"pills",icon:e.jsx(lr,{className:"h-4 w-4"}),children:"Profit & Loss"}),e.jsx(vt,{value:"cash-flow",variant:"pills",icon:e.jsx($s,{className:"h-4 w-4"}),children:"Cash Flow"}),e.jsx(vt,{value:"ratios",variant:"pills",icon:e.jsx(yn,{className:"h-4 w-4"}),children:"Ratios"}),e.jsx(vt,{value:"custom",variant:"pills",icon:e.jsx(en,{className:"h-4 w-4"}),children:"Custom"})]}),e.jsxs(yt,{value:"balance-sheet",className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{onClick:k,disabled:m,children:m?"Generating...":"Generate Balance Sheet"}),e.jsxs(I,{variant:"outline",onClick:()=>{v(null),k()},disabled:m,children:[e.jsx(Ts,{className:"mr-2 h-4 w-4"}),"Force Refresh"]}),e.jsx(Qy,{reportType:"balance-sheet",reportData:g,companyId:n,disabled:m})]}),V()]}),e.jsxs(yt,{value:"profit-loss",className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{onClick:F,disabled:m,children:m?"Generating...":"Generate Profit & Loss"}),e.jsxs(I,{variant:"outline",onClick:()=>{j(null),F()},disabled:m,children:[e.jsx(Ts,{className:"mr-2 h-4 w-4"}),"Force Refresh"]}),e.jsx(Qy,{reportType:"profit-loss",reportData:y,companyId:n,disabled:m})]}),M()]}),e.jsxs(yt,{value:"cash-flow",className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{onClick:A,disabled:m,children:m?"Generating...":"Generate Cash Flow"}),e.jsxs(I,{variant:"outline",onClick:()=>{w(null),A()},disabled:m,children:[e.jsx(Ts,{className:"mr-2 h-4 w-4"}),"Force Refresh"]}),e.jsx(Qy,{reportType:"cash-flow",reportData:b,companyId:n,disabled:m})]}),G()]}),e.jsxs(yt,{value:"ratios",className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{onClick:T,disabled:m,children:m?"Calculating...":"Calculate Ratios"}),e.jsx(Qy,{reportType:"ratios",reportData:N,companyId:n,disabled:m})]}),L()]}),e.jsx(yt,{value:"custom",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Custom Report Builder"})}),e.jsx(ie,{children:e.jsxs("div",{className:"text-center text-gray-500 py-8",children:[e.jsx(en,{className:"h-12 w-12 mx-auto mb-4 text-gray-400"}),e.jsx("p",{children:"Custom report builder coming soon..."}),e.jsx("p",{className:"text-sm",children:"Drag-and-drop interface for creating custom financial reports"})]})})]})})]})]})}function ose(){var As,Ht,xs,Ct,ke,gt,us;const{ready:s}=gu("accounting-page"),[t,r]=j5(),[n,a]=x.useState(null),[i,o]=x.useState(zs()),l=hi();x.useEffect(()=>{const We=()=>{const Pt=zs();Pt&&Pt!==i&&(console.log(" Accounting page - Company changed from",i,"to",Pt),o(Pt),l.invalidateQueries(),console.log(" Accounting page - React Query cache invalidated"))};window.addEventListener("storage",We);const Et=Pt=>{const rs=Pt.detail.companyId;rs&&rs!==i&&(console.log(" Accounting page - Company changed via custom event from",i,"to",rs),o(rs),l.invalidateQueries(),console.log(" Accounting page - React Query cache invalidated"))};return window.addEventListener("companyChanged",Et),()=>{window.removeEventListener("storage",We),window.removeEventListener("companyChanged",Et)}},[i,l]);const c=We=>{o(We.target.value)},d=We=>{v(We.target.value)},u=We=>{w(We.target.value),F(1)},h=We=>{C(We.target.value),F(1)},f=We=>{_(We.target.value),F(1)},[m,p]=x.useState(1),[g,v]=x.useState(""),[y,j]=x.useState("overview"),[b,w]=x.useState(()=>{const We=new Date;return We.setMonth(We.getMonth()-3),We.toISOString().slice(0,10)}),[N,C]=x.useState(()=>new Date().toISOString().slice(0,10)),[S,_]=x.useState(""),[k,F]=x.useState(1),A=x.useRef(!1),[T,V]=x.useState("comfortable"),[M,G]=x.useState(""),[L,J]=x.useState(""),[z,U]=x.useState(""),[oe,Q]=x.useState(null),[P,q]=x.useState([]),[D,se]=x.useState(!1),[he,be]=x.useState([]),[pe,Ae]=x.useState(!1),Ee=We=>{var Ns,er,Ir,jn;const Et=We.bankName||((Ns=We.connection)==null?void 0:Ns.bankName)||"Bank",Pt=We.accountNumber||We.maskedNumber||We.last4||((er=We.connection)==null?void 0:er.accountNumber)||"",rs=typeof Pt=="string"?Pt.slice(-4):String(Pt||"").slice(-4),ms=We.accountType||We.type||((Ir=We.connection)==null?void 0:Ir.accountType)||"",Bs=We.currency||((jn=We.connection)==null?void 0:jn.currency)||"",Vs=(We.id||"").slice(0,6);return[Et+(ms?` ${ms}`:""),`**** ${rs||"????"}`,Bs||void 0,Vs?`#${Vs}`:void 0].filter(Boolean).join("  ")},$e=async()=>{if(i)try{Ae(!0);const We=await de.get(`/api/bank-accounts?companyId=${encodeURIComponent(i)}`),Et=(We==null?void 0:We.items)??(We==null?void 0:We.data)??We,Pt=Array.isArray(Et)?Et:Et&&Et.accounts?Et.accounts:[];be(Pt),Pt.length&&!Pt.find(rs=>rs.id===M)&&G(""),Pt.length?ze.success(`Loaded ${Pt.length} bank account${Pt.length>1?"s":""}`):ze.error("No bank accounts found for this company")}catch(We){console.error("Failed to load accounts",We),ze.error("Failed to load bank accounts")}finally{Ae(!1)}},[O,te]=x.useState(null),[re,le]=x.useState(!0),[Z,K]=x.useState({}),[X,ce]=x.useState({}),[Y,ue]=x.useState(!1),[ve,Le]=x.useState(null),Me=async()=>{try{ue(!0);const We=new Date,Et=new Date;Et.setMonth(We.getMonth()-5);const Pt=Et.toISOString().slice(0,10),rs=We.toISOString().slice(0,10);console.log("Fetching financial analytics for period:",{start:Pt,end:rs,companyId:i});const ms=await de.get(`/api/dashboard?companyId=${encodeURIComponent(i)}&period=180`),Bs=(ms==null?void 0:ms.data)||ms||{};console.log("Dashboard API response:",Bs);const Vs=Bs.metrics||{},Ws=Bs.monthlyTrend||[];let Ns=Vs.totalRevenue||0,er=Math.abs(Vs.totalExpenses||0);Ws.length>0&&(Ns=Ws.reduce((qr,qn)=>qr+(qn.revenue||0),0),er=Ws.reduce((qr,qn)=>qr+Math.abs(qn.expenses||0),0));const Ir=Vs.netProfit||Ns-er,jn=Ns>0?Math.round(Ir/Ns*100*10)/10:0,Hs=Vs.netProfit||Ir;console.log("Calculated financial metrics:",{totalRevenue:Ns,totalExpenses:er,netIncome:Ir,profitMargin:jn,netCashFlow:Hs}),Ns>0||er>0?ze.success(`Analytics  Rev ${Ns.toLocaleString()}  Exp ${er.toLocaleString()}  Margin ${jn}%  Cash ${Hs.toLocaleString()}`):ze.warning("No financial data found for the selected period"),Le({start:Pt,end:rs,totalRevenue:Ns,totalExpenses:er,netIncome:Ir,profitMargin:jn,netCashFlow:Hs})}catch(We){console.error("Failed to compute financial analytics",We),ze.error("Failed to load financial analytics")}finally{ue(!1)}},[tt,fe]=x.useState(!1),[ct,dt]=x.useState([]),pt=async()=>{if(i){fe(!0);try{const We=await de.get(`/api/ai/insights?companyId=${encodeURIComponent(i)}`),Et=Array.isArray(We==null?void 0:We.data)?We.data:Array.isArray(We)?We:[];dt(Et),ze.success(`Loaded ${Et.length} AI insight${Et.length===1?"":"s"}`),Et.length>0&&console.info("AI Insights sample:",Et[0])}catch(We){console.error("Failed to load AI insights",We),ze.error("Failed to load AI insights")}finally{fe(!1)}}},qe=async()=>{if(!i)return;fe(!0);const We=ze.loading("Analyzing financial data with AI...",{duration:3e4});try{const Et=await de.post("/api/llama-ai/analysis/financial-insights",{companyId:i});let Pt=[];if(Et!=null&&Et.success&&(Et!=null&&Et.data)){const rs=Et.data;rs.insights&&Array.isArray(rs.insights)?Pt=rs.insights.map(ms=>({category:ms.type||"financial",insightText:ms.description||rs.message||"",priority:ms.impact==="high"?"high":ms.impact==="low"?"low":"medium",confidence:ms.confidence||rs.confidence||.8})):Pt=[{category:"financial",insightText:rs.message||"Financial analysis completed",priority:rs.intent==="urgent"?"high":"medium",confidence:rs.confidence||.8}],rs.suggestions&&Array.isArray(rs.suggestions)&&rs.suggestions.forEach(ms=>{Pt.push({category:"recommendation",insightText:ms,priority:"medium",confidence:.7})})}if(dt(Pt),ze.dismiss(We),ze.success(`Generated ${Pt.length} AI insights`),Pt.length>0)try{const rs=Pt.slice(0,5);for(const ms of rs){const Bs={companyId:i,category:ms.category,insightText:ms.insightText,priority:ms.priority};try{await de.post("/api/ai/insights",Bs)}catch(Vs){console.warn("Failed to save insight:",Vs)}}}catch(rs){console.warn("Failed to save insights:",rs)}await pt()}catch(Et){console.error("Failed to generate AI insights",Et),ze.dismiss(We),ze.error("Failed to generate AI insights")}finally{fe(!1)}};x.useEffect(()=>{let We=!1;const Et=new AbortController;return(async()=>{try{le(!0);const rs=await fetch(`${qi.api.baseUrl}/api/accounting/overview?companyId=${i}`,{signal:Et.signal,headers:{"x-tenant-id":Ii(),Authorization:`Bearer ${localStorage.getItem("auth_token")||""}`}});if(rs.ok){const ms=await rs.json();We||te(ms)}else{const ms={metrics:{assets:0,netIncome:0,journalEntries:0,balanceOk:!0},health:[{label:"AR Aging",value:0,status:"ok",description:"No data available"},{label:"AP Aging",value:0,status:"ok",description:"No data available"},{label:"Cash Runway",value:0,status:"warn",description:"No data available"}],summary:{revenue:0,expenses:0,profit:0,netIncome:0},activity:[],tasks:[{label:"No tasks",count:0,variant:"outline"}],generatedAt:new Date().toISOString()};We||te(ms)}}catch(rs){We||console.error("Error fetching overview:",rs)}finally{We||le(!1)}})(),()=>{We=!0,Et.abort()}},[i]);const{data:mt,isLoading:Rt}=nte({asOf:g||new Date().toISOString().slice(0,10),companyId:i}),{data:_e=[],isLoading:Xe}=ate({companyId:i}),{data:At}=ite({companyId:i,page:m,pageSize:10}),{data:st,isLoading:$t}=ote({companyId:i,startDate:b||new Date().toISOString().slice(0,10),endDate:N||new Date().toISOString().slice(0,10),accountId:S||void 0,page:k,pageSize:10});console.log("General Ledger Debug:",{companyId:i,glStart:b,glEnd:N,glAccountId:S,glPage:k,glLoading:$t,glData:st?{entries:((As=st==null?void 0:st.entries)==null?void 0:As.length)||0,pagination:st==null?void 0:st.pagination,hasData:!!((Ht=st==null?void 0:st.entries)!=null&&Ht.length)}:null});const fs=()=>{const We=(st==null?void 0:st.entries)||[];if(!We.length)return;const Et=["Date","Reference","Memo","Debit","Credit","Account"],Pt=We.map(Ws=>{var Ns,er,Ir;return[((Ns=Ws.date)==null?void 0:Ns.slice(0,10))||"",Ws.reference||"",Ws.description||"",String(Ws.debit??""),String(Ws.credit??""),`${((er=Ws.account)==null?void 0:er.code)||""} ${((Ir=Ws.account)==null?void 0:Ir.name)||""}`.trim()]}),rs=[Et,...Pt].map(Ws=>Ws.map(Ns=>`"${String(Ns).replace(/"/g,'""')}"`).join(",")).join(`
`),ms=new Blob([rs],{type:"text/csv"}),Bs=URL.createObjectURL(ms),Vs=document.createElement("a");Vs.href=Bs,Vs.download="general-ledger.csv",Vs.click(),URL.revokeObjectURL(Bs)},zt=x.useMemo(()=>{const We=(st==null?void 0:st.entries)||[],Et=We.reduce((rs,ms)=>rs+Number(ms.debit||0),0),Pt=We.reduce((rs,ms)=>rs+Number(ms.credit||0),0);return{d:Et,c:Pt,diff:Et-Pt}},[st]);x.useEffect(()=>{s&&a(null)},[s]);const St=id(),js=We=>{const Et=new URLSearchParams(t||"");Object.entries(We).forEach(([Pt,rs])=>{rs===void 0||rs===""?Et.delete(Pt):Et.set(Pt,String(rs))}),r(Et)};x.useEffect(()=>{i?$e():(be([]),G(""))},[i]);const et=async()=>{if(!(!i||!M)){se(!0);try{const We=new URLSearchParams({companyId:i,bankAccountId:M});L&&We.set("startDate",L),z&&We.set("endDate",z);const Et=await de.get(`/api/reconciliation/status?${We.toString()}`),Pt=(Et==null?void 0:Et.data)??Et??null;Q(Pt),Pt&&typeof Pt.matchedCount=="number"&&ze.success(`Status loaded  Matched ${Pt.matchedCount}, Unmatched ${Pt.unmatchedBankCount}`)}catch(We){console.error("Failed to load reconciliation status",We),ze.error("Failed to load reconciliation status"),Q(null)}finally{se(!1)}}},lt=async()=>{var We;if(!(!i||!M)){se(!0);try{const Et=new URLSearchParams({companyId:i,bankAccountId:M,page:"1",pageSize:"20"}),Pt=await de.get(`/api/bank-transactions?${Et.toString()}`),rs=(Pt==null?void 0:Pt.data)??Pt??{},ms=rs.items||rs.transactions||[],Bs=[];for(const Vs of ms)try{const Ws=await de.post(`/api/bank-transactions/${encodeURIComponent(Vs.id)}/find-matches?companyId=${encodeURIComponent(i)}`,{}),Ns=(Ws==null?void 0:Ws.matches)??((We=Ws==null?void 0:Ws.data)==null?void 0:We.matches)??[];for(const er of Ns)Bs.push({id:`${Vs.id}-${er.ledgerTxnId}`,bankTxnId:Vs.id,bankDate:Vs.transactionDate||Vs.date,bankAmount:Vs.amount,ledgerTxnId:er.ledgerTxnId,ledgerDate:er.ledgerDate,ledgerAmount:er.amount,score:er.score})}catch{}q(Bs),ze.success(`Found ${Bs.length} candidate${Bs.length===1?"":"s"}`)}catch(Et){console.error("Failed to load reconciliation candidates",Et),ze.error("Failed to load candidates"),q([])}finally{se(!1)}}},Fe=async(We,Et)=>{if(!(!i||!M||!We||!Et)){se(!0);try{await de.post("/api/reconciliation/match",{companyId:i,bankAccountId:M,bankTxnId:We,ledgerTxnId:Et}),ze.success("Matched successfully"),await Promise.all([et(),lt()])}catch(Pt){console.error("Match failed",Pt),ze.error("Match failed")}finally{se(!1)}}},ft=async We=>{if(!(!i||!M||!We)){se(!0);try{await de.post("/api/reconciliation/unmatch",{companyId:i,bankAccountId:M,matchId:We}),ze.success("Unmatched successfully"),await Promise.all([et(),lt()])}catch(Et){console.error("Unmatch failed",Et),ze.error("Unmatch failed")}finally{se(!1)}}},He=x.useMemo(()=>{var Pt,rs;if(O)return{assets:O.metrics.assets,netIncome:O.metrics.netIncome,entries:O.metrics.journalEntries,balanceOk:O.metrics.balanceOk};const We=(mt==null?void 0:mt.totalDebits)??0,Et=(mt==null?void 0:mt.totalCredits)??0;return{assets:Math.max(We-Et,0),netIncome:0,entries:((Pt=At==null?void 0:At.pagination)==null?void 0:Pt.totalCount)??(((rs=At==null?void 0:At.entries)==null?void 0:rs.length)||0),balanceOk:Math.round((We-Et)*100)===0}},[O,mt,At]),[Je,It]=x.useState(!1);x.useEffect(()=>{It(!0)},[]),x.useEffect(()=>{if(!Je||A.current||!t)return;const We=er=>t.get(er)||"",Et=We("cid");Et&&o(Et);const Pt=We("asOf");Pt&&v(Pt);const rs=We("tab");rs&&j(rs);const ms=We("glStart");ms&&w(ms);const Bs=We("glEnd");Bs&&C(Bs);const Vs=We("glAcc");Vs&&_(Vs);const Ws=We("glPage");Ws&&F(Number(Ws)||1);const Ns=We("journalPage");Ns&&p(Number(Ns)||1),A.current=!0},[Je,t]),x.useEffect(()=>{A.current&&js({cid:i}),typeof window<"u"&&localStorage.setItem("company_id",i)},[i]),x.useEffect(()=>{A.current&&js({asOf:g})},[g]),x.useEffect(()=>{A.current&&js({tab:y})},[y]),x.useEffect(()=>{A.current&&js({glStart:b})},[b]),x.useEffect(()=>{A.current&&js({glEnd:N})},[N]),x.useEffect(()=>{A.current&&js({glAcc:S})},[S]),x.useEffect(()=>{A.current&&js({glPage:k})},[k]),x.useEffect(()=>{A.current&&js({journalPage:m})},[m]);const Gt=async We=>{K(Et=>({...Et,[We]:!0}));try{const Et=new Date().toISOString().split("T")[0];let Pt="";switch(We){case"balance-sheet":Pt=`/api/enhanced-financial-reports/balance-sheet?companyId=${i}&asOfDate=${Et}`;break;case"profit-loss":const ms=new Date;ms.setMonth(ms.getMonth()-1),Pt=`/api/enhanced-financial-reports/profit-loss?companyId=${i}&startDate=${ms.toISOString().split("T")[0]}&endDate=${Et}`;break;case"cash-flow":const Bs=new Date;Bs.setMonth(Bs.getMonth()-1),Pt=`/api/enhanced-financial-reports/cash-flow?companyId=${i}&startDate=${Bs.toISOString().split("T")[0]}&endDate=${Et}`;break}const rs=await de.get(Pt);ce(ms=>({...ms,[We]:(rs==null?void 0:rs.data)||rs})),ze.success(`${We.replace("-"," ").replace(/\b\w/g,ms=>ms.toUpperCase())} generated successfully!`),setTimeout(()=>{const ms=document.getElementById("generated-reports-section");ms&&ms.scrollIntoView({behavior:"smooth"})},100)}catch(Et){console.error(`Error generating ${We}:`,Et),ze.error(`Failed to generate ${We.replace("-"," ")}`)}finally{K(Et=>({...Et,[We]:!1}))}};if(!Je)return e.jsx(Kr,{children:e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading"})})})})});const qt=Rt||Xe||$t||re;return qt?e.jsx(Kr,{children:e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(On,{className:"mx-auto h-8 w-8 animate-spin text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading accounting overview..."})]})})})}):n?e.jsx(Kr,{children:e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-600 mb-4",children:"Failed to load accounting data"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:n||"Unknown error"}),e.jsx(I,{onClick:()=>window.location.reload(),variant:"outline",children:"Try Again"})]})})})}):e.jsx(Kr,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Financial Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Comprehensive accounting tools and financial insights for your business"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(I,{variant:"outline",onClick:()=>St("/reports"),children:[e.jsx(An,{className:"mr-2 h-4 w-4"}),"Export Report"]}),e.jsxs(I,{onClick:()=>St("/dashboard/journal/new"),children:[e.jsx(Ss,{className:"mr-2 h-4 w-4"}),"New Entry"]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 -mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Company"}),e.jsx("input",{className:"h-8 w-48 border rounded px-2 text-sm",value:i,onChange:c,placeholder:"Enter company ID (e.g., seed-company-1)"},"company-id-input")]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Date"}),e.jsxs("div",{className:"inline-flex rounded-md border overflow-hidden",children:[e.jsx("button",{className:"px-2 py-1 text-xs hover:bg-muted",onClick:()=>v(new Date().toISOString().slice(0,10)),children:"Today"}),e.jsx("button",{className:"px-2 py-1 text-xs hover:bg-muted",onClick:()=>v(new Date(Date.now()-7*24*60*60*1e3).toISOString().slice(0,10)),children:"7D"}),e.jsx("button",{className:"px-2 py-1 text-xs hover:bg-muted",onClick:()=>v(new Date(Date.now()-30*24*60*60*1e3).toISOString().slice(0,10)),children:"30D"})]}),e.jsx("input",{type:"date",className:"h-8 w-40 border rounded px-2 text-sm",placeholder:"YYYY-MM-DD",value:g,onChange:d},"as-of-input")]})]}),e.jsxs(an,{value:y,onValueChange:j,className:"space-y-6",children:[e.jsxs(on,{className:"grid w-full grid-cols-6",children:[e.jsx(vt,{value:"overview",children:"Overview"}),e.jsx(vt,{value:"chart-of-accounts",children:"Chart of Accounts"}),e.jsx(vt,{value:"journal-entries",children:"Journal Entries"}),e.jsx(vt,{value:"reports",children:"Financial Reports"}),e.jsx(vt,{value:"reconciliation",children:"Reconciliation"}),e.jsx(vt,{value:"analytics",children:"Analytics"})]}),e.jsxs(yt,{value:"overview",className:"space-y-6",children:[e.jsx(ne,{children:e.jsx(ie,{className:"py-4",children:e.jsxs("div",{className:"grid md:grid-cols-4 gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Company"}),e.jsx("input",{className:"mt-1 w-full border rounded px-3 py-2",value:i,onChange:c,placeholder:"Enter company ID (e.g., seed-company-1)"},"company-id-input-2")]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"As of (YYYY-MM-DD)"}),e.jsx("input",{type:"date",className:"mt-1 w-full border rounded px-3 py-2",value:g,onChange:d,placeholder:"YYYY-MM-DD"},"as-of-input-2")]}),e.jsx("div",{className:"flex items-end",children:e.jsx(I,{variant:"outline",onClick:()=>p(1),disabled:qt,children:"Apply"})})]})})}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Quick Stats"}),e.jsx(Vt,{children:"Overview from trial balance"})]}),e.jsxs(ie,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Assets"}),e.jsx("span",{className:"text-base font-semibold text-foreground",children:He.assets.toLocaleString()})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Entries"}),e.jsx("span",{className:"text-base font-semibold text-foreground",children:He.entries})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Balanced"}),e.jsx("span",{className:He.balanceOk?"text-green-600 font-medium":"text-red-600 font-medium",children:He.balanceOk?"Yes":"No"})]})]})]}),e.jsxs(ne,{className:"md:col-span-2",children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Trial Balance"}),e.jsx(Vt,{children:"Debits and credits summary"})]}),e.jsx(ie,{children:mt?e.jsxs("div",{className:"grid grid-cols-3 gap-3 text-sm",children:[e.jsxs("div",{className:"p-3 rounded-md border bg-muted/30",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Debits"}),e.jsx("div",{className:"text-lg font-semibold",children:mt.totalDebits.toLocaleString()})]}),e.jsxs("div",{className:"p-3 rounded-md border bg-muted/30",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Credits"}),e.jsx("div",{className:"text-lg font-semibold",children:mt.totalCredits.toLocaleString()})]}),e.jsxs("div",{className:"p-3 rounded-md border bg-muted/30",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Difference"}),e.jsx("div",{className:`text-lg font-semibold ${mt.totalDebits-mt.totalCredits===0?"text-green-600":"text-amber-600"}`,children:(mt.totalDebits-mt.totalCredits).toFixed(2)})]})]}):e.jsx("div",{className:"text-sm text-muted-foreground",children:"No trial balance data"})})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Recent Journal Entries"})}),e.jsxs(ie,{children:[(xs=At==null?void 0:At.entries)!=null&&xs.length?e.jsx("ul",{className:"text-sm space-y-2",children:(At.entries||[]).slice(0,5).map(We=>{var Et,Pt;return e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{children:((Et=We.date)==null?void 0:Et.slice(0,10))||""}),e.jsxs("span",{children:[((Pt=We.lines)==null?void 0:Pt.length)||0," lines"]})]},We.id)})}):e.jsx("div",{className:"text-sm text-muted-foreground",children:"No entries"}),e.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[e.jsx(I,{variant:"outline",size:"sm",disabled:m<=1||qt,onClick:()=>p(We=>Math.max(1,We-1)),children:"Prev"}),e.jsx(I,{variant:"outline",size:"sm",disabled:qt||(((Ct=At==null?void 0:At.entries)==null?void 0:Ct.length)??0)<10,onClick:()=>p(We=>We+1),children:"Next"})]})]})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Accounts"})}),e.jsx(ie,{children:_e!=null&&_e.length?e.jsx("ul",{className:"text-sm max-h-48 overflow-auto space-y-1",children:_e.slice(0,10).map(We=>e.jsxs("li",{className:"flex justify-between",children:[e.jsxs("button",{className:"text-left hover:underline",onClick:()=>{_(We.id),j("journal-entries")},children:[We.code," ",We.name]}),e.jsx("span",{className:"text-muted-foreground",children:We.isActive===!1?"Inactive":""})]},We.id))}):e.jsx("div",{className:"text-sm text-muted-foreground",children:"No accounts"})})]})]})]}),e.jsx(yt,{value:"chart-of-accounts",className:"space-y-6",children:e.jsx(ne,{children:e.jsx(ie,{className:"py-4",children:e.jsx(sse,{})})})}),e.jsx(yt,{value:"journal-entries",className:"space-y-6",children:e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"General Ledger"}),e.jsx(Vt,{children:"Filter by date range and account; click accounts to deep-link"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Density"}),e.jsxs("div",{className:"inline-flex rounded-md border",children:[e.jsx("button",{className:`px-2 py-1 text-xs ${T==="comfortable"?"bg-muted":""}`,onClick:()=>V("comfortable"),children:"Comfortable"}),e.jsx("button",{className:`px-2 py-1 text-xs ${T==="compact"?"bg-muted":""}`,onClick:()=>V("compact"),children:"Compact"})]})]})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:"grid md:grid-cols-5 gap-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Start Date"}),e.jsx("input",{type:"date",className:"mt-1 w-full border rounded px-3 py-2",value:b,onChange:u,placeholder:"YYYY-MM-DD"},"gl-start-input")]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"End Date"}),e.jsx("input",{type:"date",className:"mt-1 w-full border rounded px-3 py-2",value:N,onChange:h,placeholder:"YYYY-MM-DD"},"gl-end-input")]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Account"}),e.jsxs("select",{className:"mt-1 w-full border rounded px-3 py-2",value:S,onChange:f,children:[e.jsx("option",{value:"",children:"All Accounts"}),(_e||[]).map(We=>e.jsxs("option",{value:We.id,children:[We.code," ",We.name]},We.id))]},"gl-account-select")]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{const We=new Date,Et=new Date;Et.setDate(We.getDate()-7),w(Et.toISOString().slice(0,10)),C(We.toISOString().slice(0,10)),F(1)},children:"7D"}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{const We=new Date,Et=new Date;Et.setMonth(We.getMonth()-1),w(Et.toISOString().slice(0,10)),C(We.toISOString().slice(0,10)),F(1)},children:"1M"}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{const We=new Date,Et=new Date;Et.setFullYear(We.getFullYear()-1),w(Et.toISOString().slice(0,10)),C(We.toISOString().slice(0,10)),F(1)},children:"1Y"})]}),e.jsx(I,{variant:"outline",onClick:()=>F(1),children:"Apply"})]})]}),(ke=st==null?void 0:st.entries)!=null&&ke.length?e.jsxs("div",{className:"overflow-auto max-h-[60vh] border rounded-md",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-muted sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2",children:"Date"}),e.jsx("th",{className:"text-left p-2",children:"Reference"}),e.jsx("th",{className:"text-left p-2",children:"Memo"}),e.jsx("th",{className:"text-right p-2",children:"Debit"}),e.jsx("th",{className:"text-right p-2",children:"Credit"}),e.jsx("th",{className:"text-left p-2",children:"Account"})]})}),e.jsx("tbody",{children:(st.entries||[]).map(We=>{var Et;return e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:T==="compact"?"px-2 py-1":"p-2",children:((Et=We.date)==null?void 0:Et.slice(0,10))||""}),e.jsx("td",{className:T==="compact"?"px-2 py-1":"p-2",children:We.reference||""}),e.jsx("td",{className:T==="compact"?"px-2 py-1":"p-2",children:We.description||""}),e.jsx("td",{className:`${T==="compact"?"px-2 py-1":"p-2"} text-right`,children:We.debit}),e.jsx("td",{className:`${T==="compact"?"px-2 py-1":"p-2"} text-right`,children:We.credit}),e.jsxs("td",{className:T==="compact"?"px-2 py-1":"p-2",children:[We.accountCode," ",We.accountName]})]},We.id)})})]}),e.jsx("div",{className:"sticky bottom-0 bg-background/95 backdrop-blur border-t",children:e.jsxs("div",{className:"flex items-center justify-between gap-2 p-2",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs",children:[e.jsxs("span",{className:"px-2 py-1 rounded bg-slate-100",children:["Debit: ",zt.d.toFixed(2)]}),e.jsxs("span",{className:"px-2 py-1 rounded bg-slate-100",children:["Credit: ",zt.c.toFixed(2)]}),e.jsxs("span",{className:"px-2 py-1 rounded bg-slate-100",children:["Diff: ",zt.diff.toFixed(2)]}),typeof(st==null?void 0:st.runningBalance)=="number"&&e.jsxs("span",{className:"px-2 py-1 rounded bg-slate-100",children:["Running Balance: ",Number(st.runningBalance).toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{variant:"outline",size:"sm",onClick:fs,children:"Export CSV"}),e.jsx(I,{variant:"outline",size:"sm",disabled:((gt=st==null?void 0:st.pagination)==null?void 0:gt.hasPrev)===!1,onClick:()=>F(We=>Math.max(1,We-1)),children:"Prev"}),e.jsx(I,{variant:"outline",size:"sm",disabled:((us=st==null?void 0:st.pagination)==null?void 0:us.hasNext)===!1,onClick:()=>F(We=>We+1),children:"Next"})]})]})})]}):e.jsxs("div",{className:"text-sm text-muted-foreground flex flex-col items-center justify-center gap-2 py-8",children:[e.jsx(Zt,{className:"h-12 w-12 text-gray-300"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No ledger entries found"}),e.jsx("p",{className:"text-sm mb-4 text-center max-w-md",children:"There are no journal entries with lines for the selected criteria. This could mean:"}),e.jsxs("ul",{className:"text-sm text-left max-w-md mb-4 space-y-1",children:[e.jsx("li",{children:" No journal entries exist for this date range"}),e.jsx("li",{children:" Journal entries exist but have no lines"}),e.jsx("li",{children:" Entries are in a different status (not POSTED or DRAFT)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{_(""),w(""),C(""),F(1)},children:"Reset Filters"}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{const We=new Date;We.setFullYear(We.getFullYear()-2),w(We.toISOString().slice(0,10)),C(new Date().toISOString().slice(0,10)),_(""),F(1)},children:"Show All Entries"}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>j("overview"),children:"Go to Overview"})]})]})]})]})}),e.jsxs(yt,{value:"reports",className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Income Statement"}),e.jsx(Vt,{children:"Profit and loss report"})]}),e.jsx(ie,{children:e.jsx("div",{className:"text-center py-4",children:e.jsx(I,{variant:"outline",className:"w-full",onClick:()=>Gt("profit-loss"),disabled:Z["profit-loss"],children:Z["profit-loss"]?e.jsxs(e.Fragment,{children:[e.jsx(On,{className:"w-4 h-4 mr-2 animate-spin"}),"Generating..."]}):"Generate Report"})})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Balance Sheet"}),e.jsx(Vt,{children:"Assets, liabilities, and equity"})]}),e.jsx(ie,{children:e.jsx("div",{className:"text-center py-4",children:e.jsx(I,{variant:"outline",className:"w-full",onClick:()=>Gt("balance-sheet"),disabled:Z["balance-sheet"],children:Z["balance-sheet"]?e.jsxs(e.Fragment,{children:[e.jsx(On,{className:"w-4 h-4 mr-2 animate-spin"}),"Generating..."]}):"Generate Report"})})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Cash Flow"}),e.jsx(Vt,{children:"Cash flow statement"})]}),e.jsx(ie,{children:e.jsx("div",{className:"text-center py-4",children:e.jsx(I,{variant:"outline",className:"w-full",onClick:()=>Gt("cash-flow"),disabled:Z["cash-flow"],children:Z["cash-flow"]?e.jsxs(e.Fragment,{children:[e.jsx(On,{className:"w-4 h-4 mr-2 animate-spin"}),"Generating..."]}):"Generate Report"})})})]})]}),(X["profit-loss"]||X["balance-sheet"]||X["cash-flow"])&&e.jsx("div",{id:"generated-reports-section",className:"mt-8",children:e.jsx(l1,{selectedCompany:i,defaultReportType:X["profit-loss"]?"profit-loss":X["balance-sheet"]?"balance-sheet":X["cash-flow"]?"cash-flow":"profit-loss",initialData:X})})]}),e.jsx(yt,{value:"reconciliation",className:"space-y-6",children:e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Bank Reconciliation"}),e.jsx(Vt,{children:"Match your records with bank statements"})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:"grid md:grid-cols-4 gap-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Company"}),e.jsx("input",{className:"mt-1 w-full border rounded px-3 py-2",value:i,onChange:We=>o(We.target.value),placeholder:"Enter company ID"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Bank Account ID"}),e.jsxs("select",{className:"mt-1 w-full border rounded px-3 py-2 text-sm disabled:opacity-50",value:M,onChange:We=>G(We.target.value),disabled:pe,children:[e.jsx("option",{value:"",children:pe?"Loading accounts":"Select account"}),he.map(We=>e.jsx("option",{value:We.id,children:Ee(We)},We.id))]}),!he.length&&!pe&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["No accounts found. ",e.jsx("button",{className:"underline",onClick:$e,children:"Reload accounts"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Start Date"}),e.jsx("div",{className:"flex gap-2",children:e.jsx("input",{type:"date",className:"mt-1 w-full border rounded px-3 py-2",placeholder:"YYYY-MM-DD",value:L,onChange:We=>J(We.target.value)})}),e.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{const We=new Date;We.setDate(We.getDate()-7),J(We.toISOString().slice(0,10))},children:"7D"}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{const We=new Date;We.setDate(We.getDate()-30),J(We.toISOString().slice(0,10))},children:"30D"}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{const We=new Date;We.setDate(1),J(We.toISOString().slice(0,10))},children:"This Mo"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"End Date"}),e.jsx("input",{type:"date",className:"mt-1 w-full border rounded px-3 py-2",placeholder:"YYYY-MM-DD",value:z,onChange:We=>U(We.target.value)}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:e.jsx(I,{variant:"outline",size:"sm",onClick:()=>U(new Date().toISOString().slice(0,10)),children:"Today"})})]})]}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx(I,{variant:"outline",onClick:$e,disabled:!i||pe,children:pe?"Loading Accounts...":"Reload Accounts"}),e.jsx(I,{variant:"outline",onClick:et,disabled:!i||!M||D,children:"Load Status"}),e.jsx(I,{onClick:lt,disabled:!i||!M||D,children:"Find Candidates"}),e.jsx(I,{onClick:async()=>{if(!(!i||!M)){se(!0);try{await Promise.all([et(),lt()])}finally{se(!1)}}},disabled:!i||!M||D,children:"Start Reconciliation"})]}),oe&&e.jsxs("div",{className:"grid md:grid-cols-3 gap-3 mb-4",children:[e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Matched"}),e.jsx("div",{className:"text-lg font-semibold",children:oe.matchedCount??oe.matched??0})]}),e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Unmatched Bank"}),e.jsx("div",{className:"text-lg font-semibold",children:oe.unmatchedBankCount??oe.unmatchedBank??0})]}),e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Unmatched Ledger"}),e.jsx("div",{className:"text-lg font-semibold",children:oe.unmatchedLedgerCount??oe.unmatchedLedger??0})]})]}),e.jsxs("div",{className:"border rounded",children:[e.jsx("div",{className:"p-2 border-b text-sm font-medium",children:"Match Candidates"}),P.length?e.jsx("div",{className:"max-h-[60vh] overflow-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-muted sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left p-2",children:"Bank Date"}),e.jsx("th",{className:"text-left p-2",children:"Bank Amount"}),e.jsx("th",{className:"text-left p-2",children:"Ledger Date"}),e.jsx("th",{className:"text-left p-2",children:"Ledger Amount"}),e.jsx("th",{className:"text-left p-2",children:"Similarity"}),e.jsx("th",{className:"text-right p-2",children:"Action"})]})}),e.jsx("tbody",{children:P.map(We=>{var Et,Pt,rs,ms;return e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"p-2",children:We.bankDate||((Et=We.bankTxn)==null?void 0:Et.date)||""}),e.jsx("td",{className:"p-2",children:We.bankAmount??((Pt=We.bankTxn)==null?void 0:Pt.amount)??""}),e.jsx("td",{className:"p-2",children:We.ledgerDate||((rs=We.ledgerTxn)==null?void 0:rs.date)||""}),e.jsx("td",{className:"p-2",children:We.ledgerAmount??((ms=We.ledgerTxn)==null?void 0:ms.amount)??""}),e.jsxs("td",{className:"p-2",children:[Math.round((We.score??We.similarity??0)*100),"%"]}),e.jsx("td",{className:"p-2 text-right",children:We.matchId?e.jsx(I,{size:"sm",variant:"outline",onClick:()=>ft(We.matchId),disabled:D,children:"Unmatch"}):e.jsx(I,{size:"sm",onClick:()=>{var Bs,Vs;return Fe(We.bankTxnId||((Bs=We.bankTxn)==null?void 0:Bs.id),We.ledgerTxnId||((Vs=We.ledgerTxn)==null?void 0:Vs.id))},disabled:D,children:"Match"})})]},We.id||`${We.bankTxnId}-${We.ledgerTxnId}`)})})]})}):e.jsx("div",{className:"text-sm text-muted-foreground p-4",children:"No candidates loaded"})]})]})]})}),e.jsx(yt,{value:"analytics",className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Financial Analytics"}),e.jsx(Vt,{children:"Advanced financial insights and trends"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Eo,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"Analytics Dashboard"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"View detailed financial analytics"}),e.jsxs(I,{onClick:Me,disabled:Y,children:[e.jsx(ir,{className:"mr-2 h-4 w-4"}),Y?"Computing":"Run Analytics"]}),ve&&e.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-6 text-left max-w-xl mx-auto",children:[e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Period"}),e.jsxs("div",{className:"text-sm font-medium",children:[ve.start,"  ",ve.end]})]}),e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Revenue"}),e.jsx("div",{className:"text-sm font-medium",children:ve.totalRevenue.toLocaleString()})]}),e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Expenses"}),e.jsx("div",{className:"text-sm font-medium",children:ve.totalExpenses.toLocaleString()})]}),e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Net Income"}),e.jsx("div",{className:"text-sm font-medium",children:ve.netIncome.toLocaleString()})]}),e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Profit Margin"}),e.jsxs("div",{className:"text-sm font-medium",children:[ve.profitMargin,"%"]})]}),e.jsxs("div",{className:"p-3 border rounded",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Net Cash Flow"}),e.jsx("div",{className:`text-sm font-medium ${ve.netCashFlow>=0?"text-green-600":"text-red-600"}`,children:ve.netCashFlow.toLocaleString()})]})]})]})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"AI Insights"}),e.jsx(Vt,{children:"Intelligent financial recommendations"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(sa,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"AI-Powered Insights"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Get intelligent financial recommendations"}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(I,{variant:"outline",onClick:pt,disabled:tt,children:tt?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-gray-300 border-t-gray-600"}),"Loading..."]}):"Load Insights"}),e.jsx(I,{onClick:qe,disabled:tt,children:tt?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-white border-t-gray-400"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(or,{className:"mr-2 h-4 w-4"}),"Generate"]})})]}),tt&&e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("div",{className:"inline-flex items-center px-4 py-2 bg-blue-50 text-blue-700 rounded-lg",children:[e.jsx("div",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-blue-300 border-t-blue-600"}),"AI is analyzing your financial data..."]})}),ct!=null&&ct.length?e.jsx("div",{className:"mt-6 text-left max-w-2xl mx-auto border rounded divide-y",children:ct.slice(0,5).map((We,Et)=>{const Pt={...We},rs=(Pt.category||Pt.type||"financial").toString().replace(/_/g," ").replace(/\b\w/g,Ir=>Ir.toUpperCase()),ms=(Pt.priority||Pt.impact||"medium").toString(),Bs=typeof Pt.confidence=="number"?Math.round(Pt.confidence*100):void 0;let Vs=Pt.insightText||Pt.description||Pt.text||Pt.summary||"";if(typeof Vs!="string")try{Vs=JSON.stringify(Vs)}catch{Vs=String(Vs)}if(Vs&&Vs.trim().startsWith("{"))try{const Ir=JSON.parse(Vs);Vs=Ir.description||Ir.summary||Object.values(Ir).join("  ")}catch{}const Ws=(Vs||"").toString().slice(0,240),Ns=Pt.generatedAt?new Date(Pt.generatedAt).toLocaleString():"Just generated",er=ms==="high"?"text-red-600 bg-red-50 border-red-200":ms==="low"?"text-muted-foreground bg-gray-50 border-gray-200":"text-amber-600 bg-amber-50 border-amber-200";return e.jsxs("div",{className:"p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:rs}),e.jsx("div",{className:`text-xs px-2 py-1 rounded-full border ${er}`,children:ms})]}),e.jsx("div",{className:"text-sm text-gray-700 mb-2 leading-relaxed",children:Ws}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[Bs!==void 0?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:"Confidence:"}),e.jsxs("span",{className:"font-medium",children:[Bs,"%"]})]}):e.jsx("span",{}),e.jsx("div",{children:Ns})]})]},Pt.id||Et)})}):e.jsxs("div",{className:"mt-6 text-center py-8 text-gray-500",children:[e.jsx(sa,{className:"mx-auto h-8 w-8 text-gray-300 mb-2"}),e.jsx("p",{children:"No AI insights available yet"}),e.jsx("p",{className:"text-sm",children:'Click "Generate" to analyze your financial data'})]})]})})]})]})})]})]})})}function g7({invoiceId:s,amount:t,currency:r,customerEmail:n,customerName:a,description:i,variant:o="default",size:l="default",showAmount:c=!0,onPaymentSuccess:d,onPaymentError:u}){const[h,f]=x.useState(!1),[m,p]=x.useState(null),[g,v]=x.useState(!1),[y,j]=x.useState(null),b=(k,F)=>new Intl.NumberFormat("en-US",{style:"currency",currency:F}).format(k),w=async()=>{try{f(!0),j(null);const k=await de.createPaymentLink(s,{customerEmail:n,customerName:a,description:i||`Payment for Invoice ${s}`,expiresInMinutes:1440});p(k.url),v(!0)}catch(k){console.error("Error creating payment link:",k);const F="Failed to create payment link";j(F),u==null||u(F)}finally{f(!1)}},N=()=>{m&&window.open(m,"_blank")},C=async()=>{if(m)try{await navigator.clipboard.writeText(m)}catch(k){console.error("Failed to copy link:",k)}},S=()=>h?"Creating Payment...":c?`Pay ${b(t,r)}`:"Pay Now",_=()=>h?e.jsx(Ts,{className:"w-4 h-4 animate-spin"}):e.jsx($a,{className:"w-4 h-4"});return e.jsxs(e.Fragment,{children:[e.jsxs(I,{onClick:w,disabled:h,variant:o,size:l,className:"min-w-[120px]",children:[_(),e.jsx("span",{className:"ml-2",children:S()})]}),e.jsx(ts,{open:g,onOpenChange:v,children:e.jsxs(ss,{className:"max-w-md",children:[e.jsx(as,{children:e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx($a,{className:"w-5 h-5"}),"Secure Payment"]})}),e.jsx("div",{className:"space-y-4",children:y?e.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[e.jsx(Ln,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Payment Error"})]}),e.jsx("p",{className:"text-red-700 mt-1",children:y})]}):m?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(bs,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"font-medium text-green-800",children:"Payment Link Ready"})]}),e.jsx("p",{className:"text-green-700 text-sm",children:"Click below to complete your payment securely."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Amount Due"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:b(t,r)})]}),e.jsx(Oe,{variant:"outline",className:"text-green-600 border-green-600",children:"Secure Payment"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(I,{onClick:N,className:"w-full",size:"lg",children:[e.jsx(Nm,{className:"w-4 h-4 mr-2"}),"Pay Now - ",b(t,r)]}),e.jsxs(I,{onClick:C,variant:"outline",className:"w-full",children:[e.jsx(ac,{className:"w-4 h-4 mr-2"}),"Copy Payment Link"]})]}),e.jsx("div",{className:"text-xs text-gray-500 text-center",children:"Payment link expires in 24 hours"})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ts,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-gray-400"}),e.jsx("p",{className:"text-gray-600",children:"Creating secure payment link..."})]})})]})})]})}function v7({invoiceId:s,amount:t,currency:r,customerEmail:n,customerName:a,description:i,onPaymentSuccess:o,onPaymentError:l}){return e.jsx(g7,{invoiceId:s,amount:t,currency:r,customerEmail:n,customerName:a,description:i,variant:"outline",size:"sm",showAmount:!1,onPaymentSuccess:o,onPaymentError:l})}function rP({invoiceId:s,amount:t,currency:r,customerEmail:n,customerName:a,description:i,onPaymentSuccess:o,onPaymentError:l}){return e.jsx(g7,{invoiceId:s,amount:t,currency:r,customerEmail:n,customerName:a,description:i,variant:"default",size:"lg",showAmount:!0,onPaymentSuccess:o,onPaymentError:l})}var hx={},lse=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},y7={},Oc={};let Q5;const cse=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];Oc.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17};Oc.getSymbolTotalCodewords=function(t){return cse[t]};Oc.getBCHDigit=function(s){let t=0;for(;s!==0;)t++,s>>>=1;return t};Oc.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');Q5=t};Oc.isKanjiModeEnabled=function(){return typeof Q5<"u"};Oc.toSJIS=function(t){return Q5(t)};var uN={};(function(s){s.L={bit:1},s.M={bit:0},s.Q={bit:3},s.H={bit:2};function t(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return s.L;case"m":case"medium":return s.M;case"q":case"quartile":return s.Q;case"h":case"high":return s.H;default:throw new Error("Unknown EC Level: "+r)}}s.isValid=function(n){return n&&typeof n.bit<"u"&&n.bit>=0&&n.bit<4},s.from=function(n,a){if(s.isValid(n))return n;try{return t(n)}catch{return a}}})(uN);function j7(){this.buffer=[],this.length=0}j7.prototype={get:function(s){const t=Math.floor(s/8);return(this.buffer[t]>>>7-s%8&1)===1},put:function(s,t){for(let r=0;r<t;r++)this.putBit((s>>>t-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(s){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),s&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var dse=j7;function iy(s){if(!s||s<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=s,this.data=new Uint8Array(s*s),this.reservedBit=new Uint8Array(s*s)}iy.prototype.set=function(s,t,r,n){const a=s*this.size+t;this.data[a]=r,n&&(this.reservedBit[a]=!0)};iy.prototype.get=function(s,t){return this.data[s*this.size+t]};iy.prototype.xor=function(s,t,r){this.data[s*this.size+t]^=r};iy.prototype.isReserved=function(s,t){return this.reservedBit[s*this.size+t]};var use=iy,b7={};(function(s){const t=Oc.getSymbolSize;s.getRowColCoords=function(n){if(n===1)return[];const a=Math.floor(n/7)+2,i=t(n),o=i===145?26:Math.ceil((i-13)/(2*a-2))*2,l=[i-7];for(let c=1;c<a-1;c++)l[c]=l[c-1]-o;return l.push(6),l.reverse()},s.getPositions=function(n){const a=[],i=s.getRowColCoords(n),o=i.length;for(let l=0;l<o;l++)for(let c=0;c<o;c++)l===0&&c===0||l===0&&c===o-1||l===o-1&&c===0||a.push([i[l],i[c]]);return a}})(b7);var N7={};const hse=Oc.getSymbolSize,nP=7;N7.getPositions=function(t){const r=hse(t);return[[0,0],[r-nP,0],[0,r-nP]]};var w7={};(function(s){s.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};s.isValid=function(a){return a!=null&&a!==""&&!isNaN(a)&&a>=0&&a<=7},s.from=function(a){return s.isValid(a)?parseInt(a,10):void 0},s.getPenaltyN1=function(a){const i=a.size;let o=0,l=0,c=0,d=null,u=null;for(let h=0;h<i;h++){l=c=0,d=u=null;for(let f=0;f<i;f++){let m=a.get(h,f);m===d?l++:(l>=5&&(o+=t.N1+(l-5)),d=m,l=1),m=a.get(f,h),m===u?c++:(c>=5&&(o+=t.N1+(c-5)),u=m,c=1)}l>=5&&(o+=t.N1+(l-5)),c>=5&&(o+=t.N1+(c-5))}return o},s.getPenaltyN2=function(a){const i=a.size;let o=0;for(let l=0;l<i-1;l++)for(let c=0;c<i-1;c++){const d=a.get(l,c)+a.get(l,c+1)+a.get(l+1,c)+a.get(l+1,c+1);(d===4||d===0)&&o++}return o*t.N2},s.getPenaltyN3=function(a){const i=a.size;let o=0,l=0,c=0;for(let d=0;d<i;d++){l=c=0;for(let u=0;u<i;u++)l=l<<1&2047|a.get(d,u),u>=10&&(l===1488||l===93)&&o++,c=c<<1&2047|a.get(u,d),u>=10&&(c===1488||c===93)&&o++}return o*t.N3},s.getPenaltyN4=function(a){let i=0;const o=a.data.length;for(let c=0;c<o;c++)i+=a.data[c];return Math.abs(Math.ceil(i*100/o/5)-10)*t.N4};function r(n,a,i){switch(n){case s.Patterns.PATTERN000:return(a+i)%2===0;case s.Patterns.PATTERN001:return a%2===0;case s.Patterns.PATTERN010:return i%3===0;case s.Patterns.PATTERN011:return(a+i)%3===0;case s.Patterns.PATTERN100:return(Math.floor(a/2)+Math.floor(i/3))%2===0;case s.Patterns.PATTERN101:return a*i%2+a*i%3===0;case s.Patterns.PATTERN110:return(a*i%2+a*i%3)%2===0;case s.Patterns.PATTERN111:return(a*i%3+(a+i)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}s.applyMask=function(a,i){const o=i.size;for(let l=0;l<o;l++)for(let c=0;c<o;c++)i.isReserved(c,l)||i.xor(c,l,r(a,c,l))},s.getBestMask=function(a,i){const o=Object.keys(s.Patterns).length;let l=0,c=1/0;for(let d=0;d<o;d++){i(d),s.applyMask(d,a);const u=s.getPenaltyN1(a)+s.getPenaltyN2(a)+s.getPenaltyN3(a)+s.getPenaltyN4(a);s.applyMask(d,a),u<c&&(c=u,l=d)}return l}})(w7);var hN={};const mm=uN,Zy=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],ej=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];hN.getBlocksCount=function(t,r){switch(r){case mm.L:return Zy[(t-1)*4+0];case mm.M:return Zy[(t-1)*4+1];case mm.Q:return Zy[(t-1)*4+2];case mm.H:return Zy[(t-1)*4+3];default:return}};hN.getTotalCodewordsCount=function(t,r){switch(r){case mm.L:return ej[(t-1)*4+0];case mm.M:return ej[(t-1)*4+1];case mm.Q:return ej[(t-1)*4+2];case mm.H:return ej[(t-1)*4+3];default:return}};var S7={},mN={};const k0=new Uint8Array(512),c1=new Uint8Array(256);(function(){let t=1;for(let r=0;r<255;r++)k0[r]=t,c1[t]=r,t<<=1,t&256&&(t^=285);for(let r=255;r<512;r++)k0[r]=k0[r-255]})();mN.log=function(t){if(t<1)throw new Error("log("+t+")");return c1[t]};mN.exp=function(t){return k0[t]};mN.mul=function(t,r){return t===0||r===0?0:k0[c1[t]+c1[r]]};(function(s){const t=mN;s.mul=function(n,a){const i=new Uint8Array(n.length+a.length-1);for(let o=0;o<n.length;o++)for(let l=0;l<a.length;l++)i[o+l]^=t.mul(n[o],a[l]);return i},s.mod=function(n,a){let i=new Uint8Array(n);for(;i.length-a.length>=0;){const o=i[0];for(let c=0;c<a.length;c++)i[c]^=t.mul(a[c],o);let l=0;for(;l<i.length&&i[l]===0;)l++;i=i.slice(l)}return i},s.generateECPolynomial=function(n){let a=new Uint8Array([1]);for(let i=0;i<n;i++)a=s.mul(a,new Uint8Array([1,t.exp(i)]));return a}})(S7);const C7=S7;function Z5(s){this.genPoly=void 0,this.degree=s,this.degree&&this.initialize(this.degree)}Z5.prototype.initialize=function(t){this.degree=t,this.genPoly=C7.generateECPolynomial(this.degree)};Z5.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(t.length+this.degree);r.set(t);const n=C7.mod(r,this.genPoly),a=this.degree-n.length;if(a>0){const i=new Uint8Array(this.degree);return i.set(n,a),i}return n};var mse=Z5,A7={},Vm={},e3={};e3.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40};var vu={};const E7="[0-9]+",fse="[A-Z $%*+\\-./:]+";let av="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";av=av.replace(/u/g,"\\u");const xse="(?:(?![A-Z0-9 $%*+\\-./:]|"+av+`)(?:.|[\r
]))+`;vu.KANJI=new RegExp(av,"g");vu.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");vu.BYTE=new RegExp(xse,"g");vu.NUMERIC=new RegExp(E7,"g");vu.ALPHANUMERIC=new RegExp(fse,"g");const pse=new RegExp("^"+av+"$"),gse=new RegExp("^"+E7+"$"),vse=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");vu.testKanji=function(t){return pse.test(t)};vu.testNumeric=function(t){return gse.test(t)};vu.testAlphanumeric=function(t){return vse.test(t)};(function(s){const t=e3,r=vu;s.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},s.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},s.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},s.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},s.MIXED={bit:-1},s.getCharCountIndicator=function(i,o){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!t.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?i.ccBits[0]:o<27?i.ccBits[1]:i.ccBits[2]},s.getBestModeForData=function(i){return r.testNumeric(i)?s.NUMERIC:r.testAlphanumeric(i)?s.ALPHANUMERIC:r.testKanji(i)?s.KANJI:s.BYTE},s.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},s.isValid=function(i){return i&&i.bit&&i.ccBits};function n(a){if(typeof a!="string")throw new Error("Param is not a string");switch(a.toLowerCase()){case"numeric":return s.NUMERIC;case"alphanumeric":return s.ALPHANUMERIC;case"kanji":return s.KANJI;case"byte":return s.BYTE;default:throw new Error("Unknown mode: "+a)}}s.from=function(i,o){if(s.isValid(i))return i;try{return n(i)}catch{return o}}})(Vm);(function(s){const t=Oc,r=hN,n=uN,a=Vm,i=e3,o=7973,l=t.getBCHDigit(o);function c(f,m,p){for(let g=1;g<=40;g++)if(m<=s.getCapacity(g,p,f))return g}function d(f,m){return a.getCharCountIndicator(f,m)+4}function u(f,m){let p=0;return f.forEach(function(g){const v=d(g.mode,m);p+=v+g.getBitsLength()}),p}function h(f,m){for(let p=1;p<=40;p++)if(u(f,p)<=s.getCapacity(p,m,a.MIXED))return p}s.from=function(m,p){return i.isValid(m)?parseInt(m,10):p},s.getCapacity=function(m,p,g){if(!i.isValid(m))throw new Error("Invalid QR Code version");typeof g>"u"&&(g=a.BYTE);const v=t.getSymbolTotalCodewords(m),y=r.getTotalCodewordsCount(m,p),j=(v-y)*8;if(g===a.MIXED)return j;const b=j-d(g,m);switch(g){case a.NUMERIC:return Math.floor(b/10*3);case a.ALPHANUMERIC:return Math.floor(b/11*2);case a.KANJI:return Math.floor(b/13);case a.BYTE:default:return Math.floor(b/8)}},s.getBestVersionForData=function(m,p){let g;const v=n.from(p,n.M);if(Array.isArray(m)){if(m.length>1)return h(m,v);if(m.length===0)return 1;g=m[0]}else g=m;return c(g.mode,g.getLength(),v)},s.getEncodedBits=function(m){if(!i.isValid(m)||m<7)throw new Error("Invalid QR Code version");let p=m<<12;for(;t.getBCHDigit(p)-l>=0;)p^=o<<t.getBCHDigit(p)-l;return m<<12|p}})(A7);var I7={};const qC=Oc,P7=1335,yse=21522,aP=qC.getBCHDigit(P7);I7.getEncodedBits=function(t,r){const n=t.bit<<3|r;let a=n<<10;for(;qC.getBCHDigit(a)-aP>=0;)a^=P7<<qC.getBCHDigit(a)-aP;return(n<<10|a)^yse};var _7={};const jse=Vm;function Cp(s){this.mode=jse.NUMERIC,this.data=s.toString()}Cp.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)};Cp.prototype.getLength=function(){return this.data.length};Cp.prototype.getBitsLength=function(){return Cp.getBitsLength(this.data.length)};Cp.prototype.write=function(t){let r,n,a;for(r=0;r+3<=this.data.length;r+=3)n=this.data.substr(r,3),a=parseInt(n,10),t.put(a,10);const i=this.data.length-r;i>0&&(n=this.data.substr(r),a=parseInt(n,10),t.put(a,i*3+1))};var bse=Cp;const Nse=Vm,u2=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Ap(s){this.mode=Nse.ALPHANUMERIC,this.data=s}Ap.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)};Ap.prototype.getLength=function(){return this.data.length};Ap.prototype.getBitsLength=function(){return Ap.getBitsLength(this.data.length)};Ap.prototype.write=function(t){let r;for(r=0;r+2<=this.data.length;r+=2){let n=u2.indexOf(this.data[r])*45;n+=u2.indexOf(this.data[r+1]),t.put(n,11)}this.data.length%2&&t.put(u2.indexOf(this.data[r]),6)};var wse=Ap;const Sse=Vm;function Ep(s){this.mode=Sse.BYTE,typeof s=="string"?this.data=new TextEncoder().encode(s):this.data=new Uint8Array(s)}Ep.getBitsLength=function(t){return t*8};Ep.prototype.getLength=function(){return this.data.length};Ep.prototype.getBitsLength=function(){return Ep.getBitsLength(this.data.length)};Ep.prototype.write=function(s){for(let t=0,r=this.data.length;t<r;t++)s.put(this.data[t],8)};var Cse=Ep;const Ase=Vm,Ese=Oc;function Ip(s){this.mode=Ase.KANJI,this.data=s}Ip.getBitsLength=function(t){return t*13};Ip.prototype.getLength=function(){return this.data.length};Ip.prototype.getBitsLength=function(){return Ip.getBitsLength(this.data.length)};Ip.prototype.write=function(s){let t;for(t=0;t<this.data.length;t++){let r=Ese.toSJIS(this.data[t]);if(r>=33088&&r<=40956)r-=33088;else if(r>=57408&&r<=60351)r-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);r=(r>>>8&255)*192+(r&255),s.put(r,13)}};var Ise=Ip,k7={exports:{}};(function(s){var t={single_source_shortest_paths:function(r,n,a){var i={},o={};o[n]=0;var l=t.PriorityQueue.make();l.push(n,0);for(var c,d,u,h,f,m,p,g,v;!l.empty();){c=l.pop(),d=c.value,h=c.cost,f=r[d]||{};for(u in f)f.hasOwnProperty(u)&&(m=f[u],p=h+m,g=o[u],v=typeof o[u]>"u",(v||g>p)&&(o[u]=p,l.push(u,p),i[u]=d))}if(typeof a<"u"&&typeof o[a]>"u"){var y=["Could not find a path from ",n," to ",a,"."].join("");throw new Error(y)}return i},extract_shortest_path_from_predecessor_list:function(r,n){for(var a=[],i=n;i;)a.push(i),r[i],i=r[i];return a.reverse(),a},find_path:function(r,n,a){var i=t.single_source_shortest_paths(r,n,a);return t.extract_shortest_path_from_predecessor_list(i,a)},PriorityQueue:{make:function(r){var n=t.PriorityQueue,a={},i;r=r||{};for(i in n)n.hasOwnProperty(i)&&(a[i]=n[i]);return a.queue=[],a.sorter=r.sorter||n.default_sorter,a},default_sorter:function(r,n){return r.cost-n.cost},push:function(r,n){var a={value:r,cost:n};this.queue.push(a),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};s.exports=t})(k7);var Pse=k7.exports;(function(s){const t=Vm,r=bse,n=wse,a=Cse,i=Ise,o=vu,l=Oc,c=Pse;function d(y){return unescape(encodeURIComponent(y)).length}function u(y,j,b){const w=[];let N;for(;(N=y.exec(b))!==null;)w.push({data:N[0],index:N.index,mode:j,length:N[0].length});return w}function h(y){const j=u(o.NUMERIC,t.NUMERIC,y),b=u(o.ALPHANUMERIC,t.ALPHANUMERIC,y);let w,N;return l.isKanjiModeEnabled()?(w=u(o.BYTE,t.BYTE,y),N=u(o.KANJI,t.KANJI,y)):(w=u(o.BYTE_KANJI,t.BYTE,y),N=[]),j.concat(b,w,N).sort(function(S,_){return S.index-_.index}).map(function(S){return{data:S.data,mode:S.mode,length:S.length}})}function f(y,j){switch(j){case t.NUMERIC:return r.getBitsLength(y);case t.ALPHANUMERIC:return n.getBitsLength(y);case t.KANJI:return i.getBitsLength(y);case t.BYTE:return a.getBitsLength(y)}}function m(y){return y.reduce(function(j,b){const w=j.length-1>=0?j[j.length-1]:null;return w&&w.mode===b.mode?(j[j.length-1].data+=b.data,j):(j.push(b),j)},[])}function p(y){const j=[];for(let b=0;b<y.length;b++){const w=y[b];switch(w.mode){case t.NUMERIC:j.push([w,{data:w.data,mode:t.ALPHANUMERIC,length:w.length},{data:w.data,mode:t.BYTE,length:w.length}]);break;case t.ALPHANUMERIC:j.push([w,{data:w.data,mode:t.BYTE,length:w.length}]);break;case t.KANJI:j.push([w,{data:w.data,mode:t.BYTE,length:d(w.data)}]);break;case t.BYTE:j.push([{data:w.data,mode:t.BYTE,length:d(w.data)}])}}return j}function g(y,j){const b={},w={start:{}};let N=["start"];for(let C=0;C<y.length;C++){const S=y[C],_=[];for(let k=0;k<S.length;k++){const F=S[k],A=""+C+k;_.push(A),b[A]={node:F,lastCount:0},w[A]={};for(let T=0;T<N.length;T++){const V=N[T];b[V]&&b[V].node.mode===F.mode?(w[V][A]=f(b[V].lastCount+F.length,F.mode)-f(b[V].lastCount,F.mode),b[V].lastCount+=F.length):(b[V]&&(b[V].lastCount=F.length),w[V][A]=f(F.length,F.mode)+4+t.getCharCountIndicator(F.mode,j))}}N=_}for(let C=0;C<N.length;C++)w[N[C]].end=0;return{map:w,table:b}}function v(y,j){let b;const w=t.getBestModeForData(y);if(b=t.from(j,w),b!==t.BYTE&&b.bit<w.bit)throw new Error('"'+y+'" cannot be encoded with mode '+t.toString(b)+`.
 Suggested mode is: `+t.toString(w));switch(b===t.KANJI&&!l.isKanjiModeEnabled()&&(b=t.BYTE),b){case t.NUMERIC:return new r(y);case t.ALPHANUMERIC:return new n(y);case t.KANJI:return new i(y);case t.BYTE:return new a(y)}}s.fromArray=function(j){return j.reduce(function(b,w){return typeof w=="string"?b.push(v(w,null)):w.data&&b.push(v(w.data,w.mode)),b},[])},s.fromString=function(j,b){const w=h(j,l.isKanjiModeEnabled()),N=p(w),C=g(N,b),S=c.find_path(C.map,"start","end"),_=[];for(let k=1;k<S.length-1;k++)_.push(C.table[S[k]].node);return s.fromArray(m(_))},s.rawSplit=function(j){return s.fromArray(h(j,l.isKanjiModeEnabled()))}})(_7);const fN=Oc,h2=uN,_se=dse,kse=use,Tse=b7,Dse=N7,VC=w7,WC=hN,Ose=mse,d1=A7,Rse=I7,Fse=Vm,m2=_7;function Mse(s,t){const r=s.size,n=Dse.getPositions(t);for(let a=0;a<n.length;a++){const i=n[a][0],o=n[a][1];for(let l=-1;l<=7;l++)if(!(i+l<=-1||r<=i+l))for(let c=-1;c<=7;c++)o+c<=-1||r<=o+c||(l>=0&&l<=6&&(c===0||c===6)||c>=0&&c<=6&&(l===0||l===6)||l>=2&&l<=4&&c>=2&&c<=4?s.set(i+l,o+c,!0,!0):s.set(i+l,o+c,!1,!0))}}function Lse(s){const t=s.size;for(let r=8;r<t-8;r++){const n=r%2===0;s.set(r,6,n,!0),s.set(6,r,n,!0)}}function $se(s,t){const r=Tse.getPositions(t);for(let n=0;n<r.length;n++){const a=r[n][0],i=r[n][1];for(let o=-2;o<=2;o++)for(let l=-2;l<=2;l++)o===-2||o===2||l===-2||l===2||o===0&&l===0?s.set(a+o,i+l,!0,!0):s.set(a+o,i+l,!1,!0)}}function Bse(s,t){const r=s.size,n=d1.getEncodedBits(t);let a,i,o;for(let l=0;l<18;l++)a=Math.floor(l/3),i=l%3+r-8-3,o=(n>>l&1)===1,s.set(a,i,o,!0),s.set(i,a,o,!0)}function f2(s,t,r){const n=s.size,a=Rse.getEncodedBits(t,r);let i,o;for(i=0;i<15;i++)o=(a>>i&1)===1,i<6?s.set(i,8,o,!0):i<8?s.set(i+1,8,o,!0):s.set(n-15+i,8,o,!0),i<8?s.set(8,n-i-1,o,!0):i<9?s.set(8,15-i-1+1,o,!0):s.set(8,15-i-1,o,!0);s.set(n-8,8,1,!0)}function Use(s,t){const r=s.size;let n=-1,a=r-1,i=7,o=0;for(let l=r-1;l>0;l-=2)for(l===6&&l--;;){for(let c=0;c<2;c++)if(!s.isReserved(a,l-c)){let d=!1;o<t.length&&(d=(t[o]>>>i&1)===1),s.set(a,l-c,d),i--,i===-1&&(o++,i=7)}if(a+=n,a<0||r<=a){a-=n,n=-n;break}}}function zse(s,t,r){const n=new _se;r.forEach(function(c){n.put(c.mode.bit,4),n.put(c.getLength(),Fse.getCharCountIndicator(c.mode,s)),c.write(n)});const a=fN.getSymbolTotalCodewords(s),i=WC.getTotalCodewordsCount(s,t),o=(a-i)*8;for(n.getLengthInBits()+4<=o&&n.put(0,4);n.getLengthInBits()%8!==0;)n.putBit(0);const l=(o-n.getLengthInBits())/8;for(let c=0;c<l;c++)n.put(c%2?17:236,8);return qse(n,s,t)}function qse(s,t,r){const n=fN.getSymbolTotalCodewords(t),a=WC.getTotalCodewordsCount(t,r),i=n-a,o=WC.getBlocksCount(t,r),l=n%o,c=o-l,d=Math.floor(n/o),u=Math.floor(i/o),h=u+1,f=d-u,m=new Ose(f);let p=0;const g=new Array(o),v=new Array(o);let y=0;const j=new Uint8Array(s.buffer);for(let S=0;S<o;S++){const _=S<c?u:h;g[S]=j.slice(p,p+_),v[S]=m.encode(g[S]),p+=_,y=Math.max(y,_)}const b=new Uint8Array(n);let w=0,N,C;for(N=0;N<y;N++)for(C=0;C<o;C++)N<g[C].length&&(b[w++]=g[C][N]);for(N=0;N<f;N++)for(C=0;C<o;C++)b[w++]=v[C][N];return b}function Vse(s,t,r,n){let a;if(Array.isArray(s))a=m2.fromArray(s);else if(typeof s=="string"){let d=t;if(!d){const u=m2.rawSplit(s);d=d1.getBestVersionForData(u,r)}a=m2.fromString(s,d||40)}else throw new Error("Invalid data");const i=d1.getBestVersionForData(a,r);if(!i)throw new Error("The amount of data is too big to be stored in a QR Code");if(!t)t=i;else if(t<i)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+i+`.
`);const o=zse(t,r,a),l=fN.getSymbolSize(t),c=new kse(l);return Mse(c,t),Lse(c),$se(c,t),f2(c,r,0),t>=7&&Bse(c,t),Use(c,o),isNaN(n)&&(n=VC.getBestMask(c,f2.bind(null,c,r))),VC.applyMask(n,c),f2(c,r,n),{modules:c,version:t,errorCorrectionLevel:r,maskPattern:n,segments:a}}y7.create=function(t,r){if(typeof t>"u"||t==="")throw new Error("No input text");let n=h2.M,a,i;return typeof r<"u"&&(n=h2.from(r.errorCorrectionLevel,h2.M),a=d1.from(r.version),i=VC.from(r.maskPattern),r.toSJISFunc&&fN.setToSJISFunction(r.toSJISFunc)),Vse(t,a,n,i)};var T7={},t3={};(function(s){function t(r){if(typeof r=="number"&&(r=r.toString()),typeof r!="string")throw new Error("Color should be defined as hex string");let n=r.slice().replace("#","").split("");if(n.length<3||n.length===5||n.length>8)throw new Error("Invalid hex color: "+r);(n.length===3||n.length===4)&&(n=Array.prototype.concat.apply([],n.map(function(i){return[i,i]}))),n.length===6&&n.push("F","F");const a=parseInt(n.join(""),16);return{r:a>>24&255,g:a>>16&255,b:a>>8&255,a:a&255,hex:"#"+n.slice(0,6).join("")}}s.getOptions=function(n){n||(n={}),n.color||(n.color={});const a=typeof n.margin>"u"||n.margin===null||n.margin<0?4:n.margin,i=n.width&&n.width>=21?n.width:void 0,o=n.scale||4;return{width:i,scale:i?4:o,margin:a,color:{dark:t(n.color.dark||"#000000ff"),light:t(n.color.light||"#ffffffff")},type:n.type,rendererOpts:n.rendererOpts||{}}},s.getScale=function(n,a){return a.width&&a.width>=n+a.margin*2?a.width/(n+a.margin*2):a.scale},s.getImageWidth=function(n,a){const i=s.getScale(n,a);return Math.floor((n+a.margin*2)*i)},s.qrToImageData=function(n,a,i){const o=a.modules.size,l=a.modules.data,c=s.getScale(o,i),d=Math.floor((o+i.margin*2)*c),u=i.margin*c,h=[i.color.light,i.color.dark];for(let f=0;f<d;f++)for(let m=0;m<d;m++){let p=(f*d+m)*4,g=i.color.light;if(f>=u&&m>=u&&f<d-u&&m<d-u){const v=Math.floor((f-u)/c),y=Math.floor((m-u)/c);g=h[l[v*o+y]?1:0]}n[p++]=g.r,n[p++]=g.g,n[p++]=g.b,n[p]=g.a}}})(t3);(function(s){const t=t3;function r(a,i,o){a.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=o,i.width=o,i.style.height=o+"px",i.style.width=o+"px"}function n(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}s.render=function(i,o,l){let c=l,d=o;typeof c>"u"&&(!o||!o.getContext)&&(c=o,o=void 0),o||(d=n()),c=t.getOptions(c);const u=t.getImageWidth(i.modules.size,c),h=d.getContext("2d"),f=h.createImageData(u,u);return t.qrToImageData(f.data,i,c),r(h,d,u),h.putImageData(f,0,0),d},s.renderToDataURL=function(i,o,l){let c=l;typeof c>"u"&&(!o||!o.getContext)&&(c=o,o=void 0),c||(c={});const d=s.render(i,o,c),u=c.type||"image/png",h=c.rendererOpts||{};return d.toDataURL(u,h.quality)}})(T7);var D7={};const Wse=t3;function iP(s,t){const r=s.a/255,n=t+'="'+s.hex+'"';return r<1?n+" "+t+'-opacity="'+r.toFixed(2).slice(1)+'"':n}function x2(s,t,r){let n=s+t;return typeof r<"u"&&(n+=" "+r),n}function Hse(s,t,r){let n="",a=0,i=!1,o=0;for(let l=0;l<s.length;l++){const c=Math.floor(l%t),d=Math.floor(l/t);!c&&!i&&(i=!0),s[l]?(o++,l>0&&c>0&&s[l-1]||(n+=i?x2("M",c+r,.5+d+r):x2("m",a,0),a=0,i=!1),c+1<t&&s[l+1]||(n+=x2("h",o),o=0)):a++}return n}D7.render=function(t,r,n){const a=Wse.getOptions(r),i=t.modules.size,o=t.modules.data,l=i+a.margin*2,c=a.color.light.a?"<path "+iP(a.color.light,"fill")+' d="M0 0h'+l+"v"+l+'H0z"/>':"",d="<path "+iP(a.color.dark,"stroke")+' d="'+Hse(o,i,a.margin)+'"/>',u='viewBox="0 0 '+l+" "+l+'"',f='<svg xmlns="http://www.w3.org/2000/svg" '+(a.width?'width="'+a.width+'" height="'+a.width+'" ':"")+u+' shape-rendering="crispEdges">'+c+d+`</svg>
`;return typeof n=="function"&&n(null,f),f};const Gse=lse,HC=y7,O7=T7,Kse=D7;function s3(s,t,r,n,a){const i=[].slice.call(arguments,1),o=i.length,l=typeof i[o-1]=="function";if(!l&&!Gse())throw new Error("Callback required as last argument");if(l){if(o<2)throw new Error("Too few arguments provided");o===2?(a=r,r=t,t=n=void 0):o===3&&(t.getContext&&typeof a>"u"?(a=n,n=void 0):(a=n,n=r,r=t,t=void 0))}else{if(o<1)throw new Error("Too few arguments provided");return o===1?(r=t,t=n=void 0):o===2&&!t.getContext&&(n=r,r=t,t=void 0),new Promise(function(c,d){try{const u=HC.create(r,n);c(s(u,t,n))}catch(u){d(u)}})}try{const c=HC.create(r,n);a(null,s(c,t,n))}catch(c){a(c)}}hx.create=HC.create;hx.toCanvas=s3.bind(null,O7.render);hx.toDataURL=s3.bind(null,O7.renderToDataURL);hx.toString=s3.bind(null,function(s,t,r){return Kse.render(s,r)});const Yse="modulepreload",Jse=function(s){return"/"+s},oP={},T0=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(r.map(c=>{if(c=Jse(c),c in oP)return;oP[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":Yse,d||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((f,m)=>{h.addEventListener("load",f),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})};function Na(s){"@babel/helpers - typeof";return Na=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Na(s)}var Rd=Uint8Array,Ec=Uint16Array,r3=Int32Array,n3=new Rd([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),a3=new Rd([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),lP=new Rd([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),R7=function(s,t){for(var r=new Ec(31),n=0;n<31;++n)r[n]=t+=1<<s[n-1];for(var a=new r3(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)a[i]=i-r[n]<<5|n;return{b:r,r:a}},F7=R7(n3,2),Xse=F7.b,GC=F7.r;Xse[28]=258,GC[258]=28;var Qse=R7(a3,0),cP=Qse.r,KC=new Ec(32768);for(var di=0;di<32768;++di){var Mh=(di&43690)>>1|(di&21845)<<1;Mh=(Mh&52428)>>2|(Mh&13107)<<2,Mh=(Mh&61680)>>4|(Mh&3855)<<4,KC[di]=((Mh&65280)>>8|(Mh&255)<<8)>>1}var D0=function(s,t,r){for(var n=s.length,a=0,i=new Ec(t);a<n;++a)s[a]&&++i[s[a]-1];var o=new Ec(t);for(a=1;a<t;++a)o[a]=o[a-1]+i[a-1]<<1;var l;if(r){l=new Ec(1<<t);var c=15-t;for(a=0;a<n;++a)if(s[a])for(var d=a<<4|s[a],u=t-s[a],h=o[s[a]-1]++<<u,f=h|(1<<u)-1;h<=f;++h)l[KC[h]>>c]=d}else for(l=new Ec(n),a=0;a<n;++a)s[a]&&(l[a]=KC[o[s[a]-1]++]>>15-s[a]);return l},ex=new Rd(288);for(var di=0;di<144;++di)ex[di]=8;for(var di=144;di<256;++di)ex[di]=9;for(var di=256;di<280;++di)ex[di]=7;for(var di=280;di<288;++di)ex[di]=8;var u1=new Rd(32);for(var di=0;di<32;++di)u1[di]=5;var Zse=D0(ex,9,0),ere=D0(u1,5,0),M7=function(s){return(s+7)/8|0},tre=function(s,t,r){return(r==null||r>s.length)&&(r=s.length),new Rd(s.subarray(t,r))},ku=function(s,t,r){r<<=t&7;var n=t/8|0;s[n]|=r,s[n+1]|=r>>8},Zg=function(s,t,r){r<<=t&7;var n=t/8|0;s[n]|=r,s[n+1]|=r>>8,s[n+2]|=r>>16},p2=function(s,t){for(var r=[],n=0;n<s.length;++n)s[n]&&r.push({s:n,f:s[n]});var a=r.length,i=r.slice();if(!a)return{t:$7,l:0};if(a==1){var o=new Rd(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(N,C){return N.f-C.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],d=0,u=1,h=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};u!=a-1;)l=r[r[d].f<r[h].f?d++:h++],c=r[d!=u&&r[d].f<r[h].f?d++:h++],r[u++]={s:-1,f:l.f+c.f,l,r:c};for(var f=i[0].s,n=1;n<a;++n)i[n].s>f&&(f=i[n].s);var m=new Ec(f+1),p=YC(r[u-1],m,0);if(p>t){var n=0,g=0,v=p-t,y=1<<v;for(i.sort(function(C,S){return m[S.s]-m[C.s]||C.f-S.f});n<a;++n){var j=i[n].s;if(m[j]>t)g+=y-(1<<p-m[j]),m[j]=t;else break}for(g>>=v;g>0;){var b=i[n].s;m[b]<t?g-=1<<t-m[b]++-1:++n}for(;n>=0&&g;--n){var w=i[n].s;m[w]==t&&(--m[w],++g)}p=t}return{t:new Rd(m),l:p}},YC=function(s,t,r){return s.s==-1?Math.max(YC(s.l,t,r+1),YC(s.r,t,r+1)):t[s.s]=r},dP=function(s){for(var t=s.length;t&&!s[--t];);for(var r=new Ec(++t),n=0,a=s[0],i=1,o=function(c){r[n++]=c},l=1;l<=t;++l)if(s[l]==a&&l!=t)++i;else{if(!a&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(a),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(a);i=1,a=s[l]}return{c:r.subarray(0,n),n:t}},e0=function(s,t){for(var r=0,n=0;n<t.length;++n)r+=s[n]*t[n];return r},L7=function(s,t,r){var n=r.length,a=M7(t+2);s[a]=n&255,s[a+1]=n>>8,s[a+2]=s[a]^255,s[a+3]=s[a+1]^255;for(var i=0;i<n;++i)s[a+i+4]=r[i];return(a+4+n)*8},uP=function(s,t,r,n,a,i,o,l,c,d,u){ku(t,u++,r),++a[256];for(var h=p2(a,15),f=h.t,m=h.l,p=p2(i,15),g=p.t,v=p.l,y=dP(f),j=y.c,b=y.n,w=dP(g),N=w.c,C=w.n,S=new Ec(19),_=0;_<j.length;++_)++S[j[_]&31];for(var _=0;_<N.length;++_)++S[N[_]&31];for(var k=p2(S,7),F=k.t,A=k.l,T=19;T>4&&!F[lP[T-1]];--T);var V=d+5<<3,M=e0(a,ex)+e0(i,u1)+o,G=e0(a,f)+e0(i,g)+o+14+3*T+e0(S,F)+2*S[16]+3*S[17]+7*S[18];if(c>=0&&V<=M&&V<=G)return L7(t,u,s.subarray(c,c+d));var L,J,z,U;if(ku(t,u,1+(G<M)),u+=2,G<M){L=D0(f,m,0),J=f,z=D0(g,v,0),U=g;var oe=D0(F,A,0);ku(t,u,b-257),ku(t,u+5,C-1),ku(t,u+10,T-4),u+=14;for(var _=0;_<T;++_)ku(t,u+3*_,F[lP[_]]);u+=3*T;for(var Q=[j,N],P=0;P<2;++P)for(var q=Q[P],_=0;_<q.length;++_){var D=q[_]&31;ku(t,u,oe[D]),u+=F[D],D>15&&(ku(t,u,q[_]>>5&127),u+=q[_]>>12)}}else L=Zse,J=ex,z=ere,U=u1;for(var _=0;_<l;++_){var se=n[_];if(se>255){var D=se>>18&31;Zg(t,u,L[D+257]),u+=J[D+257],D>7&&(ku(t,u,se>>23&31),u+=n3[D]);var he=se&31;Zg(t,u,z[he]),u+=U[he],he>3&&(Zg(t,u,se>>5&8191),u+=a3[he])}else Zg(t,u,L[se]),u+=J[se]}return Zg(t,u,L[256]),u+J[256]},sre=new r3([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),$7=new Rd(0),rre=function(s,t,r,n,a,i){var o=i.z||s.length,l=new Rd(n+o+5*(1+Math.ceil(o/7e3))+a),c=l.subarray(n,l.length-a),d=i.l,u=(i.r||0)&7;if(t){u&&(c[0]=i.r>>3);for(var h=sre[t-1],f=h>>13,m=h&8191,p=(1<<r)-1,g=i.p||new Ec(32768),v=i.h||new Ec(p+1),y=Math.ceil(r/3),j=2*y,b=function(re){return(s[re]^s[re+1]<<y^s[re+2]<<j)&p},w=new r3(25e3),N=new Ec(288),C=new Ec(32),S=0,_=0,k=i.i||0,F=0,A=i.w||0,T=0;k+2<o;++k){var V=b(k),M=k&32767,G=v[V];if(g[M]=G,v[V]=M,A<=k){var L=o-k;if((S>7e3||F>24576)&&(L>423||!d)){u=uP(s,c,0,w,N,C,_,F,T,k-T,u),F=S=_=0,T=k;for(var J=0;J<286;++J)N[J]=0;for(var J=0;J<30;++J)C[J]=0}var z=2,U=0,oe=m,Q=M-G&32767;if(L>2&&V==b(k-Q))for(var P=Math.min(f,L)-1,q=Math.min(32767,k),D=Math.min(258,L);Q<=q&&--oe&&M!=G;){if(s[k+z]==s[k+z-Q]){for(var se=0;se<D&&s[k+se]==s[k+se-Q];++se);if(se>z){if(z=se,U=Q,se>P)break;for(var he=Math.min(Q,se-2),be=0,J=0;J<he;++J){var pe=k-Q+J&32767,Ae=g[pe],Ee=pe-Ae&32767;Ee>be&&(be=Ee,G=pe)}}}M=G,G=g[M],Q+=M-G&32767}if(U){w[F++]=268435456|GC[z]<<18|cP[U];var $e=GC[z]&31,O=cP[U]&31;_+=n3[$e]+a3[O],++N[257+$e],++C[O],A=k+z,++S}else w[F++]=s[k],++N[s[k]]}}for(k=Math.max(k,A);k<o;++k)w[F++]=s[k],++N[s[k]];u=uP(s,c,d,w,N,C,_,F,T,k-T,u),d||(i.r=u&7|c[u/8|0]<<3,u-=7,i.h=v,i.p=g,i.i=k,i.w=A)}else{for(var k=i.w||0;k<o+d;k+=65535){var te=k+65535;te>=o&&(c[u/8|0]=d,te=o),u=L7(c,u+1,s.subarray(k,te))}i.i=o}return tre(l,0,n+M7(u)+a)},B7=function(){var s=1,t=0;return{p:function(r){for(var n=s,a=t,i=r.length|0,o=0;o!=i;){for(var l=Math.min(o+2655,i);o<l;++o)a+=n+=r[o];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}s=n,t=a},d:function(){return s%=65521,t%=65521,(s&255)<<24|(s&65280)<<8|(t&255)<<8|t>>8}}},nre=function(s,t,r,n,a){if(!a&&(a={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),o=new Rd(i.length+s.length);o.set(i),o.set(s,i.length),s=o,a.w=i.length}return rre(s,t.level==null?6:t.level,t.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(s.length)))*1.5):20:12+t.mem,r,n,a)},U7=function(s,t,r){for(;r;++t)s[t]=r,r>>>=8},are=function(s,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(s[0]=120,s[1]=n<<6|(t.dictionary&&32),s[1]|=31-(s[0]<<8|s[1])%31,t.dictionary){var a=B7();a.p(t.dictionary),U7(s,2,a.d())}};function JC(s,t){t||(t={});var r=B7();r.p(s);var n=nre(s,t,t.dictionary?6:2,4);return are(n,t),U7(n,n.length-4,r.d()),n}var ire=typeof TextDecoder<"u"&&new TextDecoder,ore=0;try{ire.decode($7,{stream:!0}),ore=1}catch{}function lre(s){if(Array.isArray(s))return s}function cre(s,t){var r=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(s)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function hP(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=Array(t);r<t;r++)n[r]=s[r];return n}function dre(s,t){if(s){if(typeof s=="string")return hP(s,t);var r={}.toString.call(s).slice(8,-1);return r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set"?Array.from(s):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?hP(s,t):void 0}}function ure(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mP(s,t){return lre(s)||cre(s,t)||dre(s,t)||ure()}function fP(s,t="utf8"){return new TextDecoder(t).decode(s)}const hre=new TextEncoder;function mre(s){return hre.encode(s)}const fre=1024*8,xre=(()=>{const s=new Uint8Array(4),t=new Uint32Array(s.buffer);return!((t[0]=1)&s[0])})(),g2={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class i3{constructor(t=fre,r={}){dn(this,"buffer");dn(this,"byteLength");dn(this,"byteOffset");dn(this,"length");dn(this,"offset");dn(this,"lastWrittenByte");dn(this,"littleEndian");dn(this,"_data");dn(this,"_mark");dn(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const a=r.offset?r.offset>>>0:0,i=t.byteLength-a;let o=a;(ArrayBuffer.isView(t)||t instanceof i3)&&(t.byteLength!==t.buffer.byteLength&&(o=t.byteOffset+a),t=t.buffer),n?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=t,this.length=i,this.byteLength=i,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,i),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,a=new Uint8Array(n);a.set(new Uint8Array(this.buffer)),this.buffer=a.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=g2[r].BYTES_PER_ELEMENT*t,a=this.byteOffset+this.offset,i=this.buffer.slice(a,a+n);if(this.littleEndian===xre&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(a,a+n));l.reverse();const c=new g2[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new g2[r](i);return this.offset+=n,o}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return fP(this.readBytes(t))}decodeText(t=1,r="utf8"){return fP(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(mre(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Ng(s){let t=s.length;for(;--t>=0;)s[t]=0}const pre=3,gre=258,z7=29,vre=256,yre=vre+1+z7,q7=30,jre=512,bre=new Array((yre+2)*2);Ng(bre);const Nre=new Array(q7*2);Ng(Nre);const wre=new Array(jre);Ng(wre);const Sre=new Array(gre-pre+1);Ng(Sre);const Cre=new Array(z7);Ng(Cre);const Are=new Array(q7);Ng(Are);const Ere=(s,t,r,n)=>{let a=s&65535|0,i=s>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do a=a+t[n++]|0,i=i+a|0;while(--o);a%=65521,i%=65521}return a|i<<16|0};var XC=Ere;const Ire=()=>{let s,t=[];for(var r=0;r<256;r++){s=r;for(var n=0;n<8;n++)s=s&1?3988292384^s>>>1:s>>>1;t[r]=s}return t},Pre=new Uint32Array(Ire()),_re=(s,t,r,n)=>{const a=Pre,i=n+r;s^=-1;for(let o=n;o<i;o++)s=s>>>8^a[(s^t[o])&255];return s^-1};var Hd=_re,QC={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},V7={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const kre=(s,t)=>Object.prototype.hasOwnProperty.call(s,t);var Tre=function(s){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)kre(r,n)&&(s[n]=r[n])}}return s},Dre=s=>{let t=0;for(let n=0,a=s.length;n<a;n++)t+=s[n].length;const r=new Uint8Array(t);for(let n=0,a=0,i=s.length;n<i;n++){let o=s[n];r.set(o,a),a+=o.length}return r},W7={assign:Tre,flattenChunks:Dre};let H7=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{H7=!1}const iv=new Uint8Array(256);for(let s=0;s<256;s++)iv[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;iv[254]=iv[254]=1;var Ore=s=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(s);let t,r,n,a,i,o=s.length,l=0;for(a=0;a<o;a++)r=s.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=s.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(l),i=0,a=0;i<l;a++)r=s.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=s.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),r<128?t[i++]=r:r<2048?(t[i++]=192|r>>>6,t[i++]=128|r&63):r<65536?(t[i++]=224|r>>>12,t[i++]=128|r>>>6&63,t[i++]=128|r&63):(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63,t[i++]=128|r>>>6&63,t[i++]=128|r&63);return t};const Rre=(s,t)=>{if(t<65534&&s.subarray&&H7)return String.fromCharCode.apply(null,s.length===t?s:s.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(s[n]);return r};var Fre=(s,t)=>{const r=t||s.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(s.subarray(0,t));let n,a;const i=new Array(r*2);for(a=0,n=0;n<r;){let o=s[n++];if(o<128){i[a++]=o;continue}let l=iv[o];if(l>4){i[a++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|s[n++]&63,l--;if(l>1){i[a++]=65533;continue}o<65536?i[a++]=o:(o-=65536,i[a++]=55296|o>>10&1023,i[a++]=56320|o&1023)}return Rre(i,a)},Mre=(s,t)=>{t=t||s.length,t>s.length&&(t=s.length);let r=t-1;for(;r>=0&&(s[r]&192)===128;)r--;return r<0||r===0?t:r+iv[s[r]]>t?r:t},ZC={string2buf:Ore,buf2string:Fre,utf8border:Mre};function Lre(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var $re=Lre;const tj=16209,Bre=16191;var Ure=function(t,r){let n,a,i,o,l,c,d,u,h,f,m,p,g,v,y,j,b,w,N,C,S,_,k,F;const A=t.state;n=t.next_in,k=t.input,a=n+(t.avail_in-5),i=t.next_out,F=t.output,o=i-(r-t.avail_out),l=i+(t.avail_out-257),c=A.dmax,d=A.wsize,u=A.whave,h=A.wnext,f=A.window,m=A.hold,p=A.bits,g=A.lencode,v=A.distcode,y=(1<<A.lenbits)-1,j=(1<<A.distbits)-1;e:do{p<15&&(m+=k[n++]<<p,p+=8,m+=k[n++]<<p,p+=8),b=g[m&y];t:for(;;){if(w=b>>>24,m>>>=w,p-=w,w=b>>>16&255,w===0)F[i++]=b&65535;else if(w&16){N=b&65535,w&=15,w&&(p<w&&(m+=k[n++]<<p,p+=8),N+=m&(1<<w)-1,m>>>=w,p-=w),p<15&&(m+=k[n++]<<p,p+=8,m+=k[n++]<<p,p+=8),b=v[m&j];s:for(;;){if(w=b>>>24,m>>>=w,p-=w,w=b>>>16&255,w&16){if(C=b&65535,w&=15,p<w&&(m+=k[n++]<<p,p+=8,p<w&&(m+=k[n++]<<p,p+=8)),C+=m&(1<<w)-1,C>c){t.msg="invalid distance too far back",A.mode=tj;break e}if(m>>>=w,p-=w,w=i-o,C>w){if(w=C-w,w>u&&A.sane){t.msg="invalid distance too far back",A.mode=tj;break e}if(S=0,_=f,h===0){if(S+=d-w,w<N){N-=w;do F[i++]=f[S++];while(--w);S=i-C,_=F}}else if(h<w){if(S+=d+h-w,w-=h,w<N){N-=w;do F[i++]=f[S++];while(--w);if(S=0,h<N){w=h,N-=w;do F[i++]=f[S++];while(--w);S=i-C,_=F}}}else if(S+=h-w,w<N){N-=w;do F[i++]=f[S++];while(--w);S=i-C,_=F}for(;N>2;)F[i++]=_[S++],F[i++]=_[S++],F[i++]=_[S++],N-=3;N&&(F[i++]=_[S++],N>1&&(F[i++]=_[S++]))}else{S=i-C;do F[i++]=F[S++],F[i++]=F[S++],F[i++]=F[S++],N-=3;while(N>2);N&&(F[i++]=F[S++],N>1&&(F[i++]=F[S++]))}}else if(w&64){t.msg="invalid distance code",A.mode=tj;break e}else{b=v[(b&65535)+(m&(1<<w)-1)];continue s}break}}else if(w&64)if(w&32){A.mode=Bre;break e}else{t.msg="invalid literal/length code",A.mode=tj;break e}else{b=g[(b&65535)+(m&(1<<w)-1)];continue t}break}}while(n<a&&i<l);N=p>>3,n-=N,p-=N<<3,m&=(1<<p)-1,t.next_in=n,t.next_out=i,t.avail_in=n<a?5+(a-n):5-(n-a),t.avail_out=i<l?257+(l-i):257-(i-l),A.hold=m,A.bits=p};const Ex=15,xP=852,pP=592,gP=0,v2=1,vP=2,zre=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),qre=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Vre=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Wre=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Hre=(s,t,r,n,a,i,o,l)=>{const c=l.bits;let d=0,u=0,h=0,f=0,m=0,p=0,g=0,v=0,y=0,j=0,b,w,N,C,S,_=null,k;const F=new Uint16Array(Ex+1),A=new Uint16Array(Ex+1);let T=null,V,M,G;for(d=0;d<=Ex;d++)F[d]=0;for(u=0;u<n;u++)F[t[r+u]]++;for(m=c,f=Ex;f>=1&&F[f]===0;f--);if(m>f&&(m=f),f===0)return a[i++]=1<<24|64<<16|0,a[i++]=1<<24|64<<16|0,l.bits=1,0;for(h=1;h<f&&F[h]===0;h++);for(m<h&&(m=h),v=1,d=1;d<=Ex;d++)if(v<<=1,v-=F[d],v<0)return-1;if(v>0&&(s===gP||f!==1))return-1;for(A[1]=0,d=1;d<Ex;d++)A[d+1]=A[d]+F[d];for(u=0;u<n;u++)t[r+u]!==0&&(o[A[t[r+u]]++]=u);if(s===gP?(_=T=o,k=20):s===v2?(_=zre,T=qre,k=257):(_=Vre,T=Wre,k=0),j=0,u=0,d=h,S=i,p=m,g=0,N=-1,y=1<<m,C=y-1,s===v2&&y>xP||s===vP&&y>pP)return 1;for(;;){V=d-g,o[u]+1<k?(M=0,G=o[u]):o[u]>=k?(M=T[o[u]-k],G=_[o[u]-k]):(M=96,G=0),b=1<<d-g,w=1<<p,h=w;do w-=b,a[S+(j>>g)+w]=V<<24|M<<16|G|0;while(w!==0);for(b=1<<d-1;j&b;)b>>=1;if(b!==0?(j&=b-1,j+=b):j=0,u++,--F[d]===0){if(d===f)break;d=t[r+o[u]]}if(d>m&&(j&C)!==N){for(g===0&&(g=m),S+=h,p=d-g,v=1<<p;p+g<f&&(v-=F[p+g],!(v<=0));)p++,v<<=1;if(y+=1<<p,s===v2&&y>xP||s===vP&&y>pP)return 1;N=j&C,a[N]=m<<24|p<<16|S-i|0}}return j!==0&&(a[S+j]=d-g<<24|64<<16|0),l.bits=m,0};var O0=Hre;const Gre=0,G7=1,K7=2,{Z_FINISH:yP,Z_BLOCK:Kre,Z_TREES:sj,Z_OK:tx,Z_STREAM_END:Yre,Z_NEED_DICT:Jre,Z_STREAM_ERROR:rd,Z_DATA_ERROR:Y7,Z_MEM_ERROR:J7,Z_BUF_ERROR:Xre,Z_DEFLATED:jP}=V7,xN=16180,bP=16181,NP=16182,wP=16183,SP=16184,CP=16185,AP=16186,EP=16187,IP=16188,PP=16189,h1=16190,Tu=16191,y2=16192,_P=16193,j2=16194,kP=16195,TP=16196,DP=16197,OP=16198,rj=16199,nj=16200,RP=16201,FP=16202,MP=16203,LP=16204,$P=16205,b2=16206,BP=16207,UP=16208,pi=16209,X7=16210,Q7=16211,Qre=852,Zre=592,ene=15,tne=ene,zP=s=>(s>>>24&255)+(s>>>8&65280)+((s&65280)<<8)+((s&255)<<24);function sne(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const mx=s=>{if(!s)return 1;const t=s.state;return!t||t.strm!==s||t.mode<xN||t.mode>Q7?1:0},Z7=s=>{if(mx(s))return rd;const t=s.state;return s.total_in=s.total_out=t.total=0,s.msg="",t.wrap&&(s.adler=t.wrap&1),t.mode=xN,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(Qre),t.distcode=t.distdyn=new Int32Array(Zre),t.sane=1,t.back=-1,tx},e$=s=>{if(mx(s))return rd;const t=s.state;return t.wsize=0,t.whave=0,t.wnext=0,Z7(s)},t$=(s,t)=>{let r;if(mx(s))return rd;const n=s.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?rd:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,e$(s))},s$=(s,t)=>{if(!s)return rd;const r=new sne;s.state=r,r.strm=s,r.window=null,r.mode=xN;const n=t$(s,t);return n!==tx&&(s.state=null),n},rne=s=>s$(s,tne);let qP=!0,N2,w2;const nne=s=>{if(qP){N2=new Int32Array(512),w2=new Int32Array(32);let t=0;for(;t<144;)s.lens[t++]=8;for(;t<256;)s.lens[t++]=9;for(;t<280;)s.lens[t++]=7;for(;t<288;)s.lens[t++]=8;for(O0(G7,s.lens,0,288,N2,0,s.work,{bits:9}),t=0;t<32;)s.lens[t++]=5;O0(K7,s.lens,0,32,w2,0,s.work,{bits:5}),qP=!1}s.lencode=N2,s.lenbits=9,s.distcode=w2,s.distbits=5},r$=(s,t,r,n)=>{let a;const i=s.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(t.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):(a=i.wsize-i.wnext,a>n&&(a=n),i.window.set(t.subarray(r-n,r-n+a),i.wnext),n-=a,n?(i.window.set(t.subarray(r-n,r),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=a,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=a))),0},ane=(s,t)=>{let r,n,a,i,o,l,c,d,u,h,f,m,p,g,v=0,y,j,b,w,N,C,S,_;const k=new Uint8Array(4);let F,A;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(mx(s)||!s.output||!s.input&&s.avail_in!==0)return rd;r=s.state,r.mode===Tu&&(r.mode=y2),o=s.next_out,a=s.output,c=s.avail_out,i=s.next_in,n=s.input,l=s.avail_in,d=r.hold,u=r.bits,h=l,f=c,_=tx;e:for(;;)switch(r.mode){case xN:if(r.wrap===0){r.mode=y2;break}for(;u<16;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(r.wrap&2&&d===35615){r.wbits===0&&(r.wbits=15),r.check=0,k[0]=d&255,k[1]=d>>>8&255,r.check=Hd(r.check,k,2,0),d=0,u=0,r.mode=bP;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((d&255)<<8)+(d>>8))%31){s.msg="incorrect header check",r.mode=pi;break}if((d&15)!==jP){s.msg="unknown compression method",r.mode=pi;break}if(d>>>=4,u-=4,S=(d&15)+8,r.wbits===0&&(r.wbits=S),S>15||S>r.wbits){s.msg="invalid window size",r.mode=pi;break}r.dmax=1<<r.wbits,r.flags=0,s.adler=r.check=1,r.mode=d&512?PP:Tu,d=0,u=0;break;case bP:for(;u<16;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(r.flags=d,(r.flags&255)!==jP){s.msg="unknown compression method",r.mode=pi;break}if(r.flags&57344){s.msg="unknown header flags set",r.mode=pi;break}r.head&&(r.head.text=d>>8&1),r.flags&512&&r.wrap&4&&(k[0]=d&255,k[1]=d>>>8&255,r.check=Hd(r.check,k,2,0)),d=0,u=0,r.mode=NP;case NP:for(;u<32;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}r.head&&(r.head.time=d),r.flags&512&&r.wrap&4&&(k[0]=d&255,k[1]=d>>>8&255,k[2]=d>>>16&255,k[3]=d>>>24&255,r.check=Hd(r.check,k,4,0)),d=0,u=0,r.mode=wP;case wP:for(;u<16;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}r.head&&(r.head.xflags=d&255,r.head.os=d>>8),r.flags&512&&r.wrap&4&&(k[0]=d&255,k[1]=d>>>8&255,r.check=Hd(r.check,k,2,0)),d=0,u=0,r.mode=SP;case SP:if(r.flags&1024){for(;u<16;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}r.length=d,r.head&&(r.head.extra_len=d),r.flags&512&&r.wrap&4&&(k[0]=d&255,k[1]=d>>>8&255,r.check=Hd(r.check,k,2,0)),d=0,u=0}else r.head&&(r.head.extra=null);r.mode=CP;case CP:if(r.flags&1024&&(m=r.length,m>l&&(m=l),m&&(r.head&&(S=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(i,i+m),S)),r.flags&512&&r.wrap&4&&(r.check=Hd(r.check,n,m,i)),l-=m,i+=m,r.length-=m),r.length))break e;r.length=0,r.mode=AP;case AP:if(r.flags&2048){if(l===0)break e;m=0;do S=n[i+m++],r.head&&S&&r.length<65536&&(r.head.name+=String.fromCharCode(S));while(S&&m<l);if(r.flags&512&&r.wrap&4&&(r.check=Hd(r.check,n,m,i)),l-=m,i+=m,S)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=EP;case EP:if(r.flags&4096){if(l===0)break e;m=0;do S=n[i+m++],r.head&&S&&r.length<65536&&(r.head.comment+=String.fromCharCode(S));while(S&&m<l);if(r.flags&512&&r.wrap&4&&(r.check=Hd(r.check,n,m,i)),l-=m,i+=m,S)break e}else r.head&&(r.head.comment=null);r.mode=IP;case IP:if(r.flags&512){for(;u<16;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(r.wrap&4&&d!==(r.check&65535)){s.msg="header crc mismatch",r.mode=pi;break}d=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),s.adler=r.check=0,r.mode=Tu;break;case PP:for(;u<32;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}s.adler=r.check=zP(d),d=0,u=0,r.mode=h1;case h1:if(r.havedict===0)return s.next_out=o,s.avail_out=c,s.next_in=i,s.avail_in=l,r.hold=d,r.bits=u,Jre;s.adler=r.check=1,r.mode=Tu;case Tu:if(t===Kre||t===sj)break e;case y2:if(r.last){d>>>=u&7,u-=u&7,r.mode=b2;break}for(;u<3;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}switch(r.last=d&1,d>>>=1,u-=1,d&3){case 0:r.mode=_P;break;case 1:if(nne(r),r.mode=rj,t===sj){d>>>=2,u-=2;break e}break;case 2:r.mode=TP;break;case 3:s.msg="invalid block type",r.mode=pi}d>>>=2,u-=2;break;case _P:for(d>>>=u&7,u-=u&7;u<32;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if((d&65535)!==(d>>>16^65535)){s.msg="invalid stored block lengths",r.mode=pi;break}if(r.length=d&65535,d=0,u=0,r.mode=j2,t===sj)break e;case j2:r.mode=kP;case kP:if(m=r.length,m){if(m>l&&(m=l),m>c&&(m=c),m===0)break e;a.set(n.subarray(i,i+m),o),l-=m,i+=m,c-=m,o+=m,r.length-=m;break}r.mode=Tu;break;case TP:for(;u<14;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(r.nlen=(d&31)+257,d>>>=5,u-=5,r.ndist=(d&31)+1,d>>>=5,u-=5,r.ncode=(d&15)+4,d>>>=4,u-=4,r.nlen>286||r.ndist>30){s.msg="too many length or distance symbols",r.mode=pi;break}r.have=0,r.mode=DP;case DP:for(;r.have<r.ncode;){for(;u<3;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}r.lens[T[r.have++]]=d&7,d>>>=3,u-=3}for(;r.have<19;)r.lens[T[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,F={bits:r.lenbits},_=O0(Gre,r.lens,0,19,r.lencode,0,r.work,F),r.lenbits=F.bits,_){s.msg="invalid code lengths set",r.mode=pi;break}r.have=0,r.mode=OP;case OP:for(;r.have<r.nlen+r.ndist;){for(;v=r.lencode[d&(1<<r.lenbits)-1],y=v>>>24,j=v>>>16&255,b=v&65535,!(y<=u);){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(b<16)d>>>=y,u-=y,r.lens[r.have++]=b;else{if(b===16){for(A=y+2;u<A;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(d>>>=y,u-=y,r.have===0){s.msg="invalid bit length repeat",r.mode=pi;break}S=r.lens[r.have-1],m=3+(d&3),d>>>=2,u-=2}else if(b===17){for(A=y+3;u<A;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}d>>>=y,u-=y,S=0,m=3+(d&7),d>>>=3,u-=3}else{for(A=y+7;u<A;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}d>>>=y,u-=y,S=0,m=11+(d&127),d>>>=7,u-=7}if(r.have+m>r.nlen+r.ndist){s.msg="invalid bit length repeat",r.mode=pi;break}for(;m--;)r.lens[r.have++]=S}}if(r.mode===pi)break;if(r.lens[256]===0){s.msg="invalid code -- missing end-of-block",r.mode=pi;break}if(r.lenbits=9,F={bits:r.lenbits},_=O0(G7,r.lens,0,r.nlen,r.lencode,0,r.work,F),r.lenbits=F.bits,_){s.msg="invalid literal/lengths set",r.mode=pi;break}if(r.distbits=6,r.distcode=r.distdyn,F={bits:r.distbits},_=O0(K7,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,F),r.distbits=F.bits,_){s.msg="invalid distances set",r.mode=pi;break}if(r.mode=rj,t===sj)break e;case rj:r.mode=nj;case nj:if(l>=6&&c>=258){s.next_out=o,s.avail_out=c,s.next_in=i,s.avail_in=l,r.hold=d,r.bits=u,Ure(s,f),o=s.next_out,a=s.output,c=s.avail_out,i=s.next_in,n=s.input,l=s.avail_in,d=r.hold,u=r.bits,r.mode===Tu&&(r.back=-1);break}for(r.back=0;v=r.lencode[d&(1<<r.lenbits)-1],y=v>>>24,j=v>>>16&255,b=v&65535,!(y<=u);){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(j&&!(j&240)){for(w=y,N=j,C=b;v=r.lencode[C+((d&(1<<w+N)-1)>>w)],y=v>>>24,j=v>>>16&255,b=v&65535,!(w+y<=u);){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}d>>>=w,u-=w,r.back+=w}if(d>>>=y,u-=y,r.back+=y,r.length=b,j===0){r.mode=$P;break}if(j&32){r.back=-1,r.mode=Tu;break}if(j&64){s.msg="invalid literal/length code",r.mode=pi;break}r.extra=j&15,r.mode=RP;case RP:if(r.extra){for(A=r.extra;u<A;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}r.length+=d&(1<<r.extra)-1,d>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=FP;case FP:for(;v=r.distcode[d&(1<<r.distbits)-1],y=v>>>24,j=v>>>16&255,b=v&65535,!(y<=u);){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(!(j&240)){for(w=y,N=j,C=b;v=r.distcode[C+((d&(1<<w+N)-1)>>w)],y=v>>>24,j=v>>>16&255,b=v&65535,!(w+y<=u);){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}d>>>=w,u-=w,r.back+=w}if(d>>>=y,u-=y,r.back+=y,j&64){s.msg="invalid distance code",r.mode=pi;break}r.offset=b,r.extra=j&15,r.mode=MP;case MP:if(r.extra){for(A=r.extra;u<A;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}r.offset+=d&(1<<r.extra)-1,d>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){s.msg="invalid distance too far back",r.mode=pi;break}r.mode=LP;case LP:if(c===0)break e;if(m=f-c,r.offset>m){if(m=r.offset-m,m>r.whave&&r.sane){s.msg="invalid distance too far back",r.mode=pi;break}m>r.wnext?(m-=r.wnext,p=r.wsize-m):p=r.wnext-m,m>r.length&&(m=r.length),g=r.window}else g=a,p=o-r.offset,m=r.length;m>c&&(m=c),c-=m,r.length-=m;do a[o++]=g[p++];while(--m);r.length===0&&(r.mode=nj);break;case $P:if(c===0)break e;a[o++]=r.length,c--,r.mode=nj;break;case b2:if(r.wrap){for(;u<32;){if(l===0)break e;l--,d|=n[i++]<<u,u+=8}if(f-=c,s.total_out+=f,r.total+=f,r.wrap&4&&f&&(s.adler=r.check=r.flags?Hd(r.check,a,f,o-f):XC(r.check,a,f,o-f)),f=c,r.wrap&4&&(r.flags?d:zP(d))!==r.check){s.msg="incorrect data check",r.mode=pi;break}d=0,u=0}r.mode=BP;case BP:if(r.wrap&&r.flags){for(;u<32;){if(l===0)break e;l--,d+=n[i++]<<u,u+=8}if(r.wrap&4&&d!==(r.total&4294967295)){s.msg="incorrect length check",r.mode=pi;break}d=0,u=0}r.mode=UP;case UP:_=Yre;break e;case pi:_=Y7;break e;case X7:return J7;case Q7:default:return rd}return s.next_out=o,s.avail_out=c,s.next_in=i,s.avail_in=l,r.hold=d,r.bits=u,(r.wsize||f!==s.avail_out&&r.mode<pi&&(r.mode<b2||t!==yP))&&r$(s,s.output,s.next_out,f-s.avail_out),h-=s.avail_in,f-=s.avail_out,s.total_in+=h,s.total_out+=f,r.total+=f,r.wrap&4&&f&&(s.adler=r.check=r.flags?Hd(r.check,a,f,s.next_out-f):XC(r.check,a,f,s.next_out-f)),s.data_type=r.bits+(r.last?64:0)+(r.mode===Tu?128:0)+(r.mode===rj||r.mode===j2?256:0),(h===0&&f===0||t===yP)&&_===tx&&(_=Xre),_},ine=s=>{if(mx(s))return rd;let t=s.state;return t.window&&(t.window=null),s.state=null,tx},one=(s,t)=>{if(mx(s))return rd;const r=s.state;return r.wrap&2?(r.head=t,t.done=!1,tx):rd},lne=(s,t)=>{const r=t.length;let n,a,i;return mx(s)||(n=s.state,n.wrap!==0&&n.mode!==h1)?rd:n.mode===h1&&(a=1,a=XC(a,t,r,0),a!==n.check)?Y7:(i=r$(s,t,r,r),i?(n.mode=X7,J7):(n.havedict=1,tx))};var cne=e$,dne=t$,une=Z7,hne=rne,mne=s$,fne=ane,xne=ine,pne=one,gne=lne,vne="pako inflate (from Nodeca project)",$u={inflateReset:cne,inflateReset2:dne,inflateResetKeep:une,inflateInit:hne,inflateInit2:mne,inflate:fne,inflateEnd:xne,inflateGetHeader:pne,inflateSetDictionary:gne,inflateInfo:vne};function yne(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var jne=yne;const n$=Object.prototype.toString,{Z_NO_FLUSH:bne,Z_FINISH:Nne,Z_OK:ov,Z_STREAM_END:S2,Z_NEED_DICT:C2,Z_STREAM_ERROR:wne,Z_DATA_ERROR:VP,Z_MEM_ERROR:Sne}=V7;function oy(s){this.options=W7.assign({chunkSize:1024*64,windowBits:15,to:""},s||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(s&&s.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new $re,this.strm.avail_out=0;let r=$u.inflateInit2(this.strm,t.windowBits);if(r!==ov)throw new Error(QC[r]);if(this.header=new jne,$u.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=ZC.string2buf(t.dictionary):n$.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=$u.inflateSetDictionary(this.strm,t.dictionary),r!==ov)))throw new Error(QC[r])}oy.prototype.push=function(s,t){const r=this.strm,n=this.options.chunkSize,a=this.options.dictionary;let i,o,l;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?Nne:bne,n$.call(s)==="[object ArrayBuffer]"?r.input=new Uint8Array(s):r.input=s,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),i=$u.inflate(r,o),i===C2&&a&&(i=$u.inflateSetDictionary(r,a),i===ov?i=$u.inflate(r,o):i===VP&&(i=C2));r.avail_in>0&&i===S2&&r.state.wrap>0&&s[r.next_in]!==0;)$u.inflateReset(r),i=$u.inflate(r,o);switch(i){case wne:case VP:case C2:case Sne:return this.onEnd(i),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||i===S2))if(this.options.to==="string"){let c=ZC.utf8border(r.output,r.next_out),d=r.next_out-c,u=ZC.buf2string(r.output,c);r.next_out=d,r.avail_out=n-d,d&&r.output.set(r.output.subarray(c,c+d),0),this.onData(u)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(i===ov&&l===0)){if(i===S2)return i=$u.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};oy.prototype.onData=function(s){this.chunks.push(s)};oy.prototype.onEnd=function(s){s===ov&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=W7.flattenChunks(this.chunks)),this.chunks=[],this.err=s,this.msg=this.strm.msg};function Cne(s,t){const r=new oy(t);if(r.push(s),r.err)throw r.msg||QC[r.err];return r.result}var Ane=oy,Ene=Cne,Ine={Inflate:Ane,inflate:Ene};const{Inflate:Pne,inflate:_ne}=Ine;var WP=Pne,kne=_ne;const a$=[];for(let s=0;s<256;s++){let t=s;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;a$[s]=t}const HP=4294967295;function Tne(s,t,r){let n=s;for(let a=0;a<r;a++)n=a$[(n^t[a])&255]^n>>>8;return n}function Dne(s,t){return(Tne(HP,s,t)^HP)>>>0}function GP(s,t,r){const n=s.readUint32(),a=Dne(new Uint8Array(s.buffer,s.byteOffset+s.offset-t-4,t),t);if(a!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${a}`)}function i$(s,t,r){for(let n=0;n<r;n++)t[n]=s[n]}function o$(s,t,r,n){let a=0;for(;a<n;a++)t[a]=s[a];for(;a<r;a++)t[a]=s[a]+t[a-n]&255}function l$(s,t,r,n){let a=0;if(r.length===0)for(;a<n;a++)t[a]=s[a];else for(;a<n;a++)t[a]=s[a]+r[a]&255}function c$(s,t,r,n,a){let i=0;if(r.length===0){for(;i<a;i++)t[i]=s[i];for(;i<n;i++)t[i]=s[i]+(t[i-a]>>1)&255}else{for(;i<a;i++)t[i]=s[i]+(r[i]>>1)&255;for(;i<n;i++)t[i]=s[i]+(t[i-a]+r[i]>>1)&255}}function d$(s,t,r,n,a){let i=0;if(r.length===0){for(;i<a;i++)t[i]=s[i];for(;i<n;i++)t[i]=s[i]+t[i-a]&255}else{for(;i<a;i++)t[i]=s[i]+r[i]&255;for(;i<n;i++)t[i]=s[i]+One(t[i-a],r[i],r[i-a])&255}}function One(s,t,r){const n=s+t-r,a=Math.abs(n-s),i=Math.abs(n-t),o=Math.abs(n-r);return a<=i&&a<=o?s:i<=o?t:r}function Rne(s,t,r,n,a,i){switch(s){case 0:i$(t,r,a);break;case 1:o$(t,r,a,i);break;case 2:l$(t,r,n,a);break;case 3:c$(t,r,n,a,i);break;case 4:d$(t,r,n,a,i);break;default:throw new Error(`Unsupported filter: ${s}`)}}const Fne=new Uint16Array([255]),Mne=new Uint8Array(Fne.buffer),Lne=Mne[0]===255;function $ne(s){const{data:t,width:r,height:n,channels:a,depth:i}=s,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(i/8)*a,c=new Uint8Array(n*r*l);let d=0;for(let u=0;u<7;u++){const h=o[u],f=Math.ceil((r-h.x)/h.xStep),m=Math.ceil((n-h.y)/h.yStep);if(f<=0||m<=0)continue;const p=f*l,g=new Uint8Array(p);for(let v=0;v<m;v++){const y=t[d++],j=t.subarray(d,d+p);d+=p;const b=new Uint8Array(p);Rne(y,j,b,g,p,l),g.set(b);for(let w=0;w<f;w++){const N=h.x+w*h.xStep,C=h.y+v*h.yStep;if(!(N>=r||C>=n))for(let S=0;S<l;S++)c[(C*r+N)*l+S]=b[w*l+S]}}}if(i===16){const u=new Uint16Array(c.buffer);if(Lne)for(let h=0;h<u.length;h++)u[h]=Bne(u[h]);return u}else return c}function Bne(s){return(s&255)<<8|s>>8&255}const Une=new Uint16Array([255]),zne=new Uint8Array(Une.buffer),qne=zne[0]===255,Vne=new Uint8Array(0);function KP(s){const{data:t,width:r,height:n,channels:a,depth:i}=s,o=Math.ceil(i/8)*a,l=Math.ceil(i/8*a*r),c=new Uint8Array(n*l);let d=Vne,u=0,h,f;for(let m=0;m<n;m++){switch(h=t.subarray(u+1,u+1+l),f=c.subarray(m*l,(m+1)*l),t[u]){case 0:i$(h,f,l);break;case 1:o$(h,f,l,o);break;case 2:l$(h,f,d,l);break;case 3:c$(h,f,d,l,o);break;case 4:d$(h,f,d,l,o);break;default:throw new Error(`Unsupported filter: ${t[u]}`)}d=f,u+=l+1}if(i===16){const m=new Uint16Array(c.buffer);if(qne)for(let p=0;p<m.length;p++)m[p]=Wne(m[p]);return m}else return c}function Wne(s){return(s&255)<<8|s>>8&255}const Uj=Uint8Array.of(137,80,78,71,13,10,26,10);function YP(s){if(!Hne(s.readBytes(Uj.length)))throw new Error("wrong PNG signature")}function Hne(s){if(s.length<Uj.length)return!1;for(let t=0;t<Uj.length;t++)if(s[t]!==Uj[t])return!1;return!0}const Gne="tEXt",Kne=0,u$=new TextDecoder("latin1");function Yne(s){if(Xne(s),s.length===0||s.length>79)throw new Error("keyword length must be between 1 and 79")}const Jne=/^[\u0000-\u00FF]*$/;function Xne(s){if(!Jne.test(s))throw new Error("invalid latin1 text")}function Qne(s,t,r){const n=h$(t);s[n]=Zne(t,r-n.length-1)}function h$(s){for(s.mark();s.readByte()!==Kne;);const t=s.offset;s.reset();const r=u$.decode(s.readBytes(t-s.offset-1));return s.skip(1),Yne(r),r}function Zne(s,t){return u$.decode(s.readBytes(t))}const gc={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},A2={UNKNOWN:-1,DEFLATE:0},JP={UNKNOWN:-1,ADAPTIVE:0},E2={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},aj={NONE:0,BACKGROUND:1,PREVIOUS:2},I2={SOURCE:0,OVER:1};class eae extends i3{constructor(r,n={}){super(r);dn(this,"_checkCrc");dn(this,"_inflator");dn(this,"_png");dn(this,"_apng");dn(this,"_end");dn(this,"_hasPalette");dn(this,"_palette");dn(this,"_hasTransparency");dn(this,"_transparency");dn(this,"_compressionMethod");dn(this,"_filterMethod");dn(this,"_interlaceMethod");dn(this,"_colorType");dn(this,"_isAnimated");dn(this,"_numberOfFrames");dn(this,"_numberOfPlays");dn(this,"_frames");dn(this,"_writingDataChunks");const{checkCrc:a=!1}=n;this._checkCrc=a,this._inflator=new WP,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=A2.UNKNOWN,this._filterMethod=JP.UNKNOWN,this._interlaceMethod=E2.UNKNOWN,this._colorType=gc.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(YP(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(YP(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const a=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case Gne:Qne(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?GP(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const a=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=a+r;break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?GP(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=tae(this.readUint8());const n=this.readUint8();this._colorType=n;let a;switch(n){case gc.GREYSCALE:a=1;break;case gc.TRUECOLOUR:a=3;break;case gc.INDEXED_COLOUR:a=1;break;case gc.GREYSCALE_ALPHA:a=2;break;case gc.TRUECOLOUR_ALPHA:a=4;break;case gc.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==A2.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const a=[];this._palette=a;for(let i=0;i<n;i++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,a=this.offset+this.byteOffset;if(a+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case gc.GREYSCALE:case gc.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case gc.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const a=this.readByte();this._palette[n].push(a)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case gc.UNKNOWN:case gc.GREYSCALE_ALPHA:case gc.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=h$(this),a=this.readUint8();if(a!==A2.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const i=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:kne(i)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),a=this.readByte();this._png.resolution={x:r,y:n,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(r);if(a){if(a.data=KP({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)n.data=a.data;else{const i=this._apng.frames.at(r-1);this.disposeFrame(a,i,n),this.addFrameDataToCanvas(n,a)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,a){switch(r.disposeOp){case aj.NONE:break;case aj.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let o=0;o<this._png.width;o++){const l=(i*r.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)a.data[l+c]=0}break;case aj.PREVIOUS:a.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const a=1<<this._png.depth,i=(o,l)=>{const c=((o+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,d=(o*n.width+l)*this._png.channels;return{index:c,frameIndex:d}};switch(n.blendOp){case I2.SOURCE:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:d}=i(o,l);for(let u=0;u<this._png.channels;u++)r.data[c+u]=n.data[d+u]}break;case I2.OVER:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:d}=i(o,l);for(let u=0;u<this._png.channels;u++){const h=n.data[d+this._png.channels-1]/a,f=u%(this._png.channels-1)===0?1:n.data[d+u],m=Math.floor(h*f+(1-h)*r.data[c+u]);r.data[c+u]+=m}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==JP.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===E2.NO_INTERLACE)this._png.data=KP({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===E2.ADAM7)this._png.data=$ne({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:aj.NONE,blendOp:I2.SOURCE,data:r}),this._inflator=new WP,this._writingDataChunks=!1}}function tae(s){if(s!==1&&s!==2&&s!==4&&s!==8&&s!==16)throw new Error(`invalid bit depth: ${s}`);return s}var XP;(function(s){s[s.UNKNOWN=0]="UNKNOWN",s[s.METRE=1]="METRE"})(XP||(XP={}));function sae(s,t){return new eae(s,t).decode()}var Gr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function P2(){Gr.console&&typeof Gr.console.log=="function"&&Gr.console.log.apply(Gr.console,arguments)}var Ma={log:P2,warn:function(s){Gr.console&&(typeof Gr.console.warn=="function"?Gr.console.warn.apply(Gr.console,arguments):P2.call(null,arguments))},error:function(s){Gr.console&&(typeof Gr.console.error=="function"?Gr.console.error.apply(Gr.console,arguments):P2(s))}};function _2(s,t,r){var n=new XMLHttpRequest;n.open("GET",s),n.responseType="blob",n.onload=function(){df(n.response,t,r)},n.onerror=function(){Ma.error("could not download file")},n.send()}function QP(s){var t=new XMLHttpRequest;t.open("HEAD",s,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function ij(s){try{s.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),s.dispatchEvent(t)}}var df=Gr.saveAs||((typeof window>"u"?"undefined":Na(window))!=="object"||window!==Gr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(s,t,r){var n=Gr.URL||Gr.webkitURL,a=document.createElement("a");t=t||s.name||"download",a.download=t,a.rel="noopener",typeof s=="string"?(a.href=s,a.origin!==location.origin?QP(a.href)?_2(s,t,r):ij(a,a.target="_blank"):ij(a)):(a.href=n.createObjectURL(s),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){ij(a)},0))}:"msSaveOrOpenBlob"in navigator?function(s,t,r){if(t=t||s.name||"download",typeof s=="string")if(QP(s))_2(s,t,r);else{var n=document.createElement("a");n.href=s,n.target="_blank",setTimeout(function(){ij(n)})}else navigator.msSaveOrOpenBlob(function(a,i){return i===void 0?i={autoBom:!1}:Na(i)!=="object"&&(Ma.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(s,r),t)}:function(s,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof s=="string")return _2(s,t,r);var a=s.type==="application/octet-stream",i=/constructor/i.test(Gr.HTMLElement)||Gr.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||a&&i)&&(typeof FileReader>"u"?"undefined":Na(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var u=l.result;u=o?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},l.readAsDataURL(s)}else{var c=Gr.URL||Gr.webkitURL,d=c.createObjectURL(s);n?n.location=d:location.href=d,n=null,setTimeout(function(){c.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function m$(s){var t;s=s||"",this.ok=!1,s.charAt(0)=="#"&&(s=s.substr(1,6)),s={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[s=(s=s.replace(/ /g,"")).toLowerCase()]||s;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,i=r[n].process,o=a.exec(s);o&&(t=i(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),d=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),"#"+l+c+d}}var zj=Gr.atob.bind(Gr),ZP=Gr.btoa.bind(Gr);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function k2(s,t){var r=s[0],n=s[1],a=s[2],i=s[3];r=rl(r,n,a,i,t[0],7,-680876936),i=rl(i,r,n,a,t[1],12,-389564586),a=rl(a,i,r,n,t[2],17,606105819),n=rl(n,a,i,r,t[3],22,-1044525330),r=rl(r,n,a,i,t[4],7,-176418897),i=rl(i,r,n,a,t[5],12,1200080426),a=rl(a,i,r,n,t[6],17,-1473231341),n=rl(n,a,i,r,t[7],22,-45705983),r=rl(r,n,a,i,t[8],7,1770035416),i=rl(i,r,n,a,t[9],12,-1958414417),a=rl(a,i,r,n,t[10],17,-42063),n=rl(n,a,i,r,t[11],22,-1990404162),r=rl(r,n,a,i,t[12],7,1804603682),i=rl(i,r,n,a,t[13],12,-40341101),a=rl(a,i,r,n,t[14],17,-1502002290),r=nl(r,n=rl(n,a,i,r,t[15],22,1236535329),a,i,t[1],5,-165796510),i=nl(i,r,n,a,t[6],9,-1069501632),a=nl(a,i,r,n,t[11],14,643717713),n=nl(n,a,i,r,t[0],20,-373897302),r=nl(r,n,a,i,t[5],5,-701558691),i=nl(i,r,n,a,t[10],9,38016083),a=nl(a,i,r,n,t[15],14,-660478335),n=nl(n,a,i,r,t[4],20,-405537848),r=nl(r,n,a,i,t[9],5,568446438),i=nl(i,r,n,a,t[14],9,-1019803690),a=nl(a,i,r,n,t[3],14,-187363961),n=nl(n,a,i,r,t[8],20,1163531501),r=nl(r,n,a,i,t[13],5,-1444681467),i=nl(i,r,n,a,t[2],9,-51403784),a=nl(a,i,r,n,t[7],14,1735328473),r=al(r,n=nl(n,a,i,r,t[12],20,-1926607734),a,i,t[5],4,-378558),i=al(i,r,n,a,t[8],11,-2022574463),a=al(a,i,r,n,t[11],16,1839030562),n=al(n,a,i,r,t[14],23,-35309556),r=al(r,n,a,i,t[1],4,-1530992060),i=al(i,r,n,a,t[4],11,1272893353),a=al(a,i,r,n,t[7],16,-155497632),n=al(n,a,i,r,t[10],23,-1094730640),r=al(r,n,a,i,t[13],4,681279174),i=al(i,r,n,a,t[0],11,-358537222),a=al(a,i,r,n,t[3],16,-722521979),n=al(n,a,i,r,t[6],23,76029189),r=al(r,n,a,i,t[9],4,-640364487),i=al(i,r,n,a,t[12],11,-421815835),a=al(a,i,r,n,t[15],16,530742520),r=il(r,n=al(n,a,i,r,t[2],23,-995338651),a,i,t[0],6,-198630844),i=il(i,r,n,a,t[7],10,1126891415),a=il(a,i,r,n,t[14],15,-1416354905),n=il(n,a,i,r,t[5],21,-57434055),r=il(r,n,a,i,t[12],6,1700485571),i=il(i,r,n,a,t[3],10,-1894986606),a=il(a,i,r,n,t[10],15,-1051523),n=il(n,a,i,r,t[1],21,-2054922799),r=il(r,n,a,i,t[8],6,1873313359),i=il(i,r,n,a,t[15],10,-30611744),a=il(a,i,r,n,t[6],15,-1560198380),n=il(n,a,i,r,t[13],21,1309151649),r=il(r,n,a,i,t[4],6,-145523070),i=il(i,r,n,a,t[11],10,-1120210379),a=il(a,i,r,n,t[2],15,718787259),n=il(n,a,i,r,t[9],21,-343485551),s[0]=fm(r,s[0]),s[1]=fm(n,s[1]),s[2]=fm(a,s[2]),s[3]=fm(i,s[3])}function pN(s,t,r,n,a,i){return t=fm(fm(t,s),fm(n,i)),fm(t<<a|t>>>32-a,r)}function rl(s,t,r,n,a,i,o){return pN(t&r|~t&n,s,t,a,i,o)}function nl(s,t,r,n,a,i,o){return pN(t&n|r&~n,s,t,a,i,o)}function al(s,t,r,n,a,i,o){return pN(t^r^n,s,t,a,i,o)}function il(s,t,r,n,a,i,o){return pN(r^(t|~n),s,t,a,i,o)}function f$(s){var t,r=s.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=s.length;t+=64)k2(n,rae(s.substring(t-64,t)));s=s.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<s.length;t++)a[t>>2]|=s.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(k2(n,a),t=0;t<16;t++)a[t]=0;return a[14]=8*r,k2(n,a),n}function rae(s){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=s.charCodeAt(t)+(s.charCodeAt(t+1)<<8)+(s.charCodeAt(t+2)<<16)+(s.charCodeAt(t+3)<<24);return r}var e_="0123456789abcdef".split("");function nae(s){for(var t="",r=0;r<4;r++)t+=e_[s>>8*r+4&15]+e_[s>>8*r&15];return t}function aae(s){return String.fromCharCode(255&s,(65280&s)>>8,(16711680&s)>>16,(4278190080&s)>>24)}function e4(s){return f$(s).map(aae).join("")}var iae=function(s){for(var t=0;t<s.length;t++)s[t]=nae(s[t]);return s.join("")}(f$("hello"))!="5d41402abc4b2a76b9719d911017c592";function fm(s,t){if(iae){var r=(65535&s)+(65535&t);return(s>>16)+(t>>16)+(r>>16)<<16|65535&r}return s+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function t4(s,t){var r,n,a,i;if(s!==r){for(var o=(a=s,i=1+(256/s.length|0),new Array(i+1).join(a)),l=[],c=0;c<256;c++)l[c]=c;var d=0;for(c=0;c<256;c++){var u=l[c];d=(d+u+o.charCodeAt(c))%256,l[c]=l[d],l[d]=u}r=s,n=l}else l=n;var h=t.length,f=0,m=0,p="";for(c=0;c<h;c++)m=(m+(u=l[f=(f+1)%256]))%256,l[f]=l[m],l[m]=u,o=l[(l[f]+l[m])%256],p+=String.fromCharCode(t.charCodeAt(c)^o);return p}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var t_={print:4,modify:8,copy:16,"annot-forms":32};function Ux(s,t,r,n){this.v=1,this.r=2;var a=192;s.forEach(function(l){if(t_.perm!==void 0)throw new Error("Invalid permission: "+l);a+=t_[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(t+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,o),this.P=-(1+(255^a)),this.encryptionKey=e4(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=t4(this.encryptionKey,this.padding)}function zx(s){if(/[^\u0000-\u00ff]/.test(s))throw new Error("Invalid PDF Name Object: "+s+", Only accept ASCII characters.");for(var t="",r=s.length,n=0;n<r;n++){var a=s.charCodeAt(n);t+=a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?"#"+("0"+a.toString(16)).slice(-2):s[n]}return t}function s_(s){if(Na(s)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,a){if(a=a||!1,typeof r!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var i=Math.random().toString(35);return t[r][i]=[n,!!a],i},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var i in t[r]){var o=t[r][i];try{o[0].apply(s,n)}catch(l){Gr.console&&Ma.error("jsPDF PubSub Error",l.message,l)}o[1]&&a.push(i)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function lv(s){if(!(this instanceof lv))return new lv(s);var t="opacity,stroke-opacity".split(",");for(var r in s)s.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=s[r]);this.id="",this.objectNumber=-1}function x$(s,t){this.gState=s,this.matrix=t,this.id="",this.objectNumber=-1}function Qh(s,t,r,n,a){if(!(this instanceof Qh))return new Qh(s,t,r,n,a);this.type=s==="axial"?2:3,this.coords=t,this.colors=r,x$.call(this,n,a)}function bf(s,t,r,n,a){if(!(this instanceof bf))return new bf(s,t,r,n,a);this.boundingBox=s,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,x$.call(this,n,a)}function jr(s){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],i=arguments[3],o=[],l=1,c=16,d="S",u=null;Na(s=s||{})==="object"&&(r=s.orientation,n=s.unit||n,a=s.format||a,i=s.compress||s.compressPdf||i,(u=s.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),l=typeof s.userUnit=="number"?Math.abs(s.userUnit):1,s.precision!==void 0&&(t=s.precision),s.floatPrecision!==void 0&&(c=s.floatPrecision),d=s.defaultPathOperation||"S"),o=s.filters||(i===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var h=s.putOnlyUsedFonts||!1,f={},m={internal:{},__private__:{}};m.__private__.PubSub=s_;var p="1.3",g=m.__private__.getPdfVersion=function(){return p};m.__private__.setPdfVersion=function(H){p=H};var v={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return v};var y=m.__private__.getPageFormat=function(H){return v[H]};a=a||"a4";var j="compat",b="advanced",w=j;function N(){this.saveGraphicsState(),le(new Gt(qe,0,0,-qe,0,ds()*qe).toString()+" cm"),this.setFontSize(this.getFontSize()/qe),d="n",w=b}function C(){this.restoreGraphicsState(),d="S",w=j}var S=m.__private__.combineFontStyleAndFontWeight=function(H,Ce){if(H=="bold"&&Ce=="normal"||H=="bold"&&Ce==400||H=="normal"&&Ce=="italic"||H=="bold"&&Ce=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Ce&&(H=Ce==400||Ce==="normal"?H==="italic"?"italic":"normal":Ce!=700&&Ce!=="bold"||H!=="normal"?(Ce==700?"bold":Ce)+""+H:"bold"),H};m.advancedAPI=function(H){var Ce=w===j;return Ce&&N.call(this),typeof H!="function"||(H(this),Ce&&C.call(this)),this},m.compatAPI=function(H){var Ce=w===b;return Ce&&C.call(this),typeof H!="function"||(H(this),Ce&&N.call(this)),this},m.isAdvancedAPI=function(){return w===b};var _,k=function(H){if(w!==b)throw new Error(H+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},F=m.roundToPrecision=m.__private__.roundToPrecision=function(H,Ce){var Ge=t||Ce;if(isNaN(H)||isNaN(Ge))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return H.toFixed(Ge).replace(/0+$/,"")};_=m.hpf=m.__private__.hpf=typeof c=="number"?function(H){if(isNaN(H))throw new Error("Invalid argument passed to jsPDF.hpf");return F(H,c)}:c==="smart"?function(H){if(isNaN(H))throw new Error("Invalid argument passed to jsPDF.hpf");return F(H,H>-1&&H<1?16:5)}:function(H){if(isNaN(H))throw new Error("Invalid argument passed to jsPDF.hpf");return F(H,16)};var A=m.f2=m.__private__.f2=function(H){if(isNaN(H))throw new Error("Invalid argument passed to jsPDF.f2");return F(H,2)},T=m.__private__.f3=function(H){if(isNaN(H))throw new Error("Invalid argument passed to jsPDF.f3");return F(H,3)},V=m.scale=m.__private__.scale=function(H){if(isNaN(H))throw new Error("Invalid argument passed to jsPDF.scale");return w===j?H*qe:w===b?H:void 0},M=function(H){return V(function(Ce){return w===j?ds()-Ce:w===b?Ce:void 0}(H))};m.__private__.setPrecision=m.setPrecision=function(H){typeof parseInt(H,10)=="number"&&(t=parseInt(H,10))};var G,L="00000000000000000000000000000000",J=m.__private__.getFileId=function(){return L},z=m.__private__.setFileId=function(H){return L=H!==void 0&&/^[a-fA-F0-9]{32}$/.test(H)?H.toUpperCase():L.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(cr=new Ux(u.userPermissions,u.userPassword,u.ownerPassword,L)),L};m.setFileId=function(H){return z(H),this},m.getFileId=function(){return J()};var U=m.__private__.convertDateToPDFDate=function(H){var Ce=H.getTimezoneOffset(),Ge=Ce<0?"+":"-",ht=Math.floor(Math.abs(Ce/60)),wt=Math.abs(Ce%60),Qt=[Ge,D(ht),"'",D(wt),"'"].join("");return["D:",H.getFullYear(),D(H.getMonth()+1),D(H.getDate()),D(H.getHours()),D(H.getMinutes()),D(H.getSeconds()),Qt].join("")},oe=m.__private__.convertPDFDateToDate=function(H){var Ce=parseInt(H.substr(2,4),10),Ge=parseInt(H.substr(6,2),10)-1,ht=parseInt(H.substr(8,2),10),wt=parseInt(H.substr(10,2),10),Qt=parseInt(H.substr(12,2),10),vs=parseInt(H.substr(14,2),10);return new Date(Ce,Ge,ht,wt,Qt,vs,0)},Q=m.__private__.setCreationDate=function(H){var Ce;if(H===void 0&&(H=new Date),H instanceof Date)Ce=U(H);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(H))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Ce=H}return G=Ce},P=m.__private__.getCreationDate=function(H){var Ce=G;return H==="jsDate"&&(Ce=oe(G)),Ce};m.setCreationDate=function(H){return Q(H),this},m.getCreationDate=function(H){return P(H)};var q,D=m.__private__.padd2=function(H){return("0"+parseInt(H)).slice(-2)},se=m.__private__.padd2Hex=function(H){return("00"+(H=H.toString())).substr(H.length)},he=0,be=[],pe=[],Ae=0,Ee=[],$e=[],O=!1,te=pe;m.__private__.setCustomOutputDestination=function(H){O=!0,te=H};var re=function(H){O||(te=H)};m.__private__.resetCustomOutputDestination=function(){O=!1,te=pe};var le=m.__private__.out=function(H){return H=H.toString(),Ae+=H.length+1,te.push(H),te},Z=m.__private__.write=function(H){return le(arguments.length===1?H.toString():Array.prototype.join.call(arguments," "))},K=m.__private__.getArrayBuffer=function(H){for(var Ce=H.length,Ge=new ArrayBuffer(Ce),ht=new Uint8Array(Ge);Ce--;)ht[Ce]=H.charCodeAt(Ce);return Ge},X=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return X};var ce=s.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(H){return ce=w===b?H/qe:H,this};var Y,ue=m.__private__.getFontSize=m.getFontSize=function(){return w===j?ce:ce*qe},ve=s.R2L||!1;m.__private__.setR2L=m.setR2L=function(H){return ve=H,this},m.__private__.getR2L=m.getR2L=function(){return ve};var Le,Me=m.__private__.setZoomMode=function(H){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(H))Y=H;else if(isNaN(H)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(H)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+H+'" is not recognized.');Y=H}else Y=parseInt(H,10)};m.__private__.getZoomMode=function(){return Y};var tt,fe=m.__private__.setPageMode=function(H){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(H)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+H+'" is not recognized.');Le=H};m.__private__.getPageMode=function(){return Le};var ct=m.__private__.setLayoutMode=function(H){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(H)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+H+'" is not recognized.');tt=H};m.__private__.getLayoutMode=function(){return tt},m.__private__.setDisplayMode=m.setDisplayMode=function(H,Ce,Ge){return Me(H),ct(Ce),fe(Ge),this};var dt={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(H){if(Object.keys(dt).indexOf(H)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return dt[H]},m.__private__.getDocumentProperties=function(){return dt},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(H){for(var Ce in dt)dt.hasOwnProperty(Ce)&&H[Ce]&&(dt[Ce]=H[Ce]);return this},m.__private__.setDocumentProperty=function(H,Ce){if(Object.keys(dt).indexOf(H)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return dt[H]=Ce};var pt,qe,mt,Rt,_e,Xe={},At={},st=[],$t={},fs={},zt={},St={},js=null,et=0,lt=[],Fe=new s_(m),ft=s.hotfixes||[],He={},Je={},It=[],Gt=function H(Ce,Ge,ht,wt,Qt,vs){if(!(this instanceof H))return new H(Ce,Ge,ht,wt,Qt,vs);isNaN(Ce)&&(Ce=1),isNaN(Ge)&&(Ge=0),isNaN(ht)&&(ht=0),isNaN(wt)&&(wt=1),isNaN(Qt)&&(Qt=0),isNaN(vs)&&(vs=0),this._matrix=[Ce,Ge,ht,wt,Qt,vs]};Object.defineProperty(Gt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(H){this._matrix[0]=H}}),Object.defineProperty(Gt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(H){this._matrix[1]=H}}),Object.defineProperty(Gt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(H){this._matrix[2]=H}}),Object.defineProperty(Gt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(H){this._matrix[3]=H}}),Object.defineProperty(Gt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(H){this._matrix[4]=H}}),Object.defineProperty(Gt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(H){this._matrix[5]=H}}),Object.defineProperty(Gt.prototype,"a",{get:function(){return this._matrix[0]},set:function(H){this._matrix[0]=H}}),Object.defineProperty(Gt.prototype,"b",{get:function(){return this._matrix[1]},set:function(H){this._matrix[1]=H}}),Object.defineProperty(Gt.prototype,"c",{get:function(){return this._matrix[2]},set:function(H){this._matrix[2]=H}}),Object.defineProperty(Gt.prototype,"d",{get:function(){return this._matrix[3]},set:function(H){this._matrix[3]=H}}),Object.defineProperty(Gt.prototype,"e",{get:function(){return this._matrix[4]},set:function(H){this._matrix[4]=H}}),Object.defineProperty(Gt.prototype,"f",{get:function(){return this._matrix[5]},set:function(H){this._matrix[5]=H}}),Object.defineProperty(Gt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Gt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Gt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Gt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Gt.prototype.join=function(H){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(_).join(H)},Gt.prototype.multiply=function(H){var Ce=H.sx*this.sx+H.shy*this.shx,Ge=H.sx*this.shy+H.shy*this.sy,ht=H.shx*this.sx+H.sy*this.shx,wt=H.shx*this.shy+H.sy*this.sy,Qt=H.tx*this.sx+H.ty*this.shx+this.tx,vs=H.tx*this.shy+H.ty*this.sy+this.ty;return new Gt(Ce,Ge,ht,wt,Qt,vs)},Gt.prototype.decompose=function(){var H=this.sx,Ce=this.shy,Ge=this.shx,ht=this.sy,wt=this.tx,Qt=this.ty,vs=Math.sqrt(H*H+Ce*Ce),Js=(H/=vs)*Ge+(Ce/=vs)*ht;Ge-=H*Js,ht-=Ce*Js;var je=Math.sqrt(Ge*Ge+ht*ht);return Js/=je,H*(ht/=je)<Ce*(Ge/=je)&&(H=-H,Ce=-Ce,Js=-Js,vs=-vs),{scale:new Gt(vs,0,0,je,0,0),translate:new Gt(1,0,0,1,wt,Qt),rotate:new Gt(H,Ce,-Ce,H,0,0),skew:new Gt(1,0,Js,1,0,0)}},Gt.prototype.toString=function(H){return this.join(" ")},Gt.prototype.inversed=function(){var H=this.sx,Ce=this.shy,Ge=this.shx,ht=this.sy,wt=this.tx,Qt=this.ty,vs=1/(H*ht-Ce*Ge),Js=ht*vs,je=-Ce*vs,Ot=-Ge*vs,Ds=H*vs;return new Gt(Js,je,Ot,Ds,-Js*wt-Ot*Qt,-je*wt-Ds*Qt)},Gt.prototype.applyToPoint=function(H){var Ce=H.x*this.sx+H.y*this.shx+this.tx,Ge=H.x*this.shy+H.y*this.sy+this.ty;return new qs(Ce,Ge)},Gt.prototype.applyToRectangle=function(H){var Ce=this.applyToPoint(H),Ge=this.applyToPoint(new qs(H.x+H.w,H.y+H.h));return new Sn(Ce.x,Ce.y,Ge.x-Ce.x,Ge.y-Ce.y)},Gt.prototype.clone=function(){var H=this.sx,Ce=this.shy,Ge=this.shx,ht=this.sy,wt=this.tx,Qt=this.ty;return new Gt(H,Ce,Ge,ht,wt,Qt)},m.Matrix=Gt;var qt=m.matrixMult=function(H,Ce){return Ce.multiply(H)},As=new Gt(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=As;var Ht=function(H,Ce){if(!fs[H]){var Ge=(Ce instanceof Qh?"Sh":"P")+(Object.keys($t).length+1).toString(10);Ce.id=Ge,fs[H]=Ge,$t[Ge]=Ce,Fe.publish("addPattern",Ce)}};m.ShadingPattern=Qh,m.TilingPattern=bf,m.addShadingPattern=function(H,Ce){return k("addShadingPattern()"),Ht(H,Ce),this},m.beginTilingPattern=function(H){k("beginTilingPattern()"),Fn(H.boundingBox[0],H.boundingBox[1],H.boundingBox[2]-H.boundingBox[0],H.boundingBox[3]-H.boundingBox[1],H.matrix)},m.endTilingPattern=function(H,Ce){k("endTilingPattern()"),Ce.stream=$e[q].join(`
`),Ht(H,Ce),Fe.publish("endTilingPattern",Ce),It.pop().restore()};var xs,Ct=m.__private__.newObject=function(){var H=ke();return gt(H,!0),H},ke=m.__private__.newObjectDeferred=function(){return he++,be[he]=function(){return Ae},he},gt=function(H,Ce){return Ce=typeof Ce=="boolean"&&Ce,be[H]=Ae,Ce&&le(H+" 0 obj"),H},us=m.__private__.newAdditionalObject=function(){var H={objId:ke(),content:""};return Ee.push(H),H},We=ke(),Et=ke(),Pt=m.__private__.decodeColorString=function(H){var Ce=H.split(" ");if(Ce.length!==2||Ce[1]!=="g"&&Ce[1]!=="G")Ce.length!==5||Ce[4]!=="k"&&Ce[4]!=="K"||(Ce=[(1-Ce[0])*(1-Ce[3]),(1-Ce[1])*(1-Ce[3]),(1-Ce[2])*(1-Ce[3]),"r"]);else{var Ge=parseFloat(Ce[0]);Ce=[Ge,Ge,Ge,"r"]}for(var ht="#",wt=0;wt<3;wt++)ht+=("0"+Math.floor(255*parseFloat(Ce[wt])).toString(16)).slice(-2);return ht},rs=m.__private__.encodeColorString=function(H){var Ce;typeof H=="string"&&(H={ch1:H});var Ge=H.ch1,ht=H.ch2,wt=H.ch3,Qt=H.ch4,vs=H.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Ge=="string"&&Ge.charAt(0)!=="#"){var Js=new m$(Ge);if(Js.ok)Ge=Js.toHex();else if(!/^\d*\.?\d*$/.test(Ge))throw new Error('Invalid color "'+Ge+'" passed to jsPDF.encodeColorString.')}if(typeof Ge=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Ge)&&(Ge="#"+Ge[1]+Ge[1]+Ge[2]+Ge[2]+Ge[3]+Ge[3]),typeof Ge=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Ge)){var je=parseInt(Ge.substr(1),16);Ge=je>>16&255,ht=je>>8&255,wt=255&je}if(ht===void 0||Qt===void 0&&Ge===ht&&ht===wt)Ce=typeof Ge=="string"?Ge+" "+vs[0]:H.precision===2?A(Ge/255)+" "+vs[0]:T(Ge/255)+" "+vs[0];else if(Qt===void 0||Na(Qt)==="object"){if(Qt&&!isNaN(Qt.a)&&Qt.a===0)return["1.","1.","1.",vs[1]].join(" ");Ce=typeof Ge=="string"?[Ge,ht,wt,vs[1]].join(" "):H.precision===2?[A(Ge/255),A(ht/255),A(wt/255),vs[1]].join(" "):[T(Ge/255),T(ht/255),T(wt/255),vs[1]].join(" ")}else Ce=typeof Ge=="string"?[Ge,ht,wt,Qt,vs[2]].join(" "):H.precision===2?[A(Ge),A(ht),A(wt),A(Qt),vs[2]].join(" "):[T(Ge),T(ht),T(wt),T(Qt),vs[2]].join(" ");return Ce},ms=m.__private__.getFilters=function(){return o},Bs=m.__private__.putStream=function(H){var Ce=(H=H||{}).data||"",Ge=H.filters||ms(),ht=H.alreadyAppliedFilters||[],wt=H.addLength1||!1,Qt=Ce.length,vs=H.objectId,Js=function(ri){return ri};if(u!==null&&vs===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(Js=cr.encryptor(vs,0));var je={};Ge===!0&&(Ge=["FlateEncode"]);var Ot=H.additionalKeyValues||[],Ds=(je=jr.API.processDataByFilters!==void 0?jr.API.processDataByFilters(Ce,Ge):{data:Ce,reverseChain:[]}).reverseChain+(Array.isArray(ht)?ht.join(" "):ht.toString());if(je.data.length!==0&&(Ot.push({key:"Length",value:je.data.length}),wt===!0&&Ot.push({key:"Length1",value:Qt})),Ds.length!=0)if(Ds.split("/").length-1==1)Ot.push({key:"Filter",value:Ds});else{Ot.push({key:"Filter",value:"["+Ds+"]"});for(var ar=0;ar<Ot.length;ar+=1)if(Ot[ar].key==="DecodeParms"){for(var cn=[],Va=0;Va<je.reverseChain.split("/").length-1;Va+=1)cn.push("null");cn.push(Ot[ar].value),Ot[ar].value="["+cn.join(" ")+"]"}}le("<<");for(var Wn=0;Wn<Ot.length;Wn++)le("/"+Ot[Wn].key+" "+Ot[Wn].value);le(">>"),je.data.length!==0&&(le("stream"),le(Js(je.data)),le("endstream"))},Vs=m.__private__.putPage=function(H){var Ce=H.number,Ge=H.data,ht=H.objId,wt=H.contentsObjId;gt(ht,!0),le("<</Type /Page"),le("/Parent "+H.rootDictionaryObjId+" 0 R"),le("/Resources "+H.resourceDictionaryObjId+" 0 R"),le("/MediaBox ["+parseFloat(_(H.mediaBox.bottomLeftX))+" "+parseFloat(_(H.mediaBox.bottomLeftY))+" "+_(H.mediaBox.topRightX)+" "+_(H.mediaBox.topRightY)+"]"),H.cropBox!==null&&le("/CropBox ["+_(H.cropBox.bottomLeftX)+" "+_(H.cropBox.bottomLeftY)+" "+_(H.cropBox.topRightX)+" "+_(H.cropBox.topRightY)+"]"),H.bleedBox!==null&&le("/BleedBox ["+_(H.bleedBox.bottomLeftX)+" "+_(H.bleedBox.bottomLeftY)+" "+_(H.bleedBox.topRightX)+" "+_(H.bleedBox.topRightY)+"]"),H.trimBox!==null&&le("/TrimBox ["+_(H.trimBox.bottomLeftX)+" "+_(H.trimBox.bottomLeftY)+" "+_(H.trimBox.topRightX)+" "+_(H.trimBox.topRightY)+"]"),H.artBox!==null&&le("/ArtBox ["+_(H.artBox.bottomLeftX)+" "+_(H.artBox.bottomLeftY)+" "+_(H.artBox.topRightX)+" "+_(H.artBox.topRightY)+"]"),typeof H.userUnit=="number"&&H.userUnit!==1&&le("/UserUnit "+H.userUnit),Fe.publish("putPage",{objId:ht,pageContext:lt[Ce],pageNumber:Ce,page:Ge}),le("/Contents "+wt+" 0 R"),le(">>"),le("endobj");var Qt=Ge.join(`
`);return w===b&&(Qt+=`
Q`),gt(wt,!0),Bs({data:Qt,filters:ms(),objectId:wt}),le("endobj"),ht},Ws=m.__private__.putPages=function(){var H,Ce,Ge=[];for(H=1;H<=et;H++)lt[H].objId=ke(),lt[H].contentsObjId=ke();for(H=1;H<=et;H++)Ge.push(Vs({number:H,data:$e[H],objId:lt[H].objId,contentsObjId:lt[H].contentsObjId,mediaBox:lt[H].mediaBox,cropBox:lt[H].cropBox,bleedBox:lt[H].bleedBox,trimBox:lt[H].trimBox,artBox:lt[H].artBox,userUnit:lt[H].userUnit,rootDictionaryObjId:We,resourceDictionaryObjId:Et}));gt(We,!0),le("<</Type /Pages");var ht="/Kids [";for(Ce=0;Ce<et;Ce++)ht+=Ge[Ce]+" 0 R ";le(ht+"]"),le("/Count "+et),le(">>"),le("endobj"),Fe.publish("postPutPages")},Ns=function(H){Fe.publish("putFont",{font:H,out:le,newObject:Ct,putStream:Bs}),H.isAlreadyPutted!==!0&&(H.objectNumber=Ct(),le("<<"),le("/Type /Font"),le("/BaseFont /"+zx(H.postScriptName)),le("/Subtype /Type1"),typeof H.encoding=="string"&&le("/Encoding /"+H.encoding),le("/FirstChar 32"),le("/LastChar 255"),le(">>"),le("endobj"))},er=function(H){H.objectNumber=Ct();var Ce=[];Ce.push({key:"Type",value:"/XObject"}),Ce.push({key:"Subtype",value:"/Form"}),Ce.push({key:"BBox",value:"["+[_(H.x),_(H.y),_(H.x+H.width),_(H.y+H.height)].join(" ")+"]"}),Ce.push({key:"Matrix",value:"["+H.matrix.toString()+"]"});var Ge=H.pages[1].join(`
`);Bs({data:Ge,additionalKeyValues:Ce,objectId:H.objectNumber}),le("endobj")},Ir=function(H,Ce){Ce||(Ce=21);var Ge=Ct(),ht=function(vs,Js){var je,Ot=[],Ds=1/(Js-1);for(je=0;je<1;je+=Ds)Ot.push(je);if(Ot.push(1),vs[0].offset!=0){var ar={offset:0,color:vs[0].color};vs.unshift(ar)}if(vs[vs.length-1].offset!=1){var cn={offset:1,color:vs[vs.length-1].color};vs.push(cn)}for(var Va="",Wn=0,ri=0;ri<Ot.length;ri++){for(je=Ot[ri];je>vs[Wn+1].offset;)Wn++;var Wa=vs[Wn].offset,vi=(je-Wa)/(vs[Wn+1].offset-Wa),pl=vs[Wn].color,Bl=vs[Wn+1].color;Va+=se(Math.round((1-vi)*pl[0]+vi*Bl[0]).toString(16))+se(Math.round((1-vi)*pl[1]+vi*Bl[1]).toString(16))+se(Math.round((1-vi)*pl[2]+vi*Bl[2]).toString(16))}return Va.trim()}(H.colors,Ce),wt=[];wt.push({key:"FunctionType",value:"0"}),wt.push({key:"Domain",value:"[0.0 1.0]"}),wt.push({key:"Size",value:"["+Ce+"]"}),wt.push({key:"BitsPerSample",value:"8"}),wt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),wt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Bs({data:ht,additionalKeyValues:wt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Ge}),le("endobj"),H.objectNumber=Ct(),le("<< /ShadingType "+H.type),le("/ColorSpace /DeviceRGB");var Qt="/Coords ["+_(parseFloat(H.coords[0]))+" "+_(parseFloat(H.coords[1]))+" ";H.type===2?Qt+=_(parseFloat(H.coords[2]))+" "+_(parseFloat(H.coords[3])):Qt+=_(parseFloat(H.coords[2]))+" "+_(parseFloat(H.coords[3]))+" "+_(parseFloat(H.coords[4]))+" "+_(parseFloat(H.coords[5])),le(Qt+="]"),H.matrix&&le("/Matrix ["+H.matrix.toString()+"]"),le("/Function "+Ge+" 0 R"),le("/Extend [true true]"),le(">>"),le("endobj")},jn=function(H,Ce){var Ge=ke(),ht=Ct();Ce.push({resourcesOid:Ge,objectOid:ht}),H.objectNumber=ht;var wt=[];wt.push({key:"Type",value:"/Pattern"}),wt.push({key:"PatternType",value:"1"}),wt.push({key:"PaintType",value:"1"}),wt.push({key:"TilingType",value:"1"}),wt.push({key:"BBox",value:"["+H.boundingBox.map(_).join(" ")+"]"}),wt.push({key:"XStep",value:_(H.xStep)}),wt.push({key:"YStep",value:_(H.yStep)}),wt.push({key:"Resources",value:Ge+" 0 R"}),H.matrix&&wt.push({key:"Matrix",value:"["+H.matrix.toString()+"]"}),Bs({data:H.stream,additionalKeyValues:wt,objectId:H.objectNumber}),le("endobj")},Hs=function(H){for(var Ce in H.objectNumber=Ct(),le("<<"),H)switch(Ce){case"opacity":le("/ca "+A(H[Ce]));break;case"stroke-opacity":le("/CA "+A(H[Ce]))}le(">>"),le("endobj")},qr=function(H){gt(H.resourcesOid,!0),le("<<"),le("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var Ce in le("/Font <<"),Xe)Xe.hasOwnProperty(Ce)&&(h===!1||h===!0&&f.hasOwnProperty(Ce))&&le("/"+Ce+" "+Xe[Ce].objectNumber+" 0 R");le(">>")}(),function(){if(Object.keys($t).length>0){for(var Ce in le("/Shading <<"),$t)$t.hasOwnProperty(Ce)&&$t[Ce]instanceof Qh&&$t[Ce].objectNumber>=0&&le("/"+Ce+" "+$t[Ce].objectNumber+" 0 R");Fe.publish("putShadingPatternDict"),le(">>")}}(),function(Ce){if(Object.keys($t).length>0){for(var Ge in le("/Pattern <<"),$t)$t.hasOwnProperty(Ge)&&$t[Ge]instanceof m.TilingPattern&&$t[Ge].objectNumber>=0&&$t[Ge].objectNumber<Ce&&le("/"+Ge+" "+$t[Ge].objectNumber+" 0 R");Fe.publish("putTilingPatternDict"),le(">>")}}(H.objectOid),function(){if(Object.keys(zt).length>0){var Ce;for(Ce in le("/ExtGState <<"),zt)zt.hasOwnProperty(Ce)&&zt[Ce].objectNumber>=0&&le("/"+Ce+" "+zt[Ce].objectNumber+" 0 R");Fe.publish("putGStateDict"),le(">>")}}(),function(){for(var Ce in le("/XObject <<"),He)He.hasOwnProperty(Ce)&&He[Ce].objectNumber>=0&&le("/"+Ce+" "+He[Ce].objectNumber+" 0 R");Fe.publish("putXobjectDict"),le(">>")}(),le(">>"),le("endobj")},qn=function(H){At[H.fontName]=At[H.fontName]||{},At[H.fontName][H.fontStyle]=H.id},In=function(H,Ce,Ge,ht,wt){var Qt={id:"F"+(Object.keys(Xe).length+1).toString(10),postScriptName:H,fontName:Ce,fontStyle:Ge,encoding:ht,isStandardFont:wt||!1,metadata:{}};return Fe.publish("addFont",{font:Qt,instance:this}),Xe[Qt.id]=Qt,qn(Qt),Qt.id},Yr=m.__private__.pdfEscape=m.pdfEscape=function(H,Ce){return function(Ge,ht){var wt,Qt,vs,Js,je,Ot,Ds,ar,cn;if(vs=(ht=ht||{}).sourceEncoding||"Unicode",je=ht.outputEncoding,(ht.autoencode||je)&&Xe[pt].metadata&&Xe[pt].metadata[vs]&&Xe[pt].metadata[vs].encoding&&(Js=Xe[pt].metadata[vs].encoding,!je&&Xe[pt].encoding&&(je=Xe[pt].encoding),!je&&Js.codePages&&(je=Js.codePages[0]),typeof je=="string"&&(je=Js[je]),je)){for(Ds=!1,Ot=[],wt=0,Qt=Ge.length;wt<Qt;wt++)(ar=je[Ge.charCodeAt(wt)])?Ot.push(String.fromCharCode(ar)):Ot.push(Ge[wt]),Ot[wt].charCodeAt(0)>>8&&(Ds=!0);Ge=Ot.join("")}for(wt=Ge.length;Ds===void 0&&wt!==0;)Ge.charCodeAt(wt-1)>>8&&(Ds=!0),wt--;if(!Ds)return Ge;for(Ot=ht.noBOM?[]:[254,255],wt=0,Qt=Ge.length;wt<Qt;wt++){if((cn=(ar=Ge.charCodeAt(wt))>>8)>>8)throw new Error("Character at position "+wt+" of string '"+Ge+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Ot.push(cn),Ot.push(ar-(cn<<8))}return String.fromCharCode.apply(void 0,Ot)}(H,Ce).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},$r=m.__private__.beginPage=function(H){$e[++et]=[],lt[et]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(H[0]),topRightY:Number(H[1])}},Vn(et),re($e[q])},Vr=function(H,Ce){var Ge,ht,wt;switch(r=Ce||r,typeof H=="string"&&(Ge=y(H.toLowerCase()),Array.isArray(Ge)&&(ht=Ge[0],wt=Ge[1])),Array.isArray(H)&&(ht=H[0]*qe,wt=H[1]*qe),isNaN(ht)&&(ht=a[0],wt=a[1]),(ht>14400||wt>14400)&&(Ma.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ht=Math.min(14400,ht),wt=Math.min(14400,wt)),a=[ht,wt],r.substr(0,1)){case"l":wt>ht&&(a=[wt,ht]);break;case"p":ht>wt&&(a=[wt,ht])}$r(a),fn(kt),le(zo),Zo!==0&&le(Zo+" J"),el!==0&&le(el+" j"),Fe.publish("addPage",{pageNumber:et})},wn=function(H){H>0&&H<=et&&($e.splice(H,1),lt.splice(H,1),et--,q>et&&(q=et),this.setPage(q))},Vn=function(H){H>0&&H<=et&&(q=H)},De=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return $e.length-1},ut=function(H,Ce,Ge){var ht,wt=void 0;return Ge=Ge||{},H=H!==void 0?H:Xe[pt].fontName,Ce=Ce!==void 0?Ce:Xe[pt].fontStyle,ht=H.toLowerCase(),At[ht]!==void 0&&At[ht][Ce]!==void 0?wt=At[ht][Ce]:At[H]!==void 0&&At[H][Ce]!==void 0?wt=At[H][Ce]:Ge.disableWarning===!1&&Ma.warn("Unable to look up font label for font '"+H+"', '"+Ce+"'. Refer to getFontList() for available fonts."),wt||Ge.noFallback||(wt=At.times[Ce])==null&&(wt=At.times.normal),wt},Pe=m.__private__.putInfo=function(){var H=Ct(),Ce=function(ht){return ht};for(var Ge in u!==null&&(Ce=cr.encryptor(H,0)),le("<<"),le("/Producer ("+Yr(Ce("jsPDF "+jr.version))+")"),dt)dt.hasOwnProperty(Ge)&&dt[Ge]&&le("/"+Ge.substr(0,1).toUpperCase()+Ge.substr(1)+" ("+Yr(Ce(dt[Ge]))+")");le("/CreationDate ("+Yr(Ce(G))+")"),le(">>"),le("endobj")},_t=m.__private__.putCatalog=function(H){var Ce=(H=H||{}).rootDictionaryObjId||We;switch(Ct(),le("<<"),le("/Type /Catalog"),le("/Pages "+Ce+" 0 R"),Y||(Y="fullwidth"),Y){case"fullwidth":le("/OpenAction [3 0 R /FitH null]");break;case"fullheight":le("/OpenAction [3 0 R /FitV null]");break;case"fullpage":le("/OpenAction [3 0 R /Fit]");break;case"original":le("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Ge=""+Y;Ge.substr(Ge.length-1)==="%"&&(Y=parseInt(Y)/100),typeof Y=="number"&&le("/OpenAction [3 0 R /XYZ null null "+A(Y)+"]")}switch(tt||(tt="continuous"),tt){case"continuous":le("/PageLayout /OneColumn");break;case"single":le("/PageLayout /SinglePage");break;case"two":case"twoleft":le("/PageLayout /TwoColumnLeft");break;case"tworight":le("/PageLayout /TwoColumnRight")}Le&&le("/PageMode /"+Le),Fe.publish("putCatalog"),le(">>"),le("endobj")},bt=m.__private__.putTrailer=function(){le("trailer"),le("<<"),le("/Size "+(he+1)),le("/Root "+he+" 0 R"),le("/Info "+(he-1)+" 0 R"),u!==null&&le("/Encrypt "+cr.oid+" 0 R"),le("/ID [ <"+L+"> <"+L+"> ]"),le(">>")},ps=m.__private__.putHeader=function(){le("%PDF-"+p),le("%")},Pr=m.__private__.putXRef=function(){var H="0000000000";le("xref"),le("0 "+(he+1)),le("0000000000 65535 f ");for(var Ce=1;Ce<=he;Ce++)typeof be[Ce]=="function"?le((H+be[Ce]()).slice(-10)+" 00000 n "):be[Ce]!==void 0?le((H+be[Ce]).slice(-10)+" 00000 n "):le("0000000000 00000 n ")},Wr=m.__private__.buildDocument=function(){var H;he=0,Ae=0,pe=[],be=[],Ee=[],We=ke(),Et=ke(),re(pe),Fe.publish("buildDocument"),ps(),Ws(),function(){Fe.publish("putAdditionalObjects");for(var Ge=0;Ge<Ee.length;Ge++){var ht=Ee[Ge];gt(ht.objId,!0),le(ht.content),le("endobj")}Fe.publish("postPutAdditionalObjects")}(),H=[],function(){for(var Ge in Xe)Xe.hasOwnProperty(Ge)&&(h===!1||h===!0&&f.hasOwnProperty(Ge))&&Ns(Xe[Ge])}(),function(){var Ge;for(Ge in zt)zt.hasOwnProperty(Ge)&&Hs(zt[Ge])}(),function(){for(var Ge in He)He.hasOwnProperty(Ge)&&er(He[Ge])}(),function(Ge){var ht;for(ht in $t)$t.hasOwnProperty(ht)&&($t[ht]instanceof Qh?Ir($t[ht]):$t[ht]instanceof bf&&jn($t[ht],Ge))}(H),Fe.publish("putResources"),H.forEach(qr),qr({resourcesOid:Et,objectOid:Number.MAX_SAFE_INTEGER}),Fe.publish("postPutResources"),u!==null&&(cr.oid=Ct(),le("<<"),le("/Filter /Standard"),le("/V "+cr.v),le("/R "+cr.r),le("/U <"+cr.toHexString(cr.U)+">"),le("/O <"+cr.toHexString(cr.O)+">"),le("/P "+cr.P),le(">>"),le("endobj")),Pe(),_t();var Ce=Ae;return Pr(),bt(),le("startxref"),le(""+Ce),le("%%EOF"),re($e[q]),pe.join(`
`)},Zs=m.__private__.getBlob=function(H){return new Blob([K(H)],{type:"application/pdf"})},wr=m.output=m.__private__.output=(xs=function(H,Ce){switch(typeof(Ce=Ce||{})=="string"?Ce={filename:Ce}:Ce.filename=Ce.filename||"generated.pdf",H){case void 0:return Wr();case"save":m.save(Ce.filename);break;case"arraybuffer":return K(Wr());case"blob":return Zs(Wr());case"bloburi":case"bloburl":if(Gr.URL!==void 0&&typeof Gr.URL.createObjectURL=="function")return Gr.URL&&Gr.URL.createObjectURL(Zs(Wr()))||void 0;Ma.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Ge="",ht=Wr();try{Ge=ZP(ht)}catch{Ge=ZP(unescape(encodeURIComponent(ht)))}return"data:application/pdf;filename="+Ce.filename+";base64,"+Ge;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Gr)==="[object Window]"){var wt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Qt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Ce.pdfObjectUrl&&(wt=Ce.pdfObjectUrl,Qt="");var vs='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+wt+'"'+Qt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Ce)+");<\/script></body></html>",Js=Gr.open();return Js!==null&&Js.document.write(vs),Js}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Gr)==="[object Window]"){var je='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Ce.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Ce.filename+'" width="500px" height="400px" /></body></html>',Ot=Gr.open();if(Ot!==null){Ot.document.write(je);var Ds=this;Ot.document.documentElement.querySelector("#pdfViewer").onload=function(){Ot.document.title=Ce.filename,Ot.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Ds.output("bloburl"))}}return Ot}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Gr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var ar='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Ce)+'"></iframe></body></html>',cn=Gr.open();if(cn!==null&&(cn.document.write(ar),cn.document.title=Ce.filename),cn||typeof safari>"u")return cn;break;case"datauri":case"dataurl":return Gr.document.location.href=this.output("datauristring",Ce);default:return null}},xs.foo=function(){try{return xs.apply(this,arguments)}catch(Ge){var H=Ge.stack||"";~H.indexOf(" at ")&&(H=H.split(" at ")[1]);var Ce="Error in function "+H.split(`
`)[0].split("<")[0]+": "+Ge.message;if(!Gr.console)throw new Error(Ce);Gr.console.error(Ce,Ge),Gr.alert&&alert(Ce)}},xs.foo.bar=xs,xs.foo),xa=function(H){return Array.isArray(ft)===!0&&ft.indexOf(H)>-1};switch(n){case"pt":qe=1;break;case"mm":qe=72/25.4;break;case"cm":qe=72/2.54;break;case"in":qe=72;break;case"px":qe=xa("px_scaling")==1?.75:96/72;break;case"pc":case"em":qe=12;break;case"ex":qe=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);qe=n}var cr=null;Q(),z();var Zn=m.__private__.getPageInfo=m.getPageInfo=function(H){if(isNaN(H)||H%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:lt[H].objId,pageNumber:H,pageContext:lt[H]}},Hi=m.__private__.getPageInfoByObjId=function(H){if(isNaN(H)||H%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Ce in lt)if(lt[Ce].objId===H)break;return Zn(Ce)},Gi=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:lt[q].objId,pageNumber:q,pageContext:lt[q]}};m.addPage=function(){return Vr.apply(this,arguments),this},m.setPage=function(){return Vn.apply(this,arguments),re.call(this,$e[q]),this},m.insertPage=function(H){return this.addPage(),this.movePage(q,H),this},m.movePage=function(H,Ce){var Ge,ht;if(H>Ce){Ge=$e[H],ht=lt[H];for(var wt=H;wt>Ce;wt--)$e[wt]=$e[wt-1],lt[wt]=lt[wt-1];$e[Ce]=Ge,lt[Ce]=ht,this.setPage(Ce)}else if(H<Ce){Ge=$e[H],ht=lt[H];for(var Qt=H;Qt<Ce;Qt++)$e[Qt]=$e[Qt+1],lt[Qt]=lt[Qt+1];$e[Ce]=Ge,lt[Ce]=ht,this.setPage(Ce)}return this},m.deletePage=function(){return wn.apply(this,arguments),this},m.__private__.text=m.text=function(H,Ce,Ge,ht,wt){var Qt,vs,Js,je,Ot,Ds,ar,cn,Va,Wn=(ht=ht||{}).scope||this;if(typeof H=="number"&&typeof Ce=="number"&&(typeof Ge=="string"||Array.isArray(Ge))){var ri=Ge;Ge=Ce,Ce=H,H=ri}if(arguments[3]instanceof Gt==0?(Js=arguments[4],je=arguments[5],Na(ar=arguments[3])==="object"&&ar!==null||(typeof Js=="string"&&(je=Js,Js=null),typeof ar=="string"&&(je=ar,ar=null),typeof ar=="number"&&(Js=ar,ar=null),ht={flags:ar,angle:Js,align:je})):(k("The transform parameter of text() with a Matrix value"),Va=wt),isNaN(Ce)||isNaN(Ge)||H==null)throw new Error("Invalid arguments passed to jsPDF.text");if(H.length===0)return Wn;var Wa,vi="",pl=typeof ht.lineHeightFactor=="number"?ht.lineHeightFactor:Jt,Bl=Wn.internal.scaleFactor;function _r(Ga){return Ga=Ga.split("	").join(Array(ht.TabLen||9).join(" ")),Yr(Ga,ar)}function Ha(Ga){for(var Ka,Oi=Ga.concat(),Ri=[],Cu=Oi.length;Cu--;)typeof(Ka=Oi.shift())=="string"?Ri.push(Ka):Array.isArray(Ga)&&(Ka.length===1||Ka[1]===void 0&&Ka[2]===void 0)?Ri.push(Ka[0]):Ri.push([Ka[0],Ka[1],Ka[2]]);return Ri}function io(Ga,Ka){var Oi;if(typeof Ga=="string")Oi=Ka(Ga)[0];else if(Array.isArray(Ga)){for(var Ri,Cu,Cx=Ga.concat(),Vd=[],qg=Cx.length;qg--;)typeof(Ri=Cx.shift())=="string"?Vd.push(Ka(Ri)[0]):Array.isArray(Ri)&&typeof Ri[0]=="string"&&(Cu=Ka(Ri[0],Ri[1],Ri[2]),Vd.push([Cu[0],Cu[1],Cu[2]]));Oi=Vd}return Oi}var ae=!1,Ke=!0;if(typeof H=="string")ae=!0;else if(Array.isArray(H)){var Bt=H.concat();vs=[];for(var Yt,Fs=Bt.length;Fs--;)(typeof(Yt=Bt.shift())!="string"||Array.isArray(Yt)&&typeof Yt[0]!="string")&&(Ke=!1);ae=Ke}if(ae===!1)throw new Error('Type of text must be string or Array. "'+H+'" is not recognized.');typeof H=="string"&&(H=H.match(/[\r?\n]/)?H.split(/\r\n|\r|\n/g):[H]);var zr=ce/Wn.internal.scaleFactor,Ms=zr*(pl-1);switch(ht.baseline){case"bottom":Ge-=Ms;break;case"top":Ge+=zr-Ms;break;case"hanging":Ge+=zr-2*Ms;break;case"middle":Ge+=zr/2-Ms}if((Ds=ht.maxWidth||0)>0&&(typeof H=="string"?H=Wn.splitTextToSize(H,Ds):Object.prototype.toString.call(H)==="[object Array]"&&(H=H.reduce(function(Ga,Ka){return Ga.concat(Wn.splitTextToSize(Ka,Ds))},[]))),Qt={text:H,x:Ce,y:Ge,options:ht,mutex:{pdfEscape:Yr,activeFontKey:pt,fonts:Xe,activeFontSize:ce}},Fe.publish("preProcessText",Qt),H=Qt.text,Js=(ht=Qt.options).angle,Va instanceof Gt==0&&Js&&typeof Js=="number"){Js*=Math.PI/180,ht.rotationDirection===0&&(Js=-Js),w===b&&(Js=-Js);var bn=Math.cos(Js),tl=Math.sin(Js);Va=new Gt(bn,tl,-tl,bn,0,0)}else Js&&Js instanceof Gt&&(Va=Js);w!==b||Va||(Va=As),(Ot=ht.charSpace||qo)!==void 0&&(vi+=_(V(Ot))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(cn=ht.horizontalScale)!==void 0&&(vi+=_(100*cn)+` Tz
`),ht.lang;var wi=-1,Rc=ht.renderingMode!==void 0?ht.renderingMode:ht.stroke,Ul=Wn.internal.getCurrentPageInfo().pageContext;switch(Rc){case 0:case!1:case"fill":wi=0;break;case 1:case!0:case"stroke":wi=1;break;case 2:case"fillThenStroke":wi=2;break;case 3:case"invisible":wi=3;break;case 4:case"fillAndAddForClipping":wi=4;break;case 5:case"strokeAndAddPathForClipping":wi=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":wi=6;break;case 7:case"addToPathForClipping":wi=7}var Mn=Ul.usedRenderingMode!==void 0?Ul.usedRenderingMode:-1;wi!==-1?vi+=wi+` Tr
`:Mn!==-1&&(vi+=`0 Tr
`),wi!==-1&&(Ul.usedRenderingMode=wi),je=ht.align||"left";var Cn,Bn=ce*pl,gl=Wn.internal.pageSize.getWidth(),vl=Xe[pt];Ot=ht.charSpace||qo,Ds=ht.maxWidth||0,ar=Object.assign({autoencode:!0,noBOM:!0},ht.flags);var Vo=[],bx=function(Ga){return Wn.getStringUnitWidth(Ga,{font:vl,charSpace:Ot,fontSize:ce,doKerning:!1})*ce/Bl};if(Object.prototype.toString.call(H)==="[object Array]"){var zl;vs=Ha(H),je!=="left"&&(Cn=vs.map(bx));var ql,Jm=0;if(je==="right"){Ce-=Cn[0],H=[],Fs=vs.length;for(var Bd=0;Bd<Fs;Bd++)Bd===0?(ql=Yi(Ce),zl=Ji(Ge)):(ql=V(Jm-Cn[Bd]),zl=-Bn),H.push([vs[Bd],ql,zl]),Jm=Cn[Bd]}else if(je==="center"){Ce-=Cn[0]/2,H=[],Fs=vs.length;for(var Ah=0;Ah<Fs;Ah++)Ah===0?(ql=Yi(Ce),zl=Ji(Ge)):(ql=V((Jm-Cn[Ah])/2),zl=-Bn),H.push([vs[Ah],ql,zl]),Jm=Cn[Ah]}else if(je==="left"){H=[],Fs=vs.length;for(var Bg=0;Bg<Fs;Bg++)H.push(vs[Bg])}else if(je==="justify"&&vl.encoding==="Identity-H"){H=[],Fs=vs.length,Ds=Ds!==0?Ds:gl;for(var Eh=0,Di=0;Di<Fs;Di++)if(zl=Di===0?Ji(Ge):-Bn,ql=Di===0?Yi(Ce):Eh,Di<Fs-1){var bw=V((Ds-Cn[Di])/(vs[Di].split(" ").length-1)),Ud=vs[Di].split(" ");H.push([Ud[0]+" ",ql,zl]),Eh=0;for(var zd=1;zd<Ud.length;zd++){var Nx=(bx(Ud[zd-1]+" "+Ud[zd])-bx(Ud[zd]))*Bl+bw;zd==Ud.length-1?H.push([Ud[zd],Nx,0]):H.push([Ud[zd]+" ",Nx,0]),Eh-=Nx}}else H.push([vs[Di],ql,zl]);H.push(["",Eh,0])}else{if(je!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(H=[],Fs=vs.length,Ds=Ds!==0?Ds:gl,Di=0;Di<Fs;Di++)zl=Di===0?Ji(Ge):-Bn,ql=Di===0?Yi(Ce):0,Di<Fs-1?Vo.push(_(V((Ds-Cn[Di])/(vs[Di].split(" ").length-1)))):Vo.push(0),H.push([vs[Di],ql,zl])}}(typeof ht.R2L=="boolean"?ht.R2L:ve)===!0&&(H=io(H,function(Ga,Ka,Oi){return[Ga.split("").reverse().join(""),Ka,Oi]})),Qt={text:H,x:Ce,y:Ge,options:ht,mutex:{pdfEscape:Yr,activeFontKey:pt,fonts:Xe,activeFontSize:ce}},Fe.publish("postProcessText",Qt),H=Qt.text,Wa=Qt.mutex.isHex||!1;var Ug=Xe[pt].encoding;Ug!=="WinAnsiEncoding"&&Ug!=="StandardEncoding"||(H=io(H,function(Ga,Ka,Oi){return[_r(Ga),Ka,Oi]})),vs=Ha(H),H=[];for(var wx,Sx,Xm,Qm=Array.isArray(vs[0])?1:0,Su="",zg=function(Ga,Ka,Oi){var Ri="";return Oi instanceof Gt?(Oi=typeof ht.angle=="number"?qt(Oi,new Gt(1,0,0,1,Ga,Ka)):qt(new Gt(1,0,0,1,Ga,Ka),Oi),w===b&&(Oi=qt(new Gt(1,0,0,-1,0,0),Oi)),Ri=Oi.join(" ")+` Tm
`):Ri=_(Ga)+" "+_(Ka)+` Td
`,Ri},dc=0;dc<vs.length;dc++){switch(Su="",Qm){case 1:Xm=(Wa?"<":"(")+vs[dc][0]+(Wa?">":")"),wx=parseFloat(vs[dc][1]),Sx=parseFloat(vs[dc][2]);break;case 0:Xm=(Wa?"<":"(")+vs[dc]+(Wa?">":")"),wx=Yi(Ce),Sx=Ji(Ge)}Vo!==void 0&&Vo[dc]!==void 0&&(Su=Vo[dc]+` Tw
`),dc===0?H.push(Su+zg(wx,Sx,Va)+Xm):Qm===0?H.push(Su+Xm):Qm===1&&H.push(Su+zg(wx,Sx,Va)+Xm)}H=Qm===0?H.join(` Tj
T* `):H.join(` Tj
`),H+=` Tj
`;var qd=`BT
/`;return qd+=pt+" "+ce+` Tf
`,qd+=_(ce*pl)+` TL
`,qd+=Xi+`
`,qd+=vi,qd+=H,le(qd+="ET"),f[pt]=!0,Wn};var Ti=m.__private__.clip=m.clip=function(H){return le(H==="evenodd"?"W*":"W"),this};m.clipEvenOdd=function(){return Ti("evenodd")},m.__private__.discardPath=m.discardPath=function(){return le("n"),this};var Ea=m.__private__.isValidStyle=function(H){var Ce=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(H)!==-1&&(Ce=!0),Ce};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(H){return Ea(H)&&(d=H),this};var Ki=m.__private__.getStyle=m.getStyle=function(H){var Ce=d;switch(H){case"D":case"S":Ce="S";break;case"F":Ce="f";break;case"FD":case"DF":Ce="B";break;case"f":case"f*":case"B":case"B*":Ce=H}return Ce},mi=m.close=function(){return le("h"),this};m.stroke=function(){return le("S"),this},m.fill=function(H){return Da("f",H),this},m.fillEvenOdd=function(H){return Da("f*",H),this},m.fillStroke=function(H){return Da("B",H),this},m.fillStrokeEvenOdd=function(H){return Da("B*",H),this};var Da=function(H,Ce){Na(Ce)==="object"?Ne(Ce,H):le(H)},fi=function(H){H===null||w===b&&H===void 0||(H=Ki(H),le(H))};function qa(H,Ce,Ge,ht,wt){var Qt=new bf(Ce||this.boundingBox,Ge||this.xStep,ht||this.yStep,this.gState,wt||this.matrix);Qt.stream=this.stream;var vs=H+"$$"+this.cloneIndex+++"$$";return Ht(vs,Qt),Qt}var Ne=function(H,Ce){var Ge=fs[H.key],ht=$t[Ge];if(ht instanceof Qh)le("q"),le(Dt(Ce)),ht.gState&&m.setGState(ht.gState),le(H.matrix.toString()+" cm"),le("/"+Ge+" sh"),le("Q");else if(ht instanceof bf){var wt=new Gt(1,0,0,-1,0,ds());H.matrix&&(wt=wt.multiply(H.matrix||As),Ge=qa.call(ht,H.key,H.boundingBox,H.xStep,H.yStep,wt).id),le("q"),le("/Pattern cs"),le("/"+Ge+" scn"),ht.gState&&m.setGState(ht.gState),le(Ce),le("Q")}},Dt=function(H){switch(H){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},ye=m.moveTo=function(H,Ce){return le(_(V(H))+" "+_(M(Ce))+" m"),this},Be=m.lineTo=function(H,Ce){return le(_(V(H))+" "+_(M(Ce))+" l"),this},Ft=m.curveTo=function(H,Ce,Ge,ht,wt,Qt){return le([_(V(H)),_(M(Ce)),_(V(Ge)),_(M(ht)),_(V(wt)),_(M(Qt)),"c"].join(" ")),this};m.__private__.line=m.line=function(H,Ce,Ge,ht,wt){if(isNaN(H)||isNaN(Ce)||isNaN(Ge)||isNaN(ht)||!Ea(wt))throw new Error("Invalid arguments passed to jsPDF.line");return w===j?this.lines([[Ge-H,ht-Ce]],H,Ce,[1,1],wt||"S"):this.lines([[Ge-H,ht-Ce]],H,Ce,[1,1]).stroke()},m.__private__.lines=m.lines=function(H,Ce,Ge,ht,wt,Qt){var vs,Js,je,Ot,Ds,ar,cn,Va,Wn,ri,Wa,vi;if(typeof H=="number"&&(vi=Ge,Ge=Ce,Ce=H,H=vi),ht=ht||[1,1],Qt=Qt||!1,isNaN(Ce)||isNaN(Ge)||!Array.isArray(H)||!Array.isArray(ht)||!Ea(wt)||typeof Qt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(ye(Ce,Ge),vs=ht[0],Js=ht[1],Ot=H.length,ri=Ce,Wa=Ge,je=0;je<Ot;je++)(Ds=H[je]).length===2?(ri=Ds[0]*vs+ri,Wa=Ds[1]*Js+Wa,Be(ri,Wa)):(ar=Ds[0]*vs+ri,cn=Ds[1]*Js+Wa,Va=Ds[2]*vs+ri,Wn=Ds[3]*Js+Wa,ri=Ds[4]*vs+ri,Wa=Ds[5]*Js+Wa,Ft(ar,cn,Va,Wn,ri,Wa));return Qt&&mi(),fi(wt),this},m.path=function(H){for(var Ce=0;Ce<H.length;Ce++){var Ge=H[Ce],ht=Ge.c;switch(Ge.op){case"m":ye(ht[0],ht[1]);break;case"l":Be(ht[0],ht[1]);break;case"c":Ft.apply(this,ht);break;case"h":mi()}}return this},m.__private__.rect=m.rect=function(H,Ce,Ge,ht,wt){if(isNaN(H)||isNaN(Ce)||isNaN(Ge)||isNaN(ht)||!Ea(wt))throw new Error("Invalid arguments passed to jsPDF.rect");return w===j&&(ht=-ht),le([_(V(H)),_(M(Ce)),_(V(Ge)),_(V(ht)),"re"].join(" ")),fi(wt),this},m.__private__.triangle=m.triangle=function(H,Ce,Ge,ht,wt,Qt,vs){if(isNaN(H)||isNaN(Ce)||isNaN(Ge)||isNaN(ht)||isNaN(wt)||isNaN(Qt)||!Ea(vs))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Ge-H,ht-Ce],[wt-Ge,Qt-ht],[H-wt,Ce-Qt]],H,Ce,[1,1],vs,!0),this},m.__private__.roundedRect=m.roundedRect=function(H,Ce,Ge,ht,wt,Qt,vs){if(isNaN(H)||isNaN(Ce)||isNaN(Ge)||isNaN(ht)||isNaN(wt)||isNaN(Qt)||!Ea(vs))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Js=4/3*(Math.SQRT2-1);return wt=Math.min(wt,.5*Ge),Qt=Math.min(Qt,.5*ht),this.lines([[Ge-2*wt,0],[wt*Js,0,wt,Qt-Qt*Js,wt,Qt],[0,ht-2*Qt],[0,Qt*Js,-wt*Js,Qt,-wt,Qt],[2*wt-Ge,0],[-wt*Js,0,-wt,-Qt*Js,-wt,-Qt],[0,2*Qt-ht],[0,-Qt*Js,wt*Js,-Qt,wt,-Qt]],H+wt,Ce,[1,1],vs,!0),this},m.__private__.ellipse=m.ellipse=function(H,Ce,Ge,ht,wt){if(isNaN(H)||isNaN(Ce)||isNaN(Ge)||isNaN(ht)||!Ea(wt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Qt=4/3*(Math.SQRT2-1)*Ge,vs=4/3*(Math.SQRT2-1)*ht;return ye(H+Ge,Ce),Ft(H+Ge,Ce-vs,H+Qt,Ce-ht,H,Ce-ht),Ft(H-Qt,Ce-ht,H-Ge,Ce-vs,H-Ge,Ce),Ft(H-Ge,Ce+vs,H-Qt,Ce+ht,H,Ce+ht),Ft(H+Qt,Ce+ht,H+Ge,Ce+vs,H+Ge,Ce),fi(wt),this},m.__private__.circle=m.circle=function(H,Ce,Ge,ht){if(isNaN(H)||isNaN(Ce)||isNaN(Ge)||!Ea(ht))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(H,Ce,Ge,Ge,ht)},m.setFont=function(H,Ce,Ge){return Ge&&(Ce=S(Ce,Ge)),pt=ut(H,Ce,{disableWarning:!1}),this};var Kt=m.__private__.getFont=m.getFont=function(){return Xe[ut.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var H,Ce,Ge={};for(H in At)if(At.hasOwnProperty(H))for(Ce in Ge[H]=[],At[H])At[H].hasOwnProperty(Ce)&&Ge[H].push(Ce);return Ge},m.addFont=function(H,Ce,Ge,ht,wt){var Qt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Qt.indexOf(arguments[3])!==-1?wt=arguments[3]:arguments[3]&&Qt.indexOf(arguments[3])==-1&&(Ge=S(Ge,ht)),In.call(this,H,Ce,Ge,wt=wt||"Identity-H")};var Jt,kt=s.lineWidth||.200025,gs=m.__private__.getLineWidth=m.getLineWidth=function(){return kt},fn=m.__private__.setLineWidth=m.setLineWidth=function(H){return kt=H,le(_(V(H))+" w"),this};m.__private__.setLineDash=jr.API.setLineDash=jr.API.setLineDashPattern=function(H,Ce){if(H=H||[],Ce=Ce||0,isNaN(Ce)||!Array.isArray(H))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return H=H.map(function(Ge){return _(V(Ge))}).join(" "),Ce=_(V(Ce)),le("["+H+"] "+Ce+" d"),this};var xi=m.__private__.getLineHeight=m.getLineHeight=function(){return ce*Jt};m.__private__.getLineHeight=m.getLineHeight=function(){return ce*Jt};var $n=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(H){return typeof(H=H||1.15)=="number"&&(Jt=H),this},Ur=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return Jt};$n(s.lineHeight);var Yi=m.__private__.getHorizontalCoordinate=function(H){return V(H)},Ji=m.__private__.getVerticalCoordinate=function(H){return w===b?H:lt[q].mediaBox.topRightY-lt[q].mediaBox.bottomLeftY-V(H)},rn=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(H){return _(Yi(H))},Ll=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(H){return _(Ji(H))},zo=s.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return Pt(zo)},m.__private__.setStrokeColor=m.setDrawColor=function(H,Ce,Ge,ht){return zo=rs({ch1:H,ch2:Ce,ch3:Ge,ch4:ht,pdfColorType:"draw",precision:2}),le(zo),this};var Qo=s.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return Pt(Qo)},m.__private__.setFillColor=m.setFillColor=function(H,Ce,Ge,ht){return Qo=rs({ch1:H,ch2:Ce,ch3:Ge,ch4:ht,pdfColorType:"fill",precision:2}),le(Qo),this};var Xi=s.textColor||"0 g",_o=m.__private__.getTextColor=m.getTextColor=function(){return Pt(Xi)};m.__private__.setTextColor=m.setTextColor=function(H,Ce,Ge,ht){return Xi=rs({ch1:H,ch2:Ce,ch3:Ge,ch4:ht,pdfColorType:"text",precision:3}),this};var qo=s.charSpace,$l=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(qo||0)};m.__private__.setCharSpace=m.setCharSpace=function(H){if(isNaN(H))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return qo=H,this};var Zo=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(H){var Ce=m.CapJoinStyles[H];if(Ce===void 0)throw new Error("Line cap style of '"+H+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Zo=Ce,le(Ce+" J"),this};var el=0;m.__private__.setLineJoin=m.setLineJoin=function(H){var Ce=m.CapJoinStyles[H];if(Ce===void 0)throw new Error("Line join style of '"+H+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return el=Ce,le(Ce+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(H){if(H=H||0,isNaN(H))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return le(_(V(H))+" M"),this},m.GState=lv,m.setGState=function(H){(H=typeof H=="string"?zt[St[H]]:ot(null,H)).equals(js)||(le("/"+H.id+" gs"),js=H)};var ot=function(H,Ce){if(!H||!St[H]){var Ge=!1;for(var ht in zt)if(zt.hasOwnProperty(ht)&&zt[ht].equals(Ce)){Ge=!0;break}if(Ge)Ce=zt[ht];else{var wt="GS"+(Object.keys(zt).length+1).toString(10);zt[wt]=Ce,Ce.id=wt}return H&&(St[H]=Ce.id),Fe.publish("addGState",Ce),Ce}};m.addGState=function(H,Ce){return ot(H,Ce),this},m.saveGraphicsState=function(){return le("q"),st.push({key:pt,size:ce,color:Xi}),this},m.restoreGraphicsState=function(){le("Q");var H=st.pop();return pt=H.key,ce=H.size,Xi=H.color,js=null,this},m.setCurrentTransformationMatrix=function(H){return le(H.toString()+" cm"),this},m.comment=function(H){return le("#"+H),this};var qs=function(H,Ce){var Ge=H||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Ge},set:function(Qt){isNaN(Qt)||(Ge=parseFloat(Qt))}});var ht=Ce||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ht},set:function(Qt){isNaN(Qt)||(ht=parseFloat(Qt))}});var wt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return wt},set:function(Qt){wt=Qt.toString()}}),this},Sn=function(H,Ce,Ge,ht){qs.call(this,H,Ce),this.type="rect";var wt=Ge||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return wt},set:function(vs){isNaN(vs)||(wt=parseFloat(vs))}});var Qt=ht||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Qt},set:function(vs){isNaN(vs)||(Qt=parseFloat(vs))}}),this},hr=function(){this.page=et,this.currentPage=q,this.pages=$e.slice(0),this.pagesContext=lt.slice(0),this.x=mt,this.y=Rt,this.matrix=_e,this.width=$(q),this.height=ds(q),this.outputDestination=te,this.id="",this.objectNumber=-1};hr.prototype.restore=function(){et=this.page,q=this.currentPage,lt=this.pagesContext,$e=this.pages,mt=this.x,Rt=this.y,_e=this.matrix,Xt(q,this.width),Us(q,this.height),te=this.outputDestination};var Fn=function(H,Ce,Ge,ht,wt){It.push(new hr),et=q=0,$e=[],mt=H,Rt=Ce,_e=wt,$r([Ge,ht])};for(var Rr in m.beginFormObject=function(H,Ce,Ge,ht,wt){return Fn(H,Ce,Ge,ht,wt),this},m.endFormObject=function(H){return function(Ce){if(Je[Ce])It.pop().restore();else{var Ge=new hr,ht="Xo"+(Object.keys(He).length+1).toString(10);Ge.id=ht,Je[Ce]=ht,He[ht]=Ge,Fe.publish("addFormObject",Ge),It.pop().restore()}}(H),this},m.doFormObject=function(H,Ce){var Ge=He[Je[H]];return le("q"),le(Ce.toString()+" cm"),le("/"+Ge.id+" Do"),le("Q"),this},m.getFormObject=function(H){var Ce=He[Je[H]];return{x:Ce.x,y:Ce.y,width:Ce.width,height:Ce.height,matrix:Ce.matrix}},m.save=function(H,Ce){return H=H||"generated.pdf",(Ce=Ce||{}).returnPromise=Ce.returnPromise||!1,Ce.returnPromise===!1?(df(Zs(Wr()),H),typeof df.unload=="function"&&Gr.setTimeout&&setTimeout(df.unload,911),this):new Promise(function(Ge,ht){try{var wt=df(Zs(Wr()),H);typeof df.unload=="function"&&Gr.setTimeout&&setTimeout(df.unload,911),Ge(wt)}catch(Qt){ht(Qt.message)}})},jr.API)jr.API.hasOwnProperty(Rr)&&(Rr==="events"&&jr.API.events.length?function(H,Ce){var Ge,ht,wt;for(wt=Ce.length-1;wt!==-1;wt--)Ge=Ce[wt][0],ht=Ce[wt][1],H.subscribe.apply(H,[Ge].concat(typeof ht=="function"?[ht]:ht))}(Fe,jr.API.events):m[Rr]=jr.API[Rr]);var $=m.getPageWidth=function(H){return(lt[H=H||q].mediaBox.topRightX-lt[H].mediaBox.bottomLeftX)/qe},Xt=m.setPageWidth=function(H,Ce){lt[H].mediaBox.topRightX=Ce*qe+lt[H].mediaBox.bottomLeftX},ds=m.getPageHeight=function(H){return(lt[H=H||q].mediaBox.topRightY-lt[H].mediaBox.bottomLeftY)/qe},Us=m.setPageHeight=function(H,Ce){lt[H].mediaBox.topRightY=Ce*qe+lt[H].mediaBox.bottomLeftY};return m.internal={pdfEscape:Yr,getStyle:Ki,getFont:Kt,getFontSize:ue,getCharSpace:$l,getTextColor:_o,getLineHeight:xi,getLineHeightFactor:Ur,getLineWidth:gs,write:Z,getHorizontalCoordinate:Yi,getVerticalCoordinate:Ji,getCoordinateString:rn,getVerticalCoordinateString:Ll,collections:{},newObject:Ct,newAdditionalObject:us,newObjectDeferred:ke,newObjectDeferredBegin:gt,getFilters:ms,putStream:Bs,events:Fe,scaleFactor:qe,pageSize:{getWidth:function(){return $(q)},setWidth:function(H){Xt(q,H)},getHeight:function(){return ds(q)},setHeight:function(H){Us(q,H)}},encryptionOptions:u,encryption:cr,getEncryptor:function(H){return u!==null?cr.encryptor(H,0):function(Ce){return Ce}},output:wr,getNumberOfPages:De,pages:$e,out:le,f2:A,f3:T,getPageInfo:Zn,getPageInfoByObjId:Hi,getCurrentPageInfo:Gi,getPDFVersion:g,Point:qs,Rectangle:Sn,Matrix:Gt,hasHotfix:xa},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return $(q)},set:function(H){Xt(q,H)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return ds(q)},set:function(H){Us(q,H)},enumerable:!0,configurable:!0}),(function(H){for(var Ce=0,Ge=X.length;Ce<Ge;Ce++){var ht=In.call(this,H[Ce][0],H[Ce][1],H[Ce][2],X[Ce][3],!0);h===!1&&(f[ht]=!0);var wt=H[Ce][0].split("-");qn({id:ht,fontName:wt[0],fontStyle:wt[1]||""})}Fe.publish("addFonts",{fonts:Xe,dictionary:At})}).call(m,X),pt="F1",Vr(a,r),Fe.publish("initialized"),m}Ux.prototype.lsbFirstWord=function(s){return String.fromCharCode(255&s,s>>8&255,s>>16&255,s>>24&255)},Ux.prototype.toHexString=function(s){return s.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Ux.prototype.hexToBytes=function(s){for(var t=[],r=0;r<s.length;r+=2)t.push(String.fromCharCode(parseInt(s.substr(r,2),16)));return t.join("")},Ux.prototype.processOwnerPassword=function(s,t){return t4(e4(t).substr(0,5),s)},Ux.prototype.encryptor=function(s,t){var r=e4(this.encryptionKey+String.fromCharCode(255&s,s>>8&255,s>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return t4(r,n)}},lv.prototype.equals=function(s){var t,r="id,objectNumber,equals";if(!s||Na(s)!==Na(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!s.hasOwnProperty(t)||this[t]!==s[t])return!1;n++}for(t in s)s.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},jr.API={events:[]},jr.version="3.0.2";var Ei=jr.API,o3=1,fx=function(s){return s.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ix=function(s){return s.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Zr=function(s){return s.toFixed(2)},Lh=function(s){return s.toFixed(5)};Ei.__acroform__={};var oc=function(s,t){s.prototype=Object.create(t.prototype),s.prototype.constructor=s},r_=function(s){return s*o3},Kd=function(s){var t=new g$,r=nr.internal.getHeight(s)||0,n=nr.internal.getWidth(s)||0;return t.BBox=[0,0,Number(Zr(n)),Number(Zr(r))],t},oae=Ei.__acroform__.setBit=function(s,t){if(s=s||0,t=t||0,isNaN(s)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return s|1<<t},lae=Ei.__acroform__.clearBit=function(s,t){if(s=s||0,t=t||0,isNaN(s)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return s&~(1<<t)},cae=Ei.__acroform__.getBit=function(s,t){if(isNaN(s)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return s&1<<t?1:0},Bi=Ei.__acroform__.getBitForPdf=function(s,t){if(isNaN(s)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return cae(s,t-1)},Ui=Ei.__acroform__.setBitForPdf=function(s,t){if(isNaN(s)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return oae(s,t-1)},zi=Ei.__acroform__.clearBitForPdf=function(s,t){if(isNaN(s)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return lae(s,t-1)},dae=Ei.__acroform__.calculateCoordinates=function(s,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,a=s[0],i=s[1],o=s[2],l=s[3],c={};return c.lowerLeft_X=r(a)||0,c.lowerLeft_Y=n(i+l)||0,c.upperRight_X=r(a+o)||0,c.upperRight_Y=n(i)||0,[Number(Zr(c.lowerLeft_X)),Number(Zr(c.lowerLeft_Y)),Number(Zr(c.upperRight_X)),Number(Zr(c.upperRight_Y))]},uae=function(s){if(s.appearanceStreamContent)return s.appearanceStreamContent;if(s.V||s.DV){var t=[],r=s._V||s.DV,n=s4(s,r),a=s.scope.internal.getFont(s.fontName,s.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(s.scope.__private__.encodeColorString(s.color)),t.push("/"+a+" "+Zr(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=Kd(s);return i.scope=s.scope,i.stream=t.join(`
`),i}},s4=function(s,t){var r=s.fontSize===0?s.maxFontSize:s.fontSize,n={text:"",fontSize:""},a=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");a=s.multiline?a.map(function(A){return A.split(`
`)}):a.map(function(A){return[A]});var i=r,o=nr.internal.getHeight(s)||0;o=o<0?-o:o;var l=nr.internal.getWidth(s)||0;l=l<0?-l:l;var c=function(A,T,V){if(A+1<a.length){var M=T+" "+a[A+1][0];return oj(M,s,V).width<=l-4}return!1};i++;e:for(;i>0;){t="",i--;var d,u,h=oj("3",s,i).height,f=s.multiline?o-i:(o-h)/2,m=f+=2,p=0,g=0,v=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+oj(t,s,i=12).width+", FieldWidth:"+l+`
`;break}for(var y="",j=0,b=0;b<a.length;b++)if(a.hasOwnProperty(b)){var w=!1;if(a[b].length!==1&&v!==a[b].length-1){if((h+2)*(j+2)+2>o)continue e;y+=a[b][v],w=!0,g=b,b--}else{y=(y+=a[b][v]+" ").substr(y.length-1)==" "?y.substr(0,y.length-1):y;var N=parseInt(b),C=c(N,y,i),S=b>=a.length-1;if(C&&!S){y+=" ",v=0;continue}if(C||S){if(S)g=N;else if(s.multiline&&(h+2)*(j+2)+2>o)continue e}else{if(!s.multiline||(h+2)*(j+2)+2>o)continue e;g=N}}for(var _="",k=p;k<=g;k++){var F=a[k];if(s.multiline){if(k===g){_+=F[v]+" ",v=(v+1)%F.length;continue}if(k===p){_+=F[F.length-1]+" ";continue}}_+=F[0]+" "}switch(_=_.substr(_.length-1)==" "?_.substr(0,_.length-1):_,u=oj(_,s,i).width,s.textAlign){case"right":d=l-u-2;break;case"center":d=(l-u)/2;break;default:d=2}t+=Zr(d)+" "+Zr(m)+` Td
`,t+="("+fx(_)+`) Tj
`,t+=-Zr(d)+` 0 Td
`,m=-(i+2),u=0,p=w?g:g+1,j++,y=""}break}return n.text=t,n.fontSize=i,n},oj=function(s,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),a=t.scope.getStringUnitWidth(s,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},hae={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},mae=function(s,t){var r={type:"reference",object:s};t.internal.getPageInfo(s.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(s.page).pageContext.annotations.push(r)},fae=function(s,t){if(t.scope=s,s.internal!==void 0&&(s.internal.acroformPlugin===void 0||s.internal.acroformPlugin.isInitialized===!1)){if(Fd.FieldNum=0,s.internal.acroformPlugin=JSON.parse(JSON.stringify(hae)),s.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");o3=s.internal.scaleFactor,s.internal.acroformPlugin.acroFormDictionaryRoot=new v$,s.internal.acroformPlugin.acroFormDictionaryRoot.scope=s,s.internal.acroformPlugin.acroFormDictionaryRoot._eventID=s.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(s)}),s.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var i=n[a];i.objId=void 0,i.hasAnnotation&&mae(i,r)}})(s)}),s.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(s)}),s.internal.events.subscribe("postPutPages",function(r){(function(n,a){var i=!n;for(var o in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],d=l.Rect;if(l.Rect&&(l.Rect=dae(l.Rect,a)),a.internal.newObjectDeferredBegin(l.objId,!0),l.DA=nr.createDefaultAppearanceStream(l),Na(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=d,l.hasAppearanceStream&&!l.appearanceStreamContent){var u=uae(l);c.push({key:"AP",value:"<</N "+u+">>"}),a.internal.acroformPlugin.xForms.push(u)}if(l.appearanceStreamContent){var h="";for(var f in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(f)){var m=l.appearanceStreamContent[f];if(h+="/"+f+" ",h+="<<",Object.keys(m).length>=1||Array.isArray(m)){for(var o in m)if(m.hasOwnProperty(o)){var p=m[o];typeof p=="function"&&(p=p.call(a,l)),h+="/"+o+" "+p+" ",a.internal.acroformPlugin.xForms.indexOf(p)>=0||a.internal.acroformPlugin.xForms.push(p)}}else typeof(p=m)=="function"&&(p=p.call(a,l)),h+="/"+o+" "+p,a.internal.acroformPlugin.xForms.indexOf(p)>=0||a.internal.acroformPlugin.xForms.push(p);h+=">>"}c.push({key:"AP",value:`<<
`+h+">>"})}a.internal.putStream({additionalKeyValues:c,objectId:l.objId}),a.internal.out("endobj")}i&&function(g,v){for(var y in g)if(g.hasOwnProperty(y)){var j=y,b=g[y];v.internal.newObjectDeferredBegin(b.objId,!0),Na(b)==="object"&&typeof b.putStream=="function"&&b.putStream(),delete g[j]}}(a.internal.acroformPlugin.xForms,a)})(r,s)}),s.internal.acroformPlugin.isInitialized=!0}},p$=Ei.__acroform__.arrayToPdfArray=function(s,t,r){var n=function(o){return o};if(Array.isArray(s)){for(var a="[",i=0;i<s.length;i++)switch(i!==0&&(a+=" "),Na(s[i])){case"boolean":case"number":case"object":a+=s[i].toString();break;case"string":s[i].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),a+="("+fx(n(s[i].toString()))+")"):a+=s[i].toString()}return a+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},T2=function(s,t,r){var n=function(a){return a};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(s=s||"").toString(),"("+fx(n(s))+")"},nu=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(s){this._objId=s}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};nu.prototype.toString=function(){return this.objId+" 0 R"},nu.prototype.putStream=function(){var s=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:s,objectId:this.objId}),this.scope.internal.out("endobj")},nu.prototype.getKeyValueListForStream=function(){var s=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],a=this[n];a&&(Array.isArray(a)?s.push({key:n,value:p$(a,this.objId,this.scope)}):a instanceof nu?(a.scope=this.scope,s.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&s.push({key:n,value:a}))}return s};var g$=function(){nu.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var s,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){s=r.trim()},get:function(){return s||null}})};oc(g$,nu);var v$=function(){nu.call(this);var s,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(s){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+fx(r(s))+")"}},set:function(r){s=r}})};oc(v$,nu);var Fd=function s(){nu.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute F supplied.');t=y}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Bi(t,3)},set:function(y){y?this.F=Ui(t,3):this.F=zi(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute Ff supplied.');r=y}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(y){n=y!==void 0?y:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(y){n[0]=y}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(y){n[1]=y}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(y){n[2]=y}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(y){n[3]=y}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(y){switch(y){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=y;break;default:throw new Error('Invalid value "'+y+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof m1)return;i="FieldObject"+s.FieldNum++}var y=function(j){return j};return this.scope&&(y=this.scope.internal.getEncryptor(this.objId)),"("+fx(y(i))+")"},set:function(y){i=y.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(y){i=y}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(y){o=y}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(y){l=y}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(y){c=y}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/o3:d},set:function(y){d=y}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(y){u=y}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof m1||this instanceof Am))return T2(h,this.objId,this.scope)},set:function(y){y=y.toString(),h=y}});var f=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof vo==0?T2(f,this.objId,this.scope):f},set:function(y){y=y.toString(),f=this instanceof vo==0?y.substr(0,1)==="("?Ix(y.substr(1,y.length-2)):Ix(y):y}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof vo==1?Ix(f.substr(1,f.length-1)):f},set:function(y){y=y.toString(),f=this instanceof vo==1?"/"+y:y}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(y){this.V=y}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof vo==0?T2(m,this.objId,this.scope):m},set:function(y){y=y.toString(),m=this instanceof vo==0?y.substr(0,1)==="("?Ix(y.substr(1,y.length-2)):Ix(y):y}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof vo==1?Ix(m.substr(1,m.length-1)):m},set:function(y){y=y.toString(),m=this instanceof vo==1?"/"+y:y}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var p,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(y){y=!!y,g=y}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(p)return p},set:function(y){p=y}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,1)},set:function(y){y?this.Ff=Ui(this.Ff,1):this.Ff=zi(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,2)},set:function(y){y?this.Ff=Ui(this.Ff,2):this.Ff=zi(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,3)},set:function(y){y?this.Ff=Ui(this.Ff,3):this.Ff=zi(this.Ff,3)}});var v=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(v!==null)return v},set:function(y){if([0,1,2].indexOf(y)===-1)throw new Error('Invalid value "'+y+'" for attribute Q supplied.');v=y}}),Object.defineProperty(this,"textAlign",{get:function(){var y;switch(v){case 0:default:y="left";break;case 1:y="center";break;case 2:y="right"}return y},configurable:!0,enumerable:!0,set:function(y){switch(y){case"right":case 2:v=2;break;case"center":case 1:v=1;break;default:v=0}}})};oc(Fd,nu);var $f=function(){Fd.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var s=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return s},set:function(r){s=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return s},set:function(r){s=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return p$(t,this.objId,this.scope)},set:function(r){var n,a;a=[],typeof(n=r)=="string"&&(a=function(i,o,l){l||(l=1);for(var c,d=[];c=o.exec(i);)d.push(c[l]);return d}(n,/\((.*?)\)/g)),t=a}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,18)},set:function(r){r?this.Ff=Ui(this.Ff,18):this.Ff=zi(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Ui(this.Ff,19):this.Ff=zi(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,20)},set:function(r){r?(this.Ff=Ui(this.Ff,20),t.sort()):this.Ff=zi(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,22)},set:function(r){r?this.Ff=Ui(this.Ff,22):this.Ff=zi(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,23)},set:function(r){r?this.Ff=Ui(this.Ff,23):this.Ff=zi(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,27)},set:function(r){r?this.Ff=Ui(this.Ff,27):this.Ff=zi(this.Ff,27)}}),this.hasAppearanceStream=!1};oc($f,Fd);var Bf=function(){$f.call(this),this.fontName="helvetica",this.combo=!1};oc(Bf,$f);var Uf=function(){Bf.call(this),this.combo=!0};oc(Uf,Bf);var R0=function(){Uf.call(this),this.edit=!0};oc(R0,Uf);var vo=function(){Fd.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,15)},set:function(r){r?this.Ff=Ui(this.Ff,15):this.Ff=zi(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,16)},set:function(r){r?this.Ff=Ui(this.Ff,16):this.Ff=zi(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,17)},set:function(r){r?this.Ff=Ui(this.Ff,17):this.Ff=zi(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,26)},set:function(r){r?this.Ff=Ui(this.Ff,26):this.Ff=zi(this.Ff,26)}});var s,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,a=[];for(n in a.push("<<"),t)a.push("/"+n+" ("+fx(r(t[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(r){Na(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return s},set:function(r){s=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return s.substr(1,s.length-1)},set:function(r){s="/"+r}})};oc(vo,Fd);var F0=function(){vo.call(this),this.pushButton=!0};oc(F0,vo);var zf=function(){vo.call(this),this.radio=!0,this.pushButton=!1;var s=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return s},set:function(t){s=t!==void 0?t:[]}})};oc(zf,vo);var m1=function(){var s,t;Fd.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return s},set:function(a){s=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(a){t=a}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(l){return l};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var i,o=[];for(i in o.push("<<"),n)o.push("/"+i+" ("+fx(a(n[i]))+")");return o.push(">>"),o.join(`
`)},set:function(a){Na(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(a){r="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=nr.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};oc(m1,Fd),zf.prototype.setAppearance=function(s){if(!("createAppearanceStream"in s)||!("getCA"in s))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=s.createAppearanceStream(r.optionName),r.caption=s.getCA()}},zf.prototype.createOption=function(s){var t=new m1;return t.Parent=this,t.optionName=s,this.Kids.push(t),xae.call(this.scope,t),t};var M0=function(){vo.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=nr.CheckBox.createAppearanceStream()};oc(M0,vo);var Am=function(){Fd.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,13)},set:function(t){t?this.Ff=Ui(this.Ff,13):this.Ff=zi(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,21)},set:function(t){t?this.Ff=Ui(this.Ff,21):this.Ff=zi(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,23)},set:function(t){t?this.Ff=Ui(this.Ff,23):this.Ff=zi(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,24)},set:function(t){t?this.Ff=Ui(this.Ff,24):this.Ff=zi(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,25)},set:function(t){t?this.Ff=Ui(this.Ff,25):this.Ff=zi(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,26)},set:function(t){t?this.Ff=Ui(this.Ff,26):this.Ff=zi(this.Ff,26)}});var s=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return s},set:function(t){s=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return s},set:function(t){Number.isInteger(t)&&(s=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};oc(Am,Fd);var L0=function(){Am.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Bi(this.Ff,14)},set:function(s){s?this.Ff=Ui(this.Ff,14):this.Ff=zi(this.Ff,14)}}),this.password=!0};oc(L0,Am);var nr={CheckBox:{createAppearanceStream:function(){return{N:{On:nr.CheckBox.YesNormal},D:{On:nr.CheckBox.YesPushDown,Off:nr.CheckBox.OffPushDown}}},YesPushDown:function(s){var t=Kd(s);t.scope=s.scope;var r=[],n=s.scope.internal.getFont(s.fontName,s.fontStyle).id,a=s.scope.__private__.encodeColorString(s.color),i=s4(s,s.caption);return r.push("0.749023 g"),r.push("0 0 "+Zr(nr.internal.getWidth(s))+" "+Zr(nr.internal.getHeight(s))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Zr(i.fontSize)+" Tf "+a),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(s){var t=Kd(s);t.scope=s.scope;var r=s.scope.internal.getFont(s.fontName,s.fontStyle).id,n=s.scope.__private__.encodeColorString(s.color),a=[],i=nr.internal.getHeight(s),o=nr.internal.getWidth(s),l=s4(s,s.caption);return a.push("1 g"),a.push("0 0 "+Zr(o)+" "+Zr(i)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+Zr(o-1)+" "+Zr(i-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+Zr(l.fontSize)+" Tf "+n),a.push(l.text),a.push("ET"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(s){var t=Kd(s);t.scope=s.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Zr(nr.internal.getWidth(s))+" "+Zr(nr.internal.getHeight(s))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(s){var t={D:{Off:nr.RadioButton.Circle.OffPushDown},N:{}};return t.N[s]=nr.RadioButton.Circle.YesNormal,t.D[s]=nr.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(s){var t=Kd(s);t.scope=s.scope;var r=[],n=nr.internal.getWidth(s)<=nr.internal.getHeight(s)?nr.internal.getWidth(s)/4:nr.internal.getHeight(s)/4;n=Number((.9*n).toFixed(5));var a=nr.internal.Bezier_C,i=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Lh(nr.internal.getWidth(s)/2)+" "+Lh(nr.internal.getHeight(s)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(s){var t=Kd(s);t.scope=s.scope;var r=[],n=nr.internal.getWidth(s)<=nr.internal.getHeight(s)?nr.internal.getWidth(s)/4:nr.internal.getHeight(s)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*nr.internal.Bezier_C).toFixed(5)),o=Number((n*nr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Lh(nr.internal.getWidth(s)/2)+" "+Lh(nr.internal.getHeight(s)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Lh(nr.internal.getWidth(s)/2)+" "+Lh(nr.internal.getHeight(s)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(s){var t=Kd(s);t.scope=s.scope;var r=[],n=nr.internal.getWidth(s)<=nr.internal.getHeight(s)?nr.internal.getWidth(s)/4:nr.internal.getHeight(s)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*nr.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Lh(nr.internal.getWidth(s)/2)+" "+Lh(nr.internal.getHeight(s)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(s){var t={D:{Off:nr.RadioButton.Cross.OffPushDown},N:{}};return t.N[s]=nr.RadioButton.Cross.YesNormal,t.D[s]=nr.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(s){var t=Kd(s);t.scope=s.scope;var r=[],n=nr.internal.calculateCross(s);return r.push("q"),r.push("1 1 "+Zr(nr.internal.getWidth(s)-2)+" "+Zr(nr.internal.getHeight(s)-2)+" re"),r.push("W"),r.push("n"),r.push(Zr(n.x1.x)+" "+Zr(n.x1.y)+" m"),r.push(Zr(n.x2.x)+" "+Zr(n.x2.y)+" l"),r.push(Zr(n.x4.x)+" "+Zr(n.x4.y)+" m"),r.push(Zr(n.x3.x)+" "+Zr(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(s){var t=Kd(s);t.scope=s.scope;var r=nr.internal.calculateCross(s),n=[];return n.push("0.749023 g"),n.push("0 0 "+Zr(nr.internal.getWidth(s))+" "+Zr(nr.internal.getHeight(s))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Zr(nr.internal.getWidth(s)-2)+" "+Zr(nr.internal.getHeight(s)-2)+" re"),n.push("W"),n.push("n"),n.push(Zr(r.x1.x)+" "+Zr(r.x1.y)+" m"),n.push(Zr(r.x2.x)+" "+Zr(r.x2.y)+" l"),n.push(Zr(r.x4.x)+" "+Zr(r.x4.y)+" m"),n.push(Zr(r.x3.x)+" "+Zr(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(s){var t=Kd(s);t.scope=s.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Zr(nr.internal.getWidth(s))+" "+Zr(nr.internal.getHeight(s))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(s){var t=s.scope.internal.getFont(s.fontName,s.fontStyle).id,r=s.scope.__private__.encodeColorString(s.color);return"/"+t+" "+s.fontSize+" Tf "+r}};nr.internal={Bezier_C:.551915024494,calculateCross:function(s){var t=nr.internal.getWidth(s),r=nr.internal.getHeight(s),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},nr.internal.getWidth=function(s){var t=0;return Na(s)==="object"&&(t=r_(s.Rect[2])),t},nr.internal.getHeight=function(s){var t=0;return Na(s)==="object"&&(t=r_(s.Rect[3])),t};var xae=Ei.addField=function(s){if(fae(this,s),!(s instanceof Fd))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=s).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),s.page=s.scope.internal.getCurrentPageInfo().pageNumber,this};Ei.AcroFormChoiceField=$f,Ei.AcroFormListBox=Bf,Ei.AcroFormComboBox=Uf,Ei.AcroFormEditBox=R0,Ei.AcroFormButton=vo,Ei.AcroFormPushButton=F0,Ei.AcroFormRadioButton=zf,Ei.AcroFormCheckBox=M0,Ei.AcroFormTextField=Am,Ei.AcroFormPasswordField=L0,Ei.AcroFormAppearance=nr,Ei.AcroForm={ChoiceField:$f,ListBox:Bf,ComboBox:Uf,EditBox:R0,Button:vo,PushButton:F0,RadioButton:zf,CheckBox:M0,TextField:Am,PasswordField:L0,Appearance:nr},jr.AcroForm={ChoiceField:$f,ListBox:Bf,ComboBox:Uf,EditBox:R0,Button:vo,PushButton:F0,RadioButton:zf,CheckBox:M0,TextField:Am,PasswordField:L0,Appearance:nr};var pae=jr.AcroForm;function y$(s){return s.reduce(function(t,r,n){return t[r]=n,t},{})}(function(s){var t="addImage_";s.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=s.__addimage__.getImageFileTypeByImageData=function(A,T){var V,M,G,L,J,z=r;if((T=T||r)==="RGBA"||A.data!==void 0&&A.data instanceof Uint8ClampedArray&&"height"in A&&"width"in A)return"RGBA";if(C(A))for(J in n)for(G=n[J],V=0;V<G.length;V+=1){for(L=!0,M=0;M<G[V].length;M+=1)if(G[V][M]!==void 0&&G[V][M]!==A[M]){L=!1;break}if(L===!0){z=J;break}}else for(J in n)for(G=n[J],V=0;V<G.length;V+=1){for(L=!0,M=0;M<G[V].length;M+=1)if(G[V][M]!==void 0&&G[V][M]!==A.charCodeAt(M)){L=!1;break}if(L===!0){z=J;break}}return z===r&&T!==r&&(z=T),z},i=function A(T){for(var V=this.internal.write,M=this.internal.putStream,G=(0,this.internal.getFilters)();G.indexOf("FlateEncode")!==-1;)G.splice(G.indexOf("FlateEncode"),1);T.objectId=this.internal.newObject();var L=[];if(L.push({key:"Type",value:"/XObject"}),L.push({key:"Subtype",value:"/Image"}),L.push({key:"Width",value:T.width}),L.push({key:"Height",value:T.height}),T.colorSpace===y.INDEXED?L.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(T.palette.length/3-1)+" "+("sMask"in T&&T.sMask!==void 0?T.objectId+2:T.objectId+1)+" 0 R]"}):(L.push({key:"ColorSpace",value:"/"+T.colorSpace}),T.colorSpace===y.DEVICE_CMYK&&L.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),L.push({key:"BitsPerComponent",value:T.bitsPerComponent}),"decodeParameters"in T&&T.decodeParameters!==void 0&&L.push({key:"DecodeParms",value:"<<"+T.decodeParameters+">>"}),"transparency"in T&&Array.isArray(T.transparency)){for(var J="",z=0,U=T.transparency.length;z<U;z++)J+=T.transparency[z]+" "+T.transparency[z]+" ";L.push({key:"Mask",value:"["+J+"]"})}T.sMask!==void 0&&L.push({key:"SMask",value:T.objectId+1+" 0 R"});var oe=T.filter!==void 0?["/"+T.filter]:void 0;if(M({data:T.data,additionalKeyValues:L,alreadyAppliedFilters:oe,objectId:T.objectId}),V("endobj"),"sMask"in T&&T.sMask!==void 0){var Q=(T.predictor!=null?"/Predictor "+T.predictor:"")+" /Colors 1 /BitsPerComponent 8 /Columns "+T.width,P={width:T.width,height:T.height,colorSpace:"DeviceGray",bitsPerComponent:T.bitsPerComponent,decodeParameters:Q,data:T.sMask};"filter"in T&&(P.filter=T.filter),A.call(this,P)}if(T.colorSpace===y.INDEXED){var q=this.internal.newObject();M({data:_(new Uint8Array(T.palette)),objectId:q}),V("endobj")}},o=function(){var A=this.internal.collections[t+"images"];for(var T in A)i.call(this,A[T])},l=function(){var A,T=this.internal.collections[t+"images"],V=this.internal.write;for(var M in T)V("/I"+(A=T[M]).index,A.objectId,"0","R")},c=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},d=function(){var A=this.internal.collections[t+"images"];return c.call(this),A},u=function(){return Object.keys(this.internal.collections[t+"images"]).length},h=function(A){return typeof s["process"+A.toUpperCase()]=="function"},f=function(A){return Na(A)==="object"&&A.nodeType===1},m=function(A,T){if(A.nodeName==="IMG"&&A.hasAttribute("src")){var V=""+A.getAttribute("src");if(V.indexOf("data:image/")===0)return zj(unescape(V).split("base64,").pop());var M=s.loadFile(V,!0);if(M!==void 0)return M}if(A.nodeName==="CANVAS"){if(A.width===0||A.height===0)throw new Error("Given canvas must have data. Canvas width: "+A.width+", height: "+A.height);var G;switch(T){case"PNG":G="image/png";break;case"WEBP":G="image/webp";break;default:G="image/jpeg"}return zj(A.toDataURL(G,1).split("base64,").pop())}},p=function(A){var T=this.internal.collections[t+"images"];if(T){for(var V in T)if(A===T[V].alias)return T[V]}},g=function(A,T,V){return A||T||(A=-96,T=-96),A<0&&(A=-1*V.width*72/A/this.internal.scaleFactor),T<0&&(T=-1*V.height*72/T/this.internal.scaleFactor),A===0&&(A=T*V.width/V.height),T===0&&(T=A*V.height/V.width),[A,T]},v=function(A,T,V,M,G,L){var J=g.call(this,V,M,G),z=this.internal.getCoordinateString,U=this.internal.getVerticalCoordinateString,oe=d.call(this);if(V=J[0],M=J[1],oe[G.index]=G,L){L*=Math.PI/180;var Q=Math.cos(L),P=Math.sin(L),q=function(se){return se.toFixed(4)},D=[q(Q),q(P),q(-1*P),q(Q),0,0,"cm"]}this.internal.write("q"),L?(this.internal.write([1,"0","0",1,z(A),U(T+M),"cm"].join(" ")),this.internal.write(D.join(" ")),this.internal.write([z(V),"0","0",z(M),"0","0","cm"].join(" "))):this.internal.write([z(V),"0","0",z(M),z(A),U(T+M),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+G.index+" Do"),this.internal.write("Q")},y=s.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};s.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var j=s.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=s.__addimage__.sHashCode=function(A){var T,V,M=0;if(typeof A=="string")for(V=A.length,T=0;T<V;T++)M=(M<<5)-M+A.charCodeAt(T),M|=0;else if(C(A))for(V=A.byteLength/2,T=0;T<V;T++)M=(M<<5)-M+A[T],M|=0;return M},w=s.__addimage__.validateStringAsBase64=function(A){(A=A||"").toString().trim();var T=!0;return A.length===0&&(T=!1),A.length%4!=0&&(T=!1),/^[A-Za-z0-9+/]+$/.test(A.substr(0,A.length-2))===!1&&(T=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(A.substr(-2))===!1&&(T=!1),T},N=s.__addimage__.extractImageFromDataUrl=function(A){if(A==null||!(A=A.trim()).startsWith("data:"))return null;var T=A.indexOf(",");return T<0?null:A.substring(0,T).trim().endsWith("base64")?A.substring(T+1):null};s.__addimage__.isArrayBuffer=function(A){return A instanceof ArrayBuffer};var C=s.__addimage__.isArrayBufferView=function(A){return A instanceof Int8Array||A instanceof Uint8Array||A instanceof Uint8ClampedArray||A instanceof Int16Array||A instanceof Uint16Array||A instanceof Int32Array||A instanceof Uint32Array||A instanceof Float32Array||A instanceof Float64Array},S=s.__addimage__.binaryStringToUint8Array=function(A){for(var T=A.length,V=new Uint8Array(T),M=0;M<T;M++)V[M]=A.charCodeAt(M);return V},_=s.__addimage__.arrayBufferToBinaryString=function(A){for(var T="",V=C(A)?A:new Uint8Array(A),M=0;M<V.length;M+=8192)T+=String.fromCharCode.apply(null,V.subarray(M,M+8192));return T};s.addImage=function(){var A,T,V,M,G,L,J,z,U;if(typeof arguments[1]=="number"?(T=r,V=arguments[1],M=arguments[2],G=arguments[3],L=arguments[4],J=arguments[5],z=arguments[6],U=arguments[7]):(T=arguments[1],V=arguments[2],M=arguments[3],G=arguments[4],L=arguments[5],J=arguments[6],z=arguments[7],U=arguments[8]),Na(A=arguments[0])==="object"&&!f(A)&&"imageData"in A){var oe=A;A=oe.imageData,T=oe.format||T||r,V=oe.x||V||0,M=oe.y||M||0,G=oe.w||oe.width||G,L=oe.h||oe.height||L,J=oe.alias||J,z=oe.compression||z,U=oe.rotation||oe.angle||U}var Q=this.internal.getFilters();if(z===void 0&&Q.indexOf("FlateEncode")!==-1&&(z="SLOW"),isNaN(V)||isNaN(M))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var P=k.call(this,A,T,J,z);return v.call(this,V,M,G,L,P,U),this};var k=function(A,T,V,M){var G,L,J;if(typeof A=="string"&&a(A)===r){A=unescape(A);var z=F(A,!1);(z!==""||(z=s.loadFile(A,!0))!==void 0)&&(A=z)}if(f(A)&&(A=m(A,T)),T=a(A,T),!h(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(((J=V)==null||J.length===0)&&(V=function(U){return typeof U=="string"||C(U)?b(U):C(U.data)?b(U.data):null}(A)),(G=p.call(this,V))||(A instanceof Uint8Array||T==="RGBA"||(L=A,A=S(A)),G=this["process"+T.toUpperCase()](A,u.call(this),V,function(U){return U&&typeof U=="string"&&(U=U.toUpperCase()),U in s.image_compression?U:j.NONE}(M),L)),!G)throw new Error("An unknown error occurred whilst processing the image.");return G},F=s.__addimage__.convertBase64ToBinaryString=function(A,T){T=typeof T!="boolean"||T;var V,M="";if(typeof A=="string"){var G;V=(G=N(A))!==null&&G!==void 0?G:A;try{M=zj(V)}catch(L){if(T)throw w(V)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+L.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return M};s.getImageProperties=function(A){var T,V,M="";if(f(A)&&(A=m(A)),typeof A=="string"&&a(A)===r&&((M=F(A,!1))===""&&(M=s.loadFile(A)||""),A=M),V=a(A),!h(V))throw new Error("addImage does not support files of type '"+V+"', please ensure that a plugin for '"+V+"' support is added.");if(A instanceof Uint8Array||(A=S(A)),!(T=this["process"+V.toUpperCase()](A)))throw new Error("An unknown error occurred whilst processing the image");return T.fileType=V,T}})(jr.API),function(s){var t=function(r){if(r!==void 0&&r!="")return!0};jr.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),s.events.push(["putPage",function(r){for(var n,a,i,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),d=r.pageContext.annotations,u=!1,h=0;h<d.length&&!u;h++)switch((n=d[h]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var f=0;f<d.length;f++){n=d[f];var m=this.internal.pdfEscape,p=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),v=this.internal.newAdditionalObject(),y=this.internal.getEncryptor(g.objId),j=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+m(y(n.contents))+")",i+=" /Popup "+v.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+m(y(j))+") >>",g.content=i;var b=g.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+b,n.open&&(i+=" /Open true"),i+=" >>",v.content=i,this.internal.write(g.objId,"0 R",v.objId,"0 R");break;case"freetext":a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var w=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+m(p(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+w+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var N=this.annotations._nameMap[n.options.name];n.options.pageNumber=N.page,n.options.top=N.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+m(p(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;default:var C=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+C+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),s.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},s.link=function(r,n,a,i,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:d(n),w:c(r+a),h:d(n+i)},options:o,type:"link"})},s.textWithLink=function(r,n,a,i){var o,l,c=this.getTextWidth(r),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){l=i.maxWidth;var u=this.splitTextToSize(r,l).length;o=Math.ceil(d*u)}else l=c,o=d;return this.text(r,n,a,i),a+=.2*d,i.align==="center"&&(n-=c/2),i.align==="right"&&(n-=c),this.link(n,a-d,l,o,i),c},s.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(jr.API),function(s){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];s.__arabicParser__={};var i=s.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},o=s.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},l=s.__arabicParser__.isArabicEndLetter=function(g){return o(g)&&i(g)&&t[g.charCodeAt(0)].length<=2},c=s.__arabicParser__.isArabicAlfLetter=function(g){return o(g)&&a.indexOf(g.charCodeAt(0))>=0};s.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return o(g)&&i(g)&&t[g.charCodeAt(0)].length>=1};var d=s.__arabicParser__.arabicLetterHasFinalForm=function(g){return o(g)&&i(g)&&t[g.charCodeAt(0)].length>=2};s.__arabicParser__.arabicLetterHasInitialForm=function(g){return o(g)&&i(g)&&t[g.charCodeAt(0)].length>=3};var u=s.__arabicParser__.arabicLetterHasMedialForm=function(g){return o(g)&&i(g)&&t[g.charCodeAt(0)].length==4},h=s.__arabicParser__.resolveLigatures=function(g){var v=0,y=r,j="",b=0;for(v=0;v<g.length;v+=1)y[g.charCodeAt(v)]!==void 0?(b++,typeof(y=y[g.charCodeAt(v)])=="number"&&(j+=String.fromCharCode(y),y=r,b=0),v===g.length-1&&(y=r,j+=g.charAt(v-(b-1)),v-=b-1,b=0)):(y=r,j+=g.charAt(v-b),v-=b,b=0);return j};s.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var f=s.__arabicParser__.getCorrectForm=function(g,v,y){return o(g)?i(g)===!1?-1:!d(g)||!o(v)&&!o(y)||!o(y)&&l(v)||l(g)&&!o(v)||l(g)&&c(v)||l(g)&&l(v)?0:u(g)&&o(v)&&!l(v)&&o(y)&&d(y)?3:l(g)||!o(y)?1:2:-1},m=function(g){var v=0,y=0,j=0,b="",w="",N="",C=(g=g||"").split("\\s+"),S=[];for(v=0;v<C.length;v+=1){for(S.push(""),y=0;y<C[v].length;y+=1)b=C[v][y],w=C[v][y-1],N=C[v][y+1],o(b)?(j=f(b,w,N),S[v]+=j!==-1?String.fromCharCode(t[b.charCodeAt(0)][j]):b):S[v]+=b;S[v]=h(S[v])}return S.join(" ")},p=s.__arabicParser__.processArabic=s.processArabic=function(){var g,v=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,y=[];if(Array.isArray(v)){var j=0;for(y=[],j=0;j<v.length;j+=1)Array.isArray(v[j])?y.push([m(v[j][0]),v[j][1],v[j][2]]):y.push([m(v[j])]);g=y}else g=m(v);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};s.events.push(["preProcessText",p])}(jr.API),jr.API.autoPrint=function(s){var t;return(s=s||{}).variant=s.variant||"non-conform",s.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(s){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(l){a=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(l){i=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var a;if((r=r||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},s.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(jr.API),function(s){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var h=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var f=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var m=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return m},set:function(g){m=g}});var p=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return p},set:function(g){p=g}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},s.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},s.getTextDimensions=function(c,d){n.call(this);var u=(d=d||{}).fontSize||this.getFontSize(),h=d.font||this.getFont(),f=d.scaleFactor||this.internal.scaleFactor,m=0,p=0,g=0,v=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var y=d.maxWidth;y>0?typeof c=="string"?c=this.splitTextToSize(c,y):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(b,w){return b.concat(v.splitTextToSize(w,y))},[])):c=Array.isArray(c)?c:[c];for(var j=0;j<c.length;j++)m<(g=this.getStringUnitWidth(c[j],{font:h})*u)&&(m=g);return m!==0&&(p=c.length),{w:m/=f,h:Math.max((p*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/f,0)}},s.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=s.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var d=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,h=this.internal.__cell__.margins||t,f=this.internal.__cell__.tableHeaderRow,m=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===c.lineNumber?(c.x=(d.x||0)+(d.width||0),c.y=d.y||0):d.y+d.height+c.height+h.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=h.top,m&&f&&(this.printHeaderRow(c.lineNumber,!0),c.y+=f[0].height)):c.y=d.y+d.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};s.table=function(c,d,u,h,f){if(n.call(this),!u)throw new Error("No data for PDF table.");var m,p,g,v,y=[],j=[],b=[],w={},N={},C=[],S=[],_=(f=f||{}).autoSize||!1,k=f.printHeaders!==!1,F=f.css&&f.css["font-size"]!==void 0?16*f.css["font-size"]:f.fontSize||12,A=f.margins||Object.assign({width:this.getPageWidth()},t),T=typeof f.padding=="number"?f.padding:3,V=f.headerBackgroundColor||"#c8c8c8",M=f.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=k,this.internal.__cell__.margins=A,this.internal.__cell__.table_font_size=F,this.internal.__cell__.padding=T,this.internal.__cell__.headerBackgroundColor=V,this.internal.__cell__.headerTextColor=M,this.setFontSize(F),h==null)j=y=Object.keys(u[0]),b=y.map(function(){return"left"});else if(Array.isArray(h)&&Na(h[0])==="object")for(y=h.map(function(oe){return oe.name}),j=h.map(function(oe){return oe.prompt||oe.name||""}),b=h.map(function(oe){return oe.align||"left"}),m=0;m<h.length;m+=1)N[h[m].name]=.7499990551181103*h[m].width;else Array.isArray(h)&&typeof h[0]=="string"&&(j=y=h,b=y.map(function(){return"left"}));if(_||Array.isArray(h)&&typeof h[0]=="string")for(m=0;m<y.length;m+=1){for(w[v=y[m]]=u.map(function(oe){return oe[v]}),this.setFont(void 0,"bold"),C.push(this.getTextDimensions(j[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),p=w[v],this.setFont(void 0,"normal"),g=0;g<p.length;g+=1)C.push(this.getTextDimensions(p[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);N[v]=Math.max.apply(null,C)+T+T,C=[]}if(k){var G={};for(m=0;m<y.length;m+=1)G[y[m]]={},G[y[m]].text=j[m],G[y[m]].align=b[m];var L=l.call(this,G,N);S=y.map(function(oe){return new i(c,d,N[oe],L,G[oe].text,void 0,G[oe].align)}),this.setTableHeaderRow(S),this.printHeaderRow(1,!1)}var J=h.reduce(function(oe,Q){return oe[Q.name]=Q.align,oe},{});for(m=0;m<u.length;m+=1){"rowStart"in f&&f.rowStart instanceof Function&&f.rowStart({row:m,data:u[m]},this);var z=l.call(this,u[m],N);for(g=0;g<y.length;g+=1){var U=u[m][y[g]];"cellStart"in f&&f.cellStart instanceof Function&&f.cellStart({row:m,col:g,data:U},this),o.call(this,new i(c,d,N[y[g]],z,U,m+2,J[y[g]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=d,this};var l=function(c,d){var u=this.internal.__cell__.padding,h=this.internal.__cell__.table_font_size,f=this.internal.scaleFactor;return Object.keys(c).map(function(m){var p=c[m];return this.splitTextToSize(p.hasOwnProperty("text")?p.text:p,d[m]-u-u)},this).map(function(m){return this.getLineHeightFactor()*m.length*h/f+u+u},this).reduce(function(m,p){return Math.max(m,p)},0)};s.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},s.printHeaderRow=function(c,d){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var h=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(h[0],h[1],h[2],h[3],void 0,-1)}this.setFont(void 0,"bold");for(var f=[],m=0;m<this.internal.__cell__.tableHeaderRow.length;m+=1){u=this.internal.__cell__.tableHeaderRow[m].clone(),d&&(u.y=this.internal.__cell__.margins.top||0,f.push(u)),u.lineNumber=c;var p=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,u),this.setTextColor(p)}f.length>0&&this.setTableHeaderRow(f),this.setFont(void 0,"normal"),r=!1}}(jr.API);var j$={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},b$=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],r4=y$(b$),N$=[100,200,300,400,500,600,700,800,900],gae=y$(N$);function D2(s){var t=s.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return j$[i=i||"normal"]?i:"normal"}(s.style),n=function(i){return i?typeof i=="number"?i>=100&&i<=900&&i%100==0?i:400:/^\d00$/.test(i)?parseInt(i):i==="bold"?700:400:400}(s.weight),a=function(i){return typeof r4[i=i||"normal"]=="number"?i:"normal"}(s.stretch);return{family:t,style:r,weight:n,stretch:a,src:s.src||[],ref:s.ref||{name:t,style:[a,r,n].join(" ")}}}function n_(s,t,r,n){var a;for(a=r;a>=0&&a<t.length;a+=n)if(s[t[a]])return s[t[a]];for(a=r;a>=0&&a<t.length;a-=n)if(s[t[a]])return s[t[a]]}var vae={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},a_={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function i_(s){return[s.stretch,s.style,s.weight,s.family].join(" ")}function o_(s){return s.trimLeft()}function yae(s,t){for(var r=0;r<s.length;){if(s.charAt(r)===t)return[s.substring(0,r),s.substring(r+1)];r+=1}return null}function jae(s){var t=s.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],s.substring(t[0].length)]}var lj,l_,c_,Px,cj,d_,u_,h_,O2=["times"];function m_(s,t,r,n){var a=4,i=x_;switch(n){case jr.API.image_compression.FAST:a=1,i=f_;break;case jr.API.image_compression.MEDIUM:a=6,i=p_;break;case jr.API.image_compression.SLOW:a=9,i=g_}s=function(l,c,d,u){for(var h,f=l.length/c,m=new Uint8Array(l.length+f),p=[bae,f_,x_,p_,g_],g=0;g<f;g+=1){var v=g*c,y=l.subarray(v,v+c);if(u)m.set(u(y,d,h),v+g);else{for(var j=p.length,b=[],w=0;w<j;w+=1)b[w]=p[w](y,d,h);var N=wae(b.concat());m.set(b[N],v+g)}h=y}return m}(s,t,r,i);var o=JC(s,{level:a});return jr.API.__addimage__.arrayBufferToBinaryString(o)}function bae(s){var t=Array.apply([],s);return t.unshift(0),t}function f_(s,t){var r=s.length,n=[];n[0]=1;for(var a=0;a<r;a+=1){var i=s[a-t]||0;n[a+1]=s[a]-i+256&255}return n}function x_(s,t,r){var n=s.length,a=[];a[0]=2;for(var i=0;i<n;i+=1){var o=r&&r[i]||0;a[i+1]=s[i]-o+256&255}return a}function p_(s,t,r){var n=s.length,a=[];a[0]=3;for(var i=0;i<n;i+=1){var o=s[i-t]||0,l=r&&r[i]||0;a[i+1]=s[i]+256-(o+l>>>1)&255}return a}function g_(s,t,r){var n=s.length,a=[];a[0]=4;for(var i=0;i<n;i+=1){var o=Nae(s[i-t]||0,r&&r[i]||0,r&&r[i-t]||0);a[i+1]=s[i]-o+256&255}return a}function Nae(s,t,r){if(s===t&&t===r)return s;var n=Math.abs(t-r),a=Math.abs(s-r),i=Math.abs(s+t-r-r);return n<=a&&n<=i?s:a<=i?t:r}function wae(s){var t=s.map(function(r){return r.reduce(function(n,a){return n+Math.abs(a)},0)});return t.indexOf(Math.min.apply(null,t))}function R2(s,t,r){var n=t*r,a=Math.floor(n/8),i=16-(n-8*a+r),o=(1<<r)-1;return w$(s,a)>>i&o}function v_(s,t,r,n){var a=r*n,i=Math.floor(a/8),o=16-(a-8*i+n),l=(1<<n)-1,c=(t&l)<<o;(function(d,u,h){if(u+1<d.byteLength)d.setUint16(u,h,!1);else{var f=h>>8&255;d.setUint8(u,f)}})(s,i,w$(s,i)&~(l<<o)&65535|c)}function w$(s,t){return t+1<s.byteLength?s.getUint16(t,!1):s.getUint8(t)<<8}function Sae(s){var t=0;if(s[t++]!==71||s[t++]!==73||s[t++]!==70||s[t++]!==56||(s[t++]+1&253)!=56||s[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=s[t++]|s[t++]<<8,n=s[t++]|s[t++]<<8,a=s[t++],i=a>>7,o=1<<1+(7&a);s[t++],s[t++];var l=null,c=null;i&&(l=t,c=o,t+=3*o);var d=!0,u=[],h=0,f=null,m=0,p=null;for(this.width=r,this.height=n;d&&t<s.length;)switch(s[t++]){case 33:switch(s[t++]){case 255:if(s[t]!==11||s[t+1]==78&&s[t+2]==69&&s[t+3]==84&&s[t+4]==83&&s[t+5]==67&&s[t+6]==65&&s[t+7]==80&&s[t+8]==69&&s[t+9]==50&&s[t+10]==46&&s[t+11]==48&&s[t+12]==3&&s[t+13]==1&&s[t+16]==0)t+=14,p=s[t++]|s[t++]<<8,t++;else for(t+=12;;){if(!((A=s[t++])>=0))throw Error("Invalid block size");if(A===0)break;t+=A}break;case 249:if(s[t++]!==4||s[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=s[t++];h=s[t++]|s[t++]<<8,f=s[t++],1&g||(f=null),m=g>>2&7,t++;break;case 254:for(;;){if(!((A=s[t++])>=0))throw Error("Invalid block size");if(A===0)break;t+=A}break;default:throw new Error("Unknown graphic control label: 0x"+s[t-1].toString(16))}break;case 44:var v=s[t++]|s[t++]<<8,y=s[t++]|s[t++]<<8,j=s[t++]|s[t++]<<8,b=s[t++]|s[t++]<<8,w=s[t++],N=w>>6&1,C=1<<1+(7&w),S=l,_=c,k=!1;w>>7&&(k=!0,S=t,_=C,t+=3*C);var F=t;for(t++;;){var A;if(!((A=s[t++])>=0))throw Error("Invalid block size");if(A===0)break;t+=A}u.push({x:v,y,width:j,height:b,has_local_palette:k,palette_offset:S,palette_size:_,data_offset:F,data_length:t-F,transparent_index:f,interlaced:!!N,delay:h,disposal:m});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+s[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return p},this.frameInfo=function(T){if(T<0||T>=u.length)throw new Error("Frame index out of range.");return u[T]},this.decodeAndBlitFrameBGRA=function(T,V){var M=this.frameInfo(T),G=M.width*M.height,L=new Uint8Array(G);y_(s,M.data_offset,L,G);var J=M.palette_offset,z=M.transparent_index;z===null&&(z=256);var U=M.width,oe=r-U,Q=U,P=4*(M.y*r+M.x),q=4*((M.y+M.height)*r+M.x),D=P,se=4*oe;M.interlaced===!0&&(se+=4*r*7);for(var he=8,be=0,pe=L.length;be<pe;++be){var Ae=L[be];if(Q===0&&(Q=U,(D+=se)>=q&&(se=4*oe+4*r*(he-1),D=P+(U+oe)*(he<<1),he>>=1)),Ae===z)D+=4;else{var Ee=s[J+3*Ae],$e=s[J+3*Ae+1],O=s[J+3*Ae+2];V[D++]=O,V[D++]=$e,V[D++]=Ee,V[D++]=255}--Q}},this.decodeAndBlitFrameRGBA=function(T,V){var M=this.frameInfo(T),G=M.width*M.height,L=new Uint8Array(G);y_(s,M.data_offset,L,G);var J=M.palette_offset,z=M.transparent_index;z===null&&(z=256);var U=M.width,oe=r-U,Q=U,P=4*(M.y*r+M.x),q=4*((M.y+M.height)*r+M.x),D=P,se=4*oe;M.interlaced===!0&&(se+=4*r*7);for(var he=8,be=0,pe=L.length;be<pe;++be){var Ae=L[be];if(Q===0&&(Q=U,(D+=se)>=q&&(se=4*oe+4*r*(he-1),D=P+(U+oe)*(he<<1),he>>=1)),Ae===z)D+=4;else{var Ee=s[J+3*Ae],$e=s[J+3*Ae+1],O=s[J+3*Ae+2];V[D++]=Ee,V[D++]=$e,V[D++]=O,V[D++]=255}--Q}}}function y_(s,t,r,n){for(var a=s[t++],i=1<<a,o=i+1,l=o+1,c=a+1,d=(1<<c)-1,u=0,h=0,f=0,m=s[t++],p=new Int32Array(4096),g=null;;){for(;u<16&&m!==0;)h|=s[t++]<<u,u+=8,m===1?m=s[t++]:--m;if(u<c)break;var v=h&d;if(h>>=c,u-=c,v!==i){if(v===o)break;for(var y=v<l?v:g,j=0,b=y;b>i;)b=p[b]>>8,++j;var w=b;if(f+j+(y!==v?1:0)>n)return void Ma.log("Warning, gif stream longer than expected.");r[f++]=w;var N=f+=j;for(y!==v&&(r[f++]=w),b=y;j--;)b=p[b],r[--N]=255&b,b>>=8;g!==null&&l<4096&&(p[l++]=g<<8|w,l>=d+1&&c<12&&(++c,d=d<<1|1)),g=v}else l=o+1,d=(1<<(c=a+1))-1,g=null}return f!==n&&Ma.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function F2(s){var t,r,n,a,i,o=Math.floor,l=new Array(64),c=new Array(64),d=new Array(64),u=new Array(64),h=new Array(65535),f=new Array(65535),m=new Array(64),p=new Array(64),g=[],v=0,y=7,j=new Array(64),b=new Array(64),w=new Array(64),N=new Array(256),C=new Array(2048),S=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],_=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],k=[0,1,2,3,4,5,6,7,8,9,10,11],F=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],A=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],V=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],G=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function L(P,q){for(var D=0,se=0,he=new Array,be=1;be<=16;be++){for(var pe=1;pe<=P[be];pe++)he[q[se]]=[],he[q[se]][0]=D,he[q[se]][1]=be,se++,D++;D*=2}return he}function J(P){for(var q=P[0],D=P[1]-1;D>=0;)q&1<<D&&(v|=1<<y),D--,--y<0&&(v==255?(z(255),z(0)):z(v),y=7,v=0)}function z(P){g.push(P)}function U(P){z(P>>8&255),z(255&P)}function oe(P,q,D,se,he){for(var be,pe=he[0],Ae=he[240],Ee=function(ce,Y){var ue,ve,Le,Me,tt,fe,ct,dt,pt,qe,mt=0;for(pt=0;pt<8;++pt){ue=ce[mt],ve=ce[mt+1],Le=ce[mt+2],Me=ce[mt+3],tt=ce[mt+4],fe=ce[mt+5],ct=ce[mt+6];var Rt=ue+(dt=ce[mt+7]),_e=ue-dt,Xe=ve+ct,At=ve-ct,st=Le+fe,$t=Le-fe,fs=Me+tt,zt=Me-tt,St=Rt+fs,js=Rt-fs,et=Xe+st,lt=Xe-st;ce[mt]=St+et,ce[mt+4]=St-et;var Fe=.707106781*(lt+js);ce[mt+2]=js+Fe,ce[mt+6]=js-Fe;var ft=.382683433*((St=zt+$t)-(lt=At+_e)),He=.5411961*St+ft,Je=1.306562965*lt+ft,It=.707106781*(et=$t+At),Gt=_e+It,qt=_e-It;ce[mt+5]=qt+He,ce[mt+3]=qt-He,ce[mt+1]=Gt+Je,ce[mt+7]=Gt-Je,mt+=8}for(mt=0,pt=0;pt<8;++pt){ue=ce[mt],ve=ce[mt+8],Le=ce[mt+16],Me=ce[mt+24],tt=ce[mt+32],fe=ce[mt+40],ct=ce[mt+48];var As=ue+(dt=ce[mt+56]),Ht=ue-dt,xs=ve+ct,Ct=ve-ct,ke=Le+fe,gt=Le-fe,us=Me+tt,We=Me-tt,Et=As+us,Pt=As-us,rs=xs+ke,ms=xs-ke;ce[mt]=Et+rs,ce[mt+32]=Et-rs;var Bs=.707106781*(ms+Pt);ce[mt+16]=Pt+Bs,ce[mt+48]=Pt-Bs;var Vs=.382683433*((Et=We+gt)-(ms=Ct+Ht)),Ws=.5411961*Et+Vs,Ns=1.306562965*ms+Vs,er=.707106781*(rs=gt+Ct),Ir=Ht+er,jn=Ht-er;ce[mt+40]=jn+Ws,ce[mt+24]=jn-Ws,ce[mt+8]=Ir+Ns,ce[mt+56]=Ir-Ns,mt++}for(pt=0;pt<64;++pt)qe=ce[pt]*Y[pt],m[pt]=qe>0?qe+.5|0:qe-.5|0;return m}(P,q),$e=0;$e<64;++$e)p[S[$e]]=Ee[$e];var O=p[0]-D;D=p[0],O==0?J(se[0]):(J(se[f[be=32767+O]]),J(h[be]));for(var te=63;te>0&&p[te]==0;)te--;if(te==0)return J(pe),D;for(var re,le=1;le<=te;){for(var Z=le;p[le]==0&&le<=te;)++le;var K=le-Z;if(K>=16){re=K>>4;for(var X=1;X<=re;++X)J(Ae);K&=15}be=32767+p[le],J(he[(K<<4)+f[be]]),J(h[be]),le++}return te!=63&&J(pe),D}function Q(P){P=Math.min(Math.max(P,1),100),i!=P&&(function(q){for(var D=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],se=0;se<64;se++){var he=o((D[se]*q+50)/100);he=Math.min(Math.max(he,1),255),l[S[se]]=he}for(var be=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],pe=0;pe<64;pe++){var Ae=o((be[pe]*q+50)/100);Ae=Math.min(Math.max(Ae,1),255),c[S[pe]]=Ae}for(var Ee=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],$e=0,O=0;O<8;O++)for(var te=0;te<8;te++)d[$e]=1/(l[S[$e]]*Ee[O]*Ee[te]*8),u[$e]=1/(c[S[$e]]*Ee[O]*Ee[te]*8),$e++}(P<50?Math.floor(5e3/P):Math.floor(200-2*P)),i=P)}this.encode=function(P,q){q&&Q(q),g=new Array,v=0,y=7,U(65496),U(65504),U(16),z(74),z(70),z(73),z(70),z(0),z(1),z(1),z(0),U(1),U(1),z(0),z(0),function(){U(65499),U(132),z(0);for(var ve=0;ve<64;ve++)z(l[ve]);z(1);for(var Le=0;Le<64;Le++)z(c[Le])}(),function(ve,Le){U(65472),U(17),z(8),U(Le),U(ve),z(3),z(1),z(17),z(0),z(2),z(17),z(1),z(3),z(17),z(1)}(P.width,P.height),function(){U(65476),U(418),z(0);for(var ve=0;ve<16;ve++)z(_[ve+1]);for(var Le=0;Le<=11;Le++)z(k[Le]);z(16);for(var Me=0;Me<16;Me++)z(F[Me+1]);for(var tt=0;tt<=161;tt++)z(A[tt]);z(1);for(var fe=0;fe<16;fe++)z(T[fe+1]);for(var ct=0;ct<=11;ct++)z(V[ct]);z(17);for(var dt=0;dt<16;dt++)z(M[dt+1]);for(var pt=0;pt<=161;pt++)z(G[pt])}(),U(65498),U(12),z(3),z(1),z(0),z(2),z(17),z(3),z(17),z(0),z(63),z(0);var D=0,se=0,he=0;v=0,y=7,this.encode.displayName="_encode_";for(var be,pe,Ae,Ee,$e,O,te,re,le,Z=P.data,K=P.width,X=P.height,ce=4*K,Y=0;Y<X;){for(be=0;be<ce;){for($e=ce*Y+be,te=-1,re=0,le=0;le<64;le++)O=$e+(re=le>>3)*ce+(te=4*(7&le)),Y+re>=X&&(O-=ce*(Y+1+re-X)),be+te>=ce&&(O-=be+te-ce+4),pe=Z[O++],Ae=Z[O++],Ee=Z[O++],j[le]=(C[pe]+C[Ae+256|0]+C[Ee+512|0]>>16)-128,b[le]=(C[pe+768|0]+C[Ae+1024|0]+C[Ee+1280|0]>>16)-128,w[le]=(C[pe+1280|0]+C[Ae+1536|0]+C[Ee+1792|0]>>16)-128;D=oe(j,d,D,t,n),se=oe(b,u,se,r,a),he=oe(w,u,he,r,a),be+=32}Y+=8}if(y>=0){var ue=[];ue[1]=y+1,ue[0]=(1<<y+1)-1,J(ue)}return U(65497),new Uint8Array(g)},s=s||50,function(){for(var P=String.fromCharCode,q=0;q<256;q++)N[q]=P(q)}(),t=L(_,k),r=L(T,V),n=L(F,A),a=L(M,G),function(){for(var P=1,q=2,D=1;D<=15;D++){for(var se=P;se<q;se++)f[32767+se]=D,h[32767+se]=[],h[32767+se][1]=D,h[32767+se][0]=se;for(var he=-(q-1);he<=-P;he++)f[32767+he]=D,h[32767+he]=[],h[32767+he][1]=D,h[32767+he][0]=q-1+he;P<<=1,q<<=1}}(),function(){for(var P=0;P<256;P++)C[P]=19595*P,C[P+256|0]=38470*P,C[P+512|0]=7471*P+32768,C[P+768|0]=-11059*P,C[P+1024|0]=-21709*P,C[P+1280|0]=32768*P+8421375,C[P+1536|0]=-27439*P,C[P+1792|0]=-5329*P}(),Q(s)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function xd(s,t){if(this.pos=0,this.buffer=s,this.datav=new DataView(s.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function j_(s){function t(k){if(!k)throw Error("assert :P")}function r(k,F,A){for(var T=0;4>T;T++)if(k[F+T]!=A.charCodeAt(T))return!0;return!1}function n(k,F,A,T,V){for(var M=0;M<V;M++)k[F+M]=A[T+M]}function a(k,F,A,T){for(var V=0;V<T;V++)k[F+V]=A}function i(k){return new Int32Array(k)}function o(k,F){for(var A=[],T=0;T<k;T++)A.push(new F);return A}function l(k,F){var A=[];return function T(V,M,G){for(var L=G[M],J=0;J<L&&(V.push(G.length>M+1?[]:new F),!(G.length<M+1));J++)T(V[J],M+1,G)}(A,0,k),A}var c=function(){var k=this;function F(E,R){for(var ee=1<<R-1>>>0;E&ee;)ee>>>=1;return ee?(E&ee-1)+ee:E}function A(E,R,ee,me,Ie){t(!(me%ee));do E[R+(me-=ee)]=Ie;while(0<me)}function T(E,R,ee,me,Ie){if(t(2328>=Ie),512>=Ie)var Te=i(512);else if((Te=i(Ie))==null)return 0;return function(Re,Ue,Ve,Qe,jt,Ut){var Ze,Nt,Tt=Ue,os=1<<Ve,Lt=i(16),cs=i(16);for(t(jt!=0),t(Qe!=null),t(Re!=null),t(0<Ve),Nt=0;Nt<jt;++Nt){if(15<Qe[Nt])return 0;++Lt[Qe[Nt]]}if(Lt[0]==jt)return 0;for(cs[1]=0,Ze=1;15>Ze;++Ze){if(Lt[Ze]>1<<Ze)return 0;cs[Ze+1]=cs[Ze]+Lt[Ze]}for(Nt=0;Nt<jt;++Nt)Ze=Qe[Nt],0<Qe[Nt]&&(Ut[cs[Ze]++]=Nt);if(cs[15]==1)return(Qe=new V).g=0,Qe.value=Ut[0],A(Re,Tt,1,os,Qe),os;var hs,Es=-1,ws=os-1,Nr=0,rr=1,xn=1,mr=1<<Ve;for(Nt=0,Ze=1,jt=2;Ze<=Ve;++Ze,jt<<=1){if(rr+=xn<<=1,0>(xn-=Lt[Ze]))return 0;for(;0<Lt[Ze];--Lt[Ze])(Qe=new V).g=Ze,Qe.value=Ut[Nt++],A(Re,Tt+Nr,jt,mr,Qe),Nr=F(Nr,Ze)}for(Ze=Ve+1,jt=2;15>=Ze;++Ze,jt<<=1){if(rr+=xn<<=1,0>(xn-=Lt[Ze]))return 0;for(;0<Lt[Ze];--Lt[Ze]){if(Qe=new V,(Nr&ws)!=Es){for(Tt+=mr,hs=1<<(Es=Ze)-Ve;15>Es&&!(0>=(hs-=Lt[Es]));)++Es,hs<<=1;os+=mr=1<<(hs=Es-Ve),Re[Ue+(Es=Nr&ws)].g=hs+Ve,Re[Ue+Es].value=Tt-Ue-Es}Qe.g=Ze-Ve,Qe.value=Ut[Nt++],A(Re,Tt+(Nr>>Ve),jt,mr,Qe),Nr=F(Nr,Ze)}}return rr!=2*cs[15]-1?0:os}(E,R,ee,me,Ie,Te)}function V(){this.value=this.g=0}function M(){this.value=this.g=0}function G(){this.G=o(5,V),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(Bd,M)}function L(E,R,ee,me){t(E!=null),t(R!=null),t(2147483648>me),E.Ca=254,E.I=0,E.b=-8,E.Ka=0,E.oa=R,E.pa=ee,E.Jd=R,E.Yc=ee+me,E.Zc=4<=me?ee+me-4+1:ee,pe(E)}function J(E,R){for(var ee=0;0<R--;)ee|=Ee(E,128)<<R;return ee}function z(E,R){var ee=J(E,R);return Ae(E)?-ee:ee}function U(E,R,ee,me){var Ie,Te=0;for(t(E!=null),t(R!=null),t(4294967288>me),E.Sb=me,E.Ra=0,E.u=0,E.h=0,4<me&&(me=4),Ie=0;Ie<me;++Ie)Te+=R[ee+Ie]<<8*Ie;E.Ra=Te,E.bb=me,E.oa=R,E.pa=ee}function oe(E){for(;8<=E.u&&E.bb<E.Sb;)E.Ra>>>=8,E.Ra+=E.oa[E.pa+E.bb]<<Eh-8>>>0,++E.bb,E.u-=8;se(E)&&(E.h=1,E.u=0)}function Q(E,R){if(t(0<=R),!E.h&&R<=Bg){var ee=D(E)&Ah[R];return E.u+=R,oe(E),ee}return E.h=1,E.u=0}function P(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function q(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function D(E){return E.Ra>>>(E.u&Eh-1)>>>0}function se(E){return t(E.bb<=E.Sb),E.h||E.bb==E.Sb&&E.u>Eh}function he(E,R){E.u=R,E.h=se(E)}function be(E){E.u>=Di&&(t(E.u>=Di),oe(E))}function pe(E){t(E!=null&&E.oa!=null),E.pa<E.Zc?(E.I=(E.oa[E.pa++]|E.I<<8)>>>0,E.b+=8):(t(E!=null&&E.oa!=null),E.pa<E.Yc?(E.b+=8,E.I=E.oa[E.pa++]|E.I<<8):E.Ka?E.b=0:(E.I<<=8,E.b+=8,E.Ka=1))}function Ae(E){return J(E,1)}function Ee(E,R){var ee=E.Ca;0>E.b&&pe(E);var me=E.b,Ie=ee*R>>>8,Te=(E.I>>>me>Ie)+0;for(Te?(ee-=Ie,E.I-=Ie+1<<me>>>0):ee=Ie+1,me=ee,Ie=0;256<=me;)Ie+=8,me>>=8;return me=7^Ie+bw[me],E.b-=me,E.Ca=(ee<<me)-1,Te}function $e(E,R,ee){E[R+0]=ee>>24&255,E[R+1]=ee>>16&255,E[R+2]=ee>>8&255,E[R+3]=255&ee}function O(E,R){return E[R+0]|E[R+1]<<8}function te(E,R){return O(E,R)|E[R+2]<<16}function re(E,R){return O(E,R)|O(E,R+2)<<16}function le(E,R){var ee=1<<R;return t(E!=null),t(0<R),E.X=i(ee),E.X==null?0:(E.Mb=32-R,E.Xa=R,1)}function Z(E,R){t(E!=null),t(R!=null),t(E.Xa==R.Xa),n(R.X,0,E.X,0,1<<R.Xa)}function K(){this.X=[],this.Xa=this.Mb=0}function X(E,R,ee,me){t(ee!=null),t(me!=null);var Ie=ee[0],Te=me[0];return Ie==0&&(Ie=(E*Te+R/2)/R),Te==0&&(Te=(R*Ie+E/2)/E),0>=Ie||0>=Te?0:(ee[0]=Ie,me[0]=Te,1)}function ce(E,R){return E+(1<<R)-1>>>R}function Y(E,R){return((4278255360&E)+(4278255360&R)>>>0&4278255360)+((16711935&E)+(16711935&R)>>>0&16711935)>>>0}function ue(E,R){k[R]=function(ee,me,Ie,Te,Re,Ue,Ve){var Qe;for(Qe=0;Qe<Re;++Qe){var jt=k[E](Ue[Ve+Qe-1],Ie,Te+Qe);Ue[Ve+Qe]=Y(ee[me+Qe],jt)}}}function ve(){this.ud=this.hd=this.jd=0}function Le(E,R){return((4278124286&(E^R))>>>1)+(E&R)>>>0}function Me(E){return 0<=E&&256>E?E:0>E?0:255<E?255:void 0}function tt(E,R){return Me(E+(E-R+.5>>1))}function fe(E,R,ee){return Math.abs(R-ee)-Math.abs(E-ee)}function ct(E,R,ee,me,Ie,Te,Re){for(me=Te[Re-1],ee=0;ee<Ie;++ee)Te[Re+ee]=me=Y(E[R+ee],me)}function dt(E,R,ee,me,Ie){var Te;for(Te=0;Te<ee;++Te){var Re=E[R+Te],Ue=Re>>8&255,Ve=16711935&(Ve=(Ve=16711935&Re)+((Ue<<16)+Ue));me[Ie+Te]=(4278255360&Re)+Ve>>>0}}function pt(E,R){R.jd=255&E,R.hd=E>>8&255,R.ud=E>>16&255}function qe(E,R,ee,me,Ie,Te){var Re;for(Re=0;Re<me;++Re){var Ue=R[ee+Re],Ve=Ue>>>8,Qe=Ue,jt=255&(jt=(jt=Ue>>>16)+((E.jd<<24>>24)*(Ve<<24>>24)>>>5));Qe=255&(Qe=(Qe+=(E.hd<<24>>24)*(Ve<<24>>24)>>>5)+((E.ud<<24>>24)*(jt<<24>>24)>>>5)),Ie[Te+Re]=(4278255360&Ue)+(jt<<16)+Qe}}function mt(E,R,ee,me,Ie){k[R]=function(Te,Re,Ue,Ve,Qe,jt,Ut,Ze,Nt){for(Ve=Ut;Ve<Ze;++Ve)for(Ut=0;Ut<Nt;++Ut)Qe[jt++]=Ie(Ue[me(Te[Re++])])},k[E]=function(Te,Re,Ue,Ve,Qe,jt,Ut){var Ze=8>>Te.b,Nt=Te.Ea,Tt=Te.K[0],os=Te.w;if(8>Ze)for(Te=(1<<Te.b)-1,os=(1<<Ze)-1;Re<Ue;++Re){var Lt,cs=0;for(Lt=0;Lt<Nt;++Lt)Lt&Te||(cs=me(Ve[Qe++])),jt[Ut++]=Ie(Tt[cs&os]),cs>>=Ze}else k["VP8LMapColor"+ee](Ve,Qe,Tt,os,jt,Ut,Re,Ue,Nt)}}function Rt(E,R,ee,me,Ie){for(ee=R+ee;R<ee;){var Te=E[R++];me[Ie++]=Te>>16&255,me[Ie++]=Te>>8&255,me[Ie++]=255&Te}}function _e(E,R,ee,me,Ie){for(ee=R+ee;R<ee;){var Te=E[R++];me[Ie++]=Te>>16&255,me[Ie++]=Te>>8&255,me[Ie++]=255&Te,me[Ie++]=Te>>24&255}}function Xe(E,R,ee,me,Ie){for(ee=R+ee;R<ee;){var Te=(Re=E[R++])>>16&240|Re>>12&15,Re=240&Re|Re>>28&15;me[Ie++]=Te,me[Ie++]=Re}}function At(E,R,ee,me,Ie){for(ee=R+ee;R<ee;){var Te=(Re=E[R++])>>16&248|Re>>13&7,Re=Re>>5&224|Re>>3&31;me[Ie++]=Te,me[Ie++]=Re}}function st(E,R,ee,me,Ie){for(ee=R+ee;R<ee;){var Te=E[R++];me[Ie++]=255&Te,me[Ie++]=Te>>8&255,me[Ie++]=Te>>16&255}}function $t(E,R,ee,me,Ie,Te){if(Te==0)for(ee=R+ee;R<ee;)$e(me,((Te=E[R++])[0]>>24|Te[1]>>8&65280|Te[2]<<8&16711680|Te[3]<<24)>>>0),Ie+=32;else n(me,Ie,E,R,ee)}function fs(E,R){k[R][0]=k[E+"0"],k[R][1]=k[E+"1"],k[R][2]=k[E+"2"],k[R][3]=k[E+"3"],k[R][4]=k[E+"4"],k[R][5]=k[E+"5"],k[R][6]=k[E+"6"],k[R][7]=k[E+"7"],k[R][8]=k[E+"8"],k[R][9]=k[E+"9"],k[R][10]=k[E+"10"],k[R][11]=k[E+"11"],k[R][12]=k[E+"12"],k[R][13]=k[E+"13"],k[R][14]=k[E+"0"],k[R][15]=k[E+"0"]}function zt(E){return E==Sw||E==Cw||E==Ty||E==Aw}function St(){this.eb=[],this.size=this.A=this.fb=0}function js(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function et(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new St,this.f.kb=new js,this.sd=null}function lt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Fe(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ft(E){return alert("todo:WebPSamplerProcessPlane"),E.T}function He(E,R){var ee=E.T,me=R.ba.f.RGBA,Ie=me.eb,Te=me.fb+E.ka*me.A,Re=Mc[R.ba.S],Ue=E.y,Ve=E.O,Qe=E.f,jt=E.N,Ut=E.ea,Ze=E.W,Nt=R.cc,Tt=R.dc,os=R.Mc,Lt=R.Nc,cs=E.ka,hs=E.ka+E.T,Es=E.U,ws=Es+1>>1;for(cs==0?Re(Ue,Ve,null,null,Qe,jt,Ut,Ze,Qe,jt,Ut,Ze,Ie,Te,null,null,Es):(Re(R.ec,R.fc,Ue,Ve,Nt,Tt,os,Lt,Qe,jt,Ut,Ze,Ie,Te-me.A,Ie,Te,Es),++ee);cs+2<hs;cs+=2)Nt=Qe,Tt=jt,os=Ut,Lt=Ze,jt+=E.Rc,Ze+=E.Rc,Te+=2*me.A,Re(Ue,(Ve+=2*E.fa)-E.fa,Ue,Ve,Nt,Tt,os,Lt,Qe,jt,Ut,Ze,Ie,Te-me.A,Ie,Te,Es);return Ve+=E.fa,E.j+hs<E.o?(n(R.ec,R.fc,Ue,Ve,Es),n(R.cc,R.dc,Qe,jt,ws),n(R.Mc,R.Nc,Ut,Ze,ws),ee--):1&hs||Re(Ue,Ve,null,null,Qe,jt,Ut,Ze,Qe,jt,Ut,Ze,Ie,Te+me.A,null,null,Es),ee}function Je(E,R,ee){var me=E.F,Ie=[E.J];if(me!=null){var Te=E.U,Re=R.ba.S,Ue=Re==ky||Re==Ty;R=R.ba.f.RGBA;var Ve=[0],Qe=E.ka;Ve[0]=E.T,E.Kb&&(Qe==0?--Ve[0]:(--Qe,Ie[0]-=E.width),E.j+E.ka+E.T==E.o&&(Ve[0]=E.o-E.j-Qe));var jt=R.eb;Qe=R.fb+Qe*R.A,E=nI(me,Ie[0],E.width,Te,Ve,jt,Qe+(Ue?0:3),R.A),t(ee==Ve),E&&zt(Re)&&Vg(jt,Qe,Ue,Te,Ve,R.A)}return 0}function It(E){var R=E.ma,ee=R.ba.S,me=11>ee,Ie=ee==Py||ee==_y||ee==ky||ee==ww||ee==12||zt(ee);if(R.memory=null,R.Ib=null,R.Jb=null,R.Nd=null,!zl(R.Oa,E,Ie?11:12))return 0;if(Ie&&zt(ee)&&Ke(),E.da)alert("todo:use_scaling");else{if(me){if(R.Ib=ft,E.Kb){if(ee=E.U+1>>1,R.memory=i(E.U+2*ee),R.memory==null)return 0;R.ec=R.memory,R.fc=0,R.cc=R.ec,R.dc=R.fc+E.U,R.Mc=R.cc,R.Nc=R.dc+ee,R.Ib=He,Ke()}}else alert("todo:EmitYUV");Ie&&(R.Jb=Je,me&&io())}if(me&&!jI){for(E=0;256>E;++E)SW[E]=89858*(E-128)+Oy>>Dy,EW[E]=-22014*(E-128)+Oy,AW[E]=-45773*(E-128),CW[E]=113618*(E-128)+Oy>>Dy;for(E=Hg;E<Pw;++E)R=76283*(E-16)+Oy>>Dy,IW[E-Hg]=Cn(R,255),PW[E-Hg]=Cn(R+8>>4,15);jI=1}return 1}function Gt(E){var R=E.ma,ee=E.U,me=E.T;return t(!(1&E.ka)),0>=ee||0>=me?0:(ee=R.Ib(E,R),R.Jb!=null&&R.Jb(E,R,ee),R.Dc+=ee,1)}function qt(E){E.ma.memory=null}function As(E,R,ee,me){return Q(E,8)!=47?0:(R[0]=Q(E,14)+1,ee[0]=Q(E,14)+1,me[0]=Q(E,1),Q(E,3)!=0?0:!E.h)}function Ht(E,R){if(4>E)return E+1;var ee=E-2>>1;return(2+(1&E)<<ee)+Q(R,ee)+1}function xs(E,R){return 120<R?R-120:1<=(ee=((ee=dW[R-1])>>4)*E+(8-(15&ee)))?ee:1;var ee}function Ct(E,R,ee){var me=D(ee),Ie=E[R+=255&me].g-8;return 0<Ie&&(he(ee,ee.u+8),me=D(ee),R+=E[R].value,R+=me&(1<<Ie)-1),he(ee,ee.u+E[R].g),E[R].value}function ke(E,R,ee){return ee.g+=E.g,ee.value+=E.value<<R>>>0,t(8>=ee.g),E.g}function gt(E,R,ee){var me=E.xc;return t((R=me==0?0:E.vc[E.md*(ee>>me)+(R>>me)])<E.Wb),E.Ya[R]}function us(E,R,ee,me){var Ie=E.ab,Te=E.c*R,Re=E.C;R=Re+R;var Ue=ee,Ve=me;for(me=E.Ta,ee=E.Ua;0<Ie--;){var Qe=E.gc[Ie],jt=Re,Ut=R,Ze=Ue,Nt=Ve,Tt=(Ve=me,Ue=ee,Qe.Ea);switch(t(jt<Ut),t(Ut<=Qe.nc),Qe.hc){case 2:Nx(Ze,Nt,(Ut-jt)*Tt,Ve,Ue);break;case 0:var os=jt,Lt=Ut,cs=Ve,hs=Ue,Es=(mr=Qe).Ea;os==0&&(Ud(Ze,Nt,null,null,1,cs,hs),ct(Ze,Nt+1,0,0,Es-1,cs,hs+1),Nt+=Es,hs+=Es,++os);for(var ws=1<<mr.b,Nr=ws-1,rr=ce(Es,mr.b),xn=mr.K,mr=mr.w+(os>>mr.b)*rr;os<Lt;){var Un=xn,oo=mr,pn=1;for(zd(Ze,Nt,cs,hs-Es,1,cs,hs);pn<Es;){var fr=(pn&~Nr)+ws;fr>Es&&(fr=Es),(0,Qm[Un[oo++]>>8&15])(Ze,Nt+ +pn,cs,hs+pn-Es,fr-pn,cs,hs+pn),pn=fr}Nt+=Es,hs+=Es,++os&Nr||(mr+=rr)}Ut!=Qe.nc&&n(Ve,Ue-Tt,Ve,Ue+(Ut-jt-1)*Tt,Tt);break;case 1:for(Tt=Ze,Lt=Nt,Es=(Ze=Qe.Ea)-(hs=Ze&~(cs=(Nt=1<<Qe.b)-1)),os=ce(Ze,Qe.b),ws=Qe.K,Qe=Qe.w+(jt>>Qe.b)*os;jt<Ut;){for(Nr=ws,rr=Qe,xn=new ve,mr=Lt+hs,Un=Lt+Ze;Lt<mr;)pt(Nr[rr++],xn),Su(xn,Tt,Lt,Nt,Ve,Ue),Lt+=Nt,Ue+=Nt;Lt<Un&&(pt(Nr[rr++],xn),Su(xn,Tt,Lt,Es,Ve,Ue),Lt+=Es,Ue+=Es),++jt&cs||(Qe+=os)}break;case 3:if(Ze==Ve&&Nt==Ue&&0<Qe.b){for(Lt=Ve,Ze=Tt=Ue+(Ut-jt)*Tt-(hs=(Ut-jt)*ce(Qe.Ea,Qe.b)),Nt=Ve,cs=Ue,os=[],hs=(Es=hs)-1;0<=hs;--hs)os[hs]=Nt[cs+hs];for(hs=Es-1;0<=hs;--hs)Lt[Ze+hs]=os[hs];Ug(Qe,jt,Ut,Ve,Tt,Ve,Ue)}else Ug(Qe,jt,Ut,Ze,Nt,Ve,Ue)}Ue=me,Ve=ee}Ve!=ee&&n(me,ee,Ue,Ve,Te)}function We(E,R){var ee=E.V,me=E.Ba+E.c*E.C,Ie=R-E.C;if(t(R<=E.l.o),t(16>=Ie),0<Ie){var Te=E.l,Re=E.Ta,Ue=E.Ua,Ve=Te.width;if(us(E,Ie,ee,me),Ie=Ue=[Ue],t((ee=E.C)<(me=R)),t(Te.v<Te.va),me>Te.o&&(me=Te.o),ee<Te.j){var Qe=Te.j-ee;ee=Te.j,Ie[0]+=Qe*Ve}if(ee>=me?ee=0:(Ie[0]+=4*Te.v,Te.ka=ee-Te.j,Te.U=Te.va-Te.v,Te.T=me-ee,ee=1),ee){if(Ue=Ue[0],11>(ee=E.ca).S){var jt=ee.f.RGBA,Ut=(me=ee.S,Ie=Te.U,Te=Te.T,Qe=jt.eb,jt.A),Ze=Te;for(jt=jt.fb+E.Ma*jt.A;0<Ze--;){var Nt=Re,Tt=Ue,os=Ie,Lt=Qe,cs=jt;switch(me){case Iy:zg(Nt,Tt,os,Lt,cs);break;case Py:dc(Nt,Tt,os,Lt,cs);break;case Sw:dc(Nt,Tt,os,Lt,cs),Vg(Lt,cs,0,os,1,0);break;case uI:Ka(Nt,Tt,os,Lt,cs);break;case _y:$t(Nt,Tt,os,Lt,cs,1);break;case Cw:$t(Nt,Tt,os,Lt,cs,1),Vg(Lt,cs,0,os,1,0);break;case ky:$t(Nt,Tt,os,Lt,cs,0);break;case Ty:$t(Nt,Tt,os,Lt,cs,0),Vg(Lt,cs,1,os,1,0);break;case ww:qd(Nt,Tt,os,Lt,cs);break;case Aw:qd(Nt,Tt,os,Lt,cs),rI(Lt,cs,os,1,0);break;case hI:Ga(Nt,Tt,os,Lt,cs);break;default:t(0)}Ue+=Ve,jt+=Ut}E.Ma+=Te}else alert("todo:EmitRescaledRowsYUVA");t(E.Ma<=ee.height)}}E.C=R,t(E.C<=E.i)}function Et(E){var R;if(0<E.ua)return 0;for(R=0;R<E.Wb;++R){var ee=E.Ya[R].G,me=E.Ya[R].H;if(0<ee[1][me[1]+0].g||0<ee[2][me[2]+0].g||0<ee[3][me[3]+0].g)return 0}return 1}function Pt(E,R,ee,me,Ie,Te){if(E.Z!=0){var Re=E.qd,Ue=E.rd;for(t(Ph[E.Z]!=null);R<ee;++R)Ph[E.Z](Re,Ue,me,Ie,me,Ie,Te),Re=me,Ue=Ie,Ie+=Te;E.qd=Re,E.rd=Ue}}function rs(E,R){var ee=E.l.ma,me=ee.Z==0||ee.Z==1?E.l.j:E.C;if(me=E.C<me?me:E.C,t(R<=E.l.o),R>me){var Ie=E.l.width,Te=ee.ca,Re=ee.tb+Ie*me,Ue=E.V,Ve=E.Ba+E.c*me,Qe=E.gc;t(E.ab==1),t(Qe[0].hc==3),Sx(Qe[0],me,R,Ue,Ve,Te,Re),Pt(ee,me,R,Te,Re,Ie)}E.C=E.Ma=R}function ms(E,R,ee,me,Ie,Te,Re){var Ue=E.$/me,Ve=E.$%me,Qe=E.m,jt=E.s,Ut=ee+E.$,Ze=Ut;Ie=ee+me*Ie;var Nt=ee+me*Te,Tt=280+jt.ua,os=E.Pb?Ue:16777216,Lt=0<jt.ua?jt.Wa:null,cs=jt.wc,hs=Ut<Nt?gt(jt,Ve,Ue):null;t(E.C<Te),t(Nt<=Ie);var Es=!1;e:for(;;){for(;Es||Ut<Nt;){var ws=0;if(Ue>=os){var Nr=Ut-ee;t((os=E).Pb),os.wd=os.m,os.xd=Nr,0<os.s.ua&&Z(os.s.Wa,os.s.vb),os=Ue+hW}if(Ve&cs||(hs=gt(jt,Ve,Ue)),t(hs!=null),hs.Qb&&(R[Ut]=hs.qb,Es=!0),!Es)if(be(Qe),hs.jc){ws=Qe,Nr=R;var rr=Ut,xn=hs.pd[D(ws)&Bd-1];t(hs.jc),256>xn.g?(he(ws,ws.u+xn.g),Nr[rr]=xn.value,ws=0):(he(ws,ws.u+xn.g-256),t(256<=xn.value),ws=xn.value),ws==0&&(Es=!0)}else ws=Ct(hs.G[0],hs.H[0],Qe);if(Qe.h)break;if(Es||256>ws){if(!Es)if(hs.nd)R[Ut]=(hs.qb|ws<<8)>>>0;else{if(be(Qe),Es=Ct(hs.G[1],hs.H[1],Qe),be(Qe),Nr=Ct(hs.G[2],hs.H[2],Qe),rr=Ct(hs.G[3],hs.H[3],Qe),Qe.h)break;R[Ut]=(rr<<24|Es<<16|ws<<8|Nr)>>>0}if(Es=!1,++Ut,++Ve>=me&&(Ve=0,++Ue,Re!=null&&Ue<=Te&&!(Ue%16)&&Re(E,Ue),Lt!=null))for(;Ze<Ut;)ws=R[Ze++],Lt.X[(506832829*ws&4294967295)>>>Lt.Mb]=ws}else if(280>ws){if(ws=Ht(ws-256,Qe),Nr=Ct(hs.G[4],hs.H[4],Qe),be(Qe),Nr=xs(me,Nr=Ht(Nr,Qe)),Qe.h)break;if(Ut-ee<Nr||Ie-Ut<ws)break e;for(rr=0;rr<ws;++rr)R[Ut+rr]=R[Ut+rr-Nr];for(Ut+=ws,Ve+=ws;Ve>=me;)Ve-=me,++Ue,Re!=null&&Ue<=Te&&!(Ue%16)&&Re(E,Ue);if(t(Ut<=Ie),Ve&cs&&(hs=gt(jt,Ve,Ue)),Lt!=null)for(;Ze<Ut;)ws=R[Ze++],Lt.X[(506832829*ws&4294967295)>>>Lt.Mb]=ws}else{if(!(ws<Tt))break e;for(Es=ws-280,t(Lt!=null);Ze<Ut;)ws=R[Ze++],Lt.X[(506832829*ws&4294967295)>>>Lt.Mb]=ws;ws=Ut,t(!(Es>>>(Nr=Lt).Xa)),R[ws]=Nr.X[Es],Es=!0}Es||t(Qe.h==se(Qe))}if(E.Pb&&Qe.h&&Ut<Ie)t(E.m.h),E.a=5,E.m=E.wd,E.$=E.xd,0<E.s.ua&&Z(E.s.vb,E.s.Wa);else{if(Qe.h)break e;Re!=null&&Re(E,Ue>Te?Te:Ue),E.a=0,E.$=Ut-ee}return 1}return E.a=3,0}function Bs(E){t(E!=null),E.vc=null,E.yc=null,E.Ya=null;var R=E.Wa;R!=null&&(R.X=null),E.vb=null,t(E!=null)}function Vs(){var E=new cn;return E==null?null:(E.a=0,E.xb=xI,fs("Predictor","VP8LPredictors"),fs("Predictor","VP8LPredictors_C"),fs("PredictorAdd","VP8LPredictorsAdd"),fs("PredictorAdd","VP8LPredictorsAdd_C"),Nx=dt,Su=qe,zg=Rt,dc=_e,qd=Xe,Ga=At,Ka=st,k.VP8LMapColor32b=wx,k.VP8LMapColor8b=Xm,E)}function Ws(E,R,ee,me,Ie){var Te=1,Re=[E],Ue=[R],Ve=me.m,Qe=me.s,jt=null,Ut=0;e:for(;;){if(ee)for(;Te&&Q(Ve,1);){var Ze=Re,Nt=Ue,Tt=me,os=1,Lt=Tt.m,cs=Tt.gc[Tt.ab],hs=Q(Lt,2);if(Tt.Oc&1<<hs)Te=0;else{switch(Tt.Oc|=1<<hs,cs.hc=hs,cs.Ea=Ze[0],cs.nc=Nt[0],cs.K=[null],++Tt.ab,t(4>=Tt.ab),hs){case 0:case 1:cs.b=Q(Lt,3)+2,os=Ws(ce(cs.Ea,cs.b),ce(cs.nc,cs.b),0,Tt,cs.K),cs.K=cs.K[0];break;case 3:var Es,ws=Q(Lt,8)+1,Nr=16<ws?0:4<ws?1:2<ws?2:3;if(Ze[0]=ce(cs.Ea,Nr),cs.b=Nr,Es=os=Ws(ws,1,0,Tt,cs.K)){var rr,xn=ws,mr=cs,Un=1<<(8>>mr.b),oo=i(Un);if(oo==null)Es=0;else{var pn=mr.K[0],fr=mr.w;for(oo[0]=mr.K[0][0],rr=1;rr<1*xn;++rr)oo[rr]=Y(pn[fr+rr],oo[rr-1]);for(;rr<4*Un;++rr)oo[rr]=0;mr.K[0]=null,mr.K[0]=oo,Es=1}}os=Es;break;case 2:break;default:t(0)}Te=os}}if(Re=Re[0],Ue=Ue[0],Te&&Q(Ve,1)&&!(Te=1<=(Ut=Q(Ve,4))&&11>=Ut)){me.a=3;break e}var Gs;if(Gs=Te)t:{var Fi,nn,Hn,ni=me,Wo=Re,yl=Ue,Si=Ut,sl=ee,jl=ni.m,lo=ni.s,Yn=[null],pa=1,Ci=0,ga=uW[Si];s:for(;;){if(sl&&Q(jl,1)){var Ho=Q(jl,3)+2,hd=ce(Wo,Ho),Mi=ce(yl,Ho),Vl=hd*Mi;if(!Ws(hd,Mi,0,ni,Yn))break s;for(Yn=Yn[0],lo.xc=Ho,Fi=0;Fi<Vl;++Fi){var Oa=Yn[Fi]>>8&65535;Yn[Fi]=Oa,Oa>=pa&&(pa=Oa+1)}}if(jl.h)break s;for(nn=0;5>nn;++nn){var co=mI[nn];!nn&&0<Si&&(co+=1<<Si),Ci<co&&(Ci=co)}var hc=o(pa*ga,V),bl=pa,mc=o(bl,G);if(mc==null)var fc=null;else t(65536>=bl),fc=mc;var Wl=i(Ci);if(fc==null||Wl==null||hc==null){ni.a=1;break s}var xc=hc;for(Fi=Hn=0;Fi<pa;++Fi){var Ya=fc[Fi],pc=Ya.G,md=Ya.H,Zm=0,Eu=1,Go=0;for(nn=0;5>nn;++nn){co=mI[nn],pc[nn]=xc,md[nn]=Hn,!nn&&0<Si&&(co+=1<<Si);n:{var Fy,_w=co,My=ni,Gg=Wl,TW=xc,DW=Hn,kw=0,_h=My.m,OW=Q(_h,1);if(a(Gg,0,0,_w),OW){var RW=Q(_h,1)+1,FW=Q(_h,1),wI=Q(_h,FW==0?1:8);Gg[wI]=1,RW==2&&(Gg[wI=Q(_h,8)]=1);var Ly=1}else{var SI=i(19),CI=Q(_h,4)+4;if(19<CI){My.a=3;var $y=0;break n}for(Fy=0;Fy<CI;++Fy)SI[cW[Fy]]=Q(_h,3);var Tw=void 0,Kg=void 0,AI=My,MW=SI,By=_w,EI=Gg,Dw=0,kh=AI.m,II=8,PI=o(128,V);r:for(;T(PI,0,7,MW,19);){if(Q(kh,1)){var LW=2+2*Q(kh,3);if((Tw=2+Q(kh,LW))>By)break r}else Tw=By;for(Kg=0;Kg<By&&Tw--;){be(kh);var _I=PI[0+(127&D(kh))];he(kh,kh.u+_I.g);var Ax=_I.value;if(16>Ax)EI[Kg++]=Ax,Ax!=0&&(II=Ax);else{var $W=Ax==16,kI=Ax-16,BW=oW[kI],TI=Q(kh,iW[kI])+BW;if(Kg+TI>By)break r;for(var UW=$W?II:0;0<TI--;)EI[Kg++]=UW}}Dw=1;break r}Dw||(AI.a=3),Ly=Dw}(Ly=Ly&&!_h.h)&&(kw=T(TW,DW,8,Gg,_w)),Ly&&kw!=0?$y=kw:(My.a=3,$y=0)}if($y==0)break s;if(Eu&&lW[nn]==1&&(Eu=xc[Hn].g==0),Zm+=xc[Hn].g,Hn+=$y,3>=nn){var Yg,Ow=Wl[0];for(Yg=1;Yg<co;++Yg)Wl[Yg]>Ow&&(Ow=Wl[Yg]);Go+=Ow}}if(Ya.nd=Eu,Ya.Qb=0,Eu&&(Ya.qb=(pc[3][md[3]+0].value<<24|pc[1][md[1]+0].value<<16|pc[2][md[2]+0].value)>>>0,Zm==0&&256>pc[0][md[0]+0].value&&(Ya.Qb=1,Ya.qb+=pc[0][md[0]+0].value<<8)),Ya.jc=!Ya.Qb&&6>Go,Ya.jc){var Uy,Iu=Ya;for(Uy=0;Uy<Bd;++Uy){var Th=Uy,Dh=Iu.pd[Th],zy=Iu.G[0][Iu.H[0]+Th];256<=zy.value?(Dh.g=zy.g+256,Dh.value=zy.value):(Dh.g=0,Dh.value=0,Th>>=ke(zy,8,Dh),Th>>=ke(Iu.G[1][Iu.H[1]+Th],16,Dh),Th>>=ke(Iu.G[2][Iu.H[2]+Th],0,Dh),ke(Iu.G[3][Iu.H[3]+Th],24,Dh))}}}lo.vc=Yn,lo.Wb=pa,lo.Ya=fc,lo.yc=hc,Gs=1;break t}Gs=0}if(!(Te=Gs)){me.a=3;break e}if(0<Ut){if(Qe.ua=1<<Ut,!le(Qe.Wa,Ut)){me.a=1,Te=0;break e}}else Qe.ua=0;var Rw=me,DI=Re,zW=Ue,Fw=Rw.s,Mw=Fw.xc;if(Rw.c=DI,Rw.i=zW,Fw.md=ce(DI,Mw),Fw.wc=Mw==0?-1:(1<<Mw)-1,ee){me.xb=yW;break e}if((jt=i(Re*Ue))==null){me.a=1,Te=0;break e}Te=(Te=ms(me,jt,0,Re,Ue,Ue,null))&&!Ve.h;break e}return Te?(Ie!=null?Ie[0]=jt:(t(jt==null),t(ee)),me.$=0,ee||Bs(Qe)):Bs(Qe),Te}function Ns(E,R){var ee=E.c*E.i,me=ee+R+16*R;return t(E.c<=R),E.V=i(me),E.V==null?(E.Ta=null,E.Ua=0,E.a=1,0):(E.Ta=E.V,E.Ua=E.Ba+ee+R,1)}function er(E,R){var ee=E.C,me=R-ee,Ie=E.V,Te=E.Ba+E.c*ee;for(t(R<=E.l.o);0<me;){var Re=16<me?16:me,Ue=E.l.ma,Ve=E.l.width,Qe=Ve*Re,jt=Ue.ca,Ut=Ue.tb+Ve*ee,Ze=E.Ta,Nt=E.Ua;us(E,Re,Ie,Te),aI(Ze,Nt,jt,Ut,Qe),Pt(Ue,ee,ee+Re,jt,Ut,Ve),me-=Re,Ie+=Re*E.c,ee+=Re}t(ee==R),E.C=E.Ma=R}function Ir(){this.ub=this.yd=this.td=this.Rb=0}function jn(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Hs(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function qr(){this.Yb=function(){var E=[];return function R(ee,me,Ie){for(var Te=Ie[me],Re=0;Re<Te&&(ee.push(Ie.length>me+1?[]:0),!(Ie.length<me+1));Re++)R(ee[Re],me+1,Ie)}(E,0,[3,11]),E}()}function qn(){this.jb=i(3),this.Wc=l([4,8],qr),this.Xc=l([4,17],qr)}function In(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function Yr(){this.ld=this.La=this.dd=this.tc=0}function $r(){this.Na=this.la=0}function Vr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function wn(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Vn(){this.uc=this.M=this.Nb=0,this.wa=Array(new Yr),this.Y=0,this.ya=Array(new wn),this.aa=0,this.l=new Pe}function De(){this.y=i(16),this.f=i(8),this.ea=i(8)}function ut(){this.cb=this.a=0,this.sc="",this.m=new P,this.Od=new Ir,this.Kc=new jn,this.ed=new In,this.Qa=new Hs,this.Ic=this.$c=this.Aa=0,this.D=new Vn,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,P),this.ia=0,this.pb=o(4,Vr),this.Pa=new qn,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new De),this.Hd=0,this.rb=Array(new $r),this.sb=0,this.wa=Array(new Yr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new wn),this.L=this.aa=0,this.gd=l([4,2],Yr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Pe(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function _t(){var E=new ut;return E!=null&&(E.a=0,E.sc="OK",E.cb=0,E.Xb=0,Wg||(Wg=Wr)),E}function bt(E,R,ee){return E.a==0&&(E.a=R,E.sc=ee,E.cb=0),0}function ps(E,R,ee){return 3<=ee&&E[R+0]==157&&E[R+1]==1&&E[R+2]==42}function Pr(E,R){if(E==null)return 0;if(E.a=0,E.sc="OK",R==null)return bt(E,2,"null VP8Io passed to VP8GetHeaders()");var ee=R.data,me=R.w,Ie=R.ha;if(4>Ie)return bt(E,7,"Truncated header.");var Te=ee[me+0]|ee[me+1]<<8|ee[me+2]<<16,Re=E.Od;if(Re.Rb=!(1&Te),Re.td=Te>>1&7,Re.yd=Te>>4&1,Re.ub=Te>>5,3<Re.td)return bt(E,3,"Incorrect keyframe parameters.");if(!Re.yd)return bt(E,4,"Frame not displayable.");me+=3,Ie-=3;var Ue=E.Kc;if(Re.Rb){if(7>Ie)return bt(E,7,"cannot parse picture header");if(!ps(ee,me,Ie))return bt(E,3,"Bad code word");Ue.c=16383&(ee[me+4]<<8|ee[me+3]),Ue.Td=ee[me+4]>>6,Ue.i=16383&(ee[me+6]<<8|ee[me+5]),Ue.Ud=ee[me+6]>>6,me+=7,Ie-=7,E.za=Ue.c+15>>4,E.Ub=Ue.i+15>>4,R.width=Ue.c,R.height=Ue.i,R.Da=0,R.j=0,R.v=0,R.va=R.width,R.o=R.height,R.da=0,R.ib=R.width,R.hb=R.height,R.U=R.width,R.T=R.height,a((Te=E.Pa).jb,0,255,Te.jb.length),t((Te=E.Qa)!=null),Te.Cb=0,Te.Bb=0,Te.Fb=1,a(Te.Zb,0,0,Te.Zb.length),a(Te.Lb,0,0,Te.Lb)}if(Re.ub>Ie)return bt(E,7,"bad partition length");L(Te=E.m,ee,me,Re.ub),me+=Re.ub,Ie-=Re.ub,Re.Rb&&(Ue.Ld=Ae(Te),Ue.Kd=Ae(Te)),Ue=E.Qa;var Ve,Qe=E.Pa;if(t(Te!=null),t(Ue!=null),Ue.Cb=Ae(Te),Ue.Cb){if(Ue.Bb=Ae(Te),Ae(Te)){for(Ue.Fb=Ae(Te),Ve=0;4>Ve;++Ve)Ue.Zb[Ve]=Ae(Te)?z(Te,7):0;for(Ve=0;4>Ve;++Ve)Ue.Lb[Ve]=Ae(Te)?z(Te,6):0}if(Ue.Bb)for(Ve=0;3>Ve;++Ve)Qe.jb[Ve]=Ae(Te)?J(Te,8):255}else Ue.Bb=0;if(Te.Ka)return bt(E,3,"cannot parse segment header");if((Ue=E.ed).zd=Ae(Te),Ue.Tb=J(Te,6),Ue.wb=J(Te,3),Ue.Pc=Ae(Te),Ue.Pc&&Ae(Te)){for(Qe=0;4>Qe;++Qe)Ae(Te)&&(Ue.vd[Qe]=z(Te,6));for(Qe=0;4>Qe;++Qe)Ae(Te)&&(Ue.od[Qe]=z(Te,6))}if(E.L=Ue.Tb==0?0:Ue.zd?1:2,Te.Ka)return bt(E,3,"cannot parse filter header");var jt=Ie;if(Ie=Ve=me,me=Ve+jt,Ue=jt,E.Xb=(1<<J(E.m,2))-1,jt<3*(Qe=E.Xb))ee=7;else{for(Ve+=3*Qe,Ue-=3*Qe,jt=0;jt<Qe;++jt){var Ut=ee[Ie+0]|ee[Ie+1]<<8|ee[Ie+2]<<16;Ut>Ue&&(Ut=Ue),L(E.Jc[+jt],ee,Ve,Ut),Ve+=Ut,Ue-=Ut,Ie+=3}L(E.Jc[+Qe],ee,Ve,Ue),ee=Ve<me?0:5}if(ee!=0)return bt(E,ee,"cannot parse partitions");for(ee=J(Ve=E.m,7),Ie=Ae(Ve)?z(Ve,4):0,me=Ae(Ve)?z(Ve,4):0,Ue=Ae(Ve)?z(Ve,4):0,Qe=Ae(Ve)?z(Ve,4):0,Ve=Ae(Ve)?z(Ve,4):0,jt=E.Qa,Ut=0;4>Ut;++Ut){if(jt.Cb){var Ze=jt.Zb[Ut];jt.Fb||(Ze+=ee)}else{if(0<Ut){E.pb[Ut]=E.pb[0];continue}Ze=ee}var Nt=E.pb[Ut];Nt.Sc[0]=Ew[Cn(Ze+Ie,127)],Nt.Sc[1]=Iw[Cn(Ze+0,127)],Nt.Eb[0]=2*Ew[Cn(Ze+me,127)],Nt.Eb[1]=101581*Iw[Cn(Ze+Ue,127)]>>16,8>Nt.Eb[1]&&(Nt.Eb[1]=8),Nt.Qc[0]=Ew[Cn(Ze+Qe,117)],Nt.Qc[1]=Iw[Cn(Ze+Ve,127)],Nt.lc=Ze+Ve}if(!Re.Rb)return bt(E,4,"Not a key frame.");for(Ae(Te),Re=E.Pa,ee=0;4>ee;++ee){for(Ie=0;8>Ie;++Ie)for(me=0;3>me;++me)for(Ue=0;11>Ue;++Ue)Qe=Ee(Te,gW[ee][Ie][me][Ue])?J(Te,8):xW[ee][Ie][me][Ue],Re.Wc[ee][Ie].Yb[me][Ue]=Qe;for(Ie=0;17>Ie;++Ie)Re.Xc[ee][Ie]=Re.Wc[ee][vW[Ie]]}return E.kc=Ae(Te),E.kc&&(E.Bd=J(Te,8)),E.cb=1}function Wr(E,R,ee,me,Ie,Te,Re){var Ue=R[Ie].Yb[ee];for(ee=0;16>Ie;++Ie){if(!Ee(E,Ue[ee+0]))return Ie;for(;!Ee(E,Ue[ee+1]);)if(Ue=R[++Ie].Yb[0],ee=0,Ie==16)return 16;var Ve=R[Ie+1].Yb;if(Ee(E,Ue[ee+2])){var Qe=E,jt=0;if(Ee(Qe,(Ze=Ue)[(Ut=ee)+3]))if(Ee(Qe,Ze[Ut+6])){for(Ue=0,Ut=2*(jt=Ee(Qe,Ze[Ut+8]))+(Ze=Ee(Qe,Ze[Ut+9+jt])),jt=0,Ze=mW[Ut];Ze[Ue];++Ue)jt+=jt+Ee(Qe,Ze[Ue]);jt+=3+(8<<Ut)}else Ee(Qe,Ze[Ut+7])?(jt=7+2*Ee(Qe,165),jt+=Ee(Qe,145)):jt=5+Ee(Qe,159);else jt=Ee(Qe,Ze[Ut+4])?3+Ee(Qe,Ze[Ut+5]):2;Ue=Ve[2]}else jt=1,Ue=Ve[1];Ve=Re+fW[Ie],0>(Qe=E).b&&pe(Qe);var Ut,Ze=Qe.b,Nt=(Ut=Qe.Ca>>1)-(Qe.I>>Ze)>>31;--Qe.b,Qe.Ca+=Nt,Qe.Ca|=1,Qe.I-=(Ut+1&Nt)<<Ze,Te[Ve]=((jt^Nt)-Nt)*me[(0<Ie)+0]}return 16}function Zs(E){var R=E.rb[E.sb-1];R.la=0,R.Na=0,a(E.zc,0,0,E.zc.length),E.ja=0}function wr(E,R,ee,me,Ie){Ie=E[R+ee+32*me]+(Ie>>3),E[R+ee+32*me]=-256&Ie?0>Ie?0:255:Ie}function xa(E,R,ee,me,Ie,Te){wr(E,R,0,ee,me+Ie),wr(E,R,1,ee,me+Te),wr(E,R,2,ee,me-Te),wr(E,R,3,ee,me-Ie)}function cr(E){return(20091*E>>16)+E}function Zn(E,R,ee,me){var Ie,Te=0,Re=i(16);for(Ie=0;4>Ie;++Ie){var Ue=E[R+0]+E[R+8],Ve=E[R+0]-E[R+8],Qe=(35468*E[R+4]>>16)-cr(E[R+12]),jt=cr(E[R+4])+(35468*E[R+12]>>16);Re[Te+0]=Ue+jt,Re[Te+1]=Ve+Qe,Re[Te+2]=Ve-Qe,Re[Te+3]=Ue-jt,Te+=4,R++}for(Ie=Te=0;4>Ie;++Ie)Ue=(E=Re[Te+0]+4)+Re[Te+8],Ve=E-Re[Te+8],Qe=(35468*Re[Te+4]>>16)-cr(Re[Te+12]),wr(ee,me,0,0,Ue+(jt=cr(Re[Te+4])+(35468*Re[Te+12]>>16))),wr(ee,me,1,0,Ve+Qe),wr(ee,me,2,0,Ve-Qe),wr(ee,me,3,0,Ue-jt),Te++,me+=32}function Hi(E,R,ee,me){var Ie=E[R+0]+4,Te=35468*E[R+4]>>16,Re=cr(E[R+4]),Ue=35468*E[R+1]>>16;xa(ee,me,0,Ie+Re,E=cr(E[R+1]),Ue),xa(ee,me,1,Ie+Te,E,Ue),xa(ee,me,2,Ie-Te,E,Ue),xa(ee,me,3,Ie-Re,E,Ue)}function Gi(E,R,ee,me,Ie){Zn(E,R,ee,me),Ie&&Zn(E,R+16,ee,me+4)}function Ti(E,R,ee,me){Ri(E,R+0,ee,me,1),Ri(E,R+32,ee,me+128,1)}function Ea(E,R,ee,me){var Ie;for(E=E[R+0]+4,Ie=0;4>Ie;++Ie)for(R=0;4>R;++R)wr(ee,me,R,Ie,E)}function Ki(E,R,ee,me){E[R+0]&&Vd(E,R+0,ee,me),E[R+16]&&Vd(E,R+16,ee,me+4),E[R+32]&&Vd(E,R+32,ee,me+128),E[R+48]&&Vd(E,R+48,ee,me+128+4)}function mi(E,R,ee,me){var Ie,Te=i(16);for(Ie=0;4>Ie;++Ie){var Re=E[R+0+Ie]+E[R+12+Ie],Ue=E[R+4+Ie]+E[R+8+Ie],Ve=E[R+4+Ie]-E[R+8+Ie],Qe=E[R+0+Ie]-E[R+12+Ie];Te[0+Ie]=Re+Ue,Te[8+Ie]=Re-Ue,Te[4+Ie]=Qe+Ve,Te[12+Ie]=Qe-Ve}for(Ie=0;4>Ie;++Ie)Re=(E=Te[0+4*Ie]+3)+Te[3+4*Ie],Ue=Te[1+4*Ie]+Te[2+4*Ie],Ve=Te[1+4*Ie]-Te[2+4*Ie],Qe=E-Te[3+4*Ie],ee[me+0]=Re+Ue>>3,ee[me+16]=Qe+Ve>>3,ee[me+32]=Re-Ue>>3,ee[me+48]=Qe-Ve>>3,me+=64}function Da(E,R,ee){var me,Ie=R-32,Te=uc,Re=255-E[Ie-1];for(me=0;me<ee;++me){var Ue,Ve=Te,Qe=Re+E[R-1];for(Ue=0;Ue<ee;++Ue)E[R+Ue]=Ve[Qe+E[Ie+Ue]];R+=32}}function fi(E,R){Da(E,R,4)}function qa(E,R){Da(E,R,8)}function Ne(E,R){Da(E,R,16)}function Dt(E,R){var ee;for(ee=0;16>ee;++ee)n(E,R+32*ee,E,R-32,16)}function ye(E,R){var ee;for(ee=16;0<ee;--ee)a(E,R,E[R-1],16),R+=32}function Be(E,R,ee){var me;for(me=0;16>me;++me)a(R,ee+32*me,E,16)}function Ft(E,R){var ee,me=16;for(ee=0;16>ee;++ee)me+=E[R-1+32*ee]+E[R+ee-32];Be(me>>5,E,R)}function Kt(E,R){var ee,me=8;for(ee=0;16>ee;++ee)me+=E[R-1+32*ee];Be(me>>4,E,R)}function Jt(E,R){var ee,me=8;for(ee=0;16>ee;++ee)me+=E[R+ee-32];Be(me>>4,E,R)}function kt(E,R){Be(128,E,R)}function gs(E,R,ee){return E+2*R+ee+2>>2}function fn(E,R){var ee,me=R-32;for(me=new Uint8Array([gs(E[me-1],E[me+0],E[me+1]),gs(E[me+0],E[me+1],E[me+2]),gs(E[me+1],E[me+2],E[me+3]),gs(E[me+2],E[me+3],E[me+4])]),ee=0;4>ee;++ee)n(E,R+32*ee,me,0,me.length)}function xi(E,R){var ee=E[R-1],me=E[R-1+32],Ie=E[R-1+64],Te=E[R-1+96];$e(E,R+0,16843009*gs(E[R-1-32],ee,me)),$e(E,R+32,16843009*gs(ee,me,Ie)),$e(E,R+64,16843009*gs(me,Ie,Te)),$e(E,R+96,16843009*gs(Ie,Te,Te))}function $n(E,R){var ee,me=4;for(ee=0;4>ee;++ee)me+=E[R+ee-32]+E[R-1+32*ee];for(me>>=3,ee=0;4>ee;++ee)a(E,R+32*ee,me,4)}function Ur(E,R){var ee=E[R-1+0],me=E[R-1+32],Ie=E[R-1+64],Te=E[R-1-32],Re=E[R+0-32],Ue=E[R+1-32],Ve=E[R+2-32],Qe=E[R+3-32];E[R+0+96]=gs(me,Ie,E[R-1+96]),E[R+1+96]=E[R+0+64]=gs(ee,me,Ie),E[R+2+96]=E[R+1+64]=E[R+0+32]=gs(Te,ee,me),E[R+3+96]=E[R+2+64]=E[R+1+32]=E[R+0+0]=gs(Re,Te,ee),E[R+3+64]=E[R+2+32]=E[R+1+0]=gs(Ue,Re,Te),E[R+3+32]=E[R+2+0]=gs(Ve,Ue,Re),E[R+3+0]=gs(Qe,Ve,Ue)}function Yi(E,R){var ee=E[R+1-32],me=E[R+2-32],Ie=E[R+3-32],Te=E[R+4-32],Re=E[R+5-32],Ue=E[R+6-32],Ve=E[R+7-32];E[R+0+0]=gs(E[R+0-32],ee,me),E[R+1+0]=E[R+0+32]=gs(ee,me,Ie),E[R+2+0]=E[R+1+32]=E[R+0+64]=gs(me,Ie,Te),E[R+3+0]=E[R+2+32]=E[R+1+64]=E[R+0+96]=gs(Ie,Te,Re),E[R+3+32]=E[R+2+64]=E[R+1+96]=gs(Te,Re,Ue),E[R+3+64]=E[R+2+96]=gs(Re,Ue,Ve),E[R+3+96]=gs(Ue,Ve,Ve)}function Ji(E,R){var ee=E[R-1+0],me=E[R-1+32],Ie=E[R-1+64],Te=E[R-1-32],Re=E[R+0-32],Ue=E[R+1-32],Ve=E[R+2-32],Qe=E[R+3-32];E[R+0+0]=E[R+1+64]=Te+Re+1>>1,E[R+1+0]=E[R+2+64]=Re+Ue+1>>1,E[R+2+0]=E[R+3+64]=Ue+Ve+1>>1,E[R+3+0]=Ve+Qe+1>>1,E[R+0+96]=gs(Ie,me,ee),E[R+0+64]=gs(me,ee,Te),E[R+0+32]=E[R+1+96]=gs(ee,Te,Re),E[R+1+32]=E[R+2+96]=gs(Te,Re,Ue),E[R+2+32]=E[R+3+96]=gs(Re,Ue,Ve),E[R+3+32]=gs(Ue,Ve,Qe)}function rn(E,R){var ee=E[R+0-32],me=E[R+1-32],Ie=E[R+2-32],Te=E[R+3-32],Re=E[R+4-32],Ue=E[R+5-32],Ve=E[R+6-32],Qe=E[R+7-32];E[R+0+0]=ee+me+1>>1,E[R+1+0]=E[R+0+64]=me+Ie+1>>1,E[R+2+0]=E[R+1+64]=Ie+Te+1>>1,E[R+3+0]=E[R+2+64]=Te+Re+1>>1,E[R+0+32]=gs(ee,me,Ie),E[R+1+32]=E[R+0+96]=gs(me,Ie,Te),E[R+2+32]=E[R+1+96]=gs(Ie,Te,Re),E[R+3+32]=E[R+2+96]=gs(Te,Re,Ue),E[R+3+64]=gs(Re,Ue,Ve),E[R+3+96]=gs(Ue,Ve,Qe)}function Ll(E,R){var ee=E[R-1+0],me=E[R-1+32],Ie=E[R-1+64],Te=E[R-1+96];E[R+0+0]=ee+me+1>>1,E[R+2+0]=E[R+0+32]=me+Ie+1>>1,E[R+2+32]=E[R+0+64]=Ie+Te+1>>1,E[R+1+0]=gs(ee,me,Ie),E[R+3+0]=E[R+1+32]=gs(me,Ie,Te),E[R+3+32]=E[R+1+64]=gs(Ie,Te,Te),E[R+3+64]=E[R+2+64]=E[R+0+96]=E[R+1+96]=E[R+2+96]=E[R+3+96]=Te}function zo(E,R){var ee=E[R-1+0],me=E[R-1+32],Ie=E[R-1+64],Te=E[R-1+96],Re=E[R-1-32],Ue=E[R+0-32],Ve=E[R+1-32],Qe=E[R+2-32];E[R+0+0]=E[R+2+32]=ee+Re+1>>1,E[R+0+32]=E[R+2+64]=me+ee+1>>1,E[R+0+64]=E[R+2+96]=Ie+me+1>>1,E[R+0+96]=Te+Ie+1>>1,E[R+3+0]=gs(Ue,Ve,Qe),E[R+2+0]=gs(Re,Ue,Ve),E[R+1+0]=E[R+3+32]=gs(ee,Re,Ue),E[R+1+32]=E[R+3+64]=gs(me,ee,Re),E[R+1+64]=E[R+3+96]=gs(Ie,me,ee),E[R+1+96]=gs(Te,Ie,me)}function Qo(E,R){var ee;for(ee=0;8>ee;++ee)n(E,R+32*ee,E,R-32,8)}function Xi(E,R){var ee;for(ee=0;8>ee;++ee)a(E,R,E[R-1],8),R+=32}function _o(E,R,ee){var me;for(me=0;8>me;++me)a(R,ee+32*me,E,8)}function qo(E,R){var ee,me=8;for(ee=0;8>ee;++ee)me+=E[R+ee-32]+E[R-1+32*ee];_o(me>>4,E,R)}function $l(E,R){var ee,me=4;for(ee=0;8>ee;++ee)me+=E[R+ee-32];_o(me>>3,E,R)}function Zo(E,R){var ee,me=4;for(ee=0;8>ee;++ee)me+=E[R-1+32*ee];_o(me>>3,E,R)}function el(E,R){_o(128,E,R)}function ot(E,R,ee){var me=E[R-ee],Ie=E[R+0],Te=3*(Ie-me)+Nw[1020+E[R-2*ee]-E[R+ee]],Re=Ey[112+(Te+4>>3)];E[R-ee]=uc[255+me+Ey[112+(Te+3>>3)]],E[R+0]=uc[255+Ie-Re]}function qs(E,R,ee,me){var Ie=E[R+0],Te=E[R+ee];return Fc[255+E[R-2*ee]-E[R-ee]]>me||Fc[255+Te-Ie]>me}function Sn(E,R,ee,me){return 4*Fc[255+E[R-ee]-E[R+0]]+Fc[255+E[R-2*ee]-E[R+ee]]<=me}function hr(E,R,ee,me,Ie){var Te=E[R-3*ee],Re=E[R-2*ee],Ue=E[R-ee],Ve=E[R+0],Qe=E[R+ee],jt=E[R+2*ee],Ut=E[R+3*ee];return 4*Fc[255+Ue-Ve]+Fc[255+Re-Qe]>me?0:Fc[255+E[R-4*ee]-Te]<=Ie&&Fc[255+Te-Re]<=Ie&&Fc[255+Re-Ue]<=Ie&&Fc[255+Ut-jt]<=Ie&&Fc[255+jt-Qe]<=Ie&&Fc[255+Qe-Ve]<=Ie}function Fn(E,R,ee,me){var Ie=2*me+1;for(me=0;16>me;++me)Sn(E,R+me,ee,Ie)&&ot(E,R+me,ee)}function Rr(E,R,ee,me){var Ie=2*me+1;for(me=0;16>me;++me)Sn(E,R+me*ee,1,Ie)&&ot(E,R+me*ee,1)}function $(E,R,ee,me){var Ie;for(Ie=3;0<Ie;--Ie)Fn(E,R+=4*ee,ee,me)}function Xt(E,R,ee,me){var Ie;for(Ie=3;0<Ie;--Ie)Rr(E,R+=4,ee,me)}function ds(E,R,ee,me,Ie,Te,Re,Ue){for(Te=2*Te+1;0<Ie--;){if(hr(E,R,ee,Te,Re))if(qs(E,R,ee,Ue))ot(E,R,ee);else{var Ve=E,Qe=R,jt=ee,Ut=Ve[Qe-2*jt],Ze=Ve[Qe-jt],Nt=Ve[Qe+0],Tt=Ve[Qe+jt],os=Ve[Qe+2*jt],Lt=27*(hs=Nw[1020+3*(Nt-Ze)+Nw[1020+Ut-Tt]])+63>>7,cs=18*hs+63>>7,hs=9*hs+63>>7;Ve[Qe-3*jt]=uc[255+Ve[Qe-3*jt]+hs],Ve[Qe-2*jt]=uc[255+Ut+cs],Ve[Qe-jt]=uc[255+Ze+Lt],Ve[Qe+0]=uc[255+Nt-Lt],Ve[Qe+jt]=uc[255+Tt-cs],Ve[Qe+2*jt]=uc[255+os-hs]}R+=me}}function Us(E,R,ee,me,Ie,Te,Re,Ue){for(Te=2*Te+1;0<Ie--;){if(hr(E,R,ee,Te,Re))if(qs(E,R,ee,Ue))ot(E,R,ee);else{var Ve=E,Qe=R,jt=ee,Ut=Ve[Qe-jt],Ze=Ve[Qe+0],Nt=Ve[Qe+jt],Tt=Ey[112+(4+(os=3*(Ze-Ut))>>3)],os=Ey[112+(os+3>>3)],Lt=Tt+1>>1;Ve[Qe-2*jt]=uc[255+Ve[Qe-2*jt]+Lt],Ve[Qe-jt]=uc[255+Ut+os],Ve[Qe+0]=uc[255+Ze-Tt],Ve[Qe+jt]=uc[255+Nt-Lt]}R+=me}}function H(E,R,ee,me,Ie,Te){ds(E,R,ee,1,16,me,Ie,Te)}function Ce(E,R,ee,me,Ie,Te){ds(E,R,1,ee,16,me,Ie,Te)}function Ge(E,R,ee,me,Ie,Te){var Re;for(Re=3;0<Re;--Re)Us(E,R+=4*ee,ee,1,16,me,Ie,Te)}function ht(E,R,ee,me,Ie,Te){var Re;for(Re=3;0<Re;--Re)Us(E,R+=4,1,ee,16,me,Ie,Te)}function wt(E,R,ee,me,Ie,Te,Re,Ue){ds(E,R,Ie,1,8,Te,Re,Ue),ds(ee,me,Ie,1,8,Te,Re,Ue)}function Qt(E,R,ee,me,Ie,Te,Re,Ue){ds(E,R,1,Ie,8,Te,Re,Ue),ds(ee,me,1,Ie,8,Te,Re,Ue)}function vs(E,R,ee,me,Ie,Te,Re,Ue){Us(E,R+4*Ie,Ie,1,8,Te,Re,Ue),Us(ee,me+4*Ie,Ie,1,8,Te,Re,Ue)}function Js(E,R,ee,me,Ie,Te,Re,Ue){Us(E,R+4,1,Ie,8,Te,Re,Ue),Us(ee,me+4,1,Ie,8,Te,Re,Ue)}function je(){this.ba=new et,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Fe,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Ot(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Ds(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function ar(){this.ua=0,this.Wa=new K,this.vb=new K,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new G,this.yc=new V}function cn(){this.xb=this.a=0,this.l=new Pe,this.ca=new et,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new q,this.Pb=0,this.wd=new q,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new ar,this.ab=0,this.gc=o(4,Ds),this.Oc=0}function Va(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Pe,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Wn(E,R,ee,me,Ie,Te,Re){for(E=E==null?0:E[R+0],R=0;R<Re;++R)Ie[Te+R]=E+ee[me+R]&255,E=Ie[Te+R]}function ri(E,R,ee,me,Ie,Te,Re){var Ue;if(E==null)Wn(null,null,ee,me,Ie,Te,Re);else for(Ue=0;Ue<Re;++Ue)Ie[Te+Ue]=E[R+Ue]+ee[me+Ue]&255}function Wa(E,R,ee,me,Ie,Te,Re){if(E==null)Wn(null,null,ee,me,Ie,Te,Re);else{var Ue,Ve=E[R+0],Qe=Ve,jt=Ve;for(Ue=0;Ue<Re;++Ue)Qe=jt+(Ve=E[R+Ue])-Qe,jt=ee[me+Ue]+(-256&Qe?0>Qe?0:255:Qe)&255,Qe=Ve,Ie[Te+Ue]=jt}}function vi(E,R,ee,me){var Ie=R.width,Te=R.o;if(t(E!=null&&R!=null),0>ee||0>=me||ee+me>Te)return null;if(!E.Cc){if(E.ga==null){var Re;if(E.ga=new Va,(Re=E.ga==null)||(Re=R.width*R.o,t(E.Gb.length==0),E.Gb=i(Re),E.Uc=0,E.Gb==null?Re=0:(E.mb=E.Gb,E.nb=E.Uc,E.rc=null,Re=1),Re=!Re),!Re){Re=E.ga;var Ue=E.Fa,Ve=E.P,Qe=E.qc,jt=E.mb,Ut=E.nb,Ze=Ve+1,Nt=Qe-1,Tt=Re.l;if(t(Ue!=null&&jt!=null&&R!=null),Ph[0]=null,Ph[1]=Wn,Ph[2]=ri,Ph[3]=Wa,Re.ca=jt,Re.tb=Ut,Re.c=R.width,Re.i=R.height,t(0<Re.c&&0<Re.i),1>=Qe)R=0;else if(Re.$a=3&Ue[Ve+0],Re.Z=Ue[Ve+0]>>2&3,Re.Lc=Ue[Ve+0]>>4&3,Ve=Ue[Ve+0]>>6&3,0>Re.$a||1<Re.$a||4<=Re.Z||1<Re.Lc||Ve)R=0;else if(Tt.put=Gt,Tt.ac=It,Tt.bc=qt,Tt.ma=Re,Tt.width=R.width,Tt.height=R.height,Tt.Da=R.Da,Tt.v=R.v,Tt.va=R.va,Tt.j=R.j,Tt.o=R.o,Re.$a)e:{t(Re.$a==1),R=Vs();t:for(;;){if(R==null){R=0;break e}if(t(Re!=null),Re.mc=R,R.c=Re.c,R.i=Re.i,R.l=Re.l,R.l.ma=Re,R.l.width=Re.c,R.l.height=Re.i,R.a=0,U(R.m,Ue,Ze,Nt),!Ws(Re.c,Re.i,1,R,null)||(R.ab==1&&R.gc[0].hc==3&&Et(R.s)?(Re.ic=1,Ue=R.c*R.i,R.Ta=null,R.Ua=0,R.V=i(Ue),R.Ba=0,R.V==null?(R.a=1,R=0):R=1):(Re.ic=0,R=Ns(R,Re.c)),!R))break t;R=1;break e}Re.mc=null,R=0}else R=Nt>=Re.c*Re.i;Re=!R}if(Re)return null;E.ga.Lc!=1?E.Ga=0:me=Te-ee}t(E.ga!=null),t(ee+me<=Te);e:{if(R=(Ue=E.ga).c,Te=Ue.l.o,Ue.$a==0){if(Ze=E.rc,Nt=E.Vc,Tt=E.Fa,Ve=E.P+1+ee*R,Qe=E.mb,jt=E.nb+ee*R,t(Ve<=E.P+E.qc),Ue.Z!=0)for(t(Ph[Ue.Z]!=null),Re=0;Re<me;++Re)Ph[Ue.Z](Ze,Nt,Tt,Ve,Qe,jt,R),Ze=Qe,Nt=jt,jt+=R,Ve+=R;else for(Re=0;Re<me;++Re)n(Qe,jt,Tt,Ve,R),Ze=Qe,Nt=jt,jt+=R,Ve+=R;E.rc=Ze,E.Vc=Nt}else{if(t(Ue.mc!=null),R=ee+me,t((Re=Ue.mc)!=null),t(R<=Re.i),Re.C>=R)R=1;else if(Ue.ic||io(),Ue.ic){Ue=Re.V,Ze=Re.Ba,Nt=Re.c;var os=Re.i,Lt=(Tt=1,Ve=Re.$/Nt,Qe=Re.$%Nt,jt=Re.m,Ut=Re.s,Re.$),cs=Nt*os,hs=Nt*R,Es=Ut.wc,ws=Lt<hs?gt(Ut,Qe,Ve):null;t(Lt<=cs),t(R<=os),t(Et(Ut));t:for(;;){for(;!jt.h&&Lt<hs;){if(Qe&Es||(ws=gt(Ut,Qe,Ve)),t(ws!=null),be(jt),256>(os=Ct(ws.G[0],ws.H[0],jt)))Ue[Ze+Lt]=os,++Lt,++Qe>=Nt&&(Qe=0,++Ve<=R&&!(Ve%16)&&rs(Re,Ve));else{if(!(280>os)){Tt=0;break t}os=Ht(os-256,jt);var Nr,rr=Ct(ws.G[4],ws.H[4],jt);if(be(jt),!(Lt>=(rr=xs(Nt,rr=Ht(rr,jt)))&&cs-Lt>=os)){Tt=0;break t}for(Nr=0;Nr<os;++Nr)Ue[Ze+Lt+Nr]=Ue[Ze+Lt+Nr-rr];for(Lt+=os,Qe+=os;Qe>=Nt;)Qe-=Nt,++Ve<=R&&!(Ve%16)&&rs(Re,Ve);Lt<hs&&Qe&Es&&(ws=gt(Ut,Qe,Ve))}t(jt.h==se(jt))}rs(Re,Ve>R?R:Ve);break t}!Tt||jt.h&&Lt<cs?(Tt=0,Re.a=jt.h?5:3):Re.$=Lt,R=Tt}else R=ms(Re,Re.V,Re.Ba,Re.c,Re.i,R,er);if(!R){me=0;break e}}ee+me>=Te&&(E.Cc=1),me=1}if(!me)return null;if(E.Cc&&((me=E.ga)!=null&&(me.mc=null),E.ga=null,0<E.Ga))return alert("todo:WebPDequantizeLevels"),null}return E.nb+ee*Ie}function pl(E,R,ee,me,Ie,Te){for(;0<Ie--;){var Re,Ue=E,Ve=R+(ee?1:0),Qe=E,jt=R+(ee?0:3);for(Re=0;Re<me;++Re){var Ut=Qe[jt+4*Re];Ut!=255&&(Ut*=32897,Ue[Ve+4*Re+0]=Ue[Ve+4*Re+0]*Ut>>23,Ue[Ve+4*Re+1]=Ue[Ve+4*Re+1]*Ut>>23,Ue[Ve+4*Re+2]=Ue[Ve+4*Re+2]*Ut>>23)}R+=Te}}function Bl(E,R,ee,me,Ie){for(;0<me--;){var Te;for(Te=0;Te<ee;++Te){var Re=E[R+2*Te+0],Ue=15&(Qe=E[R+2*Te+1]),Ve=4369*Ue,Qe=(240&Qe|Qe>>4)*Ve>>16;E[R+2*Te+0]=(240&Re|Re>>4)*Ve>>16&240|(15&Re|Re<<4)*Ve>>16>>4&15,E[R+2*Te+1]=240&Qe|Ue}R+=Ie}}function _r(E,R,ee,me,Ie,Te,Re,Ue){var Ve,Qe,jt=255;for(Qe=0;Qe<Ie;++Qe){for(Ve=0;Ve<me;++Ve){var Ut=E[R+Ve];Te[Re+4*Ve]=Ut,jt&=Ut}R+=ee,Re+=Ue}return jt!=255}function Ha(E,R,ee,me,Ie){var Te;for(Te=0;Te<Ie;++Te)ee[me+Te]=E[R+Te]>>8}function io(){Vg=pl,rI=Bl,nI=_r,aI=Ha}function ae(E,R,ee){k[E]=function(me,Ie,Te,Re,Ue,Ve,Qe,jt,Ut,Ze,Nt,Tt,os,Lt,cs,hs,Es){var ws,Nr=Es-1>>1,rr=Ue[Ve+0]|Qe[jt+0]<<16,xn=Ut[Ze+0]|Nt[Tt+0]<<16;t(me!=null);var mr=3*rr+xn+131074>>2;for(R(me[Ie+0],255&mr,mr>>16,os,Lt),Te!=null&&(mr=3*xn+rr+131074>>2,R(Te[Re+0],255&mr,mr>>16,cs,hs)),ws=1;ws<=Nr;++ws){var Un=Ue[Ve+ws]|Qe[jt+ws]<<16,oo=Ut[Ze+ws]|Nt[Tt+ws]<<16,pn=rr+Un+xn+oo+524296,fr=pn+2*(Un+xn)>>3;mr=fr+rr>>1,rr=(pn=pn+2*(rr+oo)>>3)+Un>>1,R(me[Ie+2*ws-1],255&mr,mr>>16,os,Lt+(2*ws-1)*ee),R(me[Ie+2*ws-0],255&rr,rr>>16,os,Lt+(2*ws-0)*ee),Te!=null&&(mr=pn+xn>>1,rr=fr+oo>>1,R(Te[Re+2*ws-1],255&mr,mr>>16,cs,hs+(2*ws-1)*ee),R(Te[Re+2*ws+0],255&rr,rr>>16,cs,hs+(2*ws+0)*ee)),rr=Un,xn=oo}1&Es||(mr=3*rr+xn+131074>>2,R(me[Ie+Es-1],255&mr,mr>>16,os,Lt+(Es-1)*ee),Te!=null&&(mr=3*xn+rr+131074>>2,R(Te[Re+Es-1],255&mr,mr>>16,cs,hs+(Es-1)*ee)))}}function Ke(){Mc[Iy]=jW,Mc[Py]=pI,Mc[uI]=bW,Mc[_y]=gI,Mc[ky]=vI,Mc[ww]=yI,Mc[hI]=NW,Mc[Sw]=pI,Mc[Cw]=gI,Mc[Ty]=vI,Mc[Aw]=yI}function Bt(E){return E&-16384?0>E?0:255:E>>wW}function Yt(E,R){return Bt((19077*E>>8)+(26149*R>>8)-14234)}function Fs(E,R,ee){return Bt((19077*E>>8)-(6419*R>>8)-(13320*ee>>8)+8708)}function zr(E,R){return Bt((19077*E>>8)+(33050*R>>8)-17685)}function Ms(E,R,ee,me,Ie){me[Ie+0]=Yt(E,ee),me[Ie+1]=Fs(E,R,ee),me[Ie+2]=zr(E,R)}function bn(E,R,ee,me,Ie){me[Ie+0]=zr(E,R),me[Ie+1]=Fs(E,R,ee),me[Ie+2]=Yt(E,ee)}function tl(E,R,ee,me,Ie){var Te=Fs(E,R,ee);R=Te<<3&224|zr(E,R)>>3,me[Ie+0]=248&Yt(E,ee)|Te>>5,me[Ie+1]=R}function wi(E,R,ee,me,Ie){var Te=240&zr(E,R)|15;me[Ie+0]=240&Yt(E,ee)|Fs(E,R,ee)>>4,me[Ie+1]=Te}function Rc(E,R,ee,me,Ie){me[Ie+0]=255,Ms(E,R,ee,me,Ie+1)}function Ul(E,R,ee,me,Ie){bn(E,R,ee,me,Ie),me[Ie+3]=255}function Mn(E,R,ee,me,Ie){Ms(E,R,ee,me,Ie),me[Ie+3]=255}function Cn(E,R){return 0>E?0:E>R?R:E}function Bn(E,R,ee){k[E]=function(me,Ie,Te,Re,Ue,Ve,Qe,jt,Ut){for(var Ze=jt+(-2&Ut)*ee;jt!=Ze;)R(me[Ie+0],Te[Re+0],Ue[Ve+0],Qe,jt),R(me[Ie+1],Te[Re+0],Ue[Ve+0],Qe,jt+ee),Ie+=2,++Re,++Ve,jt+=2*ee;1&Ut&&R(me[Ie+0],Te[Re+0],Ue[Ve+0],Qe,jt)}}function gl(E,R,ee){return ee==0?E==0?R==0?6:5:R==0?4:0:ee}function vl(E,R,ee,me,Ie){switch(E>>>30){case 3:Ri(R,ee,me,Ie,0);break;case 2:Cu(R,ee,me,Ie);break;case 1:Vd(R,ee,me,Ie)}}function Vo(E,R){var ee,me,Ie=R.M,Te=R.Nb,Re=E.oc,Ue=E.pc+40,Ve=E.oc,Qe=E.pc+584,jt=E.oc,Ut=E.pc+600;for(ee=0;16>ee;++ee)Re[Ue+32*ee-1]=129;for(ee=0;8>ee;++ee)Ve[Qe+32*ee-1]=129,jt[Ut+32*ee-1]=129;for(0<Ie?Re[Ue-1-32]=Ve[Qe-1-32]=jt[Ut-1-32]=129:(a(Re,Ue-32-1,127,21),a(Ve,Qe-32-1,127,9),a(jt,Ut-32-1,127,9)),me=0;me<E.za;++me){var Ze=R.ya[R.aa+me];if(0<me){for(ee=-1;16>ee;++ee)n(Re,Ue+32*ee-4,Re,Ue+32*ee+12,4);for(ee=-1;8>ee;++ee)n(Ve,Qe+32*ee-4,Ve,Qe+32*ee+4,4),n(jt,Ut+32*ee-4,jt,Ut+32*ee+4,4)}var Nt=E.Gd,Tt=E.Hd+me,os=Ze.ad,Lt=Ze.Hc;if(0<Ie&&(n(Re,Ue-32,Nt[Tt].y,0,16),n(Ve,Qe-32,Nt[Tt].f,0,8),n(jt,Ut-32,Nt[Tt].ea,0,8)),Ze.Za){var cs=Re,hs=Ue-32+16;for(0<Ie&&(me>=E.za-1?a(cs,hs,Nt[Tt].y[15],4):n(cs,hs,Nt[Tt+1].y,0,4)),ee=0;4>ee;ee++)cs[hs+128+ee]=cs[hs+256+ee]=cs[hs+384+ee]=cs[hs+0+ee];for(ee=0;16>ee;++ee,Lt<<=2)cs=Re,hs=Ue+bI[ee],ud[Ze.Ob[ee]](cs,hs),vl(Lt,os,16*+ee,cs,hs)}else if(cs=gl(me,Ie,Ze.Ob[0]),Ih[cs](Re,Ue),Lt!=0)for(ee=0;16>ee;++ee,Lt<<=2)vl(Lt,os,16*+ee,Re,Ue+bI[ee]);for(ee=Ze.Gc,cs=gl(me,Ie,Ze.Dd),Au[cs](Ve,Qe),Au[cs](jt,Ut),Lt=os,cs=Ve,hs=Qe,255&(Ze=0|ee)&&(170&Ze?Cx(Lt,256,cs,hs):qg(Lt,256,cs,hs)),Ze=jt,Lt=Ut,255&(ee>>=8)&&(170&ee?Cx(os,320,Ze,Lt):qg(os,320,Ze,Lt)),Ie<E.Ub-1&&(n(Nt[Tt].y,0,Re,Ue+480,16),n(Nt[Tt].f,0,Ve,Qe+224,8),n(Nt[Tt].ea,0,jt,Ut+224,8)),ee=8*Te*E.B,Nt=E.sa,Tt=E.ta+16*me+16*Te*E.R,os=E.qa,Ze=E.ra+8*me+ee,Lt=E.Ha,cs=E.Ia+8*me+ee,ee=0;16>ee;++ee)n(Nt,Tt+ee*E.R,Re,Ue+32*ee,16);for(ee=0;8>ee;++ee)n(os,Ze+ee*E.B,Ve,Qe+32*ee,8),n(Lt,cs+ee*E.B,jt,Ut+32*ee,8)}}function bx(E,R,ee,me,Ie,Te,Re,Ue,Ve){var Qe=[0],jt=[0],Ut=0,Ze=Ve!=null?Ve.kd:0,Nt=Ve??new Ot;if(E==null||12>ee)return 7;Nt.data=E,Nt.w=R,Nt.ha=ee,R=[R],ee=[ee],Nt.gb=[Nt.gb];e:{var Tt=R,os=ee,Lt=Nt.gb;if(t(E!=null),t(os!=null),t(Lt!=null),Lt[0]=0,12<=os[0]&&!r(E,Tt[0],"RIFF")){if(r(E,Tt[0]+8,"WEBP")){Lt=3;break e}var cs=re(E,Tt[0]+4);if(12>cs||4294967286<cs){Lt=3;break e}if(Ze&&cs>os[0]-8){Lt=7;break e}Lt[0]=cs,Tt[0]+=12,os[0]-=12}Lt=0}if(Lt!=0)return Lt;for(cs=0<Nt.gb[0],ee=ee[0];;){e:{var hs=E;os=R,Lt=ee;var Es=Qe,ws=jt,Nr=Tt=[0];if((mr=Ut=[Ut])[0]=0,8>Lt[0])Lt=7;else{if(!r(hs,os[0],"VP8X")){if(re(hs,os[0]+4)!=10){Lt=3;break e}if(18>Lt[0]){Lt=7;break e}var rr=re(hs,os[0]+8),xn=1+te(hs,os[0]+12);if(2147483648<=xn*(hs=1+te(hs,os[0]+15))){Lt=3;break e}Nr!=null&&(Nr[0]=rr),Es!=null&&(Es[0]=xn),ws!=null&&(ws[0]=hs),os[0]+=18,Lt[0]-=18,mr[0]=1}Lt=0}}if(Ut=Ut[0],Tt=Tt[0],Lt!=0)return Lt;if(os=!!(2&Tt),!cs&&Ut)return 3;if(Te!=null&&(Te[0]=!!(16&Tt)),Re!=null&&(Re[0]=os),Ue!=null&&(Ue[0]=0),Re=Qe[0],Tt=jt[0],Ut&&os&&Ve==null){Lt=0;break}if(4>ee){Lt=7;break}if(cs&&Ut||!cs&&!Ut&&!r(E,R[0],"ALPH")){ee=[ee],Nt.na=[Nt.na],Nt.P=[Nt.P],Nt.Sa=[Nt.Sa];e:{rr=E,Lt=R,cs=ee;var mr=Nt.gb;Es=Nt.na,ws=Nt.P,Nr=Nt.Sa,xn=22,t(rr!=null),t(cs!=null),hs=Lt[0];var Un=cs[0];for(t(Es!=null),t(Nr!=null),Es[0]=null,ws[0]=null,Nr[0]=0;;){if(Lt[0]=hs,cs[0]=Un,8>Un){Lt=7;break e}var oo=re(rr,hs+4);if(4294967286<oo){Lt=3;break e}var pn=8+oo+1&-2;if(xn+=pn,0<mr&&xn>mr){Lt=3;break e}if(!r(rr,hs,"VP8 ")||!r(rr,hs,"VP8L")){Lt=0;break e}if(Un[0]<pn){Lt=7;break e}r(rr,hs,"ALPH")||(Es[0]=rr,ws[0]=hs+8,Nr[0]=oo),hs+=pn,Un-=pn}}if(ee=ee[0],Nt.na=Nt.na[0],Nt.P=Nt.P[0],Nt.Sa=Nt.Sa[0],Lt!=0)break}ee=[ee],Nt.Ja=[Nt.Ja],Nt.xa=[Nt.xa];e:if(mr=E,Lt=R,cs=ee,Es=Nt.gb[0],ws=Nt.Ja,Nr=Nt.xa,rr=Lt[0],hs=!r(mr,rr,"VP8 "),xn=!r(mr,rr,"VP8L"),t(mr!=null),t(cs!=null),t(ws!=null),t(Nr!=null),8>cs[0])Lt=7;else{if(hs||xn){if(mr=re(mr,rr+4),12<=Es&&mr>Es-12){Lt=3;break e}if(Ze&&mr>cs[0]-8){Lt=7;break e}ws[0]=mr,Lt[0]+=8,cs[0]-=8,Nr[0]=xn}else Nr[0]=5<=cs[0]&&mr[rr+0]==47&&!(mr[rr+4]>>5),ws[0]=cs[0];Lt=0}if(ee=ee[0],Nt.Ja=Nt.Ja[0],Nt.xa=Nt.xa[0],R=R[0],Lt!=0)break;if(4294967286<Nt.Ja)return 3;if(Ue==null||os||(Ue[0]=Nt.xa?2:1),Re=[Re],Tt=[Tt],Nt.xa){if(5>ee){Lt=7;break}Ue=Re,Ze=Tt,os=Te,E==null||5>ee?E=0:5<=ee&&E[R+0]==47&&!(E[R+4]>>5)?(cs=[0],mr=[0],Es=[0],U(ws=new q,E,R,ee),As(ws,cs,mr,Es)?(Ue!=null&&(Ue[0]=cs[0]),Ze!=null&&(Ze[0]=mr[0]),os!=null&&(os[0]=Es[0]),E=1):E=0):E=0}else{if(10>ee){Lt=7;break}Ue=Tt,E==null||10>ee||!ps(E,R+3,ee-3)?E=0:(Ze=E[R+0]|E[R+1]<<8|E[R+2]<<16,os=16383&(E[R+7]<<8|E[R+6]),E=16383&(E[R+9]<<8|E[R+8]),1&Ze||3<(Ze>>1&7)||!(Ze>>4&1)||Ze>>5>=Nt.Ja||!os||!E?E=0:(Re&&(Re[0]=os),Ue&&(Ue[0]=E),E=1))}if(!E||(Re=Re[0],Tt=Tt[0],Ut&&(Qe[0]!=Re||jt[0]!=Tt)))return 3;Ve!=null&&(Ve[0]=Nt,Ve.offset=R-Ve.w,t(4294967286>R-Ve.w),t(Ve.offset==Ve.ha-ee));break}return Lt==0||Lt==7&&Ut&&Ve==null?(Te!=null&&(Te[0]|=Nt.na!=null&&0<Nt.na.length),me!=null&&(me[0]=Re),Ie!=null&&(Ie[0]=Tt),0):Lt}function zl(E,R,ee){var me=R.width,Ie=R.height,Te=0,Re=0,Ue=me,Ve=Ie;if(R.Da=E!=null&&0<E.Da,R.Da&&(Ue=E.cd,Ve=E.bd,Te=E.v,Re=E.j,11>ee||(Te&=-2,Re&=-2),0>Te||0>Re||0>=Ue||0>=Ve||Te+Ue>me||Re+Ve>Ie))return 0;if(R.v=Te,R.j=Re,R.va=Te+Ue,R.o=Re+Ve,R.U=Ue,R.T=Ve,R.da=E!=null&&0<E.da,R.da){if(!X(Ue,Ve,ee=[E.ib],Te=[E.hb]))return 0;R.ib=ee[0],R.hb=Te[0]}return R.ob=E!=null&&E.ob,R.Kb=E==null||!E.Sd,R.da&&(R.ob=R.ib<3*me/4&&R.hb<3*Ie/4,R.Kb=0),1}function ql(E){if(E==null)return 2;if(11>E.S){var R=E.f.RGBA;R.fb+=(E.height-1)*R.A,R.A=-R.A}else R=E.f.kb,E=E.height,R.O+=(E-1)*R.fa,R.fa=-R.fa,R.N+=(E-1>>1)*R.Ab,R.Ab=-R.Ab,R.W+=(E-1>>1)*R.Db,R.Db=-R.Db,R.F!=null&&(R.J+=(E-1)*R.lb,R.lb=-R.lb);return 0}function Jm(E,R,ee,me){if(me==null||0>=E||0>=R)return 2;if(ee!=null){if(ee.Da){var Ie=ee.cd,Te=ee.bd,Re=-2&ee.v,Ue=-2&ee.j;if(0>Re||0>Ue||0>=Ie||0>=Te||Re+Ie>E||Ue+Te>R)return 2;E=Ie,R=Te}if(ee.da){if(!X(E,R,Ie=[ee.ib],Te=[ee.hb]))return 2;E=Ie[0],R=Te[0]}}me.width=E,me.height=R;e:{var Ve=me.width,Qe=me.height;if(E=me.S,0>=Ve||0>=Qe||!(E>=Iy&&13>E))E=2;else{if(0>=me.Rd&&me.sd==null){Re=Te=Ie=R=0;var jt=(Ue=Ve*NI[E])*Qe;if(11>E||(Te=(Qe+1)/2*(R=(Ve+1)/2),E==12&&(Re=(Ie=Ve)*Qe)),(Qe=i(jt+2*Te+Re))==null){E=1;break e}me.sd=Qe,11>E?((Ve=me.f.RGBA).eb=Qe,Ve.fb=0,Ve.A=Ue,Ve.size=jt):((Ve=me.f.kb).y=Qe,Ve.O=0,Ve.fa=Ue,Ve.Fd=jt,Ve.f=Qe,Ve.N=0+jt,Ve.Ab=R,Ve.Cd=Te,Ve.ea=Qe,Ve.W=0+jt+Te,Ve.Db=R,Ve.Ed=Te,E==12&&(Ve.F=Qe,Ve.J=0+jt+2*Te),Ve.Tc=Re,Ve.lb=Ie)}if(R=1,Ie=me.S,Te=me.width,Re=me.height,Ie>=Iy&&13>Ie)if(11>Ie)E=me.f.RGBA,R&=(Ue=Math.abs(E.A))*(Re-1)+Te<=E.size,R&=Ue>=Te*NI[Ie],R&=E.eb!=null;else{E=me.f.kb,Ue=(Te+1)/2,jt=(Re+1)/2,Ve=Math.abs(E.fa),Qe=Math.abs(E.Ab);var Ut=Math.abs(E.Db),Ze=Math.abs(E.lb),Nt=Ze*(Re-1)+Te;R&=Ve*(Re-1)+Te<=E.Fd,R&=Qe*(jt-1)+Ue<=E.Cd,R=(R&=Ut*(jt-1)+Ue<=E.Ed)&Ve>=Te&Qe>=Ue&Ut>=Ue,R&=E.y!=null,R&=E.f!=null,R&=E.ea!=null,Ie==12&&(R&=Ze>=Te,R&=Nt<=E.Tc,R&=E.F!=null)}else R=0;E=R?0:2}}return E!=0||ee!=null&&ee.fd&&(E=ql(me)),E}var Bd=64,Ah=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Bg=24,Eh=32,Di=8,bw=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ue("Predictor0","PredictorAdd0"),k.Predictor0=function(){return 4278190080},k.Predictor1=function(E){return E},k.Predictor2=function(E,R,ee){return R[ee+0]},k.Predictor3=function(E,R,ee){return R[ee+1]},k.Predictor4=function(E,R,ee){return R[ee-1]},k.Predictor5=function(E,R,ee){return Le(Le(E,R[ee+1]),R[ee+0])},k.Predictor6=function(E,R,ee){return Le(E,R[ee-1])},k.Predictor7=function(E,R,ee){return Le(E,R[ee+0])},k.Predictor8=function(E,R,ee){return Le(R[ee-1],R[ee+0])},k.Predictor9=function(E,R,ee){return Le(R[ee+0],R[ee+1])},k.Predictor10=function(E,R,ee){return Le(Le(E,R[ee-1]),Le(R[ee+0],R[ee+1]))},k.Predictor11=function(E,R,ee){var me=R[ee+0];return 0>=fe(me>>24&255,E>>24&255,(R=R[ee-1])>>24&255)+fe(me>>16&255,E>>16&255,R>>16&255)+fe(me>>8&255,E>>8&255,R>>8&255)+fe(255&me,255&E,255&R)?me:E},k.Predictor12=function(E,R,ee){var me=R[ee+0];return(Me((E>>24&255)+(me>>24&255)-((R=R[ee-1])>>24&255))<<24|Me((E>>16&255)+(me>>16&255)-(R>>16&255))<<16|Me((E>>8&255)+(me>>8&255)-(R>>8&255))<<8|Me((255&E)+(255&me)-(255&R)))>>>0},k.Predictor13=function(E,R,ee){var me=R[ee-1];return(tt((E=Le(E,R[ee+0]))>>24&255,me>>24&255)<<24|tt(E>>16&255,me>>16&255)<<16|tt(E>>8&255,me>>8&255)<<8|tt(255&E,255&me))>>>0};var Ud=k.PredictorAdd0;k.PredictorAdd1=ct,ue("Predictor2","PredictorAdd2"),ue("Predictor3","PredictorAdd3"),ue("Predictor4","PredictorAdd4"),ue("Predictor5","PredictorAdd5"),ue("Predictor6","PredictorAdd6"),ue("Predictor7","PredictorAdd7"),ue("Predictor8","PredictorAdd8"),ue("Predictor9","PredictorAdd9"),ue("Predictor10","PredictorAdd10"),ue("Predictor11","PredictorAdd11"),ue("Predictor12","PredictorAdd12"),ue("Predictor13","PredictorAdd13");var zd=k.PredictorAdd2;mt("ColorIndexInverseTransform","MapARGB","32b",function(E){return E>>8&255},function(E){return E}),mt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(E){return E},function(E){return E>>8&255});var Nx,Ug=k.ColorIndexInverseTransform,wx=k.MapARGB,Sx=k.VP8LColorIndexInverseTransformAlpha,Xm=k.MapAlpha,Qm=k.VP8LPredictorsAdd=[];Qm.length=16,(k.VP8LPredictors=[]).length=16,(k.VP8LPredictorsAdd_C=[]).length=16,(k.VP8LPredictors_C=[]).length=16;var Su,zg,dc,qd,Ga,Ka,Oi,Ri,Cu,Cx,Vd,qg,WE,HE,GE,KE,YE,JE,XE,QE,ZE,eI,tI,sI,Vg,rI,nI,aI,iI=i(511),oI=i(2041),lI=i(225),cI=i(767),dI=0,Nw=oI,Ey=lI,uc=cI,Fc=iI,Iy=0,Py=1,uI=2,_y=3,ky=4,ww=5,hI=6,Sw=7,Cw=8,Ty=9,Aw=10,iW=[2,3,7],oW=[3,3,11],mI=[280,256,256,256,40],lW=[0,1,1,1,0],cW=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],dW=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],uW=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],hW=8,Ew=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Iw=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Wg=null,mW=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],fW=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],fI=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],xW=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],pW=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],gW=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],vW=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ih=[],ud=[],Au=[],yW=1,xI=2,Ph=[],Mc=[];ae("UpsampleRgbLinePair",Ms,3),ae("UpsampleBgrLinePair",bn,3),ae("UpsampleRgbaLinePair",Mn,4),ae("UpsampleBgraLinePair",Ul,4),ae("UpsampleArgbLinePair",Rc,4),ae("UpsampleRgba4444LinePair",wi,2),ae("UpsampleRgb565LinePair",tl,2);var jW=k.UpsampleRgbLinePair,bW=k.UpsampleBgrLinePair,pI=k.UpsampleRgbaLinePair,gI=k.UpsampleBgraLinePair,vI=k.UpsampleArgbLinePair,yI=k.UpsampleRgba4444LinePair,NW=k.UpsampleRgb565LinePair,Dy=16,Oy=1<<Dy-1,Hg=-227,Pw=482,wW=6,jI=0,SW=i(256),CW=i(256),AW=i(256),EW=i(256),IW=i(Pw-Hg),PW=i(Pw-Hg);Bn("YuvToRgbRow",Ms,3),Bn("YuvToBgrRow",bn,3),Bn("YuvToRgbaRow",Mn,4),Bn("YuvToBgraRow",Ul,4),Bn("YuvToArgbRow",Rc,4),Bn("YuvToRgba4444Row",wi,2),Bn("YuvToRgb565Row",tl,2);var bI=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Ry=[0,2,8],_W=[8,7,6,4,4,2,2,2,1,1,1,1],kW=1;this.WebPDecodeRGBA=function(E,R,ee,me,Ie){var Te=Py,Re=new je,Ue=new et;Re.ba=Ue,Ue.S=Te,Ue.width=[Ue.width],Ue.height=[Ue.height];var Ve=Ue.width,Qe=Ue.height,jt=new lt;if(jt==null||E==null)var Ut=2;else t(jt!=null),Ut=bx(E,R,ee,jt.width,jt.height,jt.Pd,jt.Qd,jt.format,null);if(Ut!=0?Ve=0:(Ve!=null&&(Ve[0]=jt.width[0]),Qe!=null&&(Qe[0]=jt.height[0]),Ve=1),Ve){Ue.width=Ue.width[0],Ue.height=Ue.height[0],me!=null&&(me[0]=Ue.width),Ie!=null&&(Ie[0]=Ue.height);e:{if(me=new Pe,(Ie=new Ot).data=E,Ie.w=R,Ie.ha=ee,Ie.kd=1,R=[0],t(Ie!=null),((E=bx(Ie.data,Ie.w,Ie.ha,null,null,null,R,null,Ie))==0||E==7)&&R[0]&&(E=4),(R=E)==0){if(t(Re!=null),me.data=Ie.data,me.w=Ie.w+Ie.offset,me.ha=Ie.ha-Ie.offset,me.put=Gt,me.ac=It,me.bc=qt,me.ma=Re,Ie.xa){if((E=Vs())==null){Re=1;break e}if(function(Ze,Nt){var Tt=[0],os=[0],Lt=[0];t:for(;;){if(Ze==null)return 0;if(Nt==null)return Ze.a=2,0;if(Ze.l=Nt,Ze.a=0,U(Ze.m,Nt.data,Nt.w,Nt.ha),!As(Ze.m,Tt,os,Lt)){Ze.a=3;break t}if(Ze.xb=xI,Nt.width=Tt[0],Nt.height=os[0],!Ws(Tt[0],os[0],1,Ze,null))break t;return 1}return t(Ze.a!=0),0}(E,me)){if(me=(R=Jm(me.width,me.height,Re.Oa,Re.ba))==0){t:{me=E;s:for(;;){if(me==null){me=0;break t}if(t(me.s.yc!=null),t(me.s.Ya!=null),t(0<me.s.Wb),t((ee=me.l)!=null),t((Ie=ee.ma)!=null),me.xb!=0){if(me.ca=Ie.ba,me.tb=Ie.tb,t(me.ca!=null),!zl(Ie.Oa,ee,_y)){me.a=2;break s}if(!Ns(me,ee.width)||ee.da)break s;if((ee.da||zt(me.ca.S))&&io(),11>me.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),me.ca.f.kb.F!=null&&io()),me.Pb&&0<me.s.ua&&me.s.vb.X==null&&!le(me.s.vb,me.s.Wa.Xa)){me.a=1;break s}me.xb=0}if(!ms(me,me.V,me.Ba,me.c,me.i,ee.o,We))break s;Ie.Dc=me.Ma,me=1;break t}t(me.a!=0),me=0}me=!me}me&&(R=E.a)}else R=E.a}else{if((E=new _t)==null){Re=1;break e}if(E.Fa=Ie.na,E.P=Ie.P,E.qc=Ie.Sa,Pr(E,me)){if((R=Jm(me.width,me.height,Re.Oa,Re.ba))==0){if(E.Aa=0,ee=Re.Oa,t((Ie=E)!=null),ee!=null){if(0<(Ve=0>(Ve=ee.Md)?0:100<Ve?255:255*Ve/100)){for(Qe=jt=0;4>Qe;++Qe)12>(Ut=Ie.pb[Qe]).lc&&(Ut.ia=Ve*_W[0>Ut.lc?0:Ut.lc]>>3),jt|=Ut.ia;jt&&(alert("todo:VP8InitRandom"),Ie.ia=1)}Ie.Ga=ee.Id,100<Ie.Ga?Ie.Ga=100:0>Ie.Ga&&(Ie.Ga=0)}(function(Ze,Nt){if(Ze==null)return 0;if(Nt==null)return bt(Ze,2,"NULL VP8Io parameter in VP8Decode().");if(!Ze.cb&&!Pr(Ze,Nt))return 0;if(t(Ze.cb),Nt.ac==null||Nt.ac(Nt)){Nt.ob&&(Ze.L=0);var Tt=Ry[Ze.L];if(Ze.L==2?(Ze.yb=0,Ze.zb=0):(Ze.yb=Nt.v-Tt>>4,Ze.zb=Nt.j-Tt>>4,0>Ze.yb&&(Ze.yb=0),0>Ze.zb&&(Ze.zb=0)),Ze.Va=Nt.o+15+Tt>>4,Ze.Hb=Nt.va+15+Tt>>4,Ze.Hb>Ze.za&&(Ze.Hb=Ze.za),Ze.Va>Ze.Ub&&(Ze.Va=Ze.Ub),0<Ze.L){var os=Ze.ed;for(Tt=0;4>Tt;++Tt){var Lt;if(Ze.Qa.Cb){var cs=Ze.Qa.Lb[Tt];Ze.Qa.Fb||(cs+=os.Tb)}else cs=os.Tb;for(Lt=0;1>=Lt;++Lt){var hs=Ze.gd[Tt][Lt],Es=cs;if(os.Pc&&(Es+=os.vd[0],Lt&&(Es+=os.od[0])),0<(Es=0>Es?0:63<Es?63:Es)){var ws=Es;0<os.wb&&(ws=4<os.wb?ws>>2:ws>>1)>9-os.wb&&(ws=9-os.wb),1>ws&&(ws=1),hs.dd=ws,hs.tc=2*Es+ws,hs.ld=40<=Es?2:15<=Es?1:0}else hs.tc=0;hs.La=Lt}}}Tt=0}else bt(Ze,6,"Frame setup failed"),Tt=Ze.a;if(Tt=Tt==0){if(Tt){Ze.$c=0,0<Ze.Aa||(Ze.Ic=kW);t:{Tt=Ze.Ic,os=4*(ws=Ze.za);var Nr=32*ws,rr=ws+1,xn=0<Ze.L?ws*(0<Ze.Aa?2:1):0,mr=(Ze.Aa==2?2:1)*ws;if((hs=os+832+(Lt=3*(16*Tt+Ry[Ze.L])/2*Nr)+(cs=Ze.Fa!=null&&0<Ze.Fa.length?Ze.Kc.c*Ze.Kc.i:0))!=hs)Tt=0;else{if(hs>Ze.Vb){if(Ze.Vb=0,Ze.Ec=i(hs),Ze.Fc=0,Ze.Ec==null){Tt=bt(Ze,1,"no memory during frame initialization.");break t}Ze.Vb=hs}hs=Ze.Ec,Es=Ze.Fc,Ze.Ac=hs,Ze.Bc=Es,Es+=os,Ze.Gd=o(Nr,De),Ze.Hd=0,Ze.rb=o(rr+1,$r),Ze.sb=1,Ze.wa=xn?o(xn,Yr):null,Ze.Y=0,Ze.D.Nb=0,Ze.D.wa=Ze.wa,Ze.D.Y=Ze.Y,0<Ze.Aa&&(Ze.D.Y+=ws),t(!0),Ze.oc=hs,Ze.pc=Es,Es+=832,Ze.ya=o(mr,wn),Ze.aa=0,Ze.D.ya=Ze.ya,Ze.D.aa=Ze.aa,Ze.Aa==2&&(Ze.D.aa+=ws),Ze.R=16*ws,Ze.B=8*ws,ws=(Nr=Ry[Ze.L])*Ze.R,Nr=Nr/2*Ze.B,Ze.sa=hs,Ze.ta=Es+ws,Ze.qa=Ze.sa,Ze.ra=Ze.ta+16*Tt*Ze.R+Nr,Ze.Ha=Ze.qa,Ze.Ia=Ze.ra+8*Tt*Ze.B+Nr,Ze.$c=0,Es+=Lt,Ze.mb=cs?hs:null,Ze.nb=cs?Es:null,t(Es+cs<=Ze.Fc+Ze.Vb),Zs(Ze),a(Ze.Ac,Ze.Bc,0,os),Tt=1}}if(Tt){if(Nt.ka=0,Nt.y=Ze.sa,Nt.O=Ze.ta,Nt.f=Ze.qa,Nt.N=Ze.ra,Nt.ea=Ze.Ha,Nt.Vd=Ze.Ia,Nt.fa=Ze.R,Nt.Rc=Ze.B,Nt.F=null,Nt.J=0,!dI){for(Tt=-255;255>=Tt;++Tt)iI[255+Tt]=0>Tt?-Tt:Tt;for(Tt=-1020;1020>=Tt;++Tt)oI[1020+Tt]=-128>Tt?-128:127<Tt?127:Tt;for(Tt=-112;112>=Tt;++Tt)lI[112+Tt]=-16>Tt?-16:15<Tt?15:Tt;for(Tt=-255;510>=Tt;++Tt)cI[255+Tt]=0>Tt?0:255<Tt?255:Tt;dI=1}Oi=mi,Ri=Gi,Cx=Ti,Vd=Ea,qg=Ki,Cu=Hi,WE=H,HE=Ce,GE=wt,KE=Qt,YE=Ge,JE=ht,XE=vs,QE=Js,ZE=Fn,eI=Rr,tI=$,sI=Xt,ud[0]=$n,ud[1]=fi,ud[2]=fn,ud[3]=xi,ud[4]=Ur,ud[5]=Ji,ud[6]=Yi,ud[7]=rn,ud[8]=zo,ud[9]=Ll,Ih[0]=Ft,Ih[1]=Ne,Ih[2]=Dt,Ih[3]=ye,Ih[4]=Kt,Ih[5]=Jt,Ih[6]=kt,Au[0]=qo,Au[1]=qa,Au[2]=Qo,Au[3]=Xi,Au[4]=Zo,Au[5]=$l,Au[6]=el,Tt=1}else Tt=0}Tt&&(Tt=function(Un,oo){for(Un.M=0;Un.M<Un.Va;++Un.M){var pn,fr=Un.Jc[Un.M&Un.Xb],Gs=Un.m,Fi=Un;for(pn=0;pn<Fi.za;++pn){var nn=Gs,Hn=Fi,ni=Hn.Ac,Wo=Hn.Bc+4*pn,yl=Hn.zc,Si=Hn.ya[Hn.aa+pn];if(Hn.Qa.Bb?Si.$b=Ee(nn,Hn.Pa.jb[0])?2+Ee(nn,Hn.Pa.jb[2]):Ee(nn,Hn.Pa.jb[1]):Si.$b=0,Hn.kc&&(Si.Ad=Ee(nn,Hn.Bd)),Si.Za=!Ee(nn,145)+0,Si.Za){var sl=Si.Ob,jl=0;for(Hn=0;4>Hn;++Hn){var lo,Yn=yl[0+Hn];for(lo=0;4>lo;++lo){Yn=pW[ni[Wo+lo]][Yn];for(var pa=fI[Ee(nn,Yn[0])];0<pa;)pa=fI[2*pa+Ee(nn,Yn[pa])];Yn=-pa,ni[Wo+lo]=Yn}n(sl,jl,ni,Wo,4),jl+=4,yl[0+Hn]=Yn}}else Yn=Ee(nn,156)?Ee(nn,128)?1:3:Ee(nn,163)?2:0,Si.Ob[0]=Yn,a(ni,Wo,Yn,4),a(yl,0,Yn,4);Si.Dd=Ee(nn,142)?Ee(nn,114)?Ee(nn,183)?1:3:2:0}if(Fi.m.Ka)return bt(Un,7,"Premature end-of-partition0 encountered.");for(;Un.ja<Un.za;++Un.ja){if(Fi=fr,nn=(Gs=Un).rb[Gs.sb-1],ni=Gs.rb[Gs.sb+Gs.ja],pn=Gs.ya[Gs.aa+Gs.ja],Wo=Gs.kc?pn.Ad:0)nn.la=ni.la=0,pn.Za||(nn.Na=ni.Na=0),pn.Hc=0,pn.Gc=0,pn.ia=0;else{var Ci,ga;if(nn=ni,ni=Fi,Wo=Gs.Pa.Xc,yl=Gs.ya[Gs.aa+Gs.ja],Si=Gs.pb[yl.$b],Hn=yl.ad,sl=0,jl=Gs.rb[Gs.sb-1],Yn=lo=0,a(Hn,sl,0,384),yl.Za)var Ho=0,hd=Wo[3];else{pa=i(16);var Mi=nn.Na+jl.Na;if(Mi=Wg(ni,Wo[1],Mi,Si.Eb,0,pa,0),nn.Na=jl.Na=(0<Mi)+0,1<Mi)Oi(pa,0,Hn,sl);else{var Vl=pa[0]+3>>3;for(pa=0;256>pa;pa+=16)Hn[sl+pa]=Vl}Ho=1,hd=Wo[0]}var Oa=15&nn.la,co=15&jl.la;for(pa=0;4>pa;++pa){var hc=1&co;for(Vl=ga=0;4>Vl;++Vl)Oa=Oa>>1|(hc=(Mi=Wg(ni,hd,Mi=hc+(1&Oa),Si.Sc,Ho,Hn,sl))>Ho)<<7,ga=ga<<2|(3<Mi?3:1<Mi?2:Hn[sl+0]!=0),sl+=16;Oa>>=4,co=co>>1|hc<<7,lo=(lo<<8|ga)>>>0}for(hd=Oa,Ho=co>>4,Ci=0;4>Ci;Ci+=2){for(ga=0,Oa=nn.la>>4+Ci,co=jl.la>>4+Ci,pa=0;2>pa;++pa){for(hc=1&co,Vl=0;2>Vl;++Vl)Mi=hc+(1&Oa),Oa=Oa>>1|(hc=0<(Mi=Wg(ni,Wo[2],Mi,Si.Qc,0,Hn,sl)))<<3,ga=ga<<2|(3<Mi?3:1<Mi?2:Hn[sl+0]!=0),sl+=16;Oa>>=2,co=co>>1|hc<<5}Yn|=ga<<4*Ci,hd|=Oa<<4<<Ci,Ho|=(240&co)<<Ci}nn.la=hd,jl.la=Ho,yl.Hc=lo,yl.Gc=Yn,yl.ia=43690&Yn?0:Si.ia,Wo=!(lo|Yn)}if(0<Gs.L&&(Gs.wa[Gs.Y+Gs.ja]=Gs.gd[pn.$b][pn.Za],Gs.wa[Gs.Y+Gs.ja].La|=!Wo),Fi.Ka)return bt(Un,7,"Premature end-of-file encountered.")}if(Zs(Un),Gs=oo,Fi=1,pn=(fr=Un).D,nn=0<fr.L&&fr.M>=fr.zb&&fr.M<=fr.Va,fr.Aa==0)t:{if(pn.M=fr.M,pn.uc=nn,Vo(fr,pn),Fi=1,pn=(ga=fr.D).Nb,nn=(Yn=Ry[fr.L])*fr.R,ni=Yn/2*fr.B,pa=16*pn*fr.R,Vl=8*pn*fr.B,Wo=fr.sa,yl=fr.ta-nn+pa,Si=fr.qa,Hn=fr.ra-ni+Vl,sl=fr.Ha,jl=fr.Ia-ni+Vl,co=(Oa=ga.M)==0,lo=Oa>=fr.Va-1,fr.Aa==2&&Vo(fr,ga),ga.uc)for(hc=(Mi=fr).D.M,t(Mi.D.uc),ga=Mi.yb;ga<Mi.Hb;++ga){Ho=ga,hd=hc;var bl=(mc=(Go=Mi).D).Nb;Ci=Go.R;var mc=mc.wa[mc.Y+Ho],fc=Go.sa,Wl=Go.ta+16*bl*Ci+16*Ho,xc=mc.dd,Ya=mc.tc;if(Ya!=0)if(t(3<=Ya),Go.L==1)0<Ho&&eI(fc,Wl,Ci,Ya+4),mc.La&&sI(fc,Wl,Ci,Ya),0<hd&&ZE(fc,Wl,Ci,Ya+4),mc.La&&tI(fc,Wl,Ci,Ya);else{var pc=Go.B,md=Go.qa,Zm=Go.ra+8*bl*pc+8*Ho,Eu=Go.Ha,Go=Go.Ia+8*bl*pc+8*Ho;bl=mc.ld,0<Ho&&(HE(fc,Wl,Ci,Ya+4,xc,bl),KE(md,Zm,Eu,Go,pc,Ya+4,xc,bl)),mc.La&&(JE(fc,Wl,Ci,Ya,xc,bl),QE(md,Zm,Eu,Go,pc,Ya,xc,bl)),0<hd&&(WE(fc,Wl,Ci,Ya+4,xc,bl),GE(md,Zm,Eu,Go,pc,Ya+4,xc,bl)),mc.La&&(YE(fc,Wl,Ci,Ya,xc,bl),XE(md,Zm,Eu,Go,pc,Ya,xc,bl))}}if(fr.ia&&alert("todo:DitherRow"),Gs.put!=null){if(ga=16*Oa,Oa=16*(Oa+1),co?(Gs.y=fr.sa,Gs.O=fr.ta+pa,Gs.f=fr.qa,Gs.N=fr.ra+Vl,Gs.ea=fr.Ha,Gs.W=fr.Ia+Vl):(ga-=Yn,Gs.y=Wo,Gs.O=yl,Gs.f=Si,Gs.N=Hn,Gs.ea=sl,Gs.W=jl),lo||(Oa-=Yn),Oa>Gs.o&&(Oa=Gs.o),Gs.F=null,Gs.J=null,fr.Fa!=null&&0<fr.Fa.length&&ga<Oa&&(Gs.J=vi(fr,Gs,ga,Oa-ga),Gs.F=fr.mb,Gs.F==null&&Gs.F.length==0)){Fi=bt(fr,3,"Could not decode alpha data.");break t}ga<Gs.j&&(Yn=Gs.j-ga,ga=Gs.j,t(!(1&Yn)),Gs.O+=fr.R*Yn,Gs.N+=fr.B*(Yn>>1),Gs.W+=fr.B*(Yn>>1),Gs.F!=null&&(Gs.J+=Gs.width*Yn)),ga<Oa&&(Gs.O+=Gs.v,Gs.N+=Gs.v>>1,Gs.W+=Gs.v>>1,Gs.F!=null&&(Gs.J+=Gs.v),Gs.ka=ga-Gs.j,Gs.U=Gs.va-Gs.v,Gs.T=Oa-ga,Fi=Gs.put(Gs))}pn+1!=fr.Ic||lo||(n(fr.sa,fr.ta-nn,Wo,yl+16*fr.R,nn),n(fr.qa,fr.ra-ni,Si,Hn+8*fr.B,ni),n(fr.Ha,fr.Ia-ni,sl,jl+8*fr.B,ni))}if(!Fi)return bt(Un,6,"Output aborted.")}return 1}(Ze,Nt)),Nt.bc!=null&&Nt.bc(Nt),Tt&=1}return Tt?(Ze.cb=0,Tt):0})(E,me)||(R=E.a)}}else R=E.a}R==0&&Re.Oa!=null&&Re.Oa.fd&&(R=ql(Re.ba))}Re=R}Te=Re!=0?null:11>Te?Ue.f.RGBA.eb:Ue.f.kb.y}else Te=null;return Te};var NI=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(k,F){for(var A="",T=0;T<4;T++)A+=String.fromCharCode(k[F++]);return A}function u(k,F){return k[F+0]|k[F+1]<<8}function h(k,F){return(k[F+0]|k[F+1]<<8|k[F+2]<<16)>>>0}function f(k,F){return(k[F+0]|k[F+1]<<8|k[F+2]<<16|k[F+3]<<24)>>>0}new c;var m=[0],p=[0],g=[],v=new c,y=s,j=function(k,F){var A={},T=0,V=!1,M=0,G=0;if(A.frames=[],!function(P,q){for(var D=0;D<4;D++)if(P[q+D]!="RIFF".charCodeAt(D))return!0;return!1}(k,F)){for(f(k,F+=4),F+=8;F<k.length;){var L=d(k,F),J=f(k,F+=4);F+=4;var z=J+(1&J);switch(L){case"VP8 ":case"VP8L":A.frames[T]===void 0&&(A.frames[T]={}),(Q=A.frames[T]).src_off=V?G:F-8,Q.src_size=M+J+8,T++,V&&(V=!1,M=0,G=0);break;case"VP8X":(Q=A.header={}).feature_flags=k[F];var U=F+4;Q.canvas_width=1+h(k,U),U+=3,Q.canvas_height=1+h(k,U),U+=3;break;case"ALPH":V=!0,M=z+8,G=F-8;break;case"ANIM":(Q=A.header).bgcolor=f(k,F),U=F+4,Q.loop_count=u(k,U),U+=2;break;case"ANMF":var oe,Q;(Q=A.frames[T]={}).offset_x=2*h(k,F),F+=3,Q.offset_y=2*h(k,F),F+=3,Q.width=1+h(k,F),F+=3,Q.height=1+h(k,F),F+=3,Q.duration=h(k,F),F+=3,oe=k[F++],Q.dispose=1&oe,Q.blend=oe>>1&1}L!="ANMF"&&(F+=z)}return A}}(y,0);j.response=y,j.rgbaoutput=!0,j.dataurl=!1;var b=j.header?j.header:null,w=j.frames?j.frames:null;if(b){b.loop_counter=b.loop_count,m=[b.canvas_height],p=[b.canvas_width];for(var N=0;N<w.length&&w[N].blend!=0;N++);}var C=w[0],S=v.WebPDecodeRGBA(y,C.src_off,C.src_size,p,m);C.rgba=S,C.imgwidth=p[0],C.imgheight=m[0];for(var _=0;_<p[0]*m[0]*4;_++)g[_]=S[_];return this.width=p,this.height=m,this.data=g,this}(function(s){var t,r,n,a,i,o,l,c,d,u=function(P){return P=P||{},this.isStrokeTransparent=P.isStrokeTransparent||!1,this.strokeOpacity=P.strokeOpacity||1,this.strokeStyle=P.strokeStyle||"#000000",this.fillStyle=P.fillStyle||"#000000",this.isFillTransparent=P.isFillTransparent||!1,this.fillOpacity=P.fillOpacity||1,this.font=P.font||"10px sans-serif",this.textBaseline=P.textBaseline||"alphabetic",this.textAlign=P.textAlign||"left",this.lineWidth=P.lineWidth||1,this.lineJoin=P.lineJoin||"miter",this.lineCap=P.lineCap||"butt",this.path=P.path||[],this.transform=P.transform!==void 0?P.transform.clone():new c,this.globalCompositeOperation=P.globalCompositeOperation||"normal",this.globalAlpha=P.globalAlpha||1,this.clip_path=P.clip_path||[],this.currentPoint=P.currentPoint||new o,this.miterLimit=P.miterLimit||10,this.lastPoint=P.lastPoint||new o,this.lineDashOffset=P.lineDashOffset||0,this.lineDash=P.lineDash||[],this.margin=P.margin||[0,0,0,0],this.prevPageLastElemOffset=P.prevPageLastElemOffset||0,this.ignoreClearRect=typeof P.ignoreClearRect!="boolean"||P.ignoreClearRect,this};s.events.push(["initialized",function(){this.context2d=new h(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,d=new u}]);var h=function(P){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var q=P;Object.defineProperty(this,"pdf",{get:function(){return q}});var D=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return D},set:function(re){D=!!re}});var se=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return se},set:function(re){se=!!re}});var he=0;Object.defineProperty(this,"posX",{get:function(){return he},set:function(re){isNaN(re)||(he=re)}});var be=0;Object.defineProperty(this,"posY",{get:function(){return be},set:function(re){isNaN(re)||(be=re)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(re){var le;typeof re=="number"?le=[re,re,re,re]:((le=new Array(4))[0]=re[0],le[1]=re.length>=2?re[1]:le[0],le[2]=re.length>=3?re[2]:le[0],le[3]=re.length>=4?re[3]:le[1]),d.margin=le}});var pe=!1;Object.defineProperty(this,"autoPaging",{get:function(){return pe},set:function(re){pe=re}});var Ae=0;Object.defineProperty(this,"lastBreak",{get:function(){return Ae},set:function(re){Ae=re}});var Ee=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Ee},set:function(re){Ee=re}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(re){re instanceof u&&(d=re)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(re){d.path=re}});var $e=[];Object.defineProperty(this,"ctxStack",{get:function(){return $e},set:function(re){$e=re}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(re){var le;le=f(re),this.ctx.fillStyle=le.style,this.ctx.isFillTransparent=le.a===0,this.ctx.fillOpacity=le.a,this.pdf.setFillColor(le.r,le.g,le.b,{a:le.a}),this.pdf.setTextColor(le.r,le.g,le.b,{a:le.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(re){var le=f(re);this.ctx.strokeStyle=le.style,this.ctx.isStrokeTransparent=le.a===0,this.ctx.strokeOpacity=le.a,le.a===0?this.pdf.setDrawColor(255,255,255):(le.a,this.pdf.setDrawColor(le.r,le.g,le.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(re){["butt","round","square"].indexOf(re)!==-1&&(this.ctx.lineCap=re,this.pdf.setLineCap(re))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(re){isNaN(re)||(this.ctx.lineWidth=re,this.pdf.setLineWidth(re))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(re){["bevel","round","miter"].indexOf(re)!==-1&&(this.ctx.lineJoin=re,this.pdf.setLineJoin(re))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(re){isNaN(re)||(this.ctx.miterLimit=re,this.pdf.setMiterLimit(re))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(re){this.ctx.textBaseline=re}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(re){["right","end","center","left","start"].indexOf(re)!==-1&&(this.ctx.textAlign=re)}});var O=null,te=null;Object.defineProperty(this,"fontFaces",{get:function(){return te},set:function(re){O=null,te=re}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(re){var le;if(this.ctx.font=re,(le=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(re))!==null){var Z=le[1];le[2];var K=le[3],X=le[4];le[5];var ce=le[6],Y=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(X)[2];X=Math.floor(Y==="px"?parseFloat(X)*this.pdf.internal.scaleFactor:Y==="em"?parseFloat(X)*this.pdf.getFontSize():parseFloat(X)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(X);var ue=function(qe){var mt,Rt,_e=[],Xe=qe.trim();if(Xe==="")return O2;if(Xe in a_)return[a_[Xe]];for(;Xe!=="";){switch(Rt=null,mt=(Xe=o_(Xe)).charAt(0)){case'"':case"'":Rt=yae(Xe.substring(1),mt);break;default:Rt=jae(Xe)}if(Rt===null||(_e.push(Rt[0]),(Xe=o_(Rt[1]))!==""&&Xe.charAt(0)!==","))return O2;Xe=Xe.replace(/^,/,"")}return _e}(ce);if(this.fontFaces){var ve=function(qe,mt){if(O===null){var Rt=function(_e){var Xe=[];return Object.keys(_e).forEach(function(At){_e[At].forEach(function(st){var $t=null;switch(st){case"bold":$t={family:At,weight:"bold"};break;case"italic":$t={family:At,style:"italic"};break;case"bolditalic":$t={family:At,weight:"bold",style:"italic"};break;case"":case"normal":$t={family:At}}$t!==null&&($t.ref={name:At,style:st},Xe.push($t))})}),Xe}(qe.getFontList());O=function(_e){for(var Xe={},At=0;At<_e.length;++At){var st=D2(_e[At]),$t=st.family,fs=st.stretch,zt=st.style,St=st.weight;Xe[$t]=Xe[$t]||{},Xe[$t][fs]=Xe[$t][fs]||{},Xe[$t][fs][zt]=Xe[$t][fs][zt]||{},Xe[$t][fs][zt][St]=st}return Xe}(Rt.concat(mt))}return O}(this.pdf,this.fontFaces),Le=ue.map(function(qe){return{family:qe,stretch:"normal",weight:K,style:Z}}),Me=function(qe,mt,Rt){for(var _e=(Rt=Rt||{}).defaultFontFamily||"times",Xe=Object.assign({},vae,Rt.genericFontFamilies||{}),At=null,st=null,$t=0;$t<mt.length;++$t)if(Xe[(At=D2(mt[$t])).family]&&(At.family=Xe[At.family]),qe.hasOwnProperty(At.family)){st=qe[At.family];break}if(!(st=st||qe[_e]))throw new Error("Could not find a font-family for the rule '"+i_(At)+"' and default family '"+_e+"'.");if(st=function(fs,zt){if(zt[fs])return zt[fs];var St=r4[fs],js=St<=r4.normal?-1:1,et=n_(zt,b$,St,js);if(!et)throw new Error("Could not find a matching font-stretch value for "+fs);return et}(At.stretch,st),st=function(fs,zt){if(zt[fs])return zt[fs];for(var St=j$[fs],js=0;js<St.length;++js)if(zt[St[js]])return zt[St[js]];throw new Error("Could not find a matching font-style for "+fs)}(At.style,st),!(st=function(fs,zt){if(zt[fs])return zt[fs];if(fs===400&&zt[500])return zt[500];if(fs===500&&zt[400])return zt[400];var St=gae[fs],js=n_(zt,N$,St,fs<400?-1:1);if(!js)throw new Error("Could not find a matching font-weight for value "+fs);return js}(At.weight,st)))throw new Error("Failed to resolve a font for the rule '"+i_(At)+"'.");return st}(ve,Le);this.pdf.setFont(Me.ref.name,Me.ref.style)}else{var tt="";(K==="bold"||parseInt(K,10)>=700||Z==="bold")&&(tt="bold"),Z==="italic"&&(tt+="italic"),tt.length===0&&(tt="normal");for(var fe="",ct={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},dt=0;dt<ue.length;dt++){if(this.pdf.internal.getFont(ue[dt],tt,{noFallback:!0,disableWarning:!0})!==void 0){fe=ue[dt];break}if(tt==="bolditalic"&&this.pdf.internal.getFont(ue[dt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)fe=ue[dt],tt="bold";else if(this.pdf.internal.getFont(ue[dt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){fe=ue[dt],tt="normal";break}}if(fe===""){for(var pt=0;pt<ue.length;pt++)if(ct[ue[pt]]){fe=ct[ue[pt]];break}}fe=fe===""?"Times":fe,this.pdf.setFont(fe,tt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(re){this.ctx.globalCompositeOperation=re}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(re){this.ctx.globalAlpha=re}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(re){this.ctx.lineDashOffset=re,Q.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(re){this.ctx.lineDash=re,Q.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(re){this.ctx.ignoreClearRect=!!re}})};h.prototype.setLineDash=function(P){this.lineDash=P},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){w.call(this,"fill",!1)},h.prototype.stroke=function(){w.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(P,q){if(isNaN(P)||isNaN(q))throw Ma.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var D=this.ctx.transform.applyToPoint(new o(P,q));this.path.push({type:"mt",x:D.x,y:D.y}),this.ctx.lastPoint=new o(P,q)},h.prototype.closePath=function(){var P=new o(0,0),q=0;for(q=this.path.length-1;q!==-1;q--)if(this.path[q].type==="begin"&&Na(this.path[q+1])==="object"&&typeof this.path[q+1].x=="number"){P=new o(this.path[q+1].x,this.path[q+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(P.x,P.y)},h.prototype.lineTo=function(P,q){if(isNaN(P)||isNaN(q))throw Ma.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var D=this.ctx.transform.applyToPoint(new o(P,q));this.path.push({type:"lt",x:D.x,y:D.y}),this.ctx.lastPoint=new o(D.x,D.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),w.call(this,null,!0)},h.prototype.quadraticCurveTo=function(P,q,D,se){if(isNaN(D)||isNaN(se)||isNaN(P)||isNaN(q))throw Ma.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var he=this.ctx.transform.applyToPoint(new o(D,se)),be=this.ctx.transform.applyToPoint(new o(P,q));this.path.push({type:"qct",x1:be.x,y1:be.y,x:he.x,y:he.y}),this.ctx.lastPoint=new o(he.x,he.y)},h.prototype.bezierCurveTo=function(P,q,D,se,he,be){if(isNaN(he)||isNaN(be)||isNaN(P)||isNaN(q)||isNaN(D)||isNaN(se))throw Ma.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var pe=this.ctx.transform.applyToPoint(new o(he,be)),Ae=this.ctx.transform.applyToPoint(new o(P,q)),Ee=this.ctx.transform.applyToPoint(new o(D,se));this.path.push({type:"bct",x1:Ae.x,y1:Ae.y,x2:Ee.x,y2:Ee.y,x:pe.x,y:pe.y}),this.ctx.lastPoint=new o(pe.x,pe.y)},h.prototype.arc=function(P,q,D,se,he,be){if(isNaN(P)||isNaN(q)||isNaN(D)||isNaN(se)||isNaN(he))throw Ma.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(be=!!be,!this.ctx.transform.isIdentity){var pe=this.ctx.transform.applyToPoint(new o(P,q));P=pe.x,q=pe.y;var Ae=this.ctx.transform.applyToPoint(new o(0,D)),Ee=this.ctx.transform.applyToPoint(new o(0,0));D=Math.sqrt(Math.pow(Ae.x-Ee.x,2)+Math.pow(Ae.y-Ee.y,2))}Math.abs(he-se)>=2*Math.PI&&(se=0,he=2*Math.PI),this.path.push({type:"arc",x:P,y:q,radius:D,startAngle:se,endAngle:he,counterclockwise:be})},h.prototype.arcTo=function(P,q,D,se,he){throw new Error("arcTo not implemented.")},h.prototype.rect=function(P,q,D,se){if(isNaN(P)||isNaN(q)||isNaN(D)||isNaN(se))throw Ma.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(P,q),this.lineTo(P+D,q),this.lineTo(P+D,q+se),this.lineTo(P,q+se),this.lineTo(P,q),this.lineTo(P+D,q),this.lineTo(P,q)},h.prototype.fillRect=function(P,q,D,se){if(isNaN(P)||isNaN(q)||isNaN(D)||isNaN(se))throw Ma.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var he={};this.lineCap!=="butt"&&(he.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(he.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(P,q,D,se),this.fill(),he.hasOwnProperty("lineCap")&&(this.lineCap=he.lineCap),he.hasOwnProperty("lineJoin")&&(this.lineJoin=he.lineJoin)}},h.prototype.strokeRect=function(P,q,D,se){if(isNaN(P)||isNaN(q)||isNaN(D)||isNaN(se))throw Ma.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");p.call(this)||(this.beginPath(),this.rect(P,q,D,se),this.stroke())},h.prototype.clearRect=function(P,q,D,se){if(isNaN(P)||isNaN(q)||isNaN(D)||isNaN(se))throw Ma.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(P,q,D,se))},h.prototype.save=function(P){P=typeof P!="boolean"||P;for(var q=this.pdf.internal.getCurrentPageInfo().pageNumber,D=0;D<this.pdf.internal.getNumberOfPages();D++)this.pdf.setPage(D+1),this.pdf.internal.out("q");if(this.pdf.setPage(q),P){this.ctx.fontSize=this.pdf.internal.getFontSize();var se=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=se}},h.prototype.restore=function(P){P=typeof P!="boolean"||P;for(var q=this.pdf.internal.getCurrentPageInfo().pageNumber,D=0;D<this.pdf.internal.getNumberOfPages();D++)this.pdf.setPage(D+1),this.pdf.internal.out("Q");this.pdf.setPage(q),P&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var f=function(P){var q,D,se,he;if(P.isCanvasGradient===!0&&(P=P.getColor()),!P)return{r:0,g:0,b:0,a:0,style:P};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(P))q=0,D=0,se=0,he=0;else{var be=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(P);if(be!==null)q=parseInt(be[1]),D=parseInt(be[2]),se=parseInt(be[3]),he=1;else if((be=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(P))!==null)q=parseInt(be[1]),D=parseInt(be[2]),se=parseInt(be[3]),he=parseFloat(be[4]);else{if(he=1,typeof P=="string"&&P.charAt(0)!=="#"){var pe=new m$(P);P=pe.ok?pe.toHex():"#000000"}P.length===4?(q=P.substring(1,2),q+=q,D=P.substring(2,3),D+=D,se=P.substring(3,4),se+=se):(q=P.substring(1,3),D=P.substring(3,5),se=P.substring(5,7)),q=parseInt(q,16),D=parseInt(D,16),se=parseInt(se,16)}}return{r:q,g:D,b:se,a:he,style:P}},m=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},p=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};h.prototype.fillText=function(P,q,D,se){if(isNaN(q)||isNaN(D)||typeof P!="string")throw Ma.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(se=isNaN(se)?void 0:se,!m.call(this)){var he=z(this.ctx.transform.rotation),be=this.ctx.transform.scaleX;T.call(this,{text:P,x:q,y:D,scale:be,angle:he,align:this.textAlign,maxWidth:se})}},h.prototype.strokeText=function(P,q,D,se){if(isNaN(q)||isNaN(D)||typeof P!="string")throw Ma.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!p.call(this)){se=isNaN(se)?void 0:se;var he=z(this.ctx.transform.rotation),be=this.ctx.transform.scaleX;T.call(this,{text:P,x:q,y:D,scale:be,renderingMode:"stroke",angle:he,align:this.textAlign,maxWidth:se})}},h.prototype.measureText=function(P){if(typeof P!="string")throw Ma.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var q=this.pdf,D=this.pdf.internal.scaleFactor,se=q.internal.getFontSize(),he=q.getStringUnitWidth(P)*se/q.internal.scaleFactor;return new function(be){var pe=(be=be||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return pe}}),this}({width:he*=Math.round(96*D/72*1e4)/1e4})},h.prototype.scale=function(P,q){if(isNaN(P)||isNaN(q))throw Ma.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var D=new c(P,0,0,q,0,0);this.ctx.transform=this.ctx.transform.multiply(D)},h.prototype.rotate=function(P){if(isNaN(P))throw Ma.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var q=new c(Math.cos(P),Math.sin(P),-Math.sin(P),Math.cos(P),0,0);this.ctx.transform=this.ctx.transform.multiply(q)},h.prototype.translate=function(P,q){if(isNaN(P)||isNaN(q))throw Ma.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var D=new c(1,0,0,1,P,q);this.ctx.transform=this.ctx.transform.multiply(D)},h.prototype.transform=function(P,q,D,se,he,be){if(isNaN(P)||isNaN(q)||isNaN(D)||isNaN(se)||isNaN(he)||isNaN(be))throw Ma.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var pe=new c(P,q,D,se,he,be);this.ctx.transform=this.ctx.transform.multiply(pe)},h.prototype.setTransform=function(P,q,D,se,he,be){P=isNaN(P)?1:P,q=isNaN(q)?0:q,D=isNaN(D)?0:D,se=isNaN(se)?1:se,he=isNaN(he)?0:he,be=isNaN(be)?0:be,this.ctx.transform=new c(P,q,D,se,he,be)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(P,q,D,se,he,be,pe,Ae,Ee){var $e=this.pdf.getImageProperties(P),O=1,te=1,re=1,le=1;se!==void 0&&Ae!==void 0&&(re=Ae/se,le=Ee/he,O=$e.width/se*Ae/se,te=$e.height/he*Ee/he),be===void 0&&(be=q,pe=D,q=0,D=0),se!==void 0&&Ae===void 0&&(Ae=se,Ee=he),se===void 0&&Ae===void 0&&(Ae=$e.width,Ee=$e.height);for(var Z,K=this.ctx.transform.decompose(),X=z(K.rotate.shx),ce=new c,Y=(ce=(ce=(ce=ce.multiply(K.translate)).multiply(K.skew)).multiply(K.scale)).applyToRectangle(new l(be-q*re,pe-D*le,se*O,he*te)),ue=v.call(this,Y),ve=[],Le=0;Le<ue.length;Le+=1)ve.indexOf(ue[Le])===-1&&ve.push(ue[Le]);if(b(ve),this.autoPaging)for(var Me=ve[0],tt=ve[ve.length-1],fe=Me;fe<tt+1;fe++){this.pdf.setPage(fe);var ct=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],dt=fe===1?this.posY+this.margin[0]:this.margin[0],pt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],qe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],mt=fe===1?0:pt+(fe-2)*qe;if(this.ctx.clip_path.length!==0){var Rt=this.path;Z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=j(Z,this.posX+this.margin[3],-mt+dt+this.ctx.prevPageLastElemOffset),N.call(this,"fill",!0),this.path=Rt}var _e=JSON.parse(JSON.stringify(Y));_e=j([_e],this.posX+this.margin[3],-mt+dt+this.ctx.prevPageLastElemOffset)[0];var Xe=(fe>Me||fe<tt)&&g.call(this);Xe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ct,qe,null).clip().discardPath()),this.pdf.addImage(P,"JPEG",_e.x,_e.y,_e.w,_e.h,null,null,X),Xe&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(P,"JPEG",Y.x,Y.y,Y.w,Y.h,null,null,X)};var v=function(P,q,D){var se=[];q=q||this.pdf.internal.pageSize.width,D=D||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var he=this.posY+this.ctx.prevPageLastElemOffset;switch(P.type){default:case"mt":case"lt":se.push(Math.floor((P.y+he)/D)+1);break;case"arc":se.push(Math.floor((P.y+he-P.radius)/D)+1),se.push(Math.floor((P.y+he+P.radius)/D)+1);break;case"qct":var be=U(this.ctx.lastPoint.x,this.ctx.lastPoint.y,P.x1,P.y1,P.x,P.y);se.push(Math.floor((be.y+he)/D)+1),se.push(Math.floor((be.y+be.h+he)/D)+1);break;case"bct":var pe=oe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,P.x1,P.y1,P.x2,P.y2,P.x,P.y);se.push(Math.floor((pe.y+he)/D)+1),se.push(Math.floor((pe.y+pe.h+he)/D)+1);break;case"rect":se.push(Math.floor((P.y+he)/D)+1),se.push(Math.floor((P.y+P.h+he)/D)+1)}for(var Ae=0;Ae<se.length;Ae+=1)for(;this.pdf.internal.getNumberOfPages()<se[Ae];)y.call(this);return se},y=function(){var P=this.fillStyle,q=this.strokeStyle,D=this.font,se=this.lineCap,he=this.lineWidth,be=this.lineJoin;this.pdf.addPage(),this.fillStyle=P,this.strokeStyle=q,this.font=D,this.lineCap=se,this.lineWidth=he,this.lineJoin=be},j=function(P,q,D){for(var se=0;se<P.length;se++)switch(P[se].type){case"bct":P[se].x2+=q,P[se].y2+=D;case"qct":P[se].x1+=q,P[se].y1+=D;default:P[se].x+=q,P[se].y+=D}return P},b=function(P){return P.sort(function(q,D){return q-D})},w=function(P,q){for(var D,se,he=this.fillStyle,be=this.strokeStyle,pe=this.lineCap,Ae=this.lineWidth,Ee=Math.abs(Ae*this.ctx.transform.scaleX),$e=this.lineJoin,O=JSON.parse(JSON.stringify(this.path)),te=JSON.parse(JSON.stringify(this.path)),re=[],le=0;le<te.length;le++)if(te[le].x!==void 0)for(var Z=v.call(this,te[le]),K=0;K<Z.length;K+=1)re.indexOf(Z[K])===-1&&re.push(Z[K]);for(var X=0;X<re.length;X++)for(;this.pdf.internal.getNumberOfPages()<re[X];)y.call(this);if(b(re),this.autoPaging)for(var ce=re[0],Y=re[re.length-1],ue=ce;ue<Y+1;ue++){this.pdf.setPage(ue),this.fillStyle=he,this.strokeStyle=be,this.lineCap=pe,this.lineWidth=Ee,this.lineJoin=$e;var ve=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Le=ue===1?this.posY+this.margin[0]:this.margin[0],Me=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],tt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],fe=ue===1?0:Me+(ue-2)*tt;if(this.ctx.clip_path.length!==0){var ct=this.path;D=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=j(D,this.posX+this.margin[3],-fe+Le+this.ctx.prevPageLastElemOffset),N.call(this,P,!0),this.path=ct}if(se=JSON.parse(JSON.stringify(O)),this.path=j(se,this.posX+this.margin[3],-fe+Le+this.ctx.prevPageLastElemOffset),q===!1||ue===0){var dt=(ue>ce||ue<Y)&&g.call(this);dt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ve,tt,null).clip().discardPath()),N.call(this,P,q),dt&&this.pdf.restoreGraphicsState()}this.lineWidth=Ae}else this.lineWidth=Ee,N.call(this,P,q),this.lineWidth=Ae;this.path=O},N=function(P,q){if((P!=="stroke"||q||!p.call(this))&&(P==="stroke"||q||!m.call(this))){for(var D,se,he=[],be=this.path,pe=0;pe<be.length;pe++){var Ae=be[pe];switch(Ae.type){case"begin":he.push({begin:!0});break;case"close":he.push({close:!0});break;case"mt":he.push({start:Ae,deltas:[],abs:[]});break;case"lt":var Ee=he.length;if(be[pe-1]&&!isNaN(be[pe-1].x)&&(D=[Ae.x-be[pe-1].x,Ae.y-be[pe-1].y],Ee>0)){for(;Ee>=0;Ee--)if(he[Ee-1].close!==!0&&he[Ee-1].begin!==!0){he[Ee-1].deltas.push(D),he[Ee-1].abs.push(Ae);break}}break;case"bct":D=[Ae.x1-be[pe-1].x,Ae.y1-be[pe-1].y,Ae.x2-be[pe-1].x,Ae.y2-be[pe-1].y,Ae.x-be[pe-1].x,Ae.y-be[pe-1].y],he[he.length-1].deltas.push(D);break;case"qct":var $e=be[pe-1].x+2/3*(Ae.x1-be[pe-1].x),O=be[pe-1].y+2/3*(Ae.y1-be[pe-1].y),te=Ae.x+2/3*(Ae.x1-Ae.x),re=Ae.y+2/3*(Ae.y1-Ae.y),le=Ae.x,Z=Ae.y;D=[$e-be[pe-1].x,O-be[pe-1].y,te-be[pe-1].x,re-be[pe-1].y,le-be[pe-1].x,Z-be[pe-1].y],he[he.length-1].deltas.push(D);break;case"arc":he.push({deltas:[],abs:[],arc:!0}),Array.isArray(he[he.length-1].abs)&&he[he.length-1].abs.push(Ae)}}se=q?null:P==="stroke"?"stroke":"fill";for(var K=!1,X=0;X<he.length;X++)if(he[X].arc)for(var ce=he[X].abs,Y=0;Y<ce.length;Y++){var ue=ce[Y];ue.type==="arc"?_.call(this,ue.x,ue.y,ue.radius,ue.startAngle,ue.endAngle,ue.counterclockwise,void 0,q,!K):V.call(this,ue.x,ue.y),K=!0}else if(he[X].close===!0)this.pdf.internal.out("h"),K=!1;else if(he[X].begin!==!0){var ve=he[X].start.x,Le=he[X].start.y;M.call(this,he[X].deltas,ve,Le),K=!0}se&&k.call(this,se),q&&F.call(this)}},C=function(P){var q=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,D=q*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return P-D;case"top":return P+q-D;case"hanging":return P+q-2*D;case"middle":return P+q/2-D;default:return P}},S=function(P){return P+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var P=function(){};return P.colorStops=[],P.addColorStop=function(q,D){this.colorStops.push([q,D])},P.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},P.isCanvasGradient=!0,P},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var _=function(P,q,D,se,he,be,pe,Ae,Ee){for(var $e=L.call(this,D,se,he,be),O=0;O<$e.length;O++){var te=$e[O];O===0&&(Ee?A.call(this,te.x1+P,te.y1+q):V.call(this,te.x1+P,te.y1+q)),G.call(this,P,q,te.x2,te.y2,te.x3,te.y3,te.x4,te.y4)}Ae?F.call(this):k.call(this,pe)},k=function(P){switch(P){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},F=function(){this.pdf.clip(),this.pdf.discardPath()},A=function(P,q){this.pdf.internal.out(r(P)+" "+n(q)+" m")},T=function(P){var q;switch(P.align){case"right":case"end":q="right";break;case"center":q="center";break;default:q="left"}var D=this.pdf.getTextDimensions(P.text),se=C.call(this,P.y),he=S.call(this,se)-D.h,be=this.ctx.transform.applyToPoint(new o(P.x,se)),pe=this.ctx.transform.decompose(),Ae=new c;Ae=(Ae=(Ae=Ae.multiply(pe.translate)).multiply(pe.skew)).multiply(pe.scale);for(var Ee,$e,O,te=this.ctx.transform.applyToRectangle(new l(P.x,se,D.w,D.h)),re=Ae.applyToRectangle(new l(P.x,he,D.w,D.h)),le=v.call(this,re),Z=[],K=0;K<le.length;K+=1)Z.indexOf(le[K])===-1&&Z.push(le[K]);if(b(Z),this.autoPaging)for(var X=Z[0],ce=Z[Z.length-1],Y=X;Y<ce+1;Y++){this.pdf.setPage(Y);var ue=Y===1?this.posY+this.margin[0]:this.margin[0],ve=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Le=this.pdf.internal.pageSize.height-this.margin[2],Me=Le-this.margin[0],tt=this.pdf.internal.pageSize.width-this.margin[1],fe=tt-this.margin[3],ct=Y===1?0:ve+(Y-2)*Me;if(this.ctx.clip_path.length!==0){var dt=this.path;Ee=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=j(Ee,this.posX+this.margin[3],-1*ct+ue),N.call(this,"fill",!0),this.path=dt}var pt=j([JSON.parse(JSON.stringify(re))],this.posX+this.margin[3],-ct+ue+this.ctx.prevPageLastElemOffset)[0];P.scale>=.01&&($e=this.pdf.internal.getFontSize(),this.pdf.setFontSize($e*P.scale),O=this.lineWidth,this.lineWidth=O*P.scale);var qe=this.autoPaging!=="text";if(qe||pt.y+pt.h<=Le){if(qe||pt.y>=ue&&pt.x<=tt){var mt=qe?P.text:this.pdf.splitTextToSize(P.text,P.maxWidth||tt-pt.x)[0],Rt=j([JSON.parse(JSON.stringify(te))],this.posX+this.margin[3],-ct+ue+this.ctx.prevPageLastElemOffset)[0],_e=qe&&(Y>X||Y<ce)&&g.call(this);_e&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],fe,Me,null).clip().discardPath()),this.pdf.text(mt,Rt.x,Rt.y,{angle:P.angle,align:q,renderingMode:P.renderingMode}),_e&&this.pdf.restoreGraphicsState()}}else pt.y<Le&&(this.ctx.prevPageLastElemOffset+=Le-pt.y);P.scale>=.01&&(this.pdf.setFontSize($e),this.lineWidth=O)}else P.scale>=.01&&($e=this.pdf.internal.getFontSize(),this.pdf.setFontSize($e*P.scale),O=this.lineWidth,this.lineWidth=O*P.scale),this.pdf.text(P.text,be.x+this.posX,be.y+this.posY,{angle:P.angle,align:q,renderingMode:P.renderingMode,maxWidth:P.maxWidth}),P.scale>=.01&&(this.pdf.setFontSize($e),this.lineWidth=O)},V=function(P,q,D,se){D=D||0,se=se||0,this.pdf.internal.out(r(P+D)+" "+n(q+se)+" l")},M=function(P,q,D){return this.pdf.lines(P,q,D,null,null)},G=function(P,q,D,se,he,be,pe,Ae){this.pdf.internal.out([t(a(D+P)),t(i(se+q)),t(a(he+P)),t(i(be+q)),t(a(pe+P)),t(i(Ae+q)),"c"].join(" "))},L=function(P,q,D,se){for(var he=2*Math.PI,be=Math.PI/2;q>D;)q-=he;var pe=Math.abs(D-q);pe<he&&se&&(pe=he-pe);for(var Ae=[],Ee=se?-1:1,$e=q;pe>1e-5;){var O=$e+Ee*Math.min(pe,be);Ae.push(J.call(this,P,$e,O)),pe-=Math.abs(O-$e),$e=O}return Ae},J=function(P,q,D){var se=(D-q)/2,he=P*Math.cos(se),be=P*Math.sin(se),pe=he,Ae=-be,Ee=pe*pe+Ae*Ae,$e=Ee+pe*he+Ae*be,O=4/3*(Math.sqrt(2*Ee*$e)-$e)/(pe*be-Ae*he),te=pe-O*Ae,re=Ae+O*pe,le=te,Z=-re,K=se+q,X=Math.cos(K),ce=Math.sin(K);return{x1:P*Math.cos(q),y1:P*Math.sin(q),x2:te*X-re*ce,y2:te*ce+re*X,x3:le*X-Z*ce,y3:le*ce+Z*X,x4:P*Math.cos(D),y4:P*Math.sin(D)}},z=function(P){return 180*P/Math.PI},U=function(P,q,D,se,he,be){var pe=P+.5*(D-P),Ae=q+.5*(se-q),Ee=he+.5*(D-he),$e=be+.5*(se-be),O=Math.min(P,he,pe,Ee),te=Math.max(P,he,pe,Ee),re=Math.min(q,be,Ae,$e),le=Math.max(q,be,Ae,$e);return new l(O,re,te-O,le-re)},oe=function(P,q,D,se,he,be,pe,Ae){var Ee,$e,O,te,re,le,Z,K,X,ce,Y,ue,ve,Le,Me=D-P,tt=se-q,fe=he-D,ct=be-se,dt=pe-he,pt=Ae-be;for($e=0;$e<41;$e++)X=(Z=(O=P+(Ee=$e/40)*Me)+Ee*((re=D+Ee*fe)-O))+Ee*(re+Ee*(he+Ee*dt-re)-Z),ce=(K=(te=q+Ee*tt)+Ee*((le=se+Ee*ct)-te))+Ee*(le+Ee*(be+Ee*pt-le)-K),$e==0?(Y=X,ue=ce,ve=X,Le=ce):(Y=Math.min(Y,X),ue=Math.min(ue,ce),ve=Math.max(ve,X),Le=Math.max(Le,ce));return new l(Math.round(Y),Math.round(ue),Math.round(ve-Y),Math.round(Le-ue))},Q=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var P,q,D=(P=this.ctx.lineDash,q=this.ctx.lineDashOffset,JSON.stringify({lineDash:P,lineDashOffset:q}));this.prevLineDash!==D&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=D)}}})(jr.API),function(s){var t=function(o){var l,c,d,u,h,f,m,p,g,v;for(c=[],d=0,u=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;u>d;d+=4)(h=(o.charCodeAt(d)<<24)+(o.charCodeAt(d+1)<<16)+(o.charCodeAt(d+2)<<8)+o.charCodeAt(d+3))!==0?(f=(h=((h=((h=((h=(h-(v=h%85))/85)-(g=h%85))/85)-(p=h%85))/85)-(m=h%85))/85)%85,c.push(f+33,m+33,p+33,g+33,v+33)):c.push(122);return function(y,j){for(var b=j;b>0;b--)y.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,d,u,h,f=String,m="length",p=255,g="charCodeAt",v="slice",y="replace";for(o[v](-2),o=o[v](0,-2)[y](/\s/g,"")[y]("z","!!!!!"),d=[],u=0,h=(o+=l="uuuuu"[v](o[m]%5||5))[m];h>u;u+=5)c=52200625*(o[g](u)-33)+614125*(o[g](u+1)-33)+7225*(o[g](u+2)-33)+85*(o[g](u+3)-33)+(o[g](u+4)-33),d.push(p&c>>24,p&c>>16,p&c>>8,p&c);return function(j,b){for(var w=b;w>0;w--)j.pop()}(d,l[m]),f.fromCharCode.apply(f,d)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},a=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",d=0;d<o.length;d+=2)c+=String.fromCharCode("0x"+(o[d]+o[d+1]));return c},i=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=JC(l)).reduce(function(d,u){return d+String.fromCharCode(u)},"")};s.processDataByFilters=function(o,l){var c=0,d=o||"",u=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":d=r(d),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=t(d),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=a(d),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=n(d),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=i(d),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:d,reverseChain:u.reverse().join(" ")}}}(jr.API),function(s){s.loadFile=function(t,r,n){return function(a,i,o){i=i!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,d,u){var h=new XMLHttpRequest,f=0,m=function(p){var g=p.length,v=[],y=String.fromCharCode;for(f=0;f<g;f+=1)v.push(y(255&p.charCodeAt(f)));return v.join("")};if(h.open("GET",c,!d),h.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(h.onload=function(){h.status===200?u(m(this.responseText)):u(void 0)}),h.send(null),d&&h.status===200)return m(h.responseText)}(a,i,o)}catch{}return l}(t,r,n)},s.loadImageFile=s.loadFile}(jr.API),function(s){function t(){return(Gr.html2canvas?Promise.resolve(Gr.html2canvas):T0(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Gr.DOMPurify?Promise.resolve(Gr.DOMPurify):T0(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=Na(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},a=function(l,c){var d=document.createElement(l);for(var u in c.className&&(d.className=c.className),c.innerHTML&&c.dompurify&&(d.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)d.style[u]=c.style[u];return d},i=function l(c,d){for(var u=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),h=c.firstChild;h;h=h.nextSibling)d!==!0&&h.nodeType===1&&h.nodeName==="SCRIPT"||u.appendChild(l(h,d));return c.nodeType===1&&(c.nodeName==="CANVAS"?(u.width=c.width,u.height=c.height,u.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(u.value=c.value),u.addEventListener("load",function(){u.scrollTop=c.scrollTop,u.scrollLeft=c.scrollLeft},!0)),u},o=function l(c){var d=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),u=l.convert(Promise.resolve(),d);return(u=u.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(d){switch(n(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(d){return this.set({src:a("div",{innerHTML:l,dompurify:d})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,c(this.prop.container,d)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var d=this.opt.jsPDF,u=this.opt.fontFaces,h=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,f=Object.assign({async:!0,allowTaint:!0,scale:h,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete f.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=u,u)for(var m=0;m<u.length;++m){var p=u[m],g=p.src.find(function(v){return v.format==="truetype"});g&&d.addFont(g.url,p.ref.name,p.ref.style)}return f.windowHeight=f.windowHeight||0,f.windowHeight=f.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):f.windowHeight,d.context2d.save(!0),c(this.prop.container,f)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(d){if(d in o.template.prop)return function(){this.prop[d]=l[d]};switch(d){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[d]=l[d]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var d=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(d):d})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(d,u){return Math.floor(d*u/72*96)}return this.then(function(){(l=l||jr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,d,u){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),d!=null&&(this.progress.n=d),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,d,u){return this.setProgress(l?this.progress.val+l:null,c||null,d?this.progress.n+d:null,u?this.progress.stack.concat(u):null)},o.prototype.then=function(l,c){var d=this;return this.thenCore(l,c,function(u,h){return d.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(f){return d.updateProgress(null,u),f}).then(u,h).then(function(f){return d.updateProgress(1),f})})},o.prototype.thenCore=function(l,c,d){d=d||Promise.prototype.then;var u=this;l&&(l=l.bind(u)),c&&(c=c.bind(u));var h=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:o.convert(Object.assign({},u),Promise.prototype),f=d.call(h,l,c);return o.convert(f,u.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(d){c=c.thenCore(d)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,jr.getPageSize=function(l,c,d){if(Na(l)==="object"){var u=l;l=u.orientation,c=u.unit||c,d=u.format||d}c=c||"mm",d=d||"a4",l=(""+(l||"P")).toLowerCase();var h,f=(""+d).toLowerCase(),m={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":h=1;break;case"mm":h=72/25.4;break;case"cm":h=72/2.54;break;case"in":h=72;break;case"px":h=.75;break;case"pc":case"em":h=12;break;case"ex":h=6;break;default:throw"Invalid unit: "+c}var p,g=0,v=0;if(m.hasOwnProperty(f))g=m[f][1]/h,v=m[f][0]/h;else try{g=d[1],v=d[0]}catch{throw new Error("Invalid format: "+d)}if(l==="p"||l==="portrait")l="p",v>g&&(p=v,v=g,g=p);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",g>v&&(p=v,v=g,g=p)}return{width:v,height:g,unit:c,k:h,orientation:l}},s.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(D2):null;var d=new o(c);return c.worker?d:d.from(l).doCallback()}}(jr.API),jr.API.addJS=function(s){return c_=s,this.internal.events.subscribe("postPutResources",function(){lj=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(lj+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),l_=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+c_+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){lj!==void 0&&l_!==void 0&&this.internal.out("/Names <</JavaScript "+lj+" 0 R>>")}),this},function(s){var t;s.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=r.outline.render().split(/\r\n/),i=0;i<a.length;i++){var o=a[i],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,u=[];for(i=0;i<d;i++){var h=r.internal.newObject();u.push(h);var f=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+f.objId+" 0 R /XYZ null null null]>> endobj")}var m=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<u.length;i++)r.internal.write("(page_"+(i+1)+")"+u[i]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+m+" 0 R"),r.internal.write(">>","endobj")}}]),s.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),s.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,a,i){var o={title:a,options:i,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var o=n.children[i];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var d=0;d<n.children.length;d++)this.renderItems(n.children[d])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,a){for(var i=0;i<a.children.length;i++)n.count++,this.count_r(n,a.children[i]);return n.count}}])}(jr.API),function(s){var t=[192,193,194,195,196,197,198,199];s.processJPEG=function(r,n,a,i,o,l){var c,d=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(h){for(var f,m=256*h.charCodeAt(4)+h.charCodeAt(5),p=h.length,g={width:0,height:0,numcomponents:1},v=4;v<p;v+=2){if(v+=m,t.indexOf(h.charCodeAt(v+1))!==-1){f=256*h.charCodeAt(v+5)+h.charCodeAt(v+6),g={width:256*h.charCodeAt(v+7)+h.charCodeAt(v+8),height:f,numcomponents:h.charCodeAt(v+9)};break}m=256*h.charCodeAt(v+2)+h.charCodeAt(v+3)}return g}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}u={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:d,index:n,alias:a}}return u}}(jr.API),jr.API.processPNG=function(s,t,r,n){if(this.__addimage__.isArrayBuffer(s)&&(s=new Uint8Array(s)),this.__addimage__.isArrayBufferView(s)){var a,i=sae(s,{checkCrc:!0}),o=i.width,l=i.height,c=i.channels,d=i.palette,u=i.depth;a=d&&c===1?function(S){for(var _=S.width,k=S.height,F=S.data,A=S.palette,T=S.depth,V=!1,M=[],G=[],L=void 0,J=!1,z=0,U=0;U<A.length;U++){var oe=mP(A[U],4),Q=oe[0],P=oe[1],q=oe[2],D=oe[3];M.push(Q,P,q),D!=null&&(D===0?(z++,G.length<1&&G.push(U)):D<255&&(J=!0))}if(J||z>1){V=!0,G=void 0;var se=_*k;L=new Uint8Array(se);for(var he=new DataView(F.buffer),be=0;be<se;be++){var pe=R2(he,be,T),Ae=mP(A[pe],4)[3];L[be]=Ae}}return{colorSpace:"Indexed",colorsPerPixel:1,colorBytes:F,alphaBytes:L,needSMask:V,palette:M,mask:G}}(i):c===2||c===4?function(S){for(var _=S.data,k=S.width,F=S.height,A=S.channels,T=S.depth,V=A===2?"DeviceGray":"DeviceRGB",M=A-1,G=k*F,L=M,J=G*L,z=1*G,U=Math.ceil(J*T/8),oe=Math.ceil(z*T/8),Q=new Uint8Array(U),P=new Uint8Array(oe),q=new DataView(_.buffer),D=new DataView(Q.buffer),se=new DataView(P.buffer),he=!1,be=0;be<G;be++){for(var pe=be*A,Ae=0;Ae<L;Ae++)v_(D,R2(q,pe+Ae,T),be*L+Ae,T);var Ee=R2(q,pe+L,T);Ee<(1<<T)-1&&(he=!0),v_(se,Ee,1*be,T)}return{colorSpace:V,colorsPerPixel:M,colorBytes:Q,alphaBytes:P,needSMask:he}}(i):function(S){var _=S.data,k=S.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:k,colorsPerPixel:k==="DeviceGray"?1:3,colorBytes:_ instanceof Uint8Array?_:new Uint8Array(_.buffer),needSMask:!1}}(i);var h,f,m,p=a,g=p.colorSpace,v=p.colorsPerPixel,y=p.colorBytes,j=p.alphaBytes,b=p.needSMask,w=p.palette,N=p.mask,C=null;return n!==jr.API.image_compression.NONE&&typeof JC=="function"?(C=function(S){var _;switch(S){case jr.API.image_compression.FAST:_=11;break;case jr.API.image_compression.MEDIUM:_=13;break;case jr.API.image_compression.SLOW:_=14;break;default:_=12}return _}(n),h=this.decode.FLATE_DECODE,f="/Predictor ".concat(C," "),s=m_(y,o*v,v,n),b&&(m=m_(j,o,1,n))):(h=void 0,f="",s=y,b&&(m=j)),f+="/Colors ".concat(v," /BitsPerComponent ").concat(u," /Columns ").concat(o),(this.__addimage__.isArrayBuffer(s)||this.__addimage__.isArrayBufferView(s))&&(s=this.__addimage__.arrayBufferToBinaryString(s)),(m&&this.__addimage__.isArrayBuffer(m)||this.__addimage__.isArrayBufferView(m))&&(m=this.__addimage__.arrayBufferToBinaryString(m)),{alias:r,data:s,index:t,filter:h,decodeParameters:f,transparency:N,palette:w,sMask:m,predictor:C,width:o,height:l,bitsPerComponent:u,colorSpace:g}}},function(s){s.processGIF89A=function(t,r,n,a){var i=new Sae(t),o=i.width,l=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var d={data:c,width:o,height:l},u=new F2(100).encode(d,100);return s.processJPEG.call(this,u,r,n,a)},s.processGIF87A=s.processGIF89A}(jr.API),xd.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var s=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(s);for(var t=0;t<s;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:n,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},xd.prototype.parseBGR=function(){this.pos=this.offset;try{var s="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[s]()}catch(r){Ma.log("bit decode error:"+r)}},xd.prototype.bit1=function(){var s,t=Math.ceil(this.width/8),r=t%4;for(s=this.height-1;s>=0;s--){for(var n=this.bottom_up?s:this.height-1-s,a=0;a<t;a++)for(var i=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*a*4,l=0;l<8&&8*a+l<this.width;l++){var c=this.palette[i>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},xd.prototype.bit4=function(){for(var s=Math.ceil(this.width/2),t=s%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<s;a++){var i=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*a*4,l=i>>4,c=15&i,d=this.palette[l];if(this.data[o]=d.blue,this.data[o+1]=d.green,this.data[o+2]=d.red,this.data[o+3]=255,2*a+1>=this.width)break;d=this.palette[c],this.data[o+4]=d.blue,this.data[o+4+1]=d.green,this.data[o+4+2]=d.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},xd.prototype.bit8=function(){for(var s=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*n;if(a<this.palette.length){var o=this.palette[a];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}s!==0&&(this.pos+=4-s)}},xd.prototype.bit15=function(){for(var s=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&t)/t*255|0,l=(i>>5&t)/t*255|0,c=(i>>10&t)/t*255|0,d=i>>15?255:0,u=n*this.width*4+4*a;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=d}this.pos+=s}},xd.prototype.bit16=function(){for(var s=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&t)/t*255|0,c=(o>>5&r)/r*255|0,d=(o>>11)/t*255|0,u=a*this.width*4+4*i;this.data[u]=d,this.data[u+1]=c,this.data[u+2]=l,this.data[u+3]=255}this.pos+=s}},xd.prototype.bit24=function(){for(var s=this.height-1;s>=0;s--){for(var t=this.bottom_up?s:this.height-1-s,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=i,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},xd.prototype.bit32=function(){for(var s=this.height-1;s>=0;s--)for(var t=this.bottom_up?s:this.height-1-s,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=i,this.data[l+1]=a,this.data[l+2]=n,this.data[l+3]=o}},xd.prototype.getData=function(){return this.data},function(s){s.processBMP=function(t,r,n,a){var i=new xd(t,!1),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},d=new F2(100).encode(c,100);return s.processJPEG.call(this,d,r,n,a)}}(jr.API),j_.prototype.getData=function(){return this.data},function(s){s.processWEBP=function(t,r,n,a){var i=new j_(t),o=i.width,l=i.height,c={data:i.getData(),width:o,height:l},d=new F2(100).encode(c,100);return s.processJPEG.call(this,d,r,n,a)}}(jr.API),jr.API.processRGBA=function(s,t,r){for(var n=s.data,a=n.length,i=new Uint8Array(a/4*3),o=new Uint8Array(a/4),l=0,c=0,d=0;d<a;d+=4){var u=n[d],h=n[d+1],f=n[d+2],m=n[d+3];i[l++]=u,i[l++]=h,i[l++]=f,o[c++]=m}var p=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:p,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:s.width,height:s.height}},jr.API.setLanguage=function(s){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[s]!==void 0&&(this.internal.languageSettings.languageCode=s,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Px=jr.API,cj=Px.getCharWidthsArray=function(s,t){var r,n,a=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:a.metadata.Unicode.widths,c=l.fof?l.fof:1,d=t.kerning?t.kerning:a.metadata.Unicode.kerning,u=d.fof?d.fof:1,h=t.doKerning!==!1,f=0,m=s.length,p=0,g=l[0]||c,v=[];for(r=0;r<m;r++)n=s.charCodeAt(r),typeof a.metadata.widthOfString=="function"?v.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+o*(1e3/i)||0)/1e3):(f=h&&Na(d[n])==="object"&&!isNaN(parseInt(d[n][p],10))?d[n][p]/u:0,v.push((l[n]||g)/c+f)),p=n;return v},d_=Px.getStringUnitWidth=function(s,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),a=t.charSpace||this.internal.getCharSpace();return Px.processArabic&&(s=Px.processArabic(s)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(s,r,a)/r:cj.apply(this,arguments).reduce(function(i,o){return i+o},0)},u_=function(s,t,r,n){for(var a=[],i=0,o=s.length,l=0;i!==o&&l+t[i]<r;)l+=t[i],i++;a.push(s.slice(0,i));var c=i;for(l=0;i!==o;)l+t[i]>n&&(a.push(s.slice(c,i)),l=0,c=i),l+=t[i],i++;return c!==i&&a.push(s.slice(c,i)),a},h_=function(s,t,r){r||(r={});var n,a,i,o,l,c,d,u=[],h=[u],f=r.textIndent||0,m=0,p=0,g=s.split(" "),v=cj.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var y=Array(c).join(" "),j=[];g.map(function(w){(w=w.split(/\s*\n/)).length>1?j=j.concat(w.map(function(N,C){return(C&&N.length?`
`:"")+N})):j.push(w[0])}),g=j,c=d_.apply(this,[y,r])}for(i=0,o=g.length;i<o;i++){var b=0;if(n=g[i],c&&n[0]==`
`&&(n=n.substr(1),b=1),f+m+(p=(a=cj.apply(this,[n,r])).reduce(function(w,N){return w+N},0))>t||b){if(p>t){for(l=u_.apply(this,[n,a,t-(f+m),t]),u.push(l.shift()),u=[l.pop()];l.length;)h.push([l.shift()]);p=a.slice(n.length-(u[0]?u[0].length:0)).reduce(function(w,N){return w+N},0)}else u=[n];h.push(u),f=p+c,m=v}else u.push(n),f+=m+p,m=v}return d=c?function(w,N){return(N?y:"")+w.join(" ")}:function(w){return w.join(" ")},h.map(d)},Px.splitTextToSize=function(s,t,r){var n,a=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var h=this.internal.getFont(u.fontName,u.fontStyle),f="Unicode";return h.metadata[f]?{widths:h.metadata[f].widths||{0:1},kerning:h.metadata[f].kerning||{}}:{font:h.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(s)?s:String(s).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/a;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,i.lineIndent=r.lineIndent;var l,c,d=[];for(l=0,c=n.length;l<c;l++)d=d.concat(h_.apply(this,[n[l],o,i]));return d},function(s){s.__fontmetrics__=s.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},a={},i=0;i<16;i++)n[r[i]]=t[i],a[t[i]]=r[i];var o=function(f){return"0x"+parseInt(f,10).toString(16)},l=s.__fontmetrics__.compress=function(f){var m,p,g,v,y=["{"];for(var j in f){if(m=f[j],isNaN(parseInt(j,10))?p="'"+j+"'":(j=parseInt(j,10),p=(p=o(j).slice(2)).slice(0,-1)+a[p.slice(-1)]),typeof m=="number")m<0?(g=o(m).slice(3),v="-"):(g=o(m).slice(2),v=""),g=v+g.slice(0,-1)+a[g.slice(-1)];else{if(Na(m)!=="object")throw new Error("Don't know what to do with value type "+Na(m)+".");g=l(m)}y.push(p+g)}return y.push("}"),y.join("")},c=s.__fontmetrics__.uncompress=function(f){if(typeof f!="string")throw new Error("Invalid argument passed to uncompress.");for(var m,p,g,v,y={},j=1,b=y,w=[],N="",C="",S=f.length-1,_=1;_<S;_+=1)(v=f[_])=="'"?m?(g=m.join(""),m=void 0):m=[]:m?m.push(v):v=="{"?(w.push([b,g]),b={},g=void 0):v=="}"?((p=w.pop())[0][p[1]]=b,g=void 0,b=p[0]):v=="-"?j=-1:g===void 0?n.hasOwnProperty(v)?(N+=n[v],g=parseInt(N,16)*j,j=1,N=""):N+=v:n.hasOwnProperty(v)?(C+=n[v],b[g]=parseInt(C,16)*j,j=1,g=void 0,C=""):C+=v;return y},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},h={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};s.events.push(["addFont",function(f){var m=f.font,p=h.Unicode[m.postScriptName];p&&(m.metadata.Unicode={},m.metadata.Unicode.widths=p.widths,m.metadata.Unicode.kerning=p.kerning);var g=u.Unicode[m.postScriptName];g&&(m.metadata.Unicode.encoding=g,m.encoding=g.codePages[0])}])}(jr.API),function(s){var t=function(r){for(var n=r.length,a=new Uint8Array(n),i=0;i<n;i++)a[i]=r.charCodeAt(i);return a};s.API.events.push(["addFont",function(r){var n=void 0,a=r.font,i=r.instance;if(!a.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=i.existsFileInVFS(a.postScriptName)===!1?i.loadFile(a.postScriptName):i.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(zj(l)),o.metadata=s.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(a,n)}}])}(jr),jr.API.addSvgAsImage=function(s,t,r,n,a,i,o,l){if(isNaN(t)||isNaN(r))throw Ma.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(a))throw Ma.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=a;var d=c.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,c.width,c.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return(Gr.canvg?Promise.resolve(Gr.canvg):T0(()=>import("./index.es-Bsl8SCUW.js"),__vite__mapDeps([0,1,2]))).catch(function(f){return Promise.reject(new Error("Could not load canvg: "+f))}).then(function(f){return f.default?f.default:f}).then(function(f){return f.fromString(d,s,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(f){return f.render(u)}).then(function(){h.addImage(c.toDataURL("image/jpeg",1),t,r,n,a,o,l)})},jr.API.putTotalPages=function(s){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(s,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(s,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(t,r);return this},jr.API.viewerPreferences=function(s,t){var r;s=s||{},t=t||!1;var n,a,i,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],d=0,u=0,h=0;function f(p,g){var v,y=!1;for(v=0;v<p.length;v+=1)p[v]===g&&(y=!0);return y}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,s==="reset"||t===!0){var m=l.length;for(h=0;h<m;h+=1)r[l[h]].value=r[l[h]].defaultValue,r[l[h]].explicitSet=!1}if(Na(s)==="object"){for(a in s)if(i=s[a],f(l,a)&&i!==void 0){if(r[a].type==="boolean"&&typeof i=="boolean")r[a].value=i;else if(r[a].type==="name"&&f(r[a].valueSet,i))r[a].value=i;else if(r[a].type==="integer"&&Number.isInteger(i))r[a].value=i;else if(r[a].type==="array"){for(d=0;d<i.length;d+=1)if(n=!0,i[d].length===1&&typeof i[d][0]=="number")c.push(String(i[d]-1));else if(i[d].length>1){for(u=0;u<i[d].length;u+=1)typeof i[d][u]!="number"&&(n=!1);n===!0&&c.push([i[d][0]-1,i[d][1]-1].join(" "))}r[a].value="["+c.join(" ")+"]"}else r[a].value=r[a].defaultValue;r[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var p,g=[];for(p in r)r[p].explicitSet===!0&&(r[p].type==="name"?g.push("/"+p+" /"+r[p].value):g.push("/"+p+" "+r[p].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(s){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),l=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),d=i.length+o.length+l.length+a.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(a+i+o+l+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};s.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(jr.API),function(s){var t=s.API,r=t.pdfEscape16=function(i,o){for(var l,c=o.metadata.Unicode.widths,d=["","0","00","000","0000"],u=[""],h=0,f=i.length;h<f;++h){if(l=o.metadata.characterToGlyph(i.charCodeAt(h)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=i.charCodeAt(h),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return u.join("");l=l.toString(16),u.push(d[4-l.length],l)}return u.join("")},n=function(i){var o,l,c,d,u,h,f;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],h=0,f=(l=Object.keys(i).sort(function(m,p){return m-p})).length;h<f;h++)o=l[h],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[o]!==void 0&&i[o]!==null&&typeof i[o].toString=="function"&&(d=("0000"+i[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+d+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,d=o.newObject,u=o.putStream;if(l.metadata instanceof s.API.TTFFont&&l.encoding==="Identity-H"){for(var h=l.metadata.Unicode.widths,f=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),m="",p=0;p<f.length;p++)m+=String.fromCharCode(f[p]);var g=d();u({data:m,addLength1:!0,objectId:g}),c("endobj");var v=d();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:v}),c("endobj");var y=d();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+zx(l.fontName)),c("/FontFile2 "+g+" 0 R"),c("/FontBBox "+s.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var j=d();c("<<"),c("/Type /Font"),c("/BaseFont /"+zx(l.fontName)),c("/FontDescriptor "+y+" 0 R"),c("/W "+s.API.PDFObject.convert(h)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=d(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+v+" 0 R"),c("/BaseFont /"+zx(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+j+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(o){var l=o.font,c=o.out,d=o.newObject,u=o.putStream;if(l.metadata instanceof s.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var h=l.metadata.rawData,f="",m=0;m<h.length;m++)f+=String.fromCharCode(h[m]);var p=d();u({data:f,addLength1:!0,objectId:p}),c("endobj");var g=d();u({data:n(l.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var v=d();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+p+" 0 R"),c("/Flags 96"),c("/FontBBox "+s.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+zx(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=d();for(var y=0;y<l.metadata.hmtx.widths.length;y++)l.metadata.hmtx.widths[y]=parseInt(l.metadata.hmtx.widths[y]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+zx(l.fontName)+"/FontDescriptor "+v+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+s.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(i)}]);var a=function(i){var o,l=i.text||"",c=i.x,d=i.y,u=i.options||{},h=i.mutex||{},f=h.pdfEscape,m=h.activeFontKey,p=h.fonts,g=m,v="",y=0,j="",b=p[g].encoding;if(p[g].encoding!=="Identity-H")return{text:l,x:c,y:d,options:u,mutex:h};for(j=l,g=m,Array.isArray(l)&&(j=l[0]),y=0;y<j.length;y+=1)p[g].metadata.hasOwnProperty("cmap")&&(o=p[g].metadata.cmap.unicode.codeMap[j[y].charCodeAt(0)]),o||j[y].charCodeAt(0)<256&&p[g].metadata.hasOwnProperty("Unicode")?v+=j[y]:v+="";var w="";return parseInt(g.slice(1))<14||b==="WinAnsiEncoding"?w=f(v,g).split("").map(function(N){return N.charCodeAt(0).toString(16)}).join(""):b==="Identity-H"&&(w=r(v,p[g])),h.isHex=!0,{text:w,x:c,y:d,options:u,mutex:h}};t.events.push(["postProcessText",function(i){var o=i.text||"",l=[],c={text:o,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(o)){var d=0;for(d=0;d<o.length;d+=1)Array.isArray(o[d])&&o[d].length===3?l.push([a(Object.assign({},c,{text:o[d][0]})).text,o[d][1],o[d][2]]):l.push(a(Object.assign({},c,{text:o[d]})).text);i.text=l}else i.text=a(Object.assign({},c,{text:o})).text}])}(jr),function(s){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};s.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},s.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},s.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(jr.API),function(s){s.__bidiEngine__=s.prototype.__bidiEngine__=function(n){var a,i,o,l,c,d,u,h=t,f=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],m=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],p={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},v=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],y=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),j=!1,b=0;this.__bidiEngine__={};var w=function(A){var T=A.charCodeAt(),V=T>>8,M=g[V];return M!==void 0?h[256*M+(255&T)]:V===252||V===253?"AL":y.test(V)?"L":V===8?"R":"N"},N=function(A){for(var T,V=0;V<A.length;V++){if((T=w(A.charAt(V)))==="L")return!1;if(T==="R")return!0}return!1},C=function(A,T,V,M){var G,L,J,z,U=T[M];switch(U){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":j=!1;break;case"N":case"AN":break;case"EN":j&&(U="AN");break;case"AL":j=!0,U="R";break;case"WS":case"BN":U="N";break;case"CS":M<1||M+1>=T.length||(G=V[M-1])!=="EN"&&G!=="AN"||(L=T[M+1])!=="EN"&&L!=="AN"?U="N":j&&(L="AN"),U=L===G?L:"N";break;case"ES":U=(G=M>0?V[M-1]:"B")==="EN"&&M+1<T.length&&T[M+1]==="EN"?"EN":"N";break;case"ET":if(M>0&&V[M-1]==="EN"){U="EN";break}if(j){U="N";break}for(J=M+1,z=T.length;J<z&&T[J]==="ET";)J++;U=J<z&&T[J]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(z=T.length,J=M+1;J<z&&T[J]==="NSM";)J++;if(J<z){var oe=A[M],Q=oe>=1425&&oe<=2303||oe===64286;if(G=T[J],Q&&(G==="R"||G==="AL")){U="R";break}}}U=M<1||(G=T[M-1])==="B"?"N":V[M-1];break;case"B":j=!1,a=!0,U=b;break;case"S":i=!0,U="N"}return U},S=function(A,T,V){var M=A.split("");return V&&_(M,V,{hiLevel:b}),M.reverse(),T&&T.reverse(),M.join("")},_=function(A,T,V){var M,G,L,J,z,U=-1,oe=A.length,Q=0,P=[],q=b?m:f,D=[];for(j=!1,a=!1,i=!1,G=0;G<oe;G++)D[G]=w(A[G]);for(L=0;L<oe;L++){if(z=Q,P[L]=C(A,D,P,L),M=240&(Q=q[z][p[P[L]]]),Q&=15,T[L]=J=q[Q][5],M>0)if(M===16){for(G=U;G<L;G++)T[G]=1;U=-1}else U=-1;if(q[Q][6])U===-1&&(U=L);else if(U>-1){for(G=U;G<L;G++)T[G]=J;U=-1}D[L]==="B"&&(T[L]=0),V.hiLevel|=J}i&&function(se,he,be){for(var pe=0;pe<be;pe++)if(se[pe]==="S"){he[pe]=b;for(var Ae=pe-1;Ae>=0&&se[Ae]==="WS";Ae--)he[Ae]=b}}(D,T,oe)},k=function(A,T,V,M,G){if(!(G.hiLevel<A)){if(A===1&&b===1&&!a)return T.reverse(),void(V&&V.reverse());for(var L,J,z,U,oe=T.length,Q=0;Q<oe;){if(M[Q]>=A){for(z=Q+1;z<oe&&M[z]>=A;)z++;for(U=Q,J=z-1;U<J;U++,J--)L=T[U],T[U]=T[J],T[J]=L,V&&(L=V[U],V[U]=V[J],V[J]=L);Q=z}Q++}}},F=function(A,T,V){var M=A.split(""),G={hiLevel:b};return V||(V=[]),_(M,V,G),function(L,J,z){if(z.hiLevel!==0&&u)for(var U,oe=0;oe<L.length;oe++)J[oe]===1&&(U=v.indexOf(L[oe]))>=0&&(L[oe]=v[U+1])}(M,V,G),k(2,M,T,V,G),k(1,M,T,V,G),M.join("")};return this.__bidiEngine__.doBidiReorder=function(A,T,V){if(function(G,L){if(L)for(var J=0;J<G.length;J++)L[J]=J;l===void 0&&(l=N(G)),d===void 0&&(d=N(G))}(A,T),o||!c||d)if(o&&c&&l^d)b=l?1:0,A=S(A,T,V);else if(!o&&c&&d)b=l?1:0,A=F(A,T,V),A=S(A,T);else if(!o||l||c||d){if(o&&!c&&l^d)A=S(A,T),l?(b=0,A=F(A,T,V)):(b=1,A=F(A,T,V),A=S(A,T));else if(o&&l&&!c&&d)b=1,A=F(A,T,V),A=S(A,T);else if(!o&&!c&&l^d){var M=u;l?(b=1,A=F(A,T,V),b=0,u=!1,A=F(A,T,V),u=M):(b=0,A=F(A,T,V),A=S(A,T),b=1,u=!1,A=F(A,T,V),u=M,A=S(A,T))}}else b=0,A=F(A,T,V);else b=l?1:0,A=F(A,T,V);return A},this.__bidiEngine__.setOptions=function(A){A&&(o=A.isInputVisual,c=A.isOutputVisual,l=A.isInputRtl,d=A.isOutputRtl,u=A.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new s.__bidiEngine__({isInputVisual:!0});s.API.events.push(["postProcessText",function(n){var a=n.text;n.x,n.y;var i=n.options||{};n.mutex,i.lang;var o=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(a)==="[object Array]"){var l=0;for(o=[],l=0;l<a.length;l+=1)Object.prototype.toString.call(a[l])==="[object Array]"?o.push([r.doBidiReorder(a[l][0]),a[l][1],a[l][2]]):o.push([r.doBidiReorder(a[l])]);n.text=o}else n.text=r.doBidiReorder(a);r.setOptions({isInputVisual:!0})}])}(jr),jr.API.TTFFont=function(){function s(t){var r;if(this.rawData=t,r=this.contents=new Om(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new $ae(this),this.registerTTF()}return s.open=function(t){return new s(t)},s.prototype.parse=function(){return this.directory=new Cae(this.contents),this.head=new Eae(this),this.name=new Tae(this),this.cmap=new S$(this),this.toUnicode={},this.hhea=new Iae(this),this.maxp=new Dae(this),this.hmtx=new Oae(this),this.post=new _ae(this),this.os2=new Pae(this),this.loca=new Lae(this),this.glyf=new Rae(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},s.prototype.registerTTF=function(){var t,r,n,a,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,d;for(d=[],o=0,l=(c=this.bbox).length;o<l;o++)t=c[o],d.push(Math.round(t*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(r=a>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},s.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},s.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},s.prototype.widthOfString=function(t,r,n){var a,i,o,l;for(o=0,i=0,l=(t=""+t).length;0<=l?i<l:i>l;i=0<=l?++i:--i)a=t.charCodeAt(i),o+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/r)||0;return o*(r/1e3)},s.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},s}();var Md,Om=function(){function s(t){this.data=t??[],this.pos=0,this.length=this.data.length}return s.prototype.readByte=function(){return this.data[this.pos++]},s.prototype.writeByte=function(t){return this.data[this.pos++]=t},s.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},s.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},s.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},s.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},s.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},s.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},s.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},s.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},s.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},s.prototype.writeString=function(t){var r,n,a;for(a=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)a.push(this.writeByte(t.charCodeAt(r)));return a},s.prototype.readShort=function(){return this.readInt16()},s.prototype.writeShort=function(t){return this.writeInt16(t)},s.prototype.readLongLong=function(){var t,r,n,a,i,o,l,c;return t=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),i=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^i)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*a+16777216*i+65536*o+256*l+c},s.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},s.prototype.readInt=function(){return this.readInt32()},s.prototype.writeInt=function(t){return this.writeInt32(t)},s.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},s.prototype.write=function(t){var r,n,a,i;for(i=[],n=0,a=t.length;n<a;n++)r=t[n],i.push(this.writeByte(r));return i},s}(),Cae=function(){var s;function t(r){var n,a,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},a=0,i=this.tableCount;0<=i?a<i:a>i;a=0<=i?++a:--a)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,a,i,o,l,c,d,u,h,f,m,p,g;for(g in m=Object.keys(r).length,c=Math.log(2),h=16*Math.floor(Math.log(m)/c),o=Math.floor(h/c),u=16*m-h,(a=new Om).writeInt(this.scalarType),a.writeShort(m),a.writeShort(h),a.writeShort(o),a.writeShort(u),i=16*m,d=a.pos+i,l=null,p=[],r)for(f=r[g],a.writeString(g),a.writeInt(s(f)),a.writeInt(d),a.writeInt(f.length),p=p.concat(f),g==="head"&&(l=d),d+=f.length;d%4;)p.push(0),d++;return a.write(p),n=2981146554-s(a.data),a.pos=l+8,a.writeUInt32(n),a.data},s=function(r){var n,a,i,o;for(r=C$.call(r);r.length%4;)r.push(0);for(i=new Om(r),a=0,n=0,o=r.length;n<o;n=n+=4)a+=i.readUInt32();return 4294967295&a},t}(),Aae={}.hasOwnProperty,yu=function(s,t){for(var r in t)Aae.call(t,r)&&(s[r]=t[r]);function n(){this.constructor=s}return n.prototype=t.prototype,s.prototype=new n,s.__super__=t.prototype,s};Md=function(){function s(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return s.prototype.parse=function(){},s.prototype.encode=function(){},s.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},s}();var Eae=function(){function s(){return s.__super__.constructor.apply(this,arguments)}return yu(s,Md),s.prototype.tag="head",s.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},s.prototype.encode=function(t){var r;return(r=new Om).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},s}(),b_=function(){function s(t,r){var n,a,i,o,l,c,d,u,h,f,m,p,g,v,y,j,b;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),h=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(m=t.readUInt16(),f=m/2,t.pos+=6,i=function(){var w,N;for(N=[],c=w=0;0<=f?w<f:w>f;c=0<=f?++w:--w)N.push(t.readUInt16());return N}(),t.pos+=2,g=function(){var w,N;for(N=[],c=w=0;0<=f?w<f:w>f;c=0<=f?++w:--w)N.push(t.readUInt16());return N}(),d=function(){var w,N;for(N=[],c=w=0;0<=f?w<f:w>f;c=0<=f?++w:--w)N.push(t.readUInt16());return N}(),u=function(){var w,N;for(N=[],c=w=0;0<=f?w<f:w>f;c=0<=f?++w:--w)N.push(t.readUInt16());return N}(),a=(this.length-t.pos+this.offset)/2,l=function(){var w,N;for(N=[],c=w=0;0<=a?w<a:w>a;c=0<=a?++w:--w)N.push(t.readUInt16());return N}(),c=y=0,b=i.length;y<b;c=++y)for(v=i[c],n=j=p=g[c];p<=v?j<=v:j>=v;n=p<=v?++j:--j)u[c]===0?o=n+d[c]:(o=l[u[c]/2+(n-p)-(f-c)]||0)!==0&&(o+=d[c]),this.codeMap[n]=65535&o}t.pos=h}return s.encode=function(t,r){var n,a,i,o,l,c,d,u,h,f,m,p,g,v,y,j,b,w,N,C,S,_,k,F,A,T,V,M,G,L,J,z,U,oe,Q,P,q,D,se,he,be,pe,Ae,Ee,$e,O;switch(M=new Om,o=Object.keys(t).sort(function(te,re){return te-re}),r){case"macroman":for(g=0,v=function(){var te=[];for(p=0;p<256;++p)te.push(0);return te}(),j={0:0},i={},G=0,U=o.length;G<U;G++)j[Ae=t[a=o[G]]]==null&&(j[Ae]=++g),i[a]={old:t[a],new:j[t[a]]},v[a]=j[t[a]];return M.writeUInt16(1),M.writeUInt16(0),M.writeUInt32(12),M.writeUInt16(0),M.writeUInt16(262),M.writeUInt16(0),M.write(v),{charMap:i,subtable:M.data,maxGlyphID:g+1};case"unicode":for(T=[],h=[],b=0,j={},n={},y=d=null,L=0,oe=o.length;L<oe;L++)j[N=t[a=o[L]]]==null&&(j[N]=++b),n[a]={old:N,new:j[N]},l=j[N]-a,y!=null&&l===d||(y&&h.push(y),T.push(a),d=l),y=a;for(y&&h.push(y),h.push(65535),T.push(65535),F=2*(k=T.length),_=2*Math.pow(Math.log(k)/Math.LN2,2),f=Math.log(_/2)/Math.LN2,S=2*k-_,c=[],C=[],m=[],p=J=0,Q=T.length;J<Q;p=++J){if(A=T[p],u=h[p],A===65535){c.push(0),C.push(0);break}if(A-(V=n[A].new)>=32768)for(c.push(0),C.push(2*(m.length+k-p)),a=z=A;A<=u?z<=u:z>=u;a=A<=u?++z:--z)m.push(n[a].new);else c.push(V-A),C.push(0)}for(M.writeUInt16(3),M.writeUInt16(1),M.writeUInt32(12),M.writeUInt16(4),M.writeUInt16(16+8*k+2*m.length),M.writeUInt16(0),M.writeUInt16(F),M.writeUInt16(_),M.writeUInt16(f),M.writeUInt16(S),be=0,P=h.length;be<P;be++)a=h[be],M.writeUInt16(a);for(M.writeUInt16(0),pe=0,q=T.length;pe<q;pe++)a=T[pe],M.writeUInt16(a);for(Ee=0,D=c.length;Ee<D;Ee++)l=c[Ee],M.writeUInt16(l);for($e=0,se=C.length;$e<se;$e++)w=C[$e],M.writeUInt16(w);for(O=0,he=m.length;O<he;O++)g=m[O],M.writeUInt16(g);return{charMap:n,subtable:M.data,maxGlyphID:b+1}}},s}(),S$=function(){function s(){return s.__super__.constructor.apply(this,arguments)}return yu(s,Md),s.prototype.tag="cmap",s.prototype.parse=function(t){var r,n,a;for(t.pos=this.offset,this.version=t.readUInt16(),a=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=a?n<a:n>a;n=0<=a?++n:--n)r=new b_(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},s.encode=function(t,r){var n,a;return r==null&&(r="macroman"),n=b_.encode(t,r),(a=new Om).writeUInt16(0),a.writeUInt16(1),n.table=a.data.concat(n.subtable),n},s}(),Iae=function(){function s(){return s.__super__.constructor.apply(this,arguments)}return yu(s,Md),s.prototype.tag="hhea",s.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},s}(),Pae=function(){function s(){return s.__super__.constructor.apply(this,arguments)}return yu(s,Md),s.prototype.tag="OS/2",s.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},s}(),_ae=function(){function s(){return s.__super__.constructor.apply(this,arguments)}return yu(s,Md),s.prototype.tag="post",s.prototype.parse=function(t){var r,n,a;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var i;for(n=t.readUInt16(),this.glyphNameIndex=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],a=[];t.pos<this.offset+this.length;)r=t.readByte(),a.push(this.names.push(t.readString(r)));return a;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],i=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;i=0<=l?++o:--o)c.push(t.readUInt32());return c}).call(this)}},s}(),kae=function(s,t){this.raw=s,this.length=s.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},Tae=function(){function s(){return s.__super__.constructor.apply(this,arguments)}return yu(s,Md),s.prototype.tag="name",s.prototype.parse=function(t){var r,n,a,i,o,l,c,d,u,h,f;for(t.pos=this.offset,t.readShort(),r=t.readShort(),l=t.readShort(),n=[],i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+l+t.readShort()});for(c={},i=u=0,h=n.length;u<h;i=++u)a=n[i],t.pos=a.offset,d=t.readString(a.length),o=new kae(d,a),c[f=a.nameID]==null&&(c[f]=[]),c[a.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},s}(),Dae=function(){function s(){return s.__super__.constructor.apply(this,arguments)}return yu(s,Md),s.prototype.tag="maxp",s.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},s}(),Oae=function(){function s(){return s.__super__.constructor.apply(this,arguments)}return yu(s,Md),s.prototype.tag="hmtx",s.prototype.parse=function(t){var r,n,a,i,o,l,c;for(t.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,u;for(u=[],r=d=0;0<=a?d<a:d>a;r=0<=a?++d:--d)u.push(t.readInt16());return u}(),this.widths=(function(){var d,u,h,f;for(f=[],d=0,u=(h=this.metrics).length;d<u;d++)i=h[d],f.push(i.advance);return f}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=a?o<a:o>a;r=0<=a?++o:--o)c.push(this.widths.push(n));return c},s.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},s}(),C$=[].slice,Rae=function(){function s(){return s.__super__.constructor.apply(this,arguments)}return yu(s,Md),s.prototype.tag="glyf",s.prototype.parse=function(){return this.cache={}},s.prototype.glyphFor=function(t){var r,n,a,i,o,l,c,d,u,h;return t in this.cache?this.cache[t]:(i=this.file.loca,r=this.file.contents,n=i.indexOf(t),(a=i.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,o=(l=new Om(r.read(a))).readShort(),d=l.readShort(),h=l.readShort(),c=l.readShort(),u=l.readShort(),this.cache[t]=o===-1?new Mae(l,d,h,c,u):new Fae(l,o,d,h,c,u),this.cache[t]))},s.prototype.encode=function(t,r,n){var a,i,o,l,c;for(o=[],i=[],l=0,c=r.length;l<c;l++)a=t[r[l]],i.push(o.length),a&&(o=o.concat(a.encode(n)));return i.push(o.length),{table:o,offsets:i}},s}(),Fae=function(){function s(t,r,n,a,i,o){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=a,this.xMax=i,this.yMax=o,this.compound=!1}return s.prototype.encode=function(){return this.raw.data},s}(),Mae=function(){function s(t,r,n,a,i){var o,l;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return s.prototype.encode=function(){var t,r,n;for(r=new Om(C$.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},s}(),Lae=function(){function s(){return s.__super__.constructor.apply(this,arguments)}return yu(s,Md),s.prototype.tag="loca",s.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var a,i;for(i=[],n=0,a=this.length;n<a;n+=2)i.push(2*t.readUInt16());return i}).call(this):(function(){var a,i;for(i=[],n=0,a=this.length;n<a;n+=4)i.push(t.readUInt32());return i}).call(this)},s.prototype.indexOf=function(t){return this.offsets[t]},s.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},s.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),a=0,i=0,o=0;o<n.length;++o)if(n[o]=a,i<r.length&&r[i]==o){++i,n[o]=a;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(a+=c)}for(var d=new Array(4*n.length),u=0;u<n.length;++u)d[4*u+3]=255&n[u],d[4*u+2]=(65280&n[u])>>8,d[4*u+1]=(16711680&n[u])>>16,d[4*u]=(4278190080&n[u])>>24;return d},s}(),$ae=function(){function s(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return s.prototype.generateCmap=function(){var t,r,n,a,i;for(r in a=this.font.cmap.tables[0].codeMap,t={},i=this.subset)n=i[r],t[r]=a[n];return t},s.prototype.glyphsFor=function(t){var r,n,a,i,o,l,c;for(a={},o=0,l=t.length;o<l;o++)a[i=t[o]]=this.font.glyf.glyphFor(i);for(i in r=[],a)(n=a[i])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(i in c=this.glyphsFor(r))n=c[i],a[i]=n;return a},s.prototype.encode=function(t,r){var n,a,i,o,l,c,d,u,h,f,m,p,g,v,y;for(a in n=S$.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),m={0:0},y=n.charMap)m[(c=y[a]).old]=c.new;for(p in f=n.maxGlyphID,o)p in m||(m[p]=f++);return u=function(j){var b,w;for(b in w={},j)w[j[b]]=b;return w}(m),h=Object.keys(u).sort(function(j,b){return j-b}),g=function(){var j,b,w;for(w=[],j=0,b=h.length;j<b;j++)l=h[j],w.push(u[l]);return w}(),i=this.font.glyf.encode(o,g,m),d=this.font.loca.encode(i.offsets,g),v={cmap:this.font.cmap.raw(),glyf:i.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(v["OS/2"]=this.font.os2.raw()),this.font.directory.encode(v)},s}();jr.API.PDFObject=function(){var s;function t(){}return s=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,a,i,o;if(Array.isArray(r))return"["+function(){var l,c,d;for(d=[],l=0,c=r.length;l<c;l++)n=r[l],d.push(t.convert(n));return d}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+s(r.getUTCFullYear(),4)+s(r.getUTCMonth(),2)+s(r.getUTCDate(),2)+s(r.getUTCHours(),2)+s(r.getUTCMinutes(),2)+s(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(a in i=["<<"],r)o=r[a],i.push("/"+a+" "+t.convert(o));return i.push(">>"),i.join(`
`)}return""+r},t}();const Bae=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:pae,AcroFormAppearance:nr,AcroFormButton:vo,AcroFormCheckBox:M0,AcroFormChoiceField:$f,AcroFormComboBox:Uf,AcroFormEditBox:R0,AcroFormListBox:Bf,AcroFormPasswordField:L0,AcroFormPushButton:F0,AcroFormRadioButton:zf,AcroFormTextField:Am,GState:lv,ShadingPattern:Qh,TilingPattern:bf,default:jr,jsPDF:jr},Symbol.toStringTag,{value:"Module"}));function A$(s,t,r,n,a){n=n||{};var i=1.15,o=a.internal.scaleFactor,l=a.internal.getFontSize()/o,c=a.getLineHeightFactor?a.getLineHeightFactor():i,d=l*c,u=/\r\n|\r|\n/g,h="",f=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(h=typeof s=="string"?s.split(u):s,f=h.length||1),r+=l*(2-i),n.valign==="middle"?r-=f/2*d:n.valign==="bottom"&&(r-=f*d),n.halign==="center"||n.halign==="right"){var m=l;if(n.halign==="center"&&(m*=.5),h&&f>=1){for(var p=0;p<h.length;p++)a.text(h[p],t-a.getStringUnitWidth(h[p])*m,r),r+=d;return a}t-=a.getStringUnitWidth(s)*m}return n.halign==="justify"?a.text(s,t,r,{maxWidth:n.maxWidth||100,align:"justify"}):a.text(s,t,r),a}var N_={},tp=function(){function s(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return s.setDefaults=function(t,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=t:N_=t},s.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},s.prototype.applyStyles=function(t,r){var n,a,i;r===void 0&&(r=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var o=this.jsPDFDocument.internal.getFont(),l=o.fontStyle,c=o.fontName;if(t.font&&(c=t.font),t.fontStyle){l=t.fontStyle;var d=this.getFontList()[c];d&&d.indexOf(l)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(d[0]),l=d[0])}if(this.jsPDFDocument.setFont(c,l),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!r){var u=s.unifyColor(t.fillColor);u&&(n=this.jsPDFDocument).setFillColor.apply(n,u),u=s.unifyColor(t.textColor),u&&(a=this.jsPDFDocument).setTextColor.apply(a,u),u=s.unifyColor(t.lineColor),u&&(i=this.jsPDFDocument).setDrawColor.apply(i,u),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},s.prototype.splitTextToSize=function(t,r,n){return this.jsPDFDocument.splitTextToSize(t,r,n)},s.prototype.rect=function(t,r,n,a,i){return this.jsPDFDocument.rect(t,r,n,a,i)},s.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},s.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},s.prototype.getDocument=function(){return this.jsPDFDocument},s.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},s.prototype.addPage=function(){return this.jsPDFDocument.addPage()},s.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},s.prototype.getGlobalOptions=function(){return N_||{}},s.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},s.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},s.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},s.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},s.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},s.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},s}(),n4=function(s,t){return n4=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])},n4(s,t)};function E$(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");n4(s,t);function r(){this.constructor=s}s.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var I$=function(s){E$(t,s);function t(r){var n=s.call(this)||this;return n._element=r,n}return t}(Array);function Uae(s){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/s,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function zae(s){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[s]}function f1(s,t,r){r.applyStyles(t,!0);var n=Array.isArray(s)?s:[s],a=n.map(function(i){return r.getTextWidth(i)}).reduce(function(i,o){return Math.max(i,o)},0);return a}function P$(s,t,r,n){var a=t.settings.tableLineWidth,i=t.settings.tableLineColor;s.applyStyles({lineWidth:a,lineColor:i});var o=_$(a,!1);o&&s.rect(r.x,r.y,t.getWidth(s.pageSize().width),n.y-r.y,o)}function _$(s,t){var r=s>0,n=t||t===0;return r&&n?"DF":r?"S":n?"F":null}function gN(s,t){var r,n,a,i;if(s=s||t,Array.isArray(s)){if(s.length>=4)return{top:s[0],right:s[1],bottom:s[2],left:s[3]};if(s.length===3)return{top:s[0],right:s[1],bottom:s[2],left:s[1]};if(s.length===2)return{top:s[0],right:s[1],bottom:s[0],left:s[1]};s.length===1?s=s[0]:s=t}return typeof s=="object"?(typeof s.vertical=="number"&&(s.top=s.vertical,s.bottom=s.vertical),typeof s.horizontal=="number"&&(s.right=s.horizontal,s.left=s.horizontal),{left:(r=s.left)!==null&&r!==void 0?r:t,top:(n=s.top)!==null&&n!==void 0?n:t,right:(a=s.right)!==null&&a!==void 0?a:t,bottom:(i=s.bottom)!==null&&i!==void 0?i:t}):(typeof s!="number"&&(s=t),{top:s,right:s,bottom:s,left:s})}function k$(s,t){var r=gN(t.settings.margin,0);return s.pageSize().width-(r.left+r.right)}function qae(s,t,r,n,a){var i={},o=1.3333333333333333,l=M2(t,function(b){return a.getComputedStyle(b).backgroundColor});l!=null&&(i.fillColor=l);var c=M2(t,function(b){return a.getComputedStyle(b).color});c!=null&&(i.textColor=c);var d=Wae(n,r);d&&(i.cellPadding=d);var u="borderTopColor",h=o*r,f=n.borderTopWidth;if(n.borderBottomWidth===f&&n.borderRightWidth===f&&n.borderLeftWidth===f){var m=(parseFloat(f)||0)/h;m&&(i.lineWidth=m)}else i.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/h,right:(parseFloat(n.borderRightWidth)||0)/h,bottom:(parseFloat(n.borderBottomWidth)||0)/h,left:(parseFloat(n.borderLeftWidth)||0)/h},i.lineWidth.top||(i.lineWidth.right?u="borderRightColor":i.lineWidth.bottom?u="borderBottomColor":i.lineWidth.left&&(u="borderLeftColor"));var p=M2(t,function(b){return a.getComputedStyle(b)[u]});p!=null&&(i.lineColor=p);var g=["left","right","center","justify"];g.indexOf(n.textAlign)!==-1&&(i.halign=n.textAlign),g=["middle","bottom","top"],g.indexOf(n.verticalAlign)!==-1&&(i.valign=n.verticalAlign);var v=parseInt(n.fontSize||"");isNaN(v)||(i.fontSize=v/o);var y=Vae(n);y&&(i.fontStyle=y);var j=(n.fontFamily||"").toLowerCase();return s.indexOf(j)!==-1&&(i.font=j),i}function Vae(s){var t="";return(s.fontWeight==="bold"||s.fontWeight==="bolder"||parseInt(s.fontWeight)>=700)&&(t="bold"),(s.fontStyle==="italic"||s.fontStyle==="oblique")&&(t+="italic"),t}function M2(s,t){var r=T$(s,t);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var a=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],i=parseInt(n[4]);return i===0||isNaN(a[0])||isNaN(a[1])||isNaN(a[2])?null:a}function T$(s,t){var r=t(s);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?s.parentElement==null?null:T$(s.parentElement,t):r}function Wae(s,t){var r=[s.paddingTop,s.paddingRight,s.paddingBottom,s.paddingLeft],n=96/(72/t),a=(parseInt(s.lineHeight)-parseInt(s.fontSize))/t/2,i=r.map(function(l){return parseInt(l||"0")/n}),o=gN(i,0);return a>o.top&&(o.top=a),a>o.bottom&&(o.bottom=a),o}function D$(s,t,r,n,a){var i,o;n===void 0&&(n=!1),a===void 0&&(a=!1);var l;typeof t=="string"?l=r.document.querySelector(t):l=t;var c=Object.keys(s.getFontList()),d=s.scaleFactor(),u=[],h=[],f=[];if(!l)return console.error("Html table could not be found with input: ",t),{head:u,body:h,foot:f};for(var m=0;m<l.rows.length;m++){var p=l.rows[m],g=(o=(i=p==null?void 0:p.parentElement)===null||i===void 0?void 0:i.tagName)===null||o===void 0?void 0:o.toLowerCase(),v=Hae(c,d,r,p,n,a);v&&(g==="thead"?u.push(v):g==="tfoot"?f.push(v):h.push(v))}return{head:u,body:h,foot:f}}function Hae(s,t,r,n,a,i){for(var o=new I$(n),l=0;l<n.cells.length;l++){var c=n.cells[l],d=r.getComputedStyle(c);if(a||d.display!=="none"){var u=void 0;i&&(u=qae(s,c,t,d,r)),o.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:u,_element:c,content:Gae(c)})}}var h=r.getComputedStyle(n);if(o.length>0&&(a||h.display!=="none"))return o}function Gae(s){var t=s.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),t.innerText||t.textContent||""}function Kae(s,t,r){for(var n=0,a=[s,t,r];n<a.length;n++){var i=a[n];i&&typeof i!="object"&&console.error("The options parameter should be of type object, is: "+typeof i),i.startY&&typeof i.startY!="number"&&(console.error("Invalid value for startY option",i.startY),delete i.startY)}}function Ku(s,t,r,n,a){if(s==null)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(s),o=1;o<arguments.length;o++){var l=arguments[o];if(l!=null)for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(i[c]=l[c])}return i}function O$(s,t){var r=new tp(s),n=r.getDocumentOptions(),a=r.getGlobalOptions();Kae(a,n,t);var i=Ku({},a,n,t),o;typeof window<"u"&&(o=window);var l=Yae(a,n,t),c=Jae(a,n,t),d=Xae(r,i),u=Zae(r,i,o);return{id:t.tableId,content:u,hooks:c,styles:l,settings:d}}function Yae(s,t,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},a=function(c){if(c==="columnStyles"){var d=s[c],u=t[c],h=r[c];n.columnStyles=Ku({},d,u,h)}else{var f=[s,t,r],m=f.map(function(p){return p[c]||{}});n[c]=Ku({},m[0],m[1],m[2])}},i=0,o=Object.keys(n);i<o.length;i++){var l=o[i];a(l)}return n}function Jae(s,t,r){for(var n=[s,t,r],a={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},i=0,o=n;i<o.length;i++){var l=o[i];l.didParseCell&&a.didParseCell.push(l.didParseCell),l.willDrawCell&&a.willDrawCell.push(l.willDrawCell),l.didDrawCell&&a.didDrawCell.push(l.didDrawCell),l.willDrawPage&&a.willDrawPage.push(l.willDrawPage),l.didDrawPage&&a.didDrawPage.push(l.didDrawPage)}return a}function Xae(s,t){var r,n,a,i,o,l,c,d,u,h,f,m,p=gN(t.margin,40/s.scaleFactor()),g=(r=Qae(s,t.startY))!==null&&r!==void 0?r:p.top,v;t.showFoot===!0?v="everyPage":t.showFoot===!1?v="never":v=(n=t.showFoot)!==null&&n!==void 0?n:"everyPage";var y;t.showHead===!0?y="everyPage":t.showHead===!1?y="never":y=(a=t.showHead)!==null&&a!==void 0?a:"everyPage";var j=(i=t.useCss)!==null&&i!==void 0?i:!1,b=t.theme||(j?"plain":"striped"),w=!!t.horizontalPageBreak,N=(o=t.horizontalPageBreakRepeat)!==null&&o!==void 0?o:null;return{includeHiddenHtml:(l=t.includeHiddenHtml)!==null&&l!==void 0?l:!1,useCss:j,theme:b,startY:g,margin:p,pageBreak:(c=t.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(d=t.rowPageBreak)!==null&&d!==void 0?d:"auto",tableWidth:(u=t.tableWidth)!==null&&u!==void 0?u:"auto",showHead:y,showFoot:v,tableLineWidth:(h=t.tableLineWidth)!==null&&h!==void 0?h:0,tableLineColor:(f=t.tableLineColor)!==null&&f!==void 0?f:200,horizontalPageBreak:w,horizontalPageBreakRepeat:N,horizontalPageBreakBehaviour:(m=t.horizontalPageBreakBehaviour)!==null&&m!==void 0?m:"afterAllRows"}}function Qae(s,t){var r=s.getLastAutoTable(),n=s.scaleFactor(),a=s.pageNumber(),i=!1;if(r&&r.startPageNumber){var o=r.startPageNumber+r.pageNumber-1;i=o===a}return typeof t=="number"?t:(t==null||t===!1)&&i&&(r==null?void 0:r.finalY)!=null?r.finalY+20/n:null}function Zae(s,t,r){var n=t.head||[],a=t.body||[],i=t.foot||[];if(t.html){var o=t.includeHiddenHtml;if(r){var l=D$(s,t.html,r,o,t.useCss)||{};n=l.head||n,a=l.body||n,i=l.foot||n}else console.error("Cannot parse html in non browser environment")}var c=t.columns||eie(n,a,i);return{columns:c,head:n,body:a,foot:i}}function eie(s,t,r){var n=s[0]||t[0]||r[0]||[],a=[];return Object.keys(n).filter(function(i){return i!=="_element"}).forEach(function(i){var o=1,l;Array.isArray(n)?l=n[parseInt(i)]:l=n[i],typeof l=="object"&&!Array.isArray(l)&&(o=(l==null?void 0:l.colSpan)||1);for(var c=0;c<o;c++){var d=void 0;Array.isArray(n)?d=a.length:d=i+(c>0?"_".concat(c):"");var u={dataKey:d};a.push(u)}}),a}var a4=function(){function s(t,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=t.getDocument()}return s}(),tie=function(s){E$(t,s);function t(r,n,a,i,o,l){var c=s.call(this,r,n,l)||this;return c.cell=a,c.row=i,c.column=o,c.section=i.section,c}return t}(a4),sie=function(){function s(t,r){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return s.prototype.getHeadHeight=function(t){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},s.prototype.getFootHeight=function(t){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},s.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},s.prototype.callCellHooks=function(t,r,n,a,i,o){for(var l=0,c=r;l<c.length;l++){var d=c[l],u=new tie(t,this,n,a,i,o),h=d(u)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],h)return!1}return!0},s.prototype.callEndPageHooks=function(t,r){t.applyStyles(t.userStyles);for(var n=0,a=this.hooks.didDrawPage;n<a.length;n++){var i=a[n];i(new a4(t,this,r))}},s.prototype.callWillDrawPageHooks=function(t,r){for(var n=0,a=this.hooks.willDrawPage;n<a.length;n++){var i=a[n];i(new a4(t,this,r))}},s.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(a,i){return a+i.wrappedWidth},0);return r}else{var n=this.settings.margin;return t-n.left-n.right}},s}(),R$=function(){function s(t,r,n,a,i){i===void 0&&(i=!1),this.height=0,this.raw=t,t instanceof I$&&(this.raw=t._element,this.element=t._element),this.index=r,this.section=n,this.cells=a,this.spansMultiplePages=i}return s.prototype.getMaxCellHeight=function(t){var r=this;return t.reduce(function(n,a){var i;return Math.max(n,((i=r.cells[a.index])===null||i===void 0?void 0:i.height)||0)},0)},s.prototype.hasRowSpan=function(t){var r=this;return t.filter(function(n){var a=r.cells[n.index];return a?a.rowSpan>1:!1}).length>0},s.prototype.canEntireRowFit=function(t,r){return this.getMaxCellHeight(r)<=t},s.prototype.getMinimumRowHeight=function(t,r){var n=this;return t.reduce(function(a,i){var o=n.cells[i.index];if(!o)return 0;var l=r.getLineHeight(o.styles.fontSize),c=o.padding("vertical"),d=c+l;return d>a?d:a},0)},s}(),F$=function(){function s(t,r,n){var a;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=t;var i=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,i=(a=t.content)!==null&&a!==void 0?a:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var o=i!=null?""+i:"",l=/\r\n|\r|\n/g;this.text=o.split(l)}return s.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");t=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var a=this.width-this.padding("horizontal");n=this.x+a/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:t}},s.prototype.getContentHeight=function(t,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,a=this.styles.fontSize/t*r,i=n*a+this.padding("vertical");return Math.max(i,this.styles.minCellHeight)},s.prototype.padding=function(t){var r=gN(this.styles.cellPadding,0);return t==="vertical"?r.top+r.bottom:t==="horizontal"?r.left+r.right:r[t]},s}(),rie=function(){function s(t,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=r,this.index=n}return s.prototype.getMaxCustomCellWidth=function(t){for(var r=0,n=0,a=t.allRows();n<a.length;n++){var i=a[n],o=i.cells[this.index];o&&typeof o.styles.cellWidth=="number"&&(r=Math.max(r,o.styles.cellWidth))}return r},s}();function nie(s,t){aie(s,t);var r=[],n=0;t.columns.forEach(function(i){var o=i.getMaxCustomCellWidth(t);o?i.width=o:(i.width=i.wrappedWidth,r.push(i)),n+=i.width});var a=t.getWidth(s.pageSize().width)-n;a&&(a=i4(r,a,function(i){return Math.max(i.minReadableWidth,i.minWidth)})),a&&(a=i4(r,a,function(i){return i.minWidth})),a=Math.abs(a),!t.settings.horizontalPageBreak&&a>.1/s.scaleFactor()&&(a=a<1?a:Math.round(a),console.warn("Of the table content, ".concat(a," units width could not fit page"))),oie(t),lie(t,s),iie(t)}function aie(s,t){var r=s.scaleFactor(),n=t.settings.horizontalPageBreak,a=k$(s,t);t.allRows().forEach(function(i){for(var o=0,l=t.columns;o<l.length;o++){var c=l[o],d=i.cells[c.index];if(d){var u=t.hooks.didParseCell;t.callCellHooks(s,u,d,i,c,null);var h=d.padding("horizontal");d.contentWidth=f1(d.text,d.styles,s)+h;var f=f1(d.text.join(" ").split(/[^\S\u00A0]+/),d.styles,s);if(d.minReadableWidth=f+d.padding("horizontal"),typeof d.styles.cellWidth=="number")d.minWidth=d.styles.cellWidth,d.wrappedWidth=d.styles.cellWidth;else if(d.styles.cellWidth==="wrap"||n===!0)d.contentWidth>a?(d.minWidth=a,d.wrappedWidth=a):(d.minWidth=d.contentWidth,d.wrappedWidth=d.contentWidth);else{var m=10/r;d.minWidth=d.styles.minCellWidth||m,d.wrappedWidth=d.contentWidth,d.minWidth>d.wrappedWidth&&(d.wrappedWidth=d.minWidth)}}}}),t.allRows().forEach(function(i){for(var o=0,l=t.columns;o<l.length;o++){var c=l[o],d=i.cells[c.index];if(d&&d.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,d.wrappedWidth),c.minWidth=Math.max(c.minWidth,d.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,d.minReadableWidth);else{var u=t.styles.columnStyles[c.dataKey]||t.styles.columnStyles[c.index]||{},h=u.cellWidth||u.minCellWidth;h&&typeof h=="number"&&(c.minWidth=h,c.wrappedWidth=h)}d&&(d.colSpan>1&&!c.minWidth&&(c.minWidth=d.minWidth),d.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=d.minWidth))}})}function i4(s,t,r){for(var n=t,a=s.reduce(function(m,p){return m+p.wrappedWidth},0),i=0;i<s.length;i++){var o=s[i],l=o.wrappedWidth/a,c=n*l,d=o.width+c,u=r(o),h=d<u?u:d;t-=h-o.width,o.width=h}if(t=Math.round(t*1e10)/1e10,t){var f=s.filter(function(m){return t<0?m.width>r(m):!0});f.length&&(t=i4(f,t,r))}return t}function iie(s){for(var t={},r=1,n=s.allRows(),a=0;a<n.length;a++)for(var i=n[a],o=0,l=s.columns;o<l.length;o++){var c=l[o],d=t[c.index];if(r>1)r--,delete i.cells[c.index];else if(d)d.cell.height+=i.height,r=d.cell.colSpan,delete i.cells[c.index],d.left--,d.left<=1&&delete t[c.index];else{var u=i.cells[c.index];if(!u)continue;if(u.height=i.height,u.rowSpan>1){var h=n.length-a,f=u.rowSpan>h?h:u.rowSpan;t[c.index]={cell:u,left:f,row:i}}}}}function oie(s){for(var t=s.allRows(),r=0;r<t.length;r++)for(var n=t[r],a=null,i=0,o=0,l=0;l<s.columns.length;l++){var c=s.columns[l];if(o-=1,o>1&&s.columns[l+1])i+=c.width,delete n.cells[c.index];else if(a){var d=a;delete n.cells[c.index],a=null,d.width=c.width+i}else{var d=n.cells[c.index];if(!d)continue;if(o=d.colSpan,i=0,d.colSpan>1){a=d,i+=c.width;continue}d.width=c.width+i}}}function lie(s,t){for(var r={count:0,height:0},n=0,a=s.allRows();n<a.length;n++){for(var i=a[n],o=0,l=s.columns;o<l.length;o++){var c=l[o],d=i.cells[c.index];if(d){t.applyStyles(d.styles,!0);var u=d.width-d.padding("horizontal");if(d.styles.overflow==="linebreak")d.text=t.splitTextToSize(d.text,u+1/t.scaleFactor(),{fontSize:d.styles.fontSize});else if(d.styles.overflow==="ellipsize")d.text=w_(d.text,u,d.styles,t,"...");else if(d.styles.overflow==="hidden")d.text=w_(d.text,u,d.styles,t,"");else if(typeof d.styles.overflow=="function"){var h=d.styles.overflow(d.text,u);typeof h=="string"?d.text=[h]:d.text=h}d.contentHeight=d.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var f=d.contentHeight/d.rowSpan;d.rowSpan>1&&r.count*r.height<f*d.rowSpan?r={height:f,count:d.rowSpan}:r&&r.count>0&&r.height>f&&(f=r.height),f>i.height&&(i.height=f)}}r.count--}}function w_(s,t,r,n,a){return s.map(function(i){return cie(i,t,r,n,a)})}function cie(s,t,r,n,a){var i=1e4*n.scaleFactor();if(t=Math.ceil(t*i)/i,t>=f1(s,r,n))return s;for(;t<f1(s+a,r,n)&&!(s.length<=1);)s=s.substring(0,s.length-1);return s.trim()+a}function M$(s,t){var r=new tp(s),n=die(t,r.scaleFactor()),a=new sie(t,n);return nie(r,a),r.applyStyles(r.userStyles),a}function die(s,t){var r=s.content,n=hie(r.columns);if(r.head.length===0){var a=S_(n,"head");a&&r.head.push(a)}if(r.foot.length===0){var a=S_(n,"foot");a&&r.foot.push(a)}var i=s.settings.theme,o=s.styles;return{columns:n,head:L2("head",r.head,n,o,i,t),body:L2("body",r.body,n,o,i,t),foot:L2("foot",r.foot,n,o,i,t)}}function L2(s,t,r,n,a,i){var o={},l=t.map(function(c,d){for(var u=0,h={},f=0,m=0,p=0,g=r;p<g.length;p++){var v=g[p];if(o[v.index]==null||o[v.index].left===0)if(m===0){var y=void 0;Array.isArray(c)?y=c[v.index-f-u]:y=c[v.dataKey];var j={};typeof y=="object"&&!Array.isArray(y)&&(j=(y==null?void 0:y.styles)||{});var b=mie(s,v,d,a,n,i,j),w=new F$(y,b,s);h[v.dataKey]=w,h[v.index]=w,m=w.colSpan-1,o[v.index]={left:w.rowSpan-1,times:m}}else m--,f++;else o[v.index].left--,m=o[v.index].times,u++}return new R$(c,d,s,h)});return l}function S_(s,t){var r={};return s.forEach(function(n){if(n.raw!=null){var a=uie(t,n.raw);a!=null&&(r[n.dataKey]=a)}}),Object.keys(r).length>0?r:null}function uie(s,t){if(s==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(s==="foot"&&typeof t=="object")return t.footer;return null}function hie(s){return s.map(function(t,r){var n,a;return typeof t=="object"?a=(n=t.dataKey)!==null&&n!==void 0?n:r:a=r,new rie(a,t,r)})}function mie(s,t,r,n,a,i,o){var l=zae(n),c;s==="head"?c=a.headStyles:s==="body"?c=a.bodyStyles:s==="foot"&&(c=a.footStyles);var d=Ku({},l.table,l[s],a.styles,c),u=a.columnStyles[t.dataKey]||a.columnStyles[t.index]||{},h=s==="body"?u:{},f=s==="body"&&r%2===0?Ku({},l.alternateRow,a.alternateRowStyles):{},m=Uae(i),p=Ku({},m,d,f,h);return Ku(p,o)}function fie(s,t,r){var n;r===void 0&&(r={});var a=k$(s,t),i=new Map,o=[],l=[],c=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?c=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(c=[t.settings.horizontalPageBreakRepeat]),c.forEach(function(f){var m=t.columns.find(function(p){return p.dataKey===f||p.index===f});m&&!i.has(m.index)&&(i.set(m.index,!0),o.push(m.index),l.push(t.columns[m.index]),a-=m.wrappedWidth)});for(var d=!0,u=(n=r==null?void 0:r.start)!==null&&n!==void 0?n:0;u<t.columns.length;){if(i.has(u)){u++;continue}var h=t.columns[u].wrappedWidth;if(d||a>=h)d=!1,o.push(u),l.push(t.columns[u]),a-=h;else break;u++}return{colIndexes:o,columns:l,lastIndex:u-1}}function xie(s,t){for(var r=[],n=0;n<t.columns.length;n++){var a=fie(s,t,{start:n});a.columns.length&&(r.push(a),n=a.lastIndex)}return r}function L$(s,t){var r=t.settings,n=r.startY,a=r.margin,i={x:a.left,y:n},o=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),l=n+a.bottom+o;if(r.pageBreak==="avoid"){var c=t.body,d=c.reduce(function(f,m){return f+m.height},0);l+=d}var u=new tp(s);(r.pageBreak==="always"||r.startY!=null&&l>u.pageSize().height)&&(B$(u),i.y=a.top),t.callWillDrawPageHooks(u,i);var h=Ku({},i);t.startPageNumber=u.pageNumber(),r.horizontalPageBreak?pie(u,t,h,i):(u.applyStyles(u.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(f){return ch(u,t,f,i,t.columns)}),u.applyStyles(u.userStyles),t.body.forEach(function(f,m){var p=m===t.body.length-1;x1(u,t,f,p,h,i,t.columns)}),u.applyStyles(u.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(f){return ch(u,t,f,i,t.columns)})),P$(u,t,h,i),t.callEndPageHooks(u,i),t.finalY=i.y,s.lastAutoTable=t,u.applyStyles(u.userStyles)}function pie(s,t,r,n){var a=xie(s,t),i=t.settings;if(i.horizontalPageBreakBehaviour==="afterAllRows")a.forEach(function(d,u){s.applyStyles(s.userStyles),u>0?$0(s,t,r,n,d.columns,!0):C_(s,t,n,d.columns),gie(s,t,r,n,d.columns),$2(s,t,n,d.columns)});else for(var o=-1,l=a[0],c=function(){var d=o;if(l){s.applyStyles(s.userStyles);var u=l.columns;o>=0?$0(s,t,r,n,u,!0):C_(s,t,n,u),d=A_(s,t,o+1,n,u),$2(s,t,n,u)}var h=d-o;a.slice(1).forEach(function(f){s.applyStyles(s.userStyles),$0(s,t,r,n,f.columns,!0),A_(s,t,o+1,n,f.columns,h),$2(s,t,n,f.columns)}),o=d};o<t.body.length-1;)c()}function C_(s,t,r,n){var a=t.settings;s.applyStyles(s.userStyles),(a.showHead==="firstPage"||a.showHead==="everyPage")&&t.head.forEach(function(i){return ch(s,t,i,r,n)})}function gie(s,t,r,n,a){s.applyStyles(s.userStyles),t.body.forEach(function(i,o){var l=o===t.body.length-1;x1(s,t,i,l,r,n,a)})}function A_(s,t,r,n,a,i){s.applyStyles(s.userStyles),i=i??t.body.length;var o=Math.min(r+i,t.body.length),l=-1;return t.body.slice(r,o).forEach(function(c,d){var u=r+d===t.body.length-1,h=$$(s,t,u,n);c.canEntireRowFit(h,a)&&(ch(s,t,c,n,a),l=r+d)}),l}function $2(s,t,r,n){var a=t.settings;s.applyStyles(s.userStyles),(a.showFoot==="lastPage"||a.showFoot==="everyPage")&&t.foot.forEach(function(i){return ch(s,t,i,r,n)})}function vie(s,t,r){var n=r.getLineHeight(s.styles.fontSize),a=s.padding("vertical"),i=Math.floor((t-a)/n);return Math.max(0,i)}function yie(s,t,r,n){var a={};s.spansMultiplePages=!0,s.height=0;for(var i=0,o=0,l=r.columns;o<l.length;o++){var c=l[o],d=s.cells[c.index];if(d){Array.isArray(d.text)||(d.text=[d.text]);var u=new F$(d.raw,d.styles,d.section);u=Ku(u,d),u.text=[];var h=vie(d,t,n);d.text.length>h&&(u.text=d.text.splice(h,d.text.length));var f=n.scaleFactor(),m=n.getLineHeightFactor();d.contentHeight=d.getContentHeight(f,m),d.contentHeight>=t&&(d.contentHeight=t,u.styles.minCellHeight-=t),d.contentHeight>s.height&&(s.height=d.contentHeight),u.contentHeight=u.getContentHeight(f,m),u.contentHeight>i&&(i=u.contentHeight),a[c.index]=u}}var p=new R$(s.raw,-1,s.section,a,!0);p.height=i;for(var g=0,v=r.columns;g<v.length;g++){var c=v[g],u=p.cells[c.index];u&&(u.height=p.height);var d=s.cells[c.index];d&&(d.height=s.height)}return p}function jie(s,t,r,n){var a=s.pageSize().height,i=n.settings.margin,o=i.top+i.bottom,l=a-o;t.section==="body"&&(l-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=t.getMinimumRowHeight(n.columns,s),d=c<r;if(c>l)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!d)return!1;var u=t.hasRowSpan(n.columns),h=t.getMaxCellHeight(n.columns)>l;return h?(u&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(u||n.settings.rowPageBreak==="avoid")}function x1(s,t,r,n,a,i,o){var l=$$(s,t,n,i);if(r.canEntireRowFit(l,o))ch(s,t,r,i,o);else if(jie(s,r,l,t)){var c=yie(r,l,t,s);ch(s,t,r,i,o),$0(s,t,a,i,o),x1(s,t,c,n,a,i,o)}else $0(s,t,a,i,o),x1(s,t,r,n,a,i,o)}function ch(s,t,r,n,a){n.x=t.settings.margin.left;for(var i=0,o=a;i<o.length;i++){var l=o[i],c=r.cells[l.index];if(!c){n.x+=l.width;continue}s.applyStyles(c.styles),c.x=n.x,c.y=n.y;var d=t.callCellHooks(s,t.hooks.willDrawCell,c,r,l,n);if(d===!1){n.x+=l.width;continue}bie(s,c,n);var u=c.getTextPos();A$(c.text,u.x,u.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},s.getDocument()),t.callCellHooks(s,t.hooks.didDrawCell,c,r,l,n),n.x+=l.width}n.y+=r.height}function bie(s,t,r){var n=t.styles;if(s.getDocument().setFillColor(s.getDocument().getFillColor()),typeof n.lineWidth=="number"){var a=_$(n.lineWidth,n.fillColor);a&&s.rect(t.x,r.y,t.width,t.height,a)}else typeof n.lineWidth=="object"&&(n.fillColor&&s.rect(t.x,r.y,t.width,t.height,"F"),Nie(s,t,r,n.lineWidth))}function Nie(s,t,r,n){var a,i,o,l;n.top&&(a=r.x,i=r.y,o=r.x+t.width,l=r.y,n.right&&(o+=.5*n.right),n.left&&(a-=.5*n.left),c(n.top,a,i,o,l)),n.bottom&&(a=r.x,i=r.y+t.height,o=r.x+t.width,l=r.y+t.height,n.right&&(o+=.5*n.right),n.left&&(a-=.5*n.left),c(n.bottom,a,i,o,l)),n.left&&(a=r.x,i=r.y,o=r.x,l=r.y+t.height,n.top&&(i-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.left,a,i,o,l)),n.right&&(a=r.x+t.width,i=r.y,o=r.x+t.width,l=r.y+t.height,n.top&&(i-=.5*n.top),n.bottom&&(l+=.5*n.bottom),c(n.right,a,i,o,l));function c(d,u,h,f,m){s.getDocument().setLineWidth(d),s.getDocument().line(u,h,f,m,"S")}}function $$(s,t,r,n){var a=t.settings.margin.bottom,i=t.settings.showFoot;return(i==="everyPage"||i==="lastPage"&&r)&&(a+=t.getFootHeight(t.columns)),s.pageSize().height-n.y-a}function $0(s,t,r,n,a,i){a===void 0&&(a=[]),i===void 0&&(i=!1),s.applyStyles(s.userStyles),t.settings.showFoot==="everyPage"&&!i&&t.foot.forEach(function(l){return ch(s,t,l,n,a)}),t.callEndPageHooks(s,n);var o=t.settings.margin;P$(s,t,r,n),B$(s),t.pageNumber++,n.x=o.left,n.y=o.top,r.y=o.top,t.callWillDrawPageHooks(s,n),t.settings.showHead==="everyPage"&&(t.head.forEach(function(l){return ch(s,t,l,n,a)}),s.applyStyles(s.userStyles))}function B$(s){var t=s.pageNumber();s.setPage(t+1);var r=s.pageNumber();return r===t?(s.addPage(),!0):!1}function wie(s){s.API.autoTable=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t[0],a=O$(this,n),i=M$(this,a);return L$(this,i),this},s.API.lastAutoTable=!1,s.API.autoTableText=function(t,r,n,a){A$(t,r,n,a,this)},s.API.autoTableSetDefaults=function(t){return tp.setDefaults(t,this),this},s.autoTableSetDefaults=function(t,r){tp.setDefaults(t,r)},s.API.autoTableHtmlToJson=function(t,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var a=new tp(this),i=D$(a,t,window,r,!1),o=i.head,l=i.body,c=((n=o[0])===null||n===void 0?void 0:n.map(function(d){return d.content}))||[];return{columns:c,rows:l,data:l}}}var B2;function Sie(s,t){var r=O$(s,t),n=M$(s,r);L$(s,n)}try{if(typeof window<"u"&&window){var E_=window,I_=E_.jsPDF||((B2=E_.jspdf)===null||B2===void 0?void 0:B2.jsPDF);I_&&wie(I_)}}catch(s){console.error("Could not apply autoTable plugin",s)}class Pp{constructor(t){dn(this,"doc");dn(this,"primaryColor");dn(this,"margin",20);dn(this,"currentY",20);this.options=t,this.doc=new jr("p","mm","a4"),this.primaryColor=t.company.primaryColor||"#1f2937"}formatCurrency(t,r){try{return new Intl.NumberFormat("en-US",{style:"currency",currency:r}).format(t)}catch{return`${r} ${t.toFixed(2)}`}}setColor(t){const r=t.replace("#",""),n=parseInt(r.substr(0,2),16),a=parseInt(r.substr(2,2),16),i=parseInt(r.substr(4,2),16);this.doc.setTextColor(n,a,i)}resetColor(){this.doc.setTextColor(0,0,0)}addLine(t){const r=t||this.currentY;this.doc.setDrawColor(200,200,200),this.doc.line(this.margin,r,190,r)}async generateQRCode(){try{const t=this.options.invoice.paymentUrl||`Invoice: ${this.options.invoice.invoiceNumber}
Amount: ${this.formatCurrency(this.options.invoice.totalAmount,this.options.invoice.currency)}
Due: ${this.options.invoice.dueDate||"N/A"}`;return await hx.toDataURL(t,{width:400,margin:1,color:{dark:this.primaryColor,light:"#FFFFFF"}})}catch(t){return console.error("Error generating QR code:",t),""}}generateBarcode(){const t=document.createElement("canvas");t.width=200,t.height=50;const r=t.getContext("2d");if(r){r.fillStyle="#FFFFFF",r.fillRect(0,0,t.width,t.height),r.fillStyle=this.primaryColor;const n=2;let a=10;const i=this.options.invoice.invoiceNumber.replace(/[^0-9]/g,"")||"123456";for(let o=0;o<i.length;o++){const l=parseInt(i[o]);for(let c=0;c<5;c++)(l+c)%2===0&&r.fillRect(a,5,n,35),a+=n+1;a+=3}r.fillStyle="#374151",r.font="10px monospace",r.textAlign="center",r.fillText(this.options.invoice.invoiceNumber,t.width/2,47)}return t.toDataURL()}async addHeader(){const{company:t,invoice:r}=this.options;if(t.logoUrl)try{this.doc.addImage(t.logoUrl,"PNG",this.margin,this.currentY,30,30)}catch(o){console.error("Error adding logo:",o)}this.doc.setFontSize(24),this.setColor(this.primaryColor),this.doc.text(t.name,t.logoUrl?this.margin+35:this.margin,this.currentY+10),this.resetColor(),this.doc.setFontSize(10);let n=this.currentY+15;if(t.address&&(this.doc.text(t.address,t.logoUrl?this.margin+35:this.margin,n),n+=4),t.city||t.state||t.postalCode){const o=[t.city,t.state,t.postalCode].filter(Boolean).join(", ");this.doc.text(o,t.logoUrl?this.margin+35:this.margin,n),n+=4}t.email&&(this.doc.text(`Email: ${t.email}`,t.logoUrl?this.margin+35:this.margin,n),n+=4),t.phone&&(this.doc.text(`Phone: ${t.phone}`,t.logoUrl?this.margin+35:this.margin,n),n+=4),this.doc.setFontSize(28),this.setColor(this.primaryColor),this.doc.text("INVOICE",190-this.doc.getTextWidth("INVOICE"),this.currentY+10),this.resetColor(),this.doc.setFontSize(16),this.doc.text(`#${r.invoiceNumber}`,190-this.doc.getTextWidth(`#${r.invoiceNumber}`),this.currentY+20),this.doc.setFontSize(10);const a=r.status.toUpperCase(),i=this.doc.getTextWidth(a)+4;this.doc.setFillColor(240,240,240),this.doc.rect(190-i,this.currentY+25,i,6,"F"),this.doc.text(a,190-i+2,this.currentY+29);try{const o=await this.generateQRCode();o&&(this.doc.addImage(o,"PNG",160,this.currentY+35,25,25),this.doc.setFontSize(8),this.doc.text("Scan to Pay",172.5-this.doc.getTextWidth("Scan to Pay")/2,this.currentY+65))}catch(o){console.error("Error adding QR code:",o)}try{const o=this.generateBarcode();o&&this.doc.addImage(o,"PNG",120,this.currentY+40,35,12)}catch(o){console.error("Error adding barcode:",o)}this.currentY=Math.max(n,this.currentY+70),this.addLine(this.currentY),this.currentY+=10}addInvoiceDetails(){var i,o,l,c;const{invoice:t}=this.options;this.doc.setFontSize(12),this.doc.setFont("helvetica","bold"),this.doc.text("BILL TO",this.margin,this.currentY),this.doc.setFont("helvetica","normal"),this.doc.setFontSize(10);let r=this.currentY+6;(i=t.customer)!=null&&i.name&&(this.doc.setFont("helvetica","bold"),this.doc.text(t.customer.name,this.margin,r),this.doc.setFont("helvetica","normal"),r+=5),(o=t.customer)!=null&&o.address&&(this.doc.text(t.customer.address,this.margin,r),r+=4),(l=t.customer)!=null&&l.email&&(this.doc.text(t.customer.email,this.margin,r),r+=4),(c=t.customer)!=null&&c.phone&&(this.doc.text(t.customer.phone,this.margin,r),r+=4),this.doc.setFont("helvetica","bold"),this.doc.setFontSize(12),this.doc.text("INVOICE DETAILS",110,this.currentY),this.doc.setFont("helvetica","normal"),this.doc.setFontSize(10);let n=this.currentY+6;[["Issue Date:",new Date(t.issueDate).toLocaleDateString()],...t.dueDate?[["Due Date:",new Date(t.dueDate).toLocaleDateString()]]:[],["Currency:",t.currency],["Amount:",this.formatCurrency(t.totalAmount,t.currency)],...t.balanceDue>0?[["Balance Due:",this.formatCurrency(t.balanceDue,t.currency)]]:[]].forEach(([d,u])=>{this.doc.text(d,110,n),this.doc.text(u,140,n),n+=4}),this.currentY=Math.max(r,n)+10}addLineItems(){const{invoice:t}=this.options;if(!t.lines||t.lines.length===0)return;const r=[["Description","Qty","Rate","Amount"]],n=t.lines.some(i=>i.taxRate&&i.taxRate>0);n&&r[0].splice(3,0,"Tax");const a=t.lines.map(i=>{const o=[i.description,i.quantity.toString(),this.formatCurrency(i.unitPrice,t.currency),this.formatCurrency(i.lineTotal,t.currency)];return n&&o.splice(3,0,i.taxRate?`${i.taxRate}%`:""),o});Sie(this.doc,{head:r,body:a,startY:this.currentY,margin:{left:this.margin,right:this.margin},styles:{fontSize:10,cellPadding:3},headStyles:{fillColor:[31,41,55],textColor:[255,255,255],fontStyle:"bold"},alternateRowStyles:{fillColor:[249,250,251]},columnStyles:{1:{halign:"center"},2:{halign:"right"},...n?{3:{halign:"center"},4:{halign:"right"}}:{3:{halign:"right"}}}}),this.currentY=this.doc.lastAutoTable.finalY+10}addTotals(){var l;const{invoice:t}=this.options,r=t.subtotal||((l=t.lines)==null?void 0:l.reduce((c,d)=>c+d.lineTotal,0))||0,n=t.taxAmount||0,a=t.discountAmount||0,i=130,o=110;this.doc.setFontSize(10),this.doc.text("Subtotal:",o,this.currentY),this.doc.text(this.formatCurrency(r,t.currency),i,this.currentY),this.currentY+=5,a>0&&(this.doc.text("Discount:",o,this.currentY),this.doc.text(`-${this.formatCurrency(a,t.currency)}`,i,this.currentY),this.currentY+=5),n>0&&(this.doc.text("Tax:",o,this.currentY),this.doc.text(this.formatCurrency(n,t.currency),i,this.currentY),this.currentY+=5),this.doc.setDrawColor(100,100,100),this.doc.line(o,this.currentY+2,185,this.currentY+2),this.currentY+=8,this.doc.setFont("helvetica","bold"),this.doc.setFontSize(12),this.setColor(this.primaryColor),this.doc.text("TOTAL:",o,this.currentY),this.doc.text(this.formatCurrency(t.totalAmount,t.currency),i,this.currentY),this.resetColor(),this.currentY+=10,t.balanceDue>0&&(this.doc.setFont("helvetica","bold"),this.doc.setFontSize(11),this.doc.setTextColor(220,38,38),this.doc.text("BALANCE DUE:",o,this.currentY),this.doc.text(this.formatCurrency(t.balanceDue,t.currency),i,this.currentY),this.resetColor(),this.currentY+=8)}addNotes(){const{invoice:t}=this.options;if(t.notes){this.currentY+=5,this.doc.setFont("helvetica","bold"),this.doc.setFontSize(11),this.doc.text("NOTES:",this.margin,this.currentY),this.doc.setFont("helvetica","normal"),this.doc.setFontSize(10),this.currentY+=6;const r=this.doc.splitTextToSize(t.notes,170);this.doc.text(r,this.margin,this.currentY),this.currentY+=r.length*4+5}}addFooter(){const{company:t}=this.options;this.currentY+=10,this.addLine(this.currentY),this.currentY+=8,this.doc.setFont("helvetica","bold"),this.doc.setFontSize(11),this.doc.text("PAYMENT TERMS",this.margin,this.currentY),this.doc.setFont("helvetica","normal"),this.doc.setFontSize(9),this.currentY+=6;const r=t.invoiceTerms||"Payment is due within 30 days of invoice date. Late payments may incur additional fees.",n=this.doc.splitTextToSize(r,170);if(this.doc.text(n,this.margin,this.currentY),this.currentY+=n.length*3+5,t.invoiceFooter){this.currentY+=5,this.doc.setFontSize(8),this.doc.setTextColor(100,100,100);const i=this.doc.splitTextToSize(t.invoiceFooter,170);this.doc.text(i,this.margin,this.currentY),this.currentY+=i.length*3}this.currentY+=5,this.doc.setFontSize(7),this.doc.setTextColor(150,150,150);const a=`Generated on ${new Date().toLocaleString()}  Invoice #${this.options.invoice.invoiceNumber}`;this.doc.text(a,105-this.doc.getTextWidth(a)/2,this.currentY)}async generate(){return await this.addHeader(),this.addInvoiceDetails(),this.addLineItems(),this.addTotals(),this.addNotes(),this.addFooter(),this.doc.output("blob")}async download(t){await this.addHeader(),this.addInvoiceDetails(),this.addLineItems(),this.addTotals(),this.addNotes(),this.addFooter();const r=`invoice-${this.options.invoice.invoiceNumber}.pdf`;this.doc.save(t||r)}}function Cie({invoice:s,company:t,onDownloadPDF:r,onPrint:n,onPaymentSuccess:a,onPaymentError:i}){const[o,l]=x.useState(""),[c,d]=x.useState(""),u=x.useRef(null),h=(T,V)=>{try{return new Intl.NumberFormat("en-US",{style:"currency",currency:V}).format(T)}catch{return`${V} ${T.toFixed(2)}`}},f=T=>{switch(T.toLowerCase()){case"paid":return{bg:"bg-emerald-50 border-emerald-200",text:"text-emerald-700",dot:"bg-emerald-500"};case"sent":return{bg:"bg-blue-50 border-blue-200",text:"text-blue-700",dot:"bg-blue-500"};case"draft":return{bg:"bg-gray-50 border-gray-200",text:"text-gray-700",dot:"bg-gray-500"};case"overdue":return{bg:"bg-red-50 border-red-200",text:"text-red-700",dot:"bg-red-500"};case"cancelled":return{bg:"bg-orange-50 border-orange-200",text:"text-orange-700",dot:"bg-orange-500"};default:return{bg:"bg-gray-50 border-gray-200",text:"text-gray-700",dot:"bg-gray-500"}}},m=t.invoiceTemplate||"professional",p=t.primaryColor||"#1f2937",g=t.secondaryColor||"#3b82f6",v=t.fontFamily||"Inter";x.useEffect(()=>{const T=async()=>{try{const V=s.paymentUrl||`Invoice: ${s.invoiceNumber}
Amount: ${h(s.totalAmount,s.currency)}
Due: ${s.dueDate||"N/A"}`,M=await hx.toDataURL(V,{width:120,margin:1,color:{dark:p,light:"#FFFFFF"}});l(M)}catch(V){console.error("Error generating QR code:",V)}};t.showQRCode!==!1&&T()},[s,t.showQRCode,p]),x.useEffect(()=>{const T=()=>{try{if(u.current){const V=u.current,M=V.getContext("2d");if(M){V.width=200,V.height=50,M.fillStyle="#FFFFFF",M.fillRect(0,0,V.width,V.height),M.fillStyle=p;const G=2;let L=10;const J=s.invoiceNumber.replace(/[^0-9]/g,"")||"123456";for(let z=0;z<J.length;z++){const U=parseInt(J[z]);for(let oe=0;oe<5;oe++)(U+oe)%2===0&&M.fillRect(L,5,G,35),L+=G+1;L+=3}M.fillStyle="#374151",M.font="10px monospace",M.textAlign="center",M.fillText(s.invoiceNumber,V.width/2,47),d(V.toDataURL())}}}catch(V){console.error("Error generating barcode:",V)}};t.showBarcode!==!1&&T()},[s.invoiceNumber,t.showBarcode,p]);const{toast:y}=za(),j=()=>{n?n():window.print()},b=async()=>{try{await new Pp({invoice:{...s,subtotal:N(),taxAmount:C()},company:t}).download(),y({title:"PDF Downloaded",description:`Invoice ${s.invoiceNumber} has been downloaded successfully.`})}catch(T){console.error("Error generating PDF:",T),y({title:"Download Failed",description:"There was an error generating the PDF. Please try again.",variant:"destructive"}),r&&r()}},w=async()=>{try{const V=await new Pp({invoice:{...s,subtotal:N(),taxAmount:C()},company:t}).generate(),M=new File([V],`invoice-${s.invoiceNumber}.pdf`,{type:"application/pdf"});if(navigator.share&&navigator.canShare({files:[M]}))await navigator.share({title:`Invoice ${s.invoiceNumber}`,text:`Invoice for ${h(s.totalAmount,s.currency)}`,files:[M]});else{const G=s.paymentUrl||window.location.href;await navigator.clipboard.writeText(G),y({title:"Link Copied",description:"Invoice link has been copied to clipboard."})}}catch(T){console.error("Error sharing invoice:",T),y({title:"Share Failed",description:"There was an error sharing the invoice.",variant:"destructive"})}},N=()=>{var T;return((T=s.lines)==null?void 0:T.reduce((V,M)=>V+M.lineTotal,0))||s.subtotal||0},C=()=>{var T;return s.taxAmount||((T=s.lines)==null?void 0:T.reduce((V,M)=>{const G=M.lineTotal,L=M.taxRate||0;return V+G*L/100},0))||0},S=()=>{var L,J,z,U,oe,Q,P;const T=f(s.status),V=N(),M=C(),G=s.discountAmount||0;return e.jsxs("div",{className:"max-w-5xl mx-auto bg-white shadow-xl print:shadow-none print:max-w-none",style:{fontFamily:v},children:[e.jsx("canvas",{ref:u,style:{display:"none"}}),e.jsxs("div",{className:"relative bg-white border-b-2 print:border-b-1",style:{borderColor:p},children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-gray-50 to-white opacity-50"}),e.jsx("div",{className:"relative px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-start space-x-6",children:[t.logoUrl&&t.showLogo&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-20 h-20 bg-white rounded-lg shadow-md p-2 border",children:e.jsx("img",{src:t.logoUrl,alt:`${t.name} logo`,className:"w-full h-full object-contain"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",style:{color:p},children:t.name}),t.showAddress&&t.address&&e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsx("div",{children:t.address}),(t.city||t.state||t.postalCode)&&e.jsx("div",{children:[t.city,t.state,t.postalCode].filter(Boolean).join(", ")})]}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[t.email&&e.jsxs("div",{children:["Email: ",t.email]}),t.phone&&e.jsxs("div",{children:["Phone: ",t.phone]}),t.showWebsite&&t.website&&e.jsxs("div",{children:["Web: ",t.website]}),t.taxId&&e.jsxs("div",{children:["Tax ID: ",t.taxId]})]})]})]}),e.jsxs("div",{className:"text-right space-y-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-2",children:"INVOICE"}),e.jsxs("div",{className:"text-2xl font-semibold text-gray-700",children:["#",s.invoiceNumber]})]}),e.jsxs("div",{className:`inline-flex items-center px-4 py-2 rounded-full border ${T.bg} ${T.text}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full mr-2 ${T.dot}`}),e.jsx("span",{className:"font-semibold text-sm uppercase tracking-wide",children:s.status})]}),e.jsxs("div",{className:"flex flex-col items-end space-y-3 print:space-y-2",children:[o&&t.showQRCode!==!1&&e.jsxs("div",{className:"text-center",children:[e.jsx("img",{src:o,alt:"Invoice QR Code",className:"w-24 h-24 print:w-20 print:h-20"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Scan to Pay"})]}),c&&t.showBarcode!==!1&&e.jsx("div",{className:"text-center",children:e.jsx("img",{src:c,alt:"Invoice Barcode",className:"h-12 print:h-10"})})]})]})]})})]}),e.jsx("div",{className:"px-8 py-6 bg-gray-50 print:bg-white",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b border-gray-300 pb-2",children:"Bill To"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsx("div",{className:"font-semibold text-gray-900 text-base",children:(L=s.customer)==null?void 0:L.name}),((J=s.customer)==null?void 0:J.address)&&e.jsx("div",{className:"text-gray-600",children:s.customer.address}),((z=s.customer)==null?void 0:z.email)&&e.jsx("div",{className:"text-gray-600",children:s.customer.email}),((U=s.customer)==null?void 0:U.phone)&&e.jsx("div",{className:"text-gray-600",children:s.customer.phone}),((oe=s.customer)==null?void 0:oe.taxId)&&e.jsxs("div",{className:"text-gray-600",children:["Tax ID: ",s.customer.taxId]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b border-gray-300 pb-2",children:"Invoice Details"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Issue Date:"}),e.jsx("span",{className:"font-medium",children:new Date(s.issueDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),s.dueDate&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Due Date:"}),e.jsx("span",{className:"font-medium",children:new Date(s.dueDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Currency:"}),e.jsx("span",{className:"font-medium",children:s.currency})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b border-gray-300 pb-2",children:"Payment Summary"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Amount:"}),e.jsx("span",{className:"font-semibold",children:h(s.totalAmount,s.currency)})]}),s.balanceDue>0&&e.jsxs("div",{className:"flex justify-between text-red-600",children:[e.jsx("span",{children:"Amount Due:"}),e.jsx("span",{className:"font-bold",children:h(s.balanceDue,s.currency)})]}),s.status==="paid"&&e.jsx("div",{className:"text-green-600 font-semibold text-center py-2 bg-green-50 rounded",children:" PAID IN FULL"})]})]})]})}),s.lines&&s.lines.length>0&&e.jsx("div",{className:"px-8 py-6",children:e.jsx("div",{className:"overflow-hidden rounded-lg border border-gray-200",children:e.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-900 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-semibold text-gray-900 uppercase tracking-wider",children:"Qty"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-900 uppercase tracking-wider",children:"Rate"}),s.lines.some(q=>q.taxRate&&q.taxRate>0)&&e.jsx("th",{className:"px-6 py-4 text-center text-xs font-semibold text-gray-900 uppercase tracking-wider",children:"Tax"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-900 uppercase tracking-wider",children:"Amount"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.lines.map((q,D)=>{var se;return e.jsxs("tr",{className:D%2===0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 font-medium",children:q.description}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700 text-center",children:q.quantity}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700 text-right",children:h(q.unitPrice,s.currency)}),((se=s.lines)==null?void 0:se.some(he=>he.taxRate&&he.taxRate>0))&&e.jsx("td",{className:"px-6 py-4 text-sm text-gray-700 text-center",children:q.taxRate?`${q.taxRate}%`:""}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 font-semibold text-right",children:h(q.lineTotal,s.currency)})]},D)})})]})})}),e.jsx("div",{className:"px-8 py-6 bg-gray-50 print:bg-white",children:e.jsx("div",{className:"flex justify-end",children:e.jsxs("div",{className:"w-full max-w-sm space-y-3",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-300",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Subtotal:"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:h(V,s.currency)})]}),G>0&&e.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-300",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Discount:"}),e.jsxs("span",{className:"text-sm font-semibold text-red-600",children:["-",h(G,s.currency)]})]}),M>0&&e.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-300",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Tax:"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:h(M,s.currency)})]}),e.jsxs("div",{className:"flex justify-between py-3 border-t-2 border-gray-400",children:[e.jsx("span",{className:"text-lg font-bold text-gray-900",children:"Total:"}),e.jsx("span",{className:"text-lg font-bold",style:{color:p},children:h(s.totalAmount,s.currency)})]}),s.balanceDue>0&&e.jsxs("div",{className:"flex justify-between py-2 bg-red-50 px-4 rounded border border-red-200",children:[e.jsx("span",{className:"text-sm font-bold text-red-700",children:"Balance Due:"}),e.jsx("span",{className:"text-sm font-bold text-red-700",children:h(s.balanceDue,s.currency)})]})]})})}),s.notes&&e.jsxs("div",{className:"px-8 py-4 border-t border-gray-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Notes:"}),e.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:s.notes})]}),s.balanceDue>0&&s.status!=="paid"&&e.jsx("div",{className:"px-8 py-6 bg-blue-50 print:hidden border-t border-blue-200",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-blue-900",children:"Pay This Invoice Online"}),e.jsx("p",{className:"text-blue-700 text-sm",children:"Secure payment processing  Credit cards, bank transfers, and digital wallets accepted"}),e.jsx(rP,{invoiceId:s.id,amount:s.balanceDue,currency:s.currency,customerEmail:(Q=s.customer)==null?void 0:Q.email,customerName:(P=s.customer)==null?void 0:P.name,description:`Payment for Invoice ${s.invoiceNumber}`,onPaymentSuccess:a,onPaymentError:i})]})}),e.jsxs("div",{className:"px-8 py-6 bg-gray-100 print:bg-white border-t border-gray-200",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 text-sm",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Payment Terms"}),e.jsx("p",{className:"text-gray-600",children:t.invoiceTerms||"Payment is due within 30 days of invoice date. Late payments may incur additional fees as per our terms of service."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Questions?"}),e.jsxs("p",{className:"text-gray-600",children:["Contact us at ",t.email||"billing@company.com"," or ",t.phone||"+1 (555) 123-4567","for any questions about this invoice."]})]})]}),t.invoiceFooter&&e.jsx("div",{className:"mt-6 pt-4 border-t border-gray-300 text-center",children:e.jsx("p",{className:"text-sm text-gray-500",children:t.invoiceFooter})}),e.jsxs("div",{className:"mt-4 text-center text-xs text-gray-400",children:["Generated on ",new Date().toLocaleString(),"  Invoice #",s.invoiceNumber]})]})]})},_=()=>{var T,V,M,G,L;return e.jsxs("div",{className:"max-w-5xl mx-auto bg-white shadow-2xl print:shadow-none",style:{fontFamily:v},children:[e.jsxs("div",{className:"premium-header relative overflow-hidden",style:{background:`linear-gradient(135deg, ${p} 0%, ${g} 100%)`,color:"white"},children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`radial-gradient(circle at 25% 25%, white 2px, transparent 2px),
                             radial-gradient(circle at 75% 75%, white 1px, transparent 1px)`,backgroundSize:"40px 40px, 20px 20px"}})}),e.jsx("div",{className:"relative p-10",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center gap-8",children:[t.logoUrl&&t.showLogo&&e.jsx("div",{className:"w-24 h-24 bg-white rounded-2xl p-3 shadow-xl",children:e.jsx("img",{src:t.logoUrl,alt:"Company logo",className:"w-full h-full object-contain"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-5xl font-bold mb-3 tracking-tight",style:{fontFamily:v},children:t.name}),e.jsxs("div",{className:"text-white/90 text-xl space-y-1",children:[t.showWebsite&&t.website&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full"}),e.jsx("span",{className:"font-medium",children:t.website})]}),t.showAddress&&t.address&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full"}),e.jsxs("span",{className:"font-medium",children:[t.address,t.city&&`, ${t.city}`,t.state&&`, ${t.state}`,t.postalCode&&` ${t.postalCode}`]})]})]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"bg-white/15 backdrop-blur-md rounded-2xl p-8 border border-white/20",children:[e.jsx("h2",{className:"text-4xl font-bold mb-3 tracking-wider",style:{fontFamily:v},children:"INVOICE"}),e.jsxs("div",{className:"text-3xl font-bold mb-4",children:["#",s.invoiceNumber]}),e.jsx("div",{className:`inline-block px-6 py-3 rounded-full text-sm font-bold ${s.status==="paid"?"bg-green-100 text-green-800":s.status==="sent"?"bg-blue-100 text-blue-800":s.status==="draft"?"bg-gray-100 text-gray-800":"bg-red-100 text-red-800"}`,children:s.status.toUpperCase()})]})})]})})]}),e.jsxs("div",{className:"p-10",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-16 mb-12",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center shadow-lg",style:{backgroundColor:`${p}20`},children:e.jsx("span",{className:"text-xl font-bold",style:{color:p},children:"B"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900",style:{fontFamily:v},children:"Bill To"})]}),e.jsx("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-2xl p-8 border border-gray-200",children:e.jsxs("div",{className:"text-gray-900",children:[e.jsx("div",{className:"text-2xl font-bold mb-3",children:(T=s.customer)==null?void 0:T.name}),((V=s.customer)==null?void 0:V.email)&&e.jsxs("div",{className:"text-gray-600 mb-2 flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"}),e.jsx("span",{className:"text-lg font-medium",children:s.customer.email})]}),((M=s.customer)==null?void 0:M.address)&&e.jsxs("div",{className:"text-gray-600 flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"}),e.jsx("span",{className:"text-lg font-medium",children:s.customer.address})]})]})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center shadow-lg",style:{backgroundColor:`${g}20`},children:e.jsx("span",{className:"text-xl font-bold",style:{color:g},children:"I"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900",style:{fontFamily:v},children:"Invoice Details"})]}),e.jsx("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-2xl p-8 border border-gray-200",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-gray-300",children:[e.jsx("span",{className:"font-semibold text-gray-600 text-lg",children:"Issue Date:"}),e.jsx("span",{className:"font-bold text-gray-900 text-lg",children:new Date(s.issueDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),s.dueDate&&e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-gray-300",children:[e.jsx("span",{className:"font-semibold text-gray-600 text-lg",children:"Due Date:"}),e.jsx("span",{className:"font-bold text-gray-900 text-lg",children:new Date(s.dueDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("div",{className:"flex justify-between items-center py-3",children:[e.jsx("span",{className:"font-semibold text-gray-600 text-lg",children:"Status:"}),e.jsx("span",{className:"font-bold text-gray-900 text-lg capitalize",children:s.status})]})]})})]})]}),s.lines&&s.lines.length>0&&e.jsx("div",{className:"premium-table mb-12",children:e.jsx("div",{className:"overflow-hidden border-2 border-gray-200 rounded-2xl shadow-lg",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:`linear-gradient(135deg, ${p} 0%, ${g} 100%)`},children:[e.jsx("th",{className:"px-8 py-6 text-left font-bold text-white text-lg uppercase tracking-wider",style:{fontFamily:v},children:"Description"}),e.jsx("th",{className:"px-8 py-6 text-center font-bold text-white text-lg uppercase tracking-wider",style:{fontFamily:v},children:"Qty"}),e.jsx("th",{className:"px-8 py-6 text-right font-bold text-white text-lg uppercase tracking-wider",style:{fontFamily:v},children:"Rate"}),e.jsx("th",{className:"px-8 py-6 text-right font-bold text-white text-lg uppercase tracking-wider",style:{fontFamily:v},children:"Amount"})]})}),e.jsx("tbody",{className:"divide-y-2 divide-gray-200",children:s.lines.map((J,z)=>e.jsxs("tr",{className:z%2===0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"px-8 py-6 text-gray-900 font-semibold text-lg",children:J.description}),e.jsx("td",{className:"px-8 py-6 text-center text-gray-700 text-lg",children:J.quantity}),e.jsx("td",{className:"px-8 py-6 text-right text-gray-700 text-lg",children:h(J.unitPrice,s.currency)}),e.jsx("td",{className:"px-8 py-6 text-right font-bold text-gray-900 text-lg",children:h(J.lineTotal,s.currency)})]},z))})]})})}),e.jsx("div",{className:"premium-totals flex justify-end mb-12",children:e.jsx("div",{className:"w-96",children:e.jsx("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-2xl p-8 border-2 border-gray-200 shadow-lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center py-4 border-b-2 border-gray-300",children:[e.jsx("span",{className:"text-xl font-bold text-gray-700",style:{fontFamily:v},children:"Subtotal"}),e.jsx("span",{className:"text-xl font-bold text-gray-900",children:h(s.totalAmount-(s.balanceDue>0?s.balanceDue:0),s.currency)})]}),s.balanceDue>0&&e.jsxs("div",{className:"flex justify-between items-center py-4 border-b-2 border-gray-300",children:[e.jsx("span",{className:"text-xl font-bold text-gray-700",style:{fontFamily:v},children:"Balance Due"}),e.jsx("span",{className:"text-xl font-bold text-gray-900",children:h(s.balanceDue,s.currency)})]}),e.jsxs("div",{className:"flex justify-between items-center py-6",children:[e.jsx("span",{className:"text-3xl font-bold text-gray-900",style:{fontFamily:v},children:"Total"}),e.jsx("span",{className:"text-4xl font-bold",style:{color:p},children:h(s.totalAmount,s.currency)})]})]})})})}),s.balanceDue>0&&e.jsx("div",{className:"mb-12 p-10 rounded-2xl border-3 border-dashed shadow-lg",style:{borderColor:`${p}40`,backgroundColor:`${p}08`},children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full flex items-center justify-center shadow-lg",style:{backgroundColor:`${p}20`},children:e.jsx("span",{className:"text-3xl",style:{color:p},children:""})}),e.jsx("h3",{className:"text-3xl font-bold mb-4",style:{color:p,fontFamily:v},children:"Pay Online Securely"}),e.jsx("p",{className:"text-gray-600 mb-8 text-xl leading-relaxed",children:"Complete your payment instantly using your credit card, debit card, or bank account."}),e.jsx(rP,{invoiceId:s.id,amount:s.balanceDue,currency:s.currency,customerEmail:(G=s.customer)==null?void 0:G.email,customerName:(L=s.customer)==null?void 0:L.name,description:`Payment for Invoice ${s.invoiceNumber}`,onPaymentSuccess:a,onPaymentError:i})]})}),e.jsxs("div",{className:"premium-footer border-t-4 border-gray-200 pt-10",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-16",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-2xl font-bold text-gray-900 mb-6 flex items-center gap-3",style:{fontFamily:v},children:[e.jsx("span",{className:"w-8 h-8 rounded-xl flex items-center justify-center shadow-lg",style:{backgroundColor:`${p}20`},children:e.jsx("span",{className:"text-sm font-bold",style:{color:p},children:"C"})}),"Contact Information"]}),e.jsxs("div",{className:"space-y-3 text-gray-600",children:[t.email&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"}),e.jsx("span",{className:"text-lg font-semibold",children:t.email})]}),t.phone&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"}),e.jsx("span",{className:"text-lg font-semibold",children:t.phone})]}),t.showWebsite&&t.website&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"}),e.jsx("span",{className:"text-lg font-semibold",children:t.website})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-2xl font-bold text-gray-900 mb-6 flex items-center gap-3",style:{fontFamily:v},children:[e.jsx("span",{className:"w-8 h-8 rounded-xl flex items-center justify-center shadow-lg",style:{backgroundColor:`${g}20`},children:e.jsx("span",{className:"text-sm font-bold",style:{color:g},children:"T"})}),"Payment Terms"]}),e.jsx("div",{className:"text-gray-600 leading-relaxed text-lg",children:t.invoiceTerms||"Payment is due within 30 days of invoice date. Late payments may incur additional fees."})]})]}),t.invoiceFooter&&e.jsx("div",{className:"mt-10 text-center",children:e.jsx("div",{className:"inline-block px-8 py-4 bg-gradient-to-r from-gray-100 to-gray-200 rounded-2xl shadow-lg",children:e.jsx("p",{className:"text-gray-600 font-bold text-lg",style:{fontFamily:v},children:t.invoiceFooter})})})]})]})]})},k=()=>e.jsx(ne,{className:"max-w-4xl mx-auto shadow-lg",children:e.jsxs(ie,{className:"p-0",children:[e.jsx("div",{className:"p-8 border-b-2",style:{borderColor:p},children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[t.logoUrl&&t.showLogo&&e.jsx("img",{src:t.logoUrl,alt:"Company logo",className:"w-12 h-12 object-contain"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",style:{fontFamily:v},children:t.name}),e.jsx("div",{className:"text-sm text-gray-600",children:t.showAddress&&t.address&&e.jsxs("div",{children:[t.address,t.city&&`, ${t.city}`,t.state&&`, ${t.state}`,t.postalCode&&` ${t.postalCode}`]})})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-3xl font-bold",style:{color:p,fontFamily:v},children:"INVOICE"}),e.jsx("div",{className:"text-lg font-semibold mt-1 text-gray-900",children:s.invoiceNumber})]})]})}),e.jsx("div",{className:"p-8",children:e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Classic template content would go here"})})})]})}),F=()=>e.jsx(ne,{className:"max-w-3xl mx-auto shadow-sm",children:e.jsxs(ie,{className:"p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[t.logoUrl&&t.showLogo&&e.jsx("img",{src:t.logoUrl,alt:"Company logo",className:"w-16 h-16 object-contain mx-auto mb-4"}),e.jsx("h1",{className:"text-2xl font-light text-gray-900",style:{fontFamily:v},children:t.name}),e.jsxs("div",{className:"text-sm text-gray-500 mt-2",children:["Invoice ",s.invoiceNumber]})]}),e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Minimal template content would go here"})})]})}),A=()=>{switch(m){case"modern":return _();case"classic":return k();case"minimal":return F();case"professional":default:return S()}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("style",{children:`
        @media print {
          * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
          .print\\:shadow-none { box-shadow: none !important; }
          .print\\:bg-white { background-color: white !important; }
          .print\\:text-black { color: black !important; }
          .print\\:border-b-1 { border-bottom-width: 1px !important; }
          .print\\:max-w-none { max-width: none !important; }
          .print\\:w-20 { width: 5rem !important; }
          .print\\:h-20 { height: 5rem !important; }
          .print\\:h-10 { height: 2.5rem !important; }
          .print\\:space-y-2 > * + * { margin-top: 0.5rem !important; }
          .print\\:hidden { display: none !important; }
          .no-print { display: none !important; }
          
          body { 
            margin: 0; padding: 0; 
            -webkit-print-color-adjust: exact; 
            print-color-adjust: exact; 
          }
          
          .invoice-container { 
            max-width: none !important; 
            margin: 0 !important; 
            padding: 0 !important;
            box-shadow: none !important;
            page-break-inside: avoid;
          }
          
          .invoice-page {
            page-break-inside: avoid;
            page-break-after: auto;
          }
          
          table { page-break-inside: avoid; }
          tr { page-break-inside: avoid; }
          .totals-section { page-break-inside: avoid; }
          .footer-section { page-break-inside: avoid; }
          
          /* Force colors in print */
          .bg-gray-50 { background-color: #f9fafb !important; }
          .bg-blue-50 { background-color: #eff6ff !important; }
          .text-blue-600 { color: #2563eb !important; }
          .border-gray-200 { border-color: #e5e7eb !important; }
        }
        
        @page {
          margin: 0.5in;
          size: A4;
        }
      `}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 p-6 bg-white rounded-lg shadow-sm border no-print",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs(Oe,{variant:"outline",className:"text-blue-600 border-blue-600 px-3 py-1.5 font-medium",children:[m.charAt(0).toUpperCase()+m.slice(1)," Template"]}),e.jsxs("div",{className:`inline-flex items-center px-3 py-1.5 rounded-full border text-sm font-medium ${f(s.status).bg} ${f(s.status).text}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full mr-2 ${f(s.status).dot}`}),s.status.toUpperCase()]}),e.jsx(Oe,{variant:"secondary",className:"px-3 py-1.5",children:h(s.totalAmount,s.currency)})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:j,className:"px-4 py-2",children:[e.jsx(k5,{className:"w-4 h-4 mr-2"}),"Print"]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:b,className:"px-4 py-2",children:[e.jsx(An,{className:"w-4 h-4 mr-2"}),"Download PDF"]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:async()=>{try{const T=s.paymentUrl||window.location.href;await navigator.clipboard.writeText(T),y({title:"Link Copied",description:"Invoice link has been copied to clipboard."})}catch(T){console.error("Error copying link:",T)}},className:"px-4 py-2",children:[e.jsx(ac,{className:"w-4 h-4 mr-2"}),"Copy Link"]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:w,className:"px-4 py-2",children:[e.jsx(T5,{className:"w-4 h-4 mr-2"}),"Share"]})]})]}),e.jsx("div",{className:"invoice-container invoice-page",children:A()})]})}function U$({onInvoiceCreated:s}){const[t,r]=x.useState(""),[n,a]=x.useState(null),[i,o]=x.useState([]),[l,c]=x.useState(!1),[d,u]=x.useState(!1),[h,f]=x.useState(!1),[m,p]=x.useState(""),[g,v]=x.useState(!0),[y,j]=x.useState(null),b=x.useRef(null),w=hi(),{user:N}=Ua(),{data:C}=ys({queryKey:["companies"],queryFn:()=>de.getCompanies(),enabled:!!N}),S=x.useMemo(()=>{if(!C)return[];const L=C;return Array.isArray(L)?L:L&&Array.isArray(L.data)?L.data:L&&Array.isArray(L.companies)?L.companies:[]},[C]);x.useEffect(()=>{try{const L=localStorage.getItem("company_id")||localStorage.getItem("companyId")||localStorage.getItem("company");L&&p(L)}catch{}},[]),x.useEffect(()=>{if(y&&clearTimeout(y),t.length>3&&m){const L=setTimeout(()=>{F()},500);j(L)}return()=>{y&&clearTimeout(y)}},[t,m]);const _=Rs({mutationFn:L=>de.parseInvoiceText({...L,context:{}}),onSuccess:L=>{a(L.parsedData),u(!0),ze.success("Text parsed successfully!")},onError:L=>{ze.error(L.message||"Failed to parse text")}}),k=Rs({mutationFn:L=>de.createInvoiceFromText({...L,validateData:!0}),onSuccess:L=>{L.success&&L.invoice?(ze.success("Invoice created successfully!"),w.invalidateQueries({queryKey:["invoices"]}),s==null||s(L.invoice),r(""),a(null),u(!1)):ze.error(L.message||"Failed to create invoice")},onError:L=>{ze.error(L.message||"Failed to create invoice")}}),F=async()=>{if(m)try{const L=await de.getInvoiceSuggestions(m,t);o(L.suggestions)}catch(L){console.error("Error getting suggestions:",L)}},A=()=>{if(!t.trim()||!m){ze.error("Please enter text and select a company");return}c(!0),_.mutate({text:t.trim(),companyId:m}).finally(()=>{c(!1)})},T=()=>{if(!t.trim()||!m){ze.error("Please enter text and select a company");return}k.mutate({text:t.trim(),companyId:m,autoCreateCustomer:g})},V=L=>{var J;r(L),(J=b.current)==null||J.focus()},M=L=>L>=.8?"bg-green-100 text-green-800":L>=.6?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800",G=L=>L>=.8?"High Confidence":L>=.6?"Medium Confidence":"Low Confidence";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(La,{className:"w-5 h-5"}),"Natural Language Invoice Creation"]})}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"company",children:"Company *"}),e.jsxs(rt,{value:m,onValueChange:L=>{p(L);try{localStorage.setItem("company_id",L)}catch{}},children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select company"})}),e.jsx(at,{children:S==null?void 0:S.map(L=>e.jsx(W,{value:L.id,children:L.name},L.id))})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"autoCreateCustomer",checked:g,onChange:L=>v(L.target.checked),className:"rounded"}),e.jsx(B,{htmlFor:"autoCreateCustomer",className:"text-sm",children:"Auto-create customers if not found"})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"invoiceText",children:"Describe your invoice in natural language *"}),e.jsx(Xs,{ref:b,id:"invoiceText",placeholder:"Example: Create an invoice for Acme Corp for 10 hours of consulting at $150 per hour, due in 30 days",value:t,onChange:L=>r(L.target.value),className:"min-h-[120px] mt-2"}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:[t.length," characters"]}),e.jsxs(I,{onClick:A,disabled:!t.trim()||!m||l,className:"flex items-center gap-2",children:[l?e.jsx(On,{className:"w-4 h-4 animate-spin"}):e.jsx(Np,{className:"w-4 h-4"}),l?"Processing...":"Parse & Preview"]})]})]}),i.length>0&&e.jsxs("div",{children:[e.jsxs(B,{className:"text-sm font-medium flex items-center gap-2",children:[e.jsx(ic,{className:"w-4 h-4"}),"Suggestions"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 mt-2",children:i.map((L,J)=>e.jsx(I,{variant:"outline",size:"sm",onClick:()=>V(L.suggestion),className:"justify-start text-left h-auto p-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:L.suggestion}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[L.context,"  ",Math.round(L.confidence*100),"% confidence"]})]})},J))})]})]})]}),e.jsx(ts,{open:d,onOpenChange:u,children:e.jsxs(ss,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(as,{children:e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(ir,{className:"w-5 h-5"}),"Invoice Preview",n&&e.jsx(Oe,{className:M(n.metadata.confidence),children:G(n.metadata.confidence)})]})}),n&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{className:"text-lg",children:"Customer Information"})}),e.jsx(ie,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Customer Name"}),e.jsx(ge,{value:n.customer.name,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Email"}),e.jsx(ge,{value:n.customer.email||"",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Phone"}),e.jsx(ge,{value:n.customer.phone||"",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Address"}),e.jsx(ge,{value:n.customer.address||"",readOnly:!0})]})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{className:"text-lg",children:"Invoice Items"})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:n.items.map((L,J)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:L.description}),e.jsxs("div",{className:"text-sm text-gray-500",children:[L.quantity,"  $",L.unitPrice.toFixed(2)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-medium",children:["$",L.lineTotal.toFixed(2)]}),L.category&&e.jsx("div",{className:"text-xs text-gray-500",children:L.category})]})]},J))})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{className:"text-lg",children:"Invoice Totals"})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Subtotal:"}),e.jsxs("span",{children:["$",n.amounts.subtotal.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:["Tax (",n.amounts.taxRate,"%):"]}),e.jsxs("span",{children:["$",n.amounts.taxAmount.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between font-bold text-lg border-t pt-2",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:["$",n.amounts.totalAmount.toFixed(2)]})]})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{className:"text-lg",children:"Dates"})}),e.jsx(ie,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Issue Date"}),e.jsx(ge,{value:new Date(n.dates.issueDate).toLocaleDateString(),readOnly:!0})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Due Date"}),e.jsx(ge,{value:new Date(n.dates.dueDate).toLocaleDateString(),readOnly:!0})]})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"text-lg flex items-center gap-2",children:[e.jsx(jp,{className:"w-5 h-5"}),"AI Analysis"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Intent"}),e.jsx(ge,{value:n.rawAnalysis.intent,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Extracted Entities"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:n.metadata.extractedEntities.map((L,J)=>e.jsx(Oe,{variant:"outline",children:L},J))})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Suggested Terms"}),e.jsx(ge,{value:n.metadata.suggestedTerms,readOnly:!0})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Suggested Notes"}),e.jsx(Xs,{value:n.metadata.suggestedNotes,readOnly:!0})]})]})})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(I,{variant:"outline",onClick:()=>u(!1),children:"Cancel"}),e.jsxs(I,{onClick:T,disabled:k.isPending,className:"flex items-center gap-2",children:[k.isPending?e.jsx(On,{className:"w-4 h-4 animate-spin"}):e.jsx(Od,{className:"w-4 h-4"}),k.isPending?"Creating...":"Create Invoice"]})]})]})]})})]})}function Aie({onActionExecuted:s}){var M,G,L,J,z,U;const[t,r]=x.useState([]),[n,a]=x.useState(""),[i,o]=x.useState(null),[l,c]=x.useState(""),[d,u]=x.useState(!1),[h,f]=x.useState(!1),[m,p]=x.useState(!1),g=x.useRef(null),v=hi(),{user:y}=Ua(),{data:j}=ys({queryKey:["companies"],queryFn:()=>de.getCompanies(),enabled:!!y}),{data:b}=ys({queryKey:["financial-insights",l],queryFn:()=>de.getFinancialInsights(l),enabled:!!l}),w=Rs({mutationFn:oe=>de.sendChatMessage(oe),onSuccess:oe=>{var Q,P;if(oe.success){const q={id:`user_${Date.now()}`,role:"user",content:oe.response.message,timestamp:new Date},D={id:`ai_${Date.now()}`,role:"assistant",content:oe.response.message,timestamp:new Date,metadata:{action:(Q=oe.response.action)==null?void 0:Q.type,confidence:(P=oe.response.action)==null?void 0:P.confidence,suggestions:oe.response.suggestions}};r(se=>[...se,q,D]),a(""),oe.response.message&&k(oe.response.message)}},onError:oe=>{ze.error(oe.message||"Failed to send message")}});Rs({mutationFn:oe=>de.executeChatAction(oe),onSuccess:oe=>{var Q;oe.success?(ze.success(oe.message),s==null||s(((Q=oe.result)==null?void 0:Q.type)||"unknown",oe.result),v.invalidateQueries({queryKey:["invoices"]}),v.invalidateQueries({queryKey:["expenses"]}),v.invalidateQueries({queryKey:["customers"]})):ze.error(oe.message)},onError:oe=>{ze.error(oe.message||"Failed to execute action")}});const N=Rs({mutationFn:oe=>de.startChatSession(oe),onSuccess:oe=>{if(oe.success){o(oe.sessionId);const Q={id:`welcome_${Date.now()}`,role:"assistant",content:"Hi! I'm your AI accounting assistant. I can help you with invoices, expenses, customers, reports, and answer any financial questions. What would you like to do today?",timestamp:new Date};r([Q])}},onError:oe=>{ze.error(oe.message||"Failed to start session")}});x.useEffect(()=>{var oe;(oe=g.current)==null||oe.scrollIntoView({behavior:"smooth"})},[t]),x.useEffect(()=>{l&&!i&&N.mutate(l)},[l]);const C=()=>{if(!n.trim()||!l||!i){ze.error("Please select a company and enter a message");return}w.mutate({message:n.trim(),companyId:l,sessionId:i,conversationHistory:t})},S=oe=>{oe.key==="Enter"&&!oe.shiftKey&&(oe.preventDefault(),C())},_=oe=>{a(oe.text)},k=oe=>{if("speechSynthesis"in window){f(!0);const Q=new SpeechSynthesisUtterance(oe);Q.onend=()=>f(!1),Q.onerror=()=>f(!1),speechSynthesis.speak(Q)}},F=()=>{"speechSynthesis"in window&&(speechSynthesis.cancel(),f(!1))},A=()=>{if("webkitSpeechRecognition"in window||"SpeechRecognition"in window){const oe=window.SpeechRecognition||window.webkitSpeechRecognition,Q=new oe;Q.continuous=!1,Q.interimResults=!1,Q.lang="en-US",Q.onstart=()=>u(!0),Q.onend=()=>u(!1),Q.onerror=()=>u(!1),Q.onresult=P=>{const q=P.results[0][0].transcript;a(q)},Q.start()}else ze.error("Speech recognition not supported in this browser")},T=oe=>{switch(oe){case"user":return e.jsx(bo,{className:"w-4 h-4"});case"assistant":return e.jsx(jp,{className:"w-4 h-4"});default:return e.jsx(La,{className:"w-4 h-4"})}},V=oe=>{switch(oe){case"create_invoice":return e.jsx(Zt,{className:"w-4 h-4"});case"create_expense":return e.jsx(Mr,{className:"w-4 h-4"});case"create_customer":return e.jsx(Sa,{className:"w-4 h-4"});case"generate_report":return e.jsx(lr,{className:"w-4 h-4"});case"analyze_data":return e.jsx($s,{className:"w-4 h-4"});default:return e.jsx(Np,{className:"w-4 h-4"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(jp,{className:"w-5 h-5"}),"AI Accounting Assistant"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(B,{htmlFor:"company",children:"Select Company"}),e.jsxs(rt,{value:l,onValueChange:c,children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Choose a company to chat with AI"})}),e.jsx(at,{children:(M=j==null?void 0:j.data)==null?void 0:M.map(oe=>e.jsx(W,{value:oe.id,children:oe.name},oe.id))})]})]}),e.jsxs(I,{variant:"outline",onClick:()=>p(!m),className:"flex items-center gap-2",children:[e.jsx($s,{className:"w-4 h-4"}),m?"Hide":"Show"," Insights"]})]})})]}),m&&b&&e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(ic,{className:"w-5 h-5"}),"Financial Insights"]})}),e.jsxs(ie,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["$",b.insights.financialSummary.totalRevenue.toLocaleString()]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Revenue"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-red-600",children:["$",b.insights.financialSummary.totalExpenses.toLocaleString()]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Expenses"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-2xl font-bold ${b.insights.financialSummary.netIncome>=0?"text-green-600":"text-red-600"}`,children:["$",b.insights.financialSummary.netIncome.toLocaleString()]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Net Income"})]})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium",children:"AI Recommendations"}),e.jsx("div",{className:"space-y-2 mt-2",children:b.insights.recommendations.map((oe,Q)=>e.jsxs("div",{className:"flex items-start gap-2 p-2 bg-blue-50 rounded-lg",children:[e.jsx(ic,{className:"w-4 h-4 text-blue-600 mt-0.5"}),e.jsx("span",{className:"text-sm text-blue-800",children:oe})]},Q))})]})]})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(La,{className:"w-5 h-5"}),"Chat with AI Assistant"]}),e.jsx("div",{className:"flex items-center gap-2",children:h?e.jsx(I,{variant:"outline",size:"sm",onClick:F,children:e.jsx(DY,{className:"w-4 h-4"})}):e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{var oe;return k(((oe=t[t.length-1])==null?void 0:oe.content)||"")},children:e.jsx(TY,{className:"w-4 h-4"})})})]})}),e.jsxs(ie,{children:[e.jsxs("div",{className:"space-y-4 mb-4 max-h-96 overflow-y-auto",children:[t.map(oe=>e.jsxs("div",{className:`flex gap-3 ${oe.role==="user"?"justify-end":"justify-start"}`,children:[oe.role!=="user"&&e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:T(oe.role)}),e.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${oe.role==="user"?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"}`,children:[e.jsx("div",{className:"text-sm",children:oe.content}),e.jsx("div",{className:`text-xs mt-1 ${oe.role==="user"?"text-blue-100":"text-gray-500"}`,children:new Date(oe.timestamp).toLocaleTimeString()})]}),oe.role==="user"&&e.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center",children:T(oe.role)})]},oe.id)),e.jsx("div",{ref:g})]}),t.length>0&&((L=(G=t[t.length-1])==null?void 0:G.metadata)==null?void 0:L.suggestions)&&e.jsxs("div",{className:"mb-4",children:[e.jsx(B,{className:"text-sm font-medium mb-2 block",children:"Quick Actions"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:(U=(z=(J=t[t.length-1])==null?void 0:J.metadata)==null?void 0:z.suggestions)==null?void 0:U.map((oe,Q)=>e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>_(oe),className:"flex items-center gap-2",children:[V(oe.action),oe.text]},Q))})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx(Xs,{value:n,onChange:oe=>a(oe.target.value),onKeyPress:S,placeholder:"Ask me anything about your finances... (e.g., 'Create an invoice for Acme Corp for $500', 'Show me my expenses this month', 'How's my business doing?')",className:"min-h-[60px] resize-none",disabled:w.isPending})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(I,{onClick:C,disabled:!n.trim()||!l||w.isPending,className:"flex items-center gap-2",children:w.isPending?e.jsx(On,{className:"w-4 h-4 animate-spin"}):e.jsx(wd,{className:"w-4 h-4"})}),e.jsx(I,{variant:"outline",size:"sm",onClick:d?void 0:A,disabled:d,className:"flex items-center gap-2",children:d?e.jsx(On,{className:"w-4 h-4 animate-spin"}):e.jsx(yY,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2 text-xs text-gray-500",children:[e.jsxs("div",{children:[w.isPending&&"AI is thinking...",d&&"Listening...",h&&"Speaking..."]}),e.jsx("div",{children:i&&`Session: ${i.slice(-8)}`})]})]})]})]})}function Eie({invoiceId:s,invoiceNumber:t}){const[r,n]=x.useState(null),[a,i]=x.useState(!1),[o,l]=x.useState(null),c=async()=>{i(!0),l(null);try{const[m,p]=await Promise.all([de.getInvoiceAccountingEntries(s),de.getInvoiceInventoryMovements(s)]);n({journalEntries:m,inventoryMovements:p})}catch(m){l(m.message||"Failed to fetch accounting data")}finally{i(!1)}};x.useEffect(()=>{c()},[s]);const d=r&&(r.journalEntries.length>0||r.inventoryMovements.length>0),u=()=>a?e.jsx(Ts,{className:"w-4 h-4 animate-spin"}):o?e.jsx(Ln,{className:"w-4 h-4 text-red-500"}):d?e.jsx(bs,{className:"w-4 h-4 text-green-500"}):e.jsx(Cr,{className:"w-4 h-4 text-yellow-500"}),h=()=>a?"Loading...":o?"Error loading data":d?"Accounting integrated":"No accounting data",f=()=>a?"secondary":o?"destructive":d?"default":"secondary";return e.jsxs(ne,{className:"w-full",children:[e.jsx(we,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Accounting Integration"}),e.jsx(I,{variant:"ghost",size:"sm",onClick:c,disabled:a,className:"h-6 w-6 p-0",children:e.jsx(Ts,{className:`w-3 h-3 ${a?"animate-spin":""}`})})]})}),e.jsx(ie,{className:"pt-0",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[u(),e.jsx(Oe,{variant:f(),children:h()})]}),r&&e.jsxs("div",{className:"space-y-2 text-xs text-muted-foreground",children:[r.journalEntries.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"w-3 h-3 text-green-500"}),e.jsxs("span",{children:[r.journalEntries.length," journal entries created"]})]}),r.inventoryMovements.length>0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"w-3 h-3 text-green-500"}),e.jsxs("span",{children:[r.inventoryMovements.length," inventory movements recorded"]})]})]}),o&&e.jsx("div",{className:"text-xs text-red-500",children:(o==null?void 0:o.message)||(o==null?void 0:o.toString())||"Unknown error"}),!d&&!a&&!o&&e.jsx("div",{className:"text-xs text-muted-foreground",children:"Mark invoice as paid to create accounting entries"})]})})]})}const Iie=[{value:"UTC",label:"UTC (Coordinated Universal Time)"},{value:"EST",label:"EST (Eastern Standard Time)"},{value:"PST",label:"PST (Pacific Standard Time)"},{value:"CET",label:"CET (Central European Time)"},{value:"JST",label:"JST (Japan Standard Time)"},{value:"GMT",label:"GMT (Greenwich Mean Time)"},{value:"IST",label:"IST (India Standard Time)"},{value:"AEST",label:"AEST (Australian Eastern Standard Time)"}],Pie=[{value:0,label:"Sunday"},{value:1,label:"Monday"},{value:2,label:"Tuesday"},{value:3,label:"Wednesday"},{value:4,label:"Thursday"},{value:5,label:"Friday"},{value:6,label:"Saturday"}],_ie=Array.from({length:31},(s,t)=>({value:t+1,label:`${t+1}${kie(t+1)}`}));function kie(s){if(s>=11&&s<=13)return"th";switch(s%10){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}}function P_({formData:s,onChange:t,customers:r,isEditing:n=!1,readOnly:a=!1}){var k,F;const{toast:i}=za(),[o,l]=x.useState("basic"),[c,d]=x.useState(""),[u,h]=x.useState(""),[f,m]=x.useState(""),p=A=>{t({...s,...A})},g=(A,T)=>{const V=Number(A)||0;try{return new Intl.NumberFormat(void 0,{style:"currency",currency:T}).format(V)}catch{return`$${V.toFixed(2)}`}},v=(A=[])=>{const T=A.reduce((G,L)=>G+(Number(L.quantity)||0)*(Number(L.unitPrice)||0),0),V=A.reduce((G,L)=>G+(Number(L.quantity)||0)*(Number(L.unitPrice)||0)*(Number(L.taxRate)||0)/100,0),M=T+V;return{subtotal:T,taxTotal:V,totalAmount:M}},y=A=>/.+@.+\..+/.test(A.trim()),b=(()=>{const{startDate:A,endDate:T,frequency:V,interval:M,dayOfWeek:G,dayOfMonth:L,businessDaysOnly:J}=s;if(!A)return null;const z=new Date;z.setHours(0,0,0,0);let U=new Date(A);if(isNaN(U.getTime()))return null;U.setHours(0,0,0,0);const oe=500,Q=(D,se)=>{let he=new Date(D);for(;se>0;){he.setDate(he.getDate()+1);const be=he.getDay();be!==0&&be!==6&&se--}return he},P=()=>{switch(V){case"daily":J?U=Q(U,Math.max(1,M||1)):U.setDate(U.getDate()+Math.max(1,M||1));break;case"weekly":{const D=Math.max(1,M||1);if(typeof G=="number"){const se=U.getDay(),he=(G+7-se)%7||7;U.setDate(U.getDate()+he+(D-1)*7)}else U.setDate(U.getDate()+D*7);break}case"monthly":{const D=Math.max(1,M||1),se=L||U.getDate();U.setMonth(U.getMonth()+D,Math.min(se,28));const he=new Date(U.getFullYear(),U.getMonth(),se);isNaN(he.getTime())||(U=he);break}case"quarterly":{const D=Math.max(1,M||1)*3,se=L||U.getDate();U.setMonth(U.getMonth()+D,Math.min(se,28));const he=new Date(U.getFullYear(),U.getMonth(),se);isNaN(he.getTime())||(U=he);break}case"yearly":{const D=Math.max(1,M||1),se=L||U.getDate();U.setFullYear(U.getFullYear()+D),U.setDate(Math.min(se,28));const he=new Date(U.getFullYear(),U.getMonth(),se);isNaN(he.getTime())||(U=he);break}default:U.setDate(U.getDate()+1)}};if(U>z){if(T){const D=new Date(T);if(D.setHours(0,0,0,0),U>D)return null}return U}let q=0;for(;U<=z&&q++<oe;)if(P(),T){const D=new Date(T);if(D.setHours(0,0,0,0),U>D)return null}return q>=oe?null:U})();x.useEffect(()=>{const A=v(s.lines||[]);(Math.abs((s.subtotal||0)-A.subtotal)>1e-6||Math.abs((s.taxTotal||0)-A.taxTotal)>1e-6||Math.abs((s.totalAmount||0)-A.totalAmount)>1e-6)&&p({...A})},[s.lines]);const w=(A,T)=>{if(!T.trim())return;if(!y(T)){i({title:"Invalid email",description:"Please enter a valid email address.",variant:"destructive"});return}const V=A==="cc"?s.ccEmails||[]:s.bccEmails||[];if(!V.includes(T.trim())){const M=[...V,T.trim()];p({[A==="cc"?"ccEmails":"bccEmails"]:M})}A==="cc"?d(""):h("")},N=(A,T)=>{const M=(A==="cc"?s.ccEmails||[]:s.bccEmails||[]).filter(G=>G!==T);p({[A==="cc"?"ccEmails":"bccEmails"]:M})},C=A=>{const T=parseInt(A);if(isNaN(T)||T<0)return;const V=s.reminderDays||[];V.includes(T)||p({reminderDays:[...V,T].sort((M,G)=>M-G)}),m("")},S=A=>{const T=s.reminderDays||[];p({reminderDays:T.filter(V=>V!==A)})},_=r.find(A=>A.id===s.customerId);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"sticky top-0 z-20 bg-white border-b p-3 flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Template"}),e.jsx("div",{className:"font-medium",children:s.name||"Untitled recurring invoice"})]}),e.jsx(Jc,{orientation:"vertical",className:"h-6 hidden md:block"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Customer"}),e.jsx("div",{className:"font-medium",children:(_==null?void 0:_.name)||"Select customer"})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total"}),e.jsx("div",{className:"font-semibold",children:g(v(s.lines||[]).totalAmount,s.currency||"USD")})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Next run"}),e.jsx("div",{className:"font-semibold",children:b?b.toLocaleDateString():""})]})]})]}),e.jsxs(an,{value:o,onValueChange:l,className:"w-full",children:[e.jsxs(on,{className:"grid w-full grid-cols-5",children:[e.jsxs(vt,{value:"basic",className:"flex items-center gap-2",children:[e.jsx(Xn,{className:"w-4 h-4"}),"Basic Info"]}),e.jsxs(vt,{value:"schedule",className:"flex items-center gap-2",children:[e.jsx(Cr,{className:"w-4 h-4"}),"Schedule"]}),e.jsxs(vt,{value:"conditions",className:"flex items-center gap-2",children:[e.jsx(kn,{className:"w-4 h-4"}),"Conditions"]}),e.jsxs(vt,{value:"email",className:"flex items-center gap-2",children:[e.jsx(Dd,{className:"w-4 h-4"}),"Email"]}),e.jsxs(vt,{value:"lines",className:"flex items-center gap-2",children:[e.jsx(en,{className:"w-4 h-4"}),"Line Items"]})]}),e.jsx(yt,{value:"basic",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Basic Information"})}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Template Name *"}),e.jsx(ge,{disabled:a,className:"border",value:s.name,onChange:A=>p({name:A.target.value}),placeholder:"Monthly Subscription"})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Customer *"}),e.jsxs(rt,{value:s.customerId,onValueChange:A=>p({customerId:A}),children:[e.jsx(nt,{className:"border",disabled:a,children:e.jsx(it,{placeholder:"Select customer"})}),e.jsx(at,{children:r.map(A=>e.jsx(W,{value:A.id,children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{children:A.name}),A.outstandingBalance&&A.outstandingBalance>0&&e.jsxs(Oe,{variant:"outline",className:"ml-2",children:["$",A.outstandingBalance.toFixed(2)," outstanding"]})]})},A.id))})]})]})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Description"}),e.jsx(Xs,{disabled:a,className:"border",value:s.description||"",onChange:A=>p({description:A.target.value}),placeholder:"Recurring invoice description",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Currency"}),e.jsxs(rt,{value:s.currency,onValueChange:A=>p({currency:A}),children:[e.jsx(nt,{className:"border",disabled:a,children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"USD",children:"USD"}),e.jsx(W,{value:"EUR",children:"EUR"}),e.jsx(W,{value:"GBP",children:"GBP"}),e.jsx(W,{value:"CAD",children:"CAD"}),e.jsx(W,{value:"AUD",children:"AUD"})]})]})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Due Date Offset (Days)"}),e.jsx(ge,{disabled:a,className:"border font-mono text-right",type:"number",min:"0",value:s.dueDateOffset,onChange:A=>p({dueDateOffset:parseInt(A.target.value)||0})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ka,{id:"autoSend",disabled:a,checked:s.autoSend,onCheckedChange:A=>p({autoSend:!!A})}),e.jsx(B,{htmlFor:"autoSend",children:"Auto-send invoices"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Notes"}),e.jsx(Xs,{disabled:a,className:"border",value:s.notes||"",onChange:A=>p({notes:A.target.value}),placeholder:"Optional notes",rows:3})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Terms"}),e.jsx(Xs,{disabled:a,className:"border",value:s.terms||"",onChange:A=>p({terms:A.target.value}),placeholder:"Payment terms",rows:3})]})]})]})]})}),e.jsx(yt,{value:"schedule",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Advanced Scheduling"})}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Frequency *"}),e.jsxs(rt,{value:s.frequency,onValueChange:A=>p({frequency:A}),children:[e.jsx(nt,{className:"border",disabled:a,children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"daily",children:"Daily"}),e.jsx(W,{value:"weekly",children:"Weekly"}),e.jsx(W,{value:"monthly",children:"Monthly"}),e.jsx(W,{value:"quarterly",children:"Quarterly"}),e.jsx(W,{value:"yearly",children:"Yearly"})]})]})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Interval"}),e.jsx(ge,{disabled:a,className:"border font-mono text-right",type:"number",min:"1",value:s.interval,onChange:A=>p({interval:parseInt(A.target.value)||1})})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Timezone"}),e.jsxs(rt,{value:s.timezone,onValueChange:A=>p({timezone:A}),children:[e.jsx(nt,{className:"border",disabled:a,children:e.jsx(it,{})}),e.jsx(at,{children:Iie.map(A=>e.jsx(W,{value:A.value,children:A.label},A.value))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Start Date *"}),e.jsx(ge,{disabled:a,className:"border",type:"date",value:s.startDate,onChange:A=>p({startDate:A.target.value})})]}),e.jsxs("div",{children:[e.jsx(B,{children:"End Date (Optional)"}),e.jsx(ge,{disabled:a,className:"border",type:"date",value:s.endDate||"",onChange:A=>p({endDate:A.target.value||void 0})})]})]}),s.frequency==="weekly"&&e.jsxs("div",{children:[e.jsx(B,{children:"Day of Week"}),e.jsxs(rt,{value:(k=s.dayOfWeek)==null?void 0:k.toString(),onValueChange:A=>p({dayOfWeek:parseInt(A)}),children:[e.jsx(nt,{className:"border",disabled:a,children:e.jsx(it,{placeholder:"Select day of week"})}),e.jsx(at,{children:Pie.map(A=>e.jsx(W,{value:A.value.toString(),children:A.label},A.value))})]})]}),(s.frequency==="monthly"||s.frequency==="quarterly"||s.frequency==="yearly")&&e.jsxs("div",{children:[e.jsx(B,{children:"Day of Month"}),e.jsxs(rt,{value:(F=s.dayOfMonth)==null?void 0:F.toString(),onValueChange:A=>p({dayOfMonth:parseInt(A)}),children:[e.jsx(nt,{className:"border",disabled:a,children:e.jsx(it,{placeholder:"Select day of month"})}),e.jsx(at,{children:_ie.map(A=>e.jsx(W,{value:A.value.toString(),children:A.label},A.value))})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ka,{id:"businessDaysOnly",disabled:a,checked:s.businessDaysOnly,onCheckedChange:A=>p({businessDaysOnly:!!A})}),e.jsx(B,{htmlFor:"businessDaysOnly",children:"Business days only (Monday-Friday)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ka,{id:"skipHolidays",disabled:a,checked:s.skipHolidays,onCheckedChange:A=>p({skipHolidays:!!A})}),e.jsx(B,{htmlFor:"skipHolidays",children:"Skip holidays"})]})]})]})]})}),e.jsx(yt,{value:"conditions",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Conditional Logic"})}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ka,{id:"skipIfOutstandingBalance",disabled:a,checked:s.skipIfOutstandingBalance,onCheckedChange:A=>p({skipIfOutstandingBalance:!!A})}),e.jsx(B,{htmlFor:"skipIfOutstandingBalance",children:"Skip if customer has outstanding balance"})]}),s.skipIfOutstandingBalance&&e.jsxs("div",{className:"ml-6",children:[e.jsx(B,{children:"Maximum Outstanding Amount"}),e.jsx(ge,{disabled:a,className:"border font-mono text-right",type:"number",min:"0",step:"0.01",value:s.maxOutstandingAmount||"",onChange:A=>p({maxOutstandingAmount:parseFloat(A.target.value)||void 0}),placeholder:"0.00"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Skip generation if outstanding balance exceeds this amount"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ka,{id:"skipIfCustomerInactive",disabled:a,checked:s.skipIfCustomerInactive,onCheckedChange:A=>p({skipIfCustomerInactive:!!A})}),e.jsx(B,{htmlFor:"skipIfCustomerInactive",children:"Skip if customer is inactive"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ka,{id:"requireApproval",disabled:a,checked:s.requireApproval,onCheckedChange:A=>p({requireApproval:!!A})}),e.jsx(B,{htmlFor:"requireApproval",children:"Require approval before generation"})]}),s.requireApproval&&e.jsxs("div",{className:"ml-6",children:[e.jsx(B,{children:"Approval Workflow ID"}),e.jsx(ge,{disabled:a,className:"border",value:s.approvalWorkflowId||"",onChange:A=>p({approvalWorkflowId:A.target.value}),placeholder:"workflow-id"})]})]}),_&&e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Zl,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"font-medium text-blue-900",children:"Customer Information"})]}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",_.status||"Unknown"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Outstanding Balance:"})," $",(_.outstandingBalance||0).toFixed(2)]})]})]})]})]})}),e.jsx(yt,{value:"email",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Email Settings"})}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Email Template"}),e.jsx(Xs,{disabled:a,className:"border",value:s.emailTemplate||"",onChange:A=>p({emailTemplate:A.target.value}),placeholder:"Custom email template (HTML supported)",rows:4}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Tip: Use variables like ","{","{","customer.name","}","}",", ","{","{","invoice.total","}","}",", ","{","{","due_date","}","}","."]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{children:"CC Emails"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ge,{disabled:a,className:"border",value:c,onChange:A=>d(A.target.value),placeholder:"email@example.com",onKeyPress:A=>{A.key==="Enter"&&(A.preventDefault(),w("cc",c))}}),e.jsx(I,{type:"button",disabled:a,onClick:()=>w("cc",c),children:"Add"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:(s.ccEmails||[]).map(A=>e.jsxs(Oe,{variant:"secondary",className:"flex items-center gap-1",children:[A,e.jsx("button",{disabled:a,type:"button",onClick:()=>N("cc",A),className:"ml-1 hover:text-red-600",children:""})]},A))})]})]}),e.jsxs("div",{children:[e.jsx(B,{children:"BCC Emails"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ge,{disabled:a,className:"border",value:u,onChange:A=>h(A.target.value),placeholder:"email@example.com",onKeyPress:A=>{A.key==="Enter"&&(A.preventDefault(),w("bcc",u))}}),e.jsx(I,{type:"button",disabled:a,onClick:()=>w("bcc",u),children:"Add"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:(s.bccEmails||[]).map(A=>e.jsxs(Oe,{variant:"secondary",className:"flex items-center gap-1",children:[A,e.jsx("button",{disabled:a,type:"button",onClick:()=>N("bcc",A),className:"ml-1 hover:text-red-600",children:""})]},A))})]})]})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Reminder Days"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ge,{disabled:a,className:"border font-mono text-right",type:"number",min:"0",value:f,onChange:A=>m(A.target.value),placeholder:"Days before due date",onKeyPress:A=>{A.key==="Enter"&&(A.preventDefault(),C(f))}}),e.jsx(I,{type:"button",disabled:a,onClick:()=>C(f),children:"Add"})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:(s.reminderDays||[]).map(A=>e.jsxs(Oe,{variant:"secondary",className:"flex items-center gap-1",children:[A," days",e.jsx("button",{disabled:a,type:"button",onClick:()=>S(A),className:"ml-1 hover:text-red-600",children:""})]},A))}),e.jsx("p",{className:"text-sm text-gray-500",children:"Send reminder emails this many days before the due date"})]})]})]})]})}),e.jsx(yt,{value:"lines",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Line Items"})}),e.jsxs(ie,{className:"space-y-4",children:[(s.lines||[]).length>0&&e.jsxs("div",{className:"grid grid-cols-12 gap-2 px-3 text-xs text-muted-foreground",children:[e.jsx("div",{className:"col-span-5",children:"Description"}),e.jsx("div",{className:"col-span-2 text-right",children:"Quantity"}),e.jsx("div",{className:"col-span-2 text-right",children:"Unit Price"}),e.jsx("div",{className:"col-span-2 text-right",children:"Tax %"}),e.jsx("div",{className:"col-span-1"})]}),(s.lines||[]).map((A,T)=>e.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end p-3 border rounded-lg",children:[e.jsxs("div",{className:"col-span-5",children:[e.jsx(B,{children:"Description"}),e.jsx(ge,{disabled:a,className:"border",value:A.description,onChange:V=>{const M=[...s.lines||[]];M[T].description=V.target.value;const G=v(M);p({lines:M,...G})},placeholder:"Item description"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(B,{children:"Quantity"}),e.jsx(ge,{disabled:a,className:"border font-mono text-right",type:"number",min:"0",step:"0.01",value:A.quantity,onChange:V=>{const M=[...s.lines||[]];M[T].quantity=parseFloat(V.target.value)||0;const G=v(M);p({lines:M,...G})}})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(B,{children:"Unit Price"}),e.jsx(ge,{disabled:a,className:"border font-mono text-right",type:"number",min:"0",step:"0.01",value:A.unitPrice,onChange:V=>{const M=[...s.lines||[]];M[T].unitPrice=parseFloat(V.target.value)||0;const G=v(M);p({lines:M,...G})}})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(B,{children:"Tax Rate (%)"}),e.jsx(ge,{disabled:a,className:"border font-mono text-right",type:"number",min:"0",max:"100",step:"0.01",value:A.taxRate,onChange:V=>{const M=[...s.lines||[]];M[T].taxRate=parseFloat(V.target.value)||0;const G=v(M);p({lines:M,...G})}})]}),e.jsx("div",{className:"col-span-1",children:e.jsx(I,{type:"button",variant:"outline",size:"sm",disabled:a,onClick:()=>{const V=(s.lines||[]).filter((G,L)=>L!==T),M=v(V);p({lines:V,...M})},children:""})})]},T)),e.jsx(I,{type:"button",variant:"outline",disabled:a,onClick:()=>{const A=[...s.lines||[],{description:"",quantity:1,unitPrice:0,taxRate:0}],T=v(A);p({lines:A,...T})},children:"Add Line Item"}),e.jsxs("div",{className:"space-y-2 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Subtotal:"}),e.jsx("span",{children:g(s.subtotal||0,s.currency||"USD")})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Tax:"}),e.jsx("span",{children:g(s.taxTotal||0,s.currency||"USD")})]}),e.jsxs("div",{className:"flex justify-between font-semibold border-t pt-2",children:[e.jsx("span",{children:"Total:"}),e.jsx("span",{children:g(s.totalAmount||0,s.currency||"USD")})]})]})]})]})})]})]})}var Tie={ALLUSERSPROFILE:"C:\\ProgramData",APPDATA:"C:\\Users\\NZAYISENGA\\AppData\\Roaming",ChocolateyInstall:"C:\\ProgramData\\chocolatey",CHROME_CRASHPAD_PIPE_NAME:"\\\\.\\pipe\\crashpad_6760_MNFZPENREMITOLIX",COLOR:"1",COLORTERM:"truecolor",CommonProgramFiles:"C:\\Program Files\\Common Files","CommonProgramFiles(x86)":"C:\\Program Files (x86)\\Common Files",CommonProgramW6432:"C:\\Program Files\\Common Files",COMPUTERNAME:"KEEN-PC",ComSpec:"C:\\Windows\\system32\\cmd.exe",CURL_CA_BUNDLE:"C:\\Program Files\\PostgreSQL\\17\\ssl\\certs\\ca-bundle.crt",CURSOR_TRACE_ID:"ae1c7a4c670b466da2e7a8bd088ffd60",DriverData:"C:\\Windows\\System32\\Drivers\\DriverData",EDITOR:"C:\\Windows\\notepad.exe",EFC_1492:"1",FPS_BROWSER_APP_PROFILE_STRING:"Internet Explorer",FPS_BROWSER_USER_PROFILE_STRING:"Default",GDAL_DATA:"C:\\Program Files\\PostgreSQL\\17\\gdal-data",GIT_ASKPASS:"c:\\Program Files\\cursor\\resources\\app\\extensions\\git\\dist\\askpass.sh",HOME:"C:\\Users\\NZAYISENGA",HOMEDRIVE:"C:",HOMEPATH:"\\Users\\NZAYISENGA",INIT_CWD:"D:\\my project\\urutiq\\urutiIQ-V2\\urutiq\\apps\\frontend_vite",LANG:"en_US.UTF-8",LOCALAPPDATA:"C:\\Users\\NZAYISENGA\\AppData\\Local",LOGONSERVER:"\\\\KEEN-PC",NODE:"C:\\Program Files\\nodejs\\node.exe",NODE_ENV:"production",NODE_EXE:"C:\\Program Files\\nodejs\\\\node.exe",NPM_CLI_JS:"C:\\Program Files\\nodejs\\\\node_modules\\npm\\bin\\npm-cli.js",npm_command:"run-script",npm_config_cache:"C:\\Users\\NZAYISENGA\\AppData\\Local\\npm-cache",npm_config_globalconfig:"C:\\Users\\NZAYISENGA\\AppData\\Roaming\\npm\\etc\\npmrc",npm_config_global_prefix:"C:\\Users\\NZAYISENGA\\AppData\\Roaming\\npm",npm_config_init_module:"C:\\Users\\NZAYISENGA\\.npm-init.js",npm_config_local_prefix:"D:\\my project\\urutiq\\urutiIQ-V2\\urutiq",npm_config_node_gyp:"C:\\Program Files\\nodejs\\node_modules\\npm\\node_modules\\node-gyp\\bin\\node-gyp.js",npm_config_noproxy:"",npm_config_npm_version:"10.8.2",npm_config_prefix:"C:\\Users\\NZAYISENGA\\AppData\\Roaming\\npm",npm_config_userconfig:"C:\\Users\\NZAYISENGA\\.npmrc",npm_config_user_agent:"npm/10.8.2 node/v20.19.3 win32 x64 workspaces/true",npm_execpath:"C:\\Program Files\\nodejs\\node_modules\\npm\\bin\\npm-cli.js",npm_lifecycle_event:"build",npm_lifecycle_script:"vite build || echo 'Frontend build completed with warnings'",npm_node_execpath:"C:\\Program Files\\nodejs\\node.exe",npm_package_json:"D:\\my project\\urutiq\\urutiIQ-V2\\urutiq\\apps\\frontend_vite\\package.json",npm_package_name:"@urutiq/frontend-vite",npm_package_version:"0.1.0",NPM_PREFIX_JS:"C:\\Program Files\\nodejs\\\\node_modules\\npm\\bin\\npm-prefix.js",NPM_PREFIX_NPM_CLI_JS:"C:\\Users\\NZAYISENGA\\AppData\\Roaming\\npm\\node_modules\\npm\\bin\\npm-cli.js",NUMBER_OF_PROCESSORS:"12",OneDrive:"C:\\Users\\NZAYISENGA\\OneDrive",OneDriveConsumer:"C:\\Users\\NZAYISENGA\\OneDrive",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",OS:"Windows_NT",PATH:"D:\\my project\\urutiq\\urutiIQ-V2\\urutiq\\apps\\frontend_vite\\node_modules\\.bin;D:\\my project\\urutiq\\urutiIQ-V2\\urutiq\\apps\\node_modules\\.bin;D:\\my project\\urutiq\\urutiIQ-V2\\urutiq\\node_modules\\.bin;D:\\my project\\urutiq\\urutiIQ-V2\\node_modules\\.bin;D:\\my project\\urutiq\\node_modules\\.bin;D:\\my project\\node_modules\\.bin;D:\\node_modules\\.bin;C:\\Program Files\\nodejs\\node_modules\\npm\\node_modules\\@npmcli\\run-script\\lib\\node-gyp-bin;C:\\src\\flutter\\bin;C:\\Users\\NZAYISENGA\\AppData\\Local\\Programs\\Microsoft VS Code\\bin;C:\\Program Files\\nodejs;C:\\Program Files\\nodejs\\;C:\\Program Files\\cursor\\resources\\app\\bin;C:\\Program Files\\Void\\bin;C:\\Program Files (x86)\\Bitvise SSH Client;C:\\Users\\NZAYISENGA\\AppData\\Local\\Programs\\Python\\Python310\\Scripts\\;C:\\Users\\NZAYISENGA\\AppData\\Local\\Programs\\Python\\Python310\\;C:\\Program Files\\nodejs;C:\\flutter\\bin;C:\\Users\\NZAYISENGA\\AppData\\Local\\Android\\Sdk;C:\\Users\\NZAYISENGA\\AppData\\Local\\Android\\Sdk\\platform-tools;C:\\Program Files\\Git\\bin;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;C:\\Windows\\System32;C:\\Program Files\\PostgreSQL\\15\\bin;C:\\Users\\NZAYISENGA\\AppData\\Roaming\\npm;C:\\Users\\NZAYISENGA\\AppData\\Local\\Programs\\Ollama;C:\\Users\\NZAYISENGA\\AppData\\Local\\Programs\\Microsoft VS Code\\bin;C:\\Users\\NZAYISENGA\\AppData\\Local\\Programs\\Windsurf\\bin;C:\\Windows\\System32\\OpenSSH\\;",PATHEXT:".COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC",POSTGIS_ENABLE_OUTDB_RASTERS:"1",POSTGIS_GDAL_ENABLED_DRIVERS:"GTiff PNG JPEG GIF XYZ DTED USGSDEM AAIGrid",PROCESSOR_ARCHITECTURE:"AMD64",PROCESSOR_IDENTIFIER:"Intel64 Family 6 Model 154 Stepping 4, GenuineIntel",PROCESSOR_LEVEL:"6",PROCESSOR_REVISION:"9a04",ProgramData:"C:\\ProgramData",ProgramFiles:"C:\\Program Files","ProgramFiles(x86)":"C:\\Program Files (x86)",ProgramW6432:"C:\\Program Files",PROJ_LIB:"C:\\Program Files\\PostgreSQL\\17\\share\\contrib\\postgis-3.5\\proj",PROMPT:"$P$G",PSModulePath:"C:\\Program Files\\WindowsPowerShell\\Modules;C:\\Windows\\system32\\WindowsPowerShell\\v1.0\\Modules",PUBLIC:"C:\\Users\\Public",SESSIONNAME:"Console",SystemDrive:"C:",SystemRoot:"C:\\Windows",TEMP:"C:\\Users\\NZAYIS~1\\AppData\\Local\\Temp",TERM_PROGRAM:"vscode",TERM_PROGRAM_VERSION:"1.7.17",TMP:"C:\\Users\\NZAYIS~1\\AppData\\Local\\Temp",USERDOMAIN:"KEEN-PC",USERDOMAIN_ROAMINGPROFILE:"KEEN-PC",USERNAME:"NZAYISENGA",USERPROFILE:"C:\\Users\\NZAYISENGA",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"",VSCODE_GIT_ASKPASS_MAIN:"c:\\Program Files\\cursor\\resources\\app\\extensions\\git\\dist\\askpass-main.js",VSCODE_GIT_ASKPASS_NODE:"C:\\Program Files\\cursor\\Cursor.exe",VSCODE_GIT_IPC_HANDLE:"\\\\.\\pipe\\vscode-git-00d115b6e8-sock",windir:"C:\\Windows",ZES_ENABLE_SYSMAN:"1"};const U2=s=>{const t=new Date;t.setHours(0,0,0,0);const r=new Date(s);return r.setHours(0,0,0,0),r<t},dj=s=>{if(!s)return"";try{const t=new Date(s);return isNaN(t.getTime())?"":t.toISOString().slice(0,10)}catch{return""}};function Die(){var Ge,ht,wt,Qt,vs,Js,je,Ot,Ds,ar,cn,Va,Wn,ri,Wa,vi,pl,Bl,_r,Ha,io;const{isAuthenticated:s,isLoading:t}=Ua(),{ready:r}=gu("sales-page"),{toast:n}=za(),[a,i]=x.useState(!0),[o,l]=x.useState(null),[c,d]=x.useState(!1),[u,h]=x.useState(zs());x.useEffect(()=>{const ae=()=>{const Bt=zs();Bt&&Bt!==u&&(console.log(" Sales page - Company changed from",u,"to",Bt),h(Bt))};window.addEventListener("storage",ae);const Ke=Bt=>{const Yt=Bt.detail.companyId;Yt&&Yt!==u&&(console.log(" Sales page - Company changed via custom event from",u,"to",Yt),h(Yt))};return window.addEventListener("companyChanged",Ke),()=>{window.removeEventListener("storage",ae),window.removeEventListener("companyChanged",Ke)}},[u]);const[f,m]=x.useState([]),[p,g]=x.useState([]),[v,y]=x.useState([]),[j,b]=x.useState([]),w=ae=>{const Ke=Array.isArray(ae)?ae:[];g(Ke)},[N,C]=x.useState(!1),S=async(ae,Ke="download")=>{var Bt,Yt,Fs,zr,Ms,bn,tl,wi,Rc,Ul,Mn,Cn;try{const Bn=p.find(vl=>vl.id===ae.customerId),gl=new Pp({invoice:{id:ae.id,invoiceNumber:ae.invoiceNumber,issueDate:ae.issueDate,dueDate:ae.dueDate,status:ae.status,totalAmount:ae.totalAmount,balanceDue:ae.balanceDue,currency:(Bn==null?void 0:Bn.currency)||"USD",subtotal:ae.subtotal||ae.totalAmount,taxAmount:ae.taxAmount||0,discountAmount:ae.discountAmount||0,customer:Bn?{name:Bn.name,email:Bn.email,address:Bn.address,phone:Bn.phone,taxId:Bn.taxId}:void 0,lines:ae.lines||[],notes:ae.notes,paymentUrl:ae.paymentUrl},company:{name:((Bt=rn())==null?void 0:Bt.name)||"Your Company",logoUrl:(Yt=rn())==null?void 0:Yt.logoUrl,primaryColor:((Fs=rn())==null?void 0:Fs.primaryColor)||"#009688",secondaryColor:((zr=rn())==null?void 0:zr.secondaryColor)||"#1565c0",address:(Ms=rn())==null?void 0:Ms.address,city:(bn=rn())==null?void 0:bn.city,state:(tl=rn())==null?void 0:tl.state,postalCode:(wi=rn())==null?void 0:wi.postalCode,email:(Rc=rn())==null?void 0:Rc.email,phone:(Ul=rn())==null?void 0:Ul.phone,website:(Mn=rn())==null?void 0:Mn.website,fontFamily:((Cn=rn())==null?void 0:Cn.fontFamily)||"Inter"}});if(Ke==="download")await gl.download(),n({title:"PDF Downloaded",description:`Invoice ${ae.invoiceNumber} has been downloaded successfully.`});else{const vl=await gl.generate(),Vo=URL.createObjectURL(vl);window.open(Vo,"_blank"),setTimeout(()=>URL.revokeObjectURL(Vo),3e4)}}catch(Bn){console.error("Error generating PDF:",Bn),n({title:"PDF Generation Failed",description:"There was an error generating the PDF. Please try again.",variant:"destructive"});try{const gl=await de.getInvoicePdf(ae.id),vl=URL.createObjectURL(gl);if(Ke==="download"){const Vo=document.createElement("a");Vo.href=vl,Vo.download=`invoice-${ae.invoiceNumber}.pdf`,document.body.appendChild(Vo),Vo.click(),document.body.removeChild(Vo)}else window.open(vl,"_blank");setTimeout(()=>URL.revokeObjectURL(vl),3e4)}catch(gl){console.error("Backend PDF generation also failed:",gl)}}},[_,k]=x.useState(null),[F,A]=x.useState({name:"",email:"",currency:"USD"}),[T,V]=x.useState(!1),[M,G]=x.useState(null),[L,J]=x.useState(""),[z,U]=x.useState(""),[oe,Q]=x.useState(1),[P,q]=x.useState(10),[D,se]=x.useState(1),[he,be]=x.useState(1e3),[pe,Ae]=x.useState(""),[Ee,$e]=x.useState(1),[O,te]=x.useState(10),[re,le]=x.useState(1),[Z,K]=x.useState(10),[X,ce]=x.useState(""),[Y,ue]=x.useState(""),[ve,Le]=x.useState(null),[Me,tt]=x.useState(!1),[fe,ct]=x.useState([]),[dt,pt]=x.useState(!1),[qe,mt]=x.useState(!1),[Rt,_e]=x.useState(!1),[Xe,At]=x.useState(null),[st,$t]=x.useState({customerId:"",invoiceNumber:"",currency:"USD",issueDate:new Date().toISOString().slice(0,10),dueDate:"",discountMode:"amount",discount:0,shipping:0,taxMode:"per_line",globalTaxRate:0,lines:[{description:"",quantity:1,unitPrice:0,taxRate:0,productId:""}],subtotal:0,taxTotal:0,totalAmount:0,notes:"",terms:"Payment due within 30 days",paymentTerms:"Net 30"}),[fs,zt]=x.useState(!1),[St,js]=x.useState(!1),[et,lt]=x.useState(null),[Fe,ft]=x.useState({customerId:"",estimateNumber:"",issueDate:new Date().toISOString().slice(0,10),expiryDate:"",currency:"USD",notes:"",terms:"",lines:[{description:"",quantity:1,unitPrice:0,taxRate:0}]}),[He,Je]=x.useState(!1),[It,Gt]=x.useState(!1),[qt,As]=x.useState(null),[Ht,xs]=x.useState(!1),[Ct,ke]=x.useState({customerId:"",estimateNumber:"",issueDate:new Date().toISOString().slice(0,10),expiryDate:"",currency:"USD",notes:"",terms:"",lines:[{description:"",quantity:1,unitPrice:0,taxRate:0}]}),gt=(ae,Ke=st.discount,Bt=st.shipping,Yt=st.taxMode,Fs=st.globalTaxRate,zr=st.discountMode)=>{const Ms=ae.reduce((Cn,Bn)=>{const gl=Bn.quantity*Bn.unitPrice,vl=Math.max(0,Math.min(gl,Bn.lineDiscount||0));return Cn+(gl-vl)},0),bn=zr==="percent"?Math.max(0,Math.min(100,Ke))*Ms/100:Math.max(0,Math.min(Ke,Ms)),tl=Math.max(0,Ms-bn),wi=Yt==="per_line"?ae.reduce((Cn,Bn)=>Cn+Bn.quantity*Bn.unitPrice*(Bn.taxRate||0)/100,0):tl*(Fs||0)/100,Rc=tl,Ul=wi,Mn=Rc+Ul+(Bt||0);return{subtotal:Rc,taxTotal:Ul,totalAmount:Mn}},us=ae=>{const Ke=ae.reduce((Fs,zr)=>Fs+zr.quantity*zr.unitPrice,0),Bt=ae.reduce((Fs,zr)=>Fs+zr.quantity*zr.unitPrice*(zr.taxRate||0)/100,0),Yt=Ke+Bt;return{subtotal:Ke,taxTotal:Bt,totalAmount:Yt}},[We,Et]=x.useState([]),[Pt,rs]=x.useState(!0),[ms,Bs]=x.useState("USD"),[Vs,Ws]=x.useState(1),[Ns,er]=x.useState(!1),[Ir,jn]=x.useState(!1),[Hs,qr]=x.useState(null),[qn,In]=x.useState(null),[Yr,$r]=x.useState(!1),[Vr,wn]=x.useState(null),[Vn,De]=x.useState(!1),[ut,Pe]=x.useState(null),[_t,bt]=x.useState({customerId:"",name:"",description:"",frequency:"monthly",interval:1,startDate:new Date().toISOString().slice(0,10),endDate:"",currency:"USD",notes:"",terms:"",dueDateOffset:30,autoSend:!1,emailTemplate:"",dayOfWeek:void 0,dayOfMonth:void 0,businessDaysOnly:!1,skipHolidays:!1,timezone:"UTC",skipIfOutstandingBalance:!1,maxOutstandingAmount:void 0,skipIfCustomerInactive:!1,requireApproval:!1,approvalWorkflowId:void 0,ccEmails:[],bccEmails:[],reminderDays:[],lines:[{description:"",quantity:1,unitPrice:0,taxRate:0}],subtotal:0,taxTotal:0,totalAmount:0}),[ps,Pr]=x.useState(null),[Wr,Zs]=x.useState(!1),[wr,xa]=x.useState("draft"),[cr,Zn]=x.useState(""),[Hi,Gi]=x.useState(!1),[Ti,Ea]=x.useState([]),[Ki,mi]=x.useState(!1),[Da,fi]=x.useState(null),[qa,Ne]=x.useState(""),[Dt,ye]=x.useState(!1),[Be,Ft]=x.useState(!1),[Kt,Jt]=x.useState("Customer return"),[kt,gs]=x.useState(null),fn={customerId:"",name:"",description:"",frequency:"monthly",interval:1,startDate:new Date().toISOString().slice(0,10),endDate:"",currency:"USD",notes:"",terms:"",dueDateOffset:30,autoSend:!1,emailTemplate:"",dayOfWeek:void 0,dayOfMonth:void 0,businessDaysOnly:!1,skipHolidays:!1,timezone:"UTC",skipIfOutstandingBalance:!1,maxOutstandingAmount:void 0,skipIfCustomerInactive:!1,requireApproval:!1,approvalWorkflowId:void 0,ccEmails:[],bccEmails:[],reminderDays:[],lines:[{description:"",quantity:1,unitPrice:0,taxRate:0}],subtotal:0,taxTotal:0,totalAmount:0},xi=(ae,Ke)=>ae.map(Bt=>({...Bt,unitPrice:(Bt.unitPrice||0)*(Ke||1),lineDiscount:(Bt.lineDiscount||0)*(Ke||1)})),$n=(ae,Ke)=>{const Bt=Number(ae)||0;try{return new Intl.NumberFormat(void 0,{style:"currency",currency:Ke}).format(Bt)}catch{try{return`$${Bt.toFixed(2)}`}catch{return`$${Bt}`}}},Ur=hi(),Yi=ae=>{const Ke=!!(ae.name&&ae.name.trim()&&ae.customerId&&ae.startDate&&ae.frequency),Bt=Array.isArray(ae.lines)&&ae.lines.length>0,Yt=Bt&&ae.lines.every(Fs=>{const zr=Number(Fs.quantity),Ms=Number(Fs.unitPrice),bn=Number(Fs.taxRate);return!Number.isNaN(zr)&&zr>=0&&!Number.isNaN(Ms)&&Ms>=0&&!Number.isNaN(bn)&&bn>=0&&bn<=100});return Ke&&Bt&&Yt},Ji=ys({queryKey:["companies"],queryFn:()=>de.getCompanies(),enabled:(s||r)&&!t,staleTime:5*60*1e3}),rn=()=>{const ae=Ji.data;return Array.isArray(ae)?ae.find(Ke=>Ke.id===u):null};x.useEffect(()=>{if(typeof window<"u"){const ae=localStorage.getItem("company_id");ae&&h(ae)}},[]),x.useEffect(()=>{typeof window<"u"&&u&&localStorage.setItem("company_id",u)},[u]);const Ll=Rs({mutationFn:ae=>de.createRecurringInvoice({...ae,companyId:u}),onSuccess:()=>{Ur.invalidateQueries({queryKey:["recurring-invoices"]}),$r(!1),bt({...fn,startDate:new Date().toISOString().slice(0,10)}),wn(null)}}),zo=Rs({mutationFn:({id:ae,data:Ke})=>de.updateRecurringInvoice(ae,Ke),onSuccess:()=>{Ur.invalidateQueries({queryKey:["recurring-invoices"]}),$r(!1),bt({...fn,startDate:new Date().toISOString().slice(0,10)}),wn(null)}}),Qo=Rs({mutationFn:({id:ae,status:Ke})=>de.updateRecurringInvoiceStatus(ae,Ke),onSuccess:()=>{Ur.invalidateQueries({queryKey:["recurring-invoices"]}),n({title:"Success",description:"Recurring invoice status updated"})},onError:ae=>{n({title:"Error",description:(ae==null?void 0:ae.message)||"Failed to update status",variant:"destructive"})}}),Xi=Rs({mutationFn:ae=>de.generateInvoiceFromRecurring(ae),onSuccess:()=>{Ur.invalidateQueries({queryKey:["recurring-invoices"]}),Ur.invalidateQueries({queryKey:["invoices"]}),n({title:"Success",description:"Invoice generated successfully"})},onError:ae=>{n({title:"Error",description:(ae==null?void 0:ae.message)||"Failed to generate invoice",variant:"destructive"})}}),_o=async ae=>{pt(!0);try{const Ke=await de.getRecurringInvoiceHistory(ae);ct(Ke.invoices)}catch{n({title:"Error",description:"Failed to load invoice history",variant:"destructive"})}finally{pt(!1)}},qo=ae=>{var Ke;wn(ae),bt({customerId:ae.customerId,name:ae.name,description:ae.description||"",frequency:ae.frequency,interval:ae.interval,startDate:(ae.startDate||"").slice(0,10),endDate:ae.endDate?ae.endDate.slice(0,10):"",currency:ae.currency,notes:ae.notes||"",terms:ae.terms||"",dueDateOffset:ae.dueDateOffset,autoSend:ae.autoSend,emailTemplate:ae.emailTemplate||"",dayOfWeek:void 0,dayOfMonth:void 0,businessDaysOnly:!1,skipHolidays:!1,timezone:"UTC",skipIfOutstandingBalance:!1,maxOutstandingAmount:void 0,skipIfCustomerInactive:!1,requireApproval:!1,approvalWorkflowId:void 0,ccEmails:[],bccEmails:[],reminderDays:[],lines:((Ke=ae.lines)==null?void 0:Ke.map(Bt=>({description:Bt.description||"",quantity:Number(Bt.quantity),unitPrice:Number(Bt.unitPrice),taxRate:Number(Bt.taxRate)})))||[{description:"",quantity:1,unitPrice:0,taxRate:0}],subtotal:Number(ae.totalAmount),taxTotal:0,totalAmount:Number(ae.totalAmount)}),$r(!0)},$l=ae=>{Le(ae),tt(!0),_o(ae.id)},Zo=ae=>{Xi.mutate(ae.id)},el=(ae,Ke)=>{Qo.mutate({id:ae.id,status:Ke})},ot=ys({queryKey:["invoices",oe,P,u],enabled:s&&!t&&!!u,queryFn:async()=>{const Ke=await de.getInvoices({page:oe,pageSize:P,companyId:u}),Bt=(Ke==null?void 0:Ke.items)??(Ke==null?void 0:Ke.invoices)??(Ke==null?void 0:Ke.data)??Ke;return Array.isArray(Bt)?Bt:[]}}),qs=ys({queryKey:["customers",D,he,z,u],enabled:s&&!t&&!!u,queryFn:async()=>await de.getCustomers({page:D,pageSize:he,companyId:u,q:z||void 0})}),Sn=ys({queryKey:["customers-all",u],enabled:s&&!t&&!!u,staleTime:5*60*1e3,queryFn:async()=>{var zr;const Ke=await de.getCustomers({page:1,pageSize:100,companyId:u}),Bt=(Ke==null?void 0:Ke.total)??(((zr=Ke==null?void 0:Ke.items)==null?void 0:zr.length)||0);let Yt=Array.isArray(Ke==null?void 0:Ke.items)?Ke.items:[];const Fs=(Ke==null?void 0:Ke.totalPages)||Math.ceil(Bt/100)||1;if(Fs>1){const Ms=await Promise.all(Array.from({length:Fs-1},(bn,tl)=>de.getCustomers({page:tl+2,pageSize:100,companyId:u})));for(const bn of Ms)Array.isArray(bn==null?void 0:bn.items)&&(Yt=Yt.concat(bn.items))}return{items:Yt,total:Bt}}}),hr=x.useMemo(()=>{var Ke;const ae=((Ke=Sn.data)==null?void 0:Ke.items)??Sn.data??p;return Array.isArray(ae)?ae:[]},[Sn.data,p]),Fn=ys({queryKey:["estimates",Ee,O,pe,u],enabled:s&&!t&&!!u,queryFn:async()=>{const Ke=await de.getEstimates({page:Ee,pageSize:O,companyId:u,q:pe||void 0}),Bt=(Ke==null?void 0:Ke.items)??(Ke==null?void 0:Ke.estimates)??(Ke==null?void 0:Ke.data)??Ke;return Array.isArray(Bt)?Bt:[]}}),Rr=ys({queryKey:["recurring-invoices",re,Z,X,Y,u],enabled:s&&!t&&!!u,queryFn:async()=>await de.getRecurringInvoices({page:re,pageSize:Z,companyId:u,q:X||void 0,status:Y||void 0})}),$=ys({queryKey:["products",u],enabled:s&&!t&&!!u,queryFn:async()=>{const ae=await de.getProducts({companyId:u}),Ke=(ae==null?void 0:ae.items)??(ae==null?void 0:ae.products)??(ae==null?void 0:ae.data)??ae;return Array.isArray(Ke)?Ke:[]}});x.useEffect(()=>{var ae,Ke,Bt,Yt,Fs,zr;if(ot.data&&m(ot.data),qs.data){const Ms=((ae=qs.data)==null?void 0:ae.items)||qs.data;w(Array.isArray(Ms)?Ms:[])}if(Fn.data&&y(Fn.data),Rr.data){const Ms=Rr.data,bn=(Ms==null?void 0:Ms.items)??[];b(bn)}$.data&&Et($.data),i(ot.isLoading||qs.isLoading||Fn.isLoading||Rr.isLoading||$.isLoading),l(((Ke=ot.error)==null?void 0:Ke.message)||((Bt=qs.error)==null?void 0:Bt.message)||((Yt=Fn.error)==null?void 0:Yt.message)||((Fs=Rr.error)==null?void 0:Fs.message)||((zr=$.error)==null?void 0:zr.message)||null)},[ot.data,qs.data,Fn.data,Rr.data,$.data,ot.isLoading,qs.isLoading,Fn.isLoading,Rr.isLoading,$.isLoading,ot.error,qs.error,Fn.error,Rr.error,$.error]),x.useEffect(()=>{d(!0)},[]);const Xt=x.useMemo(()=>{if(!L)return f;const ae=L.toLowerCase();return f.filter(Ke=>Ke.invoiceNumber.toLowerCase().includes(ae)||Ke.status.toLowerCase().includes(ae))},[f,L]),ds=x.useMemo(()=>Array.isArray(p)?p:[],[p]),Us=x.useMemo(()=>Array.isArray(v)?v:[],[v]),H=x.useMemo(()=>{const ae=Rr==null?void 0:Rr.data,Ke=ae==null?void 0:ae.items;return Array.isArray(Ke)&&Ke.length>0?Ke:Array.isArray(j)?j:[]},[Rr==null?void 0:Rr.data,j]),Ce=x.useMemo(()=>{const ae=Array.isArray(f)?f:[],Ke=new Date,Bt=Ke.getMonth(),Yt=Ke.getFullYear(),Fs=ae.map(Mn=>({...Mn,balanceDue:Mn.status==="paid"?0:Number(Mn.balanceDue)||0,totalAmount:Number(Mn.totalAmount)||0,status:String(Mn.status||"").toLowerCase()})),zr=Fs.reduce((Mn,Cn)=>Mn+Cn.totalAmount,0),Ms=Fs.filter(Mn=>Mn.status!=="paid"&&Mn.status!=="cancelled").reduce((Mn,Cn)=>Mn+Cn.balanceDue,0),bn=Fs.filter(Mn=>{if(Mn.status!=="paid")return!1;const Cn=new Date(Mn.issueDate);return Cn.getMonth()===Bt&&Cn.getFullYear()===Yt}).reduce((Mn,Cn)=>Mn+Cn.totalAmount,0),tl=Fs.filter(Mn=>{if(Mn.status==="paid"||Mn.status==="cancelled"||!Mn.dueDate)return!1;const Cn=new Date(Mn.dueDate),Bn=U2(Cn);return Bn&&Mn.balanceDue>0||Mn.status==="draft"&&Bn}).reduce((Mn,Cn)=>Mn+Cn.balanceDue,0),wi=zr>0?Ms/zr*100:0,Rc=zr>0?bn/zr*100:0,Ul=zr>0?tl/zr*100:0;return{outstanding:Ms,paidThisMonth:bn,overdue:tl,outstandingPercentage:wi,paidThisMonthPercentage:Rc,overduePercentage:Ul}},[f]);return c?t?e.jsx(Kr,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading..."})]})})}):!s&&!r?e.jsx(Kr,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"Please log in to access sales features."})})})}):e.jsx(Kr,{children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-50 to-blue-50 border border-slate-200 rounded-2xl p-8 mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx(Zt,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-slate-900 tracking-tight",children:"Sales & Invoicing"}),e.jsx("p",{className:"text-slate-600 text-lg font-medium",children:"Manage customers, invoices, and sales transactions"})]})]}),e.jsxs("div",{className:"flex items-center gap-6 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{children:"Live Dashboard"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{children:"Real-time Updates"})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(I,{variant:"outline",className:"h-11 px-6 border-slate-300 hover:bg-slate-50 hover:border-slate-400 transition-all duration-200",children:[e.jsx(An,{className:"w-4 h-4 mr-2"}),"Export Data"]}),e.jsxs(I,{className:"h-11 px-6 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 shadow-lg hover:shadow-xl transition-all duration-200",onClick:async()=>{var Fs,zr;let ae="";try{const Ms=await de.getNextInvoiceNumber(u);ae=(Ms==null?void 0:Ms.invoiceNumber)||""}catch{}const Ke=[{description:"",quantity:1,unitPrice:0,taxRate:0}],Bt=hr,Yt=((Fs=Bt[0])==null?void 0:Fs.currency)||"USD";Bs(Yt),$t({customerId:((zr=Bt[0])==null?void 0:zr.id)||"",invoiceNumber:ae,currency:Yt,issueDate:new Date().toISOString().slice(0,10),dueDate:"",discountMode:"amount",discount:0,shipping:0,taxMode:"per_line",globalTaxRate:0,lines:Ke,notes:"",terms:"Payment due within 30 days",paymentTerms:"Net 30",...gt(Ke,0,0,"per_line",0,"amount")}),mt(!0)},children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"New Invoice"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[e.jsxs(ne,{className:"bg-card border-border",children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium text-muted-foreground",children:"Outstanding"}),e.jsx("span",{className:"text-chart-1 font-bold text-lg",children:"$"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:a?"":`${Ce.outstandingPercentage.toFixed(0)}%`}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Pending payments"})]})]}),e.jsxs(ne,{className:"bg-card border-border",children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium text-muted-foreground",children:"Paid This Month"}),e.jsx("span",{className:"text-chart-2 font-bold text-lg",children:""})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:a?"":`${Ce.paidThisMonthPercentage.toFixed(0)}%`}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Successful payments"})]})]}),e.jsxs(ne,{className:"bg-card border-border",children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium text-muted-foreground",children:"Overdue"}),e.jsx("span",{className:"text-chart-3 font-bold text-lg",children:"!"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:a?"":$n(Ce.overdue,"RWF")}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["(",Ce.overduePercentage.toFixed(0),"% of total)"]})]})]}),e.jsxs(ne,{className:"bg-card border-border",children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium text-muted-foreground",children:"Total Customers"}),e.jsx(Sa,{className:"w-4 h-4 text-chart-4"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:a?"":(Array.isArray(p)?p:[]).length}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Active customers"})]})]})]}),"the",e.jsx("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm p-2 mb-8",children:e.jsxs(an,{defaultValue:"invoices",className:"space-y-6",children:[e.jsxs(on,{className:"grid w-full grid-cols-7 bg-slate-50 p-1 rounded-xl h-14",children:[e.jsxs(vt,{value:"invoices",className:"flex items-center gap-2 px-4 py-3 data-[state=active]:bg-white data-[state=active]:shadow-sm data-[state=active]:text-blue-600 font-medium transition-all duration-200 rounded-lg",children:[e.jsx(Zt,{className:"w-4 h-4"}),e.jsx("span",{children:"Invoices"}),e.jsx(Oe,{variant:"secondary",className:"ml-1 bg-blue-100 text-blue-700 text-xs px-2 py-0.5",children:f.length})]}),e.jsxs(vt,{value:"customers",className:"flex items-center gap-2 px-4 py-3 data-[state=active]:bg-white data-[state=active]:shadow-sm data-[state=active]:text-blue-600 font-medium transition-all duration-200 rounded-lg",children:[e.jsx(Sa,{className:"w-4 h-4"}),e.jsx("span",{children:"Customers"}),e.jsx(Oe,{variant:"secondary",className:"ml-1 bg-green-100 text-green-700 text-xs px-2 py-0.5",children:p.length})]}),e.jsxs(vt,{value:"estimates",className:"flex items-center gap-2 px-4 py-3 data-[state=active]:bg-white data-[state=active]:shadow-sm data-[state=active]:text-blue-600 font-medium transition-all duration-200 rounded-lg",children:[e.jsx(yn,{className:"w-4 h-4"}),e.jsx("span",{children:"Estimates"}),e.jsx(Oe,{variant:"secondary",className:"ml-1 bg-purple-100 text-purple-700 text-xs px-2 py-0.5",children:v.length})]}),e.jsxs(vt,{value:"recurring",className:"flex items-center gap-2 px-4 py-3 data-[state=active]:bg-white data-[state=active]:shadow-sm data-[state=active]:text-blue-600 font-medium transition-all duration-200 rounded-lg",children:[e.jsx(Ts,{className:"w-4 h-4"}),e.jsx("span",{children:"Recurring"}),e.jsx(Oe,{variant:"secondary",className:"ml-1 bg-amber-100 text-amber-700 text-xs px-2 py-0.5",children:j.length})]}),e.jsxs(vt,{value:"approvals",className:"flex items-center gap-2 px-4 py-3 data-[state=active]:bg-white data-[state=active]:shadow-sm data-[state=active]:text-blue-600 font-medium transition-all duration-200 rounded-lg",children:[e.jsx(bs,{className:"w-4 h-4"}),e.jsx("span",{children:"Approvals"})]}),e.jsxs(vt,{value:"ai-create",className:"flex items-center gap-2 px-4 py-3 data-[state=active]:bg-white data-[state=active]:shadow-sm data-[state=active]:text-blue-600 font-medium transition-all duration-200 rounded-lg",children:[e.jsx(La,{className:"w-4 h-4"}),e.jsx("span",{children:"AI Create"})]}),e.jsxs(vt,{value:"ai-chat",className:"flex items-center gap-2 px-4 py-3 data-[state=active]:bg-white data-[state=active]:shadow-sm data-[state=active]:text-blue-600 font-medium transition-all duration-200 rounded-lg",children:[e.jsx(jp,{className:"w-4 h-4"}),e.jsx("span",{children:"AI Chat"})]})]}),e.jsxs(yt,{value:"invoices",className:"space-y-4",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{children:"Recent Invoices"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Rn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(ge,{placeholder:"Search invoices...",className:"pl-10 w-64",value:L,onChange:ae=>J(ae.target.value)})]}),e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(Ic,{className:"w-4 h-4 mr-2"}),"Filter"]})]})]})}),e.jsxs(ie,{children:[o&&e.jsx("div",{className:"text-red-600 text-sm mb-2",children:(o==null?void 0:o.message)||(o==null?void 0:o.toString())||"Unknown error"}),e.jsxs("div",{className:"space-y-4",children:[(ot==null?void 0:ot.isLoading)&&e.jsx(e.Fragment,{children:[0,1,2,3,4].map(ae=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsx("div",{className:"h-4 w-32 bg-muted rounded"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-4 w-24 bg-muted rounded"}),e.jsx("div",{className:"h-6 w-20 bg-muted rounded"})]})]},ae))}),!(ot!=null&&ot.isLoading)&&Xt.map(ae=>{var Ke,Bt,Yt,Fs,zr;return e.jsxs("div",{className:"group bg-white border border-slate-200 rounded-2xl hover:shadow-xl hover:border-blue-300 transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center shadow-lg group-hover:shadow-xl transition-all duration-300",children:e.jsx("span",{className:"text-white font-bold text-xl",children:"#"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"font-bold text-slate-900 text-xl",children:ae.invoiceNumber}),e.jsx("p",{className:"text-slate-600 font-medium",children:(()=>{if(qs!=null&&qs.isLoading)return"";const Ms=(Array.isArray(p)?p:[]).find(bn=>bn.id===ae.customerId);return Ms?Ms.name:ae.customerId})()}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Issued: ",new Date(ae.issueDate).toLocaleDateString()]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(Oe,{variant:ae.status==="paid"?"default":ae.status==="pending"||ae.status==="sent"?"secondary":ae.status==="overdue"?"destructive":"outline",className:`text-xs px-3 py-1 rounded-full font-medium ${ae.status==="paid"?"bg-green-100 text-green-700 border-green-200":ae.status==="overdue"?"bg-red-100 text-red-700 border-red-200":ae.status==="pending"||ae.status==="sent"?"bg-blue-100 text-blue-700 border-blue-200":"bg-slate-100 text-slate-700 border-slate-200"}`,children:ae.status.charAt(0).toUpperCase()+ae.status.slice(1)}),ae.dueDate&&e.jsxs("span",{className:"text-xs text-slate-500 bg-slate-50 px-2 py-1 rounded-full",children:["Due: ",new Date(ae.dueDate).toLocaleDateString()]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-right space-y-1",children:[e.jsx("p",{className:"font-bold text-slate-900 text-2xl",children:$n(ae.totalAmount,qs!=null&&qs.isLoading?"USD":((Ke=(Array.isArray(p)?p:[]).find(Ms=>Ms.id===ae.customerId))==null?void 0:Ke.currency)||"USD")}),e.jsxs("p",{className:"text-sm text-slate-600",children:["Balance: ",$n(ae.balanceDue,qs!=null&&qs.isLoading?"USD":((Bt=(Array.isArray(p)?p:[]).find(Ms=>Ms.id===ae.customerId))==null?void 0:Bt.currency)||"USD")]}),ae.balanceDue>0&&e.jsxs("p",{className:"text-xs text-amber-600 font-medium",children:[(ae.balanceDue/ae.totalAmount*100).toFixed(0),"% remaining"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[(()=>{const Ms=ae.dueDate&&U2(new Date(ae.dueDate));return Ms&&ae.balanceDue>0||ae.status==="draft"&&Ms?e.jsx(Oe,{variant:"destructive",className:"text-xs",children:"Overdue"}):null})(),ae.status==="draft"&&e.jsx(I,{variant:"outline",size:"sm",className:"hover:bg-blue-50 hover:border-blue-200",onClick:async()=>{try{await de.updateInvoice(ae.id,{status:"sent"}),await Ur.invalidateQueries({queryKey:["invoices"]})}catch{}},children:"Mark Sent"}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{gs(ae.id),Ft(!0)},children:"Credit Note"}),(ae.status==="sent"||ae.status==="pending")&&e.jsxs(e.Fragment,{children:[e.jsx(I,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:async()=>{try{try{const Ms=await de.processInvoicePayment(ae.id);console.log("Accounting entries created:",Ms),await de.updateInvoice(ae.id,{status:"paid",balanceDue:0}),n({title:"Invoice marked as paid",description:`Accounting entries created and inventory updated successfully. Journal Entry: ${Ms.journalEntryId}`,variant:"default"}),await Ur.invalidateQueries({queryKey:["invoices"]}),await Ur.invalidateQueries({queryKey:["journal-entries"]}),await Ur.invalidateQueries({queryKey:["inventory-movements"]})}catch(Ms){console.error("Accounting integration error:",Ms),Ms.message&&Ms.message.includes("Insufficient inventory")?n({title:"Insufficient Inventory",description:Ms.message,variant:"destructive"}):n({title:"Error",description:"Failed to process invoice payment. Please check inventory and try again.",variant:"destructive"})}}catch(Ms){console.error("Error marking invoice as paid:",Ms),n({title:"Error",description:"Failed to mark invoice as paid",variant:"destructive"})}},children:"Mark Paid"}),ae.balanceDue>0&&e.jsx(v7,{invoiceId:ae.id,amount:ae.balanceDue,currency:qs!=null&&qs.isLoading?"USD":((Yt=(Array.isArray(p)?p:[]).find(Ms=>Ms.id===ae.customerId))==null?void 0:Yt.currency)||"USD",customerEmail:(Fs=(Array.isArray(p)?p:[]).find(Ms=>Ms.id===ae.customerId))==null?void 0:Fs.email,customerName:(zr=(Array.isArray(p)?p:[]).find(Ms=>Ms.id===ae.customerId))==null?void 0:zr.name,description:`Payment for Invoice ${ae.invoiceNumber}`,onPaymentSuccess:async()=>{try{const Ms=await de.processInvoicePayment(ae.id);console.log("Accounting entries created:",Ms),n({title:"Payment successful",description:`Payment processed and accounting entries created. Journal Entry: ${Ms.journalEntryId}`,variant:"default"}),await Ur.invalidateQueries({queryKey:["invoices"]}),await Ur.invalidateQueries({queryKey:["journal-entries"]}),await Ur.invalidateQueries({queryKey:["inventory-movements"]})}catch(Ms){console.error("Accounting integration error:",Ms),Ms.message&&Ms.message.includes("Insufficient inventory")?n({title:"Insufficient Inventory",description:Ms.message,variant:"destructive"}):n({title:"Payment successful",description:"Payment processed but accounting integration failed. Please check the accounting entries manually.",variant:"destructive"}),await Ur.invalidateQueries({queryKey:["invoices"]}),await Ur.invalidateQueries({queryKey:["journal-entries"]}),await Ur.invalidateQueries({queryKey:["inventory-movements"]})}},onPaymentError:Ms=>{console.error("Payment error:",Ms)}})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 hover:bg-blue-50 hover:text-blue-600 transition-colors duration-200",onClick:async()=>{try{qr(ae),jn(!0),Zs(!0),In(null),Pr(null),xa(ae.status),Zn((ae.dueDate||"").slice(0,10));try{const Ms=await de.getInvoicePdf(ae.id),bn=URL.createObjectURL(Ms);In(bn)}catch{}try{const Ms=await de.createPaymentLink(ae.id);Pr(Ms.url)}catch{}try{const Ms=await de.getInvoiceActivity(ae.id);Ea(Ms.map(bn=>({id:bn.id,type:bn.activityType,at:bn.createdAt,by:bn.performedBy,message:bn.description})))}catch{Ea([])}}finally{Zs(!1)}},children:e.jsx(ir,{className:"w-4 h-4"})}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 hover:bg-green-50 hover:text-green-600 transition-colors duration-200",children:e.jsx(ln,{className:"w-4 h-4"})}),e.jsx(I,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 hover:bg-purple-50 hover:text-purple-600 transition-colors duration-200",onClick:()=>{fi(ae.id);const Ms=(Array.isArray(p)?p:[]).find(bn=>bn.id===ae.customerId);Ne((Ms==null?void 0:Ms.email)||""),mi(!0)},children:e.jsx(wd,{className:"w-4 h-4"})})]})]})]})}),(()=>{const Ms=ae.dueDate&&U2(new Date(ae.dueDate));return Ms&&ae.balanceDue>0||ae.status==="draft"&&Ms?e.jsx("div",{className:"h-1 bg-gradient-to-r from-red-500 to-red-600"}):null})()]},ae.id)}),Xt.length===0&&!a&&e.jsx("div",{className:"text-sm text-muted-foreground",children:"No invoices found"})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Page ",oe]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{variant:"outline",size:"sm",disabled:oe<=1||a,onClick:()=>Q(ae=>Math.max(1,ae-1)),children:"Prev"}),e.jsx(I,{variant:"outline",size:"sm",disabled:a||f.length<P,onClick:()=>Q(ae=>ae+1),children:"Next"})]})]})]})]}),e.jsx(ts,{open:qe,onOpenChange:mt,children:e.jsxs(ss,{className:"!max-w-7xl max-h-[95vh] overflow-y-auto w-[95vw] md:max-h-[90vh] md:w-[90vw]",children:[e.jsxs(as,{className:"pb-6 border-b border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center",children:e.jsx(Zt,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx(is,{className:"text-2xl font-bold text-slate-900",children:"Create New Invoice"}),e.jsx(Ks,{className:"text-slate-600 mt-1",children:"Fill in the details below to create a professional invoice"})]})]}),Xe&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:Xe})]}),e.jsx("div",{className:"flex-1 overflow-y-auto max-h-[calc(95vh-200px)] md:max-h-[calc(90vh-200px)] scrollbar-thin scrollbar-thumb-slate-300 scrollbar-track-slate-100 hover:scrollbar-thumb-slate-400",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 py-6",children:[e.jsxs("div",{className:"md:col-span-1 lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-slate-50 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(Sa,{className:"w-5 h-5 text-blue-600"}),"Customer Information"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"inv-customer",className:"text-sm font-medium text-slate-700",children:"Select Customer *"}),e.jsxs(rt,{value:st.customerId,onValueChange:async ae=>{const Ke=hr.find(Yt=>Yt.id===ae);let Bt=st.currency;if(Ke!=null&&Ke.currency&&Pt&&!Ns&&(Bt=Ke.currency),$t(Yt=>({...Yt,customerId:ae,currency:Bt})),Ke!=null&&Ke.currency&&Pt&&!Ns&&ms!==Ke.currency)try{const{rate:Yt}=await de.getExchangeRate(ms,Ke.currency),Fs=xi(st.lines,Yt);$t(zr=>({...zr,lines:Fs,...gt(Fs),currency:Ke.currency||"USD"})),Bs(Ke.currency),Ws(Yt)}catch{}},children:[e.jsx(nt,{className:"h-12 bg-white border-slate-300",children:e.jsx(it,{placeholder:"Choose a customer..."})}),e.jsx(at,{children:hr.map(ae=>e.jsx(W,{value:ae.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:ae.name}),ae.currency&&e.jsxs("span",{className:"text-xs text-slate-500",children:["(",ae.currency,")"]})]})},ae.id))})]})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(Zt,{className:"w-5 h-5 text-blue-600"}),"Invoice Details"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"inv-number",className:"text-sm font-medium text-slate-700",children:"Invoice Number *"}),e.jsx(ge,{id:"inv-number",value:st.invoiceNumber,onChange:ae=>$t({...st,invoiceNumber:ae.target.value}),placeholder:"INV-001",className:"h-12 bg-white border-slate-300"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"inv-currency",className:"text-sm font-medium text-slate-700",children:"Currency"}),e.jsxs(rt,{value:st.currency,onValueChange:async ae=>{if(Pt&&!Ns&&ms!==ae)try{const{rate:Ke}=await de.getExchangeRate(ms,ae),Bt=xi(st.lines,Ke);$t(Yt=>({...Yt,currency:ae,lines:Bt,...gt(Bt)})),Bs(ae),Ws(Ke)}catch{$t(Ke=>({...Ke,currency:ae}))}else $t(Ke=>({...Ke,currency:ae}))},children:[e.jsx(nt,{className:"h-12 bg-white border-slate-300",children:e.jsx(it,{})}),e.jsx(at,{children:["USD","EUR","GBP","KES","NGN"].map(ae=>e.jsx(W,{value:ae,children:ae},ae))})]})]})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(Xn,{className:"w-5 h-5 text-blue-600"}),"Dates"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"inv-issue",className:"text-sm font-medium text-slate-700",children:"Issue Date *"}),e.jsx(ge,{id:"inv-issue",type:"date",value:st.issueDate,onChange:ae=>$t({...st,issueDate:ae.target.value}),className:"h-12 bg-white border-slate-300"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"inv-due",className:"text-sm font-medium text-slate-700",children:"Due Date"}),e.jsx(ge,{id:"inv-due",type:"date",value:st.dueDate||"",onChange:ae=>$t({...st,dueDate:ae.target.value}),className:"h-12 bg-white border-slate-300"})]})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(yn,{className:"w-5 h-5 text-blue-600"}),"Pricing & Tax"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"inv-shipping",className:"text-sm font-medium text-slate-700",children:"Shipping Cost"}),e.jsx(ge,{id:"inv-shipping",type:"number",step:"0.01",value:st.shipping,onChange:ae=>{const Ke=parseFloat(ae.target.value)||0;$t(Bt=>({...Bt,shipping:Ke,...gt(Bt.lines,Bt.discount,Ke)}))},className:"h-12 bg-white border-slate-300",placeholder:"0.00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Discount Mode"}),e.jsxs(rt,{value:st.discountMode,onValueChange:ae=>{$t(Ke=>({...Ke,discountMode:ae,...gt(Ke.lines,Ke.discount,Ke.shipping,Ke.taxMode,Ke.globalTaxRate,ae)}))},children:[e.jsx(nt,{className:"h-12 bg-white border-slate-300",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"amount",children:"Amount"}),e.jsx(W,{value:"percent",children:"Percentage"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(B,{htmlFor:"inv-discount",className:"text-sm font-medium text-slate-700",children:["Discount ",st.discountMode==="percent"?"(%)":""]}),e.jsx(ge,{id:"inv-discount",type:"number",step:"0.01",value:st.discount,onChange:ae=>{const Ke=parseFloat(ae.target.value)||0;$t(Bt=>({...Bt,discount:Ke,...gt(Bt.lines,Ke)}))},className:"h-12 bg-white border-slate-300",placeholder:"0.00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Tax Mode"}),e.jsxs(rt,{value:st.taxMode,onValueChange:ae=>{$t(Ke=>({...Ke,taxMode:ae,...gt(Ke.lines,Ke.discount,Ke.shipping,ae,Ke.globalTaxRate)}))},children:[e.jsx(nt,{className:"h-12 bg-white border-slate-300",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"per_line",children:"Per Line Item"}),e.jsx(W,{value:"global",children:"Global Rate"})]})]})]}),st.taxMode==="global"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"inv-tax",className:"text-sm font-medium text-slate-700",children:"Global Tax Rate (%)"}),e.jsx(ge,{id:"inv-tax",type:"number",step:"0.01",value:st.globalTaxRate,onChange:ae=>{const Ke=parseFloat(ae.target.value)||0;$t(Bt=>({...Bt,globalTaxRate:Ke,...gt(Bt.lines,Bt.discount,Bt.shipping,Bt.taxMode,Ke)}))},className:"h-12 bg-white border-slate-300",placeholder:"0.00"})]})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(La,{className:"w-5 h-5 text-blue-600"}),"Notes & Terms"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"inv-notes",className:"text-sm font-medium text-slate-700",children:"Notes"}),e.jsx(Xs,{id:"inv-notes",value:st.notes||"",onChange:ae=>$t(Ke=>({...Ke,notes:ae.target.value})),placeholder:"Internal notes or additional information...",className:"bg-white border-slate-300 min-h-[80px]"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"inv-terms",className:"text-sm font-medium text-slate-700",children:"Payment Terms"}),e.jsx(Xs,{id:"inv-terms",value:st.terms||"",onChange:ae=>$t(Ke=>({...Ke,terms:ae.target.value})),placeholder:"Terms and conditions for payment...",className:"bg-white border-slate-300 min-h-[80px]"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"inv-payment-terms",className:"text-sm font-medium text-slate-700",children:"Payment Terms Code"}),e.jsxs(rt,{value:st.paymentTerms||"Net 30",onValueChange:ae=>$t(Ke=>({...Ke,paymentTerms:ae})),children:[e.jsx(nt,{className:"h-12 bg-white border-slate-300",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"Due on Receipt",children:"Due on Receipt"}),e.jsx(W,{value:"Net 7",children:"Net 7"}),e.jsx(W,{value:"Net 15",children:"Net 15"}),e.jsx(W,{value:"Net 30",children:"Net 30"}),e.jsx(W,{value:"Net 60",children:"Net 60"}),e.jsx(W,{value:"Net 90",children:"Net 90"})]})]})]})]})]})]}),e.jsxs("div",{className:"md:col-span-1 lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-white to-slate-50 rounded-xl border-2 border-blue-100 shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx(Gu,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Line Items"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Add products or services to your invoice"})]})]}),e.jsxs(I,{variant:"default",size:"sm",onClick:()=>{const ae=[...st.lines,{description:"",quantity:1,unitPrice:0,taxRate:0,productId:""}];$t({...st,lines:ae,...gt(ae)})},className:"h-11 px-4 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 shadow-lg",children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Add Item"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-slate-100 rounded-lg p-3 border border-slate-200",children:e.jsxs("div",{className:"grid grid-cols-12 gap-4 text-sm font-bold text-slate-700",children:[e.jsxs("div",{className:"col-span-5 flex items-center gap-2",children:[e.jsx(Zt,{className:"w-4 h-4 text-blue-600"}),"Description"]}),e.jsxs("div",{className:"col-span-1 text-center flex items-center justify-center gap-1",children:[e.jsx(yn,{className:"w-3 h-3 text-blue-600"}),"Qty"]}),e.jsxs("div",{className:"col-span-2 text-right flex items-center justify-end gap-1",children:[e.jsx($a,{className:"w-3 h-3 text-blue-600"}),"Unit Price"]}),e.jsxs("div",{className:"col-span-2 text-right flex items-center justify-end gap-1",children:[e.jsx(yn,{className:"w-3 h-3 text-blue-600"}),"Discount"]}),e.jsxs("div",{className:"col-span-1 text-center flex items-center justify-center gap-1",children:[e.jsx(yn,{className:"w-3 h-3 text-blue-600"}),"Tax %"]}),e.jsx("div",{className:"col-span-1 text-center",children:"Actions"})]})}),st.lines.map((ae,Ke)=>e.jsx("div",{className:"group bg-white hover:bg-blue-50/50 transition-all duration-200 rounded-xl border-2 border-slate-200 hover:border-blue-300 shadow-sm hover:shadow-md p-5",children:e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-start",children:[e.jsxs("div",{className:"col-span-5 space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ge,{placeholder:"Enter item description (e.g., Web Design Services)",value:ae.description,onChange:Bt=>{const Yt=[...st.lines];Yt[Ke].description=Bt.target.value,$t({...st,lines:Yt,...gt(Yt)})},className:"h-12 text-base font-medium bg-white border-slate-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200"}),ae.description&&e.jsx("div",{className:"absolute right-3 top-3 text-green-500",children:e.jsx(bs,{className:"w-5 h-5"})})]}),e.jsxs(rt,{value:ae.productId||"",onValueChange:Bt=>{const Yt=We.find(zr=>zr.id===Bt);if(!Yt)return;const Fs=[...st.lines];Fs[Ke].productId=Bt,Fs[Ke].description=Yt.name,Fs[Ke].unitPrice=Yt.unitPrice||Yt.price||0,$t({...st,lines:Fs,...gt(Fs)})},children:[e.jsx(nt,{className:"h-10 text-sm bg-slate-50 border-slate-300",children:e.jsx(it,{placeholder:"Or select from product catalog..."})}),e.jsx(at,{children:We.map(Bt=>e.jsx(W,{value:Bt.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"font-medium",children:[Bt.sku?`${Bt.sku} - `:"",Bt.name]}),e.jsx(Oe,{variant:"secondary",className:"text-xs",children:$n(Bt.unitPrice||Bt.price||0,st.currency)})]})},Bt.id))})]})]}),e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(ge,{type:"number",min:"0",step:"1",placeholder:"1",value:ae.quantity,onChange:Bt=>{const Yt=[...st.lines];Yt[Ke].quantity=parseFloat(Bt.target.value)||0,$t({...st,lines:Yt,...gt(Yt)})},className:"h-12 text-center text-base font-semibold bg-white border-slate-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200"}),e.jsx("div",{className:"absolute inset-x-0 -bottom-6 text-xs text-center text-slate-500",children:"qty"})]})}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(ge,{type:"number",min:"0",step:"0.01",placeholder:"0.00",value:ae.unitPrice,onChange:Bt=>{const Yt=[...st.lines];Yt[Ke].unitPrice=parseFloat(Bt.target.value)||0,$t({...st,lines:Yt,...gt(Yt)})},className:"h-12 text-right text-base font-semibold bg-white border-slate-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200"}),e.jsx("div",{className:"absolute inset-x-0 -bottom-6 text-xs text-center text-slate-500",children:"per unit"})]})}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(ge,{type:"number",min:"0",step:"0.01",placeholder:"0.00",value:ae.lineDiscount||0,onChange:Bt=>{const Yt=[...st.lines];Yt[Ke].lineDiscount=parseFloat(Bt.target.value)||0,$t({...st,lines:Yt,...gt(Yt)})},className:"h-12 text-right text-base font-semibold bg-white border-slate-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200"}),e.jsx("div",{className:"absolute inset-x-0 -bottom-6 text-xs text-center text-slate-500",children:"discount"})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(ge,{type:"number",min:"0",step:"0.01",placeholder:"0",disabled:st.taxMode==="global",value:ae.taxRate,onChange:Bt=>{const Yt=[...st.lines];Yt[Ke].taxRate=parseFloat(Bt.target.value)||0,$t({...st,lines:Yt,...gt(Yt)})},className:"h-12 text-center text-base font-semibold bg-white border-slate-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 disabled:bg-slate-100 disabled:text-slate-500"}),e.jsx("div",{className:"absolute inset-x-0 -bottom-6 text-xs text-center text-slate-500",children:st.taxMode==="global"?"global":"tax %"})]})}),e.jsxs("div",{className:"col-span-1 flex flex-col items-center gap-2",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>{const Bt=st.lines.filter((Yt,Fs)=>Fs!==Ke);$t({...st,lines:Bt.length?Bt:[{description:"",quantity:1,unitPrice:0,taxRate:0,productId:""}],...gt(Bt.length?Bt:[{description:"",quantity:1,unitPrice:0,taxRate:0,productId:""}])})},className:"h-10 w-10 p-0 text-red-600 hover:text-red-700 hover:bg-red-100 group-hover:bg-red-50 border border-red-200",title:"Remove this line item",children:e.jsx(ma,{className:"w-5 h-5"})}),e.jsxs("div",{className:"text-center mt-2",children:[e.jsx("div",{className:"text-xs text-slate-500 font-medium",children:"Line Total"}),e.jsx("div",{className:"text-sm font-bold text-slate-900",children:$n(ae.quantity*ae.unitPrice-(ae.lineDiscount||0),st.currency)})]})]})]})},Ke)),st.lines.length===0&&e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border-2 border-dashed border-slate-300",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Gu,{className:"w-8 h-8 text-slate-400"})}),e.jsx("h4",{className:"text-lg font-semibold text-slate-700 mb-2",children:"No line items added yet"}),e.jsx("p",{className:"text-slate-500 mb-4",children:"Add products or services to get started"}),e.jsxs(I,{variant:"outline",onClick:()=>{const ae=[{description:"",quantity:1,unitPrice:0,taxRate:0,productId:""}];$t({...st,lines:ae,...gt(ae)})},className:"h-12 px-6",children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Add Your First Item"]})]}),st.lines.length>0&&e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg border border-slate-200",children:[e.jsxs("div",{className:"text-sm text-slate-600",children:[e.jsx("span",{className:"font-medium",children:st.lines.length})," line item",st.lines.length!==1?"s":""," added"]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>{const ae=[...st.lines,{description:"",quantity:1,unitPrice:0,taxRate:0,productId:""}];$t({...st,lines:ae,...gt(ae)})},className:"h-9",children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Add Another Item"]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl border-2 border-green-200 shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-green-600 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx(yn,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Invoice Totals"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Calculated automatically from line items"})]})]}),e.jsx("div",{className:"bg-white rounded-xl border-2 border-green-200 shadow-lg p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-slate-600 font-medium",children:"Subtotal"}),e.jsx("span",{className:"text-slate-900 font-semibold text-lg",children:$n(st.subtotal,st.currency)})]}),e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-slate-600 font-medium",children:"Tax"}),e.jsx("span",{className:"text-slate-900 font-semibold text-lg",children:$n(st.taxTotal,st.currency)})]}),st.shipping>0&&e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-slate-600 font-medium",children:"Shipping"}),e.jsx("span",{className:"text-slate-900 font-semibold text-lg",children:$n(st.shipping,st.currency)})]}),st.discount>0&&e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-slate-600 font-medium",children:"Discount"}),e.jsxs("span",{className:"text-red-600 font-semibold text-lg",children:["-",$n(st.discount,st.currency)]})]}),e.jsx("div",{className:"border-t border-slate-200 pt-4",children:e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-slate-900 font-bold text-xl",children:"Total"}),e.jsx("span",{className:"text-slate-900 font-bold text-2xl",children:$n(st.totalAmount,st.currency)})]})})]})}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-blue-700",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsxs("span",{children:["Exchange Rate: ",Vs.toFixed(4)," ",ms,"  ",st.currency," ",Ns?"(locked)":""]})]})})]})]})]})}),e.jsx(Xr,{className:"sticky bottom-0 bg-white border-t border-slate-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(I,{variant:"outline",onClick:()=>mt(!1),disabled:Rt,className:"h-12 px-6",children:"Cancel"}),e.jsxs(I,{variant:"outline",size:"sm",onClick:async()=>{try{if(!f[0]){n({title:"Preview unavailable",description:"Save invoice first, then preview.",variant:"destructive"});return}await S(f[0],"preview")}catch(ae){n({title:"Preview failed",description:(ae==null?void 0:ae.message)||"Failed to preview PDF",variant:"destructive"})}},className:"h-10",children:[e.jsx(ir,{className:"w-4 h-4 mr-2"}),"Preview PDF"]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:async()=>{try{if(!f[0]){n({title:"No invoice yet",description:"Save invoice first, then create payment link.",variant:"destructive"});return}const ae=await de.createPaymentLink(f[0].id);await navigator.clipboard.writeText(ae.url),n({title:"Payment link copied",description:ae.url})}catch(ae){n({title:"Create link failed",description:(ae==null?void 0:ae.message)||"Failed to create payment link",variant:"destructive"})}},className:"h-10",children:[e.jsx(s1,{className:"w-4 h-4 mr-2"}),"Copy Payment Link"]})]}),e.jsx(I,{onClick:async()=>{try{if(_e(!0),At(null),!st.customerId)throw new Error("Customer is required");if(!st.invoiceNumber)throw new Error("Invoice number is required");const ae={companyId:u,customerId:st.customerId,invoiceNumber:st.invoiceNumber,issueDate:st.issueDate,dueDate:st.dueDate||void 0,currency:st.currency,lines:st.lines.map(Bt=>({description:Bt.description,quantity:Bt.quantity,unitPrice:Bt.unitPrice,taxRate:Bt.taxRate,lineDiscount:Bt.lineDiscount||0,productId:Bt.productId||null})),subtotal:st.subtotal,taxAmount:st.taxTotal,discountAmount:st.discount,shippingAmount:st.shipping,totalAmount:st.totalAmount,balanceDue:st.totalAmount,notes:st.notes||"",terms:st.terms||"Payment due within 30 days",footer:"",paymentTerms:st.paymentTerms||"Net 30",lateFeeRate:null,deliveryMethod:"email",taxInclusive:!1,taxExemptionReason:null,createdBy:null,status:"draft",fxRateSnapshot:Vs,totalsSnapshot:{subtotal:st.subtotal,taxTotal:st.taxTotal,shipping:st.shipping,discountMode:st.discountMode,discount:st.discount,total:st.totalAmount}},Ke=await de.createInvoice(ae);if(await Ur.invalidateQueries({queryKey:["invoices"]}),Ke!=null&&Ke.id){try{await S(Ke,"preview")}catch{}try{const Bt=await de.createPaymentLink(Ke.id,{expiresInMinutes:60});await navigator.clipboard.writeText(Bt.url),n({title:"Payment link copied",description:Bt.url})}catch{}}mt(!1)}catch(ae){At((ae==null?void 0:ae.message)||"Failed to create invoice")}finally{_e(!1)}},disabled:Rt,className:"h-12 px-8 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 shadow-lg hover:shadow-xl transition-all duration-200",children:Rt?e.jsxs(e.Fragment,{children:[e.jsx(On,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating Invoice..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Zt,{className:"w-4 h-4 mr-2"}),"Create Invoice"]})})]})})]})})]}),e.jsxs(yt,{value:"customers",className:"space-y-4",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{children:"Customer Directory"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Rn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(ge,{placeholder:"Search customers...",className:"pl-10 w-64",value:z,onChange:ae=>{U(ae.target.value),se(1)}})]}),e.jsxs(I,{onClick:()=>{k(null),A({name:"",email:"",currency:"USD"}),C(!0)},children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Add Customer"]})]})]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[(Array.isArray(ds)?ds:[]).map(ae=>e.jsxs("div",{className:"group flex items-center justify-between p-6 bg-white border border-gray-100 rounded-xl hover:shadow-lg hover:border-blue-200 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-100 to-green-200 rounded-xl flex items-center justify-center group-hover:from-green-200 group-hover:to-green-300 transition-all duration-200",children:e.jsx("span",{className:"text-green-600 font-bold text-lg",children:ae.name.charAt(0)})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 text-lg",children:ae.name}),e.jsx("p",{className:"text-sm text-gray-600",children:ae.email||""}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:e.jsx(Oe,{variant:"outline",className:"text-xs",children:ae.currency||"USD"})})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{variant:"outline",size:"sm",className:"hover:bg-green-50 hover:border-green-200",onClick:()=>{k(ae),A({name:ae.name,email:ae.email,currency:ae.currency||"USD"}),C(!0)},children:e.jsx(ir,{className:"w-4 h-4"})}),e.jsx(I,{variant:"outline",size:"sm",className:"hover:bg-blue-50 hover:border-blue-200",children:e.jsx(ln,{className:"w-4 h-4"})})]})})]},ae.id)),ds.length===0&&!a&&e.jsx("div",{className:"text-sm text-muted-foreground",children:"No customers found"}),qs.data&&e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(D-1)*he+1," to ",Math.min(D*he,qs.data.total)," of ",qs.data.total," customers"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("select",{className:"text-sm border rounded px-2 py-1",value:he,onChange:ae=>{be(Number(ae.target.value)),se(1)},children:[e.jsx("option",{value:10,children:"10 per page"}),e.jsx("option",{value:20,children:"20 per page"}),e.jsx("option",{value:50,children:"50 per page"}),e.jsx("option",{value:100,children:"100 per page"})]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>se(ae=>Math.max(1,ae-1)),disabled:!qs.data.hasPrev||qs.isLoading,children:"Previous"}),e.jsxs("div",{className:"text-sm",children:["Page ",D," of ",qs.data.totalPages]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>se(ae=>ae+1),disabled:!qs.data.hasNext||qs.isLoading,children:"Next"})]})]})]})})]}),e.jsx(ts,{open:N,onOpenChange:C,children:e.jsxs(ss,{children:[e.jsxs(as,{children:[e.jsx(is,{children:_?"Edit Customer":"Add Customer"}),e.jsx(Ks,{children:"Enter customer details below."})]}),M&&e.jsx("div",{className:"text-red-600 text-sm",children:M}),e.jsxs("div",{className:"space-y-4 py-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"cust-name",children:"Name"}),e.jsx(ge,{id:"cust-name",value:F.name,onChange:ae=>A({...F,name:ae.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"cust-email",children:"Email"}),e.jsx(ge,{id:"cust-email",type:"email",value:F.email||"",onChange:ae=>A({...F,email:ae.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"cust-currency",children:"Currency"}),e.jsx("select",{id:"cust-currency",className:"w-full border rounded px-2 py-2",value:F.currency||"USD",onChange:ae=>A({...F,currency:ae.target.value}),children:["USD","EUR","GBP","KES","NGN"].map(ae=>e.jsx("option",{value:ae,children:ae},ae))})]})]}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:()=>C(!1),disabled:T,children:"Cancel"}),e.jsx(I,{onClick:async()=>{try{if(V(!0),G(null),!F.name||F.name.trim()==="")throw new Error("Name is required");if(!u)throw new Error("No company selected");_?(await de.updateCustomer(_.id,{companyId:u,name:F.name,email:F.email,currency:F.currency}),n({title:"Customer updated",description:`${F.name}`})):(await de.createCustomer({companyId:u,name:F.name,email:F.email,currency:F.currency}),n({title:"Customer created",description:`${F.name}`})),await Ur.invalidateQueries({queryKey:["customers"]}),C(!1)}catch(ae){G((ae==null?void 0:ae.message)||"Failed to save customer"),n({title:"Customer save failed",description:(ae==null?void 0:ae.message)||"Failed to save customer",variant:"destructive"})}finally{V(!1)}},disabled:T,children:T?"Saving":_?"Save Changes":"Create Customer"})]})]})})]}),e.jsx(yt,{value:"estimates",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{children:"Estimates & Quotes"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Rn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(ge,{placeholder:"Search estimates...",className:"pl-10 w-64",value:pe,onChange:ae=>{Ae(ae.target.value)}})]}),e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(Ic,{className:"w-4 h-4 mr-2"}),"Filter"]}),e.jsxs(I,{onClick:()=>{var Yt,Fs;const ae=Array.isArray(hr)?hr:[],Ke=((Yt=ae[0])==null?void 0:Yt.id)||"",Bt=((Fs=ae.find(zr=>zr.id===Ke))==null?void 0:Fs.currency)||"USD";ft({customerId:Ke,estimateNumber:"",issueDate:new Date().toISOString().slice(0,10),expiryDate:"",currency:Bt,notes:"",terms:"",lines:[{description:"",quantity:1,unitPrice:0,taxRate:0}]}),lt(null),zt(!0)},children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"New Estimate"]})]})]})}),e.jsxs(ie,{children:[o&&e.jsx("div",{className:"text-red-600 text-sm mb-2",children:(o==null?void 0:o.message)||(o==null?void 0:o.toString())||"Unknown error"}),e.jsxs("div",{className:"space-y-4",children:[(Fn==null?void 0:Fn.isLoading)&&e.jsx(e.Fragment,{children:[0,1,2,3,4].map(ae=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsx("div",{className:"h-4 w-32 bg-muted rounded"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-4 w-24 bg-muted rounded"}),e.jsx("div",{className:"h-6 w-20 bg-muted rounded"})]})]},ae))}),!(Fn!=null&&Fn.isLoading)&&Us.map(ae=>{var Ke;return e.jsxs("div",{className:"group flex items-center justify-between p-6 bg-white border border-gray-100 rounded-xl hover:shadow-lg hover:border-blue-200 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-100 to-purple-200 rounded-xl flex items-center justify-center group-hover:from-purple-200 group-hover:to-purple-300 transition-all duration-200",children:e.jsx("span",{className:"text-purple-600 font-bold text-lg",children:"#"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 text-lg",children:ae.estimateNumber}),e.jsx("p",{className:"text-sm text-gray-600",children:((Ke=ae.customer)==null?void 0:Ke.name)||"Customer"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(Oe,{variant:ae.status==="accepted"?"default":ae.status==="sent"?"secondary":ae.status==="rejected"?"destructive":"outline",className:"text-xs",children:ae.status}),ae.issueDate&&e.jsx("span",{className:"text-xs text-gray-500",children:new Date(ae.issueDate).toLocaleDateString()})]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-lg text-gray-900",children:$n(ae.totalAmount,ae.currency)}),e.jsx("p",{className:"text-sm text-gray-500",children:ae.currency})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[ae.status==="draft"&&e.jsx(I,{variant:"outline",size:"sm",className:"hover:bg-blue-50 hover:border-blue-200",onClick:async()=>{try{await de.updateEstimate(ae.id,{status:"sent"}),await Ur.invalidateQueries({queryKey:["estimates"]})}catch{}},children:"Mark Sent"}),ae.status==="sent"&&e.jsx(I,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:async()=>{try{await de.updateEstimate(ae.id,{status:"accepted"}),await Ur.invalidateQueries({queryKey:["estimates"]})}catch{}},children:"Mark Accepted"}),ae.status==="accepted"&&e.jsx(I,{size:"sm",className:"bg-blue-600 hover:bg-blue-700",onClick:async()=>{try{const Bt=await de.convertEstimateToInvoice(ae.id);await Ur.invalidateQueries({queryKey:["estimates"]}),await Ur.invalidateQueries({queryKey:["invoices"]})}catch{}},children:"Convert to Invoice"})]}),e.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:async()=>{try{const Bt=await de.getEstimatePdf(ae.id),Yt=URL.createObjectURL(Bt);window.open(Yt,"_blank")}catch{}},children:e.jsx(An,{className:"w-4 h-4"})}),e.jsx(I,{variant:"ghost",size:"sm",onClick:async()=>{try{xs(!0),As(ae),Je(!0)}finally{xs(!1)}},children:e.jsx(ir,{className:"w-4 h-4"})}),e.jsx(I,{variant:"ghost",size:"sm",onClick:async()=>{var Bt;try{As(ae),ke({customerId:ae.customerId||"",estimateNumber:ae.estimateNumber||"",issueDate:dj(ae.issueDate)||new Date().toISOString().slice(0,10),expiryDate:dj(ae.expiryDate),currency:ae.currency||"USD",notes:ae.notes||"",terms:ae.terms||"",lines:((Bt=ae.lines)==null?void 0:Bt.map(Yt=>({description:Yt.description||"",quantity:Yt.quantity||1,unitPrice:Yt.unitPrice||0,taxRate:Yt.taxRate||0})))||[{description:"",quantity:1,unitPrice:0,taxRate:0}]}),Gt(!0)}catch(Yt){console.error("Error preparing estimate for edit:",Yt)}},children:e.jsx(ln,{className:"w-4 h-4"})})]})]})]},ae.id)}),Us.length===0&&!a&&e.jsx("div",{className:"text-sm text-muted-foreground",children:"No estimates found"}),Fn.data&&e.jsx("div",{className:"flex items-center justify-between pt-4 border-t",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",Us.length," estimates"]})})]})]})]})}),e.jsx(ts,{open:fs,onOpenChange:zt,children:e.jsxs(ss,{className:"max-w-3xl max-h-[90vh] overflow-y-auto z-50",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Create Estimate"}),e.jsx(Ks,{children:"Fill in estimate details."})]}),et&&e.jsx("div",{className:"text-red-600 text-sm mb-2",children:et}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Customer"}),e.jsxs("select",{className:"w-full border rounded px-3 py-2",value:Fe.customerId,onChange:ae=>{const Ke=ae.target.value,Bt=(Array.isArray(hr)?hr:[]).find(Yt=>Yt.id===Ke);ft(Yt=>({...Yt,customerId:Ke,currency:(Bt==null?void 0:Bt.currency)||Yt.currency}))},children:[e.jsx("option",{value:"",children:"Select customer"}),(Array.isArray(hr)?hr:[]).map(ae=>e.jsxs("option",{value:ae.id,children:[ae.name," ",ae.email?`(${ae.email})`:""]},ae.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Estimate Number"}),e.jsx(ge,{placeholder:"e.g. EST-2025-0001",value:Fe.estimateNumber,onChange:ae=>ft(Ke=>({...Ke,estimateNumber:ae.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Issue Date"}),e.jsx(ge,{type:"date",value:Fe.issueDate,onChange:ae=>ft(Ke=>({...Ke,issueDate:ae.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Expiry Date"}),e.jsx(ge,{type:"date",value:Fe.expiryDate||"",onChange:ae=>ft(Ke=>({...Ke,expiryDate:ae.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Currency"}),e.jsx(ge,{value:Fe.currency,onChange:ae=>ft(Ke=>({...Ke,currency:ae.target.value.toUpperCase().slice(0,3)}))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Line Items"}),e.jsxs("div",{className:"space-y-3",children:[Fe.lines.map((ae,Ke)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-2 items-center",children:[e.jsx("div",{className:"md:col-span-5",children:e.jsx(ge,{placeholder:"Description",value:ae.description,onChange:Bt=>{const Yt=[...Fe.lines];Yt[Ke]={...Yt[Ke],description:Bt.target.value},ft(Fs=>({...Fs,lines:Yt}))}})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(ge,{type:"number",min:0,step:1,placeholder:"Qty",value:ae.quantity,onChange:Bt=>{const Yt=[...Fe.lines];Yt[Ke]={...Yt[Ke],quantity:Number(Bt.target.value)},ft(Fs=>({...Fs,lines:Yt}))}})}),e.jsx("div",{className:"md:col-span-3",children:e.jsx(ge,{type:"number",min:0,step:.01,placeholder:"Unit Price",value:ae.unitPrice,onChange:Bt=>{const Yt=[...Fe.lines];Yt[Ke]={...Yt[Ke],unitPrice:Number(Bt.target.value)},ft(Fs=>({...Fs,lines:Yt}))}})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(ge,{type:"number",min:0,max:100,step:.01,placeholder:"Tax %",value:ae.taxRate,onChange:Bt=>{const Yt=[...Fe.lines];Yt[Ke]={...Yt[Ke],taxRate:Number(Bt.target.value)},ft(Fs=>({...Fs,lines:Yt}))}})})]},Ke)),e.jsx("div",{children:e.jsx(I,{type:"button",variant:"outline",size:"sm",onClick:()=>ft(ae=>({...ae,lines:[...ae.lines,{description:"",quantity:1,unitPrice:0,taxRate:0}]})),children:"Add Line"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notes"}),e.jsx("textarea",{className:"w-full border rounded px-3 py-2 min-h-[80px]",value:Fe.notes,onChange:ae=>ft(Ke=>({...Ke,notes:ae.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Terms"}),e.jsx("textarea",{className:"w-full border rounded px-3 py-2 min-h-[80px]",value:Fe.terms,onChange:ae=>ft(Ke=>({...Ke,terms:ae.target.value}))})]})]})]}),e.jsxs(Xr,{className:"sticky bottom-0 bg-white",children:[e.jsx(I,{variant:"outline",onClick:()=>zt(!1),disabled:St,children:"Cancel"}),e.jsx(I,{onClick:async()=>{try{if(js(!0),lt(null),!u)throw new Error("No company selected");if(!Fe.customerId)throw new Error("Customer is required");if(!Fe.estimateNumber)throw new Error("Estimate number is required");if(!Fe.issueDate)throw new Error("Issue date is required");const ae={companyId:u,customerId:Fe.customerId,estimateNumber:Fe.estimateNumber,issueDate:Fe.issueDate,expiryDate:Fe.expiryDate||void 0,currency:Fe.currency||"USD",notes:Fe.notes||void 0,terms:Fe.terms||void 0,lines:Fe.lines.map(Ke=>({description:Ke.description,quantity:Number(Ke.quantity)||0,unitPrice:Number(Ke.unitPrice)||0,taxRate:Number(Ke.taxRate)||0}))};await de.createEstimate(ae),await Ur.invalidateQueries({queryKey:["estimates"]}),n({title:"Estimate created",description:ae.estimateNumber}),zt(!1)}catch(ae){lt((ae==null?void 0:ae.message)||"Failed to create estimate"),n({title:"Estimate creation failed",description:(ae==null?void 0:ae.message)||"Failed to create estimate",variant:"destructive"})}finally{js(!1)}},disabled:St,children:St?"Creating":"Create Estimate"})]})]})}),e.jsx(ts,{open:He,onOpenChange:Je,children:e.jsxs(ss,{className:"max-w-4xl max-h-[90vh] overflow-y-auto z-50",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Estimate Details"}),e.jsx(Ks,{children:"View estimate information and details."})]}),qt&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Estimate Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Estimate Number"}),e.jsx("p",{className:"text-lg font-semibold",children:qt.estimateNumber})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Customer"}),e.jsx("p",{className:"text-lg",children:((Ge=qt.customer)==null?void 0:Ge.name)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Status"}),e.jsx(Oe,{variant:qt.status==="accepted"?"default":qt.status==="sent"?"secondary":qt.status==="rejected"?"destructive":"outline",className:"text-sm",children:qt.status})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Dates & Amounts"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Issue Date"}),e.jsx("p",{children:qt.issueDate?new Date(qt.issueDate).toLocaleDateString():"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Expiry Date"}),e.jsx("p",{children:qt.expiryDate?new Date(qt.expiryDate).toLocaleDateString():"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Total Amount"}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:$n(qt.totalAmount,qt.currency)})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Line Items"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full border-collapse border border-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("th",{className:"border border-gray-200 px-4 py-2 text-left",children:"Description"}),e.jsx("th",{className:"border border-gray-200 px-4 py-2 text-right",children:"Qty"}),e.jsx("th",{className:"border border-gray-200 px-4 py-2 text-right",children:"Unit Price"}),e.jsx("th",{className:"border border-gray-200 px-4 py-2 text-right",children:"Tax Rate"}),e.jsx("th",{className:"border border-gray-200 px-4 py-2 text-right",children:"Total"})]})}),e.jsx("tbody",{children:(ht=qt.lines)==null?void 0:ht.map((ae,Ke)=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-gray-200 px-4 py-2",children:ae.description||"-"}),e.jsx("td",{className:"border border-gray-200 px-4 py-2 text-right",children:ae.quantity||0}),e.jsx("td",{className:"border border-gray-200 px-4 py-2 text-right",children:$n(ae.unitPrice||0,qt.currency)}),e.jsxs("td",{className:"border border-gray-200 px-4 py-2 text-right",children:[ae.taxRate||0,"%"]}),e.jsx("td",{className:"border border-gray-200 px-4 py-2 text-right",children:$n(ae.lineTotal||0,qt.currency)})]},Ke))})]})})]}),(qt.notes||qt.terms)&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[qt.notes&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Notes"}),e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:qt.notes})]}),qt.terms&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Terms"}),e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:qt.terms})]})]})]}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:()=>Je(!1),children:"Close"}),e.jsx(I,{onClick:()=>{var ae;qt&&(ke({customerId:qt.customerId||"",estimateNumber:qt.estimateNumber||"",issueDate:dj(qt.issueDate)||new Date().toISOString().slice(0,10),expiryDate:dj(qt.expiryDate),currency:qt.currency||"USD",notes:qt.notes||"",terms:qt.terms||"",lines:((ae=qt.lines)==null?void 0:ae.map(Ke=>({description:Ke.description||"",quantity:Ke.quantity||1,unitPrice:Ke.unitPrice||0,taxRate:Ke.taxRate||0})))||[{description:"",quantity:1,unitPrice:0,taxRate:0}]}),Je(!1),Gt(!0))},children:"Edit Estimate"})]})]})}),e.jsx(ts,{open:It,onOpenChange:Gt,children:e.jsxs(ss,{className:"max-w-3xl max-h-[90vh] overflow-y-auto z-50",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Edit Estimate"}),e.jsx(Ks,{children:"Update estimate details and information."})]}),e.jsxs("div",{className:"space-y-4",children:[et&&e.jsx("div",{className:"text-red-600 text-sm mb-2",children:et}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Customer"}),e.jsxs("select",{className:"w-full border rounded px-3 py-2",value:Ct.customerId,onChange:ae=>{const Ke=ae.target.value,Bt=(Array.isArray(hr)?hr:[]).find(Yt=>Yt.id===Ke);ke(Yt=>({...Yt,customerId:Ke,currency:(Bt==null?void 0:Bt.currency)||Yt.currency}))},children:[e.jsx("option",{value:"",children:"Select customer"}),(Array.isArray(hr)?hr:[]).map(ae=>e.jsx("option",{value:ae.id,children:ae.name},ae.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Estimate Number"}),e.jsx(ge,{placeholder:"e.g. EST-2025-0001",value:Ct.estimateNumber,onChange:ae=>ke(Ke=>({...Ke,estimateNumber:ae.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Issue Date"}),e.jsx(ge,{type:"date",value:Ct.issueDate,onChange:ae=>ke(Ke=>({...Ke,issueDate:ae.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Expiry Date"}),e.jsx(ge,{type:"date",value:Ct.expiryDate||"",onChange:ae=>ke(Ke=>({...Ke,expiryDate:ae.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Currency"}),e.jsx(ge,{value:Ct.currency,onChange:ae=>ke(Ke=>({...Ke,currency:ae.target.value.toUpperCase().slice(0,3)}))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Line Items"}),e.jsxs("div",{className:"space-y-3",children:[Ct.lines.map((ae,Ke)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-2 items-center",children:[e.jsx("div",{className:"md:col-span-5",children:e.jsx(ge,{placeholder:"Description",value:ae.description,onChange:Bt=>{const Yt=[...Ct.lines];Yt[Ke]={...Yt[Ke],description:Bt.target.value},ke(Fs=>({...Fs,lines:Yt}))}})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(ge,{type:"number",min:0,step:1,placeholder:"Qty",value:ae.quantity,onChange:Bt=>{const Yt=[...Ct.lines];Yt[Ke]={...Yt[Ke],quantity:Number(Bt.target.value)},ke(Fs=>({...Fs,lines:Yt}))}})}),e.jsx("div",{className:"md:col-span-3",children:e.jsx(ge,{type:"number",min:0,step:.01,placeholder:"Unit Price",value:ae.unitPrice,onChange:Bt=>{const Yt=[...Ct.lines];Yt[Ke]={...Yt[Ke],unitPrice:Number(Bt.target.value)},ke(Fs=>({...Fs,lines:Yt}))}})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(ge,{type:"number",min:0,max:100,step:.01,placeholder:"Tax %",value:ae.taxRate,onChange:Bt=>{const Yt=[...Ct.lines];Yt[Ke]={...Yt[Ke],taxRate:Number(Bt.target.value)},ke(Fs=>({...Fs,lines:Yt}))}})})]},Ke)),e.jsx(I,{type:"button",variant:"outline",onClick:()=>{ke(ae=>({...ae,lines:[...ae.lines,{description:"",quantity:1,unitPrice:0,taxRate:0}]}))},children:"Add Line Item"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notes"}),e.jsx("textarea",{className:"w-full border rounded px-3 py-2 min-h-[80px]",value:Ct.notes,onChange:ae=>ke(Ke=>({...Ke,notes:ae.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Terms"}),e.jsx("textarea",{className:"w-full border rounded px-3 py-2 min-h-[80px]",value:Ct.terms,onChange:ae=>ke(Ke=>({...Ke,terms:ae.target.value}))})]})]})]}),e.jsxs(Xr,{className:"sticky bottom-0 bg-white",children:[e.jsx(I,{variant:"outline",onClick:()=>Gt(!1),disabled:St,children:"Cancel"}),e.jsx(I,{onClick:async()=>{try{if(js(!0),lt(null),!qt)throw new Error("No estimate selected");if(!Ct.customerId)throw new Error("Customer is required");if(!Ct.estimateNumber)throw new Error("Estimate number is required");if(!Ct.issueDate)throw new Error("Issue date is required");const ae={customerId:Ct.customerId,estimateNumber:Ct.estimateNumber,issueDate:Ct.issueDate,expiryDate:Ct.expiryDate||void 0,currency:Ct.currency||"USD",notes:Ct.notes||void 0,terms:Ct.terms||void 0,lines:Ct.lines.map(Ke=>({description:Ke.description,quantity:Number(Ke.quantity)||0,unitPrice:Number(Ke.unitPrice)||0,taxRate:Number(Ke.taxRate)||0}))};await de.updateEstimate(qt.id,ae),await Ur.invalidateQueries({queryKey:["estimates"]}),n({title:"Estimate updated",description:ae.estimateNumber}),Gt(!1),lt(null)}catch(ae){lt((ae==null?void 0:ae.message)||"Failed to update estimate")}finally{js(!1)}},disabled:St,children:St?"Updating":"Update Estimate"})]})]})}),e.jsx(yt,{value:"recurring",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{children:"Recurring Invoices"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Rn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(ge,{placeholder:"Search recurring invoices...",className:"pl-10 w-64",value:X,onChange:ae=>{ce(ae.target.value),le(1)}})]}),e.jsxs("select",{className:"text-sm border rounded px-3 py-2",value:Y,onChange:ae=>{ue(ae.target.value),le(1)},children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"paused",children:"Paused"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]}),e.jsxs(I,{onClick:()=>{var Ke,Bt;const ae=Array.isArray(p)?p:[];bt({...fn,customerId:((Ke=ae[0])==null?void 0:Ke.id)||"",currency:((Bt=ae[0])==null?void 0:Bt.currency)||"USD",startDate:new Date().toISOString().slice(0,10)}),wn(null),$r(!0)},children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"New Recurring Invoice"]})]})]})}),e.jsxs(ie,{children:[(Rr==null?void 0:Rr.isLoading)&&e.jsx(e.Fragment,{children:[0,1,2,3,4].map(ae=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsx("div",{className:"h-4 w-32 bg-muted rounded"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-4 w-20 bg-muted rounded"}),e.jsx("div",{className:"h-4 w-16 bg-muted rounded"})]})]},ae))}),!(Rr!=null&&Rr.isLoading)&&H.map(ae=>{var Ke,Bt;return e.jsxs("div",{className:"group flex items-center justify-between p-6 bg-white border border-gray-100 rounded-xl hover:shadow-lg hover:border-blue-200 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-orange-100 to-orange-200 rounded-xl flex items-center justify-center group-hover:from-orange-200 group-hover:to-orange-300 transition-all duration-200",children:e.jsx("span",{className:"text-orange-600 font-bold text-lg",children:""})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900 text-lg",children:ae.name}),e.jsx("p",{className:"text-sm text-gray-600",children:(Ke=ae.customer)==null?void 0:Ke.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(Oe,{variant:ae.status==="active"?"default":ae.status==="paused"?"secondary":"outline",className:"text-xs",children:ae.status}),e.jsx(Oe,{variant:"outline",className:"text-xs",children:ae.frequency}),e.jsxs("span",{className:"text-xs text-gray-500",children:["$",(Number(ae.totalAmount)||0).toFixed(2)," ",ae.currency]})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Next: ",new Date(ae.nextRunDate).toLocaleDateString(),ae.lastRunDate&&`  Last: ${new Date(ae.lastRunDate).toLocaleDateString()}`,((Bt=ae._count)==null?void 0:Bt.generatedInvoices)&&`  ${ae._count.generatedInvoices} invoices`]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(rt,{value:ae.status,onValueChange:Yt=>el(ae,Yt),children:[e.jsx(nt,{className:"w-24 h-8",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"active",children:"Active"}),e.jsx(W,{value:"paused",children:"Paused"}),e.jsx(W,{value:"completed",children:"Completed"}),e.jsx(W,{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(I,{variant:"outline",size:"sm",onClick:()=>$l(ae),className:"hover:bg-blue-50 hover:border-blue-200",children:e.jsx(ir,{className:"w-4 h-4"})}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>qo(ae),className:"hover:bg-orange-50 hover:border-orange-200",children:e.jsx(ln,{className:"w-4 h-4"})}),ae.status==="active"&&e.jsx(I,{variant:"outline",size:"sm",onClick:()=>Zo(ae),disabled:Xi.isPending,className:"hover:bg-green-50 hover:border-green-200",children:Xi.isPending?e.jsx(On,{className:"w-4 h-4 animate-spin"}):e.jsx(Ts,{className:"w-4 h-4"})})]})]})]},ae.id)}),!(Rr!=null&&Rr.isLoading)&&H.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"No recurring invoices found"}),e.jsxs(I,{onClick:()=>{var Bt,Yt;const ae=Array.isArray(p)?p:[],Ke={...fn};Ke.customerId=((Bt=ae[0])==null?void 0:Bt.id)||"",Ke.currency=((Yt=ae[0])==null?void 0:Yt.currency)||"USD",Ke.startDate=new Date().toISOString().slice(0,10),bt(Ke),wn(null),$r(!0)},children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Create Recurring Invoice"]})]}),Rr.data&&e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",(re-1)*Z+1," to ",Math.min(re*Z,Rr.data.total)," of ",Rr.data.total," recurring invoices"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("select",{className:"text-sm border rounded px-2 py-1",value:Z,onChange:ae=>{K(Number(ae.target.value)),le(1)},children:[e.jsx("option",{value:10,children:"10 per page"}),e.jsx("option",{value:20,children:"20 per page"}),e.jsx("option",{value:50,children:"50 per page"})]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>le(ae=>ae-1),disabled:!Rr.data.hasPrev||Rr.isLoading,children:"Previous"}),e.jsxs("div",{className:"text-sm",children:["Page ",re," of ",Rr.data.totalPages]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>le(ae=>ae+1),disabled:!Rr.data.hasNext||Rr.isLoading,children:"Next"})]})]})]})]})}),e.jsx(yt,{value:"approvals",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Invoices Pending Approval"})}),e.jsx(ie,{children:(()=>{const ae=(ot.data||f).filter(Ke=>Ke.status==="draft"||Ke.status==="sent");return ae.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(bs,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:ot.isLoading?"Loading invoices...":"No invoices pending approval"}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Total invoices: ",(ot.data||f).length]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-blue-600 mb-4",children:["Found ",ae.length," draft invoices for approval:"]}),ae.map((Ke,Bt)=>{var Yt;return e.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-2",children:["Invoice #",Ke.invoiceNumber||Ke.id]}),e.jsxs("div",{className:"text-sm text-gray-600 mb-3",children:[e.jsxs("p",{children:["Status: ",e.jsx("span",{className:"font-medium capitalize",children:Ke.status})]}),e.jsxs("p",{children:["Amount: ",e.jsxs("span",{className:"font-medium",children:["$",Ke.totalAmount||"N/A"]})]}),e.jsxs("p",{children:["Customer: ",e.jsx("span",{className:"font-medium",children:((Yt=(Array.isArray(p)?p:[]).find(Fs=>Fs.id===Ke.customerId))==null?void 0:Yt.name)||"N/A"})]}),e.jsxs("p",{children:["Due Date: ",e.jsx("span",{className:"font-medium",children:Ke.dueDate?new Date(Ke.dueDate).toLocaleDateString():"N/A"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[Ke.status==="draft"&&e.jsxs(I,{size:"sm",className:"bg-teal-600 hover:bg-teal-700",onClick:async()=>{try{await de.updateInvoice(Ke.id,{status:"sent"}),await Ur.invalidateQueries({queryKey:["invoices"]})}catch{}},children:[e.jsx(bs,{className:"w-4 h-4 mr-2"}),"Approve"]}),(Ke.status==="sent"||Ke.status==="pending")&&e.jsxs(I,{size:"sm",className:"bg-teal-600 hover:bg-teal-700",onClick:async()=>{try{await de.updateInvoice(Ke.id,{status:"paid",balanceDue:0}),await Ur.invalidateQueries({queryKey:["invoices"]})}catch{}},children:[e.jsx(bs,{className:"w-4 h-4 mr-2"}),"Mark Paid"]}),e.jsxs(I,{variant:"destructive",size:"sm",onClick:async()=>{try{await de.updateInvoice(Ke.id,{status:"cancelled"}),await Ur.invalidateQueries({queryKey:["invoices"]})}catch{}},children:[e.jsx(nc,{className:"w-4 h-4 mr-2"}),"Reject"]})]})]},Ke.id)})]})})()})]})}),e.jsx(yt,{value:"ai-create",className:"space-y-4",children:e.jsx(U$,{onInvoiceCreated:ae=>{Ur.invalidateQueries({queryKey:["invoices"]}),n({title:"Invoice created",description:`Invoice ${ae.invoiceNumber} created successfully!`})}})}),e.jsx(yt,{value:"ai-chat",className:"space-y-4",children:e.jsx(Aie,{onActionExecuted:(ae,Ke)=>{Ur.invalidateQueries({queryKey:["invoices"]}),Ur.invalidateQueries({queryKey:["expenses"]}),Ur.invalidateQueries({queryKey:["customers"]}),Ur.invalidateQueries({queryKey:["financial-insights"]}),n({title:"Success",description:`Action ${ae} executed successfully!`})}})})]})}),e.jsx(ts,{open:Ki,onOpenChange:ae=>{mi(ae),ae||(fi(null),Ne(""))},children:e.jsxs(ss,{className:"max-w-md",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Send Invoice PDF"}),e.jsx(Ks,{children:"Enter the recipient email address."})]}),e.jsxs("div",{className:"space-y-3 py-2",children:[e.jsx(B,{htmlFor:"send-email-to",children:"Email"}),e.jsx(ge,{id:"send-email-to",type:"email",placeholder:"name@example.com",value:qa,onChange:ae=>Ne(ae.target.value)})]}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:()=>mi(!1),disabled:Dt,children:"Cancel"}),e.jsx(I,{disabled:Dt||!Da||!qa,onClick:async()=>{if(!(!Da||!qa))try{ye(!0);const ae=f.find(Fs=>Fs.id===Da);if(!ae){n({title:"Invoice Not Found",description:"Could not find invoice data for email generation.",variant:"destructive"});return}const Ke=p.find(Fs=>Fs.id===ae.customerId),Yt=await new Pp({invoice:{id:ae.id,invoiceNumber:ae.invoiceNumber,issueDate:ae.issueDate,dueDate:ae.dueDate,status:ae.status,totalAmount:ae.totalAmount,balanceDue:ae.balanceDue,currency:(Ke==null?void 0:Ke.currency)||"USD",subtotal:ae.subtotal||ae.totalAmount,taxAmount:ae.taxAmount||0,discountAmount:ae.discountAmount||0,customer:Ke?{name:Ke.name,email:Ke.email,address:Ke.address,phone:Ke.phone,taxId:Ke.taxId}:void 0,lines:ae.lines||[],notes:ae.notes,paymentUrl:ae.paymentUrl},company:{name:"Your Company",logoUrl:void 0,primaryColor:"#009688",secondaryColor:"#1565c0",address:void 0,city:void 0,state:void 0,postalCode:void 0,email:void 0,phone:void 0,website:void 0,fontFamily:"Inter",invoiceTerms:"Payment is due within 30 days of invoice date.",invoiceFooter:"Thank you for your business!"}}).generate();console.log(" Frontend PDF Debug:",{pdfBlobSize:Yt.size,pdfBlobType:Yt.type,pdfBlobConstructor:Yt.constructor.name,invoiceId:ae.id,invoiceNumber:ae.invoiceNumber}),console.log(" About to call API service with:",{invoiceId:ae.id,to:qa,attachPdf:!0,hasPdfBlob:!!Yt}),await de.sendInvoiceEmail(ae.id,{to:qa,subject:`Invoice ${ae.invoiceNumber}`,message:`Please find your invoice ${ae.invoiceNumber} attached. Thank you for your business!`,attachPdf:!0,pdfBlob:Yt}),n({title:"Invoice sent",description:`Invoice ${ae.invoiceNumber} sent to ${qa}`}),mi(!1)}catch(ae){console.error("Error sending invoice email:",ae);try{await de.sendInvoiceEmail(Da,{to:qa,attachPdf:!0}),n({title:"Invoice sent",description:qa}),mi(!1)}catch(Ke){console.error("Backend email sending also failed:",Ke),n({title:"Send failed",description:(ae==null?void 0:ae.message)||"Failed to send",variant:"destructive"})}}finally{ye(!1)}},children:Dt?"Sending":"Send PDF"})]})]})}),e.jsx(ts,{open:Ir,onOpenChange:ae=>{jn(ae),!ae&&qn&&(URL.revokeObjectURL(qn),In(null))},children:e.jsxs(ss,{className:"!max-w-7xl max-h-[95vh] overflow-y-auto w-[95vw] md:max-h-[90vh] md:w-[90vw] flex flex-col",children:[e.jsxs(as,{className:"pb-6 border-b border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-600 to-green-700 rounded-xl flex items-center justify-center",children:e.jsx(ir,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx(is,{className:"text-2xl font-bold text-slate-900",children:"Invoice Preview"}),e.jsx(Ks,{className:"text-slate-600 mt-1",children:Hs?`Previewing Invoice ${Hs.invoiceNumber}`:"Loading invoice details..."})]})]}),Wr&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg text-blue-700 text-sm",children:"Loading invoice details..."})]}),!Wr&&Hs&&e.jsx("div",{className:"flex-1 overflow-y-auto max-h-[calc(95vh-200px)] md:max-h-[calc(90vh-200px)] scrollbar-thin scrollbar-thumb-slate-300 scrollbar-track-slate-100 hover:scrollbar-thumb-slate-400 relative",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6 py-6 pr-2",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-slate-50 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(Ts,{className:"w-5 h-5 text-green-600"}),"Quick Actions"]}),e.jsx("div",{className:"mb-6",children:e.jsx(Eie,{invoiceId:(Hs==null?void 0:Hs.id)||"",invoiceNumber:(Hs==null?void 0:Hs.invoiceNumber)||""})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Status"}),e.jsxs(rt,{value:wr,onValueChange:xa,children:[e.jsx(nt,{className:"h-12 bg-white border-slate-300",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"draft",children:"Draft"}),e.jsx(W,{value:"sent",children:"Sent"}),e.jsx(W,{value:"paid",children:"Paid"}),e.jsx(W,{value:"overdue",children:"Overdue"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Due Date"}),e.jsx(ge,{type:"date",value:cr,onChange:ae=>Zn(ae.target.value),className:"h-12 bg-white border-slate-300"})]}),e.jsx(I,{disabled:Hi,onClick:async()=>{try{Gi(!0),await de.updateInvoice(Hs.id,{status:wr,dueDate:cr||void 0}),await Ur.invalidateQueries({queryKey:["invoices"]}),qr(ae=>ae&&{...ae,status:wr,dueDate:cr})}finally{Gi(!1)}},className:"w-full h-12 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 shadow-lg hover:shadow-xl transition-all duration-200",children:Hi?e.jsxs(e.Fragment,{children:[e.jsx(On,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(bs,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(Zt,{className:"w-5 h-5 text-green-600"}),"Invoice Information"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-slate-200",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Invoice #:"}),e.jsx("span",{className:"text-sm font-semibold text-slate-900",children:Hs.invoiceNumber})]}),e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-slate-200",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Issue Date:"}),e.jsx("span",{className:"text-sm font-semibold text-slate-900",children:new Date(Hs.issueDate).toLocaleDateString()})]}),cr&&e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-slate-200",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Due Date:"}),e.jsx("span",{className:"text-sm font-semibold text-slate-900",children:new Date(cr).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-slate-200",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Total Amount:"}),e.jsx("span",{className:"text-sm font-bold text-slate-900",children:$n(Hs.totalAmount,Hs.currency||"USD")})]}),e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-sm font-medium text-slate-600",children:"Balance Due:"}),e.jsx("span",{className:"text-sm font-bold text-slate-900",children:$n(Hs.balanceDue,Hs.currency||"USD")})]})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(An,{className:"w-5 h-5 text-green-600"}),"Actions"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(I,{variant:"outline",className:"w-full h-12 justify-start",onClick:async()=>{try{await S(Hs,"preview")}catch(ae){n({title:"Preview failed",description:(ae==null?void 0:ae.message)||"Failed to preview PDF",variant:"destructive"})}},children:[e.jsx(ir,{className:"w-4 h-4 mr-2"}),"Preview PDF"]}),e.jsxs(I,{variant:"outline",className:"w-full h-12 justify-start",onClick:async()=>{try{await S(Hs,"download")}catch(ae){n({title:"Download failed",description:(ae==null?void 0:ae.message)||"Failed to download PDF",variant:"destructive"})}},children:[e.jsx(An,{className:"w-4 h-4 mr-2"}),"Download"]}),e.jsxs(I,{variant:"outline",className:"w-full h-12 justify-start",onClick:async()=>{try{const ae=await de.createPaymentLink(Hs.id);await navigator.clipboard.writeText(ae.url),n({title:"Payment link copied",description:ae.url})}catch(ae){n({title:"Create link failed",description:(ae==null?void 0:ae.message)||"Failed to create payment link",variant:"destructive"})}},children:[e.jsx(s1,{className:"w-4 h-4 mr-2"}),"Copy Payment Link"]})]})]})]}),e.jsx("div",{className:"lg:col-span-3 space-y-6",children:e.jsxs("div",{className:"bg-slate-50 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(Zt,{className:"w-5 h-5 text-green-600"}),"Invoice Template"]}),e.jsx("div",{className:"bg-white rounded-lg border border-slate-200 p-4",children:e.jsx(Cie,{invoice:{id:Hs.id,invoiceNumber:Hs.invoiceNumber,issueDate:Hs.issueDate,dueDate:cr||Hs.dueDate,status:wr||Hs.status,totalAmount:Hs.totalAmount,balanceDue:Hs.balanceDue,currency:((wt=(Array.isArray(p)?p:[]).find(ae=>ae.id===Hs.customerId))==null?void 0:wt.currency)||"USD",customer:(()=>{const ae=(Array.isArray(p)?p:[]).find(Ke=>Ke.id===Hs.customerId);return ae?{id:ae.id,name:ae.name,email:ae.email,address:ae.address}:void 0})(),lines:Hs.lines||[]},company:{name:((Qt=rn())==null?void 0:Qt.name)||"Your Company",email:((vs=rn())==null?void 0:vs.email)||"contact@yourcompany.com",phone:((Js=rn())==null?void 0:Js.phone)||"+1 (555) 123-4567",address:((je=rn())==null?void 0:je.address)||"123 Business St",city:((Ot=rn())==null?void 0:Ot.city)||"City",state:((Ds=rn())==null?void 0:Ds.state)||"State",postalCode:((ar=rn())==null?void 0:ar.postalCode)||"12345",website:((cn=rn())==null?void 0:cn.website)||"www.yourcompany.com",logoUrl:(Va=rn())==null?void 0:Va.logoUrl,showLogo:((Wn=rn())==null?void 0:Wn.showLogo)||!1,showWebsite:((ri=rn())==null?void 0:ri.showWebsite)||!1,showAddress:((Wa=rn())==null?void 0:Wa.showAddress)||!1,invoiceTerms:((vi=rn())==null?void 0:vi.invoiceTerms)||"Payment is due within 30 days of invoice date.",invoiceFooter:((pl=rn())==null?void 0:pl.invoiceFooter)||"Thank you for your business!",primaryColor:((Bl=rn())==null?void 0:Bl.primaryColor)||"#009688",secondaryColor:((_r=rn())==null?void 0:_r.secondaryColor)||"#1565c0",fontFamily:((Ha=rn())==null?void 0:Ha.fontFamily)||"Inter",invoiceTemplate:((io=rn())==null?void 0:io.invoiceTemplate)||"modern"},onDownloadPDF:async()=>{try{await S(Hs,"download")}catch(ae){n({title:"Download failed",description:(ae==null?void 0:ae.message)||"Failed to download PDF",variant:"destructive"})}},onPaymentSuccess:()=>{n({title:"Payment successful",description:"Invoice has been paid successfully"}),Ur.invalidateQueries({queryKey:["invoices"]})},onPaymentError:ae=>{n({title:"Payment failed",description:(ae==null?void 0:ae.message)||(ae==null?void 0:ae.toString())||"Payment could not be processed",variant:"destructive"})}})})]})})]})})]})}),e.jsx(ts,{open:Be,onOpenChange:Ft,children:e.jsxs(ss,{children:[e.jsx(as,{children:e.jsx(is,{children:"Create Credit Note"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Reason"}),e.jsx(Xs,{value:Kt,onChange:ae=>Jt(ae.target.value),rows:3}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(I,{variant:"outline",onClick:()=>Ft(!1),children:"Cancel"}),e.jsx(I,{onClick:async()=>{if(kt)try{const ae=Tie.NEXT_PUBLIC_API_URL||"";await(await fetch(`${ae}/api/credit-notes/${u}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")||""}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo"},body:JSON.stringify({invoiceId:kt,reason:Kt,lines:[{description:"Credit",quantity:1,unitPrice:0}]})})).json(),Ft(!1)}catch{}},children:"Create"})]})]})]})}),e.jsx(ts,{open:Yr,onOpenChange:$r,children:e.jsxs(ss,{className:"!max-w-7xl max-h-[95vh] overflow-y-auto w-[95vw] md:max-h-[90vh] md:w-[90vw]",children:[e.jsxs(as,{children:[e.jsx(is,{children:Vr?"Edit Recurring Invoice":"Create Recurring Invoice"}),e.jsx(Ks,{children:"Set up a recurring invoice template that will automatically generate invoices on schedule."})]}),e.jsx(P_,{formData:_t,onChange:bt,customers:p,isEditing:!!Vr}),ut&&e.jsx("div",{className:"text-red-600 text-sm",children:ut}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:()=>$r(!1),children:"Cancel"}),e.jsx(I,{disabled:Vn||!Yi(_t),onClick:async()=>{try{De(!0),Pe(null),Vr?await zo.mutateAsync({id:Vr.id,data:_t}):await Ll.mutateAsync(_t)}catch(ae){Pe((ae==null?void 0:ae.message)||"Failed to save recurring invoice")}finally{De(!1)}},children:Vn?"Saving...":Vr?"Update":"Create"})]})]})}),e.jsx(ts,{open:Me,onOpenChange:tt,children:e.jsxs(ss,{className:"!max-w-7xl max-h-[95vh] overflow-y-auto w-[95vw] md:max-h-[90vh] md:w-[90vw]",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Recurring Invoice Details"}),e.jsx(Ks,{children:"View details and generated invoices for this recurring template."})]}),ve&&e.jsxs("div",{className:"space-y-6",children:[(()=>{const ae=(ve.lines||[]).map(Yt=>({description:Yt.description||"",quantity:Number(Yt.quantity)||0,unitPrice:Number(Yt.unitPrice)||0,taxRate:Number(Yt.taxRate)||0})),Ke=us(ae),Bt={customerId:ve.customerId,name:ve.name,description:ve.description||"",frequency:ve.frequency,interval:ve.interval||1,startDate:(ve.startDate||"").slice(0,10),endDate:ve.endDate?ve.endDate.slice(0,10):"",currency:ve.currency||"USD",notes:ve.notes||"",terms:ve.terms||"",dueDateOffset:ve.dueDateOffset||0,autoSend:!!ve.autoSend,emailTemplate:ve.emailTemplate||"",dayOfWeek:void 0,dayOfMonth:void 0,businessDaysOnly:!1,skipHolidays:!1,timezone:"UTC",skipIfOutstandingBalance:!1,maxOutstandingAmount:void 0,skipIfCustomerInactive:!1,requireApproval:!1,approvalWorkflowId:void 0,ccEmails:[],bccEmails:[],reminderDays:[],lines:ae,subtotal:Ke.subtotal,taxTotal:Ke.taxTotal,totalAmount:Ke.totalAmount};return e.jsx(P_,{formData:Bt,onChange:()=>{},customers:p,isEditing:!1,readOnly:!0})})(),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-semibold",children:"Generated Invoices"}),e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>_o(ve.id),disabled:dt,children:[dt?e.jsx(On,{className:"w-4 h-4 animate-spin mr-2"}):e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Refresh"]})]}),dt?e.jsxs("div",{className:"text-center py-4",children:[e.jsx(On,{className:"w-6 h-6 animate-spin mx-auto"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Loading invoice history..."})]}):fe.length>0?e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:fe.map(ae=>{var Ke;return e.jsxs("div",{className:"flex justify-between items-center p-3 border rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:ae.invoiceNumber}),e.jsxs("p",{className:"text-sm text-gray-500",children:[new Date(ae.createdAt).toLocaleDateString(),"  Status: ",e.jsx(Oe,{variant:"outline",className:"ml-1",children:ae.status})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold",children:$n(ae.totalAmount,ae.currency)}),((Ke=ae.payments)==null?void 0:Ke.length)>0&&e.jsxs("p",{className:"text-sm text-green-600",children:[ae.payments.length," payment(s)"]})]})]},ae.id)})}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Zt,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No invoices generated yet"})]})]})]})]})})]})}):e.jsx(Kr,{children:e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"h-6 w-48 bg-muted rounded"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[0,1,2,3].map(ae=>e.jsx(ne,{children:e.jsx(ie,{className:"p-6",children:e.jsx("div",{className:"h-10 bg-muted rounded"})})},ae))})]})})}function l3({tabs:s,value:t,onChange:r,className:n}){return e.jsx("div",{className:ns("bg-white rounded-lg shadow-sm border p-4",n),children:e.jsx("div",{className:"flex space-x-6 overflow-x-auto",children:s.map(a=>{const i=a.icon,o=t===a.id;return e.jsxs("button",{onClick:()=>r(a.id),className:ns("flex items-center space-x-2 py-2 px-1 border-b-2 font-medium text-sm whitespace-nowrap",o?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),"aria-current":o?"page":void 0,children:[i?e.jsx(i,{className:"w-4 h-4"}):null,e.jsx("span",{children:a.label})]},a.id)})})})}function Ol({className:s,...t}){return e.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:e.jsx("table",{"data-slot":"table",className:ns("w-full caption-bottom text-sm",s),...t})})}function Rl({className:s,...t}){return e.jsx("thead",{"data-slot":"table-header",className:ns("[&_tr]:border-b",s),...t})}function Fl({className:s,...t}){return e.jsx("tbody",{"data-slot":"table-body",className:ns("[&_tr:last-child]:border-0",s),...t})}function Dn({className:s,...t}){return e.jsx("tr",{"data-slot":"table-row",className:ns("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",s),...t})}function _s({className:s,...t}){return e.jsx("th",{"data-slot":"table-head",className:ns("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...t})}function Cs({className:s,...t}){return e.jsx("td",{"data-slot":"table-cell",className:ns("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...t})}var ly=s=>s.type==="checkbox",Nf=s=>s instanceof Date,Il=s=>s==null;const z$=s=>typeof s=="object";var Wi=s=>!Il(s)&&!Array.isArray(s)&&z$(s)&&!Nf(s),q$=s=>Wi(s)&&s.target?ly(s.target)?s.target.checked:s.target.value:s,Oie=s=>s.substring(0,s.search(/\.\d+(\.|$)/))||s,V$=(s,t)=>s.has(Oie(t)),Rie=s=>{const t=s.constructor&&s.constructor.prototype;return Wi(t)&&t.hasOwnProperty("isPrototypeOf")},c3=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function mo(s){let t;const r=Array.isArray(s),n=typeof FileList<"u"?s instanceof FileList:!1;if(s instanceof Date)t=new Date(s);else if(!(c3&&(s instanceof Blob||n))&&(r||Wi(s)))if(t=r?[]:Object.create(Object.getPrototypeOf(s)),!r&&!Rie(s))t=s;else for(const a in s)s.hasOwnProperty(a)&&(t[a]=mo(s[a]));else return s;return t}var vN=s=>/^\w*$/.test(s),$i=s=>s===void 0,d3=s=>Array.isArray(s)?s.filter(Boolean):[],u3=s=>d3(s.replace(/["|']|\]/g,"").split(/\.|\[/)),Ys=(s,t,r)=>{if(!t||!Wi(s))return r;const n=(vN(t)?[t]:u3(t)).reduce((a,i)=>Il(a)?a:a[i],s);return $i(n)||n===s?$i(s[t])?r:s[t]:n},wc=s=>typeof s=="boolean",ya=(s,t,r)=>{let n=-1;const a=vN(t)?[t]:u3(t),i=a.length,o=i-1;for(;++n<i;){const l=a[n];let c=r;if(n!==o){const d=s[l];c=Wi(d)||Array.isArray(d)?d:isNaN(+a[n+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;s[l]=c,s=s[l]}};const p1={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Cd={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Du={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},h3=xe.createContext(null);h3.displayName="HookFormContext";const yN=()=>xe.useContext(h3),Fie=s=>{const{children:t,...r}=s;return xe.createElement(h3.Provider,{value:r},t)};var W$=(s,t,r,n=!0)=>{const a={defaultValues:t._defaultValues};for(const i in s)Object.defineProperty(a,i,{get:()=>{const o=i;return t._proxyFormState[o]!==Cd.all&&(t._proxyFormState[o]=!n||Cd.all),r&&(r[o]=!0),s[o]}});return a};const m3=typeof window<"u"?xe.useLayoutEffect:xe.useEffect;function H$(s){const t=yN(),{control:r=t.control,disabled:n,name:a,exact:i}=s||{},[o,l]=xe.useState(r._formState),c=xe.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return m3(()=>r._subscribe({name:a,formState:c.current,exact:i,callback:d=>{!n&&l({...r._formState,...d})}}),[a,n,i]),xe.useEffect(()=>{c.current.isValid&&r._setValid(!0)},[r]),xe.useMemo(()=>W$(o,r,c.current,!1),[o,r])}var au=s=>typeof s=="string",G$=(s,t,r,n,a)=>au(s)?(n&&t.watch.add(s),Ys(r,s,a)):Array.isArray(s)?s.map(i=>(n&&t.watch.add(i),Ys(r,i))):(n&&(t.watchAll=!0),r),o4=s=>Il(s)||!z$(s);function Vu(s,t,r=new WeakSet){if(o4(s)||o4(t))return s===t;if(Nf(s)&&Nf(t))return s.getTime()===t.getTime();const n=Object.keys(s),a=Object.keys(t);if(n.length!==a.length)return!1;if(r.has(s)||r.has(t))return!0;r.add(s),r.add(t);for(const i of n){const o=s[i];if(!a.includes(i))return!1;if(i!=="ref"){const l=t[i];if(Nf(o)&&Nf(l)||Wi(o)&&Wi(l)||Array.isArray(o)&&Array.isArray(l)?!Vu(o,l,r):o!==l)return!1}}return!0}function Mie(s){const t=yN(),{control:r=t.control,name:n,defaultValue:a,disabled:i,exact:o,compute:l}=s||{},c=xe.useRef(a),d=xe.useRef(l),u=xe.useRef(void 0);d.current=l;const h=xe.useMemo(()=>r._getWatch(n,c.current),[r,n]),[f,m]=xe.useState(d.current?d.current(h):h);return m3(()=>r._subscribe({name:n,formState:{values:!0},exact:o,callback:p=>{if(!i){const g=G$(n,r._names,p.values||r._formValues,!1,c.current);if(d.current){const v=d.current(g);Vu(v,u.current)||(m(v),u.current=v)}else m(g)}}}),[r,i,n,o]),xe.useEffect(()=>r._removeUnmounted()),f}function Lie(s){const t=yN(),{name:r,disabled:n,control:a=t.control,shouldUnregister:i,defaultValue:o}=s,l=V$(a._names.array,r),c=xe.useMemo(()=>Ys(a._formValues,r,Ys(a._defaultValues,r,o)),[a,r,o]),d=Mie({control:a,name:r,defaultValue:c,exact:!0}),u=H$({control:a,name:r,exact:!0}),h=xe.useRef(s),f=xe.useRef(a.register(r,{...s.rules,value:d,...wc(s.disabled)?{disabled:s.disabled}:{}}));h.current=s;const m=xe.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Ys(u.errors,r)},isDirty:{enumerable:!0,get:()=>!!Ys(u.dirtyFields,r)},isTouched:{enumerable:!0,get:()=>!!Ys(u.touchedFields,r)},isValidating:{enumerable:!0,get:()=>!!Ys(u.validatingFields,r)},error:{enumerable:!0,get:()=>Ys(u.errors,r)}}),[u,r]),p=xe.useCallback(j=>f.current.onChange({target:{value:q$(j),name:r},type:p1.CHANGE}),[r]),g=xe.useCallback(()=>f.current.onBlur({target:{value:Ys(a._formValues,r),name:r},type:p1.BLUR}),[r,a._formValues]),v=xe.useCallback(j=>{const b=Ys(a._fields,r);b&&j&&(b._f.ref={focus:()=>j.focus&&j.focus(),select:()=>j.select&&j.select(),setCustomValidity:w=>j.setCustomValidity(w),reportValidity:()=>j.reportValidity()})},[a._fields,r]),y=xe.useMemo(()=>({name:r,value:d,...wc(n)||u.disabled?{disabled:u.disabled||n}:{},onChange:p,onBlur:g,ref:v}),[r,n,u.disabled,p,g,v,d]);return xe.useEffect(()=>{const j=a._options.shouldUnregister||i;a.register(r,{...h.current.rules,...wc(h.current.disabled)?{disabled:h.current.disabled}:{}});const b=(w,N)=>{const C=Ys(a._fields,w);C&&C._f&&(C._f.mount=N)};if(b(r,!0),j){const w=mo(Ys(a._options.defaultValues,r));ya(a._defaultValues,r,w),$i(Ys(a._formValues,r))&&ya(a._formValues,r,w)}return!l&&a.register(r),()=>{(l?j&&!a._state.action:j)?a.unregister(r):b(r,!1)}},[r,a,l,i]),xe.useEffect(()=>{a._setDisabledField({disabled:n,name:r})},[n,r,a]),xe.useMemo(()=>({field:y,formState:u,fieldState:m}),[y,u,m])}const $ie=s=>s.render(Lie(s));var f3=(s,t,r,n,a)=>t?{...r[s],types:{...r[s]&&r[s].types?r[s].types:{},[n]:a||!0}}:{},B0=s=>Array.isArray(s)?s:[s],__=()=>{let s=[];return{get observers(){return s},next:a=>{for(const i of s)i.next&&i.next(a)},subscribe:a=>(s.push(a),{unsubscribe:()=>{s=s.filter(i=>i!==a)}}),unsubscribe:()=>{s=[]}}},Jl=s=>Wi(s)&&!Object.keys(s).length,x3=s=>s.type==="file",Ad=s=>typeof s=="function",g1=s=>{if(!c3)return!1;const t=s?s.ownerDocument:0;return s instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},K$=s=>s.type==="select-multiple",p3=s=>s.type==="radio",Bie=s=>p3(s)||ly(s),z2=s=>g1(s)&&s.isConnected;function Uie(s,t){const r=t.slice(0,-1).length;let n=0;for(;n<r;)s=$i(s)?n++:s[t[n++]];return s}function zie(s){for(const t in s)if(s.hasOwnProperty(t)&&!$i(s[t]))return!1;return!0}function Qi(s,t){const r=Array.isArray(t)?t:vN(t)?[t]:u3(t),n=r.length===1?s:Uie(s,r),a=r.length-1,i=r[a];return n&&delete n[i],a!==0&&(Wi(n)&&Jl(n)||Array.isArray(n)&&zie(n))&&Qi(s,r.slice(0,-1)),s}var Y$=s=>{for(const t in s)if(Ad(s[t]))return!0;return!1};function v1(s,t={}){const r=Array.isArray(s);if(Wi(s)||r)for(const n in s)Array.isArray(s[n])||Wi(s[n])&&!Y$(s[n])?(t[n]=Array.isArray(s[n])?[]:{},v1(s[n],t[n])):Il(s[n])||(t[n]=!0);return t}function J$(s,t,r){const n=Array.isArray(s);if(Wi(s)||n)for(const a in s)Array.isArray(s[a])||Wi(s[a])&&!Y$(s[a])?$i(t)||o4(r[a])?r[a]=Array.isArray(s[a])?v1(s[a],[]):{...v1(s[a])}:J$(s[a],Il(t)?{}:t[a],r[a]):r[a]=!Vu(s[a],t[a]);return r}var t0=(s,t)=>J$(s,t,v1(t));const k_={value:!1,isValid:!1},T_={value:!0,isValid:!0};var X$=s=>{if(Array.isArray(s)){if(s.length>1){const t=s.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:t,isValid:!!t.length}}return s[0].checked&&!s[0].disabled?s[0].attributes&&!$i(s[0].attributes.value)?$i(s[0].value)||s[0].value===""?T_:{value:s[0].value,isValid:!0}:T_:k_}return k_},Q$=(s,{valueAsNumber:t,valueAsDate:r,setValueAs:n})=>$i(s)?s:t?s===""?NaN:s&&+s:r&&au(s)?new Date(s):n?n(s):s;const D_={isValid:!1,value:null};var Z$=s=>Array.isArray(s)?s.reduce((t,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:t,D_):D_;function O_(s){const t=s.ref;return x3(t)?t.files:p3(t)?Z$(s.refs).value:K$(t)?[...t.selectedOptions].map(({value:r})=>r):ly(t)?X$(s.refs).value:Q$($i(t.value)?s.ref.value:t.value,s)}var qie=(s,t,r,n)=>{const a={};for(const i of s){const o=Ys(t,i);o&&ya(a,i,o._f)}return{criteriaMode:r,names:[...s],fields:a,shouldUseNativeValidation:n}},y1=s=>s instanceof RegExp,s0=s=>$i(s)?s:y1(s)?s.source:Wi(s)?y1(s.value)?s.value.source:s.value:s,R_=s=>({isOnSubmit:!s||s===Cd.onSubmit,isOnBlur:s===Cd.onBlur,isOnChange:s===Cd.onChange,isOnAll:s===Cd.all,isOnTouch:s===Cd.onTouched});const F_="AsyncFunction";var Vie=s=>!!s&&!!s.validate&&!!(Ad(s.validate)&&s.validate.constructor.name===F_||Wi(s.validate)&&Object.values(s.validate).find(t=>t.constructor.name===F_)),Wie=s=>s.mount&&(s.required||s.min||s.max||s.maxLength||s.minLength||s.pattern||s.validate),M_=(s,t,r)=>!r&&(t.watchAll||t.watch.has(s)||[...t.watch].some(n=>s.startsWith(n)&&/^\.\w+/.test(s.slice(n.length))));const U0=(s,t,r,n)=>{for(const a of r||Object.keys(s)){const i=Ys(s,a);if(i){const{_f:o,...l}=i;if(o){if(o.refs&&o.refs[0]&&t(o.refs[0],a)&&!n)return!0;if(o.ref&&t(o.ref,o.name)&&!n)return!0;if(U0(l,t))break}else if(Wi(l)&&U0(l,t))break}}};function L_(s,t,r){const n=Ys(s,r);if(n||vN(r))return{error:n,name:r};const a=r.split(".");for(;a.length;){const i=a.join("."),o=Ys(t,i),l=Ys(s,i);if(o&&!Array.isArray(o)&&r!==i)return{name:r};if(l&&l.type)return{name:i,error:l};if(l&&l.root&&l.root.type)return{name:`${i}.root`,error:l.root};a.pop()}return{name:r}}var Hie=(s,t,r,n)=>{r(s);const{name:a,...i}=s;return Jl(i)||Object.keys(i).length>=Object.keys(t).length||Object.keys(i).find(o=>t[o]===(!n||Cd.all))},Gie=(s,t,r)=>!s||!t||s===t||B0(s).some(n=>n&&(r?n===t:n.startsWith(t)||t.startsWith(n))),Kie=(s,t,r,n,a)=>a.isOnAll?!1:!r&&a.isOnTouch?!(t||s):(r?n.isOnBlur:a.isOnBlur)?!s:(r?n.isOnChange:a.isOnChange)?s:!0,Yie=(s,t)=>!d3(Ys(s,t)).length&&Qi(s,t),Jie=(s,t,r)=>{const n=B0(Ys(s,r));return ya(n,"root",t[r]),ya(s,r,n),s},qj=s=>au(s);function $_(s,t,r="validate"){if(qj(s)||Array.isArray(s)&&s.every(qj)||wc(s)&&!s)return{type:r,message:qj(s)?s:"",ref:t}}var _x=s=>Wi(s)&&!y1(s)?s:{value:s,message:""},B_=async(s,t,r,n,a,i)=>{const{ref:o,refs:l,required:c,maxLength:d,minLength:u,min:h,max:f,pattern:m,validate:p,name:g,valueAsNumber:v,mount:y}=s._f,j=Ys(r,g);if(!y||t.has(g))return{};const b=l?l[0]:o,w=T=>{a&&b.reportValidity&&(b.setCustomValidity(wc(T)?"":T||""),b.reportValidity())},N={},C=p3(o),S=ly(o),_=C||S,k=(v||x3(o))&&$i(o.value)&&$i(j)||g1(o)&&o.value===""||j===""||Array.isArray(j)&&!j.length,F=f3.bind(null,g,n,N),A=(T,V,M,G=Du.maxLength,L=Du.minLength)=>{const J=T?V:M;N[g]={type:T?G:L,message:J,ref:o,...F(T?G:L,J)}};if(i?!Array.isArray(j)||!j.length:c&&(!_&&(k||Il(j))||wc(j)&&!j||S&&!X$(l).isValid||C&&!Z$(l).isValid)){const{value:T,message:V}=qj(c)?{value:!!c,message:c}:_x(c);if(T&&(N[g]={type:Du.required,message:V,ref:b,...F(Du.required,V)},!n))return w(V),N}if(!k&&(!Il(h)||!Il(f))){let T,V;const M=_x(f),G=_x(h);if(!Il(j)&&!isNaN(j)){const L=o.valueAsNumber||j&&+j;Il(M.value)||(T=L>M.value),Il(G.value)||(V=L<G.value)}else{const L=o.valueAsDate||new Date(j),J=oe=>new Date(new Date().toDateString()+" "+oe),z=o.type=="time",U=o.type=="week";au(M.value)&&j&&(T=z?J(j)>J(M.value):U?j>M.value:L>new Date(M.value)),au(G.value)&&j&&(V=z?J(j)<J(G.value):U?j<G.value:L<new Date(G.value))}if((T||V)&&(A(!!T,M.message,G.message,Du.max,Du.min),!n))return w(N[g].message),N}if((d||u)&&!k&&(au(j)||i&&Array.isArray(j))){const T=_x(d),V=_x(u),M=!Il(T.value)&&j.length>+T.value,G=!Il(V.value)&&j.length<+V.value;if((M||G)&&(A(M,T.message,V.message),!n))return w(N[g].message),N}if(m&&!k&&au(j)){const{value:T,message:V}=_x(m);if(y1(T)&&!j.match(T)&&(N[g]={type:Du.pattern,message:V,ref:o,...F(Du.pattern,V)},!n))return w(V),N}if(p){if(Ad(p)){const T=await p(j,r),V=$_(T,b);if(V&&(N[g]={...V,...F(Du.validate,V.message)},!n))return w(V.message),N}else if(Wi(p)){let T={};for(const V in p){if(!Jl(T)&&!n)break;const M=$_(await p[V](j,r),b,V);M&&(T={...M,...F(V,M.message)},w(M.message),n&&(N[g]=T))}if(!Jl(T)&&(N[g]={ref:b,...T},!n))return N}}return w(!0),N};const Xie={mode:Cd.onSubmit,reValidateMode:Cd.onChange,shouldFocusError:!0};function Qie(s={}){let t={...Xie,...s},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:Ad(t.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1},n={},a=Wi(t.defaultValues)||Wi(t.values)?mo(t.defaultValues||t.values)||{}:{},i=t.shouldUnregister?{}:mo(a),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,d=0;const u={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let h={...u};const f={array:__(),state:__()},m=t.criteriaMode===Cd.all,p=Y=>ue=>{clearTimeout(d),d=setTimeout(Y,ue)},g=async Y=>{if(!t.disabled&&(u.isValid||h.isValid||Y)){const ue=t.resolver?Jl((await S()).errors):await k(n,!0);ue!==r.isValid&&f.state.next({isValid:ue})}},v=(Y,ue)=>{!t.disabled&&(u.isValidating||u.validatingFields||h.isValidating||h.validatingFields)&&((Y||Array.from(l.mount)).forEach(ve=>{ve&&(ue?ya(r.validatingFields,ve,ue):Qi(r.validatingFields,ve))}),f.state.next({validatingFields:r.validatingFields,isValidating:!Jl(r.validatingFields)}))},y=(Y,ue=[],ve,Le,Me=!0,tt=!0)=>{if(Le&&ve&&!t.disabled){if(o.action=!0,tt&&Array.isArray(Ys(n,Y))){const fe=ve(Ys(n,Y),Le.argA,Le.argB);Me&&ya(n,Y,fe)}if(tt&&Array.isArray(Ys(r.errors,Y))){const fe=ve(Ys(r.errors,Y),Le.argA,Le.argB);Me&&ya(r.errors,Y,fe),Yie(r.errors,Y)}if((u.touchedFields||h.touchedFields)&&tt&&Array.isArray(Ys(r.touchedFields,Y))){const fe=ve(Ys(r.touchedFields,Y),Le.argA,Le.argB);Me&&ya(r.touchedFields,Y,fe)}(u.dirtyFields||h.dirtyFields)&&(r.dirtyFields=t0(a,i)),f.state.next({name:Y,isDirty:A(Y,ue),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else ya(i,Y,ue)},j=(Y,ue)=>{ya(r.errors,Y,ue),f.state.next({errors:r.errors})},b=Y=>{r.errors=Y,f.state.next({errors:r.errors,isValid:!1})},w=(Y,ue,ve,Le)=>{const Me=Ys(n,Y);if(Me){const tt=Ys(i,Y,$i(ve)?Ys(a,Y):ve);$i(tt)||Le&&Le.defaultChecked||ue?ya(i,Y,ue?tt:O_(Me._f)):M(Y,tt),o.mount&&g()}},N=(Y,ue,ve,Le,Me)=>{let tt=!1,fe=!1;const ct={name:Y};if(!t.disabled){if(!ve||Le){(u.isDirty||h.isDirty)&&(fe=r.isDirty,r.isDirty=ct.isDirty=A(),tt=fe!==ct.isDirty);const dt=Vu(Ys(a,Y),ue);fe=!!Ys(r.dirtyFields,Y),dt?Qi(r.dirtyFields,Y):ya(r.dirtyFields,Y,!0),ct.dirtyFields=r.dirtyFields,tt=tt||(u.dirtyFields||h.dirtyFields)&&fe!==!dt}if(ve){const dt=Ys(r.touchedFields,Y);dt||(ya(r.touchedFields,Y,ve),ct.touchedFields=r.touchedFields,tt=tt||(u.touchedFields||h.touchedFields)&&dt!==ve)}tt&&Me&&f.state.next(ct)}return tt?ct:{}},C=(Y,ue,ve,Le)=>{const Me=Ys(r.errors,Y),tt=(u.isValid||h.isValid)&&wc(ue)&&r.isValid!==ue;if(t.delayError&&ve?(c=p(()=>j(Y,ve)),c(t.delayError)):(clearTimeout(d),c=null,ve?ya(r.errors,Y,ve):Qi(r.errors,Y)),(ve?!Vu(Me,ve):Me)||!Jl(Le)||tt){const fe={...Le,...tt&&wc(ue)?{isValid:ue}:{},errors:r.errors,name:Y};r={...r,...fe},f.state.next(fe)}},S=async Y=>{v(Y,!0);const ue=await t.resolver(i,t.context,qie(Y||l.mount,n,t.criteriaMode,t.shouldUseNativeValidation));return v(Y),ue},_=async Y=>{const{errors:ue}=await S(Y);if(Y)for(const ve of Y){const Le=Ys(ue,ve);Le?ya(r.errors,ve,Le):Qi(r.errors,ve)}else r.errors=ue;return ue},k=async(Y,ue,ve={valid:!0})=>{for(const Le in Y){const Me=Y[Le];if(Me){const{_f:tt,...fe}=Me;if(tt){const ct=l.array.has(tt.name),dt=Me._f&&Vie(Me._f);dt&&u.validatingFields&&v([Le],!0);const pt=await B_(Me,l.disabled,i,m,t.shouldUseNativeValidation&&!ue,ct);if(dt&&u.validatingFields&&v([Le]),pt[tt.name]&&(ve.valid=!1,ue))break;!ue&&(Ys(pt,tt.name)?ct?Jie(r.errors,pt,tt.name):ya(r.errors,tt.name,pt[tt.name]):Qi(r.errors,tt.name))}!Jl(fe)&&await k(fe,ue,ve)}}return ve.valid},F=()=>{for(const Y of l.unMount){const ue=Ys(n,Y);ue&&(ue._f.refs?ue._f.refs.every(ve=>!z2(ve)):!z2(ue._f.ref))&&be(Y)}l.unMount=new Set},A=(Y,ue)=>!t.disabled&&(Y&&ue&&ya(i,Y,ue),!Vu(oe(),a)),T=(Y,ue,ve)=>G$(Y,l,{...o.mount?i:$i(ue)?a:au(Y)?{[Y]:ue}:ue},ve,ue),V=Y=>d3(Ys(o.mount?i:a,Y,t.shouldUnregister?Ys(a,Y,[]):[])),M=(Y,ue,ve={})=>{const Le=Ys(n,Y);let Me=ue;if(Le){const tt=Le._f;tt&&(!tt.disabled&&ya(i,Y,Q$(ue,tt)),Me=g1(tt.ref)&&Il(ue)?"":ue,K$(tt.ref)?[...tt.ref.options].forEach(fe=>fe.selected=Me.includes(fe.value)):tt.refs?ly(tt.ref)?tt.refs.forEach(fe=>{(!fe.defaultChecked||!fe.disabled)&&(Array.isArray(Me)?fe.checked=!!Me.find(ct=>ct===fe.value):fe.checked=Me===fe.value||!!Me)}):tt.refs.forEach(fe=>fe.checked=fe.value===Me):x3(tt.ref)?tt.ref.value="":(tt.ref.value=Me,tt.ref.type||f.state.next({name:Y,values:mo(i)})))}(ve.shouldDirty||ve.shouldTouch)&&N(Y,Me,ve.shouldTouch,ve.shouldDirty,!0),ve.shouldValidate&&U(Y)},G=(Y,ue,ve)=>{for(const Le in ue){if(!ue.hasOwnProperty(Le))return;const Me=ue[Le],tt=Y+"."+Le,fe=Ys(n,tt);(l.array.has(Y)||Wi(Me)||fe&&!fe._f)&&!Nf(Me)?G(tt,Me,ve):M(tt,Me,ve)}},L=(Y,ue,ve={})=>{const Le=Ys(n,Y),Me=l.array.has(Y),tt=mo(ue);ya(i,Y,tt),Me?(f.array.next({name:Y,values:mo(i)}),(u.isDirty||u.dirtyFields||h.isDirty||h.dirtyFields)&&ve.shouldDirty&&f.state.next({name:Y,dirtyFields:t0(a,i),isDirty:A(Y,tt)})):Le&&!Le._f&&!Il(tt)?G(Y,tt,ve):M(Y,tt,ve),M_(Y,l)&&f.state.next({...r,name:Y}),f.state.next({name:o.mount?Y:void 0,values:mo(i)})},J=async Y=>{o.mount=!0;const ue=Y.target;let ve=ue.name,Le=!0;const Me=Ys(n,ve),tt=dt=>{Le=Number.isNaN(dt)||Nf(dt)&&isNaN(dt.getTime())||Vu(dt,Ys(i,ve,dt))},fe=R_(t.mode),ct=R_(t.reValidateMode);if(Me){let dt,pt;const qe=ue.type?O_(Me._f):q$(Y),mt=Y.type===p1.BLUR||Y.type===p1.FOCUS_OUT,Rt=!Wie(Me._f)&&!t.resolver&&!Ys(r.errors,ve)&&!Me._f.deps||Kie(mt,Ys(r.touchedFields,ve),r.isSubmitted,ct,fe),_e=M_(ve,l,mt);ya(i,ve,qe),mt?(!ue||!ue.readOnly)&&(Me._f.onBlur&&Me._f.onBlur(Y),c&&c(0)):Me._f.onChange&&Me._f.onChange(Y);const Xe=N(ve,qe,mt),At=!Jl(Xe)||_e;if(!mt&&f.state.next({name:ve,type:Y.type,values:mo(i)}),Rt)return(u.isValid||h.isValid)&&(t.mode==="onBlur"?mt&&g():mt||g()),At&&f.state.next({name:ve,..._e?{}:Xe});if(!mt&&_e&&f.state.next({...r}),t.resolver){const{errors:st}=await S([ve]);if(tt(qe),Le){const $t=L_(r.errors,n,ve),fs=L_(st,n,$t.name||ve);dt=fs.error,ve=fs.name,pt=Jl(st)}}else v([ve],!0),dt=(await B_(Me,l.disabled,i,m,t.shouldUseNativeValidation))[ve],v([ve]),tt(qe),Le&&(dt?pt=!1:(u.isValid||h.isValid)&&(pt=await k(n,!0)));Le&&(Me._f.deps&&U(Me._f.deps),C(ve,pt,dt,Xe))}},z=(Y,ue)=>{if(Ys(r.errors,ue)&&Y.focus)return Y.focus(),1},U=async(Y,ue={})=>{let ve,Le;const Me=B0(Y);if(t.resolver){const tt=await _($i(Y)?Y:Me);ve=Jl(tt),Le=Y?!Me.some(fe=>Ys(tt,fe)):ve}else Y?(Le=(await Promise.all(Me.map(async tt=>{const fe=Ys(n,tt);return await k(fe&&fe._f?{[tt]:fe}:fe)}))).every(Boolean),!(!Le&&!r.isValid)&&g()):Le=ve=await k(n);return f.state.next({...!au(Y)||(u.isValid||h.isValid)&&ve!==r.isValid?{}:{name:Y},...t.resolver||!Y?{isValid:ve}:{},errors:r.errors}),ue.shouldFocus&&!Le&&U0(n,z,Y?Me:l.mount),Le},oe=Y=>{const ue={...o.mount?i:a};return $i(Y)?ue:au(Y)?Ys(ue,Y):Y.map(ve=>Ys(ue,ve))},Q=(Y,ue)=>({invalid:!!Ys((ue||r).errors,Y),isDirty:!!Ys((ue||r).dirtyFields,Y),error:Ys((ue||r).errors,Y),isValidating:!!Ys(r.validatingFields,Y),isTouched:!!Ys((ue||r).touchedFields,Y)}),P=Y=>{Y&&B0(Y).forEach(ue=>Qi(r.errors,ue)),f.state.next({errors:Y?r.errors:{}})},q=(Y,ue,ve)=>{const Le=(Ys(n,Y,{_f:{}})._f||{}).ref,Me=Ys(r.errors,Y)||{},{ref:tt,message:fe,type:ct,...dt}=Me;ya(r.errors,Y,{...dt,...ue,ref:Le}),f.state.next({name:Y,errors:r.errors,isValid:!1}),ve&&ve.shouldFocus&&Le&&Le.focus&&Le.focus()},D=(Y,ue)=>Ad(Y)?f.state.subscribe({next:ve=>"values"in ve&&Y(T(void 0,ue),ve)}):T(Y,ue,!0),se=Y=>f.state.subscribe({next:ue=>{Gie(Y.name,ue.name,Y.exact)&&Hie(ue,Y.formState||u,K,Y.reRenderRoot)&&Y.callback({values:{...i},...r,...ue,defaultValues:a})}}).unsubscribe,he=Y=>(o.mount=!0,h={...h,...Y.formState},se({...Y,formState:h})),be=(Y,ue={})=>{for(const ve of Y?B0(Y):l.mount)l.mount.delete(ve),l.array.delete(ve),ue.keepValue||(Qi(n,ve),Qi(i,ve)),!ue.keepError&&Qi(r.errors,ve),!ue.keepDirty&&Qi(r.dirtyFields,ve),!ue.keepTouched&&Qi(r.touchedFields,ve),!ue.keepIsValidating&&Qi(r.validatingFields,ve),!t.shouldUnregister&&!ue.keepDefaultValue&&Qi(a,ve);f.state.next({values:mo(i)}),f.state.next({...r,...ue.keepDirty?{isDirty:A()}:{}}),!ue.keepIsValid&&g()},pe=({disabled:Y,name:ue})=>{(wc(Y)&&o.mount||Y||l.disabled.has(ue))&&(Y?l.disabled.add(ue):l.disabled.delete(ue))},Ae=(Y,ue={})=>{let ve=Ys(n,Y);const Le=wc(ue.disabled)||wc(t.disabled);return ya(n,Y,{...ve||{},_f:{...ve&&ve._f?ve._f:{ref:{name:Y}},name:Y,mount:!0,...ue}}),l.mount.add(Y),ve?pe({disabled:wc(ue.disabled)?ue.disabled:t.disabled,name:Y}):w(Y,!0,ue.value),{...Le?{disabled:ue.disabled||t.disabled}:{},...t.progressive?{required:!!ue.required,min:s0(ue.min),max:s0(ue.max),minLength:s0(ue.minLength),maxLength:s0(ue.maxLength),pattern:s0(ue.pattern)}:{},name:Y,onChange:J,onBlur:J,ref:Me=>{if(Me){Ae(Y,ue),ve=Ys(n,Y);const tt=$i(Me.value)&&Me.querySelectorAll&&Me.querySelectorAll("input,select,textarea")[0]||Me,fe=Bie(tt),ct=ve._f.refs||[];if(fe?ct.find(dt=>dt===tt):tt===ve._f.ref)return;ya(n,Y,{_f:{...ve._f,...fe?{refs:[...ct.filter(z2),tt,...Array.isArray(Ys(a,Y))?[{}]:[]],ref:{type:tt.type,name:Y}}:{ref:tt}}}),w(Y,!1,void 0,tt)}else ve=Ys(n,Y,{}),ve._f&&(ve._f.mount=!1),(t.shouldUnregister||ue.shouldUnregister)&&!(V$(l.array,Y)&&o.action)&&l.unMount.add(Y)}}},Ee=()=>t.shouldFocusError&&U0(n,z,l.mount),$e=Y=>{wc(Y)&&(f.state.next({disabled:Y}),U0(n,(ue,ve)=>{const Le=Ys(n,ve);Le&&(ue.disabled=Le._f.disabled||Y,Array.isArray(Le._f.refs)&&Le._f.refs.forEach(Me=>{Me.disabled=Le._f.disabled||Y}))},0,!1))},O=(Y,ue)=>async ve=>{let Le;ve&&(ve.preventDefault&&ve.preventDefault(),ve.persist&&ve.persist());let Me=mo(i);if(f.state.next({isSubmitting:!0}),t.resolver){const{errors:tt,values:fe}=await S();r.errors=tt,Me=mo(fe)}else await k(n);if(l.disabled.size)for(const tt of l.disabled)Qi(Me,tt);if(Qi(r.errors,"root"),Jl(r.errors)){f.state.next({errors:{}});try{await Y(Me,ve)}catch(tt){Le=tt}}else ue&&await ue({...r.errors},ve),Ee(),setTimeout(Ee);if(f.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Jl(r.errors)&&!Le,submitCount:r.submitCount+1,errors:r.errors}),Le)throw Le},te=(Y,ue={})=>{Ys(n,Y)&&($i(ue.defaultValue)?L(Y,mo(Ys(a,Y))):(L(Y,ue.defaultValue),ya(a,Y,mo(ue.defaultValue))),ue.keepTouched||Qi(r.touchedFields,Y),ue.keepDirty||(Qi(r.dirtyFields,Y),r.isDirty=ue.defaultValue?A(Y,mo(Ys(a,Y))):A()),ue.keepError||(Qi(r.errors,Y),u.isValid&&g()),f.state.next({...r}))},re=(Y,ue={})=>{const ve=Y?mo(Y):a,Le=mo(ve),Me=Jl(Y),tt=Me?a:Le;if(ue.keepDefaultValues||(a=ve),!ue.keepValues){if(ue.keepDirtyValues){const fe=new Set([...l.mount,...Object.keys(t0(a,i))]);for(const ct of Array.from(fe))Ys(r.dirtyFields,ct)?ya(tt,ct,Ys(i,ct)):L(ct,Ys(tt,ct))}else{if(c3&&$i(Y))for(const fe of l.mount){const ct=Ys(n,fe);if(ct&&ct._f){const dt=Array.isArray(ct._f.refs)?ct._f.refs[0]:ct._f.ref;if(g1(dt)){const pt=dt.closest("form");if(pt){pt.reset();break}}}}if(ue.keepFieldsRef)for(const fe of l.mount)L(fe,Ys(tt,fe));else n={}}i=t.shouldUnregister?ue.keepDefaultValues?mo(a):{}:mo(tt),f.array.next({values:{...tt}}),f.state.next({values:{...tt}})}l={mount:ue.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!u.isValid||!!ue.keepIsValid||!!ue.keepDirtyValues,o.watch=!!t.shouldUnregister,f.state.next({submitCount:ue.keepSubmitCount?r.submitCount:0,isDirty:Me?!1:ue.keepDirty?r.isDirty:!!(ue.keepDefaultValues&&!Vu(Y,a)),isSubmitted:ue.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:Me?{}:ue.keepDirtyValues?ue.keepDefaultValues&&i?t0(a,i):r.dirtyFields:ue.keepDefaultValues&&Y?t0(a,Y):ue.keepDirty?r.dirtyFields:{},touchedFields:ue.keepTouched?r.touchedFields:{},errors:ue.keepErrors?r.errors:{},isSubmitSuccessful:ue.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:a})},le=(Y,ue)=>re(Ad(Y)?Y(i):Y,ue),Z=(Y,ue={})=>{const ve=Ys(n,Y),Le=ve&&ve._f;if(Le){const Me=Le.refs?Le.refs[0]:Le.ref;Me.focus&&(Me.focus(),ue.shouldSelect&&Ad(Me.select)&&Me.select())}},K=Y=>{r={...r,...Y}},ce={control:{register:Ae,unregister:be,getFieldState:Q,handleSubmit:O,setError:q,_subscribe:se,_runSchema:S,_focusError:Ee,_getWatch:T,_getDirty:A,_setValid:g,_setFieldArray:y,_setDisabledField:pe,_setErrors:b,_getFieldArray:V,_reset:re,_resetDefaultValues:()=>Ad(t.defaultValues)&&t.defaultValues().then(Y=>{le(Y,t.resetOptions),f.state.next({isLoading:!1})}),_removeUnmounted:F,_disableForm:$e,_subjects:f,_proxyFormState:u,get _fields(){return n},get _formValues(){return i},get _state(){return o},set _state(Y){o=Y},get _defaultValues(){return a},get _names(){return l},set _names(Y){l=Y},get _formState(){return r},get _options(){return t},set _options(Y){t={...t,...Y}}},subscribe:he,trigger:U,register:Ae,handleSubmit:O,watch:D,setValue:L,getValues:oe,reset:le,resetField:te,clearErrors:P,unregister:be,setError:q,setFocus:Z,getFieldState:Q};return{...ce,formControl:ce}}function xm(s={}){const t=xe.useRef(void 0),r=xe.useRef(void 0),[n,a]=xe.useState({isDirty:!1,isValidating:!1,isLoading:Ad(s.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:s.errors||{},disabled:s.disabled||!1,isReady:!1,defaultValues:Ad(s.defaultValues)?void 0:s.defaultValues});if(!t.current)if(s.formControl)t.current={...s.formControl,formState:n},s.defaultValues&&!Ad(s.defaultValues)&&s.formControl.reset(s.defaultValues,s.resetOptions);else{const{formControl:o,...l}=Qie(s);t.current={...l,formState:n}}const i=t.current.control;return i._options=s,m3(()=>{const o=i._subscribe({formState:i._proxyFormState,callback:()=>a({...i._formState}),reRenderRoot:!0});return a(l=>({...l,isReady:!0})),i._formState.isReady=!0,o},[i]),xe.useEffect(()=>i._disableForm(s.disabled),[i,s.disabled]),xe.useEffect(()=>{s.mode&&(i._options.mode=s.mode),s.reValidateMode&&(i._options.reValidateMode=s.reValidateMode)},[i,s.mode,s.reValidateMode]),xe.useEffect(()=>{s.errors&&(i._setErrors(s.errors),i._focusError())},[i,s.errors]),xe.useEffect(()=>{s.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,s.shouldUnregister]),xe.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==n.isDirty&&i._subjects.state.next({isDirty:o})}},[i,n.isDirty]),xe.useEffect(()=>{s.values&&!Vu(s.values,r.current)?(i._reset(s.values,{keepFieldsRef:!0,...i._options.resetOptions}),r.current=s.values,a(o=>({...o}))):i._resetDefaultValues()},[i,s.values]),xe.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),t.current.formState=W$(n,i),t.current}const b0=Fie,e9=x.createContext({}),pr=({...s})=>e.jsx(e9.Provider,{value:{name:s.name},children:e.jsx($ie,{...s})}),g3=()=>{const s=x.useContext(e9),t=x.useContext(t9);if(!s)throw new Error("useFormField should be used within <FormField>");const r=yN();if(!r)throw new Error("useFormField should be used within a <Form> component");const{getFieldState:n}=r,a=H$({name:s.name}),i=n(s.name,a),{id:o}=t;return{id:o,name:s.name,formItemId:`${o}-form-item`,formDescriptionId:`${o}-form-item-description`,formMessageId:`${o}-form-item-message`,...i}},t9=x.createContext({});function gr({className:s,...t}){const r=x.useId();return e.jsx(t9.Provider,{value:{id:r},children:e.jsx("div",{"data-slot":"form-item",className:ns("grid gap-2",s),...t})})}function vr({className:s,...t}){const{error:r,formItemId:n}=g3();return e.jsx(B,{"data-slot":"form-label","data-error":!!r,className:ns("data-[error=true]:text-destructive",s),htmlFor:n,...t})}function yr({...s}){const{error:t,formItemId:r,formDescriptionId:n,formMessageId:a}=g3();return e.jsx(rN,{"data-slot":"form-control",id:r,"aria-describedby":t?`${n} ${a}`:`${n}`,"aria-invalid":!!t,...s})}function Er({className:s,...t}){const{error:r,formMessageId:n}=g3(),a=r?String((r==null?void 0:r.message)??""):t.children;return a?e.jsx("p",{"data-slot":"form-message",id:n,className:ns("text-destructive text-sm",s),...t,children:a}):null}var v3="Progress",y3=100,[Zie]=qR(v3),[eoe,toe]=Zie(v3),s9=x.forwardRef((s,t)=>{const{__scopeProgress:r,value:n=null,max:a,getValueLabel:i=soe,...o}=s;(a||a===0)&&!U_(a)&&console.error(roe(`${a}`,"Progress"));const l=U_(a)?a:y3;n!==null&&!z_(n,l)&&console.error(noe(`${n}`,"Progress"));const c=z_(n,l)?n:null,d=j1(c)?i(c,l):void 0;return e.jsx(eoe,{scope:r,value:c,max:l,children:e.jsx(Tc.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":j1(c)?c:void 0,"aria-valuetext":d,role:"progressbar","data-state":a9(c,l),"data-value":c??void 0,"data-max":l,...o,ref:t})})});s9.displayName=v3;var r9="ProgressIndicator",n9=x.forwardRef((s,t)=>{const{__scopeProgress:r,...n}=s,a=toe(r9,r);return e.jsx(Tc.div,{"data-state":a9(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...n,ref:t})});n9.displayName=r9;function soe(s,t){return`${Math.round(s/t*100)}%`}function a9(s,t){return s==null?"indeterminate":s===t?"complete":"loading"}function j1(s){return typeof s=="number"}function U_(s){return j1(s)&&!isNaN(s)&&s>0}function z_(s,t){return j1(s)&&!isNaN(s)&&s<=t&&s>=0}function roe(s,t){return`Invalid prop \`max\` of value \`${s}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${y3}\`.`}function noe(s,t){return`Invalid prop \`value\` of value \`${s}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${y3} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var i9=s9,aoe=n9;const No=x.forwardRef(({className:s,value:t,...r},n)=>e.jsx(i9,{ref:n,className:ns("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...r,children:e.jsx(aoe,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));No.displayName=i9.displayName;function ioe({open:s,onOpenChange:t,defaultCompanyId:r,onCreated:n}){const[a,i]=xe.useState(null),[o,l]=xe.useState(null),[c,d]=xe.useState(r||""),[u,h]=xe.useState(""),[f,m]=xe.useState(""),[p,g]=xe.useState(new Date().toISOString().slice(0,10)),[v,y]=xe.useState(""),[j,b]=xe.useState(""),[w,N]=xe.useState(!1),[C,S]=xe.useState(""),[_,k]=xe.useState("");xe.useEffect(()=>{try{if(!c){const G=localStorage.getItem("company_id")||localStorage.getItem("companyId")||localStorage.getItem("company");G&&d(G)}}catch{}},[c]);const{data:F}=ys({queryKey:["expense-categories",c],enabled:!!c,queryFn:async()=>la.getExpenseCategories({companyId:c})}),A=G=>{o&&URL.revokeObjectURL(o);const L=URL.createObjectURL(G);l(L)},T=G=>{var J;const L=((J=G.target.files)==null?void 0:J[0])||null;i(L),L&&A(L)},V=async()=>{var G;if(a){N(!0);try{const z=await(await new Promise((oe,Q)=>{if(typeof window<"u"&&window.Tesseract)return oe(window.Tesseract);const P=document.createElement("script");P.src="https://cdn.jsdelivr.net/npm/tesseract.js@4.0.2/dist/tesseract.min.js",P.async=!0,P.onload=()=>oe(window.Tesseract),P.onerror=Q,document.head.appendChild(P)})).recognize(a,"eng",{logger:()=>{}}),U=((G=z==null?void 0:z.data)==null?void 0:G.text)||"";if(U){const oe=U.split(/\r?\n/).map(D=>D.trim()).filter(Boolean),Q=oe[0]||"",P=U.match(/\$?\s*([0-9]{1,3}(?:[,][0-9]{3})*(?:\.[0-9]{2})|[0-9]+\.[0-9]{2})\b/g),q=U.match(/\b(20[0-9]{2}[-\/.][0-1]?[0-9][-\/.][0-3]?[0-9]|[0-3]?[0-9][-\/.][0-1]?[0-9][-\/.](20[0-9]{2}))\b/);if(Q&&!u&&h(Q.slice(0,80)),P&&!f){const D=P[P.length-1].replace(/\$/g,"").replace(/,/g,"").trim();m(D)}if(q&&!p){const D=q[0].replace(/[.]/g,"-").replace(/[\/]/g,"-"),se=D.split("-"),he=se[0].length===4?D:`${se[2]}-${se[1].padStart(2,"0")}-${se[0].padStart(2,"0")}`;g(he)}j||b(oe.slice(0,3).join(" "))}}catch{}finally{N(!1)}}},M=Rs({mutationFn:async()=>{var z;const G=parseFloat(f||"0"),L={companyId:c,amount:isFinite(G)?G:0,taxAmount:0,totalAmount:isFinite(G)?G:0,expenseDate:p,categoryId:v||((z=F==null?void 0:F[0])==null?void 0:z.id)||"",description:j||`Receipt from ${u||"Unknown Vendor"}`,department:C||void 0,project:_||void 0,vendorId:void 0};return await la.createExpense(L)},onSuccess:G=>{n==null||n(G==null?void 0:G.id);try{localStorage.setItem("company_id",c)}catch{}t(!1),i(null),o&&URL.revokeObjectURL(o),l(null),h(""),m(""),b("")}});return e.jsx(ts,{open:s,onOpenChange:G=>{M.isPending||t(G)},children:e.jsxs(ss,{className:"max-w-xl",children:[e.jsx(as,{children:e.jsx(is,{children:"Scan Receipt (Quick Add)"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Company"}),e.jsxs(rt,{value:c,onValueChange:d,children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select company"})}),e.jsx(at,{children:c&&e.jsx(W,{value:c,children:c})})]})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Date"}),e.jsx(ge,{type:"date",value:p,onChange:G=>g(G.target.value)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Vendor"}),e.jsx(ge,{value:u,onChange:G=>h(G.target.value),placeholder:"e.g., Starbucks"})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Amount"}),e.jsx(ge,{type:"number",step:"0.01",inputMode:"decimal",value:f,onChange:G=>m(G.target.value),placeholder:"0.00"})]})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Category"}),e.jsxs(rt,{value:v,onValueChange:y,children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select category"})}),e.jsx(at,{children:(F||[]).map(G=>e.jsx(W,{value:G.id,children:G.name},G.id))})]})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Description"}),e.jsx(Xs,{value:j,onChange:G=>b(G.target.value),placeholder:"Optional notes"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Department (optional)"}),e.jsx(ge,{value:C,onChange:G=>S(G.target.value),placeholder:"e.g., Marketing"})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Project (optional)"}),e.jsx(ge,{value:_,onChange:G=>k(G.target.value),placeholder:"e.g., Q3 Launch"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Receipt (image or PDF)"}),e.jsx(ge,{type:"file",accept:"image/*,application/pdf",onChange:T}),o&&e.jsx("div",{className:"border rounded-md p-2",children:e.jsx("img",{src:o,alt:"Receipt preview",className:"max-h-64 object-contain"})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(I,{variant:"outline",onClick:V,disabled:!a||w,children:w?"Extracting...":"Extract with OCR"})})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(I,{variant:"outline",onClick:()=>t(!1),disabled:M.isPending,children:"Cancel"}),e.jsx(I,{onClick:()=>M.mutate(),disabled:!c||!f||!p||M.isPending,children:M.isPending?"Creating...":"Create Expense"})]})]})]})})}function ooe({open:s,onOpenChange:t}){const[r,n]=xe.useState(""),[a,i]=xe.useState(new Date(new Date().setDate(1)).toISOString().slice(0,10)),[o,l]=xe.useState(new Date().toISOString().slice(0,10)),[c,d]=xe.useState("all"),[u,h]=xe.useState(!1);xe.useEffect(()=>{try{const p=localStorage.getItem("company_id")||localStorage.getItem("companyId")||localStorage.getItem("company");p&&n(p)}catch{}},[]);const{data:f}=ys({queryKey:["companies"],queryFn:async()=>cN.getCompanies()}),m=async()=>{h(!0);try{const g=(await la.getExpenses(r,c==="all"?void 0:c)||[]).filter(C=>{const S=(C.expenseDate||"").slice(0,10);return(!a||S>=a)&&(!o||S<=o)}),v=["Date","Description","Category","Status","Amount"],y=g.map(C=>{var S,_;return[(S=C.expenseDate)==null?void 0:S.slice(0,10),(C.description||"").replaceAll('"','""'),((_=C.category)==null?void 0:_.name)||"",C.status||"",String(C.totalAmount??C.amount??0)]}),j=[v.join(","),...y.map(C=>C.map(S=>/,|"/.test(S)?`"${S}"`:S).join(","))],b=new Blob([j.join(`
`)],{type:"text/csv;charset=utf-8;"}),w=URL.createObjectURL(b),N=document.createElement("a");N.href=w,N.download=`expense_report_${a}_to_${o}.csv`,N.click(),setTimeout(()=>URL.revokeObjectURL(w),3e4)}finally{h(!1)}};return e.jsx(ts,{open:s,onOpenChange:t,children:e.jsxs(ss,{className:"max-w-lg",children:[e.jsx(as,{children:e.jsx(is,{children:"Expense Report"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Company"}),e.jsxs(rt,{value:r,onValueChange:n,children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select company"})}),e.jsx(at,{children:(Array.isArray(f)?f:[]).map(p=>e.jsx(W,{value:p.id,children:p.name},p.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Start date"}),e.jsx(ge,{type:"date",value:a,onChange:p=>i(p.target.value)})]}),e.jsxs("div",{children:[e.jsx(B,{children:"End date"}),e.jsx(ge,{type:"date",value:o,onChange:p=>l(p.target.value)})]})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Status"}),e.jsxs(rt,{value:c,onValueChange:d,children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All"}),e.jsx(W,{value:"draft",children:"Draft"}),e.jsx(W,{value:"submitted",children:"Submitted"}),e.jsx(W,{value:"approved",children:"Approved"}),e.jsx(W,{value:"paid",children:"Paid"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(I,{variant:"outline",onClick:()=>t(!1),disabled:u,children:"Close"}),e.jsx(I,{onClick:m,disabled:!r||u,children:u?"Preparing...":"Export CSV"})]})]})]})})}function loe({open:s,onOpenChange:t,expenseId:r,defaultAmount:n}){const[a,i]=xe.useState("bank_transfer"),[o,l]=xe.useState(n!=null?String(n):""),[c,d]=xe.useState(new Date().toISOString().slice(0,10)),[u,h]=xe.useState("");xe.useEffect(()=>{n!=null&&l(String(n))},[n]);const f=Rs({mutationFn:async()=>{if(!r)return;const m=parseFloat(o||"0");await la.updateExpense(r,{status:"paid",totalAmount:m,description:u?`Reimbursed: ${u}`:void 0})},onSuccess:()=>t(!1)});return e.jsx(ts,{open:s,onOpenChange:m=>{f.isPending||t(m)},children:e.jsxs(ss,{className:"max-w-md",children:[e.jsx(as,{children:e.jsx(is,{children:"Reimburse Expense"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Payment Method"}),e.jsxs(rt,{value:a,onValueChange:i,children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"bank_transfer",children:"Bank Transfer"}),e.jsx(W,{value:"mobile_money",children:"Mobile Money"}),e.jsx(W,{value:"cash",children:"Cash"}),e.jsx(W,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Amount"}),e.jsx(ge,{type:"number",step:"0.01",value:o,onChange:m=>l(m.target.value)})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Date"}),e.jsx(ge,{type:"date",value:c,onChange:m=>d(m.target.value)})]})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Reference (optional)"}),e.jsx(ge,{value:u,onChange:m=>h(m.target.value),placeholder:"e.g., TXN-12345"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(I,{variant:"outline",onClick:()=>t(!1),disabled:f.isPending,children:"Cancel"}),e.jsx(I,{onClick:()=>f.mutate(),disabled:!r||!o||f.isPending,children:f.isPending?"Processing...":"Mark as Paid"})]})]})]})})}function coe({open:s,onOpenChange:t,amount:r,date:n,description:a,exceptionId:i,onMatched:o,onSelectExpense:l}){const[c,d]=xe.useState(a||""),u=xe.useMemo(()=>n?new Date(new Date(n).setDate(new Date(n).getDate()-7)).toISOString().slice(0,10):new Date(new Date().setDate(1)).toISOString().slice(0,10),[n]),h=xe.useMemo(()=>n?new Date(new Date(n).setDate(new Date(n).getDate()+7)).toISOString().slice(0,10):new Date().toISOString().slice(0,10),[n]),{data:f}=ys({queryKey:["expenses-for-matching",u,h,r],enabled:s,queryFn:async()=>la.getExpenses(void 0,void 0,void 0)}),m=Rs({mutationFn:async({exceptionId:g,expenseId:v})=>XL.resolveMatch(g,v),onSuccess:()=>{ze.success("Exception matched to expense"),o&&o(),t(!1)},onError:g=>ze.error((g==null?void 0:g.message)||"Failed to match exception")}),p=xe.useMemo(()=>(Array.isArray(f)?f:(f==null?void 0:f.items)||(f==null?void 0:f.data)||[]).filter(v=>{const y=!c||(v.description||"").toLowerCase().includes(c.toLowerCase()),j=Number(v.totalAmount??v.amount??0),b=r?Math.abs(j-(r||0))<.01:!0,w=String(v.expenseDate||"").slice(0,10),N=(!u||w>=u)&&(!h||w<=h);return y&&b&&N}).slice(0,50),[f,c,r,u,h]);return e.jsx(ts,{open:s,onOpenChange:t,children:e.jsxs(ss,{className:"max-w-2xl",children:[e.jsx(as,{children:e.jsx(is,{children:"Match Expense to Bank Transaction"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Amount"}),e.jsx(ge,{value:r??"",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Date"}),e.jsx(ge,{value:n||"",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Search"}),e.jsx(ge,{value:c,onChange:g=>d(g.target.value),placeholder:"Description filter"})]})]}),e.jsx("div",{className:"border rounded-md max-h-72 overflow-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-muted",children:[e.jsx("th",{className:"text-left p-2",children:"Date"}),e.jsx("th",{className:"text-left p-2",children:"Description"}),e.jsx("th",{className:"text-right p-2",children:"Amount"}),e.jsx("th",{className:"p-2"})]})}),e.jsxs("tbody",{children:[p.map(g=>{const v=Number(g.totalAmount??g.amount??0);return e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"p-2",children:String(g.expenseDate||"").slice(0,10)}),e.jsx("td",{className:"p-2",children:g.description}),e.jsxs("td",{className:"p-2 text-right",children:["$",Number(v).toLocaleString()]}),e.jsx("td",{className:"p-2 text-right",children:i?e.jsx(I,{size:"sm",variant:"outline",onClick:()=>m.mutate({exceptionId:i,expenseId:g.id}),disabled:m.isPending,children:"Match"}):e.jsx(I,{size:"sm",variant:"outline",onClick:()=>{l&&l(g.id),t(!1)},children:"Select"})})]},g.id)}),p.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"p-4 text-center text-muted-foreground",children:"No candidates found"})})]})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(I,{variant:"outline",onClick:()=>t(!1),children:"Close"})})]})]})})}function doe({open:s,onOpenChange:t,expense:r}){const[n,a]=xe.useState(""),[i,o]=xe.useState(""),[l,c]=xe.useState(""),[d,u]=xe.useState(""),[h,f]=xe.useState(""),[m,p]=xe.useState(""),{data:g}=ys({queryKey:["expense-categories"],queryFn:async()=>la.getExpenseCategories()});xe.useEffect(()=>{var y;r&&(a(r.description||""),o(String(r.totalAmount??r.amount??"")),c(String(r.expenseDate||"").slice(0,10)),u(String(r.department||"")),f(String(r.project||"")),p(String(r.categoryId||((y=r.category)==null?void 0:y.id)||"")))},[r]);const v=Rs({mutationFn:async()=>{if(!r)return;const y=parseFloat(i||"0");await la.updateExpense(r.id,{description:n,expenseDate:l,department:d||void 0,project:h||void 0,categoryId:m||void 0,totalAmount:isFinite(y)?y:void 0})},onSuccess:()=>t(!1)});return e.jsx(ts,{open:s,onOpenChange:y=>{v.isPending||t(y)},children:e.jsxs(ss,{className:"max-w-lg",children:[e.jsx(as,{children:e.jsx(is,{children:"Edit Expense"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Description"}),e.jsx(Xs,{value:n,onChange:y=>a(y.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Amount"}),e.jsx(ge,{type:"number",step:"0.01",value:i,onChange:y=>o(y.target.value)})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Date"}),e.jsx(ge,{type:"date",value:l,onChange:y=>c(y.target.value)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Department"}),e.jsx(ge,{value:d,onChange:y=>u(y.target.value)})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Project"}),e.jsx(ge,{value:h,onChange:y=>f(y.target.value)})]})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Category"}),e.jsxs(rt,{value:m,onValueChange:p,children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select category"})}),e.jsx(at,{children:(g||[]).map(y=>e.jsx(W,{value:y.id,children:y.name},y.id))})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(I,{variant:"outline",onClick:()=>t(!1),disabled:v.isPending,children:"Cancel"}),e.jsx(I,{onClick:()=>v.mutate(),disabled:v.isPending,children:v.isPending?"Saving...":"Save"})]})]})]})})}function uoe({open:s,onOpenChange:t}){const[r,n]=xe.useState(null),[a,i]=xe.useState([]),[o,l]=xe.useState([]),[c,d]=xe.useState(()=>({})),[u,h]=xe.useState(""),[f,m]=xe.useState(""),[p,g]=xe.useState(""),[v,y]=xe.useState(!1),j=hi(),b=async S=>{const k=(await S.text()).split(/\r?\n/).filter(Boolean);if(k.length===0)return;const F=M=>{const G=[];let L="",J=!1;for(let z=0;z<M.length;z++){const U=M[z];U==='"'?J&&M[z+1]==='"'?(L+='"',z++):J=!J:U===","&&!J?(G.push(L),L=""):L+=U}return G.push(L),G},A=F(k[0]).map(M=>M.trim()),T=k.slice(1).map(F);l(A);const V=T.map(M=>Object.fromEntries(A.map((G,L)=>[G,M[L]??""])));i(V),d({date:A.find(M=>/date/i.test(M))||A[0],description:A.find(M=>/desc|memo|merchant/i.test(M))||A[1],amount:A.find(M=>/amount|debit|credit/i.test(M))||A[2]})},w=S=>{var k;const _=(k=S.target.files)==null?void 0:k[0];_&&(n(_),b(_))};xe.useEffect(()=>{try{const S=localStorage.getItem("company_id")||localStorage.getItem("companyId")||localStorage.getItem("company");S&&h(S)}catch{}},[]);const N=Rs({mutationFn:async S=>XL.importTransactions(S.map(_=>({date:String(_.date||""),description:String(_.description||""),amount:Number(_.amount||0),merchant:_.merchant,source:_.source})),u),onSuccess:S=>{g(`Imported ${S.created} rows. Unmatched are available in Exceptions.`),j.invalidateQueries({queryKey:["card-exceptions"]})},onError:S=>{g(`Import failed: ${(S==null?void 0:S.message)||"Unknown error"}`)},onSettled:()=>y(!1)}),C=async()=>{if(!u||!c.date||!c.description||!c.amount)return;y(!0);const S=a.map(_=>({date:String(_[c.date]),description:String(_[c.description]),amount:parseFloat(String(_[c.amount]).replace(/[^0-9.-]/g,"")),merchant:void 0,source:"csv"}));N.mutate(S)};return e.jsx(ts,{open:s,onOpenChange:t,children:e.jsxs(ss,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsx(as,{children:e.jsx(is,{children:"Import Card Transactions (CSV)"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Company"}),e.jsx(ge,{value:u,onChange:S=>h(S.target.value),placeholder:"company id"})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Default Category (optional)"}),e.jsx(ge,{value:f,onChange:S=>m(S.target.value),placeholder:"category id or mapping"})]})]}),e.jsxs("div",{children:[e.jsx(B,{children:"CSV File"}),e.jsx(ge,{type:"file",accept:"text/csv",onChange:w})]}),o.length>0&&e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Date Column"}),e.jsxs(rt,{value:c.date,onValueChange:S=>d(_=>({..._,date:S})),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsx(at,{children:o.map(S=>e.jsx(W,{value:S,children:S},S))})]})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Description Column"}),e.jsxs(rt,{value:c.description,onValueChange:S=>d(_=>({..._,description:S})),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsx(at,{children:o.map(S=>e.jsx(W,{value:S,children:S},S))})]})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Amount Column"}),e.jsxs(rt,{value:c.amount,onValueChange:S=>d(_=>({..._,amount:S})),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsx(at,{children:o.map(S=>e.jsx(W,{value:S,children:S},S))})]})]})]}),a.length>0&&e.jsxs("div",{className:"border rounded",children:[e.jsxs("div",{className:"p-2 text-sm text-muted-foreground",children:["Preview (",a.length," rows)"]}),e.jsx("div",{className:"max-h-64 overflow-auto",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{children:e.jsx("tr",{children:(o||[]).map(S=>e.jsx("th",{className:"p-2 text-left bg-muted",children:S},S))})}),e.jsx("tbody",{children:a.slice(0,20).map((S,_)=>e.jsx("tr",{className:"border-b",children:o.map(k=>e.jsx("td",{className:"p-2",children:S[k]},k))},_))})]})})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(I,{variant:"outline",onClick:()=>t(!1),disabled:v,children:"Cancel"}),e.jsx(I,{onClick:C,disabled:!a.length||!u||v,children:v?"Importing":"Import"})]}),p&&e.jsx(Xs,{readOnly:!0,value:p,className:"text-xs h-24"})]})]})})}const o9=6048e5,hoe=864e5,q_=Symbol.for("constructDateFrom");function Io(s,t){return typeof s=="function"?s(t):s&&typeof s=="object"&&q_ in s?s[q_](t):s instanceof Date?new s.constructor(t):new Date(t)}function Ta(s,t){return Io(t||s,s)}function l9(s,t,r){const n=Ta(s,r==null?void 0:r.in);return isNaN(t)?Io(s,NaN):(t&&n.setDate(n.getDate()+t),n)}function c9(s,t,r){const n=Ta(s,r==null?void 0:r.in);if(isNaN(t))return Io(s,NaN);if(!t)return n;const a=n.getDate(),i=Io(s,n.getTime());i.setMonth(n.getMonth()+t+1,0);const o=i.getDate();return a>=o?i:(n.setFullYear(i.getFullYear(),i.getMonth(),a),n)}let moe={};function cy(){return moe}function _p(s,t){var l,c,d,u;const r=cy(),n=(t==null?void 0:t.weekStartsOn)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((u=(d=r.locale)==null?void 0:d.options)==null?void 0:u.weekStartsOn)??0,a=Ta(s,t==null?void 0:t.in),i=a.getDay(),o=(i<n?7:0)+i-n;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function cv(s,t){return _p(s,{...t,weekStartsOn:1})}function d9(s,t){const r=Ta(s,t==null?void 0:t.in),n=r.getFullYear(),a=Io(r,0);a.setFullYear(n+1,0,4),a.setHours(0,0,0,0);const i=cv(a),o=Io(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=cv(o);return r.getTime()>=i.getTime()?n+1:r.getTime()>=l.getTime()?n:n-1}function V_(s){const t=Ta(s),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+s-+r}function wg(s,...t){const r=Io.bind(null,t.find(n=>typeof n=="object"));return t.map(r)}function dv(s,t){const r=Ta(s,t==null?void 0:t.in);return r.setHours(0,0,0,0),r}function u9(s,t,r){const[n,a]=wg(r==null?void 0:r.in,s,t),i=dv(n),o=dv(a),l=+i-V_(i),c=+o-V_(o);return Math.round((l-c)/hoe)}function foe(s,t){const r=d9(s,t),n=Io(s,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),cv(n)}function xoe(s,t,r){return l9(s,t*7,r)}function poe(s,t,r){return c9(s,t*12,r)}function goe(s,t){let r,n=t==null?void 0:t.in;return s.forEach(a=>{!n&&typeof a=="object"&&(n=Io.bind(null,a));const i=Ta(a,n);(!r||r<i||isNaN(+i))&&(r=i)}),Io(n,r||NaN)}function voe(s,t){let r,n=t==null?void 0:t.in;return s.forEach(a=>{!n&&typeof a=="object"&&(n=Io.bind(null,a));const i=Ta(a,n);(!r||r>i||isNaN(+i))&&(r=i)}),Io(n,r||NaN)}function yoe(s,t,r){const[n,a]=wg(r==null?void 0:r.in,s,t);return+dv(n)==+dv(a)}function h9(s){return s instanceof Date||typeof s=="object"&&Object.prototype.toString.call(s)==="[object Date]"}function joe(s){return!(!h9(s)&&typeof s!="number"||isNaN(+Ta(s)))}function boe(s,t,r){const[n,a]=wg(r==null?void 0:r.in,s,t),i=n.getFullYear()-a.getFullYear(),o=n.getMonth()-a.getMonth();return i*12+o}function Noe(s,t){const r=Ta(s,t==null?void 0:t.in),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function woe(s,t){const[r,n]=wg(s,t.start,t.end);return{start:r,end:n}}function Soe(s,t){const{start:r,end:n}=woe(t==null?void 0:t.in,s);let a=+r>+n;const i=a?+r:+n,o=a?n:r;o.setHours(0,0,0,0),o.setDate(1);let l=1;const c=[];for(;+o<=i;)c.push(Io(r,o)),o.setMonth(o.getMonth()+l);return a?c.reverse():c}function Coe(s,t){const r=Ta(s,t==null?void 0:t.in);return r.setDate(1),r.setHours(0,0,0,0),r}function Aoe(s,t){const r=Ta(s,t==null?void 0:t.in),n=r.getFullYear();return r.setFullYear(n+1,0,0),r.setHours(23,59,59,999),r}function m9(s,t){const r=Ta(s,t==null?void 0:t.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}function f9(s,t){var l,c,d,u;const r=cy(),n=(t==null?void 0:t.weekStartsOn)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((u=(d=r.locale)==null?void 0:d.options)==null?void 0:u.weekStartsOn)??0,a=Ta(s,t==null?void 0:t.in),i=a.getDay(),o=(i<n?-7:0)+6-(i-n);return a.setDate(a.getDate()+o),a.setHours(23,59,59,999),a}function Eoe(s,t){return f9(s,{...t,weekStartsOn:1})}const Ioe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Poe=(s,t,r)=>{let n;const a=Ioe[s];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function q2(s){return(t={})=>{const r=t.width?String(t.width):s.defaultWidth;return s.formats[r]||s.formats[s.defaultWidth]}}const _oe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},koe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Toe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Doe={date:q2({formats:_oe,defaultWidth:"full"}),time:q2({formats:koe,defaultWidth:"full"}),dateTime:q2({formats:Toe,defaultWidth:"full"})},Ooe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Roe=(s,t,r,n)=>Ooe[s];function r0(s){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&s.formattingValues){const o=s.defaultFormattingWidth||s.defaultWidth,l=r!=null&&r.width?String(r.width):o;a=s.formattingValues[l]||s.formattingValues[o]}else{const o=s.defaultWidth,l=r!=null&&r.width?String(r.width):s.defaultWidth;a=s.values[l]||s.values[o]}const i=s.argumentCallback?s.argumentCallback(t):t;return a[i]}}const Foe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Moe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Loe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},$oe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Boe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Uoe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},zoe=(s,t)=>{const r=Number(s),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},qoe={ordinalNumber:zoe,era:r0({values:Foe,defaultWidth:"wide"}),quarter:r0({values:Moe,defaultWidth:"wide",argumentCallback:s=>s-1}),month:r0({values:Loe,defaultWidth:"wide"}),day:r0({values:$oe,defaultWidth:"wide"}),dayPeriod:r0({values:Boe,defaultWidth:"wide",formattingValues:Uoe,defaultFormattingWidth:"wide"})};function n0(s){return(t,r={})=>{const n=r.width,a=n&&s.matchPatterns[n]||s.matchPatterns[s.defaultMatchWidth],i=t.match(a);if(!i)return null;const o=i[0],l=n&&s.parsePatterns[n]||s.parsePatterns[s.defaultParseWidth],c=Array.isArray(l)?Woe(l,h=>h.test(o)):Voe(l,h=>h.test(o));let d;d=s.valueCallback?s.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;const u=t.slice(o.length);return{value:d,rest:u}}}function Voe(s,t){for(const r in s)if(Object.prototype.hasOwnProperty.call(s,r)&&t(s[r]))return r}function Woe(s,t){for(let r=0;r<s.length;r++)if(t(s[r]))return r}function Hoe(s){return(t,r={})=>{const n=t.match(s.matchPattern);if(!n)return null;const a=n[0],i=t.match(s.parsePattern);if(!i)return null;let o=s.valueCallback?s.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const l=t.slice(a.length);return{value:o,rest:l}}}const Goe=/^(\d+)(th|st|nd|rd)?/i,Koe=/\d+/i,Yoe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Joe={any:[/^b/i,/^(a|c)/i]},Xoe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Qoe={any:[/1/i,/2/i,/3/i,/4/i]},Zoe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},ele={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},tle={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},sle={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},rle={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},nle={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},ale={ordinalNumber:Hoe({matchPattern:Goe,parsePattern:Koe,valueCallback:s=>parseInt(s,10)}),era:n0({matchPatterns:Yoe,defaultMatchWidth:"wide",parsePatterns:Joe,defaultParseWidth:"any"}),quarter:n0({matchPatterns:Xoe,defaultMatchWidth:"wide",parsePatterns:Qoe,defaultParseWidth:"any",valueCallback:s=>s+1}),month:n0({matchPatterns:Zoe,defaultMatchWidth:"wide",parsePatterns:ele,defaultParseWidth:"any"}),day:n0({matchPatterns:tle,defaultMatchWidth:"wide",parsePatterns:sle,defaultParseWidth:"any"}),dayPeriod:n0({matchPatterns:rle,defaultMatchWidth:"any",parsePatterns:nle,defaultParseWidth:"any"})},j3={code:"en-US",formatDistance:Poe,formatLong:Doe,formatRelative:Roe,localize:qoe,match:ale,options:{weekStartsOn:0,firstWeekContainsDate:1}};function ile(s,t){const r=Ta(s,t==null?void 0:t.in);return u9(r,m9(r))+1}function x9(s,t){const r=Ta(s,t==null?void 0:t.in),n=+cv(r)-+foe(r);return Math.round(n/o9)+1}function p9(s,t){var u,h,f,m;const r=Ta(s,t==null?void 0:t.in),n=r.getFullYear(),a=cy(),i=(t==null?void 0:t.firstWeekContainsDate)??((h=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??a.firstWeekContainsDate??((m=(f=a.locale)==null?void 0:f.options)==null?void 0:m.firstWeekContainsDate)??1,o=Io((t==null?void 0:t.in)||s,0);o.setFullYear(n+1,0,i),o.setHours(0,0,0,0);const l=_p(o,t),c=Io((t==null?void 0:t.in)||s,0);c.setFullYear(n,0,i),c.setHours(0,0,0,0);const d=_p(c,t);return+r>=+l?n+1:+r>=+d?n:n-1}function ole(s,t){var l,c,d,u;const r=cy(),n=(t==null?void 0:t.firstWeekContainsDate)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((u=(d=r.locale)==null?void 0:d.options)==null?void 0:u.firstWeekContainsDate)??1,a=p9(s,t),i=Io((t==null?void 0:t.in)||s,0);return i.setFullYear(a,0,n),i.setHours(0,0,0,0),_p(i,t)}function g9(s,t){const r=Ta(s,t==null?void 0:t.in),n=+_p(r,t)-+ole(r,t);return Math.round(n/o9)+1}function ba(s,t){const r=s<0?"-":"",n=Math.abs(s).toString().padStart(t,"0");return r+n}const $h={y(s,t){const r=s.getFullYear(),n=r>0?r:1-r;return ba(t==="yy"?n%100:n,t.length)},M(s,t){const r=s.getMonth();return t==="M"?String(r+1):ba(r+1,2)},d(s,t){return ba(s.getDate(),t.length)},a(s,t){const r=s.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(s,t){return ba(s.getHours()%12||12,t.length)},H(s,t){return ba(s.getHours(),t.length)},m(s,t){return ba(s.getMinutes(),t.length)},s(s,t){return ba(s.getSeconds(),t.length)},S(s,t){const r=t.length,n=s.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return ba(a,t.length)}},kx={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},W_={G:function(s,t,r){const n=s.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(s,t,r){if(t==="yo"){const n=s.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return $h.y(s,t)},Y:function(s,t,r,n){const a=p9(s,n),i=a>0?a:1-a;if(t==="YY"){const o=i%100;return ba(o,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):ba(i,t.length)},R:function(s,t){const r=d9(s);return ba(r,t.length)},u:function(s,t){const r=s.getFullYear();return ba(r,t.length)},Q:function(s,t,r){const n=Math.ceil((s.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return ba(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(s,t,r){const n=Math.ceil((s.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return ba(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(s,t,r){const n=s.getMonth();switch(t){case"M":case"MM":return $h.M(s,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(s,t,r){const n=s.getMonth();switch(t){case"L":return String(n+1);case"LL":return ba(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(s,t,r,n){const a=g9(s,n);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):ba(a,t.length)},I:function(s,t,r){const n=x9(s);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):ba(n,t.length)},d:function(s,t,r){return t==="do"?r.ordinalNumber(s.getDate(),{unit:"date"}):$h.d(s,t)},D:function(s,t,r){const n=ile(s);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):ba(n,t.length)},E:function(s,t,r){const n=s.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(s,t,r,n){const a=s.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return ba(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(s,t,r,n){const a=s.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return ba(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(s,t,r){const n=s.getDay(),a=n===0?7:n;switch(t){case"i":return String(a);case"ii":return ba(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(s,t,r){const a=s.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(s,t,r){const n=s.getHours();let a;switch(n===12?a=kx.noon:n===0?a=kx.midnight:a=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(s,t,r){const n=s.getHours();let a;switch(n>=17?a=kx.evening:n>=12?a=kx.afternoon:n>=4?a=kx.morning:a=kx.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(s,t,r){if(t==="ho"){let n=s.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return $h.h(s,t)},H:function(s,t,r){return t==="Ho"?r.ordinalNumber(s.getHours(),{unit:"hour"}):$h.H(s,t)},K:function(s,t,r){const n=s.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):ba(n,t.length)},k:function(s,t,r){let n=s.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):ba(n,t.length)},m:function(s,t,r){return t==="mo"?r.ordinalNumber(s.getMinutes(),{unit:"minute"}):$h.m(s,t)},s:function(s,t,r){return t==="so"?r.ordinalNumber(s.getSeconds(),{unit:"second"}):$h.s(s,t)},S:function(s,t){return $h.S(s,t)},X:function(s,t,r){const n=s.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return G_(n);case"XXXX":case"XX":return uf(n);case"XXXXX":case"XXX":default:return uf(n,":")}},x:function(s,t,r){const n=s.getTimezoneOffset();switch(t){case"x":return G_(n);case"xxxx":case"xx":return uf(n);case"xxxxx":case"xxx":default:return uf(n,":")}},O:function(s,t,r){const n=s.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+H_(n,":");case"OOOO":default:return"GMT"+uf(n,":")}},z:function(s,t,r){const n=s.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+H_(n,":");case"zzzz":default:return"GMT"+uf(n,":")}},t:function(s,t,r){const n=Math.trunc(+s/1e3);return ba(n,t.length)},T:function(s,t,r){return ba(+s,t.length)}};function H_(s,t=""){const r=s>0?"-":"+",n=Math.abs(s),a=Math.trunc(n/60),i=n%60;return i===0?r+String(a):r+String(a)+t+ba(i,2)}function G_(s,t){return s%60===0?(s>0?"-":"+")+ba(Math.abs(s)/60,2):uf(s,t)}function uf(s,t=""){const r=s>0?"-":"+",n=Math.abs(s),a=ba(Math.trunc(n/60),2),i=ba(n%60,2);return r+a+t+i}const K_=(s,t)=>{switch(s){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},v9=(s,t)=>{switch(s){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},lle=(s,t)=>{const r=s.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return K_(s,t);let i;switch(n){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",K_(n,t)).replace("{{time}}",v9(a,t))},cle={p:v9,P:lle},dle=/^D+$/,ule=/^Y+$/,hle=["D","DD","YY","YYYY"];function mle(s){return dle.test(s)}function fle(s){return ule.test(s)}function xle(s,t,r){const n=ple(s,t,r);if(console.warn(n),hle.includes(s))throw new RangeError(n)}function ple(s,t,r){const n=s[0]==="Y"?"years":"days of the month";return`Use \`${s.toLowerCase()}\` instead of \`${s}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const gle=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,vle=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,yle=/^'([^]*?)'?$/,jle=/''/g,ble=/[a-zA-Z]/;function Kn(s,t,r){var u,h,f,m,p,g,v,y;const n=cy(),a=(r==null?void 0:r.locale)??n.locale??j3,i=(r==null?void 0:r.firstWeekContainsDate)??((h=(u=r==null?void 0:r.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??n.firstWeekContainsDate??((m=(f=n.locale)==null?void 0:f.options)==null?void 0:m.firstWeekContainsDate)??1,o=(r==null?void 0:r.weekStartsOn)??((g=(p=r==null?void 0:r.locale)==null?void 0:p.options)==null?void 0:g.weekStartsOn)??n.weekStartsOn??((y=(v=n.locale)==null?void 0:v.options)==null?void 0:y.weekStartsOn)??0,l=Ta(s,r==null?void 0:r.in);if(!joe(l))throw new RangeError("Invalid time value");let c=t.match(vle).map(j=>{const b=j[0];if(b==="p"||b==="P"){const w=cle[b];return w(j,a.formatLong)}return j}).join("").match(gle).map(j=>{if(j==="''")return{isToken:!1,value:"'"};const b=j[0];if(b==="'")return{isToken:!1,value:Nle(j)};if(W_[b])return{isToken:!0,value:j};if(b.match(ble))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:j}});a.localize.preprocessor&&(c=a.localize.preprocessor(l,c));const d={firstWeekContainsDate:i,weekStartsOn:o,locale:a};return c.map(j=>{if(!j.isToken)return j.value;const b=j.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&fle(b)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&mle(b))&&xle(b,t,String(s));const w=W_[b[0]];return w(l,b,a.localize,d)}).join("")}function Nle(s){const t=s.match(yle);return t?t[1].replace(jle,"'"):s}function wle(s,t){const r=Ta(s,t==null?void 0:t.in),n=r.getFullYear(),a=r.getMonth(),i=Io(r,0);return i.setFullYear(n,a+1,0),i.setHours(0,0,0,0),i.getDate()}function Sle(s,t){return Ta(s,t==null?void 0:t.in).getMonth()}function Cle(s,t){return Ta(s,t==null?void 0:t.in).getFullYear()}function Ale(s,t){return+Ta(s)>+Ta(t)}function Ele(s,t){return+Ta(s)<+Ta(t)}function Ile(s,t,r){const[n,a]=wg(r==null?void 0:r.in,s,t);return n.getFullYear()===a.getFullYear()&&n.getMonth()===a.getMonth()}function Ple(s,t,r){const[n,a]=wg(r==null?void 0:r.in,s,t);return n.getFullYear()===a.getFullYear()}function _le(s,t,r){const n=Ta(s,r==null?void 0:r.in),a=n.getFullYear(),i=n.getDate(),o=Io(s,0);o.setFullYear(a,t,15),o.setHours(0,0,0,0);const l=wle(o);return n.setMonth(t,Math.min(i,l)),n}function kle(s,t,r){const n=Ta(s,r==null?void 0:r.in);return isNaN(+n)?Io(s,NaN):(n.setFullYear(t),n)}const Y_=(s,t,r)=>{if(s&&"reportValidity"in s){const n=Ys(r,t);s.setCustomValidity(n&&n.message||""),s.reportValidity()}},l4=(s,t)=>{for(const r in t.fields){const n=t.fields[r];n&&n.ref&&"reportValidity"in n.ref?Y_(n.ref,r,s):n&&n.refs&&n.refs.forEach(a=>Y_(a,r,s))}},J_=(s,t)=>{t.shouldUseNativeValidation&&l4(s,t);const r={};for(const n in s){const a=Ys(t.fields,n),i=Object.assign(s[n]||{},{ref:a&&a.ref});if(Tle(t.names||Object.keys(s),n)){const o=Object.assign({},Ys(r,n));ya(o,"root",i),ya(r,n,o)}else ya(r,n,i)}return r},Tle=(s,t)=>{const r=X_(t);return s.some(n=>X_(n).match(`^${r}\\.\\d+`))};function X_(s){return s.replace(/\]|\[/g,"")}function y9(s,t,r){function n(l,c){var d;Object.defineProperty(l,"_zod",{value:l._zod??{},enumerable:!1}),(d=l._zod).traits??(d.traits=new Set),l._zod.traits.add(s),t(l,c);for(const u in o.prototype)u in l||Object.defineProperty(l,u,{value:o.prototype[u].bind(l)});l._zod.constr=o,l._zod.def=c}const a=(r==null?void 0:r.Parent)??Object;class i extends a{}Object.defineProperty(i,"name",{value:s});function o(l){var c;const d=r!=null&&r.Parent?new i:this;n(d,l),(c=d._zod).deferred??(c.deferred=[]);for(const u of d._zod.deferred)u();return d}return Object.defineProperty(o,"init",{value:n}),Object.defineProperty(o,Symbol.hasInstance,{value:l=>{var c,d;return r!=null&&r.Parent&&l instanceof r.Parent?!0:(d=(c=l==null?void 0:l._zod)==null?void 0:c.traits)==null?void 0:d.has(s)}}),Object.defineProperty(o,"name",{value:s}),o}class Dle extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}const Ole={};function j9(s){return Ole}function Rle(s,t){return typeof t=="bigint"?t.toString():t}const b9=Error.captureStackTrace?Error.captureStackTrace:(...s)=>{};function uj(s){return typeof s=="string"?s:s==null?void 0:s.message}function N9(s,t,r){var a,i,o,l,c,d;const n={...s,path:s.path??[]};if(!s.message){const u=uj((o=(i=(a=s.inst)==null?void 0:a._zod.def)==null?void 0:i.error)==null?void 0:o.call(i,s))??uj((l=t==null?void 0:t.error)==null?void 0:l.call(t,s))??uj((c=r.customError)==null?void 0:c.call(r,s))??uj((d=r.localeError)==null?void 0:d.call(r,s))??"Invalid input";n.message=u}return delete n.inst,delete n.continue,t!=null&&t.reportInput||delete n.input,n}const w9=(s,t)=>{s.name="$ZodError",Object.defineProperty(s,"_zod",{value:s._zod,enumerable:!1}),Object.defineProperty(s,"issues",{value:t,enumerable:!1}),Object.defineProperty(s,"message",{get(){return JSON.stringify(t,Rle,2)},enumerable:!0}),Object.defineProperty(s,"toString",{value:()=>s.message,enumerable:!1})},Fle=y9("$ZodError",w9),S9=y9("$ZodError",w9,{Parent:Error}),Mle=s=>(t,r,n,a)=>{const i=n?Object.assign(n,{async:!1}):{async:!1},o=t._zod.run({value:r,issues:[]},i);if(o instanceof Promise)throw new Dle;if(o.issues.length){const l=new((a==null?void 0:a.Err)??s)(o.issues.map(c=>N9(c,i,j9())));throw b9(l,a==null?void 0:a.callee),l}return o.value},Lle=Mle(S9),$le=s=>async(t,r,n,a)=>{const i=n?Object.assign(n,{async:!0}):{async:!0};let o=t._zod.run({value:r,issues:[]},i);if(o instanceof Promise&&(o=await o),o.issues.length){const l=new((a==null?void 0:a.Err)??s)(o.issues.map(c=>N9(c,i,j9())));throw b9(l,a==null?void 0:a.callee),l}return o.value},Ble=$le(S9);function Q_(s,t){try{var r=s()}catch(n){return t(n)}return r&&r.then?r.then(void 0,t):r}function Ule(s,t){for(var r={};s.length;){var n=s[0],a=n.code,i=n.message,o=n.path.join(".");if(!r[o])if("unionErrors"in n){var l=n.unionErrors[0].errors[0];r[o]={message:l.message,type:l.code}}else r[o]={message:i,type:a};if("unionErrors"in n&&n.unionErrors.forEach(function(u){return u.errors.forEach(function(h){return s.push(h)})}),t){var c=r[o].types,d=c&&c[n.code];r[o]=f3(o,t,r,a,d?[].concat(d,n.message):n.message)}s.shift()}return r}function zle(s,t){for(var r={};s.length;){var n=s[0],a=n.code,i=n.message,o=n.path.join(".");if(!r[o])if(n.code==="invalid_union"&&n.errors.length>0){var l=n.errors[0][0];r[o]={message:l.message,type:l.code}}else r[o]={message:i,type:a};if(n.code==="invalid_union"&&n.errors.forEach(function(u){return u.forEach(function(h){return s.push(h)})}),t){var c=r[o].types,d=c&&c[n.code];r[o]=f3(o,t,r,a,d?[].concat(d,n.message):n.message)}s.shift()}return r}function pm(s,t,r){if(r===void 0&&(r={}),function(n){return"_def"in n&&typeof n._def=="object"&&"typeName"in n._def}(s))return function(n,a,i){try{return Promise.resolve(Q_(function(){return Promise.resolve(s[r.mode==="sync"?"parse":"parseAsync"](n,t)).then(function(o){return i.shouldUseNativeValidation&&l4({},i),{errors:{},values:r.raw?Object.assign({},n):o}})},function(o){if(function(l){return Array.isArray(l==null?void 0:l.issues)}(o))return{values:{},errors:J_(Ule(o.errors,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw o}))}catch(o){return Promise.reject(o)}};if(function(n){return"_zod"in n&&typeof n._zod=="object"}(s))return function(n,a,i){try{return Promise.resolve(Q_(function(){return Promise.resolve((r.mode==="sync"?Lle:Ble)(s,n,t)).then(function(o){return i.shouldUseNativeValidation&&l4({},i),{errors:{},values:r.raw?Object.assign({},n):o}})},function(o){if(function(l){return l instanceof Fle}(o))return{values:{},errors:J_(zle(o.issues,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw o}))}catch(o){return Promise.reject(o)}};throw new Error("Invalid input: not a Zod schema")}var ta;(function(s){s.assertEqual=a=>{};function t(a){}s.assertIs=t;function r(a){throw new Error}s.assertNever=r,s.arrayToEnum=a=>{const i={};for(const o of a)i[o]=o;return i},s.getValidEnumValues=a=>{const i=s.objectKeys(a).filter(l=>typeof a[a[l]]!="number"),o={};for(const l of i)o[l]=a[l];return s.objectValues(o)},s.objectValues=a=>s.objectKeys(a).map(function(i){return a[i]}),s.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const i=[];for(const o in a)Object.prototype.hasOwnProperty.call(a,o)&&i.push(o);return i},s.find=(a,i)=>{for(const o of a)if(i(o))return o},s.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function n(a,i=" | "){return a.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}s.joinValues=n,s.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(ta||(ta={}));var Z_;(function(s){s.mergeShapes=(t,r)=>({...t,...r})})(Z_||(Z_={}));const dr=ta.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Yh=s=>{switch(typeof s){case"undefined":return dr.undefined;case"string":return dr.string;case"number":return Number.isNaN(s)?dr.nan:dr.number;case"boolean":return dr.boolean;case"function":return dr.function;case"bigint":return dr.bigint;case"symbol":return dr.symbol;case"object":return Array.isArray(s)?dr.array:s===null?dr.null:s.then&&typeof s.then=="function"&&s.catch&&typeof s.catch=="function"?dr.promise:typeof Map<"u"&&s instanceof Map?dr.map:typeof Set<"u"&&s instanceof Set?dr.set:typeof Date<"u"&&s instanceof Date?dr.date:dr.object;default:return dr.unknown}},Os=ta.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class dh extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){const r=t||function(i){return i.message},n={_errors:[]},a=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(a);else if(o.code==="invalid_return_type")a(o.returnTypeError);else if(o.code==="invalid_arguments")a(o.argumentsError);else if(o.path.length===0)n._errors.push(r(o));else{let l=n,c=0;for(;c<o.path.length;){const d=o.path[c];c===o.path.length-1?(l[d]=l[d]||{_errors:[]},l[d]._errors.push(r(o))):l[d]=l[d]||{_errors:[]},l=l[d],c++}}};return a(this),n}static assert(t){if(!(t instanceof dh))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ta.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},n=[];for(const a of this.issues)a.path.length>0?(r[a.path[0]]=r[a.path[0]]||[],r[a.path[0]].push(t(a))):n.push(t(a));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}dh.create=s=>new dh(s);const c4=(s,t)=>{let r;switch(s.code){case Os.invalid_type:s.received===dr.undefined?r="Required":r=`Expected ${s.expected}, received ${s.received}`;break;case Os.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(s.expected,ta.jsonStringifyReplacer)}`;break;case Os.unrecognized_keys:r=`Unrecognized key(s) in object: ${ta.joinValues(s.keys,", ")}`;break;case Os.invalid_union:r="Invalid input";break;case Os.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${ta.joinValues(s.options)}`;break;case Os.invalid_enum_value:r=`Invalid enum value. Expected ${ta.joinValues(s.options)}, received '${s.received}'`;break;case Os.invalid_arguments:r="Invalid function arguments";break;case Os.invalid_return_type:r="Invalid function return type";break;case Os.invalid_date:r="Invalid date";break;case Os.invalid_string:typeof s.validation=="object"?"includes"in s.validation?(r=`Invalid input: must include "${s.validation.includes}"`,typeof s.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${s.validation.position}`)):"startsWith"in s.validation?r=`Invalid input: must start with "${s.validation.startsWith}"`:"endsWith"in s.validation?r=`Invalid input: must end with "${s.validation.endsWith}"`:ta.assertNever(s.validation):s.validation!=="regex"?r=`Invalid ${s.validation}`:r="Invalid";break;case Os.too_small:s.type==="array"?r=`Array must contain ${s.exact?"exactly":s.inclusive?"at least":"more than"} ${s.minimum} element(s)`:s.type==="string"?r=`String must contain ${s.exact?"exactly":s.inclusive?"at least":"over"} ${s.minimum} character(s)`:s.type==="number"?r=`Number must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${s.minimum}`:s.type==="date"?r=`Date must be ${s.exact?"exactly equal to ":s.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(s.minimum))}`:r="Invalid input";break;case Os.too_big:s.type==="array"?r=`Array must contain ${s.exact?"exactly":s.inclusive?"at most":"less than"} ${s.maximum} element(s)`:s.type==="string"?r=`String must contain ${s.exact?"exactly":s.inclusive?"at most":"under"} ${s.maximum} character(s)`:s.type==="number"?r=`Number must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="bigint"?r=`BigInt must be ${s.exact?"exactly":s.inclusive?"less than or equal to":"less than"} ${s.maximum}`:s.type==="date"?r=`Date must be ${s.exact?"exactly":s.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(s.maximum))}`:r="Invalid input";break;case Os.custom:r="Invalid input";break;case Os.invalid_intersection_types:r="Intersection results could not be merged";break;case Os.not_multiple_of:r=`Number must be a multiple of ${s.multipleOf}`;break;case Os.not_finite:r="Number must be finite";break;default:r=t.defaultError,ta.assertNever(s)}return{message:r}};let qle=c4;function Vle(){return qle}const Wle=s=>{const{data:t,path:r,errorMaps:n,issueData:a}=s,i=[...r,...a.path||[]],o={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let l="";const c=n.filter(d=>!!d).slice().reverse();for(const d of c)l=d(o,{data:t,defaultError:l}).message;return{...a,path:i,message:l}};function tr(s,t){const r=Vle(),n=Wle({issueData:t,data:s.data,path:s.path,errorMaps:[s.common.contextualErrorMap,s.schemaErrorMap,r,r===c4?void 0:c4].filter(a=>!!a)});s.common.issues.push(n)}class kc{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const n=[];for(const a of r){if(a.status==="aborted")return tn;a.status==="dirty"&&t.dirty(),n.push(a.value)}return{status:t.value,value:n}}static async mergeObjectAsync(t,r){const n=[];for(const a of r){const i=await a.key,o=await a.value;n.push({key:i,value:o})}return kc.mergeObjectSync(t,n)}static mergeObjectSync(t,r){const n={};for(const a of r){const{key:i,value:o}=a;if(i.status==="aborted"||o.status==="aborted")return tn;i.status==="dirty"&&t.dirty(),o.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||a.alwaysSet)&&(n[i.value]=o.value)}return{status:t.value,value:n}}}const tn=Object.freeze({status:"aborted"}),N0=s=>({status:"dirty",value:s}),od=s=>({status:"valid",value:s}),ek=s=>s.status==="aborted",tk=s=>s.status==="dirty",kp=s=>s.status==="valid",b1=s=>typeof Promise<"u"&&s instanceof Promise;var br;(function(s){s.errToObj=t=>typeof t=="string"?{message:t}:t||{},s.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(br||(br={}));class Rm{constructor(t,r,n,a){this._cachedPath=[],this.parent=t,this.data=r,this._path=n,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const sk=(s,t)=>{if(kp(t))return{success:!0,data:t.value};if(!s.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new dh(s.common.issues);return this._error=r,this._error}}};function Tn(s){if(!s)return{};const{errorMap:t,invalid_type_error:r,required_error:n,description:a}=s;if(t&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(o,l)=>{const{message:c}=s;return o.code==="invalid_enum_value"?{message:c??l.defaultError}:typeof l.data>"u"?{message:c??n??l.defaultError}:o.code!=="invalid_type"?{message:l.defaultError}:{message:c??r??l.defaultError}},description:a}}class Qn{get description(){return this._def.description}_getType(t){return Yh(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:Yh(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new kc,ctx:{common:t.parent.common,data:t.data,parsedType:Yh(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(b1(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const n=this.safeParse(t,r);if(n.success)return n.data;throw n.error}safeParse(t,r){const n={common:{issues:[],async:(r==null?void 0:r.async)??!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Yh(t)},a=this._parseSync({data:t,path:n.path,parent:n});return sk(n,a)}"~validate"(t){var n,a;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Yh(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:r});return kp(i)?{value:i.value}:{issues:r.common.issues}}catch(i){(a=(n=i==null?void 0:i.message)==null?void 0:n.toLowerCase())!=null&&a.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:r}).then(i=>kp(i)?{value:i.value}:{issues:r.common.issues})}async parseAsync(t,r){const n=await this.safeParseAsync(t,r);if(n.success)return n.data;throw n.error}async safeParseAsync(t,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Yh(t)},a=this._parse({data:t,path:n.path,parent:n}),i=await(b1(a)?a:Promise.resolve(a));return sk(n,i)}refine(t,r){const n=a=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(a):r;return this._refinement((a,i)=>{const o=t(a),l=()=>i.addIssue({code:Os.custom,...n(a)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(t,r){return this._refinement((n,a)=>t(n)?!0:(a.addIssue(typeof r=="function"?r(n,a):r),!1))}_refinement(t){return new Op({schema:this,typeName:sn.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return Em.create(this,this._def)}nullable(){return Rp.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return du.create(this)}promise(){return C1.create(this,this._def)}or(t){return w1.create([this,t],this._def)}and(t){return S1.create(this,t,this._def)}transform(t){return new Op({...Tn(this._def),schema:this,typeName:sn.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new u4({...Tn(this._def),innerType:this,defaultValue:r,typeName:sn.ZodDefault})}brand(){return new fce({typeName:sn.ZodBranded,type:this,...Tn(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new h4({...Tn(this._def),innerType:this,catchValue:r,typeName:sn.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return b3.create(this,t)}readonly(){return m4.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Hle=/^c[^\s-]{8,}$/i,Gle=/^[0-9a-z]+$/,Kle=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Yle=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Jle=/^[a-z0-9_-]{21}$/i,Xle=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Qle=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Zle=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,ece="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let V2;const tce=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,sce=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,rce=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,nce=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,ace=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,ice=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,C9="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",oce=new RegExp(`^${C9}$`);function A9(s){let t="[0-5]\\d";s.precision?t=`${t}\\.\\d{${s.precision}}`:s.precision==null&&(t=`${t}(\\.\\d+)?`);const r=s.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}function lce(s){return new RegExp(`^${A9(s)}$`)}function cce(s){let t=`${C9}T${A9(s)}`;const r=[];return r.push(s.local?"Z?":"Z"),s.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function dce(s,t){return!!((t==="v4"||!t)&&tce.test(s)||(t==="v6"||!t)&&rce.test(s))}function uce(s,t){if(!Xle.test(s))return!1;try{const[r]=s.split("."),n=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),a=JSON.parse(atob(n));return!(typeof a!="object"||a===null||"typ"in a&&(a==null?void 0:a.typ)!=="JWT"||!a.alg||t&&a.alg!==t)}catch{return!1}}function hce(s,t){return!!((t==="v4"||!t)&&sce.test(s)||(t==="v6"||!t)&&nce.test(s))}class Yu extends Qn{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==dr.string){const i=this._getOrReturnCtx(t);return tr(i,{code:Os.invalid_type,expected:dr.string,received:i.parsedType}),tn}const n=new kc;let a;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(a=this._getOrReturnCtx(t,a),tr(a,{code:Os.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")t.data.length>i.value&&(a=this._getOrReturnCtx(t,a),tr(a,{code:Os.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){const o=t.data.length>i.value,l=t.data.length<i.value;(o||l)&&(a=this._getOrReturnCtx(t,a),o?tr(a,{code:Os.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):l&&tr(a,{code:Os.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")Zle.test(t.data)||(a=this._getOrReturnCtx(t,a),tr(a,{validation:"email",code:Os.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")V2||(V2=new RegExp(ece,"u")),V2.test(t.data)||(a=this._getOrReturnCtx(t,a),tr(a,{validation:"emoji",code:Os.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")Yle.test(t.data)||(a=this._getOrReturnCtx(t,a),tr(a,{validation:"uuid",code:Os.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")Jle.test(t.data)||(a=this._getOrReturnCtx(t,a),tr(a,{validation:"nanoid",code:Os.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")Hle.test(t.data)||(a=this._getOrReturnCtx(t,a),tr(a,{validation:"cuid",code:Os.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")Gle.test(t.data)||(a=this._getOrReturnCtx(t,a),tr(a,{validation:"cuid2",code:Os.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")Kle.test(t.data)||(a=this._getOrReturnCtx(t,a),tr(a,{validation:"ulid",code:Os.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{a=this._getOrReturnCtx(t,a),tr(a,{validation:"url",code:Os.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),tr(a,{validation:"regex",code:Os.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(t,a),tr(a,{code:Os.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(a=this._getOrReturnCtx(t,a),tr(a,{code:Os.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(a=this._getOrReturnCtx(t,a),tr(a,{code:Os.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?cce(i).test(t.data)||(a=this._getOrReturnCtx(t,a),tr(a,{code:Os.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?oce.test(t.data)||(a=this._getOrReturnCtx(t,a),tr(a,{code:Os.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?lce(i).test(t.data)||(a=this._getOrReturnCtx(t,a),tr(a,{code:Os.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?Qle.test(t.data)||(a=this._getOrReturnCtx(t,a),tr(a,{validation:"duration",code:Os.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?dce(t.data,i.version)||(a=this._getOrReturnCtx(t,a),tr(a,{validation:"ip",code:Os.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?uce(t.data,i.alg)||(a=this._getOrReturnCtx(t,a),tr(a,{validation:"jwt",code:Os.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?hce(t.data,i.version)||(a=this._getOrReturnCtx(t,a),tr(a,{validation:"cidr",code:Os.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?ace.test(t.data)||(a=this._getOrReturnCtx(t,a),tr(a,{validation:"base64",code:Os.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?ice.test(t.data)||(a=this._getOrReturnCtx(t,a),tr(a,{validation:"base64url",code:Os.invalid_string,message:i.message}),n.dirty()):ta.assertNever(i);return{status:n.value,value:t.data}}_regex(t,r,n){return this.refinement(a=>t.test(a),{validation:r,code:Os.invalid_string,...br.errToObj(n)})}_addCheck(t){return new Yu({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...br.errToObj(t)})}url(t){return this._addCheck({kind:"url",...br.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...br.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...br.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...br.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...br.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...br.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...br.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...br.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...br.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...br.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...br.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...br.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...br.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...br.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...br.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...br.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...br.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...br.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...br.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...br.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...br.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...br.errToObj(r)})}nonempty(t){return this.min(1,br.errToObj(t))}trim(){return new Yu({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Yu({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Yu({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}Yu.create=s=>new Yu({checks:[],typeName:sn.ZodString,coerce:(s==null?void 0:s.coerce)??!1,...Tn(s)});function mce(s,t){const r=(s.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,a=r>n?r:n,i=Number.parseInt(s.toFixed(a).replace(".","")),o=Number.parseInt(t.toFixed(a).replace(".",""));return i%o/10**a}class sx extends Qn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==dr.number){const i=this._getOrReturnCtx(t);return tr(i,{code:Os.invalid_type,expected:dr.number,received:i.parsedType}),tn}let n;const a=new kc;for(const i of this._def.checks)i.kind==="int"?ta.isInteger(t.data)||(n=this._getOrReturnCtx(t,n),tr(n,{code:Os.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(n=this._getOrReturnCtx(t,n),tr(n,{code:Os.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(n=this._getOrReturnCtx(t,n),tr(n,{code:Os.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?mce(t.data,i.value)!==0&&(n=this._getOrReturnCtx(t,n),tr(n,{code:Os.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(n=this._getOrReturnCtx(t,n),tr(n,{code:Os.not_finite,message:i.message}),a.dirty()):ta.assertNever(i);return{status:a.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,br.toString(r))}gt(t,r){return this.setLimit("min",t,!1,br.toString(r))}lte(t,r){return this.setLimit("max",t,!0,br.toString(r))}lt(t,r){return this.setLimit("max",t,!1,br.toString(r))}setLimit(t,r,n,a){return new sx({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:br.toString(a)}]})}_addCheck(t){return new sx({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:br.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:br.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:br.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:br.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:br.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:br.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:br.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:br.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:br.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&ta.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(t===null||n.value<t)&&(t=n.value)}return Number.isFinite(r)&&Number.isFinite(t)}}sx.create=s=>new sx({checks:[],typeName:sn.ZodNumber,coerce:(s==null?void 0:s.coerce)||!1,...Tn(s)});class rx extends Qn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==dr.bigint)return this._getInvalidInput(t);let n;const a=new kc;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(n=this._getOrReturnCtx(t,n),tr(n,{code:Os.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(n=this._getOrReturnCtx(t,n),tr(n,{code:Os.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(t,n),tr(n,{code:Os.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):ta.assertNever(i);return{status:a.value,value:t.data}}_getInvalidInput(t){const r=this._getOrReturnCtx(t);return tr(r,{code:Os.invalid_type,expected:dr.bigint,received:r.parsedType}),tn}gte(t,r){return this.setLimit("min",t,!0,br.toString(r))}gt(t,r){return this.setLimit("min",t,!1,br.toString(r))}lte(t,r){return this.setLimit("max",t,!0,br.toString(r))}lt(t,r){return this.setLimit("max",t,!1,br.toString(r))}setLimit(t,r,n,a){return new rx({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:n,message:br.toString(a)}]})}_addCheck(t){return new rx({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:br.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:br.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:br.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:br.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:br.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}rx.create=s=>new rx({checks:[],typeName:sn.ZodBigInt,coerce:(s==null?void 0:s.coerce)??!1,...Tn(s)});class N1 extends Qn{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==dr.boolean){const n=this._getOrReturnCtx(t);return tr(n,{code:Os.invalid_type,expected:dr.boolean,received:n.parsedType}),tn}return od(t.data)}}N1.create=s=>new N1({typeName:sn.ZodBoolean,coerce:(s==null?void 0:s.coerce)||!1,...Tn(s)});class Tp extends Qn{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==dr.date){const i=this._getOrReturnCtx(t);return tr(i,{code:Os.invalid_type,expected:dr.date,received:i.parsedType}),tn}if(Number.isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return tr(i,{code:Os.invalid_date}),tn}const n=new kc;let a;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(a=this._getOrReturnCtx(t,a),tr(a,{code:Os.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(a=this._getOrReturnCtx(t,a),tr(a,{code:Os.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):ta.assertNever(i);return{status:n.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Tp({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:br.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:br.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}Tp.create=s=>new Tp({checks:[],coerce:(s==null?void 0:s.coerce)||!1,typeName:sn.ZodDate,...Tn(s)});class rk extends Qn{_parse(t){if(this._getType(t)!==dr.symbol){const n=this._getOrReturnCtx(t);return tr(n,{code:Os.invalid_type,expected:dr.symbol,received:n.parsedType}),tn}return od(t.data)}}rk.create=s=>new rk({typeName:sn.ZodSymbol,...Tn(s)});class nk extends Qn{_parse(t){if(this._getType(t)!==dr.undefined){const n=this._getOrReturnCtx(t);return tr(n,{code:Os.invalid_type,expected:dr.undefined,received:n.parsedType}),tn}return od(t.data)}}nk.create=s=>new nk({typeName:sn.ZodUndefined,...Tn(s)});class ak extends Qn{_parse(t){if(this._getType(t)!==dr.null){const n=this._getOrReturnCtx(t);return tr(n,{code:Os.invalid_type,expected:dr.null,received:n.parsedType}),tn}return od(t.data)}}ak.create=s=>new ak({typeName:sn.ZodNull,...Tn(s)});class ik extends Qn{constructor(){super(...arguments),this._any=!0}_parse(t){return od(t.data)}}ik.create=s=>new ik({typeName:sn.ZodAny,...Tn(s)});class ok extends Qn{constructor(){super(...arguments),this._unknown=!0}_parse(t){return od(t.data)}}ok.create=s=>new ok({typeName:sn.ZodUnknown,...Tn(s)});class Fm extends Qn{_parse(t){const r=this._getOrReturnCtx(t);return tr(r,{code:Os.invalid_type,expected:dr.never,received:r.parsedType}),tn}}Fm.create=s=>new Fm({typeName:sn.ZodNever,...Tn(s)});class lk extends Qn{_parse(t){if(this._getType(t)!==dr.undefined){const n=this._getOrReturnCtx(t);return tr(n,{code:Os.invalid_type,expected:dr.void,received:n.parsedType}),tn}return od(t.data)}}lk.create=s=>new lk({typeName:sn.ZodVoid,...Tn(s)});class du extends Qn{_parse(t){const{ctx:r,status:n}=this._processInputParams(t),a=this._def;if(r.parsedType!==dr.array)return tr(r,{code:Os.invalid_type,expected:dr.array,received:r.parsedType}),tn;if(a.exactLength!==null){const o=r.data.length>a.exactLength.value,l=r.data.length<a.exactLength.value;(o||l)&&(tr(r,{code:o?Os.too_big:Os.too_small,minimum:l?a.exactLength.value:void 0,maximum:o?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),n.dirty())}if(a.minLength!==null&&r.data.length<a.minLength.value&&(tr(r,{code:Os.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),n.dirty()),a.maxLength!==null&&r.data.length>a.maxLength.value&&(tr(r,{code:Os.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((o,l)=>a.type._parseAsync(new Rm(r,o,r.path,l)))).then(o=>kc.mergeArray(n,o));const i=[...r.data].map((o,l)=>a.type._parseSync(new Rm(r,o,r.path,l)));return kc.mergeArray(n,i)}get element(){return this._def.type}min(t,r){return new du({...this._def,minLength:{value:t,message:br.toString(r)}})}max(t,r){return new du({...this._def,maxLength:{value:t,message:br.toString(r)}})}length(t,r){return new du({...this._def,exactLength:{value:t,message:br.toString(r)}})}nonempty(t){return this.min(1,t)}}du.create=(s,t)=>new du({type:s,minLength:null,maxLength:null,exactLength:null,typeName:sn.ZodArray,...Tn(t)});function qx(s){if(s instanceof eo){const t={};for(const r in s.shape){const n=s.shape[r];t[r]=Em.create(qx(n))}return new eo({...s._def,shape:()=>t})}else return s instanceof du?new du({...s._def,type:qx(s.element)}):s instanceof Em?Em.create(qx(s.unwrap())):s instanceof Rp?Rp.create(qx(s.unwrap())):s instanceof nx?nx.create(s.items.map(t=>qx(t))):s}class eo extends Qn{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=ta.objectKeys(t);return this._cached={shape:t,keys:r},this._cached}_parse(t){if(this._getType(t)!==dr.object){const d=this._getOrReturnCtx(t);return tr(d,{code:Os.invalid_type,expected:dr.object,received:d.parsedType}),tn}const{status:n,ctx:a}=this._processInputParams(t),{shape:i,keys:o}=this._getCached(),l=[];if(!(this._def.catchall instanceof Fm&&this._def.unknownKeys==="strip"))for(const d in a.data)o.includes(d)||l.push(d);const c=[];for(const d of o){const u=i[d],h=a.data[d];c.push({key:{status:"valid",value:d},value:u._parse(new Rm(a,h,a.path,d)),alwaysSet:d in a.data})}if(this._def.catchall instanceof Fm){const d=this._def.unknownKeys;if(d==="passthrough")for(const u of l)c.push({key:{status:"valid",value:u},value:{status:"valid",value:a.data[u]}});else if(d==="strict")l.length>0&&(tr(a,{code:Os.unrecognized_keys,keys:l}),n.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const u of l){const h=a.data[u];c.push({key:{status:"valid",value:u},value:d._parse(new Rm(a,h,a.path,u)),alwaysSet:u in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const d=[];for(const u of c){const h=await u.key,f=await u.value;d.push({key:h,value:f,alwaysSet:u.alwaysSet})}return d}).then(d=>kc.mergeObjectSync(n,d)):kc.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(t){return br.errToObj,new eo({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,n)=>{var i,o;const a=((o=(i=this._def).errorMap)==null?void 0:o.call(i,r,n).message)??n.defaultError;return r.code==="unrecognized_keys"?{message:br.errToObj(t).message??a}:{message:a}}}:{}})}strip(){return new eo({...this._def,unknownKeys:"strip"})}passthrough(){return new eo({...this._def,unknownKeys:"passthrough"})}extend(t){return new eo({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new eo({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:sn.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new eo({...this._def,catchall:t})}pick(t){const r={};for(const n of ta.objectKeys(t))t[n]&&this.shape[n]&&(r[n]=this.shape[n]);return new eo({...this._def,shape:()=>r})}omit(t){const r={};for(const n of ta.objectKeys(this.shape))t[n]||(r[n]=this.shape[n]);return new eo({...this._def,shape:()=>r})}deepPartial(){return qx(this)}partial(t){const r={};for(const n of ta.objectKeys(this.shape)){const a=this.shape[n];t&&!t[n]?r[n]=a:r[n]=a.optional()}return new eo({...this._def,shape:()=>r})}required(t){const r={};for(const n of ta.objectKeys(this.shape))if(t&&!t[n])r[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof Em;)i=i._def.innerType;r[n]=i}return new eo({...this._def,shape:()=>r})}keyof(){return E9(ta.objectKeys(this.shape))}}eo.create=(s,t)=>new eo({shape:()=>s,unknownKeys:"strip",catchall:Fm.create(),typeName:sn.ZodObject,...Tn(t)});eo.strictCreate=(s,t)=>new eo({shape:()=>s,unknownKeys:"strict",catchall:Fm.create(),typeName:sn.ZodObject,...Tn(t)});eo.lazycreate=(s,t)=>new eo({shape:s,unknownKeys:"strip",catchall:Fm.create(),typeName:sn.ZodObject,...Tn(t)});class w1 extends Qn{_parse(t){const{ctx:r}=this._processInputParams(t),n=this._def.options;function a(i){for(const l of i)if(l.result.status==="valid")return l.result;for(const l of i)if(l.result.status==="dirty")return r.common.issues.push(...l.ctx.common.issues),l.result;const o=i.map(l=>new dh(l.ctx.common.issues));return tr(r,{code:Os.invalid_union,unionErrors:o}),tn}if(r.common.async)return Promise.all(n.map(async i=>{const o={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:o}),ctx:o}})).then(a);{let i;const o=[];for(const c of n){const d={...r,common:{...r.common,issues:[]},parent:null},u=c._parseSync({data:r.data,path:r.path,parent:d});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:d}),d.common.issues.length&&o.push(d.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;const l=o.map(c=>new dh(c));return tr(r,{code:Os.invalid_union,unionErrors:l}),tn}}get options(){return this._def.options}}w1.create=(s,t)=>new w1({options:s,typeName:sn.ZodUnion,...Tn(t)});function d4(s,t){const r=Yh(s),n=Yh(t);if(s===t)return{valid:!0,data:s};if(r===dr.object&&n===dr.object){const a=ta.objectKeys(t),i=ta.objectKeys(s).filter(l=>a.indexOf(l)!==-1),o={...s,...t};for(const l of i){const c=d4(s[l],t[l]);if(!c.valid)return{valid:!1};o[l]=c.data}return{valid:!0,data:o}}else if(r===dr.array&&n===dr.array){if(s.length!==t.length)return{valid:!1};const a=[];for(let i=0;i<s.length;i++){const o=s[i],l=t[i],c=d4(o,l);if(!c.valid)return{valid:!1};a.push(c.data)}return{valid:!0,data:a}}else return r===dr.date&&n===dr.date&&+s==+t?{valid:!0,data:s}:{valid:!1}}class S1 extends Qn{_parse(t){const{status:r,ctx:n}=this._processInputParams(t),a=(i,o)=>{if(ek(i)||ek(o))return tn;const l=d4(i.value,o.value);return l.valid?((tk(i)||tk(o))&&r.dirty(),{status:r.value,value:l.data}):(tr(n,{code:Os.invalid_intersection_types}),tn)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,o])=>a(i,o)):a(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}S1.create=(s,t,r)=>new S1({left:s,right:t,typeName:sn.ZodIntersection,...Tn(r)});class nx extends Qn{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==dr.array)return tr(n,{code:Os.invalid_type,expected:dr.array,received:n.parsedType}),tn;if(n.data.length<this._def.items.length)return tr(n,{code:Os.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),tn;!this._def.rest&&n.data.length>this._def.items.length&&(tr(n,{code:Os.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const i=[...n.data].map((o,l)=>{const c=this._def.items[l]||this._def.rest;return c?c._parse(new Rm(n,o,n.path,l)):null}).filter(o=>!!o);return n.common.async?Promise.all(i).then(o=>kc.mergeArray(r,o)):kc.mergeArray(r,i)}get items(){return this._def.items}rest(t){return new nx({...this._def,rest:t})}}nx.create=(s,t)=>{if(!Array.isArray(s))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new nx({items:s,typeName:sn.ZodTuple,rest:null,...Tn(t)})};class ck extends Qn{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==dr.map)return tr(n,{code:Os.invalid_type,expected:dr.map,received:n.parsedType}),tn;const a=this._def.keyType,i=this._def.valueType,o=[...n.data.entries()].map(([l,c],d)=>({key:a._parse(new Rm(n,l,n.path,[d,"key"])),value:i._parse(new Rm(n,c,n.path,[d,"value"]))}));if(n.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const c of o){const d=await c.key,u=await c.value;if(d.status==="aborted"||u.status==="aborted")return tn;(d.status==="dirty"||u.status==="dirty")&&r.dirty(),l.set(d.value,u.value)}return{status:r.value,value:l}})}else{const l=new Map;for(const c of o){const d=c.key,u=c.value;if(d.status==="aborted"||u.status==="aborted")return tn;(d.status==="dirty"||u.status==="dirty")&&r.dirty(),l.set(d.value,u.value)}return{status:r.value,value:l}}}}ck.create=(s,t,r)=>new ck({valueType:t,keyType:s,typeName:sn.ZodMap,...Tn(r)});class uv extends Qn{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.parsedType!==dr.set)return tr(n,{code:Os.invalid_type,expected:dr.set,received:n.parsedType}),tn;const a=this._def;a.minSize!==null&&n.data.size<a.minSize.value&&(tr(n,{code:Os.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),r.dirty()),a.maxSize!==null&&n.data.size>a.maxSize.value&&(tr(n,{code:Os.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),r.dirty());const i=this._def.valueType;function o(c){const d=new Set;for(const u of c){if(u.status==="aborted")return tn;u.status==="dirty"&&r.dirty(),d.add(u.value)}return{status:r.value,value:d}}const l=[...n.data.values()].map((c,d)=>i._parse(new Rm(n,c,n.path,d)));return n.common.async?Promise.all(l).then(c=>o(c)):o(l)}min(t,r){return new uv({...this._def,minSize:{value:t,message:br.toString(r)}})}max(t,r){return new uv({...this._def,maxSize:{value:t,message:br.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}uv.create=(s,t)=>new uv({valueType:s,minSize:null,maxSize:null,typeName:sn.ZodSet,...Tn(t)});class dk extends Qn{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}dk.create=(s,t)=>new dk({getter:s,typeName:sn.ZodLazy,...Tn(t)});class uk extends Qn{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return tr(r,{received:r.data,code:Os.invalid_literal,expected:this._def.value}),tn}return{status:"valid",value:t.data}}get value(){return this._def.value}}uk.create=(s,t)=>new uk({value:s,typeName:sn.ZodLiteral,...Tn(t)});function E9(s,t){return new Dp({values:s,typeName:sn.ZodEnum,...Tn(t)})}class Dp extends Qn{_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),n=this._def.values;return tr(r,{expected:ta.joinValues(n),received:r.parsedType,code:Os.invalid_type}),tn}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const r=this._getOrReturnCtx(t),n=this._def.values;return tr(r,{received:r.data,code:Os.invalid_enum_value,options:n}),tn}return od(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return Dp.create(t,{...this._def,...r})}exclude(t,r=this._def){return Dp.create(this.options.filter(n=>!t.includes(n)),{...this._def,...r})}}Dp.create=E9;class hk extends Qn{_parse(t){const r=ta.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(t);if(n.parsedType!==dr.string&&n.parsedType!==dr.number){const a=ta.objectValues(r);return tr(n,{expected:ta.joinValues(a),received:n.parsedType,code:Os.invalid_type}),tn}if(this._cache||(this._cache=new Set(ta.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const a=ta.objectValues(r);return tr(n,{received:n.data,code:Os.invalid_enum_value,options:a}),tn}return od(t.data)}get enum(){return this._def.values}}hk.create=(s,t)=>new hk({values:s,typeName:sn.ZodNativeEnum,...Tn(t)});class C1 extends Qn{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==dr.promise&&r.common.async===!1)return tr(r,{code:Os.invalid_type,expected:dr.promise,received:r.parsedType}),tn;const n=r.parsedType===dr.promise?r.data:Promise.resolve(r.data);return od(n.then(a=>this._def.type.parseAsync(a,{path:r.path,errorMap:r.common.contextualErrorMap})))}}C1.create=(s,t)=>new C1({type:s,typeName:sn.ZodPromise,...Tn(t)});class Op extends Qn{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===sn.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:n}=this._processInputParams(t),a=this._def.effect||null,i={addIssue:o=>{tr(n,o),o.fatal?r.abort():r.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),a.type==="preprocess"){const o=a.transform(n.data,i);if(n.common.async)return Promise.resolve(o).then(async l=>{if(r.value==="aborted")return tn;const c=await this._def.schema._parseAsync({data:l,path:n.path,parent:n});return c.status==="aborted"?tn:c.status==="dirty"||r.value==="dirty"?N0(c.value):c});{if(r.value==="aborted")return tn;const l=this._def.schema._parseSync({data:o,path:n.path,parent:n});return l.status==="aborted"?tn:l.status==="dirty"||r.value==="dirty"?N0(l.value):l}}if(a.type==="refinement"){const o=l=>{const c=a.refinement(l,i);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(n.common.async===!1){const l=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return l.status==="aborted"?tn:(l.status==="dirty"&&r.dirty(),o(l.value),{status:r.value,value:l.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(l=>l.status==="aborted"?tn:(l.status==="dirty"&&r.dirty(),o(l.value).then(()=>({status:r.value,value:l.value}))))}if(a.type==="transform")if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!kp(o))return tn;const l=a.transform(o.value,i);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:l}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>kp(o)?Promise.resolve(a.transform(o.value,i)).then(l=>({status:r.value,value:l})):tn);ta.assertNever(a)}}Op.create=(s,t,r)=>new Op({schema:s,typeName:sn.ZodEffects,effect:t,...Tn(r)});Op.createWithPreprocess=(s,t,r)=>new Op({schema:t,effect:{type:"preprocess",transform:s},typeName:sn.ZodEffects,...Tn(r)});class Em extends Qn{_parse(t){return this._getType(t)===dr.undefined?od(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Em.create=(s,t)=>new Em({innerType:s,typeName:sn.ZodOptional,...Tn(t)});class Rp extends Qn{_parse(t){return this._getType(t)===dr.null?od(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Rp.create=(s,t)=>new Rp({innerType:s,typeName:sn.ZodNullable,...Tn(t)});class u4 extends Qn{_parse(t){const{ctx:r}=this._processInputParams(t);let n=r.data;return r.parsedType===dr.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}u4.create=(s,t)=>new u4({innerType:s,typeName:sn.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Tn(t)});class h4 extends Qn{_parse(t){const{ctx:r}=this._processInputParams(t),n={...r,common:{...r.common,issues:[]}},a=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return b1(a)?a.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new dh(n.common.issues)},input:n.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new dh(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}h4.create=(s,t)=>new h4({innerType:s,typeName:sn.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Tn(t)});class mk extends Qn{_parse(t){if(this._getType(t)!==dr.nan){const n=this._getOrReturnCtx(t);return tr(n,{code:Os.invalid_type,expected:dr.nan,received:n.parsedType}),tn}return{status:"valid",value:t.data}}}mk.create=s=>new mk({typeName:sn.ZodNaN,...Tn(s)});class fce extends Qn{_parse(t){const{ctx:r}=this._processInputParams(t),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class b3 extends Qn{_parse(t){const{status:r,ctx:n}=this._processInputParams(t);if(n.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?tn:i.status==="dirty"?(r.dirty(),N0(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{const a=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?tn:a.status==="dirty"?(r.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:n.path,parent:n})}}static create(t,r){return new b3({in:t,out:r,typeName:sn.ZodPipeline})}}class m4 extends Qn{_parse(t){const r=this._def.innerType._parse(t),n=a=>(kp(a)&&(a.value=Object.freeze(a.value)),a);return b1(r)?r.then(a=>n(a)):n(r)}unwrap(){return this._def.innerType}}m4.create=(s,t)=>new m4({innerType:s,typeName:sn.ZodReadonly,...Tn(t)});var sn;(function(s){s.ZodString="ZodString",s.ZodNumber="ZodNumber",s.ZodNaN="ZodNaN",s.ZodBigInt="ZodBigInt",s.ZodBoolean="ZodBoolean",s.ZodDate="ZodDate",s.ZodSymbol="ZodSymbol",s.ZodUndefined="ZodUndefined",s.ZodNull="ZodNull",s.ZodAny="ZodAny",s.ZodUnknown="ZodUnknown",s.ZodNever="ZodNever",s.ZodVoid="ZodVoid",s.ZodArray="ZodArray",s.ZodObject="ZodObject",s.ZodUnion="ZodUnion",s.ZodDiscriminatedUnion="ZodDiscriminatedUnion",s.ZodIntersection="ZodIntersection",s.ZodTuple="ZodTuple",s.ZodRecord="ZodRecord",s.ZodMap="ZodMap",s.ZodSet="ZodSet",s.ZodFunction="ZodFunction",s.ZodLazy="ZodLazy",s.ZodLiteral="ZodLiteral",s.ZodEnum="ZodEnum",s.ZodEffects="ZodEffects",s.ZodNativeEnum="ZodNativeEnum",s.ZodOptional="ZodOptional",s.ZodNullable="ZodNullable",s.ZodDefault="ZodDefault",s.ZodCatch="ZodCatch",s.ZodPromise="ZodPromise",s.ZodBranded="ZodBranded",s.ZodPipeline="ZodPipeline",s.ZodReadonly="ZodReadonly"})(sn||(sn={}));const Tr=Yu.create;sx.create;rx.create;const z0=N1.create;Tp.create;Fm.create;const xce=du.create,uh=eo.create;w1.create;S1.create;nx.create;const dy=Dp.create;C1.create;Em.create;Rp.create;const Cc={string:s=>Yu.create({...s,coerce:!0}),number:s=>sx.create({...s,coerce:!0}),boolean:s=>N1.create({...s,coerce:!0}),bigint:s=>rx.create({...s,coerce:!0}),date:s=>Tp.create({...s,coerce:!0})},pce=uh({companyId:Tr().min(1,"Company is required"),name:Tr().min(1,"Category name is required"),description:Tr().optional(),parentId:Tr().optional(),color:Tr().optional(),icon:Tr().optional(),taxTreatment:dy(["deductible","non-deductible","partially_deductible"]).optional(),approvalThreshold:Cc.number().positive().optional()}),gce=uh({companyId:Tr().min(1,"Company is required"),categoryId:Tr().min(1,"Category is required"),name:Tr().min(1,"Budget name is required"),description:Tr().optional(),period:dy(["monthly","quarterly","yearly"]),startDate:Tr().min(1,"Start date is required"),endDate:Tr().min(1,"End date is required"),amount:Cc.number().positive("Amount must be positive"),alertThreshold:Cc.number().optional()}),vce=uh({companyId:Tr().min(1,"Company is required"),categoryId:Tr().min(1,"Category is required"),name:Tr().min(1,"Rule name is required"),description:Tr().optional(),ruleType:dy(["amount_limit","vendor_restriction","approval_required"]),amountLimit:Cc.number().positive().optional(),blockedVendors:Tr().optional(),requireApproval:z0().optional(),notifyManager:z0().optional(),autoReject:z0().optional(),conditions:Tr().optional(),actions:Tr().optional(),priority:Cc.number().int().min(1,"Priority must be at least 1")}),yce=({expenseId:s})=>{const{data:t,isLoading:r}=ys({queryKey:["expense-journal-entries",s],queryFn:()=>o1.getJournalEntries(s),enabled:!!s});if(r)return e.jsx("div",{className:"w-4 h-4 animate-pulse bg-gray-200 rounded"});const n=t&&t.length>0;return e.jsx("div",{className:`w-2 h-2 rounded-full ${n?"bg-green-500":"bg-gray-300"}`,title:n?"Journal entries exist":"No journal entries"})},jce=({expenseId:s})=>{const{data:t,isLoading:r,error:n}=ys({queryKey:["expense-journal-entries",s],queryFn:()=>o1.getJournalEntries(s),enabled:!!s});return r?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx(kr,{size:"sm",color:"teal"})}):n?e.jsx("div",{className:"text-center py-4 text-red-600",children:e.jsx("p",{children:"Error loading journal entries"})}):!t||t.length===0?e.jsxs("div",{className:"text-center py-4 text-gray-500",children:[e.jsx(ml,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No journal entries found for this expense"}),e.jsx("p",{className:"text-sm",children:"Journal entries are created automatically when expenses are approved"})]}):e.jsx("div",{className:"space-y-4",children:t.map((a,i)=>{var o;return e.jsxs(ne,{className:"border-l-4 border-l-blue-500",children:[e.jsxs(we,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(lh,{className:"h-4 w-4 text-blue-600"}),e.jsxs(Se,{className:"text-sm font-medium",children:["Journal Entry #",i+1]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{variant:a.status==="POSTED"?"default":"secondary",children:a.status}),e.jsx("span",{className:"text-xs text-gray-500",children:Kn(new Date(a.date),"MMM dd, yyyy")})]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:a.memo})]}),e.jsxs(ie,{className:"pt-0",children:[e.jsx("div",{className:"space-y-2",children:(o=a.lines)==null?void 0:o.map((l,c)=>{var d,u;return e.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center gap-2",children:l.debit>0?e.jsxs("div",{className:"flex items-center gap-1 text-red-600",children:[e.jsx(JF,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs font-medium",children:"DR"})]}):e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(KF,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs font-medium",children:"CR"})]})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:(d=l.account)==null?void 0:d.name}),e.jsx("p",{className:"text-xs text-gray-500",children:(u=l.account)==null?void 0:u.code})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-medium",children:["$",(l.debit||l.credit||0).toLocaleString()]}),l.memo&&e.jsx("p",{className:"text-xs text-gray-500",children:l.memo})]})]},c)})}),a.createdBy&&e.jsxs("div",{className:"mt-3 pt-2 border-t text-xs text-gray-500",children:["Created by ",a.createdBy.name||a.createdBy.email," on"," ",Kn(new Date(a.createdAt),"MMM dd, yyyy HH:mm")]})]})]},a.id)})})};function bce(){var mi,Da,fi,qa;const{ready:s}=gu("expenses-page"),{user:t}=Ua(),[r,n]=x.useState(""),[a,i]=x.useState("categories"),[o,l]=x.useState("all"),[c,d]=x.useState(""),[u,h]=x.useState(""),[f,m]=x.useState(""),[p,g]=x.useState(""),[v,y]=x.useState(""),[j,b]=x.useState(!1),[w,N]=x.useState(!1),[C,S]=x.useState(!1),[_,k]=x.useState(!1),[F,A]=x.useState(null),[T,V]=x.useState(null),[M,G]=x.useState(null),[L,J]=x.useState(null),[z,U]=x.useState(null),[oe,Q]=x.useState(new Set),[P,q]=x.useState(!1),[D,se]=x.useState(!1),[he,be]=x.useState(!1),[pe,Ae]=x.useState(null),[Ee,$e]=x.useState(null),[O,te]=x.useState(!1),[re,le]=x.useState(!1),[Z,K]=x.useState(!1),[X,ce]=x.useState(null),[Y,ue]=x.useState(!1),[ve,Le]=x.useState(null),[Me,tt]=x.useState(!1),[fe,ct]=x.useState("expenseDate"),[dt,pt]=x.useState("desc"),[qe,mt]=x.useState(1),[Rt,_e]=x.useState(10),[Xe,At]=x.useState(new Set),[st,$t]=x.useState(new Map),fs=hi(),zt=x.useMemo(()=>zs(),[]),{data:St,isLoading:js,error:et}=ys({queryKey:["company",zt],queryFn:async()=>await de.getCompany(zt),enabled:!!zt,retry:2,retryDelay:1e3}),lt=(St==null?void 0:St.name)||(js?"Loading...":"Company"),{data:Fe,isLoading:ft}=ys({queryKey:["expense-categories",r,zt],queryFn:async()=>{const Ne=await la.getExpenseCategories({companyId:zt,q:r||void 0});return Array.isArray(Ne)?Ne:Ne!=null&&Ne.data&&Array.isArray(Ne.data)?Ne.data:Ne!=null&&Ne.items&&Array.isArray(Ne.items)?Ne.items:[]},enabled:s&&!!zt}),{data:He,isLoading:Je}=ys({queryKey:["budgets",zt],queryFn:async()=>{const Ne=await la.getBudgets();return Array.isArray(Ne)?Ne:Ne!=null&&Ne.data&&Array.isArray(Ne.data)?Ne.data:Ne!=null&&Ne.items&&Array.isArray(Ne.items)?Ne.items:[]},enabled:s&&!!zt}),{data:It,isLoading:Gt}=ys({queryKey:["expense-rules",zt],queryFn:async()=>await la.getExpenseRules(),enabled:s&&!!zt}),{data:qt}=ys({queryKey:["budget-analytics"],queryFn:async()=>await la.getBudgetAnalytics()}),{data:As}=ys({queryKey:["gl-accounts",zt],queryFn:async()=>await JL.getAll(zt),enabled:s&&!!zt}),{data:Ht}=ys({queryKey:["vendors",zt],queryFn:async()=>{const Ne=await Hc.getVendors(zt);return Array.isArray(Ne)?Ne:Ne!=null&&Ne.data&&Array.isArray(Ne.data)?Ne.data:Ne!=null&&Ne.items&&Array.isArray(Ne.items)?Ne.items:[]},enabled:s&&!!zt}),{data:xs,isLoading:Ct}=ys({queryKey:["expenses",o,c,p,v],enabled:a==="expenses",queryFn:async()=>await la.getExpenses(void 0,o==="all"?void 0:o,c||void 0)}),{data:ke,isLoading:gt}=ys({queryKey:["expense",Ee==null?void 0:Ee.id],enabled:!!(Ee!=null&&Ee.id),queryFn:async()=>await la.getExpenseById(Ee.id)}),us=Rs({mutationFn:async Ne=>la.submitExpense(Ne),onSuccess:()=>{fs.invalidateQueries({queryKey:["expenses"]}),ze.success("Expense submitted")}}),We=Rs({mutationFn:async Ne=>{var Dt,ye,Be,Ft,Kt;try{return await la.approveExpense(Ne)}catch(Jt){const kt=((ye=(Dt=Jt==null?void 0:Jt.response)==null?void 0:Dt.data)==null?void 0:ye.details)||((Kt=(Ft=(Be=Jt==null?void 0:Jt.response)==null?void 0:Be.data)==null?void 0:Ft.error)==null?void 0:Kt.message)||(Jt==null?void 0:Jt.message)||"Failed to approve expense";throw new Error(kt)}},onSuccess:async(Ne,Dt)=>{fs.invalidateQueries({queryKey:["expenses"]}),ze.success("Expense approved");try{await wn(Dt)?ze.info("Journal entries already exist for this expense"):(Vn.mutate(Dt),ze.success("Journal entry will be generated automatically"))}catch(ye){console.error("Failed to check journal entries:",ye)}},onError:Ne=>{ze.error(Ne.message||"Failed to approve expense")}});Rs({mutationFn:async Ne=>la.updateExpense(Ne,{status:"paid"}),onSuccess:()=>{fs.invalidateQueries({queryKey:["expenses"]}),ze.success("Expense marked as paid")}});const Et=async Ne=>{var Dt;try{const ye=await la.getExpenseRules();for(const Be of ye||[]){const Ft=Be.ruleType||Be.type||"";let Kt={};try{Kt=Be.conditions?JSON.parse(Be.conditions):{}}catch{}if(Ft==="amount_limit"){const Jt=Number(Kt.amount||Kt.limit||0);if(Jt&&Number(Ne.totalAmount??Ne.amount??0)>Jt)return{ok:!1,message:`Amount exceeds policy limit of ${Jt}`}}if(Ft==="vendor_restriction"){const Jt=Kt.vendors||Kt.blocked||[],kt=((Dt=Ne.vendor)==null?void 0:Dt.name)||Ne.vendorName||"";if(Array.isArray(Jt)&&Jt.some(gs=>gs&&kt&&kt.toLowerCase().includes(String(gs).toLowerCase())))return{ok:!1,message:"Vendor restricted by policy"}}}}catch{}return{ok:!0}},Pt=async Ne=>{const Dt=await Et(Ne);if(!Dt.ok){ze.error(Dt.message||"Policy violation");return}us.mutate(Ne.id)},rs=async Ne=>{try{const ye=(await la.getExpenseRules()||[]).some(Kt=>(Kt.ruleType||Kt.type)==="approval_required"),Be=(t==null?void 0:t.role)||"employee";if(ye&&!(Be==="admin"||Be==="accountant")){ze.error("Approval requires an approver role");return}}catch{}We.mutate(Ne.id)},ms=Ne=>{if(Ne.length===0){ze.error("No expenses to export");return}const Dt=["Date","Description","Category","Vendor","Amount","Currency","Tax","Total","Status","Payment Method","Reference","Department","Project"],ye=Ne.map(kt=>{var gs;return[kt.expenseDate?Kn(new Date(kt.expenseDate),"yyyy-MM-dd"):"",kt.description||"",((gs=kt.category)==null?void 0:gs.name)||"",kt.vendorName||"",Number(kt.amount||0).toFixed(2),kt.currency||"USD",Number(kt.taxAmount||0).toFixed(2),Number(kt.totalAmount||kt.amount||0).toFixed(2),kt.status||"draft",kt.paymentMethod||"",kt.referenceNumber||"",kt.department||"",kt.project||""]}),Be=[Dt.join(","),...ye.map(kt=>kt.map(gs=>`"${String(gs).replace(/"/g,'""')}"`).join(","))].join(`
`),Ft=new Blob([Be],{type:"text/csv;charset=utf-8;"}),Kt=document.createElement("a"),Jt=URL.createObjectURL(Ft);Kt.setAttribute("href",Jt),Kt.setAttribute("download",`expenses_${Kn(new Date,"yyyy-MM-dd_HHmmss")}.csv`),Kt.style.visibility="hidden",document.body.appendChild(Kt),Kt.click(),document.body.removeChild(Kt),ze.success(`Exported ${Ne.length} expense(s) to CSV`)},Bs=Ne=>{if(Ne.length===0){ze.error("No expenses to export");return}const Dt=["Date","Description","Category","Vendor","Amount","Currency","Tax","Total","Status","Payment Method","Reference","Department","Project"],ye=Ne.map(kt=>{var gs;return[kt.expenseDate?Kn(new Date(kt.expenseDate),"yyyy-MM-dd"):"",kt.description||"",((gs=kt.category)==null?void 0:gs.name)||"",kt.vendorName||"",Number(kt.amount||0).toFixed(2),kt.currency||"USD",Number(kt.taxAmount||0).toFixed(2),Number(kt.totalAmount||kt.amount||0).toFixed(2),kt.status||"draft",kt.paymentMethod||"",kt.referenceNumber||"",kt.department||"",kt.project||""]}),Be=`
      <html xmlns:x="urn:schemas-microsoft-com:office:excel">
        <head>
          <meta charset="UTF-8">
          <xml>
            <x:ExcelWorkbook>
              <x:ExcelWorksheets>
                <x:ExcelWorksheet>
                  <x:Name>Expenses</x:Name>
                  <x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions>
                </x:ExcelWorksheet>
              </x:ExcelWorksheets>
            </x:ExcelWorkbook>
          </xml>
        </head>
        <body>
          <table border="1">
            <thead>
              <tr>${Dt.map(kt=>`<th>${kt}</th>`).join("")}</tr>
            </thead>
            <tbody>
              ${ye.map(kt=>`<tr>${kt.map(gs=>`<td>${gs}</td>`).join("")}</tr>`).join("")}
            </tbody>
          </table>
        </body>
      </html>
    `,Ft=new Blob([Be],{type:"application/vnd.ms-excel"}),Kt=document.createElement("a"),Jt=URL.createObjectURL(Ft);Kt.setAttribute("href",Jt),Kt.setAttribute("download",`expenses_${Kn(new Date,"yyyy-MM-dd_HHmmss")}.xls`),Kt.style.visibility="hidden",document.body.appendChild(Kt),Kt.click(),document.body.removeChild(Kt),ze.success(`Exported ${Ne.length} expense(s) to Excel`)},Vs=Ne=>{if(Ne.length===0){ze.error("No expenses to print");return}const Dt=window.open("","","height=800,width=1000");if(!Dt){ze.error("Please allow popups to print");return}const ye=`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Expenses Report</title>
          <style>
            body { font-family: Arial, sans-serif; padding: 20px; }
            h1 { color: #333; border-bottom: 2px solid #10b981; padding-bottom: 10px; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; }
            th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
            th { background-color: #10b981; color: white; }
            tr:nth-child(even) { background-color: #f9f9f9; }
            .total { font-weight: bold; background-color: #e0f2f1; }
            .header-info { margin-bottom: 20px; }
            @media print {
              button { display: none; }
            }
          </style>
        </head>
        <body>
          <div class="header-info">
            <h1>Expenses Report</h1>
            <p><strong>Generated:</strong> ${Kn(new Date,"MMMM dd, yyyy - hh:mm a")}</p>
            <p><strong>Total Expenses:</strong> ${Ne.length}</p>
            <p><strong>Total Amount:</strong> $${Ne.reduce((Be,Ft)=>Be+Number(Ft.totalAmount||Ft.amount||0),0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}</p>
          </div>
          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th>Description</th>
                <th>Category</th>
                <th>Vendor</th>
                <th>Amount</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              ${Ne.map(Be=>{var Ft;return`
                <tr>
                  <td>${Be.expenseDate?Kn(new Date(Be.expenseDate),"MMM dd, yyyy"):"-"}</td>
                  <td>${Be.description||""}</td>
                  <td>${((Ft=Be.category)==null?void 0:Ft.name)||"Uncategorized"}</td>
                  <td>${Be.vendorName||"-"}</td>
                  <td>${Be.currency||"USD"} $${Number(Be.totalAmount||Be.amount||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}</td>
                  <td>${Be.status||"draft"}</td>
                </tr>
              `}).join("")}
              <tr class="total">
                <td colspan="4" style="text-align: right;"><strong>TOTAL:</strong></td>
                <td colspan="2"><strong>$${Ne.reduce((Be,Ft)=>Be+Number(Ft.totalAmount||Ft.amount||0),0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}</strong></td>
              </tr>
            </tbody>
          </table>
        </body>
      </html>
    `;Dt.document.write(ye),Dt.document.close(),Dt.focus(),setTimeout(()=>{Dt.print()},250),ze.success(`Printing ${Ne.length} expense(s)`)},Ws=async()=>{if(Xe.size===0){ze.error("No expenses selected");return}try{const Dt=(await la.getExpenseRules()||[]).some(kt=>(kt.ruleType||kt.type)==="approval_required"),ye=(t==null?void 0:t.role)||"employee";if(Dt&&!(ye==="admin"||ye==="accountant")){ze.error("Bulk approval requires an approver role");return}const Ft=Array.from(Xe);let Kt=0,Jt=0;for(const kt of Ft)try{await We.mutateAsync(kt),Kt++}catch{Jt++}At(new Set),fs.invalidateQueries({queryKey:["expenses"]}),Jt===0?ze.success(`Approved ${Kt} expense(s)`):ze.warning(`Approved ${Kt} expense(s), ${Jt} failed`)}catch{ze.error("Failed to bulk approve expenses")}},Ns=async()=>{if(Xe.size===0){ze.error("No expenses selected");return}const Ne=Array.from(Xe);let Dt=0,ye=0;for(const Be of Ne)try{await Vr.mutateAsync({id:Be,data:{status:"rejected"}}),Dt++}catch{ye++}At(new Set),fs.invalidateQueries({queryKey:["expenses"]}),ye===0?ze.success(`Rejected ${Dt} expense(s)`):ze.warning(`Rejected ${Dt} expense(s), ${ye} failed`)},er=async()=>{if(Xe.size===0){ze.error("No expenses selected");return}if(!confirm(`Are you sure you want to delete ${Xe.size} expense(s)? This action cannot be undone.`))return;const Ne=Array.from(Xe);let Dt=0,ye=0;for(const Be of Ne)try{await deleteExpense.mutateAsync(Be),Dt++}catch{ye++}At(new Set),fs.invalidateQueries({queryKey:["expenses"]}),ye===0?ze.success(`Deleted ${Dt} expense(s)`):ze.warning(`Deleted ${Dt} expense(s), ${ye} failed`)},Ir=Rs({mutationFn:async Ne=>la.createExpenseCategory(Ne),onSuccess:()=>{fs.invalidateQueries({queryKey:["expense-categories"]}),fs.invalidateQueries({queryKey:["budget-analytics"]}),b(!1),ze.success("Expense category created successfully")},onError:Ne=>{var ye,Be;const Dt=((Be=(ye=Ne==null?void 0:Ne.response)==null?void 0:ye.data)==null?void 0:Be.error)||"Failed to create expense category";ze.error(Dt)}}),jn=Rs({mutationFn:async({id:Ne,data:Dt})=>la.updateExpenseCategory(Ne,Dt),onSuccess:()=>{fs.invalidateQueries({queryKey:["expense-categories"]}),fs.invalidateQueries({queryKey:["budget-analytics"]}),b(!1),G(null),ze.success("Expense category updated successfully")},onError:Ne=>{var ye,Be;const Dt=((Be=(ye=Ne==null?void 0:Ne.response)==null?void 0:ye.data)==null?void 0:Be.error)||"Failed to update expense category";ze.error(Dt)}}),Hs=Rs({mutationFn:async Ne=>la.createBudget(Ne),onSuccess:()=>{fs.invalidateQueries({queryKey:["budgets"]}),fs.invalidateQueries({queryKey:["budget-analytics"]}),N(!1),V(null),ze.success("Budget created successfully")},onError:Ne=>{ze.error("Failed to create budget")}}),qr=Rs({mutationFn:async({id:Ne,data:Dt})=>la.updateBudget(Ne,Dt),onSuccess:()=>{fs.invalidateQueries({queryKey:["budgets"]}),fs.invalidateQueries({queryKey:["budget-analytics"]}),N(!1),V(null),ze.success("Budget updated successfully")},onError:Ne=>{ze.error("Failed to update budget")}}),qn=Rs({mutationFn:async Ne=>la.createExpenseRule(Ne),onSuccess:()=>{fs.invalidateQueries({queryKey:["expense-rules"]}),k(!1),ze.success("Expense rule created successfully")},onError:Ne=>{ze.error("Failed to create expense rule")}}),In=Rs({mutationFn:async({id:Ne,data:Dt})=>la.updateExpenseRule(Ne,Dt),onSuccess:()=>{fs.invalidateQueries({queryKey:["expense-rules"]}),k(!1),A(null),ze.success("Expense rule updated successfully")},onError:Ne=>{ze.error("Failed to update expense rule")}}),Yr=Rs({mutationFn:async Ne=>await la.createExpense({...Ne,companyId:Ne.companyId||zs()}),onSuccess:()=>{fs.invalidateQueries({queryKey:["expenses"]}),fs.invalidateQueries({queryKey:["budget-analytics"]}),le(!1),ze.success("Expense created successfully")},onError:Ne=>{var ye,Be;const Dt=((Be=(ye=Ne==null?void 0:Ne.response)==null?void 0:ye.data)==null?void 0:Be.error)||"Failed to create expense";ze.error(Dt)}}),$r=Rs({mutationFn:async Ne=>la.deleteExpenseRule(Ne),onSuccess:()=>{fs.invalidateQueries({queryKey:["expense-rules"]}),ze.success("Expense rule deleted")},onError:()=>ze.error("Failed to delete expense rule")}),Vr=Rs({mutationFn:async Ne=>la.updateExpense(Ne.id,Ne),onSuccess:()=>{fs.invalidateQueries({queryKey:["expenses"]}),ue(!1),$e(null),ze.success("Expense updated successfully")},onError:Ne=>{var Dt,ye,Be,Ft,Kt,Jt;if((Dt=Ne.message)!=null&&Dt.startsWith("Budget exceeded:"))ze.error(Ne.message,{duration:1e4});else if((Ft=(Be=(ye=Ne==null?void 0:Ne.response)==null?void 0:ye.data)==null?void 0:Be.error)!=null&&Ft.startsWith("Budget exceeded:"))ze.error(Ne.response.data.error,{duration:1e4});else{const kt=((Jt=(Kt=Ne==null?void 0:Ne.response)==null?void 0:Kt.data)==null?void 0:Jt.error)||"Failed to update expense";ze.error(kt)}}}),wn=async Ne=>{try{const Dt=await o1.getJournalEntries(Ne);return Dt&&Dt.length>0}catch{return!1}},Vn=Rs({mutationFn:async Ne=>{const Dt=await o1.getJournalEntries(Ne);if(Dt&&Dt.length>0)throw new Error("Journal entries already exist for this expense");const ye=await la.getExpenseById(Ne);if(!ye)throw new Error("Expense not found");return await la.updateExpense(Ne,{...ye,status:ye.status==="draft"?"submitted":ye.status})},onSuccess:(Ne,Dt)=>{fs.invalidateQueries({queryKey:["expenses"]}),fs.invalidateQueries({queryKey:["expense-journal-entries",Dt]}),ze.success("Journal entry generated successfully")},onError:Ne=>{const Dt=(Ne==null?void 0:Ne.message)||"Failed to generate journal entry";ze.error(Dt)}}),De=xm({resolver:pm(pce),defaultValues:{}}),ut=xm({resolver:pm(uh({companyId:Tr().min(1,"Company is required"),categoryId:Tr().min(1,"Category is required"),budgetId:Tr().optional(),description:Tr().min(1,"Description is required"),amount:Cc.number().positive("Amount must be positive"),expenseDate:Tr().min(1,"Expense date is required"),vendorId:Tr().optional(),vendorName:Tr().optional(),notes:Tr().optional(),department:Tr().optional(),project:Tr().optional(),accountId:Tr().optional(),referenceNumber:Tr().optional(),paymentMethod:Tr().optional(),currency:Tr().optional(),taxRate:Cc.number().min(0).max(100).optional(),taxAmount:Cc.number().min(0).optional(),isBillable:z0().optional(),isRecurring:z0().optional(),recurringPeriod:Tr().optional(),mileage:Cc.number().min(0).optional(),mileageRate:Cc.number().min(0).optional()})),defaultValues:{companyId:"",categoryId:"",budgetId:"auto",description:"",amount:0,expenseDate:new Date().toISOString().split("T")[0],vendorId:"",vendorName:"",currency:"USD",paymentMethod:"",isBillable:!1,isRecurring:!1,notes:"",department:"",project:""}}),Pe=xm({resolver:pm(gce),defaultValues:{period:"monthly"}});x.useEffect(()=>{var Ne;T?Pe.reset({companyId:T.companyId||zs(),categoryId:((Ne=T.category)==null?void 0:Ne.id)||"",name:T.name||"",description:T.description||"",period:T.period||"monthly",startDate:T.startDate||"",endDate:T.endDate||"",amount:T.amount||0,alertThreshold:T.alertThreshold||80}):Pe.reset({companyId:zs(),period:"monthly"})},[T,Pe]);const _t=xm({resolver:pm(vce),defaultValues:{companyId:"",categoryId:"",name:"",description:"",ruleType:"approval_required",amountLimit:void 0,blockedVendors:"",requireApproval:!0,notifyManager:!1,autoReject:!1,conditions:"",actions:"",priority:1}}),bt=x.useMemo(()=>{try{return Fe?Array.isArray(Fe)?Fe:Fe.items?Fe.items:Fe.data?Fe.data:[]:[]}catch{return[]}},[Fe]),ps=x.useMemo(()=>{try{return He?Array.isArray(He)?He:He.items?He.items:He.data?He.data:[]:[]}catch{return[]}},[He]),Pr=x.useMemo(()=>{try{return It?Array.isArray(It)?It:It.items?It.items:It.data?It.data:[]:[]}catch{return[]}},[It]),Wr=x.useMemo(()=>{try{return As?Array.isArray(As)?As:As.accounts?As.accounts:As.items?As.items:As.data?As.data:[]:[]}catch{return[]}},[As]);x.useMemo(()=>Wr.filter(Ne=>{var ye,Be;return(((ye=Ne.type)==null?void 0:ye.code)||((Be=Ne.accountType)==null?void 0:Be.code))==="EXPENSE"&&Ne.isActive!==!1}),[Wr]);const Zs=Ne=>{switch(Ne){case"deductible":return"bg-green-100 text-green-800";case"non-deductible":return"bg-red-100 text-red-800";case"partially_deductible":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},wr=Ne=>Ne.spentAmount/Ne.amount*100,xa=Ne=>{const Dt=wr(Ne);return Dt>=100?"over-budget":Dt>=80?"near-limit":"within-budget"},cr=Ne=>{switch(Ne){case"over-budget":return"bg-red-100 text-red-800";case"near-limit":return"bg-yellow-100 text-yellow-800";case"within-budget":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},Zn=Ne=>{const Dt=new Set(oe);Dt.has(Ne)?Dt.delete(Ne):Dt.add(Ne),Q(Dt)},Hi=Ne=>{Ne.parentId==="none"&&(Ne.parentId=void 0),M?jn.mutate({id:M.id,data:Ne}):Ir.mutate(Ne)},Gi=Ne=>{T?qr.mutate({id:T.id,data:Ne}):Hs.mutate(Ne)},Ti=Ne=>{const Dt={...Ne};switch(Ne.ruleType){case"amount_limit":Dt.conditions=JSON.stringify({amount:Ne.amountLimit||0});break;case"vendor_restriction":Dt.conditions=JSON.stringify({vendors:Ne.blockedVendors?Ne.blockedVendors.split(",").map(Be=>Be.trim()):[]});break;case"approval_required":Dt.conditions=JSON.stringify({});break}const ye={};Ne.requireApproval&&(ye.require_approval=!0),Ne.notifyManager&&(ye.notify_manager=!0),Ne.autoReject&&(ye.auto_reject=!0),Dt.actions=JSON.stringify(ye),delete Dt.amountLimit,delete Dt.blockedVendors,delete Dt.requireApproval,delete Dt.notifyManager,delete Dt.autoReject,F?In.mutate({id:F.id,data:Dt}):qn.mutate(Dt)},Ea=Ne=>{const Dt=Number(Ne.amount)||0,ye=Ne.taxAmount||(Ne.taxRate?Dt*Number(Ne.taxRate)/100:0),Be=Dt+ye,Ft={...Ne,taxAmount:ye,totalAmount:Be,vendorId:Ne.vendorId&&Ne.vendorId.trim()!==""?Ne.vendorId:void 0,accountId:Ne.accountId&&Ne.accountId.trim()!==""?Ne.accountId:void 0,splitAccountId:Ne.splitAccountId&&Ne.splitAccountId.trim()!==""?Ne.splitAccountId:void 0};Yr.mutate(Ft)},Ki=(Ne=[],Dt=0)=>(Ne||[]).map(ye=>e.jsxs("div",{children:[e.jsxs("div",{className:`flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 ${Dt>0?"ml-6":""}`,children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[ye.children&&ye.children.length>0&&e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>Zn(ye.id),children:oe.has(ye.id)?e.jsx(tc,{className:"w-4 h-4"}):e.jsx(Tm,{className:"w-4 h-4"})}),e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:ye.color||"#6b7280"}}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:ye.name}),ye.description&&e.jsx("p",{className:"text-sm text-gray-600",children:ye.description})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[ye.taxTreatment&&e.jsx(Oe,{className:Zs(ye.taxTreatment),children:ye.taxTreatment}),e.jsx(Oe,{variant:ye.isActive?"default":"secondary",children:ye.isActive?"Active":"Inactive"}),e.jsx(I,{variant:"outline",size:"sm","aria-label":`Edit category ${ye.name}`,onClick:()=>{G(ye),De.reset({companyId:ye.companyId||zs(),name:ye.name,description:ye.description||"",parentId:ye.parentId||"",color:ye.color||"",icon:ye.icon||"",taxTreatment:ye.taxTreatment||"deductible",approvalThreshold:ye.approvalThreshold||void 0}),b(!0)},children:e.jsx(ln,{className:"w-4 h-4"})})]})]}),oe.has(ye.id)&&ye.children&&ye.children.length>0&&e.jsx("div",{className:"mt-2",children:Ki(ye.children,Dt+1)})]},ye.id));return e.jsxs(Kr,{children:[e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"bg-gradient-to-r from-cyan-50 via-blue-50 to-indigo-50 rounded-2xl p-8 border border-cyan-100 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-2xl flex items-center justify-center shadow-lg",children:e.jsx(Mr,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-cyan-600 to-blue-600 bg-clip-text text-transparent",children:"Expense Management"}),e.jsx("p",{className:"text-slate-600 mt-2 text-lg font-medium",children:"Track, categorize, and manage your business expenses efficiently"}),e.jsxs("div",{className:"flex items-center gap-4 mt-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600 bg-green-50 px-3 py-1 rounded-full",children:[e.jsx(bs,{className:"w-4 h-4"}),e.jsx("span",{children:"System Active"})]}),e.jsxs("div",{className:"text-sm text-slate-500",children:["Last sync: ",new Date().toLocaleTimeString()]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(I,{variant:"outline",onClick:()=>q(!0),className:"h-12 px-6 bg-white hover:bg-cyan-50 border-cyan-200 hover:border-cyan-300 transition-all duration-200",children:[e.jsx(Zt,{className:"w-4 h-4 mr-2"}),"Scan Receipt"]}),e.jsxs(I,{variant:"outline",onClick:()=>se(!0),className:"h-12 px-6 bg-white hover:bg-blue-50 border-blue-200 hover:border-blue-300 transition-all duration-200",children:[e.jsx($s,{className:"w-4 h-4 mr-2"}),"Export Report"]}),e.jsxs(I,{onClick:()=>le(!0),className:"h-12 px-8 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-700 hover:to-blue-700 shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105",children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"New Expense"]})]})]})}),qt&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(ne,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200 hover:shadow-lg transition-all duration-200",children:e.jsx(ie,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-600 mb-1",children:"Total Categories"}),e.jsx("p",{className:"text-3xl font-bold text-blue-900",children:qt.totalCategories}),e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"Expense categories"})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-xl flex items-center justify-center",children:e.jsx(Vw,{className:"w-6 h-6 text-white"})})]})})}),e.jsx(ne,{className:"bg-gradient-to-br from-green-50 to-green-100 border-green-200 hover:shadow-lg transition-all duration-200",children:e.jsx(ie,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-600 mb-1",children:"Active Budgets"}),e.jsx("p",{className:"text-3xl font-bold text-green-900",children:qt.activeBudgets}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Currently active"})]}),e.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-xl flex items-center justify-center",children:e.jsx(wa,{className:"w-6 h-6 text-white"})})]})})}),e.jsx(ne,{className:"bg-gradient-to-br from-teal-50 to-teal-100 border-teal-200 hover:shadow-lg transition-all duration-200",children:e.jsx(ie,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-teal-600 mb-1",children:"Total Budgeted"}),e.jsxs("p",{className:"text-3xl font-bold text-teal-900",children:["$",((mi=qt.totalBudgetedAmount)==null?void 0:mi.toLocaleString())||"0"]}),e.jsx("p",{className:"text-xs text-teal-600 mt-1",children:"Budget allocation"})]}),e.jsx("div",{className:"w-12 h-12 bg-teal-500 rounded-xl flex items-center justify-center",children:e.jsx(Mr,{className:"w-6 h-6 text-white"})})]})})}),e.jsx(ne,{className:"bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200 hover:shadow-lg transition-all duration-200",children:e.jsx(ie,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-orange-600 mb-1",children:"Total Spent"}),e.jsxs("p",{className:"text-3xl font-bold text-orange-900",children:["$",((Da=qt.totalSpentAmount)==null?void 0:Da.toLocaleString())||"0"]}),e.jsx("p",{className:"text-xs text-orange-600 mt-1",children:"Expenses incurred"})]}),e.jsx("div",{className:"w-12 h-12 bg-orange-500 rounded-xl flex items-center justify-center",children:e.jsx($s,{className:"w-6 h-6 text-white"})})]})})})]}),e.jsxs(ne,{className:"shadow-lg border-slate-200",children:[e.jsx(we,{className:"pb-6 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Se,{className:"text-2xl font-bold text-slate-900",children:"Expense Management"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Organize and track your business expenses"})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[a==="categories"&&e.jsxs(ts,{open:j,onOpenChange:b,children:[e.jsx(ki,{asChild:!0,children:e.jsxs(I,{onClick:()=>{G(null),De.reset({companyId:zs(),name:"",description:"",parentId:"",color:"#3B82F6",icon:"",taxTreatment:"deductible",approvalThreshold:void 0})},children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"New Category"]})}),e.jsxs(ss,{children:[e.jsxs(as,{children:[e.jsx(is,{children:M?"Edit Expense Category":"Create Expense Category"}),e.jsx(Ks,{children:M?"Update category information and settings":"Create a new category to organize your expenses"})]}),e.jsx(b0,{...De,children:e.jsxs("form",{onSubmit:De.handleSubmit(Hi),className:"space-y-4",children:[e.jsx(pr,{control:De.control,name:"companyId",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Company"}),e.jsx(yr,{children:e.jsx(ge,{value:lt,disabled:!0,className:"bg-slate-50"})}),e.jsx(Er,{})]})}),e.jsx(pr,{control:De.control,name:"name",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Category Name"}),e.jsx(yr,{children:e.jsx(ge,{placeholder:"Office Supplies",...Ne})}),e.jsx(Er,{})]})}),e.jsx(pr,{control:De.control,name:"description",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Description"}),e.jsx(yr,{children:e.jsx(Xs,{placeholder:"Category description...",...Ne})}),e.jsx(Er,{})]})}),e.jsx(pr,{control:De.control,name:"parentId",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Parent Category (Optional)"}),e.jsxs(rt,{value:Ne.value,onValueChange:Ne.onChange,children:[e.jsx(yr,{children:e.jsx(nt,{children:e.jsx(it,{placeholder:"Select parent category"})})}),e.jsxs(at,{children:[e.jsx(W,{value:"none",children:"None (Top Level)"}),bt.map(Dt=>e.jsx(W,{value:Dt.id,children:Dt.name},Dt.id))]})]}),e.jsx(Er,{})]})}),e.jsx(pr,{control:De.control,name:"color",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Color"}),e.jsx(yr,{children:e.jsx(ge,{type:"color",...Ne})}),e.jsx(Er,{})]})}),e.jsx(pr,{control:De.control,name:"taxTreatment",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Tax Treatment"}),e.jsxs(rt,{value:Ne.value,onValueChange:Ne.onChange,children:[e.jsx(yr,{children:e.jsx(nt,{children:e.jsx(it,{placeholder:"Select tax treatment"})})}),e.jsxs(at,{children:[e.jsx(W,{value:"deductible",children:"Fully Deductible"}),e.jsx(W,{value:"partially_deductible",children:"Partially Deductible"}),e.jsx(W,{value:"non-deductible",children:"Non-Deductible"})]})]}),e.jsx(Er,{})]})}),e.jsx(pr,{control:De.control,name:"approvalThreshold",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Approval Threshold ($)"}),e.jsx(yr,{children:e.jsx(ge,{type:"number",step:"0.01",placeholder:"0.00",...Ne})}),e.jsx(Er,{})]})}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>{b(!1),G(null),De.reset()},children:"Cancel"}),e.jsx(I,{type:"submit",disabled:Ir.status==="pending"||jn.status==="pending",children:Ir.status==="pending"||jn.status==="pending"?M?"Updating...":"Creating...":M?"Update Category":"Create Category"})]})]})})]})]}),a==="expenses"&&e.jsxs(I,{onClick:()=>{ut.reset({companyId:zs(),categoryId:"",description:"",amount:0,expenseDate:new Date().toISOString().split("T")[0],vendorName:"",notes:"",department:"",project:""}),le(!0)},children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"New Expense"]}),a==="budgets"&&e.jsxs(ts,{open:w,onOpenChange:Ne=>{N(Ne),Ne||(Pe.reset(),V(null))},children:[e.jsx(ki,{asChild:!0,children:e.jsxs(I,{children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"New Budget"]})}),e.jsxs(ss,{className:"!max-w-7xl max-h-[95vh] overflow-hidden w-[95vw] flex flex-col",children:[e.jsx(as,{className:"pb-6 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-teal-600 to-teal-700 rounded-xl flex items-center justify-center",children:e.jsx(wa,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx(is,{className:"text-2xl font-bold text-slate-900",children:T?"Edit Budget":"Create New Budget"}),e.jsx(Ks,{className:"text-slate-600 mt-1",children:T?"Update your budget settings and allocations":"Set up a new budget to track and control expenses"})]})]})}),e.jsx(b0,{...Pe,children:e.jsxs("form",{onSubmit:Pe.handleSubmit(Gi),className:"flex flex-col h-full",children:[e.jsx("div",{className:"flex-1 overflow-y-auto max-h-[calc(95vh-200px)] scrollbar-thin scrollbar-thumb-slate-300 scrollbar-track-slate-100 hover:scrollbar-thumb-slate-400 relative",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 py-6 pr-2 pb-8",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-slate-50 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(Lf,{className:"w-5 h-5 text-teal-600"}),"Company & Category"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(pr,{control:Pe.control,name:"companyId",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Company *"}),e.jsx(yr,{children:e.jsx(ge,{value:lt,disabled:!0,className:"bg-slate-50 h-12"})}),e.jsx(Er,{})]})}),e.jsx(pr,{control:Pe.control,name:"categoryId",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Category *"}),e.jsxs(rt,{onValueChange:Ne.onChange,defaultValue:Ne.value,children:[e.jsx(yr,{children:e.jsx(nt,{className:"h-12 bg-white border-slate-300",children:e.jsx(it,{placeholder:"Select category"})})}),e.jsx(at,{children:bt.map(Dt=>e.jsx(W,{value:Dt.id,children:Dt.name},Dt.id))})]}),e.jsx(Er,{})]})})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(Mr,{className:"w-5 h-5 text-teal-600"}),"Budget Details"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(pr,{control:Pe.control,name:"name",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Budget Name *"}),e.jsx(yr,{children:e.jsx(ge,{placeholder:"Q1 Office Supplies Budget",className:"h-12 bg-white border-slate-300",...Ne})}),e.jsx(Er,{})]})}),e.jsx(pr,{control:Pe.control,name:"amount",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Amount *"}),e.jsx(yr,{children:e.jsx(ge,{type:"number",step:"0.01",placeholder:"0.00",className:"h-12 bg-white border-slate-300",...Ne})}),e.jsx(Er,{})]})}),e.jsx(pr,{control:Pe.control,name:"period",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Period *"}),e.jsxs(rt,{onValueChange:Ne.onChange,defaultValue:Ne.value,children:[e.jsx(yr,{children:e.jsx(nt,{className:"h-12 bg-white border-slate-300",children:e.jsx(it,{})})}),e.jsxs(at,{children:[e.jsx(W,{value:"monthly",children:"Monthly"}),e.jsx(W,{value:"quarterly",children:"Quarterly"}),e.jsx(W,{value:"yearly",children:"Yearly"})]})]}),e.jsx(Er,{})]})})]})]})]}),e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-slate-50 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(Zt,{className:"w-5 h-5 text-teal-600"}),"Budget Description"]}),e.jsx(pr,{control:Pe.control,name:"description",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Description"}),e.jsx(yr,{children:e.jsx(Xs,{placeholder:"Describe the purpose and scope of this budget...",className:"min-h-[120px] bg-white border-slate-300 resize-none",...Ne})}),e.jsx(Er,{})]})})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(Xn,{className:"w-5 h-5 text-teal-600"}),"Dates & Alerts"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(pr,{control:Pe.control,name:"startDate",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Start Date *"}),e.jsx(yr,{children:e.jsx(ge,{type:"date",className:"h-12 bg-white border-slate-300",...Ne})}),e.jsx(Er,{})]})}),e.jsx(pr,{control:Pe.control,name:"endDate",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"End Date"}),e.jsx(yr,{children:e.jsx(ge,{type:"date",className:"h-12 bg-white border-slate-300",...Ne})}),e.jsx(Er,{})]})}),e.jsx(pr,{control:Pe.control,name:"alertThreshold",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Alert Threshold (%)"}),e.jsx(yr,{children:e.jsx(ge,{type:"number",step:"1",placeholder:"80",className:"h-12 bg-white border-slate-300",...Ne})}),e.jsx(Er,{})]})})]})]})]})]})}),e.jsx("div",{className:"sticky bottom-0 bg-white border-t border-slate-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>{N(!1),V(null)},className:"h-12 px-6",children:"Cancel"}),e.jsx(I,{type:"submit",disabled:Hs.status==="pending"||qr.status==="pending",className:"h-12 px-8 bg-gradient-to-r from-teal-600 to-teal-700 hover:from-teal-700 hover:to-teal-800 shadow-lg hover:shadow-xl transition-all duration-200",children:Hs.status==="pending"||qr.status==="pending"?e.jsxs(e.Fragment,{children:[e.jsx(kr,{size:"sm",className:"mr-2",color:"teal"}),T?"Updating...":"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(wa,{className:"w-4 h-4 mr-2"}),T?"Update Budget":"Create Budget"]})})]})})]})})]})]}),e.jsx(ts,{open:C,onOpenChange:S,children:e.jsxs(ss,{children:[e.jsxs(as,{children:[e.jsx(is,{children:"Budget Details"}),e.jsx(Ks,{children:"View complete information about this budget"})]}),z&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Budget Name"}),e.jsx("p",{className:"text-lg font-semibold",children:z.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Category"}),e.jsx("p",{className:"text-lg",children:((fi=z.category)==null?void 0:fi.name)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Period"}),e.jsx("p",{className:"text-lg capitalize",children:z.period})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Status"}),e.jsx("p",{className:"text-lg",children:e.jsx(Oe,{variant:xa(z)==="within-budget"?"default":xa(z)==="near-limit"?"secondary":"destructive",children:xa(z)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Budget Amount"}),e.jsxs("p",{className:"text-lg font-semibold text-green-600",children:["$",z.amount.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Amount Spent"}),e.jsxs("p",{className:"text-lg font-semibold text-red-600",children:["$",z.spentAmount.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Start Date"}),e.jsx("p",{className:"text-lg",children:Kn(new Date(z.startDate),"MMM dd, yyyy")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"End Date"}),e.jsx("p",{className:"text-lg",children:Kn(new Date(z.endDate),"MMM dd, yyyy")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Description"}),e.jsx("p",{className:"text-lg",children:z.description||"No description provided"})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Utilization"}),e.jsxs("div",{className:"mt-2",children:[e.jsx(No,{value:wr(z),className:"w-full"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[wr(z).toFixed(1),"% utilized"]})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(I,{variant:"outline",onClick:()=>S(!1),children:"Close"})})]})]})}),a==="rules"&&e.jsxs(ts,{open:_,onOpenChange:Ne=>{k(Ne),Ne||A(null)},children:[e.jsx(ki,{asChild:!0,children:e.jsxs(I,{onClick:()=>{A(null),_t.reset({companyId:"",categoryId:"",name:"",description:"",ruleType:"approval_required",amountLimit:void 0,blockedVendors:"",requireApproval:!0,notifyManager:!1,autoReject:!1,conditions:"",actions:"",priority:1})},children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"New Rule"]})}),e.jsxs(ss,{className:"max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs(as,{className:"flex-shrink-0",children:[e.jsx(is,{children:F?"Edit Expense Rule":"Create Expense Rule"}),e.jsx(Ks,{children:F?"Modify expense rule settings and conditions":"Create automated rules for expense approval and validation"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-1",children:e.jsx(b0,{..._t,children:e.jsxs("form",{onSubmit:_t.handleSubmit(Ti),className:"space-y-4",children:[e.jsx(pr,{control:_t.control,name:"companyId",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Company"}),e.jsx(yr,{children:e.jsx(ge,{value:lt,disabled:!0,className:"bg-slate-50"})}),e.jsx(Er,{})]})}),e.jsx(pr,{control:_t.control,name:"categoryId",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Category"}),e.jsxs(rt,{onValueChange:Ne.onChange,defaultValue:Ne.value,children:[e.jsx(yr,{children:e.jsx(nt,{children:e.jsx(it,{placeholder:"Select category"})})}),e.jsx(at,{children:bt.map(Dt=>e.jsx(W,{value:Dt.id,children:Dt.name},Dt.id))})]}),e.jsx(Er,{})]})}),e.jsx(pr,{control:_t.control,name:"name",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Rule Name"}),e.jsx(yr,{children:e.jsx(ge,{placeholder:"High Amount Approval Rule",...Ne})}),e.jsx(Er,{})]})}),e.jsx(pr,{control:_t.control,name:"description",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Description"}),e.jsx(yr,{children:e.jsx(Xs,{placeholder:"Rule description...",...Ne})}),e.jsx(Er,{})]})}),e.jsx(pr,{control:_t.control,name:"ruleType",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Rule Type"}),e.jsxs(rt,{onValueChange:Ne.onChange,defaultValue:Ne.value,children:[e.jsx(yr,{children:e.jsx(nt,{children:e.jsx(it,{placeholder:"Select rule type"})})}),e.jsxs(at,{children:[e.jsx(W,{value:"amount_limit",children:"Amount Limit"}),e.jsx(W,{value:"vendor_restriction",children:"Vendor Restriction"}),e.jsx(W,{value:"approval_required",children:"Approval Required"})]})]}),e.jsx(Er,{})]})}),_t.watch("ruleType")==="amount_limit"&&e.jsx(pr,{control:_t.control,name:"amountLimit",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Maximum Amount"}),e.jsx(yr,{children:e.jsx(ge,{type:"number",step:"0.01",placeholder:"1000.00",...Ne})}),e.jsx(Er,{})]})}),_t.watch("ruleType")==="vendor_restriction"&&e.jsx(pr,{control:_t.control,name:"blockedVendors",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Blocked Vendors"}),e.jsx(yr,{children:e.jsx(ge,{placeholder:"Vendor1, Vendor2, Vendor3",...Ne})}),e.jsx("p",{className:"text-sm text-gray-500",children:"Separate multiple vendors with commas"}),e.jsx(Er,{})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Actions"}),e.jsx(pr,{control:_t.control,name:"requireApproval",render:({field:Ne})=>e.jsxs(gr,{className:"flex flex-row items-center space-x-3 space-y-0",children:[e.jsx(yr,{children:e.jsx("input",{type:"checkbox",checked:Ne.value,onChange:Ne.onChange,className:"rounded border-gray-300"})}),e.jsx(vr,{className:"text-sm font-normal",children:"Require approval before payment"})]})}),e.jsx(pr,{control:_t.control,name:"notifyManager",render:({field:Ne})=>e.jsxs(gr,{className:"flex flex-row items-center space-x-3 space-y-0",children:[e.jsx(yr,{children:e.jsx("input",{type:"checkbox",checked:Ne.value,onChange:Ne.onChange,className:"rounded border-gray-300"})}),e.jsx(vr,{className:"text-sm font-normal",children:"Notify manager when rule is triggered"})]})}),e.jsx(pr,{control:_t.control,name:"autoReject",render:({field:Ne})=>e.jsxs(gr,{className:"flex flex-row items-center space-x-3 space-y-0",children:[e.jsx(yr,{children:e.jsx("input",{type:"checkbox",checked:Ne.value,onChange:Ne.onChange,className:"rounded border-gray-300"})}),e.jsx(vr,{className:"text-sm font-normal",children:"Automatically reject expenses that violate this rule"})]})})]}),e.jsx(pr,{control:_t.control,name:"priority",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Priority"}),e.jsx(yr,{children:e.jsx(ge,{type:"number",min:"1",placeholder:"1",...Ne})}),e.jsx(Er,{})]})})]})})}),e.jsx("div",{className:"flex-shrink-0 border-t border-slate-200 p-4 bg-slate-50",children:e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>k(!1),children:"Cancel"}),e.jsx(I,{type:"button",disabled:qn.status==="pending"||In.status==="pending",onClick:_t.handleSubmit(Ti),children:qn.status==="pending"||In.status==="pending"?F?"Updating...":"Creating...":F?"Update Rule":"Create Rule"})]})})]})]}),a==="rules"&&e.jsx(I,{variant:"outline",onClick:()=>{k(!0),_t.reset({companyId:"",categoryId:"",name:"Require Approval",description:"All expenses require approval before payment",ruleType:"approval_required",amountLimit:void 0,blockedVendors:"",requireApproval:!0,notifyManager:!1,autoReject:!1,conditions:JSON.stringify({},null,2),actions:JSON.stringify({require_approval:!0},null,2),priority:1})},children:"Require Approval Policy"})]})]})}),e.jsxs(ie,{className:"p-0",children:[e.jsx("div",{className:"px-6 py-4 bg-slate-50 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsx("div",{className:"flex-1 min-w-[300px]",children:e.jsxs("div",{className:"relative",children:[e.jsx(Rn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-4 h-4"}),e.jsx(ge,{placeholder:"Search expenses, categories, budgets...",value:r,onChange:Ne=>n(Ne.target.value),className:"pl-10 h-11 bg-white border-slate-300 focus:border-blue-500 focus:ring-blue-500"})]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(rt,{value:o,onValueChange:l,children:[e.jsx(nt,{className:"w-40 h-11 bg-white border-slate-300",children:e.jsx(it,{placeholder:"Status"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Status"}),e.jsx(W,{value:"draft",children:"Draft"}),e.jsx(W,{value:"pending",children:"Pending"}),e.jsx(W,{value:"approved",children:"Approved"}),e.jsx(W,{value:"rejected",children:"Rejected"})]})]}),e.jsxs(rt,{value:c||"all-categories",onValueChange:Ne=>d(Ne==="all-categories"?"":Ne),children:[e.jsx(nt,{className:"w-48 h-11 bg-white border-slate-300",children:e.jsx(it,{placeholder:"Category"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all-categories",children:"All Categories"}),bt.map(Ne=>e.jsx(W,{value:Ne.id,children:Ne.name},Ne.id))]})]}),e.jsxs(I,{variant:"outline",className:"h-11 px-4 bg-white border-slate-300",children:[e.jsx(Ic,{className:"w-4 h-4 mr-2"}),"Filters"]})]})]})}),e.jsx("div",{className:"px-6 py-4",children:e.jsx(l3,{tabs:[{id:"categories",label:"Categories",icon:Vw},{id:"budgets",label:"Budgets",icon:wa},{id:"rules",label:"Rules",icon:en},{id:"expenses",label:"Expenses",icon:Mr}],value:a,onChange:Ne=>i(Ne)})}),a==="categories"&&e.jsx("div",{className:"px-6 py-6",children:e.jsx("div",{className:"space-y-6",children:ft?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(kr,{size:"lg",color:"teal"})}):bt.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(Vw,{className:"w-8 h-8 text-slate-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:"No expense categories found"}),e.jsx("p",{className:"text-slate-600 mb-6 max-w-md",children:"Create your first expense category to start organizing your business expenses efficiently."}),e.jsxs(I,{onClick:()=>{De.reset({companyId:zs(),name:"",description:"",parentId:"",color:"#6b7280",icon:"",taxTreatment:"deductible",approvalThreshold:void 0}),b(!0)},className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800",children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Create First Category"]})]}):e.jsx("div",{className:"space-y-2",children:Ki(bt)})})}),a==="budgets"&&e.jsx("div",{className:"px-6 py-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsx(ge,{placeholder:"Search budgets...",value:r,onChange:Ne=>n(Ne.target.value),className:"max-w-xs"}),e.jsxs(rt,{value:o,onValueChange:l,children:[e.jsx(nt,{className:"w-40",children:e.jsx(it,{placeholder:"Filter period"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Periods"}),e.jsx(W,{value:"monthly",children:"Monthly"}),e.jsx(W,{value:"quarterly",children:"Quarterly"}),e.jsx(W,{value:"yearly",children:"Yearly"})]})]}),e.jsxs(rt,{value:c||"all-categories",onValueChange:Ne=>d(Ne==="all-categories"?"":Ne),children:[e.jsx(nt,{className:"w-48",children:e.jsx(it,{placeholder:"Filter category"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all-categories",children:"All Categories"}),bt.map(Ne=>e.jsx(W,{value:Ne.id,children:Ne.name},Ne.id))]})]})]}),Je?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(kr,{size:"lg",color:"teal"})}):ps.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(wa,{className:"w-8 h-8 text-slate-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:"No budgets created yet"}),e.jsx("p",{className:"text-slate-600 mb-6 max-w-md",children:"Set up your first budget to track and control your expense spending across different categories."}),e.jsxs(I,{onClick:()=>{Pe.reset({companyId:zs(),categoryId:"",name:"",description:"",period:"monthly",startDate:"",endDate:"",amount:0,alertThreshold:80}),N(!0)},className:"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800",children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Create First Budget"]})]}):e.jsxs(Ol,{children:[e.jsx(Rl,{children:e.jsxs(Dn,{children:[e.jsx(_s,{className:"px-4",children:"Budget Name"}),e.jsx(_s,{className:"px-4",children:"Amount"}),e.jsx(_s,{className:"px-4",children:"Spent"}),e.jsx(_s,{className:"px-4",children:"Status"}),e.jsx(_s,{className:"px-4",children:"Actions"})]})}),e.jsx(Fl,{children:ps.map(Ne=>{const Dt=xa(Ne),ye=wr(Ne);return e.jsxs(Dn,{className:"hover:bg-slate-50",children:[e.jsx(Cs,{className:"font-medium",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),Ne.name]})}),e.jsxs(Cs,{children:[e.jsxs("div",{className:"text-lg font-semibold text-slate-900",children:["$",Ne.amount.toLocaleString()]}),e.jsx("div",{className:"text-sm text-slate-500",children:"Total Budget"})]}),e.jsxs(Cs,{children:[e.jsxs("div",{className:"text-lg font-semibold text-slate-900",children:["$",Ne.spentAmount.toLocaleString()]}),e.jsx("div",{className:"text-sm text-slate-500",children:"Spent"})]}),e.jsx(Cs,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Oe,{className:`${cr(Dt)} px-3 py-1`,children:[Dt==="over-budget"&&e.jsx(Is,{className:"w-3 h-3 mr-1"}),Dt==="near-limit"&&e.jsx(Is,{className:"w-3 h-3 mr-1"}),Dt==="within-budget"&&e.jsx(bs,{className:"w-3 h-3 mr-1"}),Dt.replace("-"," ")]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${Dt==="over-budget"?"bg-red-500":Dt==="near-limit"?"bg-yellow-500":"bg-green-500"}`,style:{width:`${Math.min(ye*100,100)}%`}})}),e.jsxs("div",{className:"text-xs text-slate-500",children:[ye.toFixed(1),"% utilized"]})]})}),e.jsx(Cs,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{variant:"outline",size:"sm","aria-label":`View budget ${Ne.name}`,onClick:()=>{U(Ne),S(!0)},children:e.jsx(ir,{className:"w-4 h-4"})}),e.jsx(I,{variant:"outline",size:"sm","aria-label":`Edit budget ${Ne.name}`,onClick:()=>{var Be;V(Ne),Pe.reset({companyId:Ne.companyId||zs(),categoryId:((Be=Ne.category)==null?void 0:Be.id)||"",name:Ne.name,description:Ne.description||"",period:Ne.period,startDate:Ne.startDate?new Date(Ne.startDate).toISOString().split("T")[0]:"",endDate:Ne.endDate?new Date(Ne.endDate).toISOString().split("T")[0]:"",amount:Ne.amount,alertThreshold:Ne.alertThreshold||80}),N(!0)},children:e.jsx(ln,{className:"w-4 h-4"})})]})})]},Ne.id)})})]})]})}),a==="rules"&&e.jsx("div",{className:"px-6 py-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsx(ge,{placeholder:"Search rules...",value:r,onChange:Ne=>n(Ne.target.value),className:"max-w-xs"}),e.jsxs(rt,{value:o,onValueChange:l,children:[e.jsx(nt,{className:"w-40",children:e.jsx(it,{placeholder:"Filter type"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Types"}),e.jsx(W,{value:"amount_limit",children:"Amount Limit"}),e.jsx(W,{value:"vendor_restriction",children:"Vendor Restriction"}),e.jsx(W,{value:"approval_required",children:"Approval Required"})]})]}),e.jsxs(rt,{value:c||"all-categories",onValueChange:Ne=>d(Ne==="all-categories"?"":Ne),children:[e.jsx(nt,{className:"w-48",children:e.jsx(it,{placeholder:"Filter category"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all-categories",children:"All Categories"}),bt.map(Ne=>e.jsx(W,{value:Ne.id,children:Ne.name},Ne.id))]})]})]}),Gt?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(kr,{size:"lg",color:"teal"})}):Pr.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(en,{className:"w-8 h-8 text-slate-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:"No expense rules configured"}),e.jsx("p",{className:"text-slate-600 mb-6 max-w-md",children:"Create expense rules to automate approval workflows and enforce spending policies across your organization."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(I,{onClick:()=>{_t.reset({companyId:zs(),categoryId:"",name:"Require Approval",description:"All expenses require approval before payment",ruleType:"approval_required",amountLimit:void 0,blockedVendors:"",requireApproval:!0,notifyManager:!1,autoReject:!1,conditions:JSON.stringify({},null,2),actions:JSON.stringify({require_approval:!0},null,2),priority:1}),k(!0)},className:"bg-gradient-to-r from-teal-600 to-teal-700 hover:from-teal-700 hover:to-teal-800",children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Create Approval Rule"]}),e.jsxs(I,{variant:"outline",onClick:()=>{_t.reset({companyId:zs(),categoryId:"",name:"Amount Limit Rule",description:"Set spending limits for expense categories",ruleType:"amount_limit",amountLimit:1e3,blockedVendors:"",requireApproval:!1,notifyManager:!0,autoReject:!1,conditions:"",actions:"",priority:1}),k(!0)},children:[e.jsx(Mr,{className:"w-4 h-4 mr-2"}),"Create Limit Rule"]})]})]}):e.jsxs(Ol,{children:[e.jsx(Rl,{children:e.jsxs(Dn,{children:[e.jsx(_s,{className:"px-4",children:"Rule Name"}),e.jsx(_s,{className:"px-4",children:"Type"}),e.jsx(_s,{className:"px-4",children:"Status"}),e.jsx(_s,{className:"px-4",children:"Actions"})]})}),e.jsx(Fl,{children:Pr.map(Ne=>e.jsxs(Dn,{children:[e.jsx(Cs,{className:"font-medium",children:Ne.name}),e.jsx(Cs,{children:e.jsx(Oe,{variant:"outline",children:Ne.ruleType.replace("_"," ")})}),e.jsx(Cs,{children:e.jsx(Oe,{variant:Ne.isActive?"default":"secondary",children:Ne.isActive?"Active":"Inactive"})}),e.jsx(Cs,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{variant:"outline",size:"sm","aria-label":`Toggle rule ${Ne.name}`,onClick:()=>In.mutate({id:Ne.id,data:{isActive:!Ne.isActive}}),children:Ne.isActive?"Disable":"Enable"}),e.jsx(I,{variant:"outline",size:"sm","aria-label":`Edit rule ${Ne.name}`,onClick:()=>{var Dt;A(Ne),k(!0);try{let ye={},Be={};try{ye=typeof Ne.conditions=="string"?JSON.parse(Ne.conditions):Ne.conditions||{}}catch{}try{Be=typeof Ne.actions=="string"?JSON.parse(Ne.actions):Ne.actions||{}}catch{}const Ft=ye.amount||ye.limit,Kt=Array.isArray(ye.vendors)?ye.vendors.join(", "):"";_t.reset({companyId:zs(),categoryId:((Dt=Ne.category)==null?void 0:Dt.id)||"",name:Ne.name,description:Ne.description||"",ruleType:Ne.ruleType,amountLimit:Ft,blockedVendors:Kt,requireApproval:Be.require_approval||!1,notifyManager:Be.notify_manager||!1,autoReject:Be.auto_reject||!1,conditions:typeof Ne.conditions=="string"?Ne.conditions:JSON.stringify(Ne.conditions||{},null,2),actions:typeof Ne.actions=="string"?Ne.actions:JSON.stringify(Ne.actions||{},null,2),priority:Ne.priority})}catch{}},children:e.jsx(ln,{className:"w-4 h-4"})}),e.jsx(I,{variant:"outline",size:"sm","aria-label":`Delete rule ${Ne.name}`,onClick:()=>$r.mutate(Ne.id),children:e.jsx(hn,{className:"w-4 h-4"})})]})})]},Ne.id))})]})]})}),a==="expenses"&&e.jsx("div",{className:"px-6 py-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[e.jsx(ge,{placeholder:"Search expenses...",value:r,onChange:Ne=>n(Ne.target.value),className:"max-w-xs"}),e.jsxs(rt,{value:o,onValueChange:l,children:[e.jsx(nt,{className:"w-40",children:e.jsx(it,{placeholder:"Filter status"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All"}),e.jsx(W,{value:"draft",children:"Draft"}),e.jsx(W,{value:"submitted",children:"Submitted"}),e.jsx(W,{value:"approved",children:"Approved"}),e.jsx(W,{value:"paid",children:"Paid"})]})]}),e.jsxs(rt,{value:c||"all-categories",onValueChange:Ne=>d(Ne==="all-categories"?"":Ne),children:[e.jsx(nt,{className:"w-48",children:e.jsx(it,{placeholder:"Filter category"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all-categories",children:"All Categories"}),bt.map(Ne=>e.jsx(W,{value:Ne.id,children:Ne.name},Ne.id))]})]}),e.jsx(ge,{type:"date",value:u,onChange:Ne=>h(Ne.target.value),className:"w-40"}),e.jsx(ge,{type:"date",value:f,onChange:Ne=>m(Ne.target.value),className:"w-40"}),e.jsx(ge,{placeholder:"Dept filter",value:p,onChange:Ne=>g(Ne.target.value),className:"w-40"}),e.jsx(ge,{placeholder:"Project filter",value:v,onChange:Ne=>y(Ne.target.value),className:"w-40"}),e.jsx(I,{variant:"outline",onClick:()=>q(!0),children:"New from Receipt"}),e.jsx(I,{variant:"outline",onClick:()=>tt(!0),children:"Import Card CSV"}),e.jsx(I,{variant:"outline",onClick:()=>{window.location.href="/expenses/exceptions"},children:"Exceptions"}),e.jsx(I,{variant:"outline",onClick:()=>{const Ne=(Array.isArray(xs)?xs:(xs==null?void 0:xs.items)||(xs==null?void 0:xs.data)||[]).filter(Jt=>!r||(Jt.description||"").toLowerCase().includes(r.toLowerCase())).filter(Jt=>!u||String(Jt.expenseDate||"").slice(0,10)>=u).filter(Jt=>!f||String(Jt.expenseDate||"").slice(0,10)<=f).filter(Jt=>!p||String(Jt.department||"").toLowerCase().includes(p.toLowerCase())).filter(Jt=>!v||String(Jt.project||"").toLowerCase().includes(v.toLowerCase())).map(Jt=>{var kt;return{date:Jt.expenseDate,description:Jt.description,category:(kt=Jt.category)==null?void 0:kt.name,department:Jt.department||"",project:Jt.project||"",status:Jt.status,amount:Jt.totalAmount}}),ye=[["Date","Description","Category","Department","Project","Status","Amount"].join(","),...Ne.map(Jt=>[Jt.date,JSON.stringify(Jt.description||"").replace(/"/g,'""'),JSON.stringify(Jt.category||"").replace(/"/g,'""'),JSON.stringify(Jt.department||"").replace(/"/g,'""'),JSON.stringify(Jt.project||"").replace(/"/g,'""'),Jt.status,Jt.amount].join(","))],Be=new Blob([ye.join(`
`)],{type:"text/csv;charset=utf-8;"}),Ft=URL.createObjectURL(Be),Kt=document.createElement("a");Kt.href=Ft,Kt.download=`expenses_${new Date().toISOString().slice(0,10)}.csv`,Kt.click(),setTimeout(()=>URL.revokeObjectURL(Ft),3e4)},children:"Export CSV"})]}),Ct?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(kr,{size:"lg",color:"teal"})}):!xs||xs.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(Mr,{className:"w-8 h-8 text-slate-400"})}),e.jsx("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:"No expenses recorded"}),e.jsx("p",{className:"text-slate-600 mb-6 max-w-md",children:"Start tracking your business expenses by creating your first expense entry or importing from receipts."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(I,{onClick:()=>{ut.reset({companyId:zs(),categoryId:"",budgetId:"auto",description:"",amount:0,expenseDate:new Date().toISOString().split("T")[0],vendorName:"",notes:"",department:"",project:""}),le(!0)},className:"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800",children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Create First Expense"]}),e.jsxs(I,{variant:"outline",onClick:()=>q(!0),children:[e.jsx(Zt,{className:"w-4 h-4 mr-2"}),"Scan Receipt"]}),e.jsxs(I,{variant:"outline",onClick:()=>tt(!0),children:[e.jsx(Pl,{className:"w-4 h-4 mr-2"}),"Import CSV"]})]})]}):e.jsx(e.Fragment,{children:(()=>{const Dt=[...(Array.isArray(xs)?xs:(xs==null?void 0:xs.items)||(xs==null?void 0:xs.data)||[]).filter(kt=>!r||(kt.description||"").toLowerCase().includes(r.toLowerCase())||(kt.vendorName||"").toLowerCase().includes(r.toLowerCase())||(kt.referenceNumber||"").toLowerCase().includes(r.toLowerCase())).filter(kt=>!u||String(kt.expenseDate||"").slice(0,10)>=u).filter(kt=>!f||String(kt.expenseDate||"").slice(0,10)<=f).filter(kt=>!p||(kt.description||"").toLowerCase().includes(`[dept: ${p.toLowerCase()}`)).filter(kt=>!v||(kt.description||"").toLowerCase().includes(`[proj: ${v.toLowerCase()}`))].sort((kt,gs)=>{var $n,Ur;let fn=fe==="expenseDate"?kt.expenseDate:fe==="amount"?Number(kt.totalAmount??kt.amount??0):fe==="description"?kt.description||"":fe==="category"?(($n=kt.category)==null?void 0:$n.name)||"":fe==="vendor"?kt.vendorName||"":fe==="status"?kt.status||"":kt[fe],xi=fe==="expenseDate"?gs.expenseDate:fe==="amount"?Number(gs.totalAmount??gs.amount??0):fe==="description"?gs.description||"":fe==="category"?((Ur=gs.category)==null?void 0:Ur.name)||"":fe==="vendor"?gs.vendorName||"":fe==="status"?gs.status||"":gs[fe];return fn<xi?dt==="asc"?-1:1:fn>xi?dt==="asc"?1:-1:0}),ye=Dt.length,Be=Math.ceil(ye/Rt),Ft=(qe-1)*Rt,Kt=Dt.slice(Ft,Ft+Rt),Jt=({field:kt,label:gs})=>e.jsx(_s,{className:"px-4 cursor-pointer select-none hover:bg-slate-50",onClick:()=>{fe===kt?pt(dt==="asc"?"desc":"asc"):(ct(kt),pt("asc"))},children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:gs}),fe===kt?dt==="asc"?e.jsx(JF,{className:"w-4 h-4 text-green-600"}):e.jsx(KF,{className:"w-4 h-4 text-green-600"}):e.jsx(Wu,{className:"w-4 h-4 text-slate-400"})]})});return e.jsxs("div",{className:"space-y-4",children:[Xe.size>0&&e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200 rounded-lg p-4 shadow-md",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(Oe,{className:"bg-green-600 text-white px-3 py-1 text-base font-semibold",children:[Xe.size," ",Xe.size===1?"Expense":"Expenses"," Selected"]}),e.jsx(Jc,{orientation:"vertical",className:"h-6 bg-green-300"}),e.jsxs("span",{className:"text-sm text-slate-600 font-medium",children:["Total: $",Dt.filter(kt=>Xe.has(kt.id)).reduce((kt,gs)=>kt+Number(gs.totalAmount||gs.amount||0),0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(I,{variant:"outline",size:"sm",className:"bg-green-600 hover:bg-green-700 text-white border-green-700",onClick:Ws,children:[e.jsx(Ro,{className:"w-4 h-4 mr-2"}),"Approve Selected"]}),e.jsxs(I,{variant:"outline",size:"sm",className:"bg-orange-600 hover:bg-orange-700 text-white border-orange-700",onClick:Ns,children:[e.jsx(ma,{className:"w-4 h-4 mr-2"}),"Reject Selected"]}),e.jsxs(I,{variant:"outline",size:"sm",className:"bg-red-600 hover:bg-red-700 text-white border-red-700",onClick:er,children:[e.jsx(hn,{className:"w-4 h-4 mr-2"}),"Delete Selected"]}),e.jsx(Jc,{orientation:"vertical",className:"h-6 bg-green-300"}),e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>At(new Set),children:[e.jsx(ma,{className:"w-4 h-4 mr-2"}),"Clear Selection"]})]})]})}),e.jsxs("div",{className:"flex items-center justify-between bg-slate-50 p-4 rounded-lg border border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Show"}),e.jsxs(rt,{value:String(Rt),onValueChange:kt=>{_e(Number(kt)),mt(1)},children:[e.jsx(nt,{className:"w-20 h-9",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"5",children:"5"}),e.jsx(W,{value:"10",children:"10"}),e.jsx(W,{value:"25",children:"25"}),e.jsx(W,{value:"50",children:"50"}),e.jsx(W,{value:"100",children:"100"})]})]}),e.jsx("span",{className:"text-sm text-slate-600",children:ye===0?"No expenses":`Showing ${Ft+1}-${Math.min(Ft+Rt,ye)} of ${ye} expenses`})]}),Xe.size>0&&e.jsxs(Oe,{className:"bg-blue-100 text-blue-800 border-blue-200",children:[Xe.size," selected"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>{fs.invalidateQueries({queryKey:["expenses"]}),ze.success("Expenses refreshed")},children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Refresh"]}),e.jsxs(rt,{value:"",onValueChange:kt=>{const gs=Xe.size>0?Dt.filter(fn=>Xe.has(fn.id)):Dt;kt==="csv"?ms(gs):kt==="excel"?Bs(gs):kt==="print"&&Vs(gs)},children:[e.jsx(nt,{className:"w-[140px] h-9",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(An,{className:"w-4 h-4"}),e.jsx("span",{children:"Export"})]})}),e.jsxs(at,{children:[e.jsx(W,{value:"csv",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Zt,{className:"w-4 h-4"}),e.jsx("span",{children:"Export as CSV"})]})}),e.jsx(W,{value:"excel",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Yf,{className:"w-4 h-4"}),e.jsx("span",{children:"Export as Excel"})]})}),e.jsx(W,{value:"print",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k5,{className:"w-4 h-4"}),e.jsx("span",{children:"Print Report"})]})})]})]})]})]}),e.jsx("div",{className:"border border-slate-200 rounded-lg overflow-hidden",children:e.jsxs(Ol,{children:[e.jsx(Rl,{className:"bg-gradient-to-r from-slate-50 to-slate-100",children:e.jsxs(Dn,{children:[e.jsx(_s,{className:"px-4 w-12",children:e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-slate-300 text-green-600 focus:ring-green-500",checked:Kt.length>0&&Kt.every(kt=>Xe.has(kt.id)),onChange:kt=>{if(kt.target.checked)At(new Set([...Xe,...Kt.map(gs=>gs.id)]));else{const gs=new Set(Xe);Kt.forEach(fn=>gs.delete(fn.id)),At(gs)}}})}),e.jsx(Jt,{field:"expenseDate",label:"Date"}),e.jsx(Jt,{field:"description",label:"Description & Vendor"}),e.jsx(Jt,{field:"category",label:"Category"}),e.jsx(Jt,{field:"amount",label:"Amount"}),e.jsx(Jt,{field:"status",label:"Status"}),e.jsx(_s,{className:"px-4",children:e.jsx("span",{className:"font-semibold",children:"Actions"})})]})}),e.jsx(Fl,{children:Kt.length===0?e.jsx(Dn,{children:e.jsx(Cs,{colSpan:7,className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-2 text-slate-500",children:[e.jsx(Zt,{className:"w-12 h-12 text-slate-300"}),e.jsx("p",{className:"text-lg font-medium",children:"No expenses found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your filters or create a new expense"})]})})}):Kt.map(kt=>{var gs;return e.jsxs(Dn,{className:`hover:bg-slate-50 transition-colors ${Xe.has(kt.id)?"bg-green-50":""}`,children:[e.jsx(Cs,{className:"px-4",children:e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-slate-300 text-green-600 focus:ring-green-500",checked:Xe.has(kt.id),onChange:fn=>{const xi=new Set(Xe);fn.target.checked?xi.add(kt.id):xi.delete(kt.id),At(xi)}})}),e.jsx(Cs,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-gradient-to-br from-green-500 to-emerald-500 rounded-full shadow-sm"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-slate-900",children:kt.expenseDate?Kn(new Date(kt.expenseDate),"MMM dd, yyyy"):"-"}),e.jsx("div",{className:"text-xs text-slate-500",children:kt.expenseDate?Kn(new Date(kt.expenseDate),"hh:mm a"):""})]})]})}),e.jsx(Cs,{className:"max-w-xs",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-semibold text-slate-900 truncate",children:kt.description||"No description"}),e.jsxs("div",{className:"flex items-center gap-2",children:[kt.vendorName&&e.jsx(Oe,{variant:"outline",className:"text-xs bg-purple-50 text-purple-700 border-purple-200",children:kt.vendorName}),kt.referenceNumber&&e.jsxs("span",{className:"text-xs text-slate-500",children:["Ref: ",kt.referenceNumber]})]})]})}),e.jsx(Cs,{children:e.jsx(Oe,{variant:"outline",className:"px-3 py-1 font-medium",children:((gs=kt.category)==null?void 0:gs.name)||"Uncategorized"})}),e.jsx(Cs,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"text-lg font-bold text-slate-900",children:[kt.currency||"USD"," $",Number(kt.totalAmount??kt.amount??0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),kt.taxAmount&&Number(kt.taxAmount)>0&&e.jsxs("div",{className:"text-xs text-slate-500",children:["Tax: $",Number(kt.taxAmount).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})}),e.jsxs(Cs,{children:[e.jsxs(Oe,{className:`px-3 py-1 flex items-center gap-1 w-fit ${kt.status==="approved"?"bg-green-100 text-green-800 border-green-200":kt.status==="pending"||kt.status==="submitted"?"bg-yellow-100 text-yellow-800 border-yellow-200":kt.status==="rejected"?"bg-red-100 text-red-800 border-red-200":"bg-gray-100 text-gray-800 border-gray-200"}`,children:[kt.status==="approved"&&e.jsx(bs,{className:"w-3 h-3"}),(kt.status==="pending"||kt.status==="submitted")&&e.jsx(Is,{className:"w-3 h-3"}),kt.status==="rejected"&&e.jsx(Is,{className:"w-3 h-3"}),e.jsx("span",{className:"capitalize font-medium",children:kt.status||"draft"})]}),kt.status!=="draft"&&e.jsx(yce,{expenseId:kt.id})]}),e.jsx(Cs,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[kt.status==="draft"&&e.jsx(I,{size:"sm",variant:"outline",className:"bg-blue-50 hover:bg-blue-100 text-blue-700 border-blue-200",disabled:us.isPending,onClick:()=>Pt(kt),children:"Submit"}),kt.status==="submitted"&&e.jsxs(e.Fragment,{children:[e.jsx(I,{size:"sm",variant:"outline",className:"bg-green-50 hover:bg-green-100 text-green-700 border-green-200",disabled:We.isPending,onClick:()=>rs(kt),children:"Approve"}),e.jsx(I,{size:"sm",variant:"outline",onClick:()=>{var fn;ce({amount:Number(kt.totalAmount??kt.amount??0),date:(fn=kt.expenseDate)==null?void 0:fn.slice(0,10),description:kt.description}),K(!0)},children:"Match"})]}),kt.status==="approved"&&e.jsx(I,{size:"sm",variant:"outline",className:"bg-purple-50 hover:bg-purple-100 text-purple-700 border-purple-200",onClick:()=>{Ae(kt.id),be(!0)},children:"Reimburse"}),e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>{$e(kt),te(!0)},children:e.jsx(ir,{className:"w-4 h-4"})}),e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>{Le(kt),ue(!0)},children:e.jsx(ln,{className:"w-4 h-4"})}),kt.status!=="draft"&&e.jsx(I,{size:"sm",variant:"outline",className:"bg-blue-50 hover:bg-blue-100 text-blue-700 border-blue-200",disabled:Vn.isPending,onClick:async()=>{if(await wn(kt.id)){ze.error("Journal entries already exist for this expense");return}Vn.mutate(kt.id)},title:"Generate Journal Entry",children:Vn.isPending?e.jsx(kr,{size:"sm",color:"blue"}):e.jsx(ml,{className:"w-4 h-4"})})]})})]},kt.id)})})]})}),Be>1&&e.jsxs("div",{className:"flex items-center justify-between bg-slate-50 p-4 rounded-lg border border-slate-200",children:[e.jsxs("div",{className:"text-sm text-slate-600",children:["Page ",qe," of ",Be]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{variant:"outline",size:"sm",disabled:qe===1,onClick:()=>mt(1),children:"First"}),e.jsxs(I,{variant:"outline",size:"sm",disabled:qe===1,onClick:()=>mt(qe-1),children:[e.jsx(tN,{className:"w-4 h-4 mr-1"}),"Previous"]}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,Be)},(kt,gs)=>{let fn;return Be<=5||qe<=3?fn=gs+1:qe>=Be-2?fn=Be-4+gs:fn=qe-2+gs,e.jsx(I,{variant:qe===fn?"default":"outline",size:"sm",className:qe===fn?"bg-green-600 hover:bg-green-700":"",onClick:()=>mt(fn),children:fn},fn)})}),e.jsxs(I,{variant:"outline",size:"sm",disabled:qe===Be,onClick:()=>mt(qe+1),children:["Next",e.jsx(Tm,{className:"w-4 h-4 ml-1"})]}),e.jsx(I,{variant:"outline",size:"sm",disabled:qe===Be,onClick:()=>mt(Be),children:"Last"})]})]})]})})()})]})})]})]})]}),e.jsxs(e.Fragment,{children:[e.jsx(ioe,{open:P,onOpenChange:q,onCreated:()=>fs.invalidateQueries({queryKey:["expenses"]})}),e.jsx(ooe,{open:D,onOpenChange:se}),e.jsx(loe,{open:he,onOpenChange:Ne=>{be(Ne),Ne||(Ae(null),fs.invalidateQueries({queryKey:["expenses"]}))},expenseId:pe}),e.jsx(coe,{open:Z,onOpenChange:K,amount:X==null?void 0:X.amount,date:X==null?void 0:X.date,description:X==null?void 0:X.description}),e.jsx(doe,{open:Y,onOpenChange:Ne=>{ue(Ne),Ne||(Le(null),fs.invalidateQueries({queryKey:["expenses"]}))},expense:ve}),e.jsx(uoe,{open:Me,onOpenChange:Ne=>{tt(Ne),Ne||fs.invalidateQueries({queryKey:["expenses"]})}}),e.jsx(ts,{open:re,onOpenChange:Ne=>{le(Ne),Ne||ut.reset()},children:e.jsxs(ss,{className:"!max-w-7xl max-h-[95vh] overflow-hidden w-[95vw] flex flex-col bg-gradient-to-br from-slate-50 to-white",children:[e.jsx(as,{className:"pb-6 border-b border-slate-200 bg-white/80 backdrop-blur-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-emerald-500 via-green-500 to-teal-500 rounded-2xl flex items-center justify-center shadow-lg shadow-green-500/30",children:e.jsx(Mr,{className:"w-7 h-7 text-white"})}),e.jsx("div",{className:"absolute -bottom-1 -right-1 w-5 h-5 bg-gradient-to-br from-blue-500 to-purple-500 rounded-full border-2 border-white flex items-center justify-center",children:e.jsx(Ss,{className:"w-3 h-3 text-white"})})]}),e.jsxs("div",{children:[e.jsx(is,{className:"text-3xl font-bold bg-gradient-to-r from-slate-900 to-slate-700 bg-clip-text text-transparent",children:"Create New Expense"}),e.jsx(Ks,{className:"text-slate-600 mt-1 text-sm",children:"Professional expense tracking  Full audit trail  Real-time calculations"})]})]}),e.jsx(Oe,{className:"bg-gradient-to-r from-green-100 to-emerald-100 text-green-700 border-green-200 px-4 py-2 text-sm font-semibold",children:"Draft Mode"})]})}),e.jsx(b0,{...ut,children:e.jsxs("form",{onSubmit:ut.handleSubmit(Ea),className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto max-h-[calc(95vh-200px)] scrollbar-thin scrollbar-thumb-slate-300 scrollbar-track-slate-100 hover:scrollbar-thumb-slate-400 relative",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 py-6 pr-2 pb-8 h-full",children:[e.jsx("div",{className:"lg:w-1/2 space-y-6 flex flex-col",children:e.jsxs("div",{className:"bg-slate-50 rounded-xl p-6 flex-1",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(Lf,{className:"w-5 h-5 text-green-600"}),"Company & Category"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(pr,{control:ut.control,name:"companyId",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Company *"}),e.jsx(yr,{children:e.jsx(ge,{value:lt,disabled:!0,className:"bg-slate-50 h-12"})}),e.jsx(Er,{})]})}),e.jsx(pr,{control:ut.control,name:"categoryId",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Category *"}),e.jsxs(rt,{value:Ne.value,onValueChange:Ne.onChange,children:[e.jsx(yr,{children:e.jsx(nt,{className:"h-12 bg-white border-slate-300",children:e.jsx(it,{placeholder:"Select category"})})}),e.jsx(at,{children:bt.map(Dt=>e.jsx(W,{value:Dt.id,children:Dt.name},Dt.id))})]}),e.jsx(Er,{})]})}),ut.watch("categoryId")&&e.jsx(pr,{control:ut.control,name:"budgetId",render:({field:Ne})=>{const Dt=ps.filter(Be=>Be.categoryId===ut.watch("categoryId")),ye=Dt.length>0;return e.jsxs(gr,{children:[e.jsxs(vr,{className:"text-sm font-medium text-slate-700",children:["Budget to Use ",ye?`(${Dt.length} available)`:"(No budgets)"]}),e.jsxs(rt,{value:Ne.value,onValueChange:Ne.onChange,children:[e.jsx(yr,{children:e.jsx(nt,{className:"h-12 bg-white border-slate-300",children:e.jsx(it,{placeholder:ye?"Auto-select best budget":"No budgets available",children:Ne.value&&Ne.value!=="auto"?(()=>{const Be=Dt.find(Jt=>Jt.id===Ne.value);if(!Be)return null;const Ft=Be.amount-Be.spentAmount,Kt=Be.amount>0?Math.round(Be.spentAmount/Be.amount*100):0;return e.jsxs("div",{className:"flex flex-col text-left",children:[e.jsx("span",{children:Be.name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["$",Ft.toLocaleString()," available (",Kt,"% used)"]})]})})():null})})}),e.jsxs(at,{children:[e.jsx(W,{value:"auto",children:ye?"Auto-select best budget":"No budget (expense will be unbudgeted)"}),Dt.map(Be=>{const Ft=Be.amount-Be.spentAmount,Kt=Be.amount>0?Math.round(Be.spentAmount/Be.amount*100):0;return e.jsx(W,{value:Be.id,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:Be.name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["$",Ft.toLocaleString()," available (",Kt,"% used)"]})]})},Be.id)})]})]}),e.jsx(Er,{}),e.jsx("p",{className:"text-xs text-muted-foreground",children:ye?"Choose which budget to deduct from. Leave blank for automatic selection.":"No budgets exist for this category. Create a budget in the Budgets tab first."})]})}})]})]})}),e.jsx("div",{className:"lg:w-1/2 space-y-6 flex flex-col",children:e.jsxs("div",{className:"bg-slate-50 rounded-xl p-6 flex-1",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(Mr,{className:"w-5 h-5 text-green-600"}),"Expense Details"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(pr,{control:ut.control,name:"description",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Description *"}),e.jsx(yr,{children:e.jsx(ge,{placeholder:"Expense description",className:"h-12 bg-white border-slate-300",...Ne})}),e.jsx(Er,{})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(pr,{control:ut.control,name:"amount",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Amount *"}),e.jsx(yr,{children:e.jsx(ge,{type:"number",step:"0.01",placeholder:"0.00",className:"h-12 bg-white border-slate-300",...Ne,onChange:Dt=>{Ne.onChange(Dt);const ye=ut.watch("taxRate");if(ye){const Be=(Number(Dt.target.value)||0)*(Number(ye)/100);ut.setValue("taxAmount",Be)}}})}),e.jsx(Er,{})]})}),e.jsx(pr,{control:ut.control,name:"currency",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Currency"}),e.jsxs(rt,{value:Ne.value,onValueChange:Ne.onChange,children:[e.jsx(yr,{children:e.jsx(nt,{className:"h-12 bg-white border-slate-300",children:e.jsx(it,{placeholder:"USD"})})}),e.jsxs(at,{children:[e.jsx(W,{value:"USD",children:"USD"}),e.jsx(W,{value:"EUR",children:"EUR"}),e.jsx(W,{value:"GBP",children:"GBP"}),e.jsx(W,{value:"CAD",children:"CAD"})]})]}),e.jsx(Er,{})]})})]}),e.jsx(pr,{control:ut.control,name:"expenseDate",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Expense Date *"}),e.jsx(yr,{children:e.jsx(ge,{type:"date",className:"h-12 bg-white border-slate-300",...Ne})}),e.jsx(Er,{})]})})]})]})}),e.jsxs("div",{className:"lg:w-1/2 space-y-6 flex flex-col",children:[e.jsxs("div",{className:"bg-slate-50 rounded-xl p-6 flex-1",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(Lf,{className:"w-5 h-5 text-green-600"}),"Vendor & Organization"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(pr,{control:ut.control,name:"vendorId",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Vendor"}),e.jsxs(rt,{value:Ne.value,onValueChange:Dt=>{Ne.onChange(Dt);const ye=(Ht||[]).find(Be=>Be.id===Dt);ye&&ut.setValue("vendorName",ye.name)},children:[e.jsx(yr,{children:e.jsx(nt,{className:"h-12 bg-white border-slate-300",children:e.jsx(it,{placeholder:"Select vendor",children:Ne.value&&(()=>{var ye;const Dt=(Ht||[]).find(Be=>Be.id===Ne.value);return Dt?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white text-sm font-semibold",children:(ye=Dt.name)==null?void 0:ye.charAt(0).toUpperCase()}),e.jsx("span",{children:Dt.name})]}):null})()})})}),e.jsxs(at,{children:[e.jsx(W,{value:"none",children:e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(Ss,{className:"w-4 h-4"}),e.jsx("span",{children:"No vendor (cash/misc)"})]})}),(Ht||[]).map(Dt=>{var ye;return e.jsx(W,{value:Dt.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center text-white text-xs font-semibold",children:(ye=Dt.name)==null?void 0:ye.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:Dt.name}),Dt.email&&e.jsx("div",{className:"text-xs text-muted-foreground",children:Dt.email})]})]})},Dt.id)})]})]}),e.jsx(Er,{})]})}),e.jsx(pr,{control:ut.control,name:"department",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Department"}),e.jsx(yr,{children:e.jsx(ge,{placeholder:"Department",className:"h-12 bg-white border-slate-300",...Ne})}),e.jsx(Er,{})]})}),e.jsx(pr,{control:ut.control,name:"project",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Project"}),e.jsx(yr,{children:e.jsx(ge,{placeholder:"Project",className:"h-12 bg-white border-slate-300",...Ne})}),e.jsx(Er,{})]})})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl p-6 flex-1",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(Zt,{className:"w-5 h-5 text-green-600"}),"Additional Notes"]}),e.jsx(pr,{control:ut.control,name:"notes",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Notes"}),e.jsx(yr,{children:e.jsx(Xs,{placeholder:"Additional notes about this expense...",className:"min-h-[120px] bg-white border-slate-300 resize-none",...Ne})}),e.jsx(Er,{})]})})]})]}),e.jsx("div",{className:"lg:w-1/2 space-y-6 flex flex-col",children:e.jsxs("div",{className:"bg-slate-50 rounded-xl p-6 flex-1",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(yn,{className:"w-5 h-5 text-green-600"}),"Accounting Details"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(pr,{control:ut.control,name:"referenceNumber",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Reference/Invoice #"}),e.jsx(yr,{children:e.jsx(ge,{placeholder:"INV-12345",className:"h-12 bg-white border-slate-300",...Ne})}),e.jsx(Er,{})]})}),e.jsx(pr,{control:ut.control,name:"paymentMethod",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Payment Method"}),e.jsxs(rt,{value:Ne.value,onValueChange:Ne.onChange,children:[e.jsx(yr,{children:e.jsx(nt,{className:"h-12 bg-white border-slate-300",children:e.jsx(it,{placeholder:"Select payment method"})})}),e.jsxs(at,{children:[e.jsx(W,{value:"cash",children:"Cash"}),e.jsx(W,{value:"check",children:"Check"}),e.jsx(W,{value:"credit_card",children:"Credit Card"}),e.jsx(W,{value:"debit_card",children:"Debit Card"}),e.jsx(W,{value:"bank_transfer",children:"Bank Transfer"}),e.jsx(W,{value:"ach",children:"ACH"}),e.jsx(W,{value:"wire",children:"Wire Transfer"})]})]}),e.jsx(Er,{})]})})]})]})}),e.jsx("div",{className:"lg:w-1/2 space-y-6 flex flex-col",children:e.jsxs("div",{className:"bg-slate-50 rounded-xl p-6 flex-1",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center gap-2",children:[e.jsx(yn,{className:"w-5 h-5 text-green-600"}),"Tax & Options"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(pr,{control:ut.control,name:"taxRate",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Tax Rate (%)"}),e.jsx(yr,{children:e.jsx(ge,{type:"number",step:"0.01",placeholder:"7.5",className:"h-12 bg-white border-slate-300",...Ne,onChange:Dt=>{Ne.onChange(Dt);const ye=ut.watch("amount");if(ye){const Be=(Number(ye)||0)*(Number(Dt.target.value)/100);ut.setValue("taxAmount",Be)}}})}),e.jsx(Er,{})]})}),e.jsx(pr,{control:ut.control,name:"taxAmount",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Tax Amount"}),e.jsx(yr,{children:e.jsx(ge,{type:"number",step:"0.01",placeholder:"0.00",className:"h-12 bg-white border-slate-300",...Ne})}),e.jsx(Er,{})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(pr,{control:ut.control,name:"isBillable",render:({field:Ne})=>e.jsxs(gr,{className:"flex flex-row items-center justify-between rounded-lg border border-slate-300 bg-white p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(vr,{className:"text-base font-medium",children:"Billable to Client"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Mark if this expense can be billed to a customer/project"})]}),e.jsx(yr,{children:e.jsx("input",{type:"checkbox",checked:Ne.value,onChange:Dt=>Ne.onChange(Dt.target.checked),className:"h-5 w-5"})})]})}),e.jsx(pr,{control:ut.control,name:"isRecurring",render:({field:Ne})=>e.jsxs(gr,{className:"flex flex-row items-center justify-between rounded-lg border border-slate-300 bg-white p-4",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(vr,{className:"text-base font-medium",children:"Recurring Expense"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"This expense repeats regularly"})]}),e.jsx(yr,{children:e.jsx("input",{type:"checkbox",checked:Ne.value,onChange:Dt=>Ne.onChange(Dt.target.checked),className:"h-5 w-5"})})]})}),ut.watch("isRecurring")&&e.jsx(pr,{control:ut.control,name:"recurringPeriod",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Recurring Period"}),e.jsxs(rt,{value:Ne.value,onValueChange:Ne.onChange,children:[e.jsx(yr,{children:e.jsx(nt,{className:"h-12 bg-white border-slate-300",children:e.jsx(it,{placeholder:"Select period"})})}),e.jsxs(at,{children:[e.jsx(W,{value:"weekly",children:"Weekly"}),e.jsx(W,{value:"monthly",children:"Monthly"}),e.jsx(W,{value:"quarterly",children:"Quarterly"}),e.jsx(W,{value:"yearly",children:"Yearly"})]})]}),e.jsx(Er,{})]})})]}),e.jsxs("div",{className:"pt-4 border-t border-slate-300",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900 mb-3",children:"Mileage (Optional)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(pr,{control:ut.control,name:"mileage",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Miles/KM"}),e.jsx(yr,{children:e.jsx(ge,{type:"number",step:"0.1",placeholder:"0",className:"h-12 bg-white border-slate-300",...Ne})}),e.jsx(Er,{})]})}),e.jsx(pr,{control:ut.control,name:"mileageRate",render:({field:Ne})=>e.jsxs(gr,{children:[e.jsx(vr,{className:"text-sm font-medium text-slate-700",children:"Rate per Mile/KM"}),e.jsx(yr,{children:e.jsx(ge,{type:"number",step:"0.01",placeholder:"0.67",className:"h-12 bg-white border-slate-300",...Ne})}),e.jsx(Er,{})]})})]})]})]})]})})]}),e.jsx("div",{className:"px-6 pb-4",children:e.jsxs("div",{className:"bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 rounded-2xl p-6 shadow-2xl border border-slate-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[e.jsx(yn,{className:"w-5 h-5 text-emerald-400"}),"Expense Summary"]}),e.jsx(Oe,{className:"bg-emerald-500/20 text-emerald-300 border-emerald-500/30",children:"Live Preview"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-700/50",children:[e.jsx("span",{className:"text-slate-300 text-sm font-medium",children:"Base Amount"}),e.jsxs("span",{className:"text-white text-lg font-semibold",children:[ut.watch("currency")||"USD"," ",(Number(ut.watch("amount"))||0).toFixed(2)]})]}),(ut.watch("taxRate")||ut.watch("taxAmount"))&&e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-700/50",children:[e.jsxs("span",{className:"text-slate-300 text-sm font-medium flex items-center gap-2",children:["Tax",ut.watch("taxRate")&&e.jsxs(Oe,{className:"bg-slate-700 text-slate-300 text-xs",children:[Number(ut.watch("taxRate")).toFixed(2),"%"]})]}),e.jsxs("span",{className:"text-emerald-400 text-lg font-semibold",children:["+",(Number(ut.watch("taxAmount"))||0).toFixed(2)]})]}),ut.watch("mileage")&&ut.watch("mileageRate")&&e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-700/50",children:[e.jsxs("span",{className:"text-slate-300 text-sm font-medium flex items-center gap-2",children:["Mileage",e.jsxs(Oe,{className:"bg-slate-700 text-slate-300 text-xs",children:[Number(ut.watch("mileage")).toFixed(1),"  $",Number(ut.watch("mileageRate")).toFixed(2)]})]}),e.jsxs("span",{className:"text-blue-400 text-lg font-semibold",children:["$",((Number(ut.watch("mileage"))||0)*(Number(ut.watch("mileageRate"))||0)).toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-3 mt-2 border-t-2 border-emerald-500/30",children:[e.jsx("span",{className:"text-white text-lg font-bold",children:"Total Expense"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-3xl font-bold bg-gradient-to-r from-emerald-400 to-green-400 bg-clip-text text-transparent",children:[ut.watch("currency")||"USD"," ",((Number(ut.watch("amount"))||0)+(Number(ut.watch("taxAmount"))||0)).toFixed(2)]}),ut.watch("isBillable")&&e.jsxs(Oe,{className:"mt-1 bg-purple-500/20 text-purple-300 border-purple-500/30 text-xs",children:[e.jsx(bs,{className:"w-3 h-3 mr-1"}),"Billable to Client"]})]})]})]})]})})]}),e.jsx("div",{className:"sticky bottom-0 bg-gradient-to-r from-white via-slate-50 to-white border-t-2 border-slate-200 p-6 shadow-2xl",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>le(!1),disabled:Yr.isPending,className:"h-14 px-8 text-base font-semibold border-2 border-slate-300 hover:bg-slate-100 transition-all duration-200",children:"Cancel"}),e.jsx(I,{type:"submit",disabled:Yr.isPending,className:"h-14 px-10 text-base font-bold bg-gradient-to-r from-emerald-600 via-green-600 to-teal-600 hover:from-emerald-700 hover:via-green-700 hover:to-teal-700 shadow-xl hover:shadow-2xl transition-all duration-300 hover:scale-105",children:Yr.isPending?e.jsxs(e.Fragment,{children:[e.jsx(kr,{size:"sm",className:"mr-2",color:"teal"}),"Creating Expense..."]}):e.jsxs(e.Fragment,{children:[e.jsx(bs,{className:"w-5 h-5 mr-2"}),"Create Expense"]})})]})})]})})]})}),e.jsx(ts,{open:O,onOpenChange:Ne=>{te(Ne),Ne||$e(null)},children:e.jsxs(ss,{className:"max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs(as,{className:"flex-shrink-0",children:[e.jsx(is,{children:"Expense Details"}),e.jsx(Ks,{children:"View complete information about this expense"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto scrollbar-thin scrollbar-thumb-slate-300 scrollbar-track-slate-100 hover:scrollbar-thumb-slate-400 pr-2",children:gt?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(kr,{size:"lg",color:"teal"})}):ke?e.jsxs("div",{className:"space-y-6 pb-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Description"}),e.jsx("p",{className:"text-lg font-medium",children:ke.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Amount"}),e.jsxs("p",{className:"text-lg font-bold text-green-600",children:["$",Number(ke.totalAmount??ke.amount??0).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Date"}),e.jsx("p",{className:"text-lg",children:ke.expenseDate?new Date(ke.expenseDate).toLocaleDateString():"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Status"}),e.jsx("div",{className:"mt-1",children:e.jsx(Oe,{variant:ke.status==="paid"?"default":"secondary",children:ke.status})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Category"}),e.jsx("p",{className:"text-lg",children:((qa=ke.category)==null?void 0:qa.name)||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Vendor"}),e.jsx("p",{className:"text-lg",children:ke.vendorName||"-"})]})]}),(ke.notes||ke.department||ke.project)&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(Jc,{}),e.jsx("h3",{className:"text-lg font-medium",children:"Additional Information"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[ke.notes&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Notes"}),e.jsx("p",{className:"text-lg",children:ke.notes})]}),ke.department&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Department"}),e.jsx("p",{className:"text-lg",children:ke.department})]}),ke.project&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Project"}),e.jsx("p",{className:"text-lg",children:ke.project})]})]})]}),ke.receiptUrl&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(Jc,{}),e.jsx("h3",{className:"text-lg font-medium",children:"Receipt"}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx(I,{variant:"outline",onClick:()=>window.open(ke.receiptUrl,"_blank"),children:"View Receipt"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Jc,{}),e.jsxs("h3",{className:"text-lg font-medium flex items-center gap-2",children:[e.jsx(ml,{className:"h-5 w-5"}),"Journal Entries"]}),e.jsx(jce,{expenseId:ke.id})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Jc,{}),e.jsx("h3",{className:"text-lg font-medium",children:"Timestamps"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Created"}),e.jsx("p",{className:"text-lg",children:ke.createdAt?new Date(ke.createdAt).toLocaleString():"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Last Updated"}),e.jsx("p",{className:"text-lg",children:ke.updatedAt?new Date(ke.updatedAt).toLocaleString():"-"})]})]})]})]}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"No expense details found"})})})]})})]})]})}const ko=qi.demo.companyId,na=()=>{const s=localStorage.getItem("auth_token")||localStorage.getItem("token");return{"Content-Type":"application/json",Authorization:s?`Bearer ${s}`:"","x-tenant-id":Ii(),"x-company-id":zs()}},Ra={getProducts:async s=>{const t=new URLSearchParams;return(s!=null&&s.companyId||ko)&&t.append("companyId",(s==null?void 0:s.companyId)||ko),s!=null&&s.page&&t.append("page",s.page.toString()),s!=null&&s.pageSize&&t.append("pageSize",s.pageSize.toString()),s!=null&&s.q&&t.append("q",s.q),s!=null&&s.category&&t.append("category",s.category),s!=null&&s.status&&t.append("status",s.status),s!=null&&s.locationId&&t.append("locationId",s.locationId),await de.get(`/api/products?${t.toString()}`,{headers:na()})},getProduct:async s=>await de.get(`/api/products/${s}`,{headers:na()}),createProduct:async s=>await de.post("/api/products",{...s,companyId:s.companyId||ko},{headers:na()}),updateProduct:async(s,t)=>await de.put(`/api/products/${s}`,t,{headers:na()}),deleteProduct:async s=>{await de.delete(`/api/products/${s}`,{headers:na()})},getLocations:async s=>{const t=new URLSearchParams;return t.append("companyId",s||ko),await de.get(`/api/locations?${t.toString()}`,{headers:na()})},createLocation:async s=>await de.post("/api/locations",{...s,companyId:s.companyId||ko},{headers:na()}),updateLocation:async(s,t)=>await de.put(`/api/locations/${s}`,t,{headers:na()}),deleteLocation:async s=>{await de.delete(`/api/locations/${s}`,{headers:na()})},getMovements:async s=>{const t=new URLSearchParams;return(s!=null&&s.companyId||ko)&&t.append("companyId",(s==null?void 0:s.companyId)||ko),s!=null&&s.productId&&t.append("productId",s.productId),s!=null&&s.locationId&&t.append("locationId",s.locationId),s!=null&&s.movementType&&t.append("movementType",s.movementType),s!=null&&s.page&&t.append("page",s.page.toString()),s!=null&&s.pageSize&&t.append("pageSize",s.pageSize.toString()),await de.get(`/api/movements?${t.toString()}`,{headers:na()})},createMovement:async s=>await de.post("/api/inventory-movements",s,{headers:na()}),createProductLocation:async s=>await de.post("/api/product-locations",s,{headers:na()}),getProductLocations:async s=>{const t=new URLSearchParams;return s!=null&&s.companyId&&t.append("companyId",s.companyId),s!=null&&s.locationId&&t.append("locationId",s.locationId),s!=null&&s.productId&&t.append("productId",s.productId),await de.get(`/api/product-locations?${t.toString()}`,{headers:na()})},deleteProductLocation:async s=>await de.delete(`/api/product-locations/${s}`,{headers:na()}),getTransfers:async s=>{const t=new URLSearchParams;return(s!=null&&s.companyId||ko)&&t.append("companyId",(s==null?void 0:s.companyId)||ko),s!=null&&s.status&&t.append("status",s.status),s!=null&&s.page&&t.append("page",s.page.toString()),s!=null&&s.pageSize&&t.append("pageSize",s.pageSize.toString()),await de.get(`/transfers?${t.toString()}`,{headers:na()})},createTransfer:async s=>await de.post("/api/transfers",{...s,companyId:s.companyId||ko},{headers:na()}),getAlerts:async s=>{const t=new URLSearchParams;return(s!=null&&s.companyId||ko)&&t.append("companyId",(s==null?void 0:s.companyId)||ko),s!=null&&s.status&&t.append("status",s.status),await de.get(`/api/alerts?${t.toString()}`,{headers:na()})},generateAlerts:async s=>await de.post(`/api/alerts/generate?companyId=${s}`,{},{headers:na()}),acknowledgeAlert:async s=>await de.post(`/api/alerts/${s}/acknowledge`,{},{headers:na()}),dismissAlert:async s=>await de.post(`/api/alerts/${s}/dismiss`,{},{headers:na()}),getAlertSettings:async()=>await de.get("/api/alerts/settings",{headers:na()}),updateAlertSettings:async s=>await de.post("/api/alerts/settings",s,{headers:na()}),updateTransferStatus:async(s,t,r)=>await de.post(`/api/transfers/${s}/status`,{status:t,completedBy:r},{headers:na()}),getAnalytics:async s=>{const t=new URLSearchParams,r=(s==null?void 0:s.companyId)||zs();return r&&t.append("companyId",r),s!=null&&s.period&&t.append("period",s.period),s!=null&&s.location&&t.append("location",s.location),await de.get(`/api/analytics?${t.toString()}`,{headers:na()})},getKPIs:async s=>{const t=new URLSearchParams,r=(s==null?void 0:s.companyId)||zs();return r&&t.append("companyId",r),s!=null&&s.period&&t.append("period",s.period),s!=null&&s.location&&t.append("location",s.location),await de.get(`/api/kpis?${t.toString()}`,{headers:na()})},getSerialNumbers:async(s,t)=>{const r=new URLSearchParams;return t!=null&&t.status&&r.append("status",t.status),await de.get(`/api/products/${s}/serial-numbers?${r.toString()}`,{headers:na()})},getBatches:async(s,t)=>{const r=new URLSearchParams;return t!=null&&t.status&&r.append("status",t.status),await de.get(`/api/products/${s}/batches?${r.toString()}`,{headers:na()})},getForecasts:async s=>{const t=new URLSearchParams;return(s!=null&&s.companyId||ko)&&t.append("companyId",(s==null?void 0:s.companyId)||ko),s!=null&&s.period&&t.append("period",s.period),s!=null&&s.category&&t.append("category",s.category),s!=null&&s.location&&t.append("location",s.location),s!=null&&s.horizon&&t.append("horizon",s.horizon),await de.get(`/api/forecasts?${t.toString()}`,{headers:na()})},getForecastInsights:async s=>{const t=new URLSearchParams;(s!=null&&s.companyId||ko)&&t.append("companyId",(s==null?void 0:s.companyId)||ko),s!=null&&s.period&&t.append("period",s.period),s!=null&&s.category&&t.append("category",s.category),s!=null&&s.location&&t.append("location",s.location);const r=`/api/forecast-insights?${t.toString()}`;console.log("Calling forecast insights API:",r,"with headers:",na());const n=await de.get(r,{headers:na()});return console.log("Forecast insights API response:",n),n},getAIRecommendations:async s=>{const t=new URLSearchParams;return(s!=null&&s.companyId||ko)&&t.append("companyId",(s==null?void 0:s.companyId)||ko),s!=null&&s.period&&t.append("period",s.period),s!=null&&s.category&&t.append("category",s.category),s!=null&&s.location&&t.append("location",s.location),await de.get(`/api/ai-recommendations?${t.toString()}`,{headers:na()})}},Nce=uh({companyId:Tr().min(1,"Company is required"),vendorId:Tr().min(1,"Vendor is required"),poNumber:Tr().min(1,"PO Number is required"),orderDate:Tr().min(1,"Order date is required"),expectedDelivery:Tr().optional(),orderSource:dy(["internal","external"],{required_error:"Order source is required"}),currency:Tr().default("USD"),notes:Tr().optional(),lines:xce(uh({productId:Tr().optional(),description:Tr().min(1,"Description is required"),quantity:Cc.number().positive("Quantity must be positive"),unitPrice:Cc.number().nonnegative("Unit price must be non-negative"),taxRate:Cc.number().nonnegative().default(0)})).min(1,"At least one line item is required")});function wce(){var J,z;const{ready:s}=gu("purchase-orders-page"),[t,r]=x.useState(zs()),[n,a]=x.useState(""),[i,o]=x.useState("all"),[l,c]=x.useState(!1),[d,u]=x.useState(!1);x.useEffect(()=>{const U=()=>{const Q=zs();Q&&Q!==t&&(console.log(" Purchase Orders page - Company changed from",t,"to",Q),r(Q))};window.addEventListener("storage",U);const oe=Q=>{const P=Q.detail.companyId;P&&P!==t&&(console.log(" Purchase Orders page - Company changed via custom event from",t,"to",P),r(P))};return window.addEventListener("companyChanged",oe),()=>{window.removeEventListener("storage",U),window.removeEventListener("companyChanged",oe)}},[t]);const[h,f]=x.useState(null),[m,p]=x.useState(null),g=hi(),{data:v}=ys({queryKey:["products"],queryFn:async()=>(await Ra.getProducts({companyId:zs()})).items,enabled:s}),{data:y}=ys({queryKey:["companies"],queryFn:async()=>await cN.getCompanies(),enabled:s}),{data:j}=ys({queryKey:["vendors",t],queryFn:async()=>await Hc.getVendors(t),enabled:s}),{data:b,isLoading:w}=ys({queryKey:["purchase-orders",i],queryFn:async()=>{console.log("Fetching purchase orders...",{statusFilter:i});try{const U=await Hc.getPurchaseOrders(t,i==="all"?void 0:i);return console.log("Purchase orders fetched successfully:",U),U}catch(U){throw console.error("Error fetching purchase orders:",U),U}},enabled:s}),{data:N,isLoading:C}=ys({queryKey:["purchase-order",h==null?void 0:h.id],enabled:!!(h!=null&&h.id),queryFn:async()=>await Hc.getPurchaseOrderById(h.id)}),S=Rs({mutationFn:async U=>Hc.createPurchaseOrder(U),onSuccess:()=>{g.invalidateQueries({queryKey:["purchase-orders"]}),c(!1),ze.success("Purchase order created successfully")},onError:U=>{var Q,P,q,D;const oe=((P=(Q=U==null?void 0:U.response)==null?void 0:Q.data)==null?void 0:P.error)||((D=(q=U==null?void 0:U.response)==null?void 0:q.data)==null?void 0:D.message)||(U==null?void 0:U.message)||"Failed to create purchase order";ze.error(oe)}}),_=Rs({mutationFn:async({id:U,data:oe})=>{console.log("Starting purchase order update:",{id:U,data:oe});try{const Q=await Hc.updatePurchaseOrder(U,oe);return console.log("Purchase order updated successfully:",Q),console.log("Invalidating purchase orders queries..."),await g.invalidateQueries({queryKey:["purchase-orders"]}),console.log("Queries invalidated successfully"),Q}catch(Q){throw console.error("Error in updateOrder mutation:",Q),Q}},onSuccess:(U,oe)=>{console.log("Update mutation completed successfully",{response:U,variables:oe}),c(!1),p(null);const Q=oe.data.status;let P="Purchase order updated successfully";switch(Q){case"approved":P="Purchase order approved";break;default:P="Purchase order updated successfully"}ze.success(P)},onError:U=>{var Q,P,q,D;console.error("Purchase order update failed:",U);const oe=((P=(Q=U==null?void 0:U.response)==null?void 0:Q.data)==null?void 0:P.error)||((D=(q=U==null?void 0:U.response)==null?void 0:q.data)==null?void 0:D.message)||(U==null?void 0:U.message)||"Failed to update purchase order";ze.error(oe)}}),k=Rs({mutationFn:async U=>Hc.deletePurchaseOrder(U),onSuccess:()=>{g.invalidateQueries({queryKey:["purchase-orders"]}),ze.success("Purchase order deleted successfully")},onError:U=>{var Q,P,q,D;const oe=((P=(Q=U==null?void 0:U.response)==null?void 0:Q.data)==null?void 0:P.error)||((D=(q=U==null?void 0:U.response)==null?void 0:q.data)==null?void 0:D.message)||(U==null?void 0:U.message)||"Failed to delete purchase order";ze.error(oe)}}),F=xm({resolver:pm(Nce),defaultValues:{companyId:"",vendorId:"",poNumber:"",orderDate:"",expectedDelivery:"",currency:"USD",notes:"",lines:[{description:"",quantity:1,unitPrice:0,taxRate:0}]}}),A=F.watch("lines"),T=(Array.isArray(A)?A:[]).reduce((U,oe)=>{const Q=Number((oe==null?void 0:oe.quantity)||0),P=Number((oe==null?void 0:oe.unitPrice)||0),q=Q*P,D=q*(Number((oe==null?void 0:oe.taxRate)||0)/100);return U.subtotal+=q,U.tax+=D,U.total+=q+D,U},{subtotal:0,tax:0,total:0}),V=U=>{const oe={...U,orderDate:U.orderDate?new Date(U.orderDate).toISOString():void 0,expectedDelivery:U.expectedDelivery?new Date(U.expectedDelivery).toISOString():void 0};m?_.mutate({id:m.id,data:oe}):S.mutate(oe)},M=U=>{switch(U){case"draft":return"secondary";case"approved":return"default";case"delivered":return"default";case"closed":return"secondary";case"cancelled":return"destructive";default:return"secondary"}},G=U=>{switch(U){case"draft":return e.jsx(Zt,{className:"w-4 h-4"});case"approved":return e.jsx(bs,{className:"w-4 h-4"});case"delivered":return e.jsx(Hr,{className:"w-4 h-4"});case"closed":return e.jsx(bs,{className:"w-4 h-4"});case"cancelled":return e.jsx(nc,{className:"w-4 h-4"});default:return e.jsx(Cr,{className:"w-4 h-4"})}},L=(Array.isArray(b)?b:[]).filter(U=>{var oe,Q;return!n||U.poNumber.toLowerCase().includes(n.toLowerCase())||((oe=U.vendor)==null?void 0:oe.name.toLowerCase().includes(n.toLowerCase()))||((Q=U.notes)==null?void 0:Q.toLowerCase().includes(n.toLowerCase()))});return s?e.jsx(Kr,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Purchase Orders"}),e.jsx("p",{className:"text-gray-600",children:"Manage your purchase orders and procurement process"})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(I,{onClick:()=>{p(null);const U=typeof window<"u"&&localStorage.getItem("company_id")||zs(),Q=`PO-${new Date().getTime()}`;F.reset({companyId:U,vendorId:"",poNumber:Q,orderDate:new Date().toISOString().split("T")[0],expectedDelivery:"",orderSource:"external",currency:"USD",notes:"",lines:[{description:"",quantity:1,unitPrice:0,taxRate:0}]}),c(!0)},children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"New Purchase Order"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(ne,{children:e.jsx(ie,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Zt,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Orders"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Array.isArray(b)?b.length:0})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Mr,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Value"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900 truncate",children:["$",Array.isArray(b)?b.reduce((U,oe)=>U+Number(oe.totalAmount||0),0).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}):"0"]})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(PY,{className:"w-5 h-5 text-orange-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending Orders"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Array.isArray(b)?b.filter(U=>["draft","sent"].includes(U.status)).length:0})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(bs,{className:"w-5 h-5 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Completed Orders"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Array.isArray(b)?b.filter(U=>["approved","delivered"].includes(U.status)).length:0})]})]})})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Purchase Orders"})}),e.jsxs(ie,{children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Rn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(ge,{placeholder:"Search purchase orders...",value:n,onChange:U=>a(U.target.value),className:"pl-10"})]})}),e.jsxs(rt,{value:i,onValueChange:o,children:[e.jsx(nt,{className:"w-48",children:e.jsx(it,{placeholder:"Filter by status"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Status"}),e.jsx(W,{value:"draft",children:"Draft"}),e.jsx(W,{value:"approved",children:"Approved"}),e.jsx(W,{value:"delivered",children:"Delivered"}),e.jsx(W,{value:"closed",children:"Closed"}),e.jsx(W,{value:"cancelled",children:"Cancelled"})]})]})]}),w?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(kr,{size:"lg"})}):e.jsx("div",{className:"overflow-hidden",children:e.jsxs(Ol,{children:[e.jsx(Rl,{children:e.jsxs(Dn,{children:[e.jsx(_s,{className:"w-[120px]",children:"PO Number"}),e.jsx(_s,{className:"w-[200px]",children:"Vendor"}),e.jsx(_s,{className:"w-[100px]",children:"Date"}),e.jsx(_s,{className:"w-[120px]",children:"Amount"}),e.jsx(_s,{className:"w-[100px]",children:"Status"}),e.jsx(_s,{className:"w-[80px]",children:"Actions"})]})}),e.jsx(Fl,{children:L.length===0?e.jsx(Dn,{children:e.jsx(Cs,{colSpan:6,className:"text-center py-8",children:e.jsxs("div",{className:"text-gray-500",children:[e.jsx(Zt,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No purchase orders found"}),e.jsx("p",{className:"text-sm",children:"Create your first purchase order to get started"})]})})}):L.map(U=>{var oe,Q;return e.jsxs(Dn,{children:[e.jsx(Cs,{className:"font-medium",children:U.poNumber}),e.jsx(Cs,{className:"truncate",title:((oe=U.vendor)==null?void 0:oe.name)||"-",children:((Q=U.vendor)==null?void 0:Q.name)||"-"}),e.jsx(Cs,{className:"text-sm text-gray-600",children:U.orderDate?Kn(new Date(U.orderDate),"MMM dd"):"-"}),e.jsxs(Cs,{className:"font-medium",children:["$",U.totalAmount.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})]}),e.jsx(Cs,{children:e.jsxs(Oe,{variant:M(U.status),className:"flex items-center gap-1 w-fit",children:[G(U.status),U.status]})}),e.jsx(Cs,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{size:"sm",variant:"outline",onClick:()=>{f(U),u(!0)},title:"View Details",className:"h-8 w-8 p-0",children:e.jsx(ir,{className:"w-4 h-4"})}),U.status==="approved"&&e.jsx(I,{size:"sm",variant:"default",onClick:async()=>{var P,q;if(confirm("Mark this purchase order as delivered? This will update inventory and create accounting entries."))try{await Hc.markAsDelivered(U.id,{deliveredDate:new Date().toISOString(),deliveredBy:"System",notes:"Delivered via purchase order system"}),ze.success("Purchase order delivered successfully! Inventory and accounting updated."),window.location.reload()}catch(D){console.error("Delivery failed:",D),ze.error("Failed to deliver purchase order: "+(((q=(P=D==null?void 0:D.response)==null?void 0:P.data)==null?void 0:q.message)||D.message||"Unknown error"))}},title:"Mark as Delivered",className:"h-8 w-8 p-0 bg-green-600 hover:bg-green-700",children:e.jsx(Hr,{className:"w-4 h-4"})}),e.jsx(I,{size:"sm",variant:"outline",disabled:U.status==="closed"||U.status==="cancelled",onClick:()=>{var P,q;p(U),F.reset({companyId:((P=U.company)==null?void 0:P.id)||((q=y==null?void 0:y[0])==null?void 0:q.id)||"",vendorId:U.vendorId,poNumber:U.poNumber,orderDate:U.orderDate?new Date(U.orderDate).toISOString().split("T")[0]:"",expectedDelivery:U.expectedDelivery?new Date(U.expectedDelivery).toISOString().split("T")[0]:"",orderSource:U.orderSource||"external",currency:U.currency||"USD",notes:U.notes||"",lines:U.lines.map(D=>({id:D.id,productId:D.productId||"",description:D.description,quantity:D.quantity,unitPrice:D.unitPrice,taxRate:D.taxRate}))}),c(!0)},title:U.status==="closed"||U.status==="cancelled"?"Cannot edit closed or cancelled orders":"Edit Purchase Order",className:"h-8 w-8 p-0",children:e.jsx(ln,{className:"w-4 h-4"})}),e.jsxs(rt,{value:U.status,disabled:U.status==="closed"||U.status==="cancelled",onValueChange:async P=>{var q;if(P!==U.status){if(U.status==="delivered"&&(P==="draft"||P==="approved")){ze.error("Cannot change status from delivered back to draft or approved");return}if(U.status==="approved"&&P==="draft"){ze.error("Cannot change status from approved back to draft");return}const D=U.companyId||((q=U.company)==null?void 0:q.id),se=U.vendorId;if(!D||!se){ze.error("Missing required company or vendor information");return}if(P==="delivered")try{const be={deliveredDate:new Date().toISOString(),deliveredBy:"System",notes:`Status changed to delivered on ${new Date().toLocaleDateString()}`,journalEntryData:{memo:`Inventory delivered from PO ${U.poNumber}`,reference:`PO-${U.poNumber}-DELIVERED`}},pe=zs(),Ae=localStorage.getItem("tenant_id")||"tenant_demo",Ee=localStorage.getItem("token")||localStorage.getItem("auth_token"),$e=await fetch(un(`api/purchase-orders/${U.id}/deliver`),{method:"POST",headers:{Authorization:`Bearer ${Ee}`,"x-tenant-id":Ae,"x-company-id":pe,"Content-Type":"application/json"},body:JSON.stringify(be)});if(!$e.ok){const O=await $e.json();throw new Error(O.message||`Failed to deliver: ${$e.status} ${$e.statusText}`)}ze.success("Purchase order delivered successfully! Inventory and accounting updated."),await g.invalidateQueries({queryKey:["purchase-orders"]});return}catch(be){console.error("Delivery failed:",be),ze.error("Failed to deliver purchase order: "+((be==null?void 0:be.message)||"Unknown error"));return}const he=U.orderDate?new Date(U.orderDate).toISOString():new Date().toISOString();_.mutate({id:U.id,data:{status:P,companyId:D,vendorId:se,poNumber:U.poNumber,orderDate:he,expectedDelivery:U.expectedDelivery?new Date(U.expectedDelivery).toISOString():void 0,orderSource:U.orderSource||"external",currency:U.currency||"USD",notes:U.notes||"",lines:U.lines.map(be=>({id:be.id,productId:be.productId||"",description:be.description||"",quantity:Number(be.quantity)||1,unitPrice:Number(be.unitPrice)||0,taxRate:Number(be.taxRate)||0}))}})}},children:[e.jsx(nt,{className:"w-[130px]",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"draft",disabled:U.status==="delivered"||U.status==="approved",children:"Draft"}),e.jsx(W,{value:"approved",disabled:U.status==="delivered",children:"Approved"}),e.jsx(W,{value:"delivered",children:"Delivered"}),e.jsx(W,{value:"closed",children:"Closed"}),e.jsx(W,{value:"cancelled",children:"Cancelled"})]})]}),e.jsx(I,{size:"sm",variant:"outline",disabled:U.status==="closed"||U.status==="cancelled",onClick:()=>{confirm("Are you sure you want to delete this purchase order?")&&k.mutate(U.id)},title:U.status==="closed"||U.status==="cancelled"?"Only draft orders can be deleted":"Delete Purchase Order",className:U.status==="closed"||U.status==="cancelled"?"opacity-50 cursor-not-allowed":"",children:e.jsx(hn,{className:"w-4 h-4"})})]})})]},U.id)})})]})})]})]}),e.jsx(ts,{open:l,onOpenChange:U=>{c(U),U||(p(null),F.reset())},children:e.jsxs(ss,{className:"max-w-7xl max-h-[90vh] overflow-y-auto ",children:[e.jsx(as,{children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsx(is,{children:m?e.jsxs("span",{children:["Edit Purchase Order",m.poNumber?e.jsxs("span",{className:"ml-2 text-sm font-normal text-muted-foreground",children:["#",m.poNumber]}):null]}):"Create Purchase Order"}),m?e.jsxs(Oe,{variant:M(m.status),className:"mt-1 flex items-center gap-1 w-fit",children:[G(m.status),m.status]}):null]})}),m?e.jsxs("div",{className:"mb-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{className:"p-3 border rounded-md bg-white/50",children:[e.jsx("div",{className:"text-muted-foreground",children:"Vendor"}),e.jsx("div",{className:"font-medium",children:((J=m.vendor)==null?void 0:J.name)||"-"})]}),e.jsxs("div",{className:"p-3 border rounded-md bg-white/50",children:[e.jsx("div",{className:"text-muted-foreground",children:"Order Date"}),e.jsx("div",{className:"font-medium",children:m.orderDate?Kn(new Date(m.orderDate),"MMM dd, yyyy"):"-"})]}),e.jsxs("div",{className:"p-3 border rounded-md bg-white/50",children:[e.jsx("div",{className:"text-muted-foreground",children:"Expected Delivery"}),e.jsx("div",{className:"font-medium",children:m.expectedDelivery?Kn(new Date(m.expectedDelivery),"MMM dd, yyyy"):"-"})]}),e.jsxs("div",{className:"p-3 border rounded-md bg-white/50",children:[e.jsx("div",{className:"text-muted-foreground",children:"Current Total"}),e.jsxs("div",{className:"font-semibold",children:["$",(m.totalAmount||0).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})]})]})]}):null,e.jsx(b0,{...F,children:e.jsxs("form",{onSubmit:F.handleSubmit(V),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:[e.jsx(pr,{control:F.control,name:"companyId",render:({field:U})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Company"}),e.jsxs(rt,{value:U.value,onValueChange:U.onChange,children:[e.jsx(yr,{children:e.jsx(nt,{className:"w-full",children:e.jsx(it,{placeholder:"Select company"})})}),e.jsx(at,{children:y==null?void 0:y.map(oe=>e.jsx(W,{value:oe.id,children:oe.name},oe.id))})]}),e.jsx(Er,{})]})}),e.jsx(pr,{control:F.control,name:"vendorId",render:({field:U})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Vendor"}),e.jsxs("div",{className:"flex gap-2 items-start",children:[e.jsxs(rt,{onValueChange:U.onChange,value:U.value,children:[e.jsx(yr,{children:e.jsx(nt,{className:"w-full",children:e.jsx(it,{placeholder:"Select a vendor"})})}),e.jsx(at,{children:j==null?void 0:j.map(oe=>e.jsx(W,{value:oe.id,children:oe.name},oe.id))})]}),e.jsx(I,{type:"button",variant:"outline",size:"sm",onClick:async()=>{const oe=typeof window<"u"?window.prompt("New vendor name"):"";if(oe)try{await Hc.createVendor({name:oe,companyId:t}),ze.success("Vendor created"),await g.invalidateQueries({queryKey:["vendors",t]})}catch(Q){ze.error((Q==null?void 0:Q.message)||"Failed to create vendor")}},children:"Add"})]}),e.jsx(Er,{})]})}),e.jsx(pr,{control:F.control,name:"poNumber",render:({field:U})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"PO Number"}),e.jsx(yr,{children:e.jsx(ge,{placeholder:"PO-2024-001",...U})}),e.jsx(Er,{})]})}),e.jsx(pr,{control:F.control,name:"orderDate",render:({field:U})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Order Date"}),e.jsx(yr,{children:e.jsx(ge,{type:"date",...U})}),e.jsx(Er,{})]})}),e.jsx(pr,{control:F.control,name:"expectedDelivery",render:({field:U})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Expected Delivery"}),e.jsx(yr,{children:e.jsx(ge,{type:"date",...U})}),e.jsx(Er,{})]})}),e.jsx(pr,{control:F.control,name:"orderSource",render:({field:U})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Order Source"}),e.jsxs(rt,{value:U.value,onValueChange:U.onChange,children:[e.jsx(yr,{children:e.jsx(nt,{className:"w-full",children:e.jsx(it,{placeholder:"Select order source"})})}),e.jsxs(at,{children:[e.jsx(W,{value:"internal",children:"Internal"}),e.jsx(W,{value:"external",children:"External"})]})]}),e.jsx(Er,{})]})}),e.jsx(pr,{control:F.control,name:"currency",render:({field:U})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Currency"}),e.jsxs(rt,{value:U.value,onValueChange:U.onChange,children:[e.jsx(yr,{children:e.jsx(nt,{className:"w-full",children:e.jsx(it,{placeholder:"Select currency"})})}),e.jsxs(at,{children:[e.jsx(W,{value:"USD",children:"USD"}),e.jsx(W,{value:"EUR",children:"EUR"}),e.jsx(W,{value:"GBP",children:"GBP"}),e.jsx(W,{value:"RWF",children:"RWF"})]})]}),e.jsx(Er,{})]})})]}),e.jsx(pr,{control:F.control,name:"notes",render:({field:U})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Notes"}),e.jsx(yr,{children:e.jsx(Xs,{placeholder:"Additional notes...",...U})}),e.jsx(Er,{})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h3",{className:"text-lg font-medium",children:"Line Items"})}),e.jsx("div",{className:"overflow-x-auto",children:F.watch("lines").map((U,oe)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-6 gap-4 p-5 border rounded-lg min-w-[1100px]",children:[e.jsx(pr,{control:F.control,name:`lines.${oe}.productId`,render:({field:Q})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Product"}),e.jsxs("div",{className:"flex gap-2 items-start",children:[e.jsxs(rt,{value:Q.value,onValueChange:P=>{Q.onChange(P);const q=v==null?void 0:v.find(D=>D.id===P);q&&(F.setValue(`lines.${oe}.description`,q.name),F.setValue(`lines.${oe}.unitPrice`,q.unitPrice))},children:[e.jsx(yr,{children:e.jsx(nt,{className:"w-full",children:e.jsx(it,{placeholder:"Select product",children:(()=>{const P=F.getValues(`lines.${oe}.productId`),q=v==null?void 0:v.find(D=>D.id===P);return q?q.name:"Select product"})()})})}),e.jsx(at,{children:v==null?void 0:v.map(P=>e.jsx(W,{value:P.id,disabled:P.status==="DISCONTINUED",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:P.name}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[P.stockQuantity," in stock",P.status==="INACTIVE"&&" (Inactive)"]})]})},P.id))})]}),e.jsx(I,{type:"button",variant:"outline",size:"sm",onClick:async()=>{const P=typeof window<"u"?window.prompt("New product name"):"";if(P)try{const q=await Ra.createProduct({name:P,companyId:t,unitPrice:0,costPrice:0,sku:`SKU-${Date.now()}`});ze.success("Product created"),await g.invalidateQueries({queryKey:["products"]}),F.setValue(`lines.${oe}.productId`,q.id),F.setValue(`lines.${oe}.description`,q.name)}catch(q){ze.error((q==null?void 0:q.message)||"Failed to create product")}},children:"Add"})]}),e.jsx(Er,{})]})}),e.jsx(pr,{control:F.control,name:`lines.${oe}.description`,render:({field:Q})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Description"}),e.jsx(yr,{children:e.jsx(ge,{placeholder:"Item description",...Q})}),e.jsx(Er,{})]})}),e.jsx(pr,{control:F.control,name:`lines.${oe}.quantity`,render:({field:Q})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Quantity"}),e.jsx(yr,{children:e.jsx(ge,{type:"number",placeholder:"1",...Q})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enter the number of units"}),e.jsx(Er,{})]})}),e.jsx(pr,{control:F.control,name:`lines.${oe}.unitPrice`,render:({field:Q})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Unit Price"}),e.jsx(yr,{children:e.jsx(ge,{type:"number",placeholder:"0.00",...Q})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Price per unit before tax"}),e.jsx(Er,{})]})}),e.jsx(pr,{control:F.control,name:`lines.${oe}.taxRate`,render:({field:Q})=>e.jsxs(gr,{children:[e.jsx(vr,{children:"Tax Rate (%)"}),e.jsx(yr,{children:e.jsx(ge,{type:"number",placeholder:"0",...Q})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"e.g., 18 for 18%"}),e.jsx(Er,{})]})}),e.jsxs("div",{className:"flex items-end justify-between",children:[e.jsxs("div",{className:"text-right ml-auto",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Line Total"}),e.jsx("div",{className:"font-semibold",children:(()=>{const Q=F.getValues("lines")[oe]||{},P=Number((Q==null?void 0:Q.quantity)||0),q=Number((Q==null?void 0:Q.unitPrice)||0),D=P*q,se=D*(Number((Q==null?void 0:Q.taxRate)||0)/100);return`$${(D+se).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`})()})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(I,{type:"button",variant:"outline",size:"sm",onClick:()=>{const Q=F.getValues("lines");Q.length>1&&F.setValue("lines",Q.filter((P,q)=>q!==oe))},children:e.jsx(hn,{className:"w-4 h-4"})})})]})]},oe))}),e.jsxs(I,{type:"button",variant:"outline",onClick:()=>{const U=F.getValues("lines");F.setValue("lines",[...U,{description:"",quantity:1,unitPrice:0,taxRate:0}])},children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Add Line Item"]})]}),e.jsxs("div",{className:"border rounded-lg p-4 grid grid-cols-1 sm:grid-cols-3 gap-4 bg-white/50",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Subtotal"}),e.jsxs("div",{className:"text-xl font-semibold",children:["$",T.subtotal.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Tax"}),e.jsxs("div",{className:"text-xl font-semibold",children:["$",T.tax.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total"}),e.jsxs("div",{className:"text-2xl font-bold",children:["$",T.total.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 sticky bottom-0 bg-white/70 py-3",children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>c(!1),children:"Cancel"}),e.jsx(I,{type:"submit",disabled:S.isPending||_.isPending,children:S.isPending||_.isPending?m?"Updating...":"Creating...":m?"Update Order":"Create Order"})]})]})})]})}),e.jsx(ts,{open:d,onOpenChange:U=>{u(U),U||f(null)},children:e.jsxs(ss,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(as,{children:e.jsx(is,{children:"Purchase Order Details"})}),C?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(kr,{size:"md",color:"teal"})}):N?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"PO Number"}),e.jsx("p",{className:"text-lg font-medium",children:N.poNumber})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Vendor"}),e.jsx("p",{className:"text-lg",children:((z=N.vendor)==null?void 0:z.name)||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Order Date"}),e.jsx("p",{className:"text-lg",children:N.orderDate?Kn(new Date(N.orderDate),"MMM dd, yyyy"):"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Expected Delivery"}),e.jsx("p",{className:"text-lg",children:N.expectedDelivery?Kn(new Date(N.expectedDelivery),"MMM dd, yyyy"):"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Total Amount"}),e.jsxs("p",{className:"text-lg font-bold text-green-600",children:["$",N.totalAmount.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Status"}),e.jsx("div",{className:"mt-1",children:e.jsxs(Oe,{variant:M(N.status),className:"flex items-center gap-1 w-fit",children:[G(N.status),N.status]})})]})]}),N.notes&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(Jc,{}),e.jsx("h3",{className:"text-lg font-medium",children:"Notes"}),e.jsx("p",{className:"text-lg",children:N.notes})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Jc,{}),e.jsx("h3",{className:"text-lg font-medium",children:"Line Items"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ol,{children:[e.jsx(Rl,{children:e.jsxs(Dn,{children:[e.jsx(_s,{children:"Description"}),e.jsx(_s,{children:"Quantity"}),e.jsx(_s,{children:"Unit Price"}),e.jsx(_s,{children:"Tax Rate"}),e.jsx(_s,{children:"Total"})]})}),e.jsx(Fl,{children:N.lines.map(U=>e.jsxs(Dn,{children:[e.jsx(Cs,{children:U.description}),e.jsx(Cs,{children:U.quantity}),e.jsxs(Cs,{children:["$",U.unitPrice.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})]}),e.jsxs(Cs,{children:[U.taxRate,"%"]}),e.jsxs(Cs,{children:["$",(U.lineTotal||U.quantity*U.unitPrice).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})]})]},U.id))})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Jc,{}),e.jsx("h3",{className:"text-lg font-medium",children:"Timestamps"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Created"}),e.jsx("p",{className:"text-lg",children:N.createdAt?Kn(new Date(N.createdAt),"MMM dd, yyyy HH:mm"):"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Last Updated"}),e.jsx("p",{className:"text-lg",children:N.updatedAt?Kn(new Date(N.updatedAt),"MMM dd, yyyy HH:mm"):"-"})]})]})]})]}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"No purchase order details found"})})]})})]})}):e.jsx(Kr,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(kr,{size:"lg",color:"teal"})})})}function Sce(){const[s,t]=x.useState(zs()),[r,n]=x.useState([]),[a,i]=x.useState([]),[o,l]=x.useState(!1),[c,d]=x.useState(null),[u,h]=x.useState(!1),[f,m]=x.useState(null),[p,g]=x.useState({billId:"",amount:0,paymentMethod:"bank_transfer",notes:""});x.useEffect(()=>{const A=()=>{const V=zs();V&&V!==s&&(console.log(" Accounts Payable page - Company changed from",s,"to",V),t(V),v(),y())},T=V=>{const M=V.detail.companyId;M&&M!==s&&(console.log(" Accounts Payable page - Company changed via custom event from",s,"to",M),t(M),v(),y())};return window.addEventListener("storage",A),window.addEventListener("companyChanged",T),()=>{window.removeEventListener("storage",A),window.removeEventListener("companyChanged",T)}},[s]),x.useEffect(()=>{v(),y()},[s]);const v=async()=>{try{l(!0);const{bills:A}=await Hc.getBills(s,void 0,1,50);n(A||[])}catch(A){console.error("Error loading bills:",A),d("Failed to load bills")}finally{l(!1)}},y=async()=>{try{i([])}catch(A){console.error("Error loading payments:",A)}},j=A=>{m(A),g({billId:A.id,amount:A.balanceDue,paymentMethod:"bank_transfer",notes:""}),h(!0)},b=async()=>{var A,T;try{l(!0);const V=await de.processPayment({billId:p.billId,amount:p.amount,paymentMethod:p.paymentMethod,notes:p.notes});ze.success("Payment processed successfully!",{description:`Payment of $${p.amount} recorded with journal entry ${((A=V.journalEntry)==null?void 0:A.id)||((T=V.accountingEntries)==null?void 0:T.journalEntryId)||"N/A"}`}),await v(),await y(),h(!1),m(null),g({billId:"",amount:0,paymentMethod:"bank_transfer",notes:""})}catch(V){console.error("Error processing payment:",V),ze.error("Failed to process payment",{description:"Please try again later"})}finally{l(!1)}},w=A=>{switch(A){case"paid":return e.jsxs(Oe,{variant:"default",className:"bg-green-100 text-green-800",children:[e.jsx(bs,{className:"w-3 h-3 mr-1"}),"Paid"]});case"partially_paid":return e.jsxs(Oe,{variant:"secondary",children:[e.jsx(Ln,{className:"w-3 h-3 mr-1"}),"Partially Paid"]});case"pending":return e.jsxs(Oe,{variant:"outline",children:[e.jsx(Cr,{className:"w-3 h-3 mr-1"}),"Pending"]});default:return e.jsx(Oe,{variant:"outline",children:A})}},N=A=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(A),C=A=>new Date(A).toLocaleDateString(),S=r.filter(A=>A.status!=="paid"),_=r.filter(A=>A.status==="paid"),k=S.reduce((A,T)=>A+T.balanceDue,0),F=_.reduce((A,T)=>A+T.totalAmount,0);return e.jsx(Kr,{title:"Accounts Payable",description:"Manage vendor payments and bills",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Pending Bills"}),e.jsx(Ln,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:S.length}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[N(k)," total due"]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Paid Bills"}),e.jsx(bs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:_.length}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[N(F)," total paid"]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Total Bills"}),e.jsx(Zt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All bills this period"})]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Bills"}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(I,{onClick:v,variant:"outline",size:"sm",children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Refresh"]})})]}),e.jsx(ie,{children:o?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(On,{className:"w-6 h-6 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Loading bills..."})]}):e.jsxs(Ol,{children:[e.jsx(Rl,{children:e.jsxs(Dn,{children:[e.jsx(_s,{children:"Bill Number"}),e.jsx(_s,{children:"Vendor"}),e.jsx(_s,{children:"Amount"}),e.jsx(_s,{children:"Balance Due"}),e.jsx(_s,{children:"Status"}),e.jsx(_s,{children:"Due Date"}),e.jsx(_s,{children:"Actions"})]})}),e.jsx(Fl,{children:r.map(A=>e.jsxs(Dn,{children:[e.jsx(Cs,{className:"font-medium",children:A.billNumber}),e.jsx(Cs,{children:A.vendor.name}),e.jsx(Cs,{children:N(A.totalAmount)}),e.jsx(Cs,{children:N(A.balanceDue)}),e.jsx(Cs,{children:w(A.status)}),e.jsx(Cs,{children:C(A.dueDate)}),e.jsx(Cs,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>j(A),disabled:A.status==="paid",children:[e.jsx($a,{className:"w-4 h-4 mr-1"}),"Pay"]}),e.jsx(I,{variant:"outline",size:"sm",children:e.jsx(ir,{className:"w-4 h-4"})})]})})]},A.id))})]})})]}),e.jsx(ts,{open:u,onOpenChange:h,children:e.jsxs(ss,{className:"sm:max-w-md",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Process Payment"}),e.jsxs(Ks,{children:["Record payment for ",f==null?void 0:f.vendor.name," - ",f==null?void 0:f.billNumber]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"totalAmount",children:"Total Amount"}),e.jsx(ge,{id:"totalAmount",value:N((f==null?void 0:f.totalAmount)||0),disabled:!0})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"balanceDue",children:"Balance Due"}),e.jsx(ge,{id:"balanceDue",value:N((f==null?void 0:f.balanceDue)||0),disabled:!0})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"paymentAmount",children:"Payment Amount"}),e.jsx(ge,{id:"paymentAmount",type:"number",step:"0.01",value:p.amount,onChange:A=>g({...p,amount:parseFloat(A.target.value)||0})})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"paymentMethod",children:"Payment Method"}),e.jsxs(rt,{value:p.paymentMethod,onValueChange:A=>g({...p,paymentMethod:A}),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select payment method"})}),e.jsxs(at,{children:[e.jsx(W,{value:"bank_transfer",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx($a,{className:"w-4 h-4 mr-2"}),"Bank Transfer"]})}),e.jsx(W,{value:"check",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Zt,{className:"w-4 h-4 mr-2"}),"Check"]})}),e.jsx(W,{value:"credit_card",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx($a,{className:"w-4 h-4 mr-2"}),"Credit Card"]})}),e.jsx(W,{value:"cash",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Mr,{className:"w-4 h-4 mr-2"}),"Cash"]})})]})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"notes",children:"Notes (Optional)"}),e.jsx(Xs,{id:"notes",placeholder:"Add payment notes...",value:p.notes,onChange:A=>g({...p,notes:A.target.value})})]})]}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:()=>h(!1),disabled:o,children:"Cancel"}),e.jsx(I,{onClick:b,disabled:o||p.amount<=0,children:o?e.jsxs(e.Fragment,{children:[e.jsx(On,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx($a,{className:"w-4 h-4 mr-2"}),"Process Payment"]})})]})]})})]})})}var Xc={},jN={};jN.byteLength=Ece;jN.toByteArray=Pce;jN.fromByteArray=Tce;var Zd=[],qc=[],Cce=typeof Uint8Array<"u"?Uint8Array:Array,W2="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Tx=0,Ace=W2.length;Tx<Ace;++Tx)Zd[Tx]=W2[Tx],qc[W2.charCodeAt(Tx)]=Tx;qc[45]=62;qc[95]=63;function I9(s){var t=s.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=s.indexOf("=");r===-1&&(r=t);var n=r===t?0:4-r%4;return[r,n]}function Ece(s){var t=I9(s),r=t[0],n=t[1];return(r+n)*3/4-n}function Ice(s,t,r){return(t+r)*3/4-r}function Pce(s){var t,r=I9(s),n=r[0],a=r[1],i=new Cce(Ice(s,n,a)),o=0,l=a>0?n-4:n,c;for(c=0;c<l;c+=4)t=qc[s.charCodeAt(c)]<<18|qc[s.charCodeAt(c+1)]<<12|qc[s.charCodeAt(c+2)]<<6|qc[s.charCodeAt(c+3)],i[o++]=t>>16&255,i[o++]=t>>8&255,i[o++]=t&255;return a===2&&(t=qc[s.charCodeAt(c)]<<2|qc[s.charCodeAt(c+1)]>>4,i[o++]=t&255),a===1&&(t=qc[s.charCodeAt(c)]<<10|qc[s.charCodeAt(c+1)]<<4|qc[s.charCodeAt(c+2)]>>2,i[o++]=t>>8&255,i[o++]=t&255),i}function _ce(s){return Zd[s>>18&63]+Zd[s>>12&63]+Zd[s>>6&63]+Zd[s&63]}function kce(s,t,r){for(var n,a=[],i=t;i<r;i+=3)n=(s[i]<<16&16711680)+(s[i+1]<<8&65280)+(s[i+2]&255),a.push(_ce(n));return a.join("")}function Tce(s){for(var t,r=s.length,n=r%3,a=[],i=16383,o=0,l=r-n;o<l;o+=i)a.push(kce(s,o,o+i>l?l:o+i));return n===1?(t=s[r-1],a.push(Zd[t>>2]+Zd[t<<4&63]+"==")):n===2&&(t=(s[r-2]<<8)+s[r-1],a.push(Zd[t>>10]+Zd[t>>4&63]+Zd[t<<2&63]+"=")),a.join("")}var N3={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */N3.read=function(s,t,r,n,a){var i,o,l=a*8-n-1,c=(1<<l)-1,d=c>>1,u=-7,h=r?a-1:0,f=r?-1:1,m=s[t+h];for(h+=f,i=m&(1<<-u)-1,m>>=-u,u+=l;u>0;i=i*256+s[t+h],h+=f,u-=8);for(o=i&(1<<-u)-1,i>>=-u,u+=n;u>0;o=o*256+s[t+h],h+=f,u-=8);if(i===0)i=1-d;else{if(i===c)return o?NaN:(m?-1:1)*(1/0);o=o+Math.pow(2,n),i=i-d}return(m?-1:1)*o*Math.pow(2,i-n)};N3.write=function(s,t,r,n,a,i){var o,l,c,d=i*8-a-1,u=(1<<d)-1,h=u>>1,f=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=n?0:i-1,p=n?1:-1,g=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(l=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+h>=1?t+=f/c:t+=f*Math.pow(2,1-h),t*c>=2&&(o++,c/=2),o+h>=u?(l=0,o=u):o+h>=1?(l=(t*c-1)*Math.pow(2,a),o=o+h):(l=t*Math.pow(2,h-1)*Math.pow(2,a),o=0));a>=8;s[r+m]=l&255,m+=p,l/=256,a-=8);for(o=o<<a|l,d+=a;d>0;s[r+m]=o&255,m+=p,o/=256,d-=8);s[r+m-p]|=g*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(s){var t=jN,r=N3,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;s.Buffer=l,s.SlowBuffer=j,s.INSPECT_MAX_BYTES=50;var a=2147483647;s.kMaxLength=a,l.TYPED_ARRAY_SUPPORT=i(),!l.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function i(){try{var Z=new Uint8Array(1),K={foo:function(){return 42}};return Object.setPrototypeOf(K,Uint8Array.prototype),Object.setPrototypeOf(Z,K),Z.foo()===42}catch{return!1}}Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}});function o(Z){if(Z>a)throw new RangeError('The value "'+Z+'" is invalid for option "size"');var K=new Uint8Array(Z);return Object.setPrototypeOf(K,l.prototype),K}function l(Z,K,X){if(typeof Z=="number"){if(typeof K=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return h(Z)}return c(Z,K,X)}l.poolSize=8192;function c(Z,K,X){if(typeof Z=="string")return f(Z,K);if(ArrayBuffer.isView(Z))return p(Z);if(Z==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Z);if(te(Z,ArrayBuffer)||Z&&te(Z.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(te(Z,SharedArrayBuffer)||Z&&te(Z.buffer,SharedArrayBuffer)))return g(Z,K,X);if(typeof Z=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var ce=Z.valueOf&&Z.valueOf();if(ce!=null&&ce!==Z)return l.from(ce,K,X);var Y=v(Z);if(Y)return Y;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Z[Symbol.toPrimitive]=="function")return l.from(Z[Symbol.toPrimitive]("string"),K,X);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Z)}l.from=function(Z,K,X){return c(Z,K,X)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array);function d(Z){if(typeof Z!="number")throw new TypeError('"size" argument must be of type number');if(Z<0)throw new RangeError('The value "'+Z+'" is invalid for option "size"')}function u(Z,K,X){return d(Z),Z<=0?o(Z):K!==void 0?typeof X=="string"?o(Z).fill(K,X):o(Z).fill(K):o(Z)}l.alloc=function(Z,K,X){return u(Z,K,X)};function h(Z){return d(Z),o(Z<0?0:y(Z)|0)}l.allocUnsafe=function(Z){return h(Z)},l.allocUnsafeSlow=function(Z){return h(Z)};function f(Z,K){if((typeof K!="string"||K==="")&&(K="utf8"),!l.isEncoding(K))throw new TypeError("Unknown encoding: "+K);var X=b(Z,K)|0,ce=o(X),Y=ce.write(Z,K);return Y!==X&&(ce=ce.slice(0,Y)),ce}function m(Z){for(var K=Z.length<0?0:y(Z.length)|0,X=o(K),ce=0;ce<K;ce+=1)X[ce]=Z[ce]&255;return X}function p(Z){if(te(Z,Uint8Array)){var K=new Uint8Array(Z);return g(K.buffer,K.byteOffset,K.byteLength)}return m(Z)}function g(Z,K,X){if(K<0||Z.byteLength<K)throw new RangeError('"offset" is outside of buffer bounds');if(Z.byteLength<K+(X||0))throw new RangeError('"length" is outside of buffer bounds');var ce;return K===void 0&&X===void 0?ce=new Uint8Array(Z):X===void 0?ce=new Uint8Array(Z,K):ce=new Uint8Array(Z,K,X),Object.setPrototypeOf(ce,l.prototype),ce}function v(Z){if(l.isBuffer(Z)){var K=y(Z.length)|0,X=o(K);return X.length===0||Z.copy(X,0,0,K),X}if(Z.length!==void 0)return typeof Z.length!="number"||re(Z.length)?o(0):m(Z);if(Z.type==="Buffer"&&Array.isArray(Z.data))return m(Z.data)}function y(Z){if(Z>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return Z|0}function j(Z){return+Z!=Z&&(Z=0),l.alloc(+Z)}l.isBuffer=function(K){return K!=null&&K._isBuffer===!0&&K!==l.prototype},l.compare=function(K,X){if(te(K,Uint8Array)&&(K=l.from(K,K.offset,K.byteLength)),te(X,Uint8Array)&&(X=l.from(X,X.offset,X.byteLength)),!l.isBuffer(K)||!l.isBuffer(X))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(K===X)return 0;for(var ce=K.length,Y=X.length,ue=0,ve=Math.min(ce,Y);ue<ve;++ue)if(K[ue]!==X[ue]){ce=K[ue],Y=X[ue];break}return ce<Y?-1:Y<ce?1:0},l.isEncoding=function(K){switch(String(K).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(K,X){if(!Array.isArray(K))throw new TypeError('"list" argument must be an Array of Buffers');if(K.length===0)return l.alloc(0);var ce;if(X===void 0)for(X=0,ce=0;ce<K.length;++ce)X+=K[ce].length;var Y=l.allocUnsafe(X),ue=0;for(ce=0;ce<K.length;++ce){var ve=K[ce];if(te(ve,Uint8Array))ue+ve.length>Y.length?l.from(ve).copy(Y,ue):Uint8Array.prototype.set.call(Y,ve,ue);else if(l.isBuffer(ve))ve.copy(Y,ue);else throw new TypeError('"list" argument must be an Array of Buffers');ue+=ve.length}return Y};function b(Z,K){if(l.isBuffer(Z))return Z.length;if(ArrayBuffer.isView(Z)||te(Z,ArrayBuffer))return Z.byteLength;if(typeof Z!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Z);var X=Z.length,ce=arguments.length>2&&arguments[2]===!0;if(!ce&&X===0)return 0;for(var Y=!1;;)switch(K){case"ascii":case"latin1":case"binary":return X;case"utf8":case"utf-8":return pe(Z).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X*2;case"hex":return X>>>1;case"base64":return $e(Z).length;default:if(Y)return ce?-1:pe(Z).length;K=(""+K).toLowerCase(),Y=!0}}l.byteLength=b;function w(Z,K,X){var ce=!1;if((K===void 0||K<0)&&(K=0),K>this.length||((X===void 0||X>this.length)&&(X=this.length),X<=0)||(X>>>=0,K>>>=0,X<=K))return"";for(Z||(Z="utf8");;)switch(Z){case"hex":return U(this,K,X);case"utf8":case"utf-8":return M(this,K,X);case"ascii":return J(this,K,X);case"latin1":case"binary":return z(this,K,X);case"base64":return V(this,K,X);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return oe(this,K,X);default:if(ce)throw new TypeError("Unknown encoding: "+Z);Z=(Z+"").toLowerCase(),ce=!0}}l.prototype._isBuffer=!0;function N(Z,K,X){var ce=Z[K];Z[K]=Z[X],Z[X]=ce}l.prototype.swap16=function(){var K=this.length;if(K%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var X=0;X<K;X+=2)N(this,X,X+1);return this},l.prototype.swap32=function(){var K=this.length;if(K%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var X=0;X<K;X+=4)N(this,X,X+3),N(this,X+1,X+2);return this},l.prototype.swap64=function(){var K=this.length;if(K%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var X=0;X<K;X+=8)N(this,X,X+7),N(this,X+1,X+6),N(this,X+2,X+5),N(this,X+3,X+4);return this},l.prototype.toString=function(){var K=this.length;return K===0?"":arguments.length===0?M(this,0,K):w.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(K){if(!l.isBuffer(K))throw new TypeError("Argument must be a Buffer");return this===K?!0:l.compare(this,K)===0},l.prototype.inspect=function(){var K="",X=s.INSPECT_MAX_BYTES;return K=this.toString("hex",0,X).replace(/(.{2})/g,"$1 ").trim(),this.length>X&&(K+=" ... "),"<Buffer "+K+">"},n&&(l.prototype[n]=l.prototype.inspect),l.prototype.compare=function(K,X,ce,Y,ue){if(te(K,Uint8Array)&&(K=l.from(K,K.offset,K.byteLength)),!l.isBuffer(K))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof K);if(X===void 0&&(X=0),ce===void 0&&(ce=K?K.length:0),Y===void 0&&(Y=0),ue===void 0&&(ue=this.length),X<0||ce>K.length||Y<0||ue>this.length)throw new RangeError("out of range index");if(Y>=ue&&X>=ce)return 0;if(Y>=ue)return-1;if(X>=ce)return 1;if(X>>>=0,ce>>>=0,Y>>>=0,ue>>>=0,this===K)return 0;for(var ve=ue-Y,Le=ce-X,Me=Math.min(ve,Le),tt=this.slice(Y,ue),fe=K.slice(X,ce),ct=0;ct<Me;++ct)if(tt[ct]!==fe[ct]){ve=tt[ct],Le=fe[ct];break}return ve<Le?-1:Le<ve?1:0};function C(Z,K,X,ce,Y){if(Z.length===0)return-1;if(typeof X=="string"?(ce=X,X=0):X>2147483647?X=2147483647:X<-2147483648&&(X=-2147483648),X=+X,re(X)&&(X=Y?0:Z.length-1),X<0&&(X=Z.length+X),X>=Z.length){if(Y)return-1;X=Z.length-1}else if(X<0)if(Y)X=0;else return-1;if(typeof K=="string"&&(K=l.from(K,ce)),l.isBuffer(K))return K.length===0?-1:S(Z,K,X,ce,Y);if(typeof K=="number")return K=K&255,typeof Uint8Array.prototype.indexOf=="function"?Y?Uint8Array.prototype.indexOf.call(Z,K,X):Uint8Array.prototype.lastIndexOf.call(Z,K,X):S(Z,[K],X,ce,Y);throw new TypeError("val must be string, number or Buffer")}function S(Z,K,X,ce,Y){var ue=1,ve=Z.length,Le=K.length;if(ce!==void 0&&(ce=String(ce).toLowerCase(),ce==="ucs2"||ce==="ucs-2"||ce==="utf16le"||ce==="utf-16le")){if(Z.length<2||K.length<2)return-1;ue=2,ve/=2,Le/=2,X/=2}function Me(pt,qe){return ue===1?pt[qe]:pt.readUInt16BE(qe*ue)}var tt;if(Y){var fe=-1;for(tt=X;tt<ve;tt++)if(Me(Z,tt)===Me(K,fe===-1?0:tt-fe)){if(fe===-1&&(fe=tt),tt-fe+1===Le)return fe*ue}else fe!==-1&&(tt-=tt-fe),fe=-1}else for(X+Le>ve&&(X=ve-Le),tt=X;tt>=0;tt--){for(var ct=!0,dt=0;dt<Le;dt++)if(Me(Z,tt+dt)!==Me(K,dt)){ct=!1;break}if(ct)return tt}return-1}l.prototype.includes=function(K,X,ce){return this.indexOf(K,X,ce)!==-1},l.prototype.indexOf=function(K,X,ce){return C(this,K,X,ce,!0)},l.prototype.lastIndexOf=function(K,X,ce){return C(this,K,X,ce,!1)};function _(Z,K,X,ce){X=Number(X)||0;var Y=Z.length-X;ce?(ce=Number(ce),ce>Y&&(ce=Y)):ce=Y;var ue=K.length;ce>ue/2&&(ce=ue/2);for(var ve=0;ve<ce;++ve){var Le=parseInt(K.substr(ve*2,2),16);if(re(Le))return ve;Z[X+ve]=Le}return ve}function k(Z,K,X,ce){return O(pe(K,Z.length-X),Z,X,ce)}function F(Z,K,X,ce){return O(Ae(K),Z,X,ce)}function A(Z,K,X,ce){return O($e(K),Z,X,ce)}function T(Z,K,X,ce){return O(Ee(K,Z.length-X),Z,X,ce)}l.prototype.write=function(K,X,ce,Y){if(X===void 0)Y="utf8",ce=this.length,X=0;else if(ce===void 0&&typeof X=="string")Y=X,ce=this.length,X=0;else if(isFinite(X))X=X>>>0,isFinite(ce)?(ce=ce>>>0,Y===void 0&&(Y="utf8")):(Y=ce,ce=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var ue=this.length-X;if((ce===void 0||ce>ue)&&(ce=ue),K.length>0&&(ce<0||X<0)||X>this.length)throw new RangeError("Attempt to write outside buffer bounds");Y||(Y="utf8");for(var ve=!1;;)switch(Y){case"hex":return _(this,K,X,ce);case"utf8":case"utf-8":return k(this,K,X,ce);case"ascii":case"latin1":case"binary":return F(this,K,X,ce);case"base64":return A(this,K,X,ce);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,K,X,ce);default:if(ve)throw new TypeError("Unknown encoding: "+Y);Y=(""+Y).toLowerCase(),ve=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function V(Z,K,X){return K===0&&X===Z.length?t.fromByteArray(Z):t.fromByteArray(Z.slice(K,X))}function M(Z,K,X){X=Math.min(Z.length,X);for(var ce=[],Y=K;Y<X;){var ue=Z[Y],ve=null,Le=ue>239?4:ue>223?3:ue>191?2:1;if(Y+Le<=X){var Me,tt,fe,ct;switch(Le){case 1:ue<128&&(ve=ue);break;case 2:Me=Z[Y+1],(Me&192)===128&&(ct=(ue&31)<<6|Me&63,ct>127&&(ve=ct));break;case 3:Me=Z[Y+1],tt=Z[Y+2],(Me&192)===128&&(tt&192)===128&&(ct=(ue&15)<<12|(Me&63)<<6|tt&63,ct>2047&&(ct<55296||ct>57343)&&(ve=ct));break;case 4:Me=Z[Y+1],tt=Z[Y+2],fe=Z[Y+3],(Me&192)===128&&(tt&192)===128&&(fe&192)===128&&(ct=(ue&15)<<18|(Me&63)<<12|(tt&63)<<6|fe&63,ct>65535&&ct<1114112&&(ve=ct))}}ve===null?(ve=65533,Le=1):ve>65535&&(ve-=65536,ce.push(ve>>>10&1023|55296),ve=56320|ve&1023),ce.push(ve),Y+=Le}return L(ce)}var G=4096;function L(Z){var K=Z.length;if(K<=G)return String.fromCharCode.apply(String,Z);for(var X="",ce=0;ce<K;)X+=String.fromCharCode.apply(String,Z.slice(ce,ce+=G));return X}function J(Z,K,X){var ce="";X=Math.min(Z.length,X);for(var Y=K;Y<X;++Y)ce+=String.fromCharCode(Z[Y]&127);return ce}function z(Z,K,X){var ce="";X=Math.min(Z.length,X);for(var Y=K;Y<X;++Y)ce+=String.fromCharCode(Z[Y]);return ce}function U(Z,K,X){var ce=Z.length;(!K||K<0)&&(K=0),(!X||X<0||X>ce)&&(X=ce);for(var Y="",ue=K;ue<X;++ue)Y+=le[Z[ue]];return Y}function oe(Z,K,X){for(var ce=Z.slice(K,X),Y="",ue=0;ue<ce.length-1;ue+=2)Y+=String.fromCharCode(ce[ue]+ce[ue+1]*256);return Y}l.prototype.slice=function(K,X){var ce=this.length;K=~~K,X=X===void 0?ce:~~X,K<0?(K+=ce,K<0&&(K=0)):K>ce&&(K=ce),X<0?(X+=ce,X<0&&(X=0)):X>ce&&(X=ce),X<K&&(X=K);var Y=this.subarray(K,X);return Object.setPrototypeOf(Y,l.prototype),Y};function Q(Z,K,X){if(Z%1!==0||Z<0)throw new RangeError("offset is not uint");if(Z+K>X)throw new RangeError("Trying to access beyond buffer length")}l.prototype.readUintLE=l.prototype.readUIntLE=function(K,X,ce){K=K>>>0,X=X>>>0,ce||Q(K,X,this.length);for(var Y=this[K],ue=1,ve=0;++ve<X&&(ue*=256);)Y+=this[K+ve]*ue;return Y},l.prototype.readUintBE=l.prototype.readUIntBE=function(K,X,ce){K=K>>>0,X=X>>>0,ce||Q(K,X,this.length);for(var Y=this[K+--X],ue=1;X>0&&(ue*=256);)Y+=this[K+--X]*ue;return Y},l.prototype.readUint8=l.prototype.readUInt8=function(K,X){return K=K>>>0,X||Q(K,1,this.length),this[K]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(K,X){return K=K>>>0,X||Q(K,2,this.length),this[K]|this[K+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(K,X){return K=K>>>0,X||Q(K,2,this.length),this[K]<<8|this[K+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(K,X){return K=K>>>0,X||Q(K,4,this.length),(this[K]|this[K+1]<<8|this[K+2]<<16)+this[K+3]*16777216},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(K,X){return K=K>>>0,X||Q(K,4,this.length),this[K]*16777216+(this[K+1]<<16|this[K+2]<<8|this[K+3])},l.prototype.readIntLE=function(K,X,ce){K=K>>>0,X=X>>>0,ce||Q(K,X,this.length);for(var Y=this[K],ue=1,ve=0;++ve<X&&(ue*=256);)Y+=this[K+ve]*ue;return ue*=128,Y>=ue&&(Y-=Math.pow(2,8*X)),Y},l.prototype.readIntBE=function(K,X,ce){K=K>>>0,X=X>>>0,ce||Q(K,X,this.length);for(var Y=X,ue=1,ve=this[K+--Y];Y>0&&(ue*=256);)ve+=this[K+--Y]*ue;return ue*=128,ve>=ue&&(ve-=Math.pow(2,8*X)),ve},l.prototype.readInt8=function(K,X){return K=K>>>0,X||Q(K,1,this.length),this[K]&128?(255-this[K]+1)*-1:this[K]},l.prototype.readInt16LE=function(K,X){K=K>>>0,X||Q(K,2,this.length);var ce=this[K]|this[K+1]<<8;return ce&32768?ce|4294901760:ce},l.prototype.readInt16BE=function(K,X){K=K>>>0,X||Q(K,2,this.length);var ce=this[K+1]|this[K]<<8;return ce&32768?ce|4294901760:ce},l.prototype.readInt32LE=function(K,X){return K=K>>>0,X||Q(K,4,this.length),this[K]|this[K+1]<<8|this[K+2]<<16|this[K+3]<<24},l.prototype.readInt32BE=function(K,X){return K=K>>>0,X||Q(K,4,this.length),this[K]<<24|this[K+1]<<16|this[K+2]<<8|this[K+3]},l.prototype.readFloatLE=function(K,X){return K=K>>>0,X||Q(K,4,this.length),r.read(this,K,!0,23,4)},l.prototype.readFloatBE=function(K,X){return K=K>>>0,X||Q(K,4,this.length),r.read(this,K,!1,23,4)},l.prototype.readDoubleLE=function(K,X){return K=K>>>0,X||Q(K,8,this.length),r.read(this,K,!0,52,8)},l.prototype.readDoubleBE=function(K,X){return K=K>>>0,X||Q(K,8,this.length),r.read(this,K,!1,52,8)};function P(Z,K,X,ce,Y,ue){if(!l.isBuffer(Z))throw new TypeError('"buffer" argument must be a Buffer instance');if(K>Y||K<ue)throw new RangeError('"value" argument is out of bounds');if(X+ce>Z.length)throw new RangeError("Index out of range")}l.prototype.writeUintLE=l.prototype.writeUIntLE=function(K,X,ce,Y){if(K=+K,X=X>>>0,ce=ce>>>0,!Y){var ue=Math.pow(2,8*ce)-1;P(this,K,X,ce,ue,0)}var ve=1,Le=0;for(this[X]=K&255;++Le<ce&&(ve*=256);)this[X+Le]=K/ve&255;return X+ce},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(K,X,ce,Y){if(K=+K,X=X>>>0,ce=ce>>>0,!Y){var ue=Math.pow(2,8*ce)-1;P(this,K,X,ce,ue,0)}var ve=ce-1,Le=1;for(this[X+ve]=K&255;--ve>=0&&(Le*=256);)this[X+ve]=K/Le&255;return X+ce},l.prototype.writeUint8=l.prototype.writeUInt8=function(K,X,ce){return K=+K,X=X>>>0,ce||P(this,K,X,1,255,0),this[X]=K&255,X+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(K,X,ce){return K=+K,X=X>>>0,ce||P(this,K,X,2,65535,0),this[X]=K&255,this[X+1]=K>>>8,X+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(K,X,ce){return K=+K,X=X>>>0,ce||P(this,K,X,2,65535,0),this[X]=K>>>8,this[X+1]=K&255,X+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(K,X,ce){return K=+K,X=X>>>0,ce||P(this,K,X,4,4294967295,0),this[X+3]=K>>>24,this[X+2]=K>>>16,this[X+1]=K>>>8,this[X]=K&255,X+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(K,X,ce){return K=+K,X=X>>>0,ce||P(this,K,X,4,4294967295,0),this[X]=K>>>24,this[X+1]=K>>>16,this[X+2]=K>>>8,this[X+3]=K&255,X+4},l.prototype.writeIntLE=function(K,X,ce,Y){if(K=+K,X=X>>>0,!Y){var ue=Math.pow(2,8*ce-1);P(this,K,X,ce,ue-1,-ue)}var ve=0,Le=1,Me=0;for(this[X]=K&255;++ve<ce&&(Le*=256);)K<0&&Me===0&&this[X+ve-1]!==0&&(Me=1),this[X+ve]=(K/Le>>0)-Me&255;return X+ce},l.prototype.writeIntBE=function(K,X,ce,Y){if(K=+K,X=X>>>0,!Y){var ue=Math.pow(2,8*ce-1);P(this,K,X,ce,ue-1,-ue)}var ve=ce-1,Le=1,Me=0;for(this[X+ve]=K&255;--ve>=0&&(Le*=256);)K<0&&Me===0&&this[X+ve+1]!==0&&(Me=1),this[X+ve]=(K/Le>>0)-Me&255;return X+ce},l.prototype.writeInt8=function(K,X,ce){return K=+K,X=X>>>0,ce||P(this,K,X,1,127,-128),K<0&&(K=255+K+1),this[X]=K&255,X+1},l.prototype.writeInt16LE=function(K,X,ce){return K=+K,X=X>>>0,ce||P(this,K,X,2,32767,-32768),this[X]=K&255,this[X+1]=K>>>8,X+2},l.prototype.writeInt16BE=function(K,X,ce){return K=+K,X=X>>>0,ce||P(this,K,X,2,32767,-32768),this[X]=K>>>8,this[X+1]=K&255,X+2},l.prototype.writeInt32LE=function(K,X,ce){return K=+K,X=X>>>0,ce||P(this,K,X,4,2147483647,-2147483648),this[X]=K&255,this[X+1]=K>>>8,this[X+2]=K>>>16,this[X+3]=K>>>24,X+4},l.prototype.writeInt32BE=function(K,X,ce){return K=+K,X=X>>>0,ce||P(this,K,X,4,2147483647,-2147483648),K<0&&(K=4294967295+K+1),this[X]=K>>>24,this[X+1]=K>>>16,this[X+2]=K>>>8,this[X+3]=K&255,X+4};function q(Z,K,X,ce,Y,ue){if(X+ce>Z.length)throw new RangeError("Index out of range");if(X<0)throw new RangeError("Index out of range")}function D(Z,K,X,ce,Y){return K=+K,X=X>>>0,Y||q(Z,K,X,4),r.write(Z,K,X,ce,23,4),X+4}l.prototype.writeFloatLE=function(K,X,ce){return D(this,K,X,!0,ce)},l.prototype.writeFloatBE=function(K,X,ce){return D(this,K,X,!1,ce)};function se(Z,K,X,ce,Y){return K=+K,X=X>>>0,Y||q(Z,K,X,8),r.write(Z,K,X,ce,52,8),X+8}l.prototype.writeDoubleLE=function(K,X,ce){return se(this,K,X,!0,ce)},l.prototype.writeDoubleBE=function(K,X,ce){return se(this,K,X,!1,ce)},l.prototype.copy=function(K,X,ce,Y){if(!l.isBuffer(K))throw new TypeError("argument should be a Buffer");if(ce||(ce=0),!Y&&Y!==0&&(Y=this.length),X>=K.length&&(X=K.length),X||(X=0),Y>0&&Y<ce&&(Y=ce),Y===ce||K.length===0||this.length===0)return 0;if(X<0)throw new RangeError("targetStart out of bounds");if(ce<0||ce>=this.length)throw new RangeError("Index out of range");if(Y<0)throw new RangeError("sourceEnd out of bounds");Y>this.length&&(Y=this.length),K.length-X<Y-ce&&(Y=K.length-X+ce);var ue=Y-ce;return this===K&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(X,ce,Y):Uint8Array.prototype.set.call(K,this.subarray(ce,Y),X),ue},l.prototype.fill=function(K,X,ce,Y){if(typeof K=="string"){if(typeof X=="string"?(Y=X,X=0,ce=this.length):typeof ce=="string"&&(Y=ce,ce=this.length),Y!==void 0&&typeof Y!="string")throw new TypeError("encoding must be a string");if(typeof Y=="string"&&!l.isEncoding(Y))throw new TypeError("Unknown encoding: "+Y);if(K.length===1){var ue=K.charCodeAt(0);(Y==="utf8"&&ue<128||Y==="latin1")&&(K=ue)}}else typeof K=="number"?K=K&255:typeof K=="boolean"&&(K=Number(K));if(X<0||this.length<X||this.length<ce)throw new RangeError("Out of range index");if(ce<=X)return this;X=X>>>0,ce=ce===void 0?this.length:ce>>>0,K||(K=0);var ve;if(typeof K=="number")for(ve=X;ve<ce;++ve)this[ve]=K;else{var Le=l.isBuffer(K)?K:l.from(K,Y),Me=Le.length;if(Me===0)throw new TypeError('The value "'+K+'" is invalid for argument "value"');for(ve=0;ve<ce-X;++ve)this[ve+X]=Le[ve%Me]}return this};var he=/[^+/0-9A-Za-z-_]/g;function be(Z){if(Z=Z.split("=")[0],Z=Z.trim().replace(he,""),Z.length<2)return"";for(;Z.length%4!==0;)Z=Z+"=";return Z}function pe(Z,K){K=K||1/0;for(var X,ce=Z.length,Y=null,ue=[],ve=0;ve<ce;++ve){if(X=Z.charCodeAt(ve),X>55295&&X<57344){if(!Y){if(X>56319){(K-=3)>-1&&ue.push(239,191,189);continue}else if(ve+1===ce){(K-=3)>-1&&ue.push(239,191,189);continue}Y=X;continue}if(X<56320){(K-=3)>-1&&ue.push(239,191,189),Y=X;continue}X=(Y-55296<<10|X-56320)+65536}else Y&&(K-=3)>-1&&ue.push(239,191,189);if(Y=null,X<128){if((K-=1)<0)break;ue.push(X)}else if(X<2048){if((K-=2)<0)break;ue.push(X>>6|192,X&63|128)}else if(X<65536){if((K-=3)<0)break;ue.push(X>>12|224,X>>6&63|128,X&63|128)}else if(X<1114112){if((K-=4)<0)break;ue.push(X>>18|240,X>>12&63|128,X>>6&63|128,X&63|128)}else throw new Error("Invalid code point")}return ue}function Ae(Z){for(var K=[],X=0;X<Z.length;++X)K.push(Z.charCodeAt(X)&255);return K}function Ee(Z,K){for(var X,ce,Y,ue=[],ve=0;ve<Z.length&&!((K-=2)<0);++ve)X=Z.charCodeAt(ve),ce=X>>8,Y=X%256,ue.push(Y),ue.push(ce);return ue}function $e(Z){return t.toByteArray(be(Z))}function O(Z,K,X,ce){for(var Y=0;Y<ce&&!(Y+X>=K.length||Y>=Z.length);++Y)K[Y+X]=Z[Y];return Y}function te(Z,K){return Z instanceof K||Z!=null&&Z.constructor!=null&&Z.constructor.name!=null&&Z.constructor.name===K.name}function re(Z){return Z!==Z}var le=function(){for(var Z="0123456789abcdef",K=new Array(256),X=0;X<16;++X)for(var ce=X*16,Y=0;Y<16;++Y)K[ce+Y]=Z[X]+Z[Y];return K}()})(Xc);const Ql=()=>un(""),Dce=async s=>{const t=localStorage.getItem("token")||localStorage.getItem("auth_token");if(!t)return console.error("No token found"),{data:{invoices:[]}};let r;try{r=JSON.parse(Xc.Buffer.from(t.split(".")[1],"base64").toString()).tenantId}catch(i){return console.error("Error parsing token:",i),{data:{invoices:[]}}}console.log("Fetching invoices with:",{companyId:s,token:t?"present":"missing",tenantId:r}),console.log("Full URL:",`${Ql()}/api/accounts-payable/invoices?companyId=${s}`),console.log("Headers being sent:",{Authorization:`Bearer ${t}`,"x-tenant-id":r,"x-company-id":s});const n=await fetch(`${Ql()}/api/accounts-payable/invoices?companyId=${s}`,{headers:{Authorization:`Bearer ${t}`,"x-tenant-id":r,"x-company-id":s}});console.log("Invoices response status:",n.status);const a=await n.json();return console.log("Invoices response data:",a),console.log("Invoices data structure:",JSON.stringify(a,null,2)),a},Oce=async s=>{const t=localStorage.getItem("token")||localStorage.getItem("auth_token");if(!t)return console.error("No token found"),{data:{bills:[]}};let r;try{r=JSON.parse(Xc.Buffer.from(t.split(".")[1],"base64").toString()).tenantId}catch(i){return console.error("Error parsing token:",i),{data:{bills:[]}}}console.log("Fetching bills with:",{companyId:s,token:t?"present":"missing",tenantId:r}),console.log("Bills URL:",un(`api/bills?companyId=${s}`)),console.log("Bills headers:",{Authorization:`Bearer ${t}`,"x-tenant-id":r,"x-company-id":s});const n=await fetch(`${Ql()}/api/bills?companyId=${s}`,{headers:{Authorization:`Bearer ${t}`,"x-tenant-id":r,"x-company-id":s}});console.log("Bills response status:",n.status);const a=await n.json();return console.log("Bills response data:",a),a},Rce=async s=>{const t=localStorage.getItem("token")||localStorage.getItem("auth_token");if(!t)return console.error("No token found"),{data:{summary:{}}};let r;try{r=JSON.parse(Xc.Buffer.from(t.split(".")[1],"base64").toString()).tenantId}catch(i){return console.error("Error parsing token:",i),{data:{summary:{}}}}console.log("Fetching dashboard with:",{companyId:s,token:t?"present":"missing",tenantId:r});const n=await fetch(`${Ql()}/api/accounts-payable/dashboard?companyId=${s}`,{headers:{Authorization:`Bearer ${t}`,"x-tenant-id":r,"x-company-id":s}});console.log("Dashboard response status:",n.status);const a=await n.json();return console.log("Dashboard response data:",a),a},Fce=async s=>{const t=localStorage.getItem("token")||localStorage.getItem("auth_token");if(!t)return console.error("No token found"),{data:{}};let r;try{r=JSON.parse(Xc.Buffer.from(t.split(".")[1],"base64").toString()).tenantId}catch(i){return console.error("Error parsing token:",i),{data:{}}}console.log("Fetching aging report with:",{companyId:s,token:t?"present":"missing",tenantId:r});const n=await fetch(`${Ql()}/api/accounts-payable/aging-report?companyId=${s}`,{headers:{Authorization:`Bearer ${t}`,"x-tenant-id":r,"x-company-id":s}});console.log("Aging report response status:",n.status);const a=await n.json();return console.log("Aging report response data:",a),a},Mce=async s=>{const t=localStorage.getItem("token")||localStorage.getItem("auth_token");if(!t)return console.error("No token found"),{data:{payments:[],schedules:[],bankAccounts:[],stats:{}}};let r;try{r=JSON.parse(Xc.Buffer.from(t.split(".")[1],"base64").toString()).tenantId}catch(i){return console.error("Error parsing token:",i),{data:{payments:[],schedules:[],bankAccounts:[],stats:{}}}}console.log("Fetching payment data with:",{companyId:s,token:t?"present":"missing",tenantId:r});const n=await fetch(`${Ql()}/api/payments/payments?companyId=${s}`,{headers:{Authorization:`Bearer ${t}`,"x-tenant-id":r,"x-company-id":s}});console.log("Payment data response status:",n.status);const a=await n.json();return console.log("Payment data response data:",a),a};function Lce(){var zt,St,js,et,lt,Fe,ft,He,Je,It,Gt,qt,As,Ht,xs,Ct;const[s,t]=x.useState(""),[r,n]=x.useState("all"),[a,i]=x.useState("overview"),[o,l]=x.useState(null),[c,d]=x.useState(!1),[u,h]=x.useState(!1),[f,m]=x.useState(!1),[p,g]=x.useState(!1),[v,y]=x.useState({}),j=hi(),{isAuthenticated:b,isLoading:w,user:N}=Ua(),C=!w;console.log(" Auth Debug:",{isAuthenticated:b,authLoading:w,authReady:C,user:N?"User logged in":"No user",tokenInStorage:localStorage.getItem("token")?"Token exists":"No token",authTokenInStorage:localStorage.getItem("auth_token")?"Auth token exists":"No auth token"});const{data:S,isLoading:_,error:k}=ys({queryKey:["companies"],queryFn:cN.getCompanies,enabled:C}),F=localStorage.getItem("company_id")||localStorage.getItem("companyId")||"seed-company-1";console.log("=== COMPANY ID DEBUG ==="),console.log("Companies data:",S),console.log("Auth ready:",C),console.log("First company ID (used for queries):",F),console.log("=== API CALLS DEBUG ==="),console.log("Invoices query enabled:",C&&!0),console.log("Bills query enabled:",C&&!0),console.log("Vendors query enabled:",C&&!0),console.log("Dashboard query enabled:",C&&!0),console.log("Aging query enabled:",C&&!0);const{data:A,isLoading:T}=ys({queryKey:["invoices",F],queryFn:()=>Dce(F),enabled:C&&!0}),{data:V,isLoading:M}=ys({queryKey:["bills",F],queryFn:()=>Oce(F),enabled:C&&!0}),{data:G,isLoading:L,error:J}=ys({queryKey:["vendors",F],queryFn:async()=>{try{const ke=await Hc.getVendors(F);if(console.log("Raw vendors result:",ke),Array.isArray(ke))return ke;const gt=ke;return gt!=null&&gt.items&&Array.isArray(gt.items)?gt.items:gt!=null&&gt.data&&Array.isArray(gt.data)?gt.data:[]}catch(ke){return console.error("Error fetching vendors:",ke),[{id:"demo-vendor-1",name:"Demo Vendor 1",email:"vendor1@demo.com"},{id:"demo-vendor-2",name:"Demo Vendor 2",email:"vendor2@demo.com"},{id:"demo-vendor-3",name:"Demo Vendor 3",email:"vendor3@demo.com"}]}},enabled:C&&!0}),z=Array.isArray(G)?G:[],{data:U}=ys({queryKey:["ap-dashboard",F],queryFn:()=>Rce(F),enabled:C&&!0}),{data:oe}=ys({queryKey:["ap-aging",F],queryFn:()=>Fce(F),enabled:C&&!0}),{data:Q}=ys({queryKey:["payment-data",F],queryFn:()=>Mce(F),enabled:C&&!0}),P=()=>{const ke=localStorage.getItem("token")||localStorage.getItem("auth_token"),gt=localStorage.getItem("company_id")||localStorage.getItem("companyId");if(!ke)return{tenantId:null,companyId:gt};try{return{tenantId:JSON.parse(Xc.Buffer.from(ke.split(".")[1],"base64").toString()).tenantId,companyId:gt}}catch(us){return console.error("Error parsing token:",us),{tenantId:null,companyId:gt}}},{data:q,isLoading:D}=ys({queryKey:["purchase-orders",F],queryFn:async()=>{try{const ke=localStorage.getItem("token")||localStorage.getItem("auth_token"),{tenantId:gt}=P();if(!gt||!F)return console.error("Missing tenant or company ID"),{items:[]};console.log("Fetching purchase orders with:",{tenantId:gt,companyId:F,token:ke?"present":"missing"});const us=await fetch(`${Ql()}/api/purchase-orders?companyId=${F}`,{headers:{Authorization:`Bearer ${ke}`,"x-tenant-id":gt,"x-company-id":F}});console.log("Purchase orders response status:",us.status);const We=await us.json();return console.log("Purchase orders data:",We),We}catch(ke){return console.error("Error fetching purchase orders:",ke),{items:[]}}},enabled:C&&!0}),se=((zt=A==null?void 0:A.data)==null?void 0:zt.invoices)||[],he=((St=V==null?void 0:V.data)==null?void 0:St.bills)||((js=V==null?void 0:V.data)==null?void 0:js.items)||(V==null?void 0:V.items)||[],be=((et=U==null?void 0:U.data)==null?void 0:et.summary)||{},pe=(oe==null?void 0:oe.data)||{},Ae=((lt=Q==null?void 0:Q.data)==null?void 0:lt.payments)||[],Ee=((Fe=Q==null?void 0:Q.data)==null?void 0:Fe.schedules)||[];(ft=Q==null?void 0:Q.data)!=null&&ft.bankAccounts;const $e=((He=Q==null?void 0:Q.data)==null?void 0:He.stats)||{},O=(q==null?void 0:q.items)||((Je=q==null?void 0:q.data)==null?void 0:Je.items)||[],te=()=>({vendorId:"",purchaseOrderId:"",invoiceNumber:"",invoiceDate:Kn(new Date,"yyyy-MM-dd"),dueDate:Kn(new Date(Date.now()+30*24*60*60*1e3),"yyyy-MM-dd"),totalAmount:"",subtotal:"",taxAmount:"",currency:"USD",source:"manual",notes:""}),[re,le]=x.useState(te()),[Z,K]=x.useState({purchaseOrderId:"",goodsReceivedNoteId:"",matchingType:"two_way"}),[X,ce]=x.useState({approverId:"current-user",approvalLevel:1,comments:"",status:"approved"}),[Y,ue]=x.useState({billId:"",scheduledDate:Kn(new Date,"yyyy-MM-dd"),amount:"",paymentMethod:"bank_transfer",bankAccountId:"",priority:"normal",notes:""}),ve=se.filter(ke=>{var We,Et;const gt=!s||ke.invoiceNumber.toLowerCase().includes(s.toLowerCase())||((Et=(We=ke.vendor)==null?void 0:We.name)==null?void 0:Et.toLowerCase().includes(s.toLowerCase())),us=r==="all"||ke.status===r;return gt&&us}),Le=he.filter(ke=>{var We,Et;const gt=!s||ke.billNumber.toLowerCase().includes(s.toLowerCase())||((Et=(We=ke.vendor)==null?void 0:We.name)==null?void 0:Et.toLowerCase().includes(s.toLowerCase())),us=r==="all"||ke.status===r;return gt&&us});console.log("Vendors loading:",L),console.log("Vendors error:",J),console.log("Vendors data (raw):",G),console.log("Vendors (processed):",z),console.log("Is vendors array?",Array.isArray(z)),console.log("Invoices loading:",T),console.log("Invoices data (raw):",A),console.log("Invoices data.data:",A==null?void 0:A.data),console.log("Invoices data.data.invoices:",(It=A==null?void 0:A.data)==null?void 0:It.invoices),console.log("Invoices (processed):",se),console.log("Is invoices array?",Array.isArray(se)),console.log("Invoices length:",se.length),se.length>0&&(console.log("First invoice structure:",se[0]),console.log("First invoice keys:",Object.keys(se[0]))),console.log("=== ALL DATA DEBUG ==="),console.log("Bills data:",V),console.log("Bills (processed):",he),console.log("Bills length:",he.length),console.log("Filtered bills length:",Le.length),console.log("Dashboard data:",U),console.log("Dashboard (processed):",be),console.log("Aging data:",oe),console.log("Aging (processed):",pe);const Me=Rs({mutationFn:async ke=>{const gt=localStorage.getItem("token")||localStorage.getItem("auth_token");if(!gt)throw new Error("No token found");console.log(" Token found:",gt?"Yes":"No"),console.log(" Token length:",gt==null?void 0:gt.length),console.log(" Token preview:",(gt==null?void 0:gt.substring(0,50))+"...");let us;try{const Pt=JSON.parse(Xc.Buffer.from(gt.split(".")[1],"base64").toString());us=Pt.tenantId,console.log(" Token payload:",Pt)}catch(Pt){throw console.error("Error parsing token:",Pt),new Error("Invalid token format")}console.log("Creating invoice with:",{tenantId:us,companyId:F,data:ke}),console.log(" Invoice data being sent:",JSON.stringify(ke,null,2));const We=await fetch(`${Ql()}/api/accounts-payable/invoices`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${gt}`,"x-tenant-id":us,"x-company-id":F},body:JSON.stringify(ke)});console.log("Invoice creation response status:",We.status),console.log("Invoice creation response headers:",Object.fromEntries(We.headers.entries()));const Et=await We.json();if(console.log("Invoice creation response:",Et),!We.ok){let Pt=`HTTP ${We.status}`;throw We.status===400?Et.details&&Array.isArray(Et.details)?Pt=`Validation failed: ${Et.details.map(ms=>{var Bs;return`${ms.field||((Bs=ms.path)==null?void 0:Bs.join("."))}: ${ms.message}`}).join(", ")}`:Et.message?Pt=Et.message:Pt="Invalid data provided. Please check all fields.":We.status===401?Pt="Authentication failed. Please log in again.":We.status===403?Pt="You do not have permission to perform this action.":We.status===500&&(Pt="Server error. Please try again later."),console.error(" Invoice creation failed:",{status:We.status,error:Et,data:ke}),new Error(Pt)}return Et},onSuccess:()=>{j.invalidateQueries({queryKey:["invoices"]}),ze.success("Invoice captured successfully"),d(!1),Rt()},onError:ke=>{var us,We,Et,Pt,rs,ms;console.error(" Invoice capture mutation error:",ke),console.error(" Error details:",{message:ke.message,stack:ke.stack,response:(us=ke.response)==null?void 0:us.data,status:(We=ke.response)==null?void 0:We.status});let gt="Failed to capture invoice";(Pt=(Et=ke.response)==null?void 0:Et.data)!=null&&Pt.message?gt=ke.response.data.message:(ms=(rs=ke.response)==null?void 0:rs.data)!=null&&ms.error?gt=ke.response.data.error:ke.message&&(gt=ke.message),ze.error(gt)}}),tt=Rs({mutationFn:async({invoiceId:ke,data:gt})=>await(await fetch(`${Ql()}/api/accounts-payable/invoices/${ke}/match`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"demo-tenant","x-company-id":F},body:JSON.stringify(gt)})).json(),onSuccess:()=>{j.invalidateQueries({queryKey:["invoices"]}),ze.success("Invoice matched successfully"),h(!1)}}),fe=Rs({mutationFn:async({invoiceId:ke,data:gt})=>{const us=localStorage.getItem("token")||localStorage.getItem("auth_token");if(!us)throw new Error("No token found");let We;try{We=JSON.parse(Xc.Buffer.from(us.split(".")[1],"base64").toString()).tenantId}catch(rs){throw console.error("Error parsing token:",rs),new Error("Invalid token")}console.log("Updating invoice with:",{tenantId:We,companyId:F,invoiceId:ke,data:gt});const Et=await fetch(`${Ql()}/api/accounts-payable/invoices/${ke}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${us}`,"x-tenant-id":We,"x-company-id":F},body:JSON.stringify(gt)});console.log("Update response status:",Et.status);const Pt=await Et.json();if(console.log("Update response:",Pt),!Et.ok)throw new Error(Pt.message||`HTTP ${Et.status}`);return Pt},onSuccess:ke=>{j.invalidateQueries({queryKey:["invoices"]}),ze.success("Invoice updated successfully!"),d(!1),Rt(),console.log("Update successful, data:",ke)},onError:ke=>{console.error("Update failed:",ke),ze.error("Failed to update invoice: "+((ke==null?void 0:ke.message)||"Unknown error"))}}),ct=Rs({mutationFn:async ke=>{const gt=localStorage.getItem("token")||localStorage.getItem("auth_token");if(!gt)throw new Error("No token found");let us;try{us=JSON.parse(Xc.Buffer.from(gt.split(".")[1],"base64").toString()).tenantId}catch(Pt){throw console.error("Error parsing token:",Pt),new Error("Invalid token")}console.log("Deleting invoice:",{tenantId:us,companyId:F,invoiceId:ke});const We=await fetch(`${Ql()}/api/accounts-payable/invoices/${ke}`,{method:"DELETE",headers:{Authorization:`Bearer ${gt}`,"x-tenant-id":us,"x-company-id":F}});console.log("Delete response status:",We.status);const Et=await We.json();if(console.log("Delete response:",Et),!We.ok)throw new Error(Et.message||`HTTP ${We.status}`);return Et},onSuccess:ke=>{j.invalidateQueries({queryKey:["invoices"]}),ze.success("Invoice deleted successfully!"),console.log("Delete successful, data:",ke)},onError:ke=>{console.error("Delete failed:",ke),ze.error("Failed to delete invoice: "+((ke==null?void 0:ke.message)||"Unknown error"))}}),dt=Rs({mutationFn:async({invoiceId:ke,data:gt})=>{const us=localStorage.getItem("token")||localStorage.getItem("auth_token");if(!us)throw new Error("No token found");let We;try{We=JSON.parse(Xc.Buffer.from(us.split(".")[1],"base64").toString()).tenantId}catch(rs){throw console.error("Error parsing token:",rs),new Error("Invalid token")}console.log("Approving invoice with:",{tenantId:We,companyId:F,invoiceId:ke,data:gt});const Et=await fetch(`${Ql()}/api/accounts-payable/invoices/${ke}/approve`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${us}`,"x-tenant-id":We,"x-company-id":F},body:JSON.stringify(gt)});console.log("Approval response status:",Et.status);const Pt=await Et.json();if(console.log("Approval response:",Pt),!Et.ok)throw new Error(Pt.message||`HTTP ${Et.status}`);return Pt},onSuccess:ke=>{j.invalidateQueries({queryKey:["invoices"]}),j.invalidateQueries({queryKey:["bills"]}),j.invalidateQueries({queryKey:["dashboard"]}),ze.success("Invoice approved successfully! Bill created."),m(!1),console.log("Approval successful, data:",ke)},onError:ke=>{console.error("Approval failed:",ke),ze.error("Failed to approve invoice: "+((ke==null?void 0:ke.message)||"Unknown error"))}}),pt=Rs({mutationFn:async ke=>{const gt=localStorage.getItem("token")||localStorage.getItem("auth_token");if(!gt)throw new Error("No token found");let us;try{us=JSON.parse(Xc.Buffer.from(gt.split(".")[1],"base64").toString()).tenantId}catch(Pt){throw console.error("Error parsing token:",Pt),new Error("Invalid token")}console.log("Processing payment with:",{tenantId:us,companyId:F,paymentData:ke});const We=await fetch(`${Ql()}/api/accounts-payable/payments/process`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${gt}`,"x-tenant-id":us,"x-company-id":F},body:JSON.stringify(ke)});console.log("Payment processing response status:",We.status);const Et=await We.json();if(console.log("Payment processing response:",Et),!We.ok)throw new Error(Et.message||`HTTP ${We.status}`);return Et},onSuccess:ke=>{j.invalidateQueries({queryKey:["bills"]}),j.invalidateQueries({queryKey:["payments"]}),j.invalidateQueries({queryKey:["purchase-orders"]}),j.invalidateQueries({queryKey:["dashboard"]}),ze.success("Payment processed successfully! Purchase orders marked as paid."),g(!1),console.log("Payment processed successfully, data:",ke)},onError:ke=>{console.error("Payment processing failed:",ke),ze.error("Failed to process payment: "+((ke==null?void 0:ke.message)||"Unknown error"))}}),qe=Rs({mutationFn:async ke=>await(await fetch(`${Ql()}/api/accounts-payable/payment-schedule`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("token")||localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"demo-tenant","x-company-id":F},body:JSON.stringify(ke)})).json(),onSuccess:()=>{j.invalidateQueries({queryKey:["bills"]}),ze.success("Payment scheduled successfully"),g(!1)}}),mt=ke=>{le({vendorId:ke.vendorId||"",invoiceNumber:ke.invoiceNumber||"",invoiceDate:ke.invoiceDate||"",dueDate:ke.dueDate||"",totalAmount:ke.totalAmount?parseFloat(ke.totalAmount).toFixed(2):"",subtotal:ke.subtotal?parseFloat(ke.subtotal).toFixed(2):"",taxAmount:ke.taxAmount?parseFloat(ke.taxAmount).toFixed(2):"",currency:ke.currency||"USD",source:ke.source||"manual",notes:ke.notes||"",purchaseOrderId:""})},Rt=()=>{le(te()),l(null),y({})},_e=()=>{var Et;if(!b){ze.error("Please log in to capture invoices");return}if(!(localStorage.getItem("token")||localStorage.getItem("auth_token"))){ze.error("Authentication token not found. Please log in again.");return}const gt={};if(!re.vendorId||re.vendorId==="loading-vendors"||re.vendorId==="no-vendors"?gt.vendorId="Please select a vendor":(typeof re.vendorId!="string"||re.vendorId.trim()==="")&&(gt.vendorId="Vendor ID must be a valid string"),!re.invoiceNumber||re.invoiceNumber.trim()===""?gt.invoiceNumber="Please enter an invoice number":typeof re.invoiceNumber!="string"&&(gt.invoiceNumber="Invoice number must be a valid string"),!re.invoiceDate)gt.invoiceDate="Please select an invoice date";else{const Pt=new Date(re.invoiceDate);isNaN(Pt.getTime())&&(gt.invoiceDate="Please enter a valid date")}if(re.dueDate){const Pt=new Date(re.dueDate);isNaN(Pt.getTime())&&(gt.dueDate="Please enter a valid due date")}if(!re.totalAmount||re.totalAmount.trim()==="")gt.totalAmount="Please enter a total amount";else{const Pt=parseFloat(re.totalAmount);isNaN(Pt)?gt.totalAmount="Total amount must be a valid number":Pt<=0&&(gt.totalAmount="Total amount must be greater than 0")}if(!re.subtotal||re.subtotal.trim()==="")gt.subtotal="Please enter a subtotal amount";else{const Pt=parseFloat(re.subtotal);isNaN(Pt)?gt.subtotal="Subtotal must be a valid number":Pt<0&&(gt.subtotal="Subtotal cannot be negative")}if(!re.taxAmount||re.taxAmount.trim()==="")gt.taxAmount="Please enter a tax amount";else{const Pt=parseFloat(re.taxAmount);isNaN(Pt)?gt.taxAmount="Tax amount must be a valid number":Pt<0&&(gt.taxAmount="Tax amount cannot be negative")}!re.currency||re.currency.trim()===""?gt.currency="Please select a currency":re.currency.length!==3&&(gt.currency="Currency must be exactly 3 characters (e.g., USD)");const us=["manual","email","api","ocr","upload"];if(!re.source||re.source.trim()===""?gt.source="Please select a source":us.includes(re.source)||(gt.source=`Source must be one of: ${us.join(", ")}`),re.purchaseOrderId&&(re.purchaseOrderId==="loading"||re.purchaseOrderId==="no-pos")&&(gt.purchaseOrderId="Please select a valid purchase order"),!gt.subtotal&&!gt.taxAmount&&!gt.totalAmount){const Pt=parseFloat(re.subtotal),rs=parseFloat(re.taxAmount),ms=parseFloat(re.totalAmount),Bs=Pt+rs;Math.abs(Bs-ms)>.01&&(gt.totalAmount=`Total amount (${ms}) should equal subtotal (${Pt}) + tax (${rs}) = ${Bs}`)}if(y(gt),Object.keys(gt).length>0){console.log(" Form validation failed:",gt);return}const We={vendorId:String(re.vendorId).trim(),invoiceNumber:String(re.invoiceNumber).trim(),invoiceDate:re.invoiceDate,dueDate:re.dueDate?re.dueDate:null,totalAmount:Number(parseFloat(re.totalAmount)),subtotal:Number(parseFloat(re.subtotal)),taxAmount:Number(parseFloat(re.taxAmount)),currency:String(re.currency).toUpperCase(),source:String(re.source),notes:((Et=re.notes)==null?void 0:Et.trim())||null,...re.purchaseOrderId&&re.purchaseOrderId!=="loading"&&re.purchaseOrderId!=="no-pos"&&{purchaseOrderId:String(re.purchaseOrderId).trim()}};if(console.log(" Sending invoice data:",We),typeof We.vendorId!="string"||We.vendorId===""){console.error(" Invalid vendorId after transformation:",We.vendorId),y({vendorId:"Invalid vendor selected"});return}if(typeof We.totalAmount!="number"||We.totalAmount<=0){console.error(" Invalid totalAmount after transformation:",We.totalAmount),y({totalAmount:"Invalid total amount"});return}if(typeof We.subtotal!="number"||We.subtotal<0){console.error(" Invalid subtotal after transformation:",We.subtotal),y({subtotal:"Invalid subtotal amount"});return}if(typeof We.taxAmount!="number"||We.taxAmount<0){console.error(" Invalid taxAmount after transformation:",We.taxAmount),y({taxAmount:"Invalid tax amount"});return}o&&o.id?fe.mutate({invoiceId:o.id,data:We}):Me.mutate(We)},Xe=()=>{o&&tt.mutate({invoiceId:o.id,data:Z})},At=()=>{o&&dt.mutate({invoiceId:o.id,data:X})},st=()=>{qe.mutate(Y)},$t=()=>{if(console.log("Payment form state:",Y),!Y.billId){ze.error("No bill selected for payment");return}if(!Y.amount||parseFloat(Y.amount)<=0){ze.error("Please enter a valid payment amount");return}if(!Y.paymentMethod){ze.error("Please select a payment method");return}const ke={billId:Y.billId,amount:parseFloat(Y.amount).toString(),paymentMethod:Y.paymentMethod,notes:Y.notes||null};console.log("Sending payment data:",ke),pt.mutate(ke)},fs=ke=>{switch(ke){case"captured":return"bg-blue-100 text-blue-800";case"processing":return"bg-yellow-100 text-yellow-800";case"matched":return"bg-green-100 text-green-800";case"approved":return"bg-emerald-100 text-emerald-800";case"paid":return"bg-gray-100 text-gray-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return C?e.jsxs(Kr,{title:"UrutiIQ Accounts Payable",description:"Comprehensive invoice processing, matching, approval, and payment management",children:[e.jsx("style",{children:`
        .sonner-toaster {
          z-index: 9999 !important;
        }
        .sonner-toast {
          z-index: 9999 !important;
        }
      `}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Total Invoices"}),e.jsx(Zt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:be.totalInvoices||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[be.pendingInvoices||0," pending capture"]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Outstanding Bills"}),e.jsx(Mr,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",((Gt=be.totalOutstanding)==null?void 0:Gt.toLocaleString())||"0"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[be.overdueBills||0," overdue"]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Vendors"}),e.jsx(Sa,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:be.totalVendors||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active suppliers"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Processing Rate"}),e.jsx($s,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[be.totalInvoices>0?Math.round(be.approvedInvoices/be.totalInvoices*100):0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Invoices approved"})]})]})]}),e.jsxs(an,{value:a,onValueChange:i,className:"space-y-4",children:[e.jsxs(on,{children:[e.jsx(vt,{value:"overview",children:"Overview"}),e.jsx(vt,{value:"invoices",children:"Invoice Capture"}),e.jsx(vt,{value:"payments",children:"Payment Management"}),e.jsx(vt,{value:"reports",children:"Reports & Analytics"})]}),e.jsx(yt,{value:"overview",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Recent Bills"}),e.jsxs(Vt,{children:["Latest bills (",he.length," total)"]})]}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-2",children:he.slice(0,5).map(ke=>{var gt;return e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:ke.billNumber}),e.jsx("p",{className:"text-sm text-muted-foreground",children:(gt=ke.vendor)==null?void 0:gt.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium",children:["$",Number(ke.totalAmount).toLocaleString()]}),e.jsx(Oe,{className:fs(ke.status),children:ke.status})]})]},ke.id)})})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"AP Aging Summary"}),e.jsx(Vt,{children:"Outstanding amounts by age"})]}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-2",children:pe.agingSummary&&Object.entries(pe.agingSummary).map(([ke,gt])=>{var us;return e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium capitalize",children:ke.replace("_"," ")}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[gt.count," bills"]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"font-medium",children:["$",((us=gt.totalAmount)==null?void 0:us.toLocaleString())||"0"]})})]},ke)})})})]})]})}),e.jsxs(yt,{value:"invoices",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(ge,{placeholder:"Search invoices...",value:s,onChange:ke=>t(ke.target.value),className:"w-64"}),e.jsxs(rt,{value:r,onValueChange:n,children:[e.jsx(nt,{className:"w-32",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Status"}),e.jsx(W,{value:"captured",children:"Captured"}),e.jsx(W,{value:"processing",children:"Processing"}),e.jsx(W,{value:"matched",children:"Matched"}),e.jsx(W,{value:"approved",children:"Approved"}),e.jsx(W,{value:"paid",children:"Paid"})]})]})]}),e.jsxs(I,{onClick:()=>{Rt(),d(!0)},children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Capture Invoice"]})]}),e.jsx(ne,{children:e.jsxs(Ol,{children:[e.jsx(Rl,{children:e.jsxs(Dn,{children:[e.jsx(_s,{children:"Invoice #"}),e.jsx(_s,{children:"Vendor"}),e.jsx(_s,{children:"Date"}),e.jsx(_s,{children:"Amount"}),e.jsx(_s,{children:"Status"}),e.jsx(_s,{children:"PO Reference"}),e.jsx(_s,{children:"Source"}),e.jsx(_s,{children:"Actions"})]})}),e.jsx(Fl,{children:T?e.jsx(Dn,{children:e.jsx(Cs,{colSpan:7,className:"text-center py-8",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(kr,{size:"md",color:"teal"}),e.jsx("span",{className:"ml-3 text-muted-foreground",children:"Loading invoices..."})]})})}):ve.length===0?e.jsx(Dn,{children:e.jsx(Cs,{colSpan:7,className:"text-center py-8",children:se.length===0?'No invoices found. Click "Capture Invoice" to add one.':"No invoices match your filters."})}):ve.map(ke=>{var gt;return e.jsxs(Dn,{children:[e.jsx(Cs,{className:"font-medium",children:ke.invoiceNumber}),e.jsx(Cs,{children:(gt=ke.vendor)==null?void 0:gt.name}),e.jsx(Cs,{children:Kn(new Date(ke.invoiceDate),"MMM dd, yyyy")}),e.jsxs(Cs,{children:["$",Number(ke.totalAmount).toLocaleString()]}),e.jsx(Cs,{children:e.jsx(Oe,{className:fs(ke.status),children:ke.status})}),e.jsx(Cs,{children:ke.rawData&&JSON.parse(ke.rawData||"{}").purchaseOrderId?e.jsxs(Oe,{variant:"secondary",className:"bg-green-100 text-green-800",children:["PO-",JSON.parse(ke.rawData).purchaseOrderId]}):e.jsx("span",{className:"text-muted-foreground text-sm",children:"No PO"})}),e.jsx(Cs,{children:e.jsx(Oe,{variant:"outline",children:ke.source})}),e.jsx(Cs,{children:e.jsxs("div",{className:"flex space-x-2",children:[ke.status==="captured"&&e.jsxs(e.Fragment,{children:[e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{l(ke),mt(ke),d(!0)},title:"Edit Invoice",children:e.jsx(ln,{className:"h-4 w-4"})}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{confirm(`Are you sure you want to delete invoice ${ke.invoiceNumber}? This action cannot be undone.`)&&ct.mutate(ke.id)},disabled:ct.isPending,title:"Delete Invoice",children:e.jsx(hn,{className:"h-4 w-4"})})]}),!ke.rawData||!JSON.parse(ke.rawData||"{}").purchaseOrderId?e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{l(ke),h(!0)},title:"Match Invoice",children:e.jsx(p6,{className:"h-4 w-4"})}):e.jsxs("div",{className:"flex items-center space-x-1 text-green-600",title:"Already matched with Purchase Order",children:[e.jsx(p6,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs",children:"Matched"})]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{l(ke),m(!0)},title:"Approve Invoice",children:e.jsx(bs,{className:"h-4 w-4"})})]})})]},ke.id)})})]})})]}),e.jsxs(yt,{value:"payments",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Total Paid"}),e.jsx(Mr,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",((qt=$e.totalPaid)==null?void 0:qt.toLocaleString())||"0"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[$e.totalPayments||0," payments made"]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Scheduled"}),e.jsx(Xn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",((As=$e.totalScheduled)==null?void 0:As.toLocaleString())||"0"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Upcoming payments"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Bank Balance"}),e.jsx(iM,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",((Ht=$e.totalBankBalance)==null?void 0:Ht.toLocaleString())||"0"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[$e.bankAccounts||0," accounts"]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Recent Payments"}),e.jsx(bs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:Ae.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Payment records"})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(ge,{placeholder:"Search bills...",value:s,onChange:ke=>t(ke.target.value),className:"w-64"}),e.jsxs(rt,{value:r,onValueChange:n,children:[e.jsx(nt,{className:"w-32",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Status"}),e.jsx(W,{value:"posted",children:"Posted"}),e.jsx(W,{value:"partially_paid",children:"Partially Paid"}),e.jsx(W,{value:"paid",children:"Paid"}),e.jsx(W,{value:"overdue",children:"Overdue"})]})]})]}),e.jsxs(I,{onClick:()=>g(!0),children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Schedule Payment"]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{children:["All Bills (",he.length," total)"]}),e.jsxs(Vt,{children:["Showing ",Le.length," bills after filtering"]})]}),e.jsxs(Ol,{children:[e.jsx(Rl,{children:e.jsxs(Dn,{children:[e.jsx(_s,{children:"Bill #"}),e.jsx(_s,{children:"Vendor"}),e.jsx(_s,{children:"Due Date"}),e.jsx(_s,{children:"Amount"}),e.jsx(_s,{children:"Balance Due"}),e.jsx(_s,{children:"PO Reference"}),e.jsx(_s,{children:"Status"}),e.jsx(_s,{children:"Actions"})]})}),e.jsx(Fl,{children:M?e.jsx(Dn,{children:e.jsx(Cs,{colSpan:8,className:"text-center py-8",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(kr,{size:"md",color:"teal"}),e.jsx("span",{className:"ml-3 text-muted-foreground",children:"Loading bills..."})]})})}):Le.length===0?e.jsx(Dn,{children:e.jsx(Cs,{colSpan:8,className:"text-center py-8",children:he.length===0?"No bills found.":"No bills match your filters."})}):Le.map(ke=>{var gt,us;return e.jsxs(Dn,{children:[e.jsx(Cs,{className:"font-medium",children:ke.billNumber}),e.jsx(Cs,{children:(gt=ke.vendor)==null?void 0:gt.name}),e.jsx(Cs,{children:ke.dueDate?Kn(new Date(ke.dueDate),"MMM dd, yyyy"):"N/A"}),e.jsxs(Cs,{children:["$",Number(ke.totalAmount).toLocaleString()]}),e.jsxs(Cs,{children:["$",Number(ke.balanceDue).toLocaleString()]}),e.jsx(Cs,{children:(us=ke.invoiceCapture)!=null&&us.rawData&&JSON.parse(ke.invoiceCapture.rawData||"{}").purchaseOrderId?e.jsxs(Oe,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:["PO-",JSON.parse(ke.invoiceCapture.rawData).purchaseOrderId]}):e.jsx("span",{className:"text-muted-foreground text-sm",children:"No PO"})}),e.jsx(Cs,{children:e.jsx(Oe,{className:fs(ke.status),children:ke.status})}),e.jsx(Cs,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(I,{variant:"default",size:"sm",onClick:()=>{ue({...Y,billId:ke.id,amount:Number(ke.balanceDue).toString(),paymentMethod:"bank_transfer",scheduledDate:new Date().toISOString().split("T")[0]}),g(!0)},disabled:ke.status==="paid"||ke.balanceDue<=0,title:ke.status==="paid"?"Already paid":"Pay now",children:[e.jsx($a,{className:"h-4 w-4 mr-1"}),"Pay Now"]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{ue({...Y,billId:ke.id,amount:ke.balanceDue.toString()}),g(!0)},title:"Schedule payment",children:e.jsx(Xn,{className:"h-4 w-4"})})]})})]},ke.id)})})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Recent Payments"}),e.jsx(Vt,{children:"Latest payment transactions"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-2",children:[Ae.slice(0,5).map(ke=>{var gt,us,We;return e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:(gt=ke.bill)==null?void 0:gt.billNumber}),e.jsx("p",{className:"text-sm text-muted-foreground",children:(We=(us=ke.bill)==null?void 0:us.vendor)==null?void 0:We.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium",children:["$",Number(ke.amount).toLocaleString()]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:Kn(new Date(ke.paymentDate),"MMM dd, yyyy")})]})]},ke.id)}),Ae.length===0&&e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No payments found"})]})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Upcoming Payments"}),e.jsx(Vt,{children:"Scheduled payment transactions"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-2",children:[Ee.slice(0,5).map(ke=>{var gt,us,We;return e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:(gt=ke.bill)==null?void 0:gt.billNumber}),e.jsx("p",{className:"text-sm text-muted-foreground",children:(We=(us=ke.bill)==null?void 0:us.vendor)==null?void 0:We.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium",children:["$",Number(ke.amount).toLocaleString()]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:Kn(new Date(ke.scheduledDate),"MMM dd, yyyy")})]})]},ke.id)}),Ee.length===0&&e.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No scheduled payments"})]})})]})]}),e.jsx(yt,{value:"reports",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"AP Aging Report"}),e.jsx(Vt,{children:"Outstanding amounts by aging buckets"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[pe.agingSummary&&Object.entries(pe.agingSummary).map(([ke,gt])=>{var us;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium capitalize",children:ke.replace("_"," ")}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[gt.count," bills"]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-lg font-bold",children:["$",((us=gt.totalAmount)==null?void 0:us.toLocaleString())||"0"]})})]},ke)}),e.jsx("div",{className:"border-t pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"font-bold",children:"Total Outstanding"}),e.jsxs("p",{className:"text-xl font-bold",children:["$",((xs=pe.totalOutstanding)==null?void 0:xs.toLocaleString())||"0"]})]})})]})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Processing Statistics"}),e.jsx(Vt,{children:"Invoice processing metrics"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Total Invoices"}),e.jsx("span",{className:"font-bold",children:be.totalInvoices||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Pending Processing"}),e.jsx("span",{className:"font-bold",children:be.pendingInvoices||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Matched"}),e.jsx("span",{className:"font-bold",children:be.matchedInvoices||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Approved"}),e.jsx("span",{className:"font-bold",children:be.approvedInvoices||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Processing Rate"}),e.jsxs("span",{className:"font-bold",children:[be.totalInvoices>0?Math.round(be.approvedInvoices/be.totalInvoices*100):0,"%"]})]})]})})]})]})})]}),e.jsx(ts,{open:c,onOpenChange:ke=>{d(ke),ke||Rt()},children:e.jsxs(ss,{className:"max-w-2xl",children:[e.jsxs(as,{children:[e.jsx(is,{children:o?"Edit Invoice":"Capture New Invoice"}),e.jsx(Ks,{children:o?"Update invoice details":"Create an invoice for a purchase order to process payment"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium",children:"Purchase Order"}),e.jsxs(I,{type:"button",variant:"outline",size:"sm",onClick:()=>{ze.info("Create purchase order functionality coming soon!")},children:[e.jsx(Ss,{className:"h-4 w-4 mr-1"}),"Create PO"]})]}),e.jsxs(rt,{value:re.purchaseOrderId,onValueChange:ke=>{const gt=O.find(We=>We.id===ke),us=gt!=null&&gt.totalAmount?parseFloat(gt.totalAmount).toFixed(2):re.totalAmount;le({...re,purchaseOrderId:ke,vendorId:(gt==null?void 0:gt.vendorId)||re.vendorId,totalAmount:us}),v.purchaseOrderId&&y({...v,purchaseOrderId:""})},children:[e.jsx(nt,{className:v.purchaseOrderId?"border-red-500":"",children:e.jsx(it,{placeholder:D?"Loading purchase orders...":"Select purchase order",children:re.purchaseOrderId&&((Ct=O.find(ke=>ke.id===re.purchaseOrderId))==null?void 0:Ct.poNumber)||"Select purchase order"})}),e.jsx(at,{children:D?e.jsx(W,{value:"loading",disabled:!0,children:"Loading purchase orders..."}):!Array.isArray(O)||O.length===0?e.jsx(W,{value:"no-pos",disabled:!0,children:"No purchase orders found - Create one first"}):O.filter(ke=>["approved","delivered"].includes(ke.status)).map(ke=>{var gt;return e.jsxs(W,{value:ke.id,children:[ke.poNumber," - ",(gt=ke.vendor)==null?void 0:gt.name," ($",parseFloat(ke.totalAmount).toFixed(2),") - ",ke.status]},ke.id)})})]}),v.purchaseOrderId&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:v.purchaseOrderId}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Select a purchase order to automatically populate vendor and amount"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium",children:"Vendor"}),(!Array.isArray(z)||z.length===0)&&!L&&e.jsxs(I,{type:"button",variant:"outline",size:"sm",onClick:()=>{ze.info("Create vendor functionality coming soon!")},children:[e.jsx(Ss,{className:"h-4 w-4 mr-1"}),"Create Vendor"]})]}),e.jsxs(rt,{value:re.vendorId,onValueChange:ke=>{le({...re,vendorId:ke}),v.vendorId&&y({...v,vendorId:""})},children:[e.jsx(nt,{className:v.vendorId?"border-red-500":"",children:e.jsx(it,{placeholder:L?"Loading vendors...":"Select vendor"})}),e.jsx(at,{children:L?e.jsx(W,{value:"loading-vendors",disabled:!0,children:"Loading vendors..."}):!Array.isArray(z)||z.length===0?e.jsx(W,{value:"no-vendors",disabled:!0,children:"No vendors found - Create one first"}):z.map(ke=>e.jsx(W,{value:ke.id,children:ke.name},ke.id))})]}),v.vendorId&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:v.vendorId}),J&&e.jsxs("p",{className:"text-sm text-red-500 mt-1",children:["Error loading vendors: ",J.message]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Invoice Number"}),e.jsx(ge,{value:re.invoiceNumber,onChange:ke=>{le({...re,invoiceNumber:ke.target.value}),v.invoiceNumber&&y({...v,invoiceNumber:""})},placeholder:"Enter invoice number",className:v.invoiceNumber?"border-red-500":""}),v.invoiceNumber&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:v.invoiceNumber})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Invoice Date"}),e.jsx(ge,{type:"date",value:re.invoiceDate,onChange:ke=>{le({...re,invoiceDate:ke.target.value}),v.invoiceDate&&y({...v,invoiceDate:""})},className:v.invoiceDate?"border-red-500":""}),v.invoiceDate&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:v.invoiceDate})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Due Date"}),e.jsx(ge,{type:"date",value:re.dueDate,onChange:ke=>le({...re,dueDate:ke.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Total Amount"}),e.jsx(ge,{type:"number",value:re.totalAmount,onChange:ke=>{const gt=ke.target.value,us=gt?parseFloat(gt).toFixed(2):"";le({...re,totalAmount:us}),v.totalAmount&&y({...v,totalAmount:""})},placeholder:"0.00",className:`text-right font-mono ${v.totalAmount?"border-red-500":""}`,step:"0.01",min:"0"}),v.totalAmount&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:v.totalAmount})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Currency"}),e.jsxs(rt,{value:re.currency,onValueChange:ke=>le({...re,currency:ke}),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"USD",children:"USD"}),e.jsx(W,{value:"EUR",children:"EUR"}),e.jsx(W,{value:"GBP",children:"GBP"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Source"}),e.jsxs(rt,{value:re.source,onValueChange:ke=>le({...re,source:ke}),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"manual",children:"Manual Entry"}),e.jsx(W,{value:"email",children:"Email"}),e.jsx(W,{value:"api",children:"API"}),e.jsx(W,{value:"ocr",children:"OCR Scan"}),e.jsx(W,{value:"upload",children:"File Upload"})]})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Notes"}),e.jsx(ge,{value:re.notes,onChange:ke=>le({...re,notes:ke.target.value}),placeholder:"Additional notes"})]})]}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),e.jsx(I,{onClick:_e,disabled:Me.isPending||fe.isPending,children:Me.isPending||fe.isPending?e.jsxs(e.Fragment,{children:[e.jsx(kr,{size:"sm",className:"mr-2",color:"teal"}),o?"Updating...":"Capturing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),o?"Update Invoice":"Capture Invoice"]})})]})]})}),e.jsx(ts,{open:u,onOpenChange:h,children:e.jsxs(ss,{children:[e.jsxs(as,{children:[e.jsx(is,{children:"Match Invoice"}),e.jsx(Ks,{children:"Match invoice with purchase order and goods received note"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Matching Type"}),e.jsxs(rt,{value:Z.matchingType,onValueChange:ke=>K({...Z,matchingType:ke}),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"two_way",children:"Two-way (Invoice + PO)"}),e.jsx(W,{value:"three_way",children:"Three-way (Invoice + PO + GRN)"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Purchase Order"}),e.jsxs(rt,{value:Z.purchaseOrderId,onValueChange:ke=>K({...Z,purchaseOrderId:ke}),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select PO"})}),e.jsx(at,{})]})]}),Z.matchingType==="three_way"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Goods Received Note"}),e.jsxs(rt,{value:Z.goodsReceivedNoteId,onValueChange:ke=>K({...Z,goodsReceivedNoteId:ke}),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select GRN"})}),e.jsx(at,{})]})]})]}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:()=>h(!1),children:"Cancel"}),e.jsx(I,{onClick:Xe,disabled:tt.isPending,children:tt.isPending?"Matching...":"Match Invoice"})]})]})}),e.jsx(ts,{open:f,onOpenChange:m,children:e.jsxs(ss,{children:[e.jsxs(as,{children:[e.jsx(is,{children:"Approve Invoice"}),e.jsx(Ks,{children:"Review and approve or reject the invoice"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Approver ID"}),e.jsx(ge,{value:X.approverId,onChange:ke=>ce({...X,approverId:ke.target.value}),placeholder:"Enter approver ID"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Approval Level"}),e.jsxs(rt,{value:X.approvalLevel.toString(),onValueChange:ke=>ce({...X,approvalLevel:parseInt(ke)}),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"1",children:"Level 1"}),e.jsx(W,{value:"2",children:"Level 2"}),e.jsx(W,{value:"3",children:"Level 3"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Decision"}),e.jsxs(rt,{value:X.status,onValueChange:ke=>ce({...X,status:ke}),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"approved",children:"Approve"}),e.jsx(W,{value:"rejected",children:"Reject"}),e.jsx(W,{value:"delegated",children:"Delegate"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Comments"}),e.jsx(ge,{value:X.comments,onChange:ke=>ce({...X,comments:ke.target.value}),placeholder:"Approval comments"})]})]}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsx(I,{onClick:At,disabled:dt.isPending,children:dt.isPending?"Processing...":"Submit Decision"})]})]})}),e.jsx(ts,{open:p,onOpenChange:g,children:e.jsxs(ss,{children:[e.jsxs(as,{children:[e.jsx(is,{children:"Schedule Payment"}),e.jsx(Ks,{children:"Schedule a payment for the selected bill"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Scheduled Date"}),e.jsx(ge,{type:"date",value:Y.scheduledDate,onChange:ke=>ue({...Y,scheduledDate:ke.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Amount"}),e.jsx(ge,{type:"number",value:Y.amount,onChange:ke=>ue({...Y,amount:ke.target.value}),placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Payment Method"}),e.jsxs(rt,{value:Y.paymentMethod,onValueChange:ke=>ue({...Y,paymentMethod:ke}),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"check",children:"Check"}),e.jsx(W,{value:"bank_transfer",children:"Bank Transfer"}),e.jsx(W,{value:"credit_card",children:"Credit Card"}),e.jsx(W,{value:"cash",children:"Cash"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Priority"}),e.jsxs(rt,{value:Y.priority,onValueChange:ke=>ue({...Y,priority:ke}),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"low",children:"Low"}),e.jsx(W,{value:"normal",children:"Normal"}),e.jsx(W,{value:"high",children:"High"}),e.jsx(W,{value:"urgent",children:"Urgent"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Notes"}),e.jsx(ge,{value:Y.notes,onChange:ke=>ue({...Y,notes:ke.target.value}),placeholder:"Payment notes"})]})]}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:()=>g(!1),children:"Cancel"}),e.jsx(I,{variant:"default",onClick:$t,disabled:pt.isPending||qe.isPending,children:pt.isPending?"Processing...":"Pay Now"}),e.jsx(I,{variant:"outline",onClick:st,disabled:qe.isPending||pt.isPending,children:qe.isPending?"Scheduling...":"Schedule Payment"})]})]})})]})]}):e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(kr,{size:"lg",color:"teal"}),e.jsx("p",{className:"text-muted-foreground mt-4",children:"Loading accounts payable..."})]})})}const Qa={async get(s){return await de.get(s)},async post(s,t){return await de.post(s,t)},async put(s,t){return await de.put(s,t)},async delete(s){return await de.delete(s)},async getBankAccounts(s){const t=s?`?companyId=${encodeURIComponent(s)}`:"";return await de.get(`/api/bank-accounts${t}`)||[]},async createBankAccount(s){return await de.post("/api/bank-accounts",s)},async getBankTransactions(s,t,r,n=1,a=50){const i=new URLSearchParams;s&&i.append("bankAccountId",s),t&&i.append("companyId",t),r&&i.append("status",r),i.append("page",n.toString()),i.append("pageSize",a.toString());const l=`/api/bank-transactions${i.toString()?`?${i.toString()}`:""}`;return await de.get(l)||{items:[],page:1,pageSize:50,total:0,totalPages:0,hasNext:!1,hasPrev:!1}},async createBankTransaction(s){return await de.post("/api/bank-transactions",s)},async getPayments(s){const t=s?`?companyId=${encodeURIComponent(s)}`:"";return await de.get(`/api/payments${t}`)||[]},async postBankFeed(s,t){return(await de.post("/api/bank-feed?companyId="+encodeURIComponent(t||""),{feed:s})).data},async reconcileTransaction(s,t){return(await de.post(`/api/bank-transactions/${encodeURIComponent(s)}/reconcile`,t)).data},async getCurrencies(){return await de.get("/api/currencies")},async getExchangeRate(s,t,r){const n=`/api/exchange-rates/${s}/${t}${r?`?date=${r}`:""}`;return await de.get(n)},async convertCurrency(s,t,r,n){return await de.post("/api/convert-currency",{amount:s,fromCurrency:t,toCurrency:r,date:n})},async getHistoricalRates(s,t,r,n){const a=`/api/historical-rates/${s}/${t}?startDate=${r}&endDate=${n}`;return await de.get(a)},async updateExchangeRates(){return await de.post("/api/update-exchange-rates")},async forceRefreshRate(s,t){return await de.post(`/api/force-refresh-rate/${s}/${t}`)},async formatCurrency(s,t){return await de.post("/api/format-currency",{amount:s,currency:t})},async initializeProcessor(s,t){return await de.post("/api/payment-processors/initialize",{processorType:s,config:t})},async createPaymentIntent(s,t,r={}){return await de.post("/api/payment-intents",{amount:s,currency:t,...r})},async confirmPaymentIntent(s,t){return await de.post(`/api/payment-intents/${s}/confirm`,{paymentMethodId:t})},async createCustomer(s){console.log("=== BANKING API DEBUG ==="),console.log("bankingApi.createCustomer called with:",s),console.log("Calling endpoint: /api/payment-customers");const t=await de.post("/api/payment-customers",s);return console.log("API response:",t),t},async addPaymentMethod(s){console.log("=== BANKING API DEBUG ==="),console.log("bankingApi.addPaymentMethod called with:",s),console.log("Calling endpoint: /api/payment-methods");const t=await de.post("/api/payment-methods",s);return console.log("API response:",t),t},async getProcessorStats(){return await de.get("/api/payment-processors/stats")},async getPaymentIntents(s={}){const t=new URLSearchParams;s.limit&&t.append("limit",s.limit.toString()),s.status&&t.append("status",s.status),s.processor&&t.append("processor",s.processor);const r=`/api/payment-intents${t.toString()?`?${t.toString()}`:""}`;return await de.get(r)},async getPaymentCustomers(s={}){const t=new URLSearchParams;s.limit&&t.append("limit",s.limit.toString()),s.search&&t.append("search",s.search),s.companyId&&t.append("companyId",s.companyId);const r=`/api/payment-customers${t.toString()?`?${t.toString()}`:""}`;return await de.get(r)},async getPaymentMethods(s={}){const t=new URLSearchParams;s.customerId&&t.append("customerId",s.customerId),s.limit&&t.append("limit",s.limit.toString()),s.companyId&&t.append("companyId",s.companyId);const r=`/api/payment-methods${t.toString()?`?${t.toString()}`:""}`;return await de.get(r)},async getFinancialInsights(s){const t=s?`/api/analytics/insights?industry=${s}`:"/api/analytics/insights";return await de.get(t)},async getIndustryBenchmarks(s){return await de.get(`/api/analytics/benchmarks/${s}`)},async getCashFlowForecast(s=6){return await de.get(`/api/analytics/cash-flow-forecast?months=${s}`)},async getInstitutions(s,t,r){const n=new URLSearchParams;s&&n.append("provider",s),t&&n.append("country",t),r&&n.append("search",r);const a=`/api/institutions${n.toString()?`?${n.toString()}`:""}`;return await de.get(a)},async createConnection(s,t,r){return await de.post("/api/connections",{provider:s,institutionId:t,credentials:r})},async getConnections(){return await de.get("/api/connections")},async getConnectionStatus(s){return await de.get(`/api/connections/${s}/status`)},async syncConnection(s){return await de.post(`/api/connections/${s}/sync`)},async disconnectConnection(s){return await de.post(`/api/connections/${s}/disconnect`)},async reconnectConnection(s){return await de.post(`/api/connections/${s}/reconnect`)},async getConnectionStats(){return await de.get("/api/connections/stats")},async getMobileStats(){return await de.get("/api/mobile/stats")},async getMobileTransactions(s=20){return await de.get(`/api/mobile/transactions?limit=${s}`)},async getMobileAccounts(){return await de.get("/api/mobile/accounts")},async getMobileInsights(){return await de.get("/api/mobile/insights")},async getMobileNotifications(){return await de.get("/api/mobile/notifications")},async getQuickActions(){return await de.get("/api/mobile/quick-actions")},async executeQuickAction(s,t){return await de.post(`/api/mobile/quick-actions/${s}`,t)},async getMobileMoneyProviders(s){const t=`/api/mobile-money/providers${s?`?country=${s}`:""}`;return await de.get(t)},async getMobileMoneyProvider(s){return await de.get(`/api/mobile-money/providers/${s}`)},async createMobileMoneyAccount(s){return await de.post("/api/mobile-money/accounts",s)},async getMobileMoneyAccounts(){return await de.get("/api/mobile-money/accounts")},async initiateMobileMoneyPayment(s){return await de.post("/api/mobile-money/payments",s)},async getMobileMoneyTransactions(s,t){const r=new URLSearchParams;s&&r.append("provider",s),t&&r.append("limit",t.toString());const n=`/api/mobile-money/transactions${r.toString()?`?${r.toString()}`:""}`;return await de.get(n)},async getMobileMoneyBalance(s,t){return await de.get(`/api/mobile-money/balance?provider=${s}&phoneNumber=${t}`)},async getMobileMoneyStats(){return await de.get("/api/mobile-money/stats")},async forceRefreshHistorical(s,t,r,n){return await de.post(`/api/force-refresh-historical/${s}/${t}`,{startDate:r,endDate:n})}};function fk({companyId:s}){const[t,r]=x.useState(null),[n,a]=x.useState(!0),[i,o]=x.useState("30"),[l,c]=x.useState("all");x.useEffect(()=>{d()},[i,l]);const d=async()=>{a(!0);try{const m=s||localStorage.getItem("company_id")||localStorage.getItem("companyId")||"seed-company-1",p=await Qa.getBankAccounts(m),g=await Qa.getBankTransactions(void 0,m,void 0,1,100),v=p.reduce((M,G)=>M+Number(G.balance||0),0),y=g.items.length,j=g.items.filter(M=>M.status==="reconciled").length,b=g.items.filter(M=>M.status==="pending").length,w=g.items.filter(M=>!M.category||M.category==="Uncategorized").length,N=new Date,C=new Date(N.getTime()-parseInt(i)*24*60*60*1e3),S=g.items.filter(M=>new Date(M.transactionDate)>=C),_=S.filter(M=>Number(M.amount)>0).reduce((M,G)=>M+Number(G.amount),0),k=Math.abs(S.filter(M=>Number(M.amount)<0).reduce((M,G)=>M+Number(G.amount),0)),F=_-k,A=p.map(M=>{const G=g.items.filter(J=>J.bankAccountId===M.id),L=G.sort((J,z)=>new Date(z.transactionDate).getTime()-new Date(J.transactionDate).getTime())[0];return{account:M,balance:Number(M.balance||0),transactionCount:G.length,lastActivity:L?L.transactionDate:M.createdAt||""}}),T=S.reduce((M,G)=>{const L=G.category||"Uncategorized";return M[L]=(M[L]||0)+Math.abs(Number(G.amount)),M},{}),V=[];for(let M=6;M>=0;M--){const G=new Date(N.getTime()-M*24*60*60*1e3),L=new Date(G.setHours(0,0,0,0)),J=new Date(G.setHours(23,59,59,999)),z=S.filter(Q=>{const P=new Date(Q.transactionDate);return P>=L&&P<=J}),U=z.filter(Q=>Number(Q.amount)>0).reduce((Q,P)=>Q+Number(P.amount),0),oe=Math.abs(z.filter(Q=>Number(Q.amount)<0).reduce((Q,P)=>Q+Number(P.amount),0));V.push({date:L.toISOString().split("T")[0],inflow:U,outflow:oe,net:U-oe})}r({totalBalance:v,totalTransactions:y,reconciledTransactions:j,pendingTransactions:b,uncategorizedTransactions:w,monthlyInflow:_,monthlyOutflow:k,netCashFlow:F,accountBreakdown:A,recentTransactions:S.slice(0,10),categoryBreakdown:T,cashFlowTrend:V})}catch(m){console.error("Error loading dashboard data:",m)}finally{a(!1)}};if(n)return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-cyan-50 to-blue-50 rounded-xl p-6 border border-cyan-100",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gradient-to-r from-gray-200 to-gray-300 rounded-lg w-1/3 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((m,p)=>e.jsx(ne,{className:"border border-gray-200 shadow-sm hover:shadow-lg transition-all duration-300",children:e.jsx(ie,{className:"p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-gray-200 to-gray-300 rounded-lg"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"})]}),e.jsx("div",{className:"h-8 bg-gradient-to-r from-gray-200 to-gray-300 rounded w-1/2 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})})},p))})]});const u=m=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(m),h=m=>m>0?"text-green-600":m<0?"text-red-600":"text-gray-600",f=m=>m>0?e.jsx($s,{className:"w-4 h-4 text-green-600"}):m<0?e.jsx($o,{className:"w-4 h-4 text-red-600"}):e.jsx(or,{className:"w-4 h-4 text-gray-600"});return n?e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[...Array(4)].map((m,p)=>e.jsx(ne,{children:e.jsx(ie,{className:"p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]})})},p))})}):t?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Banking Dashboard"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(rt,{value:i,onValueChange:o,children:[e.jsx(nt,{className:"w-32",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"7",children:"Last 7 days"}),e.jsx(W,{value:"30",children:"Last 30 days"}),e.jsx(W,{value:"90",children:"Last 90 days"})]})]}),e.jsxs(rt,{value:l,onValueChange:c,children:[e.jsx(nt,{className:"w-48",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Accounts"}),t.accountBreakdown.map(m=>e.jsxs(W,{value:m.account.id,children:[m.account.bankName," - ",m.account.accountNumber]},m.account.id))]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(ne,{children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Mr,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Total Balance"})]}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:u(t.totalBalance)})]})}),e.jsx(ne,{children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[f(t.netCashFlow),e.jsx("span",{className:"text-sm font-medium",children:"Net Cash Flow"})]}),e.jsx("div",{className:`text-2xl font-bold ${h(t.netCashFlow)}`,children:u(t.netCashFlow)}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Last ",i," days"]})]})}),e.jsx(ne,{children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(lr,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Total Transactions"})]}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.totalTransactions}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[t.reconciledTransactions," reconciled"]})]})}),e.jsx(ne,{children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Is,{className:"w-5 h-5 text-orange-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Pending Items"})]}),e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:t.pendingTransactions+t.uncategorizedTransactions}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[t.pendingTransactions," pending, ",t.uncategorizedTransactions," uncategorized"]})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(vn,{className:"w-5 h-5 text-purple-600"}),"Account Overview"]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:t.accountBreakdown.map(m=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx($a,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:m.account.bankName}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[m.account.accountNumber,"  ",m.account.accountType]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-medium",children:u(m.balance)}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[m.transactionCount," transactions"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(Oe,{variant:"secondary",children:m.account.status}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Last activity: ",new Date(m.lastActivity).toLocaleDateString()]})]})]},m.account.id))})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx($s,{className:"w-5 h-5 text-green-600"}),"Cash Flow Breakdown"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Money In"}),e.jsx("span",{className:"text-green-600 font-bold",children:u(t.monthlyInflow)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Money Out"}),e.jsx("span",{className:"text-red-600 font-bold",children:u(t.monthlyOutflow)})]}),e.jsx("div",{className:"border-t pt-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium",children:"Net Cash Flow"}),e.jsx("span",{className:`font-bold ${h(t.netCashFlow)}`,children:u(t.netCashFlow)})]})})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Eo,{className:"w-5 h-5 text-blue-600"}),"Category Breakdown"]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-2",children:Object.entries(t.categoryBreakdown).sort(([,m],[,p])=>p-m).slice(0,5).map(([m,p])=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",children:m}),e.jsx("span",{className:"font-medium",children:u(p)})]},m))})})]})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Cr,{className:"w-5 h-5 text-gray-600"}),"Recent Transactions"]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-3",children:t.recentTransactions.map(m=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${Number(m.amount)>0?"bg-green-100":"bg-red-100"}`,children:Number(m.amount)>0?e.jsx($s,{className:"w-4 h-4 text-green-600"}):e.jsx($o,{className:"w-4 h-4 text-red-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:m.description||"Transaction"}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[m.merchantName&&`${m.merchantName}  `,new Date(m.transactionDate).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`font-medium ${Number(m.amount)>0?"text-green-600":"text-red-600"}`,children:[Number(m.amount)>0?"+":"",u(Number(m.amount))]}),e.jsxs("div",{className:"flex items-center gap-2",children:[m.category&&e.jsx(Oe,{variant:"outline",className:"text-xs",children:m.category}),e.jsx(Oe,{variant:m.status==="reconciled"?"default":"secondary",className:"text-xs",children:m.status})]})]})]},m.id))})})]})]}):e.jsx("div",{children:"Error loading dashboard data"})}function H2({companyId:s,transactions:t,onCategorizationComplete:r}){const[n,a]=x.useState(null),[i,o]=x.useState(!1),[l,c]=x.useState(!1),[d,u]=x.useState([]),[h,f]=x.useState([]),{toast:m}=za();x.useEffect(()=>{p(),g()},[]);const p=async()=>{try{const b=s||localStorage.getItem("company_id")||localStorage.getItem("companyId")||"seed-company-1",w=await de.get(`/categorization-stats?companyId=${b}`);a(w)}catch(b){console.error("Error loading categorization stats:",b)}},g=async()=>{try{const b=s||localStorage.getItem("company_id")||localStorage.getItem("companyId")||"seed-company-1",N=(await Qa.getBankTransactions(void 0,b)).items.filter(C=>!C.category||C.category==="Uncategorized");f(N)}catch(b){console.error("Error loading uncategorized transactions:",b)}},v=async()=>{if(d.length!==0){c(!0);try{const b=s||localStorage.getItem("company_id")||localStorage.getItem("companyId")||"seed-company-1",w=await de.post(`/bank-transactions/categorize?companyId=${b}`,{transactionIds:d});m({title:"Categorization Complete",description:`Successfully categorized ${w.categorized} transactions. ${w.failed} failed.`}),u([]),p(),g(),r&&r()}catch(b){console.error("Error categorizing transactions:",b),m({title:"Categorization Failed",description:b.message||"Failed to categorize transactions",variant:"destructive"})}finally{c(!1)}}},y=async()=>{const b=h.map(w=>w.id);u(b),await v()},j=async b=>{o(!0);try{const w=s||localStorage.getItem("company_id")||localStorage.getItem("companyId")||"seed-company-1",N=await de.post(`/bank-transactions/${b}/categorize?companyId=${w}`);m({title:"Transaction Categorized",description:`Categorized as: ${N.categorization.category}`}),p(),g()}catch(w){console.error("Error categorizing transaction:",w),m({title:"Categorization Failed",description:w.message||"Failed to categorize transaction",variant:"destructive"})}finally{o(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(sa,{className:"w-5 h-5 text-purple-600"}),"AI Transaction Categorization"]})}),e.jsxs(ie,{className:"space-y-4",children:[n&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.totalTransactions}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Transactions"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:n.categorizedTransactions}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Categorized"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:n.uncategorizedTransactions}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Uncategorized"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[Math.round(n.averageConfidence*100),"%"]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Avg Confidence"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Categorization Progress"}),e.jsxs("span",{children:[Math.round(n.categorizedTransactions/n.totalTransactions*100),"%"]})]}),e.jsx(No,{value:n.categorizedTransactions/n.totalTransactions*100,className:"h-2"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{onClick:y,disabled:l||h.length===0,className:"flex items-center gap-2",children:[e.jsx(Za,{className:"w-4 h-4"}),l?"Categorizing...":`Categorize All (${h.length})`]}),e.jsxs(I,{onClick:v,disabled:l||d.length===0,variant:"outline",children:["Categorize Selected (",d.length,")"]})]})]})]}),n&&e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx($s,{className:"w-5 h-5 text-blue-600"}),"Category Breakdown"]})}),e.jsx(ie,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:Object.entries(n.categoryBreakdown).map(([b,w])=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"font-medium",children:b}),e.jsx(Oe,{variant:"secondary",children:w})]},b))})})]}),h.length>0&&e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Ln,{className:"w-5 h-5 text-orange-600"}),"Uncategorized Transactions (",h.length,")"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-3",children:[h.slice(0,10).map(b=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:d.includes(b.id),onChange:w=>{w.target.checked?u(N=>[...N,b.id]):u(N=>N.filter(C=>C!==b.id))},className:"rounded"}),e.jsx("span",{className:"font-medium",children:b.description||"No description"}),b.merchantName&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:["- ",b.merchantName]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground mt-1",children:[new Date(b.transactionDate).toLocaleDateString(),"  $",Math.abs(Number(b.amount)).toFixed(2)]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>j(b.id),disabled:i,children:[e.jsx(sa,{className:"w-4 h-4 mr-1"}),"Categorize"]})})]},b.id)),h.length>10&&e.jsxs("div",{className:"text-center text-sm text-muted-foreground pt-2",children:["... and ",h.length-10," more transactions"]})]})})]})]})}const so={async get(s){return await de.get(s)},async post(s,t){return await de.post(s,t)},async put(s,t){return await de.put(s,t)},async delete(s){return await de.delete(s)},async getBankAccounts(s){const t=s?`?companyId=${encodeURIComponent(s)}`:"";return await de.get(`/bank-accounts${t}`)||[]},async createBankAccount(s){return(await de.post("/api/bank-accounts",s)).data},async getBankTransactions(s,t,r,n=1,a=50){const i=new URLSearchParams;s&&i.append("bankAccountId",s),t&&i.append("companyId",t),r&&i.append("status",r),i.append("page",n.toString()),i.append("pageSize",a.toString());const l=`/bank-transactions${i.toString()?`?${i.toString()}`:""}`;return await de.get(l)||{items:[],total:0,page:1,pageSize:50,totalPages:0}},async createBankTransaction(s){return(await de.post("/api/bank-transactions",s)).data},async reconcileTransaction(s,t){return(await de.post(`/bank-transactions/${s}/reconcile`,t)).data},async getPayments(s){const t=s?`?companyId=${encodeURIComponent(s)}`:"";return await de.get(`/payments${t}`)||[]},async createPayment(s){return(await de.post("/api/payments",s)).data},async getCurrencies(){return await de.get("/api/currencies")},async getExchangeRate(s,t){return await de.get(`/api/exchange-rates/${s}/${t}`)},async convertCurrency(s,t,r){return await de.post("/api/convert-currency",{fromCurrency:s,toCurrency:t,amount:r})},async getHistoricalRates(s,t=30){return await de.get(`/api/exchange-rates/${s}/history?days=${t}`)},async updateExchangeRates(){return await de.post("/api/exchange-rates/update")},formatCurrency(s,t="USD"){return new Intl.NumberFormat("en-US",{style:"currency",currency:t}).format(s)},async initializeProcessor(s,t){return await de.post("/api/payment-processors/initialize",{processor:s,config:t})},async createPaymentIntent(s){return await de.post("/api/payment-intents",s)},async confirmPaymentIntent(s,t){return await de.post(`/api/payment-intents/${s}/confirm`,t)},async createCustomer(s){return await de.post("/api/customers",s)},async addPaymentMethod(s,t){return await de.post(`/api/customers/${s}/payment-methods`,t)},async getProcessorStats(){return await de.get("/api/payment-processors/stats")},async getInstitutions(){return await de.get("/api/institutions")},async createConnection(s){return await de.post("/api/connections",s)},async getConnections(){return await de.get("/api/connections")},async getConnectionStatus(s){return await de.get(`/api/connections/${s}/status`)},async syncConnection(s){return await de.post(`/api/connections/${s}/sync`)},async disconnectConnection(s){return await de.post(`/api/connections/${s}/disconnect`)},async reconnectConnection(s){return await de.post(`/api/connections/${s}/reconnect`)},async getConnectionStats(){return await de.get("/api/connections/stats")},async getMobileStats(){return await de.get("/api/mobile-banking/stats")},async getMobileTransactions(s){const t=s?`?limit=${s}`:"";return await de.get(`/api/mobile-banking/transactions${t}`)},async getMobileAccounts(){return await de.get("/api/mobile-banking/accounts")},async getMobileInsights(){return await de.get("/api/mobile-banking/insights")},async getMobileNotifications(){return await de.get("/api/mobile-banking/notifications")},async getQuickActions(){return await de.get("/api/mobile-banking/quick-actions")},async executeQuickAction(s,t){return await de.post(`/api/mobile-banking/quick-actions/${s}/execute`,t)},async getMobileMoneyProviders(s){const t=s?`?country=${s}`:"";return await de.get(`/api/mobile-money/providers${t}`)},async getMobileMoneyProvider(s){return await de.get(`/api/mobile-money/providers/${s}`)},async createMobileMoneyAccount(s){return await de.post("/api/mobile-money/accounts",s)},async getMobileMoneyAccounts(){return await de.get("/api/mobile-money/accounts")},async initiateMobileMoneyPayment(s){return await de.post("/api/mobile-money/payments",s)},async getMobileMoneyTransactions(s,t){const r=new URLSearchParams;s&&r.append("provider",s),t&&r.append("limit",t.toString());const n=`/mobile-money/transactions${r.toString()?`?${r.toString()}`:""}`;return await de.get(n)},async getMobileMoneyBalance(s,t){return await de.get(`/api/mobile-money/balance?provider=${s}&phoneNumber=${t}`)},async getMobileMoneyStats(){return await de.get("/api/mobile-money/stats")},async forceRefreshRate(s,t){return await de.post(`/api/force-refresh-rate/${s}/${t}`)}};function $ce(){var G,L;const[s,t]=x.useState({}),[r,n]=x.useState("USD"),[a,i]=x.useState("EUR"),[o,l]=x.useState("100"),[c,d]=x.useState(null),[u,h]=x.useState(null),[f,m]=x.useState(!1),[p,g]=x.useState(null),[v,y]=x.useState(!1),[j,b]=x.useState(null),{toast:w}=za();x.useEffect(()=>{N()},[]),x.useEffect(()=>{Object.keys(s).length>0&&C()},[r,a]);const N=async()=>{try{const J=await so.getCurrencies();t(J.currencies||{})}catch{}},C=async()=>{if(r===a){h({fromCurrency:r,toCurrency:a,rate:1,timestamp:new Date().toISOString(),source:"internal"});return}try{const z=(await so.getExchangeRate(r,a)).rate;h(z),g(new Date)}catch{}},S=async()=>{if(r!==a){m(!0);try{const z=(await so.forceRefreshRate(r,a)).rate;h(z),g(new Date),w({title:"Rate Refreshed",description:`Fresh market rate: ${r}/${a} = ${z.rate}`})}catch{w({title:"Error",description:"Failed to refresh exchange rate from market data",variant:"destructive"})}finally{m(!1)}}},_=()=>{if(j)return;y(!0);const J=setInterval(()=>{C()},3e4);b(J)},k=()=>{j&&(clearInterval(j),b(null)),y(!1)};x.useEffect(()=>()=>{j&&clearInterval(j)},[j]);const F=async()=>{if(!o||r===a){d({amount:Number(o),fromCurrency:r,toCurrency:a,convertedAmount:Number(o),rate:1,timestamp:new Date().toISOString()});return}m(!0);try{if(!localStorage.getItem("auth_token"))try{const Q=await(await fetch(un("auth/demo-token"),{method:"POST",headers:cC(),body:JSON.stringify({sub:"demo-user-1",tenantId:"tenant_demo",roles:["admin","accountant"]})})).json();Q.token&&(localStorage.setItem("auth_token",Q.token),localStorage.setItem("tenant_id","tenant_demo"))}catch{}const U=(await so.convertCurrency(r,a,Number(o))).conversion;if(!U)throw new Error("Invalid response structure from currency conversion API");d(U)}catch{}finally{m(!1)}},A=()=>{const J=r;n(a),i(J)},T=(J,z)=>{const U=s[z];if(!U)return`${J.toFixed(2)} ${z}`;const oe=J.toFixed(U.decimals);switch(z){case"USD":case"CAD":case"AUD":case"NZD":case"SGD":case"HKD":return`${U.symbol}${oe}`;case"EUR":return`${oe} ${U.symbol}`;case"GBP":return`${U.symbol}${oe}`;case"JPY":return`${U.symbol}${oe}`;default:return`${oe} ${U.symbol}`}},V=J=>J.toFixed(6),M=()=>(!u||u.rate===1,null);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(yn,{className:"w-5 h-5 text-blue-600"}),"Currency Converter"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[v?e.jsxs(I,{onClick:k,size:"sm",variant:"destructive",children:[e.jsx(aM,{className:"w-3 h-3 mr-1"}),"Stop Live"]}):e.jsxs(I,{onClick:_,size:"sm",variant:"default",children:[e.jsx(po,{className:"w-3 h-3 mr-1"}),"Start Live"]}),p&&e.jsxs(Oe,{variant:v?"default":"secondary",className:"text-xs",children:[e.jsx(Cr,{className:"w-3 h-3 mr-1"}),v?"Live":"Updated"," ",p.toLocaleTimeString()]})]})]})}),e.jsxs(ie,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"amount",children:"Amount"}),e.jsx(ge,{id:"amount",type:"number",value:o,onChange:J=>l(J.target.value),placeholder:"Enter amount",className:"text-lg"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"From"}),e.jsxs(rt,{value:r,onValueChange:n,children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsx(at,{children:Object.entries(s).map(([J,z])=>e.jsx(W,{value:J,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:J}),e.jsx("span",{className:"text-muted-foreground",children:z.name})]})},J))})]})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(I,{variant:"outline",size:"icon",onClick:A,className:"rounded-full",children:e.jsx(Wu,{className:"w-4 h-4"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"To"}),e.jsxs(rt,{value:a,onValueChange:i,children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsx(at,{children:Object.entries(s).map(([J,z])=>e.jsx(W,{value:J,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:J}),e.jsx("span",{className:"text-muted-foreground",children:z.name})]})},J))})]})]})]}),e.jsx(I,{onClick:F,disabled:f||!o,className:"w-full",children:f?e.jsxs(e.Fragment,{children:[e.jsx(Ts,{className:"w-4 h-4 mr-2 animate-spin"}),"Converting..."]}):"Convert Currency"}),e.jsxs(I,{onClick:S,disabled:f||r===a,variant:"outline",className:"w-full",children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Force Refresh Market Rate"]}),c&&e.jsx(ne,{className:"bg-green-50 border-green-200",children:e.jsx(ie,{className:"pt-6",children:e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:T(c.convertedAmount||0,a)}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[T(c.amount||0,r)," = ",T(c.convertedAmount||0,a)]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Exchange rate: 1 ",r," = ",V(c.rate||0)," ",a]})]})})})]})]}),u&&e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(qu,{className:"w-5 h-5 text-purple-600"}),"Exchange Rate Information"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-medium",children:["1 ",r," = ",V(u.rate||0)," ",a]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:u.source==="external_api"?"Live rate":"Internal rate"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[M(),e.jsx(Oe,{variant:"secondary",children:u.source})]})]}),p&&e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Last updated: ",p.toLocaleString()]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"From Currency"}),e.jsxs("div",{className:"text-muted-foreground",children:[(G=s[r])==null?void 0:G.name," (",r,")"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"To Currency"}),e.jsxs("div",{className:"text-muted-foreground",children:[(L=s[a])==null?void 0:L.name," (",a,")"]})]})]})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Supported Currencies"})}),e.jsx(ie,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:Object.entries(s).map(([J,z])=>e.jsxs("div",{className:"flex items-center gap-2 p-2 border rounded-lg",children:[e.jsx("span",{className:"font-medium",children:J}),e.jsx("span",{className:"text-sm text-muted-foreground",children:z.symbol}),e.jsx("span",{className:"text-xs text-muted-foreground",children:z.name})]},J))})})]})]})}class Bce{constructor(){dn(this,"cache",new Map);dn(this,"CACHE_TTL",3e4);dn(this,"RETRY_ATTEMPTS",3);dn(this,"RETRY_DELAY",1e3)}async withRetry(t,r=this.RETRY_ATTEMPTS){try{return await t()}catch(n){if(r>1)return await new Promise(a=>setTimeout(a,this.RETRY_DELAY)),this.withRetry(t,r-1);throw n}}getCacheKey(t,r){return`${t}${r?`_${JSON.stringify(r)}`:""}`}isCacheValid(t){const r=this.cache.get(t);return r?Date.now()-r.timestamp<r.ttl:!1}setCache(t,r,n=this.CACHE_TTL){this.cache.set(t,{data:r,timestamp:Date.now(),ttl:n})}getCached(t){const r=this.cache.get(t);return r?r.data:null}async getExchangeRate(t,r,n){const a=this.getCacheKey("exchange-rate",{fromCurrency:t,toCurrency:r,date:n});if(this.isCacheValid(a))return this.getCached(a);const i=await this.withRetry(async()=>{const l=await Qa.getExchangeRate(t,r,n);return l.rate||l}),o={...i,change24h:this.calculateChange24h(i.rate),changePercent24h:this.calculateChangePercent24h(i.rate),high24h:this.calculateHigh24h(i.rate),low24h:this.calculateLow24h(i.rate),volume24h:this.calculateVolume24h(t,r)};return this.setCache(a,o),o}async getPopularPairs(){const t=this.getCacheKey("popular-pairs");if(this.isCacheValid(t))return this.getCached(t);const r=await this.withRetry(async()=>{const n=[{from:"USD",to:"EUR"},{from:"USD",to:"GBP"},{from:"USD",to:"JPY"},{from:"USD",to:"CAD"},{from:"USD",to:"AUD"},{from:"EUR",to:"GBP"},{from:"EUR",to:"JPY"},{from:"GBP",to:"JPY"}];return(await Promise.all(n.map(async i=>{try{const o=await this.getExchangeRate(i.from,i.to);return{pair:`${i.from}/${i.to}`,rate:o.rate,change24h:o.change24h||0,changePercent24h:o.changePercent24h||0,high24h:o.high24h||o.rate,low24h:o.low24h||o.rate,volume24h:o.volume24h||0,lastUpdated:o.timestamp}}catch(o){return console.error(`Error fetching rate for ${i.from}/${i.to}:`,o),null}}))).filter(Boolean)});return this.setCache(t,r,6e4),r}async getHistoricalRates(t,r,n,a){const i=this.getCacheKey("historical-rates",{fromCurrency:t,toCurrency:r,startDate:n,endDate:a});if(this.isCacheValid(i))return this.getCached(i);const o=await this.withRetry(async()=>{const l=await Qa.getHistoricalRates(t,r,n,a);return l.rates||l||[]});return this.setCache(i,o,3e5),o}async getCurrencyAnalytics(t,r){const n=this.getCacheKey("currency-analytics",{fromCurrency:t,toCurrency:r});if(this.isCacheValid(n))return this.getCached(n);const a=new Date().toISOString().split("T")[0],i=new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],o=await this.getHistoricalRates(t,r,i,a),l={volatility:this.calculateVolatility(o),trend:this.calculateTrend(o),support:this.calculateSupport(o),resistance:this.calculateResistance(o),rsi:this.calculateRSI(o),movingAverage7:this.calculateMovingAverage(o,7),movingAverage30:this.calculateMovingAverage(o,30)};return this.setCache(n,l,3e5),l}async getMarketStatus(){const t=new Date,r=t.getUTCHours(),n=r>=0&&r<22,a=n?"":this.getNextMarketOpen(t),i=n?this.getNextMarketClose(t):"";return{isOpen:n,nextOpen:a,nextClose:i,timezone:"UTC"}}async convertCurrency(t,r,n){const a=await this.withRetry(async()=>await Qa.convertCurrency(t,r,n)),i=a.conversion||a,o=i.convertedAmount*.001,l=i.convertedAmount+o;return{...i,fees:o,totalCost:l}}calculateChange24h(t){const r=(Math.random()-.5)*t*.02;return Number(r.toFixed(6))}calculateChangePercent24h(t){const r=this.calculateChange24h(t);return Number((r/t*100).toFixed(4))}calculateHigh24h(t){return Number((t*(1+Math.random()*.01)).toFixed(6))}calculateLow24h(t){return Number((t*(1-Math.random()*.01)).toFixed(6))}calculateVolume24h(t,r){const a=this.getVolumeMultiplier(t,r);return Math.floor(1e6*a)}getVolumeMultiplier(t,r){const n=["USD/EUR","USD/GBP","USD/JPY","EUR/GBP"],a=`${t}/${r}`;return n.includes(a)?1.5:.8}calculateVolatility(t){if(t.length<2)return 0;const r=t.slice(1).map((i,o)=>Math.log(i.close/t[o].close)),n=r.reduce((i,o)=>i+o,0)/r.length,a=r.reduce((i,o)=>i+Math.pow(o-n,2),0)/r.length;return Number((Math.sqrt(a)*100).toFixed(4))}calculateTrend(t){if(t.length<2)return"sideways";const r=t[0].close,a=(t[t.length-1].close-r)/r;return a>.02?"bullish":a<-.02?"bearish":"sideways"}calculateSupport(t){return t.length===0?0:Math.min(...t.map(r=>r.low))}calculateResistance(t){return t.length===0?0:Math.max(...t.map(r=>r.high))}calculateRSI(t){if(t.length<14)return 50;const r=[],n=[];for(let c=1;c<t.length;c++){const d=t[c].close-t[c-1].close;d>0?(r.push(d),n.push(0)):(r.push(0),n.push(Math.abs(d)))}const a=r.slice(-14).reduce((c,d)=>c+d,0)/14,i=n.slice(-14).reduce((c,d)=>c+d,0)/14;if(i===0)return 100;const l=100-100/(1+a/i);return Number(l.toFixed(2))}calculateMovingAverage(t,r){if(t.length<r)return 0;const a=t.slice(-r).reduce((i,o)=>i+o.close,0);return Number((a/r).toFixed(6))}getNextMarketOpen(t){const r=new Date(t);return r.setUTCDate(r.getUTCDate()+1),r.setUTCHours(0,0,0,0),r.toISOString()}getNextMarketClose(t){const r=new Date(t);return r.setUTCHours(22,0,0,0),r.toISOString()}clearCache(){this.cache.clear()}getCacheStats(){return{size:this.cache.size,keys:Array.from(this.cache.keys())}}}const q0=new Bce;function Uce({fromCurrency:s,toCurrency:t}){const[r,n]=x.useState(null),[a,i]=x.useState([]),[o,l]=x.useState(null),[c,d]=x.useState(!1),[u,h]=x.useState("7d"),{toast:f}=za(),m=async()=>{d(!0);try{const[j,b,w]=await Promise.all([q0.getCurrencyAnalytics(s,t),q0.getPopularPairs(),q0.getMarketStatus()]);n(j),i(b),l(w)}catch(j){console.error("Error loading analytics:",j),f({title:"Error",description:"Failed to load currency analytics",variant:"destructive"})}finally{d(!1)}};x.useEffect(()=>{s&&t&&m()},[s,t]);const p=j=>{switch(j){case"USD":return e.jsx(Mr,{className:"w-4 h-4"});case"EUR":return e.jsx(eM,{className:"w-4 h-4"});case"GBP":return e.jsx(nM,{className:"w-4 h-4"});default:return e.jsx(ZF,{className:"w-4 h-4"})}},g=j=>{switch(j){case"bullish":return e.jsx($s,{className:"w-4 h-4 text-green-600"});case"bearish":return e.jsx($o,{className:"w-4 h-4 text-red-600"});default:return e.jsx(or,{className:"w-4 h-4 text-gray-600"})}},v=(j,b=2)=>new Intl.NumberFormat("en-US",{minimumFractionDigits:b,maximumFractionDigits:b}).format(j),y=j=>`${j>=0?"+":""}${j.toFixed(2)}%`;return c?e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx(Ts,{className:"w-6 h-6 animate-spin"})})}):e.jsxs("div",{className:"space-y-6",children:[o&&e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(or,{className:"w-5 h-5"}),"Market Status"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{variant:o.isOpen?"default":"secondary",children:o.isOpen?"Open":"Closed"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:o.timezone})]}),!o.isOpen&&o.nextOpen&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Opens: ",new Date(o.nextOpen).toLocaleString()]})]})})]}),r&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Volatility"}),e.jsxs("p",{className:"text-2xl font-bold",children:[v(r.volatility),"%"]})]}),e.jsx(lr,{className:"w-8 h-8 text-blue-600"})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Trend"}),e.jsxs("div",{className:"flex items-center gap-2",children:[g(r.trend),e.jsx("span",{className:"text-lg font-semibold capitalize",children:r.trend})]})]}),e.jsx(wa,{className:"w-8 h-8 text-purple-600"})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Support"}),e.jsx("p",{className:"text-2xl font-bold",children:v(r.support,4)})]}),e.jsx(kn,{className:"w-8 h-8 text-green-600"})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Resistance"}),e.jsx("p",{className:"text-2xl font-bold",children:v(r.resistance,4)})]}),e.jsx(wa,{className:"w-8 h-8 text-orange-600"})]})})})]}),r&&e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(lr,{className:"w-5 h-5"}),"Technical Indicators"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:"RSI (14)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-2xl font-bold",children:v(r.rsi)}),e.jsx(Oe,{variant:r.rsi>70?"destructive":r.rsi<30?"default":"secondary",children:r.rsi>70?"Overbought":r.rsi<30?"Oversold":"Neutral"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:"MA (7)"}),e.jsx("div",{className:"text-2xl font-bold",children:v(r.movingAverage7,4)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:"MA (30)"}),e.jsx("div",{className:"text-2xl font-bold",children:v(r.movingAverage30,4)})]})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(or,{className:"w-5 h-5"}),"Popular Currency Pairs"]}),e.jsxs(rt,{value:u,onValueChange:h,children:[e.jsx(nt,{className:"w-32",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"1d",children:"1 Day"}),e.jsx(W,{value:"7d",children:"7 Days"}),e.jsx(W,{value:"30d",children:"30 Days"})]})]})]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:a.map((j,b)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[p(j.pair.split("/")[0]),e.jsx("span",{className:"font-semibold",children:j.pair.split("/")[0]}),e.jsx("span",{className:"text-muted-foreground",children:"/"}),p(j.pair.split("/")[1]),e.jsx("span",{className:"font-semibold",children:j.pair.split("/")[1]})]}),e.jsx("div",{className:"text-2xl font-bold",children:v(j.rate,4)})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-sm ${j.changePercent24h>=0?"text-green-600":"text-red-600"}`,children:y(j.changePercent24h)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:v(j.change24h,6)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"High"}),e.jsx("div",{className:"text-sm font-semibold",children:v(j.high24h,4)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Low"}),e.jsx("div",{className:"text-sm font-semibold",children:v(j.low24h,4)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Volume"}),e.jsx("div",{className:"text-sm font-semibold",children:v(j.volume24h)})]})]})]},b))})})]}),e.jsx("div",{className:"flex justify-center",children:e.jsxs(I,{onClick:m,disabled:c,variant:"outline",children:[e.jsx(Ts,{className:`w-4 h-4 mr-2 ${c?"animate-spin":""}`}),"Refresh Analytics"]})})]})}function zce({fromCurrency:s="USD",toCurrency:t="EUR"}){const[r,n]=x.useState([]),[a,i]=x.useState(!1),[o,l]=x.useState("line"),[c,d]=x.useState("30d"),[u,h]=x.useState(null),[f,m]=x.useState(null),p=x.useRef(null),{toast:g}=za(),v=async(A=!1)=>{i(!0),m(null);try{const T=new Date().toISOString().split("T")[0],V=y(c);console.log("Loading historical data:",{fromCurrency:s,toCurrency:t,startDate:V,endDate:T,forceRefresh:A});let M;A?M=await Qa.forceRefreshHistorical(s,t,V,T):M=await Qa.getHistoricalRates(s,t,V,T),console.log("Historical data response:",M),M.success&&M.rates&&M.rates.length>0?(n(M.rates),m(null),A&&g({title:"Chart Refreshed",description:"Historical data has been refreshed with new values"})):(m("No historical data available for this currency pair"),n([]))}catch(T){console.error("Error loading historical data:",T),m("Failed to load historical data"),n([]),g({title:"Error",description:"Failed to load historical data",variant:"destructive"})}finally{i(!1)}},y=A=>{const T=new Date,V={"1d":1,"7d":7,"30d":30,"90d":90,"1y":365};return new Date(T.getTime()-V[A]*24*60*60*1e3).toISOString().split("T")[0]};x.useEffect(()=>{s&&t&&v()},[s,t,c]),x.useEffect(()=>{v()},[]),x.useEffect(()=>{r.length>0&&setTimeout(()=>{j()},100)},[r,o]),x.useEffect(()=>{const A=()=>{r.length>0&&j()};return window.addEventListener("resize",A),()=>window.removeEventListener("resize",A)},[r]);const j=()=>{const A=p.current;if(!A||r.length===0){console.log("Chart draw skipped:",{canvas:!!A,ratesLength:r.length});return}const T=A.getContext("2d");if(!T){console.log("No canvas context available");return}const V=A.getBoundingClientRect();A.width=V.width*window.devicePixelRatio,A.height=V.height*window.devicePixelRatio,T.scale(window.devicePixelRatio,window.devicePixelRatio);const M=V.width,G=V.height,L=40;console.log("Drawing chart:",{width:M,height:G,dataPoints:r.length}),T.clearRect(0,0,M,G);const J=r,z=J.filter(q=>typeof q.low=="number"&&typeof q.high=="number"&&typeof q.open=="number"&&typeof q.close=="number"&&!isNaN(q.low)&&!isNaN(q.high)&&!isNaN(q.open)&&!isNaN(q.close));if(console.log("Valid data points:",z.length,"out of",J.length),z.length===0){T.fillStyle="#6b7280",T.font="16px Arial",T.textAlign="center",T.fillText("No valid data available",M/2,G/2);return}const U=Math.min(...z.map(q=>q.low)),Q=Math.max(...z.map(q=>q.high))-U;if(Q===0){T.fillStyle="#6b7280",T.font="16px Arial",T.textAlign="center",T.fillText("All values are the same",M/2,G/2);return}const P=(M-2*L)/(z.length-1);T.strokeStyle="#e5e7eb",T.lineWidth=1;for(let q=0;q<=5;q++){const D=L+(G-2*L)*(q/5);T.beginPath(),T.moveTo(L,D),T.lineTo(M-L,D),T.stroke()}switch(T.strokeStyle="#374151",T.lineWidth=2,T.beginPath(),T.moveTo(L,L),T.lineTo(L,G-L),T.lineTo(M-L,G-L),T.stroke(),o){case"line":b(T,z,M,G,L,U,Q,P);break;case"candlestick":w(T,z,M,G,L,U,Q,P);break;case"bar":N(T,z,M,G,L,U,Q,P);break}C(T,z,M,G,L,U,Q)},b=(A,T,V,M,G,L,J,z)=>{A.strokeStyle="#3b82f6",A.lineWidth=2,A.beginPath(),T.forEach((U,oe)=>{const Q=G+oe*z,P=M-G-(U.close-L)/J*(M-2*G);oe===0?A.moveTo(Q,P):A.lineTo(Q,P)}),A.stroke(),A.fillStyle="#3b82f6",T.forEach((U,oe)=>{const Q=G+oe*z,P=M-G-(U.close-L)/J*(M-2*G);A.beginPath(),A.arc(Q,P,3,0,2*Math.PI),A.fill()})},w=(A,T,V,M,G,L,J,z)=>{const U=z*.6;T.forEach((oe,Q)=>{const P=G+Q*z,q=oe.close>=oe.open;A.strokeStyle=q?"#10b981":"#ef4444",A.lineWidth=1,A.beginPath(),A.moveTo(P,M-G-(oe.high-L)/J*(M-2*G)),A.lineTo(P,M-G-(oe.low-L)/J*(M-2*G)),A.stroke();const D=M-G-(Math.max(oe.open,oe.close)-L)/J*(M-2*G),he=M-G-(Math.min(oe.open,oe.close)-L)/J*(M-2*G)-D;A.fillStyle=q?"#10b981":"#ef4444",A.fillRect(P-U/2,D,U,he),A.strokeStyle=q?"#059669":"#dc2626",A.lineWidth=1,A.strokeRect(P-U/2,D,U,he)})},N=(A,T,V,M,G,L,J,z)=>{const U=z*.6;T.forEach((oe,Q)=>{const P=G+Q*z,q=(oe.close-L)/J*(M-2*G),D=M-G-q;A.fillStyle="#3b82f6",A.fillRect(P-U/2,D,U,q)})},C=(A,T,V,M,G,L,J)=>{A.fillStyle="#6b7280",A.font="12px Inter, sans-serif",A.textAlign="center";for(let z=0;z<=5;z++){const U=L+J*z/5,oe=M-G-(M-2*G)*(z/5);A.fillText(U.toFixed(4),G-10,oe+4)}T.forEach((z,U)=>{if(U%Math.ceil(T.length/8)===0){const oe=G+U*((V-2*G)/(T.length-1)),Q=new Date(z.date);A.fillText(Q.toLocaleDateString(),oe,M-G+20)}})},S=A=>{const T=p.current;if(!T||r.length===0)return;const V=T.getBoundingClientRect(),M=A.clientX-V.left,G=40,J=(T.offsetWidth-2*G)/(r.length-1),z=Math.round((M-G)/J);z>=0&&z<r.length&&h(r[z])},_=()=>{const A=p.current;if(!A)return;const T=document.createElement("a");T.download=`currency-chart-${s}-${t}-${c}.png`,T.href=A.toDataURL(),T.click()},F=(()=>{if(r.length<2)return"neutral";const A=r[0].close,V=(r[r.length-1].close-A)/A;return V>.02?"bullish":V<-.02?"bearish":"neutral"})();return e.jsx("div",{className:"space-y-6",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(lr,{className:"w-5 h-5"}),"Currency Chart - ",s,"/",t]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(Oe,{variant:F==="bullish"?"default":F==="bearish"?"destructive":"secondary",children:[F==="bullish"&&e.jsx($s,{className:"w-3 h-3 mr-1"}),F==="bearish"&&e.jsx($o,{className:"w-3 h-3 mr-1"}),F.charAt(0).toUpperCase()+F.slice(1)]})})]})}),e.jsxs(ie,{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsxs(rt,{value:o,onValueChange:A=>l(A),children:[e.jsx(nt,{className:"w-32",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"line",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(eN,{className:"w-4 h-4"}),"Line"]})}),e.jsx(W,{value:"candlestick",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(lr,{className:"w-4 h-4"}),"Candlestick"]})}),e.jsx(W,{value:"bar",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(lr,{className:"w-4 h-4"}),"Bar"]})})]})]}),e.jsxs(rt,{value:c,onValueChange:A=>d(A),children:[e.jsx(nt,{className:"w-32",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"1d",children:"1 Day"}),e.jsx(W,{value:"7d",children:"7 Days"}),e.jsx(W,{value:"30d",children:"30 Days"}),e.jsx(W,{value:"90d",children:"90 Days"}),e.jsx(W,{value:"1y",children:"1 Year"})]})]}),e.jsxs(I,{onClick:()=>v(!0),disabled:a,variant:"outline",size:"sm",children:[e.jsx(Ts,{className:`w-4 h-4 mr-2 ${a?"animate-spin":""}`}),"Refresh"]}),e.jsxs(I,{onClick:_,variant:"outline",size:"sm",children:[e.jsx(An,{className:"w-4 h-4 mr-2"}),"Export"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("canvas",{ref:p,className:"w-full h-96 border rounded-lg cursor-crosshair",onClick:S}),a&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80",children:e.jsx(Ts,{className:"w-8 h-8 animate-spin"})}),f&&!a&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-gray-500 mb-2",children:f}),e.jsxs(I,{onClick:()=>v(!0),variant:"outline",size:"sm",children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Retry"]})]})}),!a&&!f&&r.length===0&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-gray-500 mb-2",children:"No data available"}),e.jsxs(I,{onClick:()=>v(!0),variant:"outline",size:"sm",children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Load Data"]})]})})]}),u&&e.jsxs("div",{className:"mt-4 p-4 bg-muted rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Selected Point"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Date:"}),e.jsx("div",{className:"font-semibold",children:new Date(u.date).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Open:"}),e.jsx("div",{className:"font-semibold",children:u.open.toFixed(4)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"High:"}),e.jsx("div",{className:"font-semibold",children:u.high.toFixed(4)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Low:"}),e.jsx("div",{className:"font-semibold",children:u.low.toFixed(4)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Close:"}),e.jsx("div",{className:"font-semibold",children:u.close.toFixed(4)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Volume:"}),e.jsx("div",{className:"font-semibold",children:u.volume.toLocaleString()})]})]})]})]})]})})}function qce(){var P,q;const[s,t]=x.useState({}),[r,n]=x.useState("USD"),[a,i]=x.useState("EUR"),[o,l]=x.useState("100"),[c,d]=x.useState(null),[u,h]=x.useState(null),[f,m]=x.useState(!1),[p,g]=x.useState(null),[v,y]=x.useState([]),[j,b]=x.useState([]),[w,N]=x.useState(!1),[C,S]=x.useState(null),[_,k]=x.useState({fromCurrency:"USD",toCurrency:"EUR",targetRate:.85,condition:"below"}),{toast:F}=za();x.useEffect(()=>{A(),T(),V()},[]);const A=async()=>{try{const D=await Qa.getCurrencies();t(D.currencies)}catch{F({title:"Error",description:"Failed to load currencies",variant:"destructive"})}},T=async()=>{try{const D=[{from:"USD",to:"EUR"},{from:"USD",to:"GBP"},{from:"USD",to:"JPY"},{from:"EUR",to:"GBP"},{from:"USD",to:"CAD"},{from:"USD",to:"AUD"},{from:"USD",to:"FRW"},{from:"EUR",to:"FRW"}],se=await Promise.all(D.map(async he=>{try{return(await Qa.getExchangeRate(he.from,he.to)).rate}catch{return null}}));y(se.filter(he=>he!==null))}catch{}},V=async()=>{try{const D=localStorage.getItem("company_id")||localStorage.getItem("companyId")||"seed-company-1",se=await fetch(un(`api/currency-alerts?companyId=${D}`),{headers:{...cC(),Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(se.ok){const he=await se.json();b(he.alerts||[])}else b([{id:"1",fromCurrency:"USD",toCurrency:"EUR",targetRate:.85,currentRate:.87,condition:"above",isActive:!0,createdAt:new Date().toISOString()},{id:"2",fromCurrency:"USD",toCurrency:"GBP",targetRate:.75,currentRate:.73,condition:"below",isActive:!0,createdAt:new Date().toISOString()}])}catch(D){console.error("Error loading currency alerts:",D),b([{id:"1",fromCurrency:"USD",toCurrency:"EUR",targetRate:.85,currentRate:.87,condition:"above",isActive:!0,createdAt:new Date().toISOString()},{id:"2",fromCurrency:"USD",toCurrency:"GBP",targetRate:.75,currentRate:.73,condition:"below",isActive:!0,createdAt:new Date().toISOString()}])}},M=async()=>{var D;if(!(!o||!r||!a)){m(!0);try{if(!localStorage.getItem("auth_token"))try{const Ae=await(await fetch(un("auth/demo-token"),{method:"POST",headers:cC(),body:JSON.stringify({sub:"demo-user-1",tenantId:"tenant_demo",roles:["admin","accountant"]})})).json();Ae.token&&(localStorage.setItem("auth_token",Ae.token),localStorage.setItem("tenant_id","tenant_demo"))}catch{}const he=await Qa.convertCurrency(Number(o),r,a),be=he.conversion;if(!be)throw Object.keys(he||{}).length===0?new Error("Empty response from currency conversion API - check authentication and API status"):new Error("Invalid response structure from currency conversion API");d(be),g(new Date),F({title:"Conversion Complete",description:`${o} ${r} = ${((D=be.convertedAmount)==null?void 0:D.toFixed(2))||"0.00"} ${a}`})}catch{F({title:"Conversion Failed",description:"Failed to convert currency",variant:"destructive"})}finally{m(!1)}}},G=async()=>{if(!(!r||!a)){m(!0);try{const se=(await Qa.getExchangeRate(r,a)).rate;h(se),g(new Date)}catch{F({title:"Error",description:"Failed to get exchange rate",variant:"destructive"})}finally{m(!1)}}},L=async()=>{m(!0);try{await T(),r&&a&&await G(),w||F({title:"Rates Updated",description:"Exchange rates have been refreshed"})}catch{F({title:"Error",description:"Failed to refresh rates",variant:"destructive"})}finally{m(!1)}},J=()=>{if(C)return;N(!0);const D=setInterval(()=>{L()},3e4);S(D),F({title:"Live Rates Started",description:"Exchange rates will refresh every 30 seconds"})},z=()=>{C&&(clearInterval(C),S(null)),N(!1),F({title:"Live Rates Stopped",description:"Exchange rates will no longer auto-refresh"})};x.useEffect(()=>()=>{C&&clearInterval(C)},[C]);const U=D=>{switch(D){case"USD":return e.jsx(Mr,{className:"w-4 h-4"});case"EUR":return e.jsx(eM,{className:"w-4 h-4"});case"GBP":return e.jsx(nM,{className:"w-4 h-4"});case"JPY":return e.jsx(ZF,{className:"w-4 h-4"});case"FRW":return e.jsx(qu,{className:"w-4 h-4"});default:return e.jsx(qu,{className:"w-4 h-4"})}},oe=(D,se)=>{const he=s[se];if(!he)return`${D.toFixed(2)} ${se}`;const be=D.toFixed(he.decimals);return`${he.symbol}${be}`},Q=D=>null;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Multi-Currency Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Real-time exchange rates and currency conversion"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[w?e.jsxs(I,{onClick:z,variant:"destructive",children:[e.jsx(aM,{className:"w-4 h-4 mr-2"}),"Stop Live"]}):e.jsxs(I,{onClick:J,variant:"default",children:[e.jsx(po,{className:"w-4 h-4 mr-2"}),"Start Live"]}),e.jsxs(I,{onClick:L,disabled:f,variant:"outline",children:[e.jsx(Ts,{className:`w-4 h-4 mr-2 ${f?"animate-spin":""}`}),"Refresh Rates"]}),p&&e.jsxs(Oe,{variant:w?"default":"secondary",className:"text-xs",children:[e.jsx(Cr,{className:"w-3 h-3 mr-1"}),w?"Live":"Updated"," ",p.toLocaleTimeString()]})]})]}),e.jsxs(an,{defaultValue:"converter",className:"space-y-6",children:[e.jsxs(on,{className:"grid w-full grid-cols-6",children:[e.jsx(vt,{value:"converter",children:"Converter"}),e.jsx(vt,{value:"rates",children:"Live Rates"}),e.jsx(vt,{value:"chart",children:"Chart"}),e.jsx(vt,{value:"analytics",children:"Analytics"}),e.jsx(vt,{value:"alerts",children:"Alerts"}),e.jsx(vt,{value:"settings",children:"Settings"})]}),e.jsx(yt,{value:"converter",className:"space-y-6",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(yn,{className:"w-5 h-5"}),"Currency Converter"]})}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"amount",children:"Amount"}),e.jsx(ge,{id:"amount",type:"number",value:o,onChange:D=>l(D.target.value),placeholder:"Enter amount"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"from-currency",children:"From"}),e.jsxs(rt,{value:r,onValueChange:n,children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsx(at,{children:Object.entries(s).map(([D,se])=>e.jsx(W,{value:D,children:e.jsxs("div",{className:"flex items-center gap-2",children:[U(D),D," - ",se.name]})},D))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"to-currency",children:"To"}),e.jsxs(rt,{value:a,onValueChange:i,children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsx(at,{children:Object.entries(s).map(([D,se])=>e.jsx(W,{value:D,children:e.jsxs("div",{className:"flex items-center gap-2",children:[U(D),D," - ",se.name]})},D))})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{onClick:M,disabled:f,className:"flex-1",children:[e.jsx(Wu,{className:"w-4 h-4 mr-2"}),"Convert"]}),e.jsx(I,{onClick:G,disabled:f,variant:"outline",children:"Get Rate"})]}),c&&e.jsx("div",{className:"p-4 bg-muted rounded-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:oe(c.convertedAmount||0,c.toCurrency)}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[oe(c.amount||0,c.fromCurrency)," at ",((P=c.rate)==null?void 0:P.toFixed(4))||"0.0000"," rate"]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Updated ",new Date(c.timestamp).toLocaleString()]})]})}),u&&e.jsx("div",{className:"p-4 bg-muted rounded-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-semibold",children:["1 ",u.fromCurrency," = ",((q=u.rate)==null?void 0:q.toFixed(4))||"0.0000"," ",u.toCurrency]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Source: ",u.source,"  ",new Date(u.timestamp).toLocaleString()]})]})})]})]})}),e.jsx(yt,{value:"rates",className:"space-y-6",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx($s,{className:"w-5 h-5"}),"Live Exchange Rates"]})}),e.jsx(ie,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:v.map((D,se)=>{var be;const he=Q();return e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[U(D.fromCurrency),e.jsx("span",{className:"font-semibold",children:D.fromCurrency}),e.jsx(Wu,{className:"w-3 h-3 text-muted-foreground"}),U(D.toCurrency),e.jsx("span",{className:"font-semibold",children:D.toCurrency})]}),he]}),e.jsx("div",{className:"text-2xl font-bold",children:((be=D.rate)==null?void 0:be.toFixed(4))||"0.0000"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(D.timestamp).toLocaleString()})]},se)})})})]})}),e.jsx(yt,{value:"alerts",className:"space-y-6",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Ln,{className:"w-5 h-5"}),"Currency Alerts"]})}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Create New Alert"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[e.jsxs(rt,{value:_.fromCurrency,onValueChange:D=>k({..._,fromCurrency:D}),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"From"})}),e.jsx(at,{children:Object.entries(s).map(([D,se])=>e.jsx(W,{value:D,children:D},D))})]}),e.jsxs(rt,{value:_.toCurrency,onValueChange:D=>k({..._,toCurrency:D}),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"To"})}),e.jsx(at,{children:Object.entries(s).map(([D,se])=>e.jsx(W,{value:D,children:D},D))})]}),e.jsx(ge,{type:"number",step:"0.0001",value:_.targetRate,onChange:D=>k({..._,targetRate:Number(D.target.value)}),placeholder:"Target Rate"}),e.jsxs(rt,{value:_.condition,onValueChange:D=>k({..._,condition:D}),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"above",children:"Above"}),e.jsx(W,{value:"below",children:"Below"})]})]})]}),e.jsx(I,{className:"mt-3",size:"sm",children:"Create Alert"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold",children:"Active Alerts"}),j.map(D=>{var se;return e.jsxs("div",{className:"p-3 border rounded-lg flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[U(D.fromCurrency),e.jsx("span",{className:"font-medium",children:D.fromCurrency}),e.jsx(Wu,{className:"w-3 h-3 text-muted-foreground"}),U(D.toCurrency),e.jsx("span",{className:"font-medium",children:D.toCurrency})]}),e.jsxs(Oe,{variant:D.condition==="above"?"default":"destructive",children:[D.condition==="above"?"Above":"Below"," ",D.targetRate]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Current: ",((se=D.currentRate)==null?void 0:se.toFixed(4))||"0.0000"]}),e.jsx(I,{size:"sm",variant:"outline",children:"Edit"}),e.jsx(I,{size:"sm",variant:"destructive",children:"Delete"})]})]},D.id)})]})]})]})}),e.jsx(yt,{value:"chart",className:"space-y-6",children:e.jsx(zce,{fromCurrency:r,toCurrency:a})}),e.jsx(yt,{value:"analytics",className:"space-y-6",children:e.jsx(Uce,{fromCurrency:r,toCurrency:a})}),e.jsx(yt,{value:"settings",className:"space-y-6",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(en,{className:"w-5 h-5"}),"Currency Settings"]})}),e.jsxs(ie,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold",children:"Display Preferences"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Default From Currency"}),e.jsxs(rt,{value:r,onValueChange:n,children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsx(at,{children:Object.entries(s).map(([D,se])=>e.jsx(W,{value:D,children:e.jsxs("div",{className:"flex items-center gap-2",children:[U(D),D," - ",se.name]})},D))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Default To Currency"}),e.jsxs(rt,{value:a,onValueChange:i,children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsx(at,{children:Object.entries(s).map(([D,se])=>e.jsx(W,{value:D,children:e.jsxs("div",{className:"flex items-center gap-2",children:[U(D),D," - ",se.name]})},D))})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold",children:"Live Rates Settings"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(B,{children:"Auto-refresh interval"}),e.jsxs(rt,{defaultValue:"30",children:[e.jsx(nt,{className:"w-32",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"10",children:"10 seconds"}),e.jsx(W,{value:"30",children:"30 seconds"}),e.jsx(W,{value:"60",children:"1 minute"}),e.jsx(W,{value:"300",children:"5 minutes"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(B,{children:"Enable notifications"}),e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold",children:"Cache Management"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{variant:"outline",onClick:()=>q0.clearCache(),children:"Clear Cache"}),e.jsx(I,{variant:"outline",onClick:()=>{const D=q0.getCacheStats();F({title:"Cache Stats",description:`Cache size: ${D.size} items`})},children:"View Cache Stats"})]})]})]})]})})]})]})}function xk({companyId:s}){const[t,r]=x.useState(null),[n,a]=x.useState([]),[i,o]=x.useState([]),[l,c]=x.useState([]),[d,u]=x.useState(!0),[h,f]=x.useState("overview"),[m,p]=x.useState(!1),[g,v]=x.useState("stripe"),[y,j]=x.useState({publishableKey:"",secretKey:"",clientId:"",clientSecret:"",applicationId:"",accessToken:"",environment:"sandbox"}),[b,w]=x.useState(!1),[N,C]=x.useState({amount:"",currency:"USD",description:"",customerId:""}),[S,_]=x.useState(!1),[k,F]=x.useState({name:"",email:"",phone:"",taxNumber:"",address:"",currency:"USD"}),[A,T]=x.useState(!1),[V,M]=x.useState({customerId:"",type:"card",cardNumber:"",expiryMonth:"",expiryYear:"",cvc:"",bankAccountNumber:"",routingNumber:"",accountType:"checking",isDefault:!1}),[G,L]=x.useState(!1),[J,z]=x.useState(!1),[U,oe]=x.useState(!1),[Q,P]=x.useState(!1),q=()=>{C({amount:"",currency:"USD",description:"",customerId:""})},D=()=>{F({name:"",email:"",phone:"",taxNumber:"",address:"",currency:"USD"})},se=()=>{M({customerId:"",type:"card",cardNumber:"",expiryMonth:"",expiryYear:"",cvc:"",bankAccountNumber:"",routingNumber:"",accountType:"checking",isDefault:!1})},he=()=>{j({publishableKey:"",secretKey:"",clientId:"",clientSecret:"",applicationId:"",accessToken:"",environment:"sandbox"})};x.useEffect(()=>{if(console.log("PaymentProcessorManager companyId:",s),console.log("localStorage company_id:",localStorage.getItem("company_id")),console.log("localStorage companyId:",localStorage.getItem("companyId")),console.log("localStorage company:",localStorage.getItem("company")),!s){console.warn("Company Not Selected - Please select a company to use the payment processor.");return}be()},[s]);const be=async()=>{u(!0);try{const re=await Qa.getProcessorStats();r(re);const le=await Qa.getPaymentIntents({limit:10});a(le.paymentIntents||[]);const Z=await Qa.getPaymentCustomers({limit:10,companyId:s});o(Z.customers||[]),console.log("Loading payment methods with companyId:",s);const K=await Qa.getPaymentMethods({limit:10,companyId:s});console.log("Payment methods response:",K),c(K.paymentMethods||[])}catch(re){console.error("Error loading payment processor data:",re),a([]),o([]),c([]),console.warn("Data Loading Issue - Some payment processor data could not be loaded. Please check your connection and try refreshing.")}finally{u(!1)}},pe=async()=>{p(!0);try{const re={...y,environment:y.environment};await Qa.post("/api/payment-processors/initialize",{processorType:g,config:re}),j({publishableKey:"",secretKey:"",clientId:"",clientSecret:"",applicationId:"",accessToken:"",environment:"sandbox"}),console.log(`${g.charAt(0).toUpperCase()+g.slice(1)} processor has been successfully configured and is ready to process payments.`),he(),P(!1),be()}catch(re){console.error("Error initializing processor:",re);const le=re.message||"Failed to initialize payment processor";console.error(`Initialization Failed - ${le}`)}finally{p(!1)}},Ae=async()=>{w(!0);try{await Qa.post("/api/payment-intents",{amount:Number(N.amount),currency:N.currency,description:N.description,customerId:N.customerId||void 0}),console.log(`Payment intent for $${N.amount} ${N.currency} has been created successfully.`),q(),L(!1),be()}catch(re){console.error("Error creating payment intent:",re);const le=re.message||"Failed to create payment intent";le.includes("No active payment processor configured")?console.error("Payment Processor Not Configured - Please initialize a payment processor (Stripe, PayPal, or Square) before creating payment intents."):console.error(`Payment Creation Failed - ${le}`)}finally{w(!1)}},Ee=async()=>{var re,le;T(!0);try{const Z={customerId:V.customerId,type:V.type,isDefault:V.isDefault,companyId:s};V.type==="card"?Z.card={number:V.cardNumber,expMonth:parseInt(V.expiryMonth),expYear:parseInt(V.expiryYear),cvc:V.cvc}:V.type==="bank_account"&&(Z.bankAccount={accountNumber:V.bankAccountNumber,routingNumber:V.routingNumber,accountType:V.accountType}),console.log("Adding payment method with data:",Z);const K=await Qa.addPaymentMethod(Z);console.log("Payment method creation result:",K),console.log("Payment method added successfully for customer"),se(),oe(!1),be()}catch(Z){console.error("Error adding payment method:",Z);let K="Failed to add payment method";(le=(re=Z.response)==null?void 0:re.data)!=null&&le.message?K=Z.response.data.message:Z.message&&(K=Z.message),console.error(`Payment Method Creation Failed - ${K}`)}finally{T(!1)}},$e=async()=>{var re,le;_(!0),console.log("Creating customer with data:",{companyId:s,name:k.name,email:k.email,phone:k.phone,taxNumber:k.taxNumber,address:k.address,currency:k.currency});try{console.log("=== CUSTOMER CREATION DEBUG ==="),console.log("bankingApi object:",Qa),console.log("bankingApi.createCustomer:",Qa.createCustomer),console.log("companyId being used:",s),console.log("customerForm data:",k);const Z={companyId:s,name:k.name,email:k.email,phone:k.phone,taxNumber:k.taxNumber,address:k.address,currency:k.currency};console.log("Request data being sent:",Z),console.log("Request data JSON:",JSON.stringify(Z,null,2));const K=await Qa.createCustomer(Z);console.log("Customer creation result:",K),console.log(`Customer ${k.name||k.email} has been created and is now available for both payments and invoicing.`),D(),z(!1),be()}catch(Z){console.error("Error creating customer:",Z);let K="Failed to create customer";(le=(re=Z.response)==null?void 0:re.data)!=null&&le.message?K=Z.response.data.message:Z.message&&(K=Z.message),console.log("Showing error toast:",K),console.error(`Customer Creation Failed - ${K}`)}finally{_(!1)}},O=re=>{switch(re){case"succeeded":return"text-green-600 bg-green-100";case"pending":return"text-yellow-600 bg-yellow-100";case"failed":return"text-red-600 bg-red-100";case"canceled":return"text-gray-600 bg-gray-100";default:return"text-gray-600 bg-gray-100"}},te=re=>{switch(re){case"stripe":return e.jsx($a,{className:"w-4 h-4 text-purple-600"});case"paypal":return e.jsx(Mr,{className:"w-4 h-4 text-blue-600"});case"square":return e.jsx(Za,{className:"w-4 h-4 text-green-600"});default:return e.jsx($a,{className:"w-4 h-4 text-gray-600"})}};return d?e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[...Array(4)].map((re,le)=>e.jsx(ne,{children:e.jsx(ie,{className:"p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]})})},le))})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Payment Processors"}),e.jsxs(ts,{open:Q,onOpenChange:P,children:[e.jsx(ki,{asChild:!0,children:e.jsxs(I,{children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Initialize Processor"]})}),e.jsxs(ss,{className:"max-w-2xl",children:[e.jsx(as,{children:e.jsx(is,{children:"Initialize Payment Processor"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Processor Type"}),e.jsxs(rt,{value:g,onValueChange:re=>v(re),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"stripe",children:"Stripe"}),e.jsx(W,{value:"paypal",children:"PayPal"}),e.jsx(W,{value:"square",children:"Square"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Environment"}),e.jsxs(rt,{value:y.environment,onValueChange:re=>j(le=>({...le,environment:re})),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"sandbox",children:"Sandbox"}),e.jsx(W,{value:"production",children:"Production"})]})]})]}),g==="stripe"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Publishable Key"}),e.jsx(ge,{value:y.publishableKey,onChange:re=>j(le=>({...le,publishableKey:re.target.value})),placeholder:"pk_test_..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Secret Key"}),e.jsx(ge,{type:"password",value:y.secretKey,onChange:re=>j(le=>({...le,secretKey:re.target.value})),placeholder:"sk_test_..."})]})]}),g==="paypal"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Client ID"}),e.jsx(ge,{value:y.clientId,onChange:re=>j(le=>({...le,clientId:re.target.value})),placeholder:"Client ID"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Client Secret"}),e.jsx(ge,{type:"password",value:y.clientSecret,onChange:re=>j(le=>({...le,clientSecret:re.target.value})),placeholder:"Client Secret"})]})]}),g==="square"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Application ID"}),e.jsx(ge,{value:y.applicationId,onChange:re=>j(le=>({...le,applicationId:re.target.value})),placeholder:"Application ID"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Access Token"}),e.jsx(ge,{type:"password",value:y.accessToken,onChange:re=>j(le=>({...le,accessToken:re.target.value})),placeholder:"Access Token"})]})]}),e.jsx(I,{onClick:pe,disabled:m,className:"w-full",children:m?"Initializing...":"Initialize Processor"})]})]})]})]}),t&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(ne,{children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Mr,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Total Payments"})]}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.totalPayments}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["$",t.totalAmount.toFixed(2)," total volume"]})]})}),e.jsx(ne,{children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Success Rate"})]}),e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[t.totalPayments>0?Math.round(t.successfulPayments/t.totalPayments*100):0,"%"]}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[t.successfulPayments," successful"]})]})}),e.jsx(ne,{children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($s,{className:"w-5 h-5 text-purple-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Average Amount"})]}),e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:["$",t.averageAmount.toFixed(2)]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Per transaction"})]})}),e.jsx(ne,{children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(lr,{className:"w-5 h-5 text-orange-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Processors"})]}),e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:Object.keys(t.processorBreakdown).length}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Active integrations"})]})})]}),e.jsxs(an,{value:h,onValueChange:f,children:[e.jsxs(on,{children:[e.jsx(vt,{value:"overview",children:"Overview"}),e.jsx(vt,{value:"payments",children:"Payments"}),e.jsx(vt,{value:"customers",children:"Customers"}),e.jsx(vt,{value:"methods",children:"Payment Methods"})]}),e.jsxs(yt,{value:"overview",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Recent Activity"})}),e.jsx(ie,{children:n.length>0?e.jsx("div",{className:"space-y-3",children:n.slice(0,5).map(re=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[te(re.processor),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:re.description||"Payment"}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(re.createdAt).toLocaleDateString()})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-medium",children:["$",re.amount.toFixed(2)]}),e.jsx(Oe,{className:O(re.status),children:re.status})]})]},re.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx($a,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No recent payments"}),e.jsx("p",{className:"text-sm",children:"Create your first payment to see activity here"})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Quick Actions"})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs(I,{className:"w-full justify-start",variant:"outline",onClick:()=>L(!0),children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Create Payment Intent"]}),e.jsxs(I,{className:"w-full justify-start",variant:"outline",onClick:()=>z(!0),children:[e.jsx(Sa,{className:"w-4 h-4 mr-2"}),"Add Customer"]}),e.jsxs(I,{className:"w-full justify-start",variant:"outline",onClick:()=>oe(!0),children:[e.jsx($a,{className:"w-4 h-4 mr-2"}),"Add Payment Method"]}),e.jsxs(I,{className:"w-full justify-start",variant:"outline",onClick:()=>P(!0),children:[e.jsx(en,{className:"w-4 h-4 mr-2"}),"Configure Processor"]})]})})]})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Processor Status"})}),e.jsx(ie,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx($a,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Stripe"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Credit Cards"})]})]}),e.jsx(Oe,{variant:"outline",children:"Available"})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Mr,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"PayPal"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Digital Wallet"})]})]}),e.jsx(Oe,{variant:"outline",children:"Available"})]}),e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Za,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Square"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Point of Sale"})]})]}),e.jsx(Oe,{variant:"outline",children:"Available"})]})]})})]})]}),e.jsxs(yt,{value:"payments",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Recent Payments"}),e.jsxs(I,{size:"sm",onClick:()=>L(!0),children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Create Payment"]})]}),e.jsx(ne,{children:e.jsx(ie,{className:"p-0",children:n.length>0?e.jsx("div",{className:"space-y-3",children:n.map(re=>e.jsxs("div",{className:"flex items-center justify-between p-4 border-b last:border-b-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[te(re.processor),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:["$",re.amount.toFixed(2)," ",re.currency]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:re.description||"Payment"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(Oe,{className:O(re.status),children:re.status}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:new Date(re.createdAt).toLocaleDateString()})]})]},re.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx($a,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No payments yet"}),e.jsx("p",{className:"text-sm",children:"Create your first payment to see it here"})]})})})]}),e.jsxs(yt,{value:"customers",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Customers"}),e.jsx("p",{className:"text-sm text-gray-500",children:"These are your real customers from the invoice system"})]}),e.jsxs(I,{size:"sm",onClick:()=>z(!0),children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Add Customer"]})]}),e.jsx(ne,{children:e.jsx(ie,{className:"p-0",children:i.length>0?e.jsx("div",{className:"space-y-3",children:i.map(re=>e.jsxs("div",{className:"flex items-center justify-between p-4 border-b last:border-b-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Sa,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:re.name||"Unnamed Customer"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:re.email}),re.phone&&e.jsx("div",{className:"text-xs text-gray-500",children:re.phone})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(Oe,{variant:"secondary",className:"capitalize",children:re.processor}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:new Date(re.createdAt).toLocaleDateString()}),e.jsx("div",{className:"text-xs text-blue-600 mt-1",children:"Real Customer"})]})]},re.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Sa,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No customers found"}),e.jsx("p",{className:"text-sm",children:"Add customers here or create them in the Sales/Invoices section"}),e.jsx("p",{className:"text-xs mt-2",children:"Customers created here will be available for invoicing and payments"}),e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("p",{className:"text-xs text-blue-700",children:[" ",e.jsx("strong",{children:"Tip:"})," You can create customers even without setting up a payment processor first. They'll be available for invoicing immediately."]}),s==="cmg0lf1m1001289wp87nq08d8"&&e.jsxs("p",{className:"text-xs text-red-700 mt-2",children:[" ",e.jsx("strong",{children:"Note:"}),' Your company ID points to "personal" company. Using correct company ID for "mmcmc" instead.']})]})]})})})]}),e.jsxs(yt,{value:"methods",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Payment Methods"}),e.jsxs(I,{size:"sm",onClick:()=>oe(!0),children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Add Payment Method"]})]}),e.jsx(ne,{children:e.jsx(ie,{className:"p-0",children:l.length>0?e.jsx("div",{className:"space-y-3",children:l.map(re=>e.jsxs("div",{className:"flex items-center justify-between p-4 border-b last:border-b-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($a,{className:"w-5 h-5 text-purple-600"}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium capitalize",children:[re.type," ",re.last4&&`****${re.last4}`]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[re.brand&&re.brand.toUpperCase(),re.expMonth&&re.expYear&&`  ${re.expMonth}/${re.expYear}`]})]})]}),e.jsxs("div",{className:"text-right",children:[re.isDefault&&e.jsx(Oe,{variant:"default",children:"Default"}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1 capitalize",children:re.processor})]})]},re.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx($a,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No payment methods"}),e.jsx("p",{className:"text-sm",children:"Add a payment method to get started"})]})})})]})]}),e.jsx(ts,{open:G,onOpenChange:L,children:e.jsxs(ss,{children:[e.jsx(as,{children:e.jsx(is,{children:"Create Payment Intent"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Amount"}),e.jsx(ge,{type:"number",value:N.amount,onChange:re=>C(le=>({...le,amount:re.target.value})),placeholder:"0.00"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Currency"}),e.jsxs(rt,{value:N.currency,onValueChange:re=>C(le=>({...le,currency:re})),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"USD",children:"USD"}),e.jsx(W,{value:"EUR",children:"EUR"}),e.jsx(W,{value:"GBP",children:"GBP"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Description"}),e.jsx(ge,{value:N.description,onChange:re=>C(le=>({...le,description:re.target.value})),placeholder:"Payment description"})]}),e.jsx(I,{onClick:Ae,disabled:b||!N.amount,className:"w-full",children:b?"Creating...":"Create Payment Intent"})]})]})}),e.jsx(ts,{open:J,onOpenChange:z,children:e.jsxs(ss,{children:[e.jsxs(as,{children:[e.jsx(is,{children:"Create Customer"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Customers created here will be available for both payments and invoicing."}),e.jsxs("div",{className:"text-xs text-blue-600 mt-1 flex items-center gap-2",children:[e.jsxs("span",{children:["Company: ",s]}),s==="cmg0lf1m1001289wp87nq08d8"&&e.jsx("span",{className:"text-red-600 font-medium",children:'(Points to "personal" company)'})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Name *"}),e.jsx(ge,{value:k.name,onChange:re=>F(le=>({...le,name:re.target.value})),placeholder:"Customer Name",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Email"}),e.jsx(ge,{type:"email",value:k.email,onChange:re=>F(le=>({...le,email:re.target.value})),placeholder:"customer@example.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Phone"}),e.jsx(ge,{value:k.phone,onChange:re=>F(le=>({...le,phone:re.target.value})),placeholder:"+1-555-0123"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Tax Number"}),e.jsx(ge,{value:k.taxNumber,onChange:re=>F(le=>({...le,taxNumber:re.target.value})),placeholder:"Tax ID or VAT Number"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Address"}),e.jsx(ge,{value:k.address,onChange:re=>F(le=>({...le,address:re.target.value})),placeholder:"Customer Address"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Currency"}),e.jsxs(rt,{value:k.currency,onValueChange:re=>F(le=>({...le,currency:re})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select currency"})}),e.jsxs(at,{children:[e.jsx(W,{value:"USD",children:"USD"}),e.jsx(W,{value:"EUR",children:"EUR"}),e.jsx(W,{value:"GBP",children:"GBP"}),e.jsx(W,{value:"KES",children:"KES"}),e.jsx(W,{value:"NGN",children:"NGN"})]})]})]}),e.jsx(I,{onClick:$e,disabled:S||!k.name,className:"w-full",children:S?"Creating...":"Create Customer"})]})]})}),e.jsx(ts,{open:U,onOpenChange:oe,children:e.jsxs(ss,{children:[e.jsxs(as,{children:[e.jsx(is,{children:"Add Payment Method"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Add a payment method for a customer to enable payments."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Customer *"}),e.jsxs(rt,{value:V.customerId,onValueChange:re=>M(le=>({...le,customerId:re})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select customer"})}),e.jsx(at,{children:i.map(re=>e.jsx(W,{value:re.id,children:re.name||re.email},re.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Payment Method Type *"}),e.jsxs(rt,{value:V.type,onValueChange:re=>M(le=>({...le,type:re})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select type"})}),e.jsxs(at,{children:[e.jsx(W,{value:"card",children:"Credit/Debit Card"}),e.jsx(W,{value:"bank_account",children:"Bank Account"})]})]})]}),V.type==="card"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Card Number *"}),e.jsx(ge,{placeholder:"1234 5678 9012 3456",value:V.cardNumber,onChange:re=>M(le=>({...le,cardNumber:re.target.value}))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Expiry Month *"}),e.jsx(ge,{placeholder:"12",value:V.expiryMonth,onChange:re=>M(le=>({...le,expiryMonth:re.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Expiry Year *"}),e.jsx(ge,{placeholder:"2025",value:V.expiryYear,onChange:re=>M(le=>({...le,expiryYear:re.target.value}))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"CVC *"}),e.jsx(ge,{placeholder:"123",value:V.cvc,onChange:re=>M(le=>({...le,cvc:re.target.value}))})]})]}),V.type==="bank_account"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Account Number *"}),e.jsx(ge,{placeholder:"1234567890",value:V.bankAccountNumber,onChange:re=>M(le=>({...le,bankAccountNumber:re.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Routing Number *"}),e.jsx(ge,{placeholder:"123456789",value:V.routingNumber,onChange:re=>M(le=>({...le,routingNumber:re.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Account Type *"}),e.jsxs(rt,{value:V.accountType,onValueChange:re=>M(le=>({...le,accountType:re})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select account type"})}),e.jsxs(at,{children:[e.jsx(W,{value:"checking",children:"Checking"}),e.jsx(W,{value:"savings",children:"Savings"})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"isDefault",checked:V.isDefault,onChange:re=>M(le=>({...le,isDefault:re.target.checked})),className:"rounded"}),e.jsx(B,{htmlFor:"isDefault",children:"Set as default payment method"})]}),e.jsx(I,{onClick:Ee,disabled:A||!V.customerId,className:"w-full",children:A?"Adding...":"Add Payment Method"})]})]})})]})}function G2(){var j;const[s,t]=x.useState([]),[r,n]=x.useState([]),[a,i]=x.useState([]),[o,l]=x.useState(!0),[c,d]=x.useState("retail"),[u,h]=x.useState("insights"),f=[{value:"retail",label:"Retail"},{value:"saas",label:"SaaS/Software"},{value:"consulting",label:"Consulting"},{value:"manufacturing",label:"Manufacturing"},{value:"healthcare",label:"Healthcare"},{value:"general",label:"General Business"}];x.useEffect(()=>{m()},[c]);const m=x.useCallback(async()=>{l(!0);try{const b=await so.get(`/api/analytics/insights?industry=${c}`);t(b.insights||[]);const w=await so.get(`/api/analytics/benchmarks/${c}`);n(w.benchmarks||[]);const N=await so.get("/api/analytics/cash-flow-forecast?months=6");i(N.forecast||[])}catch(b){console.error("Error loading analytics data:",b)}finally{l(!1)}},[c]),p=b=>{switch(b){case"trend":return e.jsx($s,{className:"w-5 h-5 text-blue-600"});case"anomaly":return e.jsx(Is,{className:"w-5 h-5 text-orange-600"});case"recommendation":return e.jsx(ic,{className:"w-5 h-5 text-green-600"});case"forecast":return e.jsx(wa,{className:"w-5 h-5 text-purple-600"});default:return e.jsx(lr,{className:"w-5 h-5 text-gray-600"})}},g=b=>{switch(b){case"high":return"text-red-600 bg-red-100";case"medium":return"text-yellow-600 bg-yellow-100";case"low":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}},v=b=>{switch(b){case"revenue":return"text-green-600";case"expenses":return"text-red-600";case"cash_flow":return"text-blue-600";case"profitability":return"text-purple-600";case"efficiency":return"text-orange-600";default:return"text-gray-600"}},y=b=>{switch(b){case"above":return e.jsx($s,{className:"w-4 h-4 text-green-600"});case"below":return e.jsx($o,{className:"w-4 h-4 text-red-600"});case"average":return e.jsx(lr,{className:"w-4 h-4 text-blue-600"});default:return e.jsx(lr,{className:"w-4 h-4 text-gray-600"})}};return o?e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[...Array(3)].map((b,w)=>e.jsx(ne,{children:e.jsx(ie,{className:"p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]})})},w))})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Advanced Analytics"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(rt,{value:c,onValueChange:d,children:[e.jsx(nt,{className:"w-48",children:e.jsx(it,{})}),e.jsx(at,{children:f.map(b=>e.jsx(W,{value:b.value,children:b.label},b.value))})]}),e.jsx(I,{onClick:m,variant:"outline",children:"Refresh Data"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(ne,{children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ic,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Insights"})]}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:s.length}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[s.filter(b=>b.actionable).length," actionable"]})]})}),e.jsx(ne,{children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(wa,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium",children:"High Impact"})]}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:s.filter(b=>b.impact==="high").length}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Critical insights"})]})}),e.jsx(ne,{children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(lr,{className:"w-5 h-5 text-purple-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Benchmarks"})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:r.length}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Industry metrics"})]})}),e.jsx(ne,{children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xn,{className:"w-5 h-5 text-orange-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Forecast"})]}),e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:a.length}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Months projected"})]})})]}),e.jsxs(an,{value:u,onValueChange:h,children:[e.jsxs(on,{children:[e.jsx(vt,{value:"insights",children:"Financial Insights"}),e.jsx(vt,{value:"benchmarks",children:"Industry Benchmarks"}),e.jsx(vt,{value:"forecast",children:"Cash Flow Forecast"})]}),e.jsx(yt,{value:"insights",className:"space-y-4",children:e.jsx("div",{className:"space-y-4",children:s.map(b=>e.jsx(ne,{className:"border-l-4 border-l-blue-500",children:e.jsx(ie,{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[p(b.type),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-semibold",children:b.title}),e.jsxs(Oe,{className:g(b.impact),children:[b.impact," impact"]}),e.jsx(Oe,{variant:"outline",className:v(b.category),children:b.category.replace("_"," ")})]}),e.jsx("p",{className:"text-muted-foreground mb-3",children:b.description}),b.actionable&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[e.jsx(Za,{className:"w-4 h-4"}),"Actionable insight"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-medium",children:[Math.round((b.confidence||0)*100),"% confidence"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:b.createdAt?new Date(b.createdAt).toLocaleDateString():"N/A"})]})]})})},b.id))})}),e.jsx(yt,{value:"benchmarks",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(lr,{className:"w-5 h-5 text-purple-600"}),"Industry Benchmarks - ",c.charAt(0).toUpperCase()+c.slice(1)]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:r.map((b,w)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[y(b.comparison),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:b.metric}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Industry benchmark: ",b.value,"%"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-medium",children:[b.percentile,"th percentile"]}),e.jsx(Oe,{variant:b.comparison==="above"?"default":b.comparison==="below"?"destructive":"secondary",children:b.comparison})]})]},w))})})]})}),e.jsx(yt,{value:"forecast",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(eN,{className:"w-5 h-5 text-orange-600"}),"6-Month Cash Flow Forecast"]})}),e.jsxs(ie,{children:[e.jsx("div",{className:"space-y-4",children:a&&a.length>0?a.map((b,w)=>b?e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Xn,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:b.period||"N/A"}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Confidence: ",Math.round((b.confidence||0)*100),"%"]})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Inflow"}),e.jsxs("div",{className:"font-medium text-green-600",children:["$",(b.projectedInflow||0).toFixed(2)]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Outflow"}),e.jsxs("div",{className:"font-medium text-red-600",children:["$",(b.projectedOutflow||0).toFixed(2)]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Net"}),e.jsxs("div",{className:`font-medium ${(b.netCashFlow||0)>0?"text-green-600":"text-red-600"}`,children:["$",(b.netCashFlow||0).toFixed(2)]})]})]})]},w):null):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No forecast data available"})}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Forecast Factors"}),e.jsx("ul",{className:"text-sm text-muted-foreground space-y-1",children:a&&((j=a[0])!=null&&j.factors)?a[0].factors.map((b,w)=>e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-1 bg-blue-600 rounded-full"}),b]},w)):e.jsx("li",{className:"text-muted-foreground",children:"No factors available"})})]})]})]})})]})]})}function K2({companyId:s}){const[t,r]=x.useState([]),[n,a]=x.useState([]),[i,o]=x.useState(null),[l,c]=x.useState(!0),[d,u]=x.useState(""),[h,f]=x.useState("plaid"),[m,p]=x.useState(""),[g,v]=x.useState(!1),[y,j]=x.useState(!1),[b,w]=x.useState({accountName:"",accountType:"checking",accountNumber:"",routingNumber:"",username:"",password:""});x.useEffect(()=>{S()},[]);const N=()=>{w({accountName:"",accountType:"checking",accountNumber:"",routingNumber:"",username:"",password:""}),p(""),u("")},C=G=>{j(G),G||N()},S=async()=>{c(!0);try{const G=await so.get("/api/institutions");r(G.institutions||[]);const L=s?`/api/connections?companyId=${s}`:"/api/connections",J=await so.get(L);a(J.connections||[]);const z=s?`/api/connections/stats?companyId=${s}`:"/api/connections/stats",U=await so.get(z);o(U)}catch(G){console.error("Error loading bank connection data:",G)}finally{c(!1)}},_=async()=>{if(!m){ze.error("Please select a bank",{description:"You need to choose a financial institution before creating a connection."});return}v(!0);try{const G=await so.post("/api/connections",{provider:h,institutionId:m,companyId:s||"cmg0qxjh9003nao3ftbaz1oc1",credentials:{accountName:b.accountName,accountType:b.accountType,accountNumber:b.accountNumber,routingNumber:b.routingNumber,username:b.username,password:b.password}});ze.success("Bank connection created successfully!",{description:"Your bank account connection has been established and is being synced."}),N(),j(!1),S()}catch(G){console.error("Error creating connection:",G),ze.error("Failed to create bank connection",{description:"There was an error establishing the connection. Please try again."})}finally{v(!1)}},k=async G=>{try{await so.post(`/api/connections/${G}/sync`),ze.success("Connection synced successfully!",{description:"Your bank account data has been updated with the latest information."}),S()}catch(L){console.error("Error syncing connection:",L),ze.error("Failed to sync connection",{description:"There was an error syncing your bank account. Please try again."})}},F=async G=>{if(confirm("Are you sure you want to disconnect this bank connection?"))try{await so.post(`/api/connections/${G}/disconnect`),ze.success("Connection disconnected successfully!",{description:"Your bank account connection has been removed."}),S()}catch(L){console.error("Error disconnecting connection:",L),ze.error("Failed to disconnect connection",{description:"There was an error disconnecting your bank account. Please try again."})}},A=async G=>{try{await so.post(`/api/connections/${G}/reconnect`),ze.success("Connection reconnected successfully!",{description:"Your bank account connection has been restored."}),S()}catch(L){console.error("Error reconnecting connection:",L),ze.error("Failed to reconnect connection",{description:"There was an error reconnecting your bank account. Please try again."})}},T=G=>{switch(G){case"active":return"text-green-600 bg-green-100";case"pending":return"text-yellow-600 bg-yellow-100";case"error":return"text-red-600 bg-red-100";case"inactive":return"text-gray-600 bg-gray-100";default:return"text-gray-600 bg-gray-100"}},V=G=>{switch(G){case"active":return e.jsx(bs,{className:"w-4 h-4 text-green-600"});case"pending":return e.jsx(Cr,{className:"w-4 h-4 text-yellow-600"});case"error":return e.jsx(Ln,{className:"w-4 h-4 text-red-600"});case"inactive":return e.jsx(y6,{className:"w-4 h-4 text-gray-600"});default:return e.jsx(Cr,{className:"w-4 h-4 text-gray-600"})}},M=t.filter(G=>G.name.toLowerCase().includes(d.toLowerCase()));return l?e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[...Array(4)].map((G,L)=>e.jsx(ne,{children:e.jsx(ie,{className:"p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]})})},L))})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Bank Connections"}),e.jsxs(I,{onClick:()=>j(!0),children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Connect Bank"]})]}),e.jsx(ts,{open:y,onOpenChange:C,children:e.jsxs(ss,{className:"max-w-2xl",children:[e.jsx(as,{children:e.jsx(is,{children:"Connect Your Bank Account"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Connection Provider"}),e.jsxs(rt,{value:h,onValueChange:G=>f(G),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"plaid",children:"Plaid (Recommended)"}),e.jsx(W,{value:"yodlee",children:"Yodlee"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Select Your Bank"}),e.jsxs("div",{className:"relative",children:[e.jsx(Rn,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(ge,{placeholder:"Search for your bank...",value:d,onChange:G=>u(G.target.value),className:"pl-10"})]}),e.jsx("div",{className:"max-h-60 overflow-y-auto border rounded-lg",children:M.length>0?M.map(G=>e.jsx("div",{className:`p-3 cursor-pointer hover:bg-gray-50 border-b last:border-b-0 ${m===G.id?"bg-blue-50 border-blue-200":""}`,onClick:()=>p(G.id),children:e.jsxs("div",{className:"flex items-center gap-3",children:[G.logo&&e.jsx("img",{src:G.logo,alt:G.name,className:"w-8 h-8"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:G.name}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[G.country,"  ",G.products.join(", ")]})]})]})},G.id)):e.jsxs("div",{className:"p-6 text-center",children:[e.jsx(vn,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Banks Available"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Bank integration requires actual Plaid or Yodlee API keys to be configured."}),e.jsx("p",{className:"text-sm text-gray-400",children:"Contact your administrator to set up bank connections."})]})})]}),m&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Account Name"}),e.jsx(ge,{value:b.accountName,onChange:G=>w(L=>({...L,accountName:G.target.value})),placeholder:"Business Checking"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Account Type"}),e.jsxs(rt,{value:b.accountType,onValueChange:G=>w(L=>({...L,accountType:G})),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"checking",children:"Checking"}),e.jsx(W,{value:"savings",children:"Savings"}),e.jsx(W,{value:"business_checking",children:"Business Checking"}),e.jsx(W,{value:"business_savings",children:"Business Savings"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Account Number"}),e.jsx(ge,{value:b.accountNumber,onChange:G=>w(L=>({...L,accountNumber:G.target.value})),placeholder:"1234567890"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Routing Number"}),e.jsx(ge,{value:b.routingNumber,onChange:G=>w(L=>({...L,routingNumber:G.target.value})),placeholder:"021000021"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Username"}),e.jsx(ge,{value:b.username,onChange:G=>w(L=>({...L,username:G.target.value})),placeholder:"Your bank username"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Password"}),e.jsx(ge,{type:"password",value:b.password,onChange:G=>w(L=>({...L,password:G.target.value})),placeholder:"Your bank password"})]})]})]}),e.jsx(I,{onClick:_,disabled:g||!m,className:"w-full",children:g?"Connecting...":"Connect Bank Account"})]})]})}),i&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(ne,{children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(vn,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Total Connections"})]}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.totalConnections}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[i.activeConnections," active"]})]})}),e.jsx(ne,{children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Active Connections"})]}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.activeConnections}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[i.errorConnections," errors"]})]})}),e.jsx(ne,{children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(lr,{className:"w-5 h-5 text-purple-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Total Accounts"})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:i.totalAccounts}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Connected accounts"})]})}),e.jsx(ne,{children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($s,{className:"w-5 h-5 text-orange-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Transactions"})]}),e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:i.totalTransactions}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Synced transactions"})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(s1,{className:"w-5 h-5 text-blue-600"}),"Bank Connections"]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:n.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(vn,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Bank Connections"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Connect your bank accounts to start syncing transactions automatically."}),e.jsxs(I,{onClick:()=>j(!0),children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Connect Your First Bank"]})]}):n.map(G=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(vn,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:G.bankName}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[G.accountName,"  ",G.accountType,"  ****",G.accountNumber.slice(-4)]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[V(G.status),e.jsx(Oe,{className:T(G.status),children:G.status})]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:G.lastSyncAt?`Last sync: ${new Date(G.lastSyncAt).toLocaleDateString()}`:"Never synced"})]}),e.jsxs("div",{className:"flex gap-2",children:[G.status==="active"&&e.jsx(I,{size:"sm",variant:"outline",onClick:()=>k(G.id),children:e.jsx(Ts,{className:"w-4 h-4"})}),G.status==="error"&&e.jsx(I,{size:"sm",variant:"outline",onClick:()=>A(G.id),children:e.jsx(s1,{className:"w-4 h-4"})}),e.jsx(I,{size:"sm",variant:"outline",onClick:()=>F(G.id),children:e.jsx(y6,{className:"w-4 h-4"})})]})]})]},G.id))})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(vn,{className:"w-5 h-5 text-green-600"}),"Supported Banks"]})}),e.jsx(ie,{children:t.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:t.slice(0,8).map(G=>e.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg hover:bg-gray-50",children:[G.logo&&e.jsx("img",{src:G.logo,alt:G.name,className:"w-8 h-8"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:G.name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:G.country})]})]},G.id))}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"And 10,000+ more banks worldwide through Plaid and Yodlee"})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(vn,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Bank Integration Not Configured"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"To connect bank accounts, your administrator needs to configure Plaid or Yodlee API keys."}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 text-left",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Required Setup:"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:" Obtain Plaid or Yodlee API credentials"}),e.jsx("li",{children:" Configure environment variables (PLAID_CLIENT_ID, PLAID_SECRET, etc.)"}),e.jsx("li",{children:" Set up webhook endpoints for real-time updates"}),e.jsx("li",{children:" Test connections in sandbox environment"})]})]})]})})]})]})}function Y2({companyId:s}){var G;const[t,r]=x.useState([]),[n,a]=x.useState([]),[i,o]=x.useState([]),[l,c]=x.useState(null),[d,u]=x.useState(!0),[h,f]=x.useState("all"),[m,p]=x.useState(!1),[g,v]=x.useState(!1),[y,j]=x.useState(!0),[b,w]=x.useState({provider:"",accountNumber:"",accountName:"",phoneNumber:"",currency:""}),[N,C]=x.useState({provider:"",amount:"",currency:"",phoneNumber:"",recipientPhoneNumber:"",recipientName:"",description:""}),S=["Kenya","Tanzania","Rwanda","Ghana","Nigeria","Uganda","Senegal","Cte d'Ivoire","Togo","Benin","Cameroon","Zimbabwe","Zambia","Global"];x.useEffect(()=>{_()},[h]);const _=x.useCallback(async()=>{u(!0);try{const L=await so.get(`/api/mobile-money/providers${h&&h!=="all"?`?country=${h}`:""}`);r(L.providers||[]);const J=s?`/api/mobile-money/accounts?companyId=${s}`:"/api/mobile-money/accounts",z=await so.get(J);a(z.accounts||[]);const U=s?`/api/mobile-money/transactions?companyId=${s}`:"/api/mobile-money/transactions",oe=await so.get(U);o(oe.transactions||[]);const Q=s?`/api/mobile-money/stats?companyId=${s}`:"/api/mobile-money/stats",P=await so.get(Q);c(P)}catch(L){console.error("Error loading mobile money data:",L)}finally{u(!1)}},[h,s]),k=async()=>{if(!b.provider||!b.accountNumber||!b.accountName||!b.phoneNumber){alert("Please fill in all required fields");return}try{const L=s?`/api/mobile-money/accounts?companyId=${s}`:"/api/mobile-money/accounts",J=await so.post(L,b);alert("Mobile money account created successfully!"),w({provider:"",accountNumber:"",accountName:"",phoneNumber:"",currency:""}),p(!1),_()}catch(L){console.error("Error creating account:",L),alert("Failed to create mobile money account")}},F=async()=>{if(!N.provider||!N.amount||!N.phoneNumber||!N.recipientPhoneNumber){alert("Please fill in all required fields");return}try{const L=t.find(oe=>oe.id===N.provider);if(!L){alert("Please select a valid provider");return}if(!L.currency){alert("Selected provider does not have a valid currency");return}const J={...N,currency:L.currency};console.log("Sending payment data:",J);const z=s?`/api/mobile-money/payments?companyId=${s}`:"/api/mobile-money/payments",U=await so.post(z,J);U.success?(alert("Payment initiated successfully!"),C({provider:"",amount:"",currency:"",phoneNumber:"",recipientPhoneNumber:"",recipientName:"",description:""}),v(!1),_()):alert(U.message||"Failed to initiate payment")}catch(L){console.error("Error sending money:",L),alert("Failed to send money")}},A=(L,J)=>{if(L==null||isNaN(L))return"$0.00";if(!J||J.trim()===""||J==="undefined"||J==="null")return`$${L.toFixed(2)}`;try{return new Intl.NumberFormat("en-US",{style:"currency",currency:J}).format(L)}catch{return console.warn("Invalid currency code:",J,"Defaulting to USD format"),`$${L.toFixed(2)}`}},T=L=>{switch(L){case"active":return"text-green-600 bg-green-100";case"completed":return"text-green-600 bg-green-100";case"pending":return"text-yellow-600 bg-yellow-100";case"failed":return"text-red-600 bg-red-100";case"cancelled":return"text-gray-600 bg-gray-100";default:return"text-gray-600 bg-gray-100"}},V=L=>{switch(L){case"active":return e.jsx(bs,{className:"w-4 h-4 text-green-600"});case"completed":return e.jsx(bs,{className:"w-4 h-4 text-green-600"});case"pending":return e.jsx(Cr,{className:"w-4 h-4 text-yellow-600"});case"failed":return e.jsx(Ln,{className:"w-4 h-4 text-red-600"});case"cancelled":return e.jsx(Ln,{className:"w-4 h-4 text-gray-600"});default:return e.jsx(Cr,{className:"w-4 h-4 text-gray-600"})}},M=L=>{switch(L){case"deposit":return e.jsx($s,{className:"w-5 h-5 text-green-600"});case"withdrawal":return e.jsx($o,{className:"w-5 h-5 text-red-600"});case"transfer":return e.jsx(Wu,{className:"w-5 h-5 text-blue-600"});case"payment":return e.jsx(wd,{className:"w-5 h-5 text-purple-600"});case"reversal":return e.jsx(Ts,{className:"w-5 h-5 text-orange-600"});default:return e.jsx($a,{className:"w-5 h-5 text-gray-600"})}};return d?e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[...Array(4)].map((L,J)=>e.jsx(ne,{children:e.jsx(ie,{className:"p-6",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]})})},J))})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Sd,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Mobile Money"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage mobile money accounts and payments"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{variant:"outline",onClick:()=>j(!y),children:y?e.jsx(ir,{className:"w-4 h-4"}):e.jsx(bp,{className:"w-4 h-4"})}),e.jsxs(I,{variant:"outline",onClick:_,children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Refresh"]}),e.jsxs(ts,{open:g,onOpenChange:v,children:[e.jsx(ki,{asChild:!0,children:e.jsxs(I,{children:[e.jsx(wd,{className:"w-4 h-4 mr-2"}),"Send Money"]})}),e.jsxs(ss,{className:"max-w-2xl",children:[e.jsx(as,{children:e.jsx(is,{children:"Send Mobile Money"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Provider"}),e.jsxs(rt,{value:N.provider,onValueChange:L=>{const J=t.find(z=>z.id===L);C(z=>({...z,provider:L,currency:(J==null?void 0:J.currency)||""}))},children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select provider"})}),e.jsx(at,{children:t.map(L=>e.jsxs(W,{value:L.id||`provider-${Math.random()}`,children:[L.name," (",L.country,")"]},L.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Amount"}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{type:"number",value:N.amount,onChange:L=>C(J=>({...J,amount:L.target.value})),placeholder:"0.00",className:"pr-16"}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-sm text-muted-foreground",children:N.provider&&((G=t.find(L=>L.id===N.provider))==null?void 0:G.currency)||"USD"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Your Phone Number"}),e.jsx(ge,{value:N.phoneNumber,onChange:L=>C(J=>({...J,phoneNumber:L.target.value})),placeholder:"+254700000000"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Recipient Phone Number"}),e.jsx(ge,{value:N.recipientPhoneNumber,onChange:L=>C(J=>({...J,recipientPhoneNumber:L.target.value})),placeholder:"+254700000000"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Recipient Name (Optional)"}),e.jsx(ge,{value:N.recipientName,onChange:L=>C(J=>({...J,recipientName:L.target.value})),placeholder:"John Doe"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Description"}),e.jsx(ge,{value:N.description,onChange:L=>C(J=>({...J,description:L.target.value})),placeholder:"Payment description"})]}),e.jsxs(I,{onClick:F,className:"w-full",children:[e.jsx(wd,{className:"w-4 h-4 mr-2"}),"Send Money"]})]})]})]}),e.jsxs(ts,{open:m,onOpenChange:p,children:[e.jsx(ki,{asChild:!0,children:e.jsxs(I,{variant:"outline",children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Add Account"]})}),e.jsxs(ss,{className:"max-w-2xl",children:[e.jsx(as,{children:e.jsx(is,{children:"Add Mobile Money Account"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Provider"}),e.jsxs(rt,{value:b.provider,onValueChange:L=>{const J=t.find(z=>z.id===L);w(z=>({...z,provider:L,currency:(J==null?void 0:J.currency)||""}))},children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select provider"})}),e.jsx(at,{children:t.map(L=>e.jsxs(W,{value:L.id||`provider-${Math.random()}`,children:[L.name," (",L.country,")"]},L.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Account Number"}),e.jsx(ge,{value:b.accountNumber,onChange:L=>w(J=>({...J,accountNumber:L.target.value})),placeholder:"Account number"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Account Name"}),e.jsx(ge,{value:b.accountName,onChange:L=>w(J=>({...J,accountName:L.target.value})),placeholder:"Account name"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Phone Number"}),e.jsx(ge,{value:b.phoneNumber,onChange:L=>w(J=>({...J,phoneNumber:L.target.value})),placeholder:"+254700000000"})]}),e.jsxs(I,{onClick:k,className:"w-full",children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Add Account"]})]})]})]})]})]}),l&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(ne,{children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Sd,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Total Accounts"})]}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:l.totalAccounts}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[l.activeAccounts," active"]})]})}),e.jsx(ne,{children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Wu,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Transactions"})]}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:l.totalTransactions}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"All time"})]})}),e.jsx(ne,{children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Mr,{className:"w-5 h-5 text-purple-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Total Volume"})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:A((l==null?void 0:l.totalVolume)||0,"USD")}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Processed"})]})}),e.jsx(ne,{children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($o,{className:"w-5 h-5 text-orange-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Total Fees"})]}),e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:A((l==null?void 0:l.totalFees)||0,"USD")}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Paid"})]})})]}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(B,{htmlFor:"country-filter",children:"Filter by Country:"}),e.jsxs(rt,{value:h,onValueChange:f,children:[e.jsx(nt,{id:"country-filter",className:"w-48",children:e.jsx(it,{placeholder:"All countries"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Countries"}),S.filter(L=>L&&L.trim()).map(L=>e.jsx(W,{value:L,children:L},L))]})]})]})})}),e.jsxs(an,{defaultValue:"accounts",className:"space-y-4",children:[e.jsxs(on,{children:[e.jsx(vt,{value:"accounts",children:"Accounts"}),e.jsx(vt,{value:"transactions",children:"Transactions"}),e.jsx(vt,{value:"providers",children:"Providers"})]}),e.jsx(yt,{value:"accounts",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Sd,{className:"w-5 h-5 text-green-600"}),"Mobile Money Accounts"]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:n.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Sd,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Mobile Money Accounts"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Add your first mobile money account to get started."}),e.jsxs(I,{onClick:()=>p(!0),children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Add Account"]})]}):n.map(L=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(Sd,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:L.accountName}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[L.provider,"  ",L.phoneNumber]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-semibold",children:y?A((L==null?void 0:L.balance)||0,(L==null?void 0:L.currency)||"USD"):""}),e.jsxs("div",{className:"flex items-center gap-2",children:[V(L.status),e.jsx(Oe,{className:T(L.status),children:L.status})]})]})]},L.id))})})]})}),e.jsx(yt,{value:"transactions",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Wu,{className:"w-5 h-5 text-blue-600"}),"Recent Transactions"]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-3",children:i.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Wu,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Transactions"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Transactions will appear here once you start using your accounts."})]}):i.map(L=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[M(L.transactionType),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:L.description}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[L.provider,"  ",new Date(L.createdAt).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`font-semibold ${L.transactionType==="deposit"?"text-green-600":"text-red-600"}`,children:[L.transactionType==="deposit"?"+":"",A((L==null?void 0:L.amount)||0,(L==null?void 0:L.currency)||"USD")]}),e.jsxs("div",{className:"flex items-center gap-2",children:[V(L.status),e.jsx(Oe,{className:T(L.status),children:L.status})]})]})]},L.id))})})]})}),e.jsx(yt,{value:"providers",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(qu,{className:"w-5 h-5 text-purple-600"}),"Supported Providers"]})}),e.jsx(ie,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(L=>{var J;return e.jsxs("div",{className:"p-4 border rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[L.logo&&e.jsx("img",{src:L.logo,alt:L.name,className:"w-8 h-8"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:L.name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:L.country})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Currency:"}),e.jsx("span",{className:"font-medium",children:L.currency})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Daily Limit:"}),e.jsx("span",{className:"font-medium",children:A(((J=L==null?void 0:L.limits)==null?void 0:J.daily)||0,(L==null?void 0:L.currency)||"USD")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Transfer Fee:"}),e.jsxs("span",{className:"font-medium",children:[L.fees.transfer,"%"]})]})]}),e.jsx("div",{className:"mt-3",children:e.jsx(Oe,{variant:L.isActive?"default":"secondary",children:L.isActive?"Active":"Inactive"})})]},L.id)})})})]})})]})]})}function Vce({companyId:s,accountsRefreshKey:t,setAccountsRefreshKey:r,isAddTransactionOpen:n,setIsAddTransactionOpen:a,transactionForm:i,setTransactionForm:o,transactionFormErrors:l,setTransactionFormErrors:c,handleTransactionFormChange:d,handleCreateTransaction:u}){console.log("ResponsiveBankingLayout received companyId:",s);const{isAuthenticated:h,isLoading:f}=Ua(),[m,p]=x.useState("desktop"),[g,v]=x.useState(!1),[y,j]=x.useState("dashboard"),[b,w]=x.useState(85),[N,C]=x.useState(4),[S,_]=x.useState(null);x.useEffect(()=>{console.log(" Auth state changed:",{isAuthenticated:h,authLoading:f,companyId:s,timestamp:new Date().toISOString()})},[h,f,s]),x.useEffect(()=>{const U=()=>{if(S){p(S);return}const oe=window.innerWidth;oe<768?p("mobile"):oe<1024?p("tablet"):p("desktop")};return U(),window.addEventListener("resize",U),()=>{window.removeEventListener("resize",U)}},[S]);const k=()=>{const U=Math.floor(N);return e.jsx("div",{className:"flex items-center gap-1",children:[...Array(4)].map((oe,Q)=>e.jsx("div",{className:`w-1 h-${Q<U?"3":"1"} bg-green-500 rounded-sm`},Q))})},F=()=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-6 h-3 border border-gray-400 rounded-sm relative",children:e.jsx("div",{className:"bg-green-500 h-full rounded-sm",style:{width:`${b}%`}})}),e.jsx("div",{className:"w-1 h-2 bg-gray-400 rounded-r-sm"})]}),A=[{id:"dashboard",label:"Dashboard",icon:""},{id:"transactions",label:"Transactions",icon:""},{id:"ai",label:"AI",icon:""},{id:"currency",label:"Currency",icon:""},{id:"payments",label:"Payments",icon:""},{id:"analytics",label:"Analytics",icon:""},{id:"connections",label:"Banks",icon:""},{id:"mobile-money",label:"Mobile Money",icon:""}],T=()=>e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("div",{className:"bg-black text-white text-xs px-4 py-1 flex justify-between items-center",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-medium",children:"9:41"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[k(),e.jsx(OY,{className:"w-3 h-3"}),F()]})]}),e.jsxs("div",{className:"bg-white border-b border-gray-200 px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>v(!g),children:g?e.jsx(ma,{className:"w-5 h-5"}):e.jsx(sM,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-lg font-semibold",children:"Banking"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>_(S==="desktop"?null:"desktop"),title:"Switch to Desktop View",children:e.jsx(jf,{className:"w-4 h-4"})}),e.jsx(I,{variant:"ghost",size:"sm",children:e.jsx(Rn,{className:"w-4 h-4"})}),e.jsx(I,{variant:"ghost",size:"sm",children:e.jsx(Hu,{className:"w-4 h-4"})}),e.jsx(I,{variant:"ghost",size:"sm",children:e.jsx(bo,{className:"w-4 h-4"})})]})]}),g&&e.jsx("div",{className:"bg-white border-b border-gray-200 p-4",children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:A.map(U=>e.jsxs(I,{variant:y===U.id?"default":"outline",className:"flex items-center gap-2 justify-start",onClick:()=>{j(U.id),v(!1)},children:[e.jsx("span",{className:"text-lg",children:U.icon}),e.jsx("span",{className:"text-sm",children:U.label})]},U.id))})}),e.jsxs("div",{className:"pb-20",children:[y==="dashboard"&&e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Bank Accounts"}),e.jsx(I,{onClick:()=>r&&r(U=>U+1),variant:"outline",size:"sm",children:"Refresh"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsx(V,{})})]}),y==="transactions"&&e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Recent Transactions"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{onClick:()=>a&&a(!0),size:"sm",children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Add Transaction"]}),e.jsx(I,{onClick:()=>r&&r(U=>U+1),variant:"outline",size:"sm",children:"Refresh"})]})]}),e.jsx(M,{})]}),y==="ai"&&e.jsx("div",{className:"p-4",children:e.jsx(H2,{companyId:s})}),y==="currency"&&e.jsx("div",{className:"p-4",children:e.jsx($ce,{})}),y==="payments"&&e.jsx("div",{className:"p-4",children:e.jsx(xk,{companyId:s})}),y==="analytics"&&e.jsx("div",{className:"p-4",children:e.jsx(G2,{})}),y==="connections"&&e.jsx("div",{className:"p-4",children:e.jsx(K2,{companyId:s})}),y==="mobile-money"&&e.jsx("div",{className:"p-4",children:e.jsx(Y2,{companyId:s})})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200",children:e.jsx("div",{className:"flex items-center justify-around py-2",children:A.slice(0,5).map(U=>e.jsxs(I,{variant:"ghost",size:"sm",className:`flex flex-col items-center gap-1 ${y===U.id?"text-blue-600":"text-gray-600"}`,onClick:()=>j(U.id),children:[e.jsx("span",{className:"text-lg",children:U.icon}),e.jsx("span",{className:"text-xs",children:U.label})]},U.id))})})]}),V=x.useMemo(()=>()=>{const[oe,Q]=x.useState(null),[P,q]=x.useState(!0),[D,se]=x.useState(null),he=async()=>{if(console.log(" fetchAccounts called",{isAuthenticated:h,authLoading:f,companyId:s,timestamp:new Date().toISOString()}),!h||f||!s){console.log(" fetchAccounts blocked:",{hasCompanyId:!!s,isAuthenticated:h,authLoading:f});return}let be=!0;q(!0);try{console.log(" Fetching accounts...");const pe=await Qa.getBankAccounts(s);console.log(" Accounts fetched:",pe.length),Q(pe),se(null)}catch(pe){const Ae=pe.message||String(pe);console.error(" Error fetching accounts:",Ae),se(Ae)}finally{q(!1)}};return x.useEffect(()=>{he()},[t,s,h,f]),P?e.jsxs(e.Fragment,{children:[e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:"Loading accounts..."})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:""})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:""})})]}):D?e.jsx(ne,{children:e.jsxs(ie,{className:"p-4",children:["Error: ",(D==null?void 0:D.message)||(D==null?void 0:D.toString())||"Unknown error"]})}):!oe||oe.length===0?e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:"No connected accounts"})}):e.jsx(e.Fragment,{children:oe.map(be=>e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(vn,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:be.bankName}),e.jsx("p",{className:"text-xl font-bold",children:typeof be.balance=="number"?`$${be.balance.toFixed(2)}`:be.balance??""}),e.jsx("p",{className:"text-xs text-muted-foreground",children:be.accountNumber})]})]})})},be.id))})},[s,h,f,t]),M=x.useMemo(()=>()=>{const[oe,Q]=x.useState(null),[P,q]=x.useState(!0),[D,se]=x.useState(null),he=1,be=10,pe=async()=>{if(console.log(" fetchTransactions called",{isAuthenticated:h,authLoading:f,companyId:s,timestamp:new Date().toISOString()}),!s||!h||f){console.log(" fetchTransactions blocked:",{hasCompanyId:!!s,isAuthenticated:h,authLoading:f});return}let Ae=!0;q(!0);try{console.log(" Fetching transactions...");const Ee=await Qa.getBankTransactions(void 0,s,void 0,he,be);Ee&&Ee.items?(console.log(" Transactions fetched:",Ee.items.length),Q(Ee.items)):(console.log(" No transactions found"),Q([])),se(null)}catch(Ee){const $e=Ee.message||String(Ee);console.error(" Error fetching transactions:",$e),se($e)}finally{q(!1)}};return x.useEffect(()=>{pe()},[s,h,f]),P?e.jsx("div",{className:"space-y-4",children:"Loading transactions..."}):D?e.jsxs("div",{className:"space-y-4",children:["Error loading transactions: ",(D==null?void 0:D.message)||(D==null?void 0:D.toString())||"Unknown error"]}):!oe||oe.length===0?e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{children:"No transactions found"}),e.jsx("div",{className:"flex gap-2 mt-2",children:e.jsx(I,{onClick:()=>pe(),children:"Retry"})})]}):e.jsx("div",{className:"space-y-4",children:oe.map(Ae=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${Ae.transactionType==="credit"?"bg-green-100":"bg-red-100"}`,children:Ae.transactionType==="credit"?e.jsx("span",{className:"text-green-600 font-semibold",children:""}):e.jsx("span",{className:"text-red-600 font-semibold",children:""})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:Ae.description||"Bank transaction"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(Ae.transactionDate).toLocaleDateString()})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`font-medium ${Number(Ae.amount)>=0?"text-green-600":"text-red-600"}`,children:["$",Number(Ae.amount).toFixed(2)]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:Ae.status||"unreconciled"})]})})]},Ae.id))})},[s,h,f]),G=()=>e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Hw,{className:"w-6 h-6 text-blue-600"}),e.jsx("h1",{className:"text-xl font-semibold",children:"Banking Dashboard"}),e.jsx(Oe,{variant:"secondary",children:"Tablet View"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(I,{variant:m==="mobile"?"default":"outline",size:"sm",onClick:()=>_(S==="mobile"?null:"mobile"),children:e.jsx(Sd,{className:"w-3 h-3"})}),e.jsx(I,{variant:m==="tablet"?"default":"outline",size:"sm",onClick:()=>_(S==="tablet"?null:"tablet"),children:e.jsx(Hw,{className:"w-3 h-3"})}),e.jsx(I,{variant:m==="desktop"?"default":"outline",size:"sm",onClick:()=>_(S==="desktop"?null:"desktop"),children:e.jsx(jf,{className:"w-3 h-3"})})]}),e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(en,{className:"w-4 h-4 mr-2"}),"Settings"]}),e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(bo,{className:"w-4 h-4 mr-2"}),"Profile"]})]})]})}),e.jsx("div",{className:"p-6",children:e.jsxs(an,{value:y,onValueChange:j,children:[e.jsxs(on,{className:"grid w-full grid-cols-5 mb-6",children:[e.jsx(vt,{value:"dashboard",children:"Dashboard"}),e.jsx(vt,{value:"ai",children:"AI Features"}),e.jsx(vt,{value:"analytics",children:"Analytics"}),e.jsx(vt,{value:"connections",children:"Connections"}),e.jsx(vt,{value:"mobile-money",children:"Mobile Money"})]}),e.jsx(yt,{value:"dashboard",className:"space-y-6",children:e.jsx(fk,{companyId:s})}),e.jsx(yt,{value:"ai",className:"space-y-6",children:e.jsx(H2,{companyId:s})}),e.jsx(yt,{value:"analytics",className:"space-y-6",children:e.jsx(G2,{})}),e.jsx(yt,{value:"connections",className:"space-y-6",children:e.jsx(K2,{companyId:s})}),e.jsx(yt,{value:"mobile-money",className:"space-y-6",children:e.jsx(Y2,{companyId:s})})]})})]}),L=()=>e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 px-8 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(jf,{className:"w-6 h-6 text-blue-600"}),e.jsx("h1",{className:"text-2xl font-semibold",children:"Banking Management"}),e.jsx(Oe,{variant:"secondary",children:"Desktop View"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(I,{variant:m==="mobile"?"default":"outline",size:"sm",onClick:()=>_(S==="mobile"?null:"mobile"),children:[e.jsx(Sd,{className:"w-4 h-4 mr-1"}),"Mobile"]}),e.jsxs(I,{variant:m==="tablet"?"default":"outline",size:"sm",onClick:()=>_(S==="tablet"?null:"tablet"),children:[e.jsx(Hw,{className:"w-4 h-4 mr-1"}),"Tablet"]}),e.jsxs(I,{variant:m==="desktop"?"default":"outline",size:"sm",onClick:()=>_(S==="desktop"?null:"desktop"),children:[e.jsx(jf,{className:"w-4 h-4 mr-1"}),"Desktop"]})]}),e.jsxs(I,{variant:"outline",children:[e.jsx(en,{className:"w-4 h-4 mr-2"}),"Settings"]}),e.jsxs(I,{variant:"outline",children:[e.jsx(bo,{className:"w-4 h-4 mr-2"}),"Profile"]})]})]})}),e.jsx("div",{className:"p-8",children:e.jsxs(an,{value:y,onValueChange:j,children:[e.jsxs(on,{className:"flex w-full mb-8 overflow-x-auto gap-1",children:[e.jsx(vt,{value:"dashboard",className:"whitespace-nowrap",children:"Dashboard"}),e.jsx(vt,{value:"transactions",className:"whitespace-nowrap",children:"Transactions"}),e.jsx(vt,{value:"ai",className:"whitespace-nowrap",children:"AI Categorization"}),e.jsx(vt,{value:"currency",className:"whitespace-nowrap",children:"Multi-Currency"}),e.jsx(vt,{value:"payments",className:"whitespace-nowrap",children:"Payment Processors"}),e.jsx(vt,{value:"analytics",className:"whitespace-nowrap",children:"Advanced Analytics"}),e.jsx(vt,{value:"connections",className:"whitespace-nowrap",children:"Bank Connections"}),e.jsx(vt,{value:"mobile-money",className:"whitespace-nowrap",children:"Mobile Money"})]}),e.jsx(yt,{value:"dashboard",className:"space-y-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Bank Accounts"}),e.jsx(I,{onClick:()=>r&&r(U=>U+1),variant:"outline",children:"Refresh"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:e.jsx(V,{})}),e.jsx(fk,{companyId:s})]})}),e.jsxs(yt,{value:"transactions",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Recent Transactions"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{onClick:()=>a&&a(!0),children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Add Transaction"]}),e.jsx(I,{onClick:()=>r&&r(U=>U+1),variant:"outline",children:"Refresh"})]})]}),e.jsx(M,{})]}),e.jsx(yt,{value:"ai",className:"space-y-6",children:e.jsx(H2,{companyId:s})}),e.jsx(yt,{value:"currency",className:"space-y-6",children:e.jsx(qce,{})}),e.jsx(yt,{value:"payments",className:"space-y-6",children:e.jsx(xk,{companyId:s})}),e.jsx(yt,{value:"analytics",className:"space-y-6",children:e.jsx(G2,{})}),e.jsx(yt,{value:"connections",className:"space-y-6",children:e.jsx(K2,{companyId:s})}),e.jsx(yt,{value:"mobile-money",className:"space-y-6",children:e.jsx(Y2,{companyId:s})})]})})]}),J=()=>{const[U,oe]=x.useState([]),[Q,P]=x.useState(!0),q=async()=>{if(!(!h||f||!s))try{const D=await Qa.getBankAccounts(s);oe(D)}catch(D){console.error("Error fetching bank accounts:",D)}finally{P(!1)}};return x.useEffect(()=>{q()},[s,h,f]),Q?e.jsx(W,{value:"loading",disabled:!0,children:"Loading accounts..."}):U.length===0?e.jsx(W,{value:"no-accounts",disabled:!0,children:"No bank accounts found"}):e.jsx(e.Fragment,{children:U.map(D=>e.jsxs(W,{value:D.id,children:[D.bankName," - ",D.accountNumber," (",D.accountType,")"]},D.id))})},z=()=>e.jsx(ts,{open:n||!1,onOpenChange:a,children:e.jsxs(ss,{className:"max-w-md",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Add Bank Transaction"}),e.jsx(Ks,{children:"Create a new bank transaction manually."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"bankAccount",children:"Bank Account"}),e.jsxs(rt,{value:(i==null?void 0:i.bankAccountId)||"",onValueChange:U=>d==null?void 0:d("bankAccountId",U),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select bank account..."})}),e.jsx(at,{children:e.jsx(J,{})})]}),(l==null?void 0:l.bankAccountId)&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:l.bankAccountId})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"description",children:"Description"}),e.jsx(ge,{id:"description",value:(i==null?void 0:i.description)||"",onChange:U=>d==null?void 0:d("description",U.target.value),placeholder:"Transaction description"}),(l==null?void 0:l.description)&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:l.description})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"amount",children:"Amount"}),e.jsx(ge,{id:"amount",type:"number",step:"0.01",value:(i==null?void 0:i.amount)||"",onChange:U=>d==null?void 0:d("amount",U.target.value),placeholder:"0.00"}),(l==null?void 0:l.amount)&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:l.amount})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"transactionType",children:"Type"}),e.jsxs(rt,{value:(i==null?void 0:i.transactionType)||"debit",onValueChange:U=>d==null?void 0:d("transactionType",U),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"credit",children:"Credit (Money In)"}),e.jsx(W,{value:"debit",children:"Debit (Money Out)"})]})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"transactionDate",children:"Date"}),e.jsx(ge,{id:"transactionDate",type:"date",value:(i==null?void 0:i.transactionDate)||"",onChange:U=>d==null?void 0:d("transactionDate",U.target.value)}),(l==null?void 0:l.transactionDate)&&e.jsx("p",{className:"text-sm text-destructive mt-1",children:l.transactionDate})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"merchantName",children:"Merchant (Optional)"}),e.jsx(ge,{id:"merchantName",value:(i==null?void 0:i.merchantName)||"",onChange:U=>d==null?void 0:d("merchantName",U.target.value),placeholder:"Merchant name"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"category",children:"Category (Optional)"}),e.jsx(ge,{id:"category",value:(i==null?void 0:i.category)||"",onChange:U=>d==null?void 0:d("category",U.target.value),placeholder:"Transaction category"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"reference",children:"Reference (Optional)"}),e.jsx(ge,{id:"reference",value:(i==null?void 0:i.reference)||"",onChange:U=>d==null?void 0:d("reference",U.target.value),placeholder:"Reference number"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"memo",children:"Memo (Optional)"}),e.jsx(ge,{id:"memo",value:(i==null?void 0:i.memo)||"",onChange:U=>d==null?void 0:d("memo",U.target.value),placeholder:"Additional notes"})]}),(l==null?void 0:l.submit)&&e.jsx("p",{className:"text-sm text-destructive",children:l.submit})]}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:()=>a==null?void 0:a(!1),children:"Cancel"}),e.jsx(I,{onClick:u,children:"Create Transaction"})]})]})});switch(m){case"mobile":return e.jsxs(e.Fragment,{children:[T(),e.jsx(z,{})]});case"tablet":return e.jsxs(e.Fragment,{children:[G(),e.jsx(z,{})]});case"desktop":return e.jsxs(e.Fragment,{children:[L(),e.jsx(z,{})]});default:return e.jsxs(e.Fragment,{children:[L(),e.jsx(z,{})]})}}function Wce(){const{isAuthenticated:s,isLoading:t,loginWithDemo:r}=Ua(),{toast:n}=X5(),[a,i]=x.useState(0),[o,l]=x.useState(!1),[c,d]=x.useState(""),[u,h]=x.useState(!1),[f,m]=x.useState({bankAccountId:"",description:"",amount:"",transactionType:"debit",transactionDate:new Date().toISOString().split("T")[0],merchantName:"",category:"",reference:"",memo:""}),[p,g]=x.useState({});x.useEffect(()=>{l(!0);const b=localStorage.getItem("company_id")||localStorage.getItem("companyId")||"seed-company-1",w=localStorage.getItem("company_name");let N=b;w==="mmcmc"?N="cmg0qxjh9003nao3ftbaz1oc1":b==="personal"&&(N="seed-company-1"),d(N),console.log("Banking page companyId:",N,"from localStorage:",b,"company name:",w),console.log("Banking page will pass companyId to ResponsiveBankingLayout:",N),!t&&!s&&r("banking-page",["admin","accountant"]).catch(console.error)},[s,t,r]);const v=(b,w)=>{m(N=>({...N,[b]:w})),p[b]&&g(N=>({...N,[b]:""}))},y=()=>{const b={};return f.bankAccountId.trim()||(b.bankAccountId="Bank account is required"),f.description.trim()||(b.description="Description is required"),f.amount.trim()?(isNaN(Number(f.amount))||Number(f.amount)===0)&&(b.amount="Amount must be a valid number"):b.amount="Amount is required",f.transactionDate.trim()||(b.transactionDate="Transaction date is required"),g(b),Object.keys(b).length===0},j=async()=>{if(y())try{await Qa.createBankTransaction({bankAccountId:f.bankAccountId,description:f.description.trim(),amount:Number(f.amount),transactionType:f.transactionType,transactionDate:new Date(f.transactionDate).toISOString(),merchantName:f.merchantName.trim()||void 0,category:f.category.trim()||void 0,reference:f.reference.trim()||void 0,memo:f.memo.trim()||void 0,status:"unreconciled"}),n({title:"Transaction Created",description:"Bank transaction has been successfully created."}),m({bankAccountId:"",description:"",amount:"",transactionType:"debit",transactionDate:new Date().toISOString().split("T")[0],merchantName:"",category:"",reference:"",memo:""}),g({}),h(!1),i(b=>b+1)}catch(b){console.error("Error creating transaction:",b),n({title:"Failed to Create Transaction",description:"An error occurred while creating the transaction.",variant:"destructive"}),g({submit:"Failed to create transaction. Please try again."})}};return t?e.jsx(Kr,{title:"Banking & Cash Management",description:"Manage bank accounts, transactions, reconciliation, and advanced banking features",breadcrumbs:[{label:"Dashboard",href:"/"},{label:"Banking",href:"/banking"}],children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading authentication..."})]})})}):s?o?e.jsxs(Kr,{title:"Banking & Cash Management",description:"Manage bank accounts, transactions, reconciliation, and advanced banking features",breadcrumbs:[{label:"Dashboard",href:"/"},{label:"Banking",href:"/banking"}],children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Company"}),e.jsx("input",{className:"h-8 w-48 border rounded px-2 text-sm",value:c,onChange:b=>d(b.target.value)})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Date"}),e.jsx("div",{className:"inline-flex rounded-md border overflow-hidden",children:e.jsx("button",{className:"px-2 py-1 text-xs hover:bg-muted",onClick:()=>i(b=>b+1),children:"Refresh"})})]})]}),e.jsx(Vce,{companyId:c,accountsRefreshKey:a,setAccountsRefreshKey:i,isAddTransactionOpen:u,setIsAddTransactionOpen:h,transactionForm:f,setTransactionForm:m,transactionFormErrors:p,setTransactionFormErrors:g,handleTransactionFormChange:v,handleCreateTransaction:j})]}):e.jsx(Kr,{title:"Banking & Cash Management",description:"Manage bank accounts, transactions, reconciliation, and advanced banking features",breadcrumbs:[{label:"Dashboard",href:"/"},{label:"Banking",href:"/banking"}],children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading..."})]})})}):e.jsx(Kr,{title:"Banking & Cash Management",description:"Manage bank accounts, transactions, reconciliation, and advanced banking features",breadcrumbs:[{label:"Dashboard",href:"/"},{label:"Banking",href:"/banking"}],children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"Please log in to access banking features."})})})})}const f4={getCategories:async s=>{const t=new URLSearchParams;return s&&t.append("companyId",s),await de.get(`/api/categories?${t.toString()}`)},getCategory:async s=>await de.get(`/api/categories/${s}`),createCategory:async s=>await de.post("/api/categories",s),updateCategory:async(s,t)=>await de.put(`/api/categories/${s}`,t),deleteCategory:async s=>await de.delete(`/api/categories/${s}`),getCategoryHierarchy:async s=>{const t=new URLSearchParams;return s&&t.append("companyId",s),await de.get(`/api/categories/hierarchy?${t.toString()}`)},getCategoriesFlat:async s=>{const t=await f4.getCategories(s),r=(n,a="")=>{const i=[];return n.forEach(o=>{const l=a?`${a} > ${o.name}`:o.name;i.push({id:o.id,name:o.name,path:l}),o.children&&o.children.length>0&&i.push(...r(o.children,l))}),i};return r(t)}};function Hce(s,t){var r=Object.setPrototypeOf;r?r(s,t):s.__proto__=t}function Gce(s,t){t===void 0&&(t=s.constructor);var r=Error.captureStackTrace;r&&r(s,t)}var Kce=function(){var s=function(r,n){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,i){a.__proto__=i}||function(a,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(a[o]=i[o])},s(r,n)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Yce=function(s){Kce(t,s);function t(r,n){var a=this.constructor,i=s.call(this,r,n)||this;return Object.defineProperty(i,"name",{value:a.name,enumerable:!1,configurable:!0}),Hce(i,a.prototype),Gce(i),i}return t}(Error),Jce=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),lc=function(s){Jce(t,s);function t(r){r===void 0&&(r=void 0);var n=s.call(this,r)||this;return n.message=r,n}return t.prototype.getKind=function(){var r=this.constructor;return r.kind},t.kind="Exception",t}(Yce),Xce=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Li=function(s){Xce(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.kind="ArgumentException",t}(lc),Qce=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Or=function(s){Qce(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.kind="IllegalArgumentException",t}(lc),P9=function(){function s(t){if(this.binarizer=t,t===null)throw new Or("Binarizer must be non-null.")}return s.prototype.getWidth=function(){return this.binarizer.getWidth()},s.prototype.getHeight=function(){return this.binarizer.getHeight()},s.prototype.getBlackRow=function(t,r){return this.binarizer.getBlackRow(t,r)},s.prototype.getBlackMatrix=function(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix},s.prototype.isCropSupported=function(){return this.binarizer.getLuminanceSource().isCropSupported()},s.prototype.crop=function(t,r,n,a){var i=this.binarizer.getLuminanceSource().crop(t,r,n,a);return new s(this.binarizer.createBinarizer(i))},s.prototype.isRotateSupported=function(){return this.binarizer.getLuminanceSource().isRotateSupported()},s.prototype.rotateCounterClockwise=function(){var t=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new s(this.binarizer.createBinarizer(t))},s.prototype.rotateCounterClockwise45=function(){var t=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new s(this.binarizer.createBinarizer(t))},s.prototype.toString=function(){try{return this.getBlackMatrix().toString()}catch{return""}},s}(),Zce=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),no=function(s){Zce(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.getChecksumInstance=function(){return new t},t.kind="ChecksumException",t}(lc),ede=function(){function s(t){this.source=t}return s.prototype.getLuminanceSource=function(){return this.source},s.prototype.getWidth=function(){return this.source.getWidth()},s.prototype.getHeight=function(){return this.source.getHeight()},s}(),ei=function(){function s(){}return s.arraycopy=function(t,r,n,a,i){for(;i--;)n[a++]=t[r++]},s.currentTimeMillis=function(){return Date.now()},s}(),tde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),w3=function(s){tde(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.kind="IndexOutOfBoundsException",t}(lc),sde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),pk=function(s){sde(t,s);function t(r,n){r===void 0&&(r=void 0),n===void 0&&(n=void 0);var a=s.call(this,n)||this;return a.index=r,a.message=n,a}return t.kind="ArrayIndexOutOfBoundsException",t}(w3),rde=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},So=function(){function s(){}return s.fill=function(t,r){for(var n=0,a=t.length;n<a;n++)t[n]=r},s.fillWithin=function(t,r,n,a){s.rangeCheck(t.length,r,n);for(var i=r;i<n;i++)t[i]=a},s.rangeCheck=function(t,r,n){if(r>n)throw new Or("fromIndex("+r+") > toIndex("+n+")");if(r<0)throw new pk(r);if(n>t)throw new pk(n)},s.asList=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t},s.create=function(t,r,n){var a=Array.from({length:t});return a.map(function(i){return Array.from({length:r}).fill(n)})},s.createInt32Array=function(t,r,n){var a=Array.from({length:t});return a.map(function(i){return Int32Array.from({length:r}).fill(n)})},s.equals=function(t,r){if(!t||!r||!t.length||!r.length||t.length!==r.length)return!1;for(var n=0,a=t.length;n<a;n++)if(t[n]!==r[n])return!1;return!0},s.hashCode=function(t){var r,n;if(t===null)return 0;var a=1;try{for(var i=rde(t),o=i.next();!o.done;o=i.next()){var l=o.value;a=31*a+l}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},s.fillUint8Array=function(t,r){for(var n=0;n!==t.length;n++)t[n]=r},s.copyOf=function(t,r){return t.slice(0,r)},s.copyOfUint8Array=function(t,r){if(t.length<=r){var n=new Uint8Array(r);return n.set(t),n}return t.slice(0,r)},s.copyOfRange=function(t,r,n){var a=n-r,i=new Int32Array(a);return ei.arraycopy(t,r,i,0,a),i},s.binarySearch=function(t,r,n){n===void 0&&(n=s.numberComparator);for(var a=0,i=t.length-1;a<=i;){var o=i+a>>1,l=n(r,t[o]);if(l>0)a=o+1;else if(l<0)i=o-1;else return o}return-a-1},s.numberComparator=function(t,r){return t-r},s}(),_n=function(){function s(){}return s.numberOfTrailingZeros=function(t){var r;if(t===0)return 32;var n=31;return r=t<<16,r!==0&&(n-=16,t=r),r=t<<8,r!==0&&(n-=8,t=r),r=t<<4,r!==0&&(n-=4,t=r),r=t<<2,r!==0&&(n-=2,t=r),n-(t<<1>>>31)},s.numberOfLeadingZeros=function(t){if(t===0)return 32;var r=1;return t>>>16||(r+=16,t<<=16),t>>>24||(r+=8,t<<=8),t>>>28||(r+=4,t<<=4),t>>>30||(r+=2,t<<=2),r-=t>>>31,r},s.toHexString=function(t){return t.toString(16)},s.toBinaryString=function(t){return String(parseInt(String(t),2))},s.bitCount=function(t){return t=t-(t>>>1&1431655765),t=(t&858993459)+(t>>>2&858993459),t=t+(t>>>4)&252645135,t=t+(t>>>8),t=t+(t>>>16),t&63},s.truncDivision=function(t,r){return Math.trunc(t/r)},s.parseInt=function(t,r){return r===void 0&&(r=void 0),parseInt(t,r)},s.MIN_VALUE_32_BITS=-2147483648,s.MAX_VALUE=Number.MAX_SAFE_INTEGER,s}(),Bo=function(){function s(t,r){t===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=t,r==null?this.bits=s.makeArray(t):this.bits=r)}return s.prototype.getSize=function(){return this.size},s.prototype.getSizeInBytes=function(){return Math.floor((this.size+7)/8)},s.prototype.ensureCapacity=function(t){if(t>this.bits.length*32){var r=s.makeArray(t);ei.arraycopy(this.bits,0,r,0,this.bits.length),this.bits=r}},s.prototype.get=function(t){return(this.bits[Math.floor(t/32)]&1<<(t&31))!==0},s.prototype.set=function(t){this.bits[Math.floor(t/32)]|=1<<(t&31)},s.prototype.flip=function(t){this.bits[Math.floor(t/32)]^=1<<(t&31)},s.prototype.getNextSet=function(t){var r=this.size;if(t>=r)return r;var n=this.bits,a=Math.floor(t/32),i=n[a];i&=~((1<<(t&31))-1);for(var o=n.length;i===0;){if(++a===o)return r;i=n[a]}var l=a*32+_n.numberOfTrailingZeros(i);return l>r?r:l},s.prototype.getNextUnset=function(t){var r=this.size;if(t>=r)return r;var n=this.bits,a=Math.floor(t/32),i=~n[a];i&=~((1<<(t&31))-1);for(var o=n.length;i===0;){if(++a===o)return r;i=~n[a]}var l=a*32+_n.numberOfTrailingZeros(i);return l>r?r:l},s.prototype.setBulk=function(t,r){this.bits[Math.floor(t/32)]=r},s.prototype.setRange=function(t,r){if(r<t||t<0||r>this.size)throw new Or;if(r!==t){r--;for(var n=Math.floor(t/32),a=Math.floor(r/32),i=this.bits,o=n;o<=a;o++){var l=o>n?0:t&31,c=o<a?31:r&31,d=(2<<c)-(1<<l);i[o]|=d}}},s.prototype.clear=function(){for(var t=this.bits.length,r=this.bits,n=0;n<t;n++)r[n]=0},s.prototype.isRange=function(t,r,n){if(r<t||t<0||r>this.size)throw new Or;if(r===t)return!0;r--;for(var a=Math.floor(t/32),i=Math.floor(r/32),o=this.bits,l=a;l<=i;l++){var c=l>a?0:t&31,d=l<i?31:r&31,u=(2<<d)-(1<<c)&4294967295;if((o[l]&u)!==(n?u:0))return!1}return!0},s.prototype.appendBit=function(t){this.ensureCapacity(this.size+1),t&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++},s.prototype.appendBits=function(t,r){if(r<0||r>32)throw new Or("Num bits must be between 0 and 32");this.ensureCapacity(this.size+r);for(var n=r;n>0;n--)this.appendBit((t>>n-1&1)===1)},s.prototype.appendBitArray=function(t){var r=t.size;this.ensureCapacity(this.size+r);for(var n=0;n<r;n++)this.appendBit(t.get(n))},s.prototype.xor=function(t){if(this.size!==t.size)throw new Or("Sizes don't match");for(var r=this.bits,n=0,a=r.length;n<a;n++)r[n]^=t.bits[n]},s.prototype.toBytes=function(t,r,n,a){for(var i=0;i<a;i++){for(var o=0,l=0;l<8;l++)this.get(t)&&(o|=1<<7-l),t++;r[n+i]=o}},s.prototype.getBitArray=function(){return this.bits},s.prototype.reverse=function(){for(var t=new Int32Array(this.bits.length),r=Math.floor((this.size-1)/32),n=r+1,a=this.bits,i=0;i<n;i++){var o=a[i];o=o>>1&1431655765|(o&1431655765)<<1,o=o>>2&858993459|(o&858993459)<<2,o=o>>4&252645135|(o&252645135)<<4,o=o>>8&16711935|(o&16711935)<<8,o=o>>16&65535|(o&65535)<<16,t[r-i]=o}if(this.size!==n*32){for(var l=n*32-this.size,c=t[0]>>>l,i=1;i<n;i++){var d=t[i];c|=d<<32-l,t[i-1]=c,c=d>>>l}t[n-1]=c}this.bits=t},s.makeArray=function(t){return new Int32Array(Math.floor((t+31)/32))},s.prototype.equals=function(t){if(!(t instanceof s))return!1;var r=t;return this.size===r.size&&So.equals(this.bits,r.bits)},s.prototype.hashCode=function(){return 31*this.size+So.hashCode(this.bits)},s.prototype.toString=function(){for(var t="",r=0,n=this.size;r<n;r++)r&7||(t+=" "),t+=this.get(r)?"X":".";return t},s.prototype.clone=function(){return new s(this.size,this.bits.slice())},s.prototype.toArray=function(){for(var t=[],r=0,n=this.size;r<n;r++)t.push(this.get(r));return t},s}(),x4;(function(s){s[s.OTHER=0]="OTHER",s[s.PURE_BARCODE=1]="PURE_BARCODE",s[s.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",s[s.TRY_HARDER=3]="TRY_HARDER",s[s.CHARACTER_SET=4]="CHARACTER_SET",s[s.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",s[s.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",s[s.ENABLE_CODE_39_EXTENDED_MODE=7]="ENABLE_CODE_39_EXTENDED_MODE",s[s.ASSUME_GS1=8]="ASSUME_GS1",s[s.RETURN_CODABAR_START_END=9]="RETURN_CODABAR_START_END",s[s.NEED_RESULT_POINT_CALLBACK=10]="NEED_RESULT_POINT_CALLBACK",s[s.ALLOWED_EAN_EXTENSIONS=11]="ALLOWED_EAN_EXTENSIONS"})(x4||(x4={}));const ti=x4;var nde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ls=function(s){nde(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.getFormatInstance=function(){return new t},t.kind="FormatException",t}(lc),ade=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},va;(function(s){s[s.Cp437=0]="Cp437",s[s.ISO8859_1=1]="ISO8859_1",s[s.ISO8859_2=2]="ISO8859_2",s[s.ISO8859_3=3]="ISO8859_3",s[s.ISO8859_4=4]="ISO8859_4",s[s.ISO8859_5=5]="ISO8859_5",s[s.ISO8859_6=6]="ISO8859_6",s[s.ISO8859_7=7]="ISO8859_7",s[s.ISO8859_8=8]="ISO8859_8",s[s.ISO8859_9=9]="ISO8859_9",s[s.ISO8859_10=10]="ISO8859_10",s[s.ISO8859_11=11]="ISO8859_11",s[s.ISO8859_13=12]="ISO8859_13",s[s.ISO8859_14=13]="ISO8859_14",s[s.ISO8859_15=14]="ISO8859_15",s[s.ISO8859_16=15]="ISO8859_16",s[s.SJIS=16]="SJIS",s[s.Cp1250=17]="Cp1250",s[s.Cp1251=18]="Cp1251",s[s.Cp1252=19]="Cp1252",s[s.Cp1256=20]="Cp1256",s[s.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",s[s.UTF8=22]="UTF8",s[s.ASCII=23]="ASCII",s[s.Big5=24]="Big5",s[s.GB18030=25]="GB18030",s[s.EUC_KR=26]="EUC_KR"})(va||(va={}));var wo=function(){function s(t,r,n){for(var a,i,o=[],l=3;l<arguments.length;l++)o[l-3]=arguments[l];this.valueIdentifier=t,this.name=n,typeof r=="number"?this.values=Int32Array.from([r]):this.values=r,this.otherEncodingNames=o,s.VALUE_IDENTIFIER_TO_ECI.set(t,this),s.NAME_TO_ECI.set(n,this);for(var c=this.values,d=0,u=c.length;d!==u;d++){var h=c[d];s.VALUES_TO_ECI.set(h,this)}try{for(var f=ade(o),m=f.next();!m.done;m=f.next()){var p=m.value;s.NAME_TO_ECI.set(p,this)}}catch(g){a={error:g}}finally{try{m&&!m.done&&(i=f.return)&&i.call(f)}finally{if(a)throw a.error}}}return s.prototype.getValueIdentifier=function(){return this.valueIdentifier},s.prototype.getName=function(){return this.name},s.prototype.getValue=function(){return this.values[0]},s.getCharacterSetECIByValue=function(t){if(t<0||t>=900)throw new Ls("incorect value");var r=s.VALUES_TO_ECI.get(t);if(r===void 0)throw new Ls("incorect value");return r},s.getCharacterSetECIByName=function(t){var r=s.NAME_TO_ECI.get(t);if(r===void 0)throw new Ls("incorect value");return r},s.prototype.equals=function(t){if(!(t instanceof s))return!1;var r=t;return this.getName()===r.getName()},s.VALUE_IDENTIFIER_TO_ECI=new Map,s.VALUES_TO_ECI=new Map,s.NAME_TO_ECI=new Map,s.Cp437=new s(va.Cp437,Int32Array.from([0,2]),"Cp437"),s.ISO8859_1=new s(va.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),s.ISO8859_2=new s(va.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),s.ISO8859_3=new s(va.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),s.ISO8859_4=new s(va.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),s.ISO8859_5=new s(va.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),s.ISO8859_6=new s(va.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),s.ISO8859_7=new s(va.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),s.ISO8859_8=new s(va.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),s.ISO8859_9=new s(va.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),s.ISO8859_10=new s(va.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),s.ISO8859_11=new s(va.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),s.ISO8859_13=new s(va.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),s.ISO8859_14=new s(va.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),s.ISO8859_15=new s(va.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),s.ISO8859_16=new s(va.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),s.SJIS=new s(va.SJIS,20,"SJIS","Shift_JIS"),s.Cp1250=new s(va.Cp1250,21,"Cp1250","windows-1250"),s.Cp1251=new s(va.Cp1251,22,"Cp1251","windows-1251"),s.Cp1252=new s(va.Cp1252,23,"Cp1252","windows-1252"),s.Cp1256=new s(va.Cp1256,24,"Cp1256","windows-1256"),s.UnicodeBigUnmarked=new s(va.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),s.UTF8=new s(va.UTF8,26,"UTF8","UTF-8"),s.ASCII=new s(va.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),s.Big5=new s(va.Big5,28,"Big5"),s.GB18030=new s(va.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),s.EUC_KR=new s(va.EUC_KR,30,"EUC_KR","EUC-KR"),s}(),ide=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Vj=function(s){ide(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.kind="UnsupportedOperationException",t}(lc),td=function(){function s(){}return s.decode=function(t,r){var n=this.encodingName(r);return this.customDecoder?this.customDecoder(t,n):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(n)?this.decodeFallback(t,n):new TextDecoder(n).decode(t)},s.shouldDecodeOnFallback=function(t){return!s.isBrowser()&&t==="ISO-8859-1"},s.encode=function(t,r){var n=this.encodingName(r);return this.customEncoder?this.customEncoder(t,n):typeof TextEncoder>"u"?this.encodeFallback(t):new TextEncoder().encode(t)},s.isBrowser=function(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"},s.encodingName=function(t){return typeof t=="string"?t:t.getName()},s.encodingCharacterSet=function(t){return t instanceof wo?t:wo.getCharacterSetECIByName(t)},s.decodeFallback=function(t,r){var n=this.encodingCharacterSet(r);if(s.isDecodeFallbackSupported(n)){for(var a="",i=0,o=t.length;i<o;i++){var l=t[i].toString(16);l.length<2&&(l="0"+l),a+="%"+l}return decodeURIComponent(a)}if(n.equals(wo.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(t.buffer));throw new Vj("Encoding "+this.encodingName(r)+" not supported by fallback.")},s.isDecodeFallbackSupported=function(t){return t.equals(wo.UTF8)||t.equals(wo.ISO8859_1)||t.equals(wo.ASCII)},s.encodeFallback=function(t){for(var r=btoa(unescape(encodeURIComponent(t))),n=r.split(""),a=[],i=0;i<n.length;i++)a.push(n[i].charCodeAt(0));return new Uint8Array(a)},s}(),Gn=function(){function s(){}return s.castAsNonUtf8Char=function(t,r){r===void 0&&(r=null);var n=r?r.getName():this.ISO88591;return td.decode(new Uint8Array([t]),n)},s.guessEncoding=function(t,r){if(r!=null&&r.get(ti.CHARACTER_SET)!==void 0)return r.get(ti.CHARACTER_SET).toString();for(var n=t.length,a=!0,i=!0,o=!0,l=0,c=0,d=0,u=0,h=0,f=0,m=0,p=0,g=0,v=0,y=0,j=t.length>3&&t[0]===239&&t[1]===187&&t[2]===191,b=0;b<n&&(a||i||o);b++){var w=t[b]&255;o&&(l>0?w&128?l--:o=!1:w&128&&(w&64?(l++,w&32?(l++,w&16?(l++,w&8?o=!1:u++):d++):c++):o=!1)),a&&(w>127&&w<160?a=!1:w>159&&(w<192||w===215||w===247)&&y++),i&&(h>0?w<64||w===127||w>252?i=!1:h--:w===128||w===160||w>239?i=!1:w>160&&w<224?(f++,p=0,m++,m>g&&(g=m)):w>127?(h++,m=0,p++,p>v&&(v=p)):(m=0,p=0))}return o&&l>0&&(o=!1),i&&h>0&&(i=!1),o&&(j||c+d+u>0)?s.UTF8:i&&(s.ASSUME_SHIFT_JIS||g>=3||v>=3)?s.SHIFT_JIS:a&&i?g===2&&f===2||y*10>=n?s.SHIFT_JIS:s.ISO88591:a?s.ISO88591:i?s.SHIFT_JIS:o?s.UTF8:s.PLATFORM_DEFAULT_ENCODING},s.format=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var a=-1;function i(l,c,d,u,h,f){if(l==="%%")return"%";if(r[++a]!==void 0){l=u?parseInt(u.substr(1)):void 0;var m=h?parseInt(h.substr(1)):void 0,p;switch(f){case"s":p=r[a];break;case"c":p=r[a][0];break;case"f":p=parseFloat(r[a]).toFixed(l);break;case"p":p=parseFloat(r[a]).toPrecision(l);break;case"e":p=parseFloat(r[a]).toExponential(l);break;case"x":p=parseInt(r[a]).toString(m||16);break;case"d":p=parseFloat(parseInt(r[a],m||10).toPrecision(l)).toFixed(0);break}p=typeof p=="object"?JSON.stringify(p):(+p).toString(m);for(var g=parseInt(d),v=d&&d[0]+""=="0"?"0":" ";p.length<g;)p=c!==void 0?p+v:v+p;return p}}var o=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return t.replace(o,i)},s.getBytes=function(t,r){return td.encode(t,r)},s.getCharCode=function(t,r){return r===void 0&&(r=0),t.charCodeAt(r)},s.getCharAt=function(t){return String.fromCharCode(t)},s.SHIFT_JIS=wo.SJIS.getName(),s.GB2312="GB2312",s.ISO88591=wo.ISO8859_1.getName(),s.EUC_JP="EUC_JP",s.UTF8=wo.UTF8.getName(),s.PLATFORM_DEFAULT_ENCODING=s.UTF8,s.ASSUME_SHIFT_JIS=!1,s}(),En=function(){function s(t){t===void 0&&(t=""),this.value=t}return s.prototype.enableDecoding=function(t){return this.encoding=t,this},s.prototype.append=function(t){return typeof t=="string"?this.value+=t.toString():this.encoding?this.value+=Gn.castAsNonUtf8Char(t,this.encoding):this.value+=String.fromCharCode(t),this},s.prototype.appendChars=function(t,r,n){for(var a=r;r<r+n;a++)this.append(t[a]);return this},s.prototype.length=function(){return this.value.length},s.prototype.charAt=function(t){return this.value.charAt(t)},s.prototype.deleteCharAt=function(t){this.value=this.value.substr(0,t)+this.value.substring(t+1)},s.prototype.setCharAt=function(t,r){this.value=this.value.substr(0,t)+r+this.value.substr(t+1)},s.prototype.substring=function(t,r){return this.value.substring(t,r)},s.prototype.setLengthToZero=function(){this.value=""},s.prototype.toString=function(){return this.value},s.prototype.insert=function(t,r){this.value=this.value.substring(0,t)+r+this.value.substring(t)},s}(),fu=function(){function s(t,r,n,a){if(this.width=t,this.height=r,this.rowSize=n,this.bits=a,r==null&&(r=t),this.height=r,t<1||r<1)throw new Or("Both dimensions must be greater than 0");n==null&&(n=Math.floor((t+31)/32)),this.rowSize=n,a==null&&(this.bits=new Int32Array(this.rowSize*this.height))}return s.parseFromBooleanArray=function(t){for(var r=t.length,n=t[0].length,a=new s(n,r),i=0;i<r;i++)for(var o=t[i],l=0;l<n;l++)o[l]&&a.set(l,i);return a},s.parseFromString=function(t,r,n){if(t===null)throw new Or("stringRepresentation cannot be null");for(var a=new Array(t.length),i=0,o=0,l=-1,c=0,d=0;d<t.length;)if(t.charAt(d)===`
`||t.charAt(d)==="\r"){if(i>o){if(l===-1)l=i-o;else if(i-o!==l)throw new Or("row lengths do not match");o=i,c++}d++}else if(t.substring(d,d+r.length)===r)d+=r.length,a[i]=!0,i++;else if(t.substring(d,d+n.length)===n)d+=n.length,a[i]=!1,i++;else throw new Or("illegal character encountered: "+t.substring(d));if(i>o){if(l===-1)l=i-o;else if(i-o!==l)throw new Or("row lengths do not match");c++}for(var u=new s(l,c),h=0;h<i;h++)a[h]&&u.set(Math.floor(h%l),Math.floor(h/l));return u},s.prototype.get=function(t,r){var n=r*this.rowSize+Math.floor(t/32);return(this.bits[n]>>>(t&31)&1)!==0},s.prototype.set=function(t,r){var n=r*this.rowSize+Math.floor(t/32);this.bits[n]|=1<<(t&31)&4294967295},s.prototype.unset=function(t,r){var n=r*this.rowSize+Math.floor(t/32);this.bits[n]&=~(1<<(t&31)&4294967295)},s.prototype.flip=function(t,r){var n=r*this.rowSize+Math.floor(t/32);this.bits[n]^=1<<(t&31)&4294967295},s.prototype.xor=function(t){if(this.width!==t.getWidth()||this.height!==t.getHeight()||this.rowSize!==t.getRowSize())throw new Or("input matrix dimensions do not match");for(var r=new Bo(Math.floor(this.width/32)+1),n=this.rowSize,a=this.bits,i=0,o=this.height;i<o;i++)for(var l=i*n,c=t.getRow(i,r).getBitArray(),d=0;d<n;d++)a[l+d]^=c[d]},s.prototype.clear=function(){for(var t=this.bits,r=t.length,n=0;n<r;n++)t[n]=0},s.prototype.setRegion=function(t,r,n,a){if(r<0||t<0)throw new Or("Left and top must be nonnegative");if(a<1||n<1)throw new Or("Height and width must be at least 1");var i=t+n,o=r+a;if(o>this.height||i>this.width)throw new Or("The region must fit inside the matrix");for(var l=this.rowSize,c=this.bits,d=r;d<o;d++)for(var u=d*l,h=t;h<i;h++)c[u+Math.floor(h/32)]|=1<<(h&31)&4294967295},s.prototype.getRow=function(t,r){r==null||r.getSize()<this.width?r=new Bo(this.width):r.clear();for(var n=this.rowSize,a=this.bits,i=t*n,o=0;o<n;o++)r.setBulk(o*32,a[i+o]);return r},s.prototype.setRow=function(t,r){ei.arraycopy(r.getBitArray(),0,this.bits,t*this.rowSize,this.rowSize)},s.prototype.rotate180=function(){for(var t=this.getWidth(),r=this.getHeight(),n=new Bo(t),a=new Bo(t),i=0,o=Math.floor((r+1)/2);i<o;i++)n=this.getRow(i,n),a=this.getRow(r-1-i,a),n.reverse(),a.reverse(),this.setRow(i,a),this.setRow(r-1-i,n)},s.prototype.getEnclosingRectangle=function(){for(var t=this.width,r=this.height,n=this.rowSize,a=this.bits,i=t,o=r,l=-1,c=-1,d=0;d<r;d++)for(var u=0;u<n;u++){var h=a[d*n+u];if(h!==0){if(d<o&&(o=d),d>c&&(c=d),u*32<i){for(var f=0;!(h<<31-f&4294967295);)f++;u*32+f<i&&(i=u*32+f)}if(u*32+31>l){for(var f=31;!(h>>>f);)f--;u*32+f>l&&(l=u*32+f)}}}return l<i||c<o?null:Int32Array.from([i,o,l-i+1,c-o+1])},s.prototype.getTopLeftOnBit=function(){for(var t=this.rowSize,r=this.bits,n=0;n<r.length&&r[n]===0;)n++;if(n===r.length)return null;for(var a=n/t,i=n%t*32,o=r[n],l=0;!(o<<31-l&4294967295);)l++;return i+=l,Int32Array.from([i,a])},s.prototype.getBottomRightOnBit=function(){for(var t=this.rowSize,r=this.bits,n=r.length-1;n>=0&&r[n]===0;)n--;if(n<0)return null;for(var a=Math.floor(n/t),i=Math.floor(n%t)*32,o=r[n],l=31;!(o>>>l);)l--;return i+=l,Int32Array.from([i,a])},s.prototype.getWidth=function(){return this.width},s.prototype.getHeight=function(){return this.height},s.prototype.getRowSize=function(){return this.rowSize},s.prototype.equals=function(t){if(!(t instanceof s))return!1;var r=t;return this.width===r.width&&this.height===r.height&&this.rowSize===r.rowSize&&So.equals(this.bits,r.bits)},s.prototype.hashCode=function(){var t=this.width;return t=31*t+this.width,t=31*t+this.height,t=31*t+this.rowSize,t=31*t+So.hashCode(this.bits),t},s.prototype.toString=function(t,r,n){return t===void 0&&(t="X "),r===void 0&&(r="  "),n===void 0&&(n=`
`),this.buildToString(t,r,n)},s.prototype.buildToString=function(t,r,n){for(var a=new En,i=0,o=this.height;i<o;i++){for(var l=0,c=this.width;l<c;l++)a.append(this.get(l,i)?t:r);a.append(n)}return a.toString()},s.prototype.clone=function(){return new s(this.width,this.height,this.rowSize,this.bits.slice())},s}(),ode=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),es=function(s){ode(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.getNotFoundInstance=function(){return new t},t.kind="NotFoundException",t}(lc),lde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),cde=function(s){lde(t,s);function t(r){var n=s.call(this,r)||this;return n.luminances=t.EMPTY,n.buckets=new Int32Array(t.LUMINANCE_BUCKETS),n}return t.prototype.getBlackRow=function(r,n){var a=this.getLuminanceSource(),i=a.getWidth();n==null||n.getSize()<i?n=new Bo(i):n.clear(),this.initArrays(i);for(var o=a.getRow(r,this.luminances),l=this.buckets,c=0;c<i;c++)l[(o[c]&255)>>t.LUMINANCE_SHIFT]++;var d=t.estimateBlackPoint(l);if(i<3)for(var c=0;c<i;c++)(o[c]&255)<d&&n.set(c);else for(var u=o[0]&255,h=o[1]&255,c=1;c<i-1;c++){var f=o[c+1]&255;(h*4-u-f)/2<d&&n.set(c),u=h,h=f}return n},t.prototype.getBlackMatrix=function(){var r=this.getLuminanceSource(),n=r.getWidth(),a=r.getHeight(),i=new fu(n,a);this.initArrays(n);for(var o=this.buckets,l=1;l<5;l++)for(var c=Math.floor(a*l/5),d=r.getRow(c,this.luminances),u=Math.floor(n*4/5),h=Math.floor(n/5);h<u;h++){var f=d[h]&255;o[f>>t.LUMINANCE_SHIFT]++}for(var m=t.estimateBlackPoint(o),p=r.getMatrix(),l=0;l<a;l++)for(var g=l*n,h=0;h<n;h++){var f=p[g+h]&255;f<m&&i.set(h,l)}return i},t.prototype.createBinarizer=function(r){return new t(r)},t.prototype.initArrays=function(r){this.luminances.length<r&&(this.luminances=new Uint8ClampedArray(r));for(var n=this.buckets,a=0;a<t.LUMINANCE_BUCKETS;a++)n[a]=0},t.estimateBlackPoint=function(r){for(var n=r.length,a=0,i=0,o=0,l=0;l<n;l++)r[l]>o&&(i=l,o=r[l]),r[l]>a&&(a=r[l]);for(var c=0,d=0,l=0;l<n;l++){var u=l-i,h=r[l]*u*u;h>d&&(c=l,d=h)}if(i>c){var f=i;i=c,c=f}if(c-i<=n/16)throw new es;for(var m=c-1,p=-1,l=c-1;l>i;l--){var g=l-i,h=g*g*(c-l)*(a-r[l]);h>p&&(m=l,p=h)}return m<<t.LUMINANCE_SHIFT},t.LUMINANCE_BITS=5,t.LUMINANCE_SHIFT=8-t.LUMINANCE_BITS,t.LUMINANCE_BUCKETS=1<<t.LUMINANCE_BITS,t.EMPTY=Uint8ClampedArray.from([0]),t}(ede),dde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),_9=function(s){dde(t,s);function t(r){var n=s.call(this,r)||this;return n.matrix=null,n}return t.prototype.getBlackMatrix=function(){if(this.matrix!==null)return this.matrix;var r=this.getLuminanceSource(),n=r.getWidth(),a=r.getHeight();if(n>=t.MINIMUM_DIMENSION&&a>=t.MINIMUM_DIMENSION){var i=r.getMatrix(),o=n>>t.BLOCK_SIZE_POWER;n&t.BLOCK_SIZE_MASK&&o++;var l=a>>t.BLOCK_SIZE_POWER;a&t.BLOCK_SIZE_MASK&&l++;var c=t.calculateBlackPoints(i,o,l,n,a),d=new fu(n,a);t.calculateThresholdForBlock(i,o,l,n,a,c,d),this.matrix=d}else this.matrix=s.prototype.getBlackMatrix.call(this);return this.matrix},t.prototype.createBinarizer=function(r){return new t(r)},t.calculateThresholdForBlock=function(r,n,a,i,o,l,c){for(var d=o-t.BLOCK_SIZE,u=i-t.BLOCK_SIZE,h=0;h<a;h++){var f=h<<t.BLOCK_SIZE_POWER;f>d&&(f=d);for(var m=t.cap(h,2,a-3),p=0;p<n;p++){var g=p<<t.BLOCK_SIZE_POWER;g>u&&(g=u);for(var v=t.cap(p,2,n-3),y=0,j=-2;j<=2;j++){var b=l[m+j];y+=b[v-2]+b[v-1]+b[v]+b[v+1]+b[v+2]}var w=y/25;t.thresholdBlock(r,g,f,w,i,c)}}},t.cap=function(r,n,a){return r<n?n:r>a?a:r},t.thresholdBlock=function(r,n,a,i,o,l){for(var c=0,d=a*o+n;c<t.BLOCK_SIZE;c++,d+=o)for(var u=0;u<t.BLOCK_SIZE;u++)(r[d+u]&255)<=i&&l.set(n+u,a+c)},t.calculateBlackPoints=function(r,n,a,i,o){for(var l=o-t.BLOCK_SIZE,c=i-t.BLOCK_SIZE,d=new Array(a),u=0;u<a;u++){d[u]=new Int32Array(n);var h=u<<t.BLOCK_SIZE_POWER;h>l&&(h=l);for(var f=0;f<n;f++){var m=f<<t.BLOCK_SIZE_POWER;m>c&&(m=c);for(var p=0,g=255,v=0,y=0,j=h*i+m;y<t.BLOCK_SIZE;y++,j+=i){for(var b=0;b<t.BLOCK_SIZE;b++){var w=r[j+b]&255;p+=w,w<g&&(g=w),w>v&&(v=w)}if(v-g>t.MIN_DYNAMIC_RANGE)for(y++,j+=i;y<t.BLOCK_SIZE;y++,j+=i)for(var b=0;b<t.BLOCK_SIZE;b++)p+=r[j+b]&255}var N=p>>t.BLOCK_SIZE_POWER*2;if(v-g<=t.MIN_DYNAMIC_RANGE&&(N=g/2,u>0&&f>0)){var C=(d[u-1][f]+2*d[u][f-1]+d[u-1][f-1])/4;g<C&&(N=C)}d[u][f]=N}}return d},t.BLOCK_SIZE_POWER=3,t.BLOCK_SIZE=1<<t.BLOCK_SIZE_POWER,t.BLOCK_SIZE_MASK=t.BLOCK_SIZE-1,t.MINIMUM_DIMENSION=t.BLOCK_SIZE*5,t.MIN_DYNAMIC_RANGE=24,t}(cde),uy=function(){function s(t,r){this.width=t,this.height=r}return s.prototype.getWidth=function(){return this.width},s.prototype.getHeight=function(){return this.height},s.prototype.isCropSupported=function(){return!1},s.prototype.crop=function(t,r,n,a){throw new Vj("This luminance source does not support cropping.")},s.prototype.isRotateSupported=function(){return!1},s.prototype.rotateCounterClockwise=function(){throw new Vj("This luminance source does not support rotation by 90 degrees.")},s.prototype.rotateCounterClockwise45=function(){throw new Vj("This luminance source does not support rotation by 45 degrees.")},s.prototype.toString=function(){for(var t=new Uint8ClampedArray(this.width),r=new En,n=0;n<this.height;n++){for(var a=this.getRow(n,t),i=0;i<this.width;i++){var o=a[i]&255,l=void 0;o<64?l="#":o<128?l="+":o<192?l=".":l=" ",r.append(l)}r.append(`
`)}return r.toString()},s}(),ude=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),bN=function(s){ude(t,s);function t(r){var n=s.call(this,r.getWidth(),r.getHeight())||this;return n.delegate=r,n}return t.prototype.getRow=function(r,n){for(var a=this.delegate.getRow(r,n),i=this.getWidth(),o=0;o<i;o++)a[o]=255-(a[o]&255);return a},t.prototype.getMatrix=function(){for(var r=this.delegate.getMatrix(),n=this.getWidth()*this.getHeight(),a=new Uint8ClampedArray(n),i=0;i<n;i++)a[i]=255-(r[i]&255);return a},t.prototype.isCropSupported=function(){return this.delegate.isCropSupported()},t.prototype.crop=function(r,n,a,i){return new t(this.delegate.crop(r,n,a,i))},t.prototype.isRotateSupported=function(){return this.delegate.isRotateSupported()},t.prototype.invert=function(){return this.delegate},t.prototype.rotateCounterClockwise=function(){return new t(this.delegate.rotateCounterClockwise())},t.prototype.rotateCounterClockwise45=function(){return new t(this.delegate.rotateCounterClockwise45())},t}(uy),hde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),mde=function(s){hde(t,s);function t(r,n){n===void 0&&(n=!1);var a=s.call(this,r.width,r.height)||this;return a.canvas=r,a.tempCanvasElement=null,a.buffer=t.makeBufferFromCanvasImageData(r,n),a}return t.makeBufferFromCanvasImageData=function(r,n){n===void 0&&(n=!1);var a=r.getContext("2d").getImageData(0,0,r.width,r.height);return t.toGrayscaleBuffer(a.data,r.width,r.height,n)},t.toGrayscaleBuffer=function(r,n,a,i){i===void 0&&(i=!1);var o=new Uint8ClampedArray(n*a);if(t.FRAME_INDEX=!t.FRAME_INDEX,t.FRAME_INDEX||!i)for(var l=0,c=0,d=r.length;l<d;l+=4,c++){var u=void 0,h=r[l+3];if(h===0)u=255;else{var f=r[l],m=r[l+1],p=r[l+2];u=306*f+601*m+117*p+512>>10}o[c]=u}else for(var l=0,c=0,g=r.length;l<g;l+=4,c++){var u=void 0,h=r[l+3];if(h===0)u=255;else{var f=r[l],m=r[l+1],p=r[l+2];u=306*f+601*m+117*p+512>>10}o[c]=255-u}return o},t.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Or("Requested row is outside the image: "+r);var a=this.getWidth(),i=r*a;return n===null?n=this.buffer.slice(i,i+a):(n.length<a&&(n=new Uint8ClampedArray(a)),n.set(this.buffer.slice(i,i+a))),n},t.prototype.getMatrix=function(){return this.buffer},t.prototype.isCropSupported=function(){return!0},t.prototype.crop=function(r,n,a,i){return s.prototype.crop.call(this,r,n,a,i),this},t.prototype.isRotateSupported=function(){return!0},t.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},t.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},t.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement},t.prototype.rotate=function(r){var n=this.getTempCanvasElement(),a=n.getContext("2d"),i=r*t.DEGREE_TO_RADIANS,o=this.canvas.width,l=this.canvas.height,c=Math.ceil(Math.abs(Math.cos(i))*o+Math.abs(Math.sin(i))*l),d=Math.ceil(Math.abs(Math.sin(i))*o+Math.abs(Math.cos(i))*l);return n.width=c,n.height=d,a.translate(c/2,d/2),a.rotate(i),a.drawImage(this.canvas,o/-2,l/-2),this.buffer=t.makeBufferFromCanvasImageData(n),this},t.prototype.invert=function(){return new bN(this)},t.DEGREE_TO_RADIANS=Math.PI/180,t.FRAME_INDEX=!0,t}(uy),fde=function(){function s(t,r,n){this.deviceId=t,this.label=r,this.kind="videoinput",this.groupId=n||void 0}return s.prototype.toJSON=function(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}},s}(),Nl=function(s,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(n.next(u))}catch(h){o(h)}}function c(u){try{d(n.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(s,t||[])).next())})},wl=function(s,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(d){return function(u){return c([d,u])}}function c(d){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=d[0]&2?a.return:d[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,d[1])).done)return i;switch(a=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,a=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){r.label=d[1];break}if(d[0]===6&&r.label<i[1]){r.label=i[1],i=d;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(d);break}i[2]&&r.ops.pop(),r.trys.pop();continue}d=t.call(s,r)}catch(u){d=[6,u],a=0}finally{n=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},xde=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Sg=function(){function s(t,r,n){r===void 0&&(r=500),this.reader=t,this.timeBetweenScansMillis=r,this._hints=n,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}return Object.defineProperty(s.prototype,"hasNavigator",{get:function(){return typeof navigator<"u"},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"isMediaDevicesSuported",{get:function(){return this.hasNavigator&&!!navigator.mediaDevices},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"canEnumerateDevices",{get:function(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"timeBetweenDecodingAttempts",{get:function(){return this._timeBetweenDecodingAttempts},set:function(t){this._timeBetweenDecodingAttempts=t<0?0:t},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"hints",{get:function(){return this._hints},set:function(t){this._hints=t||null},enumerable:!1,configurable:!0}),s.prototype.listVideoInputDevices=function(){return Nl(this,void 0,void 0,function(){var t,r,n,a,i,o,l,c,d,u,h,f;return wl(this,function(m){switch(m.label){case 0:if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:t=m.sent(),r=[];try{for(n=xde(t),a=n.next();!a.done;a=n.next())i=a.value,o=i.kind==="video"?"videoinput":i.kind,o==="videoinput"&&(l=i.deviceId||i.id,c=i.label||"Video device "+(r.length+1),d=i.groupId,u={deviceId:l,label:c,kind:o,groupId:d},r.push(u))}catch(p){h={error:p}}finally{try{a&&!a.done&&(f=n.return)&&f.call(n)}finally{if(h)throw h.error}}return[2,r]}})})},s.prototype.getVideoInputDevices=function(){return Nl(this,void 0,void 0,function(){var t;return wl(this,function(r){switch(r.label){case 0:return[4,this.listVideoInputDevices()];case 1:return t=r.sent(),[2,t.map(function(n){return new fde(n.deviceId,n.label)})]}})})},s.prototype.findDeviceById=function(t){return Nl(this,void 0,void 0,function(){var r;return wl(this,function(n){switch(n.label){case 0:return[4,this.listVideoInputDevices()];case 1:return r=n.sent(),r?[2,r.find(function(a){return a.deviceId===t})]:[2,null]}})})},s.prototype.decodeFromInputVideoDevice=function(t,r){return Nl(this,void 0,void 0,function(){return wl(this,function(n){switch(n.label){case 0:return[4,this.decodeOnceFromVideoDevice(t,r)];case 1:return[2,n.sent()]}})})},s.prototype.decodeOnceFromVideoDevice=function(t,r){return Nl(this,void 0,void 0,function(){var n,a;return wl(this,function(i){switch(i.label){case 0:return this.reset(),t?n={deviceId:{exact:t}}:n={facingMode:"environment"},a={video:n},[4,this.decodeOnceFromConstraints(a,r)];case 1:return[2,i.sent()]}})})},s.prototype.decodeOnceFromConstraints=function(t,r){return Nl(this,void 0,void 0,function(){var n;return wl(this,function(a){switch(a.label){case 0:return[4,navigator.mediaDevices.getUserMedia(t)];case 1:return n=a.sent(),[4,this.decodeOnceFromStream(n,r)];case 2:return[2,a.sent()]}})})},s.prototype.decodeOnceFromStream=function(t,r){return Nl(this,void 0,void 0,function(){var n,a;return wl(this,function(i){switch(i.label){case 0:return this.reset(),[4,this.attachStreamToVideo(t,r)];case 1:return n=i.sent(),[4,this.decodeOnce(n)];case 2:return a=i.sent(),[2,a]}})})},s.prototype.decodeFromInputVideoDeviceContinuously=function(t,r,n){return Nl(this,void 0,void 0,function(){return wl(this,function(a){switch(a.label){case 0:return[4,this.decodeFromVideoDevice(t,r,n)];case 1:return[2,a.sent()]}})})},s.prototype.decodeFromVideoDevice=function(t,r,n){return Nl(this,void 0,void 0,function(){var a,i;return wl(this,function(o){switch(o.label){case 0:return t?a={deviceId:{exact:t}}:a={facingMode:"environment"},i={video:a},[4,this.decodeFromConstraints(i,r,n)];case 1:return[2,o.sent()]}})})},s.prototype.decodeFromConstraints=function(t,r,n){return Nl(this,void 0,void 0,function(){var a;return wl(this,function(i){switch(i.label){case 0:return[4,navigator.mediaDevices.getUserMedia(t)];case 1:return a=i.sent(),[4,this.decodeFromStream(a,r,n)];case 2:return[2,i.sent()]}})})},s.prototype.decodeFromStream=function(t,r,n){return Nl(this,void 0,void 0,function(){var a;return wl(this,function(i){switch(i.label){case 0:return this.reset(),[4,this.attachStreamToVideo(t,r)];case 1:return a=i.sent(),[4,this.decodeContinuously(a,n)];case 2:return[2,i.sent()]}})})},s.prototype.stopAsyncDecode=function(){this._stopAsyncDecode=!0},s.prototype.stopContinuousDecode=function(){this._stopContinuousDecode=!0},s.prototype.attachStreamToVideo=function(t,r){return Nl(this,void 0,void 0,function(){var n;return wl(this,function(a){switch(a.label){case 0:return n=this.prepareVideoElement(r),this.addVideoSource(n,t),this.videoElement=n,this.stream=t,[4,this.playVideoOnLoadAsync(n)];case 1:return a.sent(),[2,n]}})})},s.prototype.playVideoOnLoadAsync=function(t){var r=this;return new Promise(function(n,a){return r.playVideoOnLoad(t,function(){return n()})})},s.prototype.playVideoOnLoad=function(t,r){var n=this;this.videoEndedListener=function(){return n.stopStreams()},this.videoCanPlayListener=function(){return n.tryPlayVideo(t)},t.addEventListener("ended",this.videoEndedListener),t.addEventListener("canplay",this.videoCanPlayListener),t.addEventListener("playing",r),this.tryPlayVideo(t)},s.prototype.isVideoPlaying=function(t){return t.currentTime>0&&!t.paused&&!t.ended&&t.readyState>2},s.prototype.tryPlayVideo=function(t){return Nl(this,void 0,void 0,function(){return wl(this,function(r){switch(r.label){case 0:if(this.isVideoPlaying(t))return console.warn("Trying to play video that is already playing."),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.play()];case 2:return r.sent(),[3,4];case 3:return r.sent(),console.warn("It was not possible to play the video."),[3,4];case 4:return[2]}})})},s.prototype.getMediaElement=function(t,r){var n=document.getElementById(t);if(!n)throw new Li("element with id '"+t+"' not found");if(n.nodeName.toLowerCase()!==r.toLowerCase())throw new Li("element with id '"+t+"' must be an "+r+" element");return n},s.prototype.decodeFromImage=function(t,r){if(!t&&!r)throw new Li("either imageElement with a src set or an url must be provided");return r&&!t?this.decodeFromImageUrl(r):this.decodeFromImageElement(t)},s.prototype.decodeFromVideo=function(t,r){if(!t&&!r)throw new Li("Either an element with a src set or an URL must be provided");return r&&!t?this.decodeFromVideoUrl(r):this.decodeFromVideoElement(t)},s.prototype.decodeFromVideoContinuously=function(t,r,n){if(t===void 0&&r===void 0)throw new Li("Either an element with a src set or an URL must be provided");return r&&!t?this.decodeFromVideoUrlContinuously(r,n):this.decodeFromVideoElementContinuously(t,n)},s.prototype.decodeFromImageElement=function(t){if(!t)throw new Li("An image element must be provided.");this.reset();var r=this.prepareImageElement(t);this.imageElement=r;var n;return this.isImageLoaded(r)?n=this.decodeOnce(r,!1,!0):n=this._decodeOnLoadImage(r),n},s.prototype.decodeFromVideoElement=function(t){var r=this._decodeFromVideoElementSetup(t);return this._decodeOnLoadVideo(r)},s.prototype.decodeFromVideoElementContinuously=function(t,r){var n=this._decodeFromVideoElementSetup(t);return this._decodeOnLoadVideoContinuously(n,r)},s.prototype._decodeFromVideoElementSetup=function(t){if(!t)throw new Li("A video element must be provided.");this.reset();var r=this.prepareVideoElement(t);return this.videoElement=r,r},s.prototype.decodeFromImageUrl=function(t){if(!t)throw new Li("An URL must be provided.");this.reset();var r=this.prepareImageElement();this.imageElement=r;var n=this._decodeOnLoadImage(r);return r.src=t,n},s.prototype.decodeFromVideoUrl=function(t){if(!t)throw new Li("An URL must be provided.");this.reset();var r=this.prepareVideoElement(),n=this.decodeFromVideoElement(r);return r.src=t,n},s.prototype.decodeFromVideoUrlContinuously=function(t,r){if(!t)throw new Li("An URL must be provided.");this.reset();var n=this.prepareVideoElement(),a=this.decodeFromVideoElementContinuously(n,r);return n.src=t,a},s.prototype._decodeOnLoadImage=function(t){var r=this;return new Promise(function(n,a){r.imageLoadedListener=function(){return r.decodeOnce(t,!1,!0).then(n,a)},t.addEventListener("load",r.imageLoadedListener)})},s.prototype._decodeOnLoadVideo=function(t){return Nl(this,void 0,void 0,function(){return wl(this,function(r){switch(r.label){case 0:return[4,this.playVideoOnLoadAsync(t)];case 1:return r.sent(),[4,this.decodeOnce(t)];case 2:return[2,r.sent()]}})})},s.prototype._decodeOnLoadVideoContinuously=function(t,r){return Nl(this,void 0,void 0,function(){return wl(this,function(n){switch(n.label){case 0:return[4,this.playVideoOnLoadAsync(t)];case 1:return n.sent(),this.decodeContinuously(t,r),[2]}})})},s.prototype.isImageLoaded=function(t){return!(!t.complete||t.naturalWidth===0)},s.prototype.prepareImageElement=function(t){var r;return typeof t>"u"&&(r=document.createElement("img"),r.width=200,r.height=200),typeof t=="string"&&(r=this.getMediaElement(t,"img")),t instanceof HTMLImageElement&&(r=t),r},s.prototype.prepareVideoElement=function(t){var r;return!t&&typeof document<"u"&&(r=document.createElement("video"),r.width=200,r.height=200),typeof t=="string"&&(r=this.getMediaElement(t,"video")),t instanceof HTMLVideoElement&&(r=t),r.setAttribute("autoplay","true"),r.setAttribute("muted","true"),r.setAttribute("playsinline","true"),r},s.prototype.decodeOnce=function(t,r,n){var a=this;r===void 0&&(r=!0),n===void 0&&(n=!0),this._stopAsyncDecode=!1;var i=function(o,l){if(a._stopAsyncDecode){l(new es("Video stream has ended before any code could be detected.")),a._stopAsyncDecode=void 0;return}try{var c=a.decode(t);o(c)}catch(f){var d=r&&f instanceof es,u=f instanceof no||f instanceof Ls,h=u&&n;if(d||h)return setTimeout(i,a._timeBetweenDecodingAttempts,o,l);l(f)}};return new Promise(function(o,l){return i(o,l)})},s.prototype.decodeContinuously=function(t,r){var n=this;this._stopContinuousDecode=!1;var a=function(){if(n._stopContinuousDecode){n._stopContinuousDecode=void 0;return}try{var i=n.decode(t);r(i,null),setTimeout(a,n.timeBetweenScansMillis)}catch(c){r(null,c);var o=c instanceof no||c instanceof Ls,l=c instanceof es;(o||l)&&setTimeout(a,n._timeBetweenDecodingAttempts)}};a()},s.prototype.decode=function(t){var r=this.createBinaryBitmap(t);return this.decodeBitmap(r)},s.prototype.createBinaryBitmap=function(t){this.getCaptureCanvasContext(t);var r=!1;t instanceof HTMLVideoElement?(this.drawFrameOnCanvas(t),r=!0):this.drawImageOnCanvas(t);var n=this.getCaptureCanvas(t),a=new mde(n,r),i=new _9(a);return new P9(i)},s.prototype.getCaptureCanvasContext=function(t){if(!this.captureCanvasContext){var r=this.getCaptureCanvas(t),n=void 0;try{n=r.getContext("2d",{willReadFrequently:!0})}catch{n=r.getContext("2d")}this.captureCanvasContext=n}return this.captureCanvasContext},s.prototype.getCaptureCanvas=function(t){if(!this.captureCanvas){var r=this.createCaptureCanvas(t);this.captureCanvas=r}return this.captureCanvas},s.prototype.drawFrameOnCanvas=function(t,r,n){r===void 0&&(r={sx:0,sy:0,sWidth:t.videoWidth,sHeight:t.videoHeight,dx:0,dy:0,dWidth:t.videoWidth,dHeight:t.videoHeight}),n===void 0&&(n=this.captureCanvasContext),n.drawImage(t,r.sx,r.sy,r.sWidth,r.sHeight,r.dx,r.dy,r.dWidth,r.dHeight)},s.prototype.drawImageOnCanvas=function(t,r,n){r===void 0&&(r={sx:0,sy:0,sWidth:t.naturalWidth,sHeight:t.naturalHeight,dx:0,dy:0,dWidth:t.naturalWidth,dHeight:t.naturalHeight}),n===void 0&&(n=this.captureCanvasContext),n.drawImage(t,r.sx,r.sy,r.sWidth,r.sHeight,r.dx,r.dy,r.dWidth,r.dHeight)},s.prototype.decodeBitmap=function(t){return this.reader.decode(t,this._hints)},s.prototype.createCaptureCanvas=function(t){if(typeof document>"u")return this._destroyCaptureCanvas(),null;var r=document.createElement("canvas"),n,a;return typeof t<"u"&&(t instanceof HTMLVideoElement?(n=t.videoWidth,a=t.videoHeight):t instanceof HTMLImageElement&&(n=t.naturalWidth||t.width,a=t.naturalHeight||t.height)),r.style.width=n+"px",r.style.height=a+"px",r.width=n,r.height=a,r},s.prototype.stopStreams=function(){this.stream&&(this.stream.getVideoTracks().forEach(function(t){return t.stop()}),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()},s.prototype.reset=function(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()},s.prototype._destroyVideoElement=function(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)},s.prototype._destroyImageElement=function(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)},s.prototype._destroyCaptureCanvas=function(){this.captureCanvasContext=void 0,this.captureCanvas=void 0},s.prototype.addVideoSource=function(t,r){try{t.srcObject=r}catch{t.src=URL.createObjectURL(r)}},s.prototype.cleanVideoSource=function(t){try{t.srcObject=null}catch{t.src=""}this.videoElement.removeAttribute("src")},s}(),xl=function(){function s(t,r,n,a,i,o){n===void 0&&(n=r==null?0:8*r.length),o===void 0&&(o=ei.currentTimeMillis()),this.text=t,this.rawBytes=r,this.numBits=n,this.resultPoints=a,this.format=i,this.timestamp=o,this.text=t,this.rawBytes=r,n==null?this.numBits=r==null?0:8*r.length:this.numBits=n,this.resultPoints=a,this.format=i,this.resultMetadata=null,o==null?this.timestamp=ei.currentTimeMillis():this.timestamp=o}return s.prototype.getText=function(){return this.text},s.prototype.getRawBytes=function(){return this.rawBytes},s.prototype.getNumBits=function(){return this.numBits},s.prototype.getResultPoints=function(){return this.resultPoints},s.prototype.getBarcodeFormat=function(){return this.format},s.prototype.getResultMetadata=function(){return this.resultMetadata},s.prototype.putMetadata=function(t,r){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(t,r)},s.prototype.putAllMetadata=function(t){t!==null&&(this.resultMetadata===null?this.resultMetadata=t:this.resultMetadata=new Map(t))},s.prototype.addResultPoints=function(t){var r=this.resultPoints;if(r===null)this.resultPoints=t;else if(t!==null&&t.length>0){var n=new Array(r.length+t.length);ei.arraycopy(r,0,n,0,r.length),ei.arraycopy(t,0,n,r.length,t.length),this.resultPoints=n}},s.prototype.getTimestamp=function(){return this.timestamp},s.prototype.toString=function(){return this.text},s}(),p4;(function(s){s[s.AZTEC=0]="AZTEC",s[s.CODABAR=1]="CODABAR",s[s.CODE_39=2]="CODE_39",s[s.CODE_93=3]="CODE_93",s[s.CODE_128=4]="CODE_128",s[s.DATA_MATRIX=5]="DATA_MATRIX",s[s.EAN_8=6]="EAN_8",s[s.EAN_13=7]="EAN_13",s[s.ITF=8]="ITF",s[s.MAXICODE=9]="MAXICODE",s[s.PDF_417=10]="PDF_417",s[s.QR_CODE=11]="QR_CODE",s[s.RSS_14=12]="RSS_14",s[s.RSS_EXPANDED=13]="RSS_EXPANDED",s[s.UPC_A=14]="UPC_A",s[s.UPC_E=15]="UPC_E",s[s.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(p4||(p4={}));const Dr=p4;var g4;(function(s){s[s.OTHER=0]="OTHER",s[s.ORIENTATION=1]="ORIENTATION",s[s.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",s[s.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",s[s.ISSUE_NUMBER=4]="ISSUE_NUMBER",s[s.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",s[s.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",s[s.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",s[s.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",s[s.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",s[s.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(g4||(g4={}));const Xo=g4;var NN=function(){function s(t,r,n,a,i,o){i===void 0&&(i=-1),o===void 0&&(o=-1),this.rawBytes=t,this.text=r,this.byteSegments=n,this.ecLevel=a,this.structuredAppendSequenceNumber=i,this.structuredAppendParity=o,this.numBits=t==null?0:8*t.length}return s.prototype.getRawBytes=function(){return this.rawBytes},s.prototype.getNumBits=function(){return this.numBits},s.prototype.setNumBits=function(t){this.numBits=t},s.prototype.getText=function(){return this.text},s.prototype.getByteSegments=function(){return this.byteSegments},s.prototype.getECLevel=function(){return this.ecLevel},s.prototype.getErrorsCorrected=function(){return this.errorsCorrected},s.prototype.setErrorsCorrected=function(t){this.errorsCorrected=t},s.prototype.getErasures=function(){return this.erasures},s.prototype.setErasures=function(t){this.erasures=t},s.prototype.getOther=function(){return this.other},s.prototype.setOther=function(t){this.other=t},s.prototype.hasStructuredAppend=function(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0},s.prototype.getStructuredAppendParity=function(){return this.structuredAppendParity},s.prototype.getStructuredAppendSequenceNumber=function(){return this.structuredAppendSequenceNumber},s}(),w0=function(){function s(){}return s.prototype.exp=function(t){return this.expTable[t]},s.prototype.log=function(t){if(t===0)throw new Or;return this.logTable[t]},s.addOrSubtract=function(t,r){return t^r},s}(),Im=function(){function s(t,r){if(r.length===0)throw new Or;this.field=t;var n=r.length;if(n>1&&r[0]===0){for(var a=1;a<n&&r[a]===0;)a++;a===n?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(n-a),ei.arraycopy(r,a,this.coefficients,0,this.coefficients.length))}else this.coefficients=r}return s.prototype.getCoefficients=function(){return this.coefficients},s.prototype.getDegree=function(){return this.coefficients.length-1},s.prototype.isZero=function(){return this.coefficients[0]===0},s.prototype.getCoefficient=function(t){return this.coefficients[this.coefficients.length-1-t]},s.prototype.evaluateAt=function(t){if(t===0)return this.getCoefficient(0);var r=this.coefficients,n;if(t===1){n=0;for(var a=0,i=r.length;a!==i;a++){var o=r[a];n=w0.addOrSubtract(n,o)}return n}n=r[0];for(var l=r.length,c=this.field,a=1;a<l;a++)n=w0.addOrSubtract(c.multiply(t,n),r[a]);return n},s.prototype.addOrSubtract=function(t){if(!this.field.equals(t.field))throw new Or("GenericGFPolys do not have same GenericGF field");if(this.isZero())return t;if(t.isZero())return this;var r=this.coefficients,n=t.coefficients;if(r.length>n.length){var a=r;r=n,n=a}var i=new Int32Array(n.length),o=n.length-r.length;ei.arraycopy(n,0,i,0,o);for(var l=o;l<n.length;l++)i[l]=w0.addOrSubtract(r[l-o],n[l]);return new s(this.field,i)},s.prototype.multiply=function(t){if(!this.field.equals(t.field))throw new Or("GenericGFPolys do not have same GenericGF field");if(this.isZero()||t.isZero())return this.field.getZero();for(var r=this.coefficients,n=r.length,a=t.coefficients,i=a.length,o=new Int32Array(n+i-1),l=this.field,c=0;c<n;c++)for(var d=r[c],u=0;u<i;u++)o[c+u]=w0.addOrSubtract(o[c+u],l.multiply(d,a[u]));return new s(l,o)},s.prototype.multiplyScalar=function(t){if(t===0)return this.field.getZero();if(t===1)return this;for(var r=this.coefficients.length,n=this.field,a=new Int32Array(r),i=this.coefficients,o=0;o<r;o++)a[o]=n.multiply(i[o],t);return new s(n,a)},s.prototype.multiplyByMonomial=function(t,r){if(t<0)throw new Or;if(r===0)return this.field.getZero();for(var n=this.coefficients,a=n.length,i=new Int32Array(a+t),o=this.field,l=0;l<a;l++)i[l]=o.multiply(n[l],r);return new s(o,i)},s.prototype.divide=function(t){if(!this.field.equals(t.field))throw new Or("GenericGFPolys do not have same GenericGF field");if(t.isZero())throw new Or("Divide by 0");for(var r=this.field,n=r.getZero(),a=this,i=t.getCoefficient(t.getDegree()),o=r.inverse(i);a.getDegree()>=t.getDegree()&&!a.isZero();){var l=a.getDegree()-t.getDegree(),c=r.multiply(a.getCoefficient(a.getDegree()),o),d=t.multiplyByMonomial(l,c),u=r.buildMonomial(l,c);n=n.addOrSubtract(u),a=a.addOrSubtract(d)}return[n,a]},s.prototype.toString=function(){for(var t="",r=this.getDegree();r>=0;r--){var n=this.getCoefficient(r);if(n!==0){if(n<0?(t+=" - ",n=-n):t.length>0&&(t+=" + "),r===0||n!==1){var a=this.field.log(n);a===0?t+="1":a===1?t+="a":(t+="a^",t+=a)}r!==0&&(r===1?t+="x":(t+="x^",t+=r))}}return t},s}(),pde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),k9=function(s){pde(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.kind="ArithmeticException",t}(lc),gde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ec=function(s){gde(t,s);function t(r,n,a){var i=s.call(this)||this;i.primitive=r,i.size=n,i.generatorBase=a;for(var o=new Int32Array(n),l=1,c=0;c<n;c++)o[c]=l,l*=2,l>=n&&(l^=r,l&=n-1);i.expTable=o;for(var d=new Int32Array(n),c=0;c<n-1;c++)d[o[c]]=c;return i.logTable=d,i.zero=new Im(i,Int32Array.from([0])),i.one=new Im(i,Int32Array.from([1])),i}return t.prototype.getZero=function(){return this.zero},t.prototype.getOne=function(){return this.one},t.prototype.buildMonomial=function(r,n){if(r<0)throw new Or;if(n===0)return this.zero;var a=new Int32Array(r+1);return a[0]=n,new Im(this,a)},t.prototype.inverse=function(r){if(r===0)throw new k9;return this.expTable[this.size-this.logTable[r]-1]},t.prototype.multiply=function(r,n){return r===0||n===0?0:this.expTable[(this.logTable[r]+this.logTable[n])%(this.size-1)]},t.prototype.getSize=function(){return this.size},t.prototype.getGeneratorBase=function(){return this.generatorBase},t.prototype.toString=function(){return"GF(0x"+_n.toHexString(this.primitive)+","+this.size+")"},t.prototype.equals=function(r){return r===this},t.AZTEC_DATA_12=new t(4201,4096,1),t.AZTEC_DATA_10=new t(1033,1024,1),t.AZTEC_DATA_6=new t(67,64,1),t.AZTEC_PARAM=new t(19,16,1),t.QR_CODE_FIELD_256=new t(285,256,0),t.DATA_MATRIX_FIELD_256=new t(301,256,1),t.AZTEC_DATA_8=t.DATA_MATRIX_FIELD_256,t.MAXICODE_FIELD_64=t.AZTEC_DATA_6,t}(w0),vde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),hj=function(s){vde(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.kind="ReedSolomonException",t}(lc),yde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),hy=function(s){yde(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.kind="IllegalStateException",t}(lc),wN=function(){function s(t){this.field=t}return s.prototype.decode=function(t,r){for(var n=this.field,a=new Im(n,t),i=new Int32Array(r),o=!0,l=0;l<r;l++){var c=a.evaluateAt(n.exp(l+n.getGeneratorBase()));i[i.length-1-l]=c,c!==0&&(o=!1)}if(!o)for(var d=new Im(n,i),u=this.runEuclideanAlgorithm(n.buildMonomial(r,1),d,r),h=u[0],f=u[1],m=this.findErrorLocations(h),p=this.findErrorMagnitudes(f,m),l=0;l<m.length;l++){var g=t.length-1-n.log(m[l]);if(g<0)throw new hj("Bad error location");t[g]=ec.addOrSubtract(t[g],p[l])}},s.prototype.runEuclideanAlgorithm=function(t,r,n){if(t.getDegree()<r.getDegree()){var a=t;t=r,r=a}for(var i=this.field,o=t,l=r,c=i.getZero(),d=i.getOne();l.getDegree()>=(n/2|0);){var u=o,h=c;if(o=l,c=d,o.isZero())throw new hj("r_{i-1} was zero");l=u;for(var f=i.getZero(),m=o.getCoefficient(o.getDegree()),p=i.inverse(m);l.getDegree()>=o.getDegree()&&!l.isZero();){var g=l.getDegree()-o.getDegree(),v=i.multiply(l.getCoefficient(l.getDegree()),p);f=f.addOrSubtract(i.buildMonomial(g,v)),l=l.addOrSubtract(o.multiplyByMonomial(g,v))}if(d=f.multiply(c).addOrSubtract(h),l.getDegree()>=o.getDegree())throw new hy("Division algorithm failed to reduce polynomial?")}var y=d.getCoefficient(0);if(y===0)throw new hj("sigmaTilde(0) was zero");var j=i.inverse(y),b=d.multiplyScalar(j),w=l.multiplyScalar(j);return[b,w]},s.prototype.findErrorLocations=function(t){var r=t.getDegree();if(r===1)return Int32Array.from([t.getCoefficient(1)]);for(var n=new Int32Array(r),a=0,i=this.field,o=1;o<i.getSize()&&a<r;o++)t.evaluateAt(o)===0&&(n[a]=i.inverse(o),a++);if(a!==r)throw new hj("Error locator degree does not match number of roots");return n},s.prototype.findErrorMagnitudes=function(t,r){for(var n=r.length,a=new Int32Array(n),i=this.field,o=0;o<n;o++){for(var l=i.inverse(r[o]),c=1,d=0;d<n;d++)if(o!==d){var u=i.multiply(r[d],l),h=u&1?u&-2:u|1;c=i.multiply(c,h)}a[o]=i.multiply(t.evaluateAt(l),i.inverse(c)),i.getGeneratorBase()!==0&&(a[o]=i.multiply(a[o],l))}return a},s}(),Ko;(function(s){s[s.UPPER=0]="UPPER",s[s.LOWER=1]="LOWER",s[s.MIXED=2]="MIXED",s[s.DIGIT=3]="DIGIT",s[s.PUNCT=4]="PUNCT",s[s.BINARY=5]="BINARY"})(Ko||(Ko={}));var gk=function(){function s(){}return s.prototype.decode=function(t){this.ddata=t;var r=t.getBits(),n=this.extractBits(r),a=this.correctBits(n),i=s.convertBoolArrayToByteArray(a),o=s.getEncodedData(a),l=new NN(i,o,null,null);return l.setNumBits(a.length),l},s.highLevelDecode=function(t){return this.getEncodedData(t)},s.getEncodedData=function(t){for(var r=t.length,n=Ko.UPPER,a=Ko.UPPER,i="",o=0;o<r;)if(a===Ko.BINARY){if(r-o<5)break;var l=s.readCode(t,o,5);if(o+=5,l===0){if(r-o<11)break;l=s.readCode(t,o,11)+31,o+=11}for(var c=0;c<l;c++){if(r-o<8){o=r;break}var d=s.readCode(t,o,8);i+=Gn.castAsNonUtf8Char(d),o+=8}a=n}else{var u=a===Ko.DIGIT?4:5;if(r-o<u)break;var d=s.readCode(t,o,u);o+=u;var h=s.getCharacter(a,d);h.startsWith("CTRL_")?(n=a,a=s.getTable(h.charAt(5)),h.charAt(6)==="L"&&(n=a)):(i+=h,a=n)}return i},s.getTable=function(t){switch(t){case"L":return Ko.LOWER;case"P":return Ko.PUNCT;case"M":return Ko.MIXED;case"D":return Ko.DIGIT;case"B":return Ko.BINARY;case"U":default:return Ko.UPPER}},s.getCharacter=function(t,r){switch(t){case Ko.UPPER:return s.UPPER_TABLE[r];case Ko.LOWER:return s.LOWER_TABLE[r];case Ko.MIXED:return s.MIXED_TABLE[r];case Ko.PUNCT:return s.PUNCT_TABLE[r];case Ko.DIGIT:return s.DIGIT_TABLE[r];default:throw new hy("Bad table")}},s.prototype.correctBits=function(t){var r,n;this.ddata.getNbLayers()<=2?(n=6,r=ec.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(n=8,r=ec.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(n=10,r=ec.AZTEC_DATA_10):(n=12,r=ec.AZTEC_DATA_12);var a=this.ddata.getNbDatablocks(),i=t.length/n;if(i<a)throw new Ls;for(var o=t.length%n,l=new Int32Array(i),c=0;c<i;c++,o+=n)l[c]=s.readCode(t,o,n);try{var d=new wN(r);d.decode(l,i-a)}catch(v){throw new Ls(v)}for(var u=(1<<n)-1,h=0,c=0;c<a;c++){var f=l[c];if(f===0||f===u)throw new Ls;(f===1||f===u-1)&&h++}for(var m=new Array(a*n-h),p=0,c=0;c<a;c++){var f=l[c];if(f===1||f===u-1)m.fill(f>1,p,p+n-1),p+=n-1;else for(var g=n-1;g>=0;--g)m[p++]=(f&1<<g)!==0}return m},s.prototype.extractBits=function(t){var r=this.ddata.isCompact(),n=this.ddata.getNbLayers(),a=(r?11:14)+n*4,i=new Int32Array(a),o=new Array(this.totalBitsInLayer(n,r));if(r)for(var l=0;l<i.length;l++)i[l]=l;else for(var c=a+1+2*_n.truncDivision(_n.truncDivision(a,2)-1,15),d=a/2,u=_n.truncDivision(c,2),l=0;l<d;l++){var h=l+_n.truncDivision(l,15);i[d-l-1]=u-h-1,i[d+l]=u+h+1}for(var l=0,f=0;l<n;l++){for(var m=(n-l)*4+(r?9:12),p=l*2,g=a-1-p,v=0;v<m;v++)for(var y=v*2,j=0;j<2;j++)o[f+y+j]=t.get(i[p+j],i[p+v]),o[f+2*m+y+j]=t.get(i[p+v],i[g-j]),o[f+4*m+y+j]=t.get(i[g-j],i[g-v]),o[f+6*m+y+j]=t.get(i[g-v],i[p+j]);f+=m*8}return o},s.readCode=function(t,r,n){for(var a=0,i=r;i<r+n;i++)a<<=1,t[i]&&(a|=1);return a},s.readByte=function(t,r){var n=t.length-r;return n>=8?s.readCode(t,r,8):s.readCode(t,r,n)<<8-n},s.convertBoolArrayToByteArray=function(t){for(var r=new Uint8Array((t.length+7)/8),n=0;n<r.length;n++)r[n]=s.readByte(t,8*n);return r},s.prototype.totalBitsInLayer=function(t,r){return((r?88:112)+16*t)*t},s.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],s.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],s.MIXED_TABLE=["CTRL_PS"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~","","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],s.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],s.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"],s}(),ea=function(){function s(){}return s.round=function(t){return isNaN(t)?0:t<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:t>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:t+(t<0?-.5:.5)|0},s.distance=function(t,r,n,a){var i=t-n,o=r-a;return Math.sqrt(i*i+o*o)},s.sum=function(t){for(var r=0,n=0,a=t.length;n!==a;n++){var i=t[n];r+=i}return r},s}(),v4=function(){function s(){}return s.floatToIntBits=function(t){return t},s.MAX_VALUE=Number.MAX_SAFE_INTEGER,s}(),ur=function(){function s(t,r){this.x=t,this.y=r}return s.prototype.getX=function(){return this.x},s.prototype.getY=function(){return this.y},s.prototype.equals=function(t){if(t instanceof s){var r=t;return this.x===r.x&&this.y===r.y}return!1},s.prototype.hashCode=function(){return 31*v4.floatToIntBits(this.x)+v4.floatToIntBits(this.y)},s.prototype.toString=function(){return"("+this.x+","+this.y+")"},s.orderBestPatterns=function(t){var r=this.distance(t[0],t[1]),n=this.distance(t[1],t[2]),a=this.distance(t[0],t[2]),i,o,l;if(n>=r&&n>=a?(o=t[0],i=t[1],l=t[2]):a>=n&&a>=r?(o=t[1],i=t[0],l=t[2]):(o=t[2],i=t[0],l=t[1]),this.crossProductZ(i,o,l)<0){var c=i;i=l,l=c}t[0]=i,t[1]=o,t[2]=l},s.distance=function(t,r){return ea.distance(t.x,t.y,r.x,r.y)},s.crossProductZ=function(t,r,n){var a=r.x,i=r.y;return(n.x-a)*(t.y-i)-(n.y-i)*(t.x-a)},s}(),S3=function(){function s(t,r){this.bits=t,this.points=r}return s.prototype.getBits=function(){return this.bits},s.prototype.getPoints=function(){return this.points},s}(),jde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),bde=function(s){jde(t,s);function t(r,n,a,i,o){var l=s.call(this,r,n)||this;return l.compact=a,l.nbDatablocks=i,l.nbLayers=o,l}return t.prototype.getNbLayers=function(){return this.nbLayers},t.prototype.getNbDatablocks=function(){return this.nbDatablocks},t.prototype.isCompact=function(){return this.compact},t}(S3),y4=function(){function s(t,r,n,a){this.image=t,this.height=t.getHeight(),this.width=t.getWidth(),r==null&&(r=s.INIT_SIZE),n==null&&(n=t.getWidth()/2|0),a==null&&(a=t.getHeight()/2|0);var i=r/2|0;if(this.leftInit=n-i,this.rightInit=n+i,this.upInit=a-i,this.downInit=a+i,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new es}return s.prototype.detect=function(){for(var t=this.leftInit,r=this.rightInit,n=this.upInit,a=this.downInit,i=!1,o=!0,l=!1,c=!1,d=!1,u=!1,h=!1,f=this.width,m=this.height;o;){o=!1;for(var p=!0;(p||!c)&&r<f;)p=this.containsBlackPoint(n,a,r,!1),p?(r++,o=!0,c=!0):c||r++;if(r>=f){i=!0;break}for(var g=!0;(g||!d)&&a<m;)g=this.containsBlackPoint(t,r,a,!0),g?(a++,o=!0,d=!0):d||a++;if(a>=m){i=!0;break}for(var v=!0;(v||!u)&&t>=0;)v=this.containsBlackPoint(n,a,t,!1),v?(t--,o=!0,u=!0):u||t--;if(t<0){i=!0;break}for(var y=!0;(y||!h)&&n>=0;)y=this.containsBlackPoint(t,r,n,!0),y?(n--,o=!0,h=!0):h||n--;if(n<0){i=!0;break}o&&(l=!0)}if(!i&&l){for(var j=r-t,b=null,w=1;b===null&&w<j;w++)b=this.getBlackPointOnSegment(t,a-w,t+w,a);if(b==null)throw new es;for(var N=null,w=1;N===null&&w<j;w++)N=this.getBlackPointOnSegment(t,n+w,t+w,n);if(N==null)throw new es;for(var C=null,w=1;C===null&&w<j;w++)C=this.getBlackPointOnSegment(r,n+w,r-w,n);if(C==null)throw new es;for(var S=null,w=1;S===null&&w<j;w++)S=this.getBlackPointOnSegment(r,a-w,r-w,a);if(S==null)throw new es;return this.centerEdges(S,b,C,N)}else throw new es},s.prototype.getBlackPointOnSegment=function(t,r,n,a){for(var i=ea.round(ea.distance(t,r,n,a)),o=(n-t)/i,l=(a-r)/i,c=this.image,d=0;d<i;d++){var u=ea.round(t+d*o),h=ea.round(r+d*l);if(c.get(u,h))return new ur(u,h)}return null},s.prototype.centerEdges=function(t,r,n,a){var i=t.getX(),o=t.getY(),l=r.getX(),c=r.getY(),d=n.getX(),u=n.getY(),h=a.getX(),f=a.getY(),m=s.CORR;return i<this.width/2?[new ur(h-m,f+m),new ur(l+m,c+m),new ur(d-m,u-m),new ur(i+m,o-m)]:[new ur(h+m,f+m),new ur(l+m,c-m),new ur(d-m,u+m),new ur(i-m,o-m)]},s.prototype.containsBlackPoint=function(t,r,n,a){var i=this.image;if(a){for(var o=t;o<=r;o++)if(i.get(o,n))return!0}else for(var l=t;l<=r;l++)if(i.get(n,l))return!0;return!1},s.INIT_SIZE=10,s.CORR=1,s}(),vk=function(){function s(){}return s.checkAndNudgePoints=function(t,r){for(var n=t.getWidth(),a=t.getHeight(),i=!0,o=0;o<r.length&&i;o+=2){var l=Math.floor(r[o]),c=Math.floor(r[o+1]);if(l<-1||l>n||c<-1||c>a)throw new es;i=!1,l===-1?(r[o]=0,i=!0):l===n&&(r[o]=n-1,i=!0),c===-1?(r[o+1]=0,i=!0):c===a&&(r[o+1]=a-1,i=!0)}i=!0;for(var o=r.length-2;o>=0&&i;o-=2){var l=Math.floor(r[o]),c=Math.floor(r[o+1]);if(l<-1||l>n||c<-1||c>a)throw new es;i=!1,l===-1?(r[o]=0,i=!0):l===n&&(r[o]=n-1,i=!0),c===-1?(r[o+1]=0,i=!0):c===a&&(r[o+1]=a-1,i=!0)}},s}(),T9=function(){function s(t,r,n,a,i,o,l,c,d){this.a11=t,this.a21=r,this.a31=n,this.a12=a,this.a22=i,this.a32=o,this.a13=l,this.a23=c,this.a33=d}return s.quadrilateralToQuadrilateral=function(t,r,n,a,i,o,l,c,d,u,h,f,m,p,g,v){var y=s.quadrilateralToSquare(t,r,n,a,i,o,l,c),j=s.squareToQuadrilateral(d,u,h,f,m,p,g,v);return j.times(y)},s.prototype.transformPoints=function(t){for(var r=t.length,n=this.a11,a=this.a12,i=this.a13,o=this.a21,l=this.a22,c=this.a23,d=this.a31,u=this.a32,h=this.a33,f=0;f<r;f+=2){var m=t[f],p=t[f+1],g=i*m+c*p+h;t[f]=(n*m+o*p+d)/g,t[f+1]=(a*m+l*p+u)/g}},s.prototype.transformPointsWithValues=function(t,r){for(var n=this.a11,a=this.a12,i=this.a13,o=this.a21,l=this.a22,c=this.a23,d=this.a31,u=this.a32,h=this.a33,f=t.length,m=0;m<f;m++){var p=t[m],g=r[m],v=i*p+c*g+h;t[m]=(n*p+o*g+d)/v,r[m]=(a*p+l*g+u)/v}},s.squareToQuadrilateral=function(t,r,n,a,i,o,l,c){var d=t-n+i-l,u=r-a+o-c;if(d===0&&u===0)return new s(n-t,i-n,t,a-r,o-a,r,0,0,1);var h=n-i,f=l-i,m=a-o,p=c-o,g=h*p-f*m,v=(d*p-f*u)/g,y=(h*u-d*m)/g;return new s(n-t+v*n,l-t+y*l,t,a-r+v*a,c-r+y*c,r,v,y,1)},s.quadrilateralToSquare=function(t,r,n,a,i,o,l,c){return s.squareToQuadrilateral(t,r,n,a,i,o,l,c).buildAdjoint()},s.prototype.buildAdjoint=function(){return new s(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},s.prototype.times=function(t){return new s(this.a11*t.a11+this.a21*t.a12+this.a31*t.a13,this.a11*t.a21+this.a21*t.a22+this.a31*t.a23,this.a11*t.a31+this.a21*t.a32+this.a31*t.a33,this.a12*t.a11+this.a22*t.a12+this.a32*t.a13,this.a12*t.a21+this.a22*t.a22+this.a32*t.a23,this.a12*t.a31+this.a22*t.a32+this.a32*t.a33,this.a13*t.a11+this.a23*t.a12+this.a33*t.a13,this.a13*t.a21+this.a23*t.a22+this.a33*t.a23,this.a13*t.a31+this.a23*t.a32+this.a33*t.a33)},s}(),Nde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),wde=function(s){Nde(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.sampleGrid=function(r,n,a,i,o,l,c,d,u,h,f,m,p,g,v,y,j,b,w){var N=T9.quadrilateralToQuadrilateral(i,o,l,c,d,u,h,f,m,p,g,v,y,j,b,w);return this.sampleGridWithTransform(r,n,a,N)},t.prototype.sampleGridWithTransform=function(r,n,a,i){if(n<=0||a<=0)throw new es;for(var o=new fu(n,a),l=new Float32Array(2*n),c=0;c<a;c++){for(var d=l.length,u=c+.5,h=0;h<d;h+=2)l[h]=h/2+.5,l[h+1]=u;i.transformPoints(l),vk.checkAndNudgePoints(r,l);try{for(var h=0;h<d;h+=2)r.get(Math.floor(l[h]),Math.floor(l[h+1]))&&o.set(h/2,c)}catch{throw new es}}return o},t}(vk),C3=function(){function s(){}return s.setGridSampler=function(t){s.gridSampler=t},s.getInstance=function(){return s.gridSampler},s.gridSampler=new wde,s}(),Hl=function(){function s(t,r){this.x=t,this.y=r}return s.prototype.toResultPoint=function(){return new ur(this.getX(),this.getY())},s.prototype.getX=function(){return this.x},s.prototype.getY=function(){return this.y},s}(),Sde=function(){function s(t){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=t}return s.prototype.detect=function(){return this.detectMirror(!1)},s.prototype.detectMirror=function(t){var r=this.getMatrixCenter(),n=this.getBullsEyeCorners(r);if(t){var a=n[0];n[0]=n[2],n[2]=a}this.extractParameters(n);var i=this.sampleGrid(this.image,n[this.shift%4],n[(this.shift+1)%4],n[(this.shift+2)%4],n[(this.shift+3)%4]),o=this.getMatrixCornerPoints(n);return new bde(i,o,this.compact,this.nbDataBlocks,this.nbLayers)},s.prototype.extractParameters=function(t){if(!this.isValidPoint(t[0])||!this.isValidPoint(t[1])||!this.isValidPoint(t[2])||!this.isValidPoint(t[3]))throw new es;var r=2*this.nbCenterLayers,n=new Int32Array([this.sampleLine(t[0],t[1],r),this.sampleLine(t[1],t[2],r),this.sampleLine(t[2],t[3],r),this.sampleLine(t[3],t[0],r)]);this.shift=this.getRotation(n,r);for(var a=0,i=0;i<4;i++){var o=n[(this.shift+i)%4];this.compact?(a<<=7,a+=o>>1&127):(a<<=10,a+=(o>>2&992)+(o>>1&31))}var l=this.getCorrectedParameterData(a,this.compact);this.compact?(this.nbLayers=(l>>6)+1,this.nbDataBlocks=(l&63)+1):(this.nbLayers=(l>>11)+1,this.nbDataBlocks=(l&2047)+1)},s.prototype.getRotation=function(t,r){var n=0;t.forEach(function(i,o,l){var c=(i>>r-2<<1)+(i&1);n=(n<<3)+c}),n=((n&1)<<11)+(n>>1);for(var a=0;a<4;a++)if(_n.bitCount(n^this.EXPECTED_CORNER_BITS[a])<=2)return a;throw new es},s.prototype.getCorrectedParameterData=function(t,r){var n,a;r?(n=7,a=2):(n=10,a=4);for(var i=n-a,o=new Int32Array(n),l=n-1;l>=0;--l)o[l]=t&15,t>>=4;try{var c=new wN(ec.AZTEC_PARAM);c.decode(o,i)}catch{throw new es}for(var d=0,l=0;l<a;l++)d=(d<<4)+o[l];return d},s.prototype.getBullsEyeCorners=function(t){var r=t,n=t,a=t,i=t,o=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){var l=this.getFirstDifferent(r,o,1,-1),c=this.getFirstDifferent(n,o,1,1),d=this.getFirstDifferent(a,o,-1,1),u=this.getFirstDifferent(i,o,-1,-1);if(this.nbCenterLayers>2){var h=this.distancePoint(u,l)*this.nbCenterLayers/(this.distancePoint(i,r)*(this.nbCenterLayers+2));if(h<.75||h>1.25||!this.isWhiteOrBlackRectangle(l,c,d,u))break}r=l,n=c,a=d,i=u,o=!o}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new es;this.compact=this.nbCenterLayers===5;var f=new ur(r.getX()+.5,r.getY()-.5),m=new ur(n.getX()+.5,n.getY()+.5),p=new ur(a.getX()-.5,a.getY()+.5),g=new ur(i.getX()-.5,i.getY()-.5);return this.expandSquare([f,m,p,g],2*this.nbCenterLayers-3,2*this.nbCenterLayers)},s.prototype.getMatrixCenter=function(){var t,r,n,a;try{var i=new y4(this.image).detect();t=i[0],r=i[1],n=i[2],a=i[3]}catch{var o=this.image.getWidth()/2,l=this.image.getHeight()/2;t=this.getFirstDifferent(new Hl(o+7,l-7),!1,1,-1).toResultPoint(),r=this.getFirstDifferent(new Hl(o+7,l+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new Hl(o-7,l+7),!1,-1,1).toResultPoint(),a=this.getFirstDifferent(new Hl(o-7,l-7),!1,-1,-1).toResultPoint()}var c=ea.round((t.getX()+a.getX()+r.getX()+n.getX())/4),d=ea.round((t.getY()+a.getY()+r.getY()+n.getY())/4);try{var i=new y4(this.image,15,c,d).detect();t=i[0],r=i[1],n=i[2],a=i[3]}catch{t=this.getFirstDifferent(new Hl(c+7,d-7),!1,1,-1).toResultPoint(),r=this.getFirstDifferent(new Hl(c+7,d+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new Hl(c-7,d+7),!1,-1,1).toResultPoint(),a=this.getFirstDifferent(new Hl(c-7,d-7),!1,-1,-1).toResultPoint()}return c=ea.round((t.getX()+a.getX()+r.getX()+n.getX())/4),d=ea.round((t.getY()+a.getY()+r.getY()+n.getY())/4),new Hl(c,d)},s.prototype.getMatrixCornerPoints=function(t){return this.expandSquare(t,2*this.nbCenterLayers,this.getDimension())},s.prototype.sampleGrid=function(t,r,n,a,i){var o=C3.getInstance(),l=this.getDimension(),c=l/2-this.nbCenterLayers,d=l/2+this.nbCenterLayers;return o.sampleGrid(t,l,l,c,c,d,c,d,d,c,d,r.getX(),r.getY(),n.getX(),n.getY(),a.getX(),a.getY(),i.getX(),i.getY())},s.prototype.sampleLine=function(t,r,n){for(var a=0,i=this.distanceResultPoint(t,r),o=i/n,l=t.getX(),c=t.getY(),d=o*(r.getX()-t.getX())/i,u=o*(r.getY()-t.getY())/i,h=0;h<n;h++)this.image.get(ea.round(l+h*d),ea.round(c+h*u))&&(a|=1<<n-h-1);return a},s.prototype.isWhiteOrBlackRectangle=function(t,r,n,a){var i=3;t=new Hl(t.getX()-i,t.getY()+i),r=new Hl(r.getX()-i,r.getY()-i),n=new Hl(n.getX()+i,n.getY()-i),a=new Hl(a.getX()+i,a.getY()+i);var o=this.getColor(a,t);if(o===0)return!1;var l=this.getColor(t,r);return l!==o||(l=this.getColor(r,n),l!==o)?!1:(l=this.getColor(n,a),l===o)},s.prototype.getColor=function(t,r){for(var n=this.distancePoint(t,r),a=(r.getX()-t.getX())/n,i=(r.getY()-t.getY())/n,o=0,l=t.getX(),c=t.getY(),d=this.image.get(t.getX(),t.getY()),u=Math.ceil(n),h=0;h<u;h++)l+=a,c+=i,this.image.get(ea.round(l),ea.round(c))!==d&&o++;var f=o/n;return f>.1&&f<.9?0:f<=.1===d?1:-1},s.prototype.getFirstDifferent=function(t,r,n,a){for(var i=t.getX()+n,o=t.getY()+a;this.isValid(i,o)&&this.image.get(i,o)===r;)i+=n,o+=a;for(i-=n,o-=a;this.isValid(i,o)&&this.image.get(i,o)===r;)i+=n;for(i-=n;this.isValid(i,o)&&this.image.get(i,o)===r;)o+=a;return o-=a,new Hl(i,o)},s.prototype.expandSquare=function(t,r,n){var a=n/(2*r),i=t[0].getX()-t[2].getX(),o=t[0].getY()-t[2].getY(),l=(t[0].getX()+t[2].getX())/2,c=(t[0].getY()+t[2].getY())/2,d=new ur(l+a*i,c+a*o),u=new ur(l-a*i,c-a*o);i=t[1].getX()-t[3].getX(),o=t[1].getY()-t[3].getY(),l=(t[1].getX()+t[3].getX())/2,c=(t[1].getY()+t[3].getY())/2;var h=new ur(l+a*i,c+a*o),f=new ur(l-a*i,c-a*o),m=[d,h,u,f];return m},s.prototype.isValid=function(t,r){return t>=0&&t<this.image.getWidth()&&r>0&&r<this.image.getHeight()},s.prototype.isValidPoint=function(t){var r=ea.round(t.getX()),n=ea.round(t.getY());return this.isValid(r,n)},s.prototype.distancePoint=function(t,r){return ea.distance(t.getX(),t.getY(),r.getX(),r.getY())},s.prototype.distanceResultPoint=function(t,r){return ea.distance(t.getX(),t.getY(),r.getX(),r.getY())},s.prototype.getDimension=function(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(_n.truncDivision(this.nbLayers-4,8)+1)+15},s}(),A1=function(){function s(){}return s.prototype.decode=function(t,r){r===void 0&&(r=null);var n=null,a=new Sde(t.getBlackMatrix()),i=null,o=null;try{var l=a.detectMirror(!1);i=l.getPoints(),this.reportFoundResultPoints(r,i),o=new gk().decode(l)}catch(h){n=h}if(o==null)try{var l=a.detectMirror(!0);i=l.getPoints(),this.reportFoundResultPoints(r,i),o=new gk().decode(l)}catch(h){throw n??h}var c=new xl(o.getText(),o.getRawBytes(),o.getNumBits(),i,Dr.AZTEC,ei.currentTimeMillis()),d=o.getByteSegments();d!=null&&c.putMetadata(Xo.BYTE_SEGMENTS,d);var u=o.getECLevel();return u!=null&&c.putMetadata(Xo.ERROR_CORRECTION_LEVEL,u),c},s.prototype.reportFoundResultPoints=function(t,r){if(t!=null){var n=t.get(ti.NEED_RESULT_POINT_CALLBACK);n!=null&&r.forEach(function(a,i,o){n.foundPossibleResultPoint(a)})}},s.prototype.reset=function(){},s}(),Cde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(s){Cde(t,s);function t(r){return r===void 0&&(r=500),s.call(this,new A1,r)||this}return t})(Sg);var Co=function(){function s(){}return s.prototype.decode=function(t,r){try{return this.doDecode(t,r)}catch{var n=r&&r.get(ti.TRY_HARDER)===!0;if(n&&t.isRotateSupported()){var a=t.rotateCounterClockwise(),i=this.doDecode(a,r),o=i.getResultMetadata(),l=270;o!==null&&o.get(Xo.ORIENTATION)===!0&&(l=l+o.get(Xo.ORIENTATION)%360),i.putMetadata(Xo.ORIENTATION,l);var c=i.getResultPoints();if(c!==null)for(var d=a.getHeight(),u=0;u<c.length;u++)c[u]=new ur(d-c[u].getY()-1,c[u].getX());return i}else throw new es}},s.prototype.reset=function(){},s.prototype.doDecode=function(t,r){var n=t.getWidth(),a=t.getHeight(),i=new Bo(n),o=r&&r.get(ti.TRY_HARDER)===!0,l=Math.max(1,a>>(o?8:5)),c;o?c=a:c=15;for(var d=Math.trunc(a/2),u=0;u<c;u++){var h=Math.trunc((u+1)/2),f=(u&1)===0,m=d+l*(f?h:-h);if(m<0||m>=a)break;try{i=t.getBlackRow(m,i)}catch{continue}for(var p=function(j){if(j===1&&(i.reverse(),r&&r.get(ti.NEED_RESULT_POINT_CALLBACK)===!0)){var b=new Map;r.forEach(function(C,S){return b.set(S,C)}),b.delete(ti.NEED_RESULT_POINT_CALLBACK),r=b}try{var w=g.decodeRow(m,i,r);if(j===1){w.putMetadata(Xo.ORIENTATION,180);var N=w.getResultPoints();N!==null&&(N[0]=new ur(n-N[0].getX()-1,N[0].getY()),N[1]=new ur(n-N[1].getX()-1,N[1].getY()))}return{value:w}}catch{}},g=this,v=0;v<2;v++){var y=p(v);if(typeof y=="object")return y.value}}throw new es},s.recordPattern=function(t,r,n){for(var a=n.length,i=0;i<a;i++)n[i]=0;var o=t.getSize();if(r>=o)throw new es;for(var l=!t.get(r),c=0,d=r;d<o;){if(t.get(d)!==l)n[c]++;else{if(++c===a)break;n[c]=1,l=!l}d++}if(!(c===a||c===a-1&&d===o))throw new es},s.recordPatternInReverse=function(t,r,n){for(var a=n.length,i=t.get(r);r>0&&a>=0;)t.get(--r)!==i&&(a--,i=!i);if(a>=0)throw new es;s.recordPattern(t,r+1,n)},s.patternMatchVariance=function(t,r,n){for(var a=t.length,i=0,o=0,l=0;l<a;l++)i+=t[l],o+=r[l];if(i<o)return Number.POSITIVE_INFINITY;var c=i/o;n*=c;for(var d=0,u=0;u<a;u++){var h=t[u],f=r[u]*c,m=h>f?h-f:f-h;if(m>n)return Number.POSITIVE_INFINITY;d+=m}return d/i},s}(),Ade=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),yk=function(s){Ade(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.findStartPattern=function(r){for(var n=r.getSize(),a=r.getNextSet(0),i=0,o=Int32Array.from([0,0,0,0,0,0]),l=a,c=!1,d=6,u=a;u<n;u++)if(r.get(u)!==c)o[i]++;else{if(i===d-1){for(var h=t.MAX_AVG_VARIANCE,f=-1,m=t.CODE_START_A;m<=t.CODE_START_C;m++){var p=Co.patternMatchVariance(o,t.CODE_PATTERNS[m],t.MAX_INDIVIDUAL_VARIANCE);p<h&&(h=p,f=m)}if(f>=0&&r.isRange(Math.max(0,l-(u-l)/2),l,!1))return Int32Array.from([l,u,f]);l+=o[0]+o[1],o=o.slice(2,o.length),o[i-1]=0,o[i]=0,i--}else i++;o[i]=1,c=!c}throw new es},t.decodeCode=function(r,n,a){Co.recordPattern(r,a,n);for(var i=t.MAX_AVG_VARIANCE,o=-1,l=0;l<t.CODE_PATTERNS.length;l++){var c=t.CODE_PATTERNS[l],d=this.patternMatchVariance(n,c,t.MAX_INDIVIDUAL_VARIANCE);d<i&&(i=d,o=l)}if(o>=0)return o;throw new es},t.prototype.decodeRow=function(r,n,a){var i=a&&a.get(ti.ASSUME_GS1)===!0,o=t.findStartPattern(n),l=o[2],c=0,d=new Uint8Array(20);d[c++]=l;var u;switch(l){case t.CODE_START_A:u=t.CODE_CODE_A;break;case t.CODE_START_B:u=t.CODE_CODE_B;break;case t.CODE_START_C:u=t.CODE_CODE_C;break;default:throw new Ls}for(var h=!1,f=!1,m="",p=o[0],g=o[1],v=Int32Array.from([0,0,0,0,0,0]),y=0,j=0,b=l,w=0,N=!0,C=!1,S=!1;!h;){var _=f;switch(f=!1,y=j,j=t.decodeCode(n,v,g),d[c++]=j,j!==t.CODE_STOP&&(N=!0),j!==t.CODE_STOP&&(w++,b+=w*j),p=g,g+=v.reduce(function(J,z){return J+z},0),j){case t.CODE_START_A:case t.CODE_START_B:case t.CODE_START_C:throw new Ls}switch(u){case t.CODE_CODE_A:if(j<64)S===C?m+=String.fromCharCode(32+j):m+=String.fromCharCode(32+j+128),S=!1;else if(j<96)S===C?m+=String.fromCharCode(j-64):m+=String.fromCharCode(j+64),S=!1;else switch(j!==t.CODE_STOP&&(N=!1),j){case t.CODE_FNC_1:i&&(m.length===0?m+="]C1":m+="");break;case t.CODE_FNC_2:case t.CODE_FNC_3:break;case t.CODE_FNC_4_A:!C&&S?(C=!0,S=!1):C&&S?(C=!1,S=!1):S=!0;break;case t.CODE_SHIFT:f=!0,u=t.CODE_CODE_B;break;case t.CODE_CODE_B:u=t.CODE_CODE_B;break;case t.CODE_CODE_C:u=t.CODE_CODE_C;break;case t.CODE_STOP:h=!0;break}break;case t.CODE_CODE_B:if(j<96)S===C?m+=String.fromCharCode(32+j):m+=String.fromCharCode(32+j+128),S=!1;else switch(j!==t.CODE_STOP&&(N=!1),j){case t.CODE_FNC_1:i&&(m.length===0?m+="]C1":m+="");break;case t.CODE_FNC_2:case t.CODE_FNC_3:break;case t.CODE_FNC_4_B:!C&&S?(C=!0,S=!1):C&&S?(C=!1,S=!1):S=!0;break;case t.CODE_SHIFT:f=!0,u=t.CODE_CODE_A;break;case t.CODE_CODE_A:u=t.CODE_CODE_A;break;case t.CODE_CODE_C:u=t.CODE_CODE_C;break;case t.CODE_STOP:h=!0;break}break;case t.CODE_CODE_C:if(j<100)j<10&&(m+="0"),m+=j;else switch(j!==t.CODE_STOP&&(N=!1),j){case t.CODE_FNC_1:i&&(m.length===0?m+="]C1":m+="");break;case t.CODE_CODE_A:u=t.CODE_CODE_A;break;case t.CODE_CODE_B:u=t.CODE_CODE_B;break;case t.CODE_STOP:h=!0;break}break}_&&(u=u===t.CODE_CODE_A?t.CODE_CODE_B:t.CODE_CODE_A)}var k=g-p;if(g=n.getNextUnset(g),!n.isRange(g,Math.min(n.getSize(),g+(g-p)/2),!1))throw new es;if(b-=w*y,b%103!==y)throw new no;var F=m.length;if(F===0)throw new es;F>0&&N&&(u===t.CODE_CODE_C?m=m.substring(0,F-2):m=m.substring(0,F-1));for(var A=(o[1]+o[0])/2,T=p+k/2,V=d.length,M=new Uint8Array(V),G=0;G<V;G++)M[G]=d[G];var L=[new ur(A,r),new ur(T,r)];return new xl(m,M,0,L,Dr.CODE_128,new Date().getTime())},t.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],t.MAX_AVG_VARIANCE=.25,t.MAX_INDIVIDUAL_VARIANCE=.7,t.CODE_SHIFT=98,t.CODE_CODE_C=99,t.CODE_CODE_B=100,t.CODE_CODE_A=101,t.CODE_FNC_1=102,t.CODE_FNC_2=97,t.CODE_FNC_3=96,t.CODE_FNC_4_A=101,t.CODE_FNC_4_B=100,t.CODE_START_A=103,t.CODE_START_B=104,t.CODE_START_C=105,t.CODE_STOP=106,t}(Co),Ede=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),J2=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},jk=function(s){Ede(t,s);function t(r,n){r===void 0&&(r=!1),n===void 0&&(n=!1);var a=s.call(this)||this;return a.usingCheckDigit=r,a.extendedMode=n,a.decodeRowResult="",a.counters=new Int32Array(9),a}return t.prototype.decodeRow=function(r,n,a){var i,o,l,c,d=this.counters;d.fill(0),this.decodeRowResult="";var u=t.findAsteriskPattern(n,d),h=n.getNextSet(u[1]),f=n.getSize(),m,p;do{t.recordPattern(n,h,d);var g=t.toNarrowWidePattern(d);if(g<0)throw new es;m=t.patternToChar(g),this.decodeRowResult+=m,p=h;try{for(var v=(i=void 0,J2(d)),y=v.next();!y.done;y=v.next()){var j=y.value;h+=j}}catch(V){i={error:V}}finally{try{y&&!y.done&&(o=v.return)&&o.call(v)}finally{if(i)throw i.error}}h=n.getNextSet(h)}while(m!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var b=0;try{for(var w=J2(d),N=w.next();!N.done;N=w.next()){var j=N.value;b+=j}}catch(V){l={error:V}}finally{try{N&&!N.done&&(c=w.return)&&c.call(w)}finally{if(l)throw l.error}}var C=h-p-b;if(h!==f&&C*2<b)throw new es;if(this.usingCheckDigit){for(var S=this.decodeRowResult.length-1,_=0,k=0;k<S;k++)_+=t.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(k));if(this.decodeRowResult.charAt(S)!==t.ALPHABET_STRING.charAt(_%43))throw new no;this.decodeRowResult=this.decodeRowResult.substring(0,S)}if(this.decodeRowResult.length===0)throw new es;var F;this.extendedMode?F=t.decodeExtended(this.decodeRowResult):F=this.decodeRowResult;var A=(u[1]+u[0])/2,T=p+b/2;return new xl(F,null,0,[new ur(A,r),new ur(T,r)],Dr.CODE_39,new Date().getTime())},t.findAsteriskPattern=function(r,n){for(var a=r.getSize(),i=r.getNextSet(0),o=0,l=i,c=!1,d=n.length,u=i;u<a;u++)if(r.get(u)!==c)n[o]++;else{if(o===d-1){if(this.toNarrowWidePattern(n)===t.ASTERISK_ENCODING&&r.isRange(Math.max(0,l-Math.floor((u-l)/2)),l,!1))return[l,u];l+=n[0]+n[1],n.copyWithin(0,2,2+o-1),n[o-1]=0,n[o]=0,o--}else o++;n[o]=1,c=!c}throw new es},t.toNarrowWidePattern=function(r){var n,a,i=r.length,o=0,l;do{var c=2147483647;try{for(var d=(n=void 0,J2(r)),u=d.next();!u.done;u=d.next()){var h=u.value;h<c&&h>o&&(c=h)}}catch(g){n={error:g}}finally{try{u&&!u.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}o=c,l=0;for(var f=0,m=0,p=0;p<i;p++){var h=r[p];h>o&&(m|=1<<i-1-p,l++,f+=h)}if(l===3){for(var p=0;p<i&&l>0;p++){var h=r[p];if(h>o&&(l--,h*2>=f))return-1}return m}}while(l>3);return-1},t.patternToChar=function(r){for(var n=0;n<t.CHARACTER_ENCODINGS.length;n++)if(t.CHARACTER_ENCODINGS[n]===r)return t.ALPHABET_STRING.charAt(n);if(r===t.ASTERISK_ENCODING)return"*";throw new es},t.decodeExtended=function(r){for(var n=r.length,a="",i=0;i<n;i++){var o=r.charAt(i);if(o==="+"||o==="$"||o==="%"||o==="/"){var l=r.charAt(i+1),c="\0";switch(o){case"+":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)+32);else throw new Ls;break;case"$":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)-64);else throw new Ls;break;case"%":if(l>="A"&&l<="E")c=String.fromCharCode(l.charCodeAt(0)-38);else if(l>="F"&&l<="J")c=String.fromCharCode(l.charCodeAt(0)-11);else if(l>="K"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)+16);else if(l>="P"&&l<="T")c=String.fromCharCode(l.charCodeAt(0)+43);else if(l==="U")c="\0";else if(l==="V")c="@";else if(l==="W")c="`";else if(l==="X"||l==="Y"||l==="Z")c="";else throw new Ls;break;case"/":if(l>="A"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)-32);else if(l==="Z")c=":";else throw new Ls;break}a+=c,i++}else a+=o}return a},t.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",t.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],t.ASTERISK_ENCODING=148,t}(Co),Ide=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),X2=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},bk=function(s){Ide(t,s);function t(){var r=s.call(this)||this;return r.decodeRowResult="",r.counters=new Int32Array(6),r}return t.prototype.decodeRow=function(r,n,a){var i,o,l,c,d=this.findAsteriskPattern(n),u=n.getNextSet(d[1]),h=n.getSize(),f=this.counters;f.fill(0),this.decodeRowResult="";var m,p;do{t.recordPattern(n,u,f);var g=this.toPattern(f);if(g<0)throw new es;m=this.patternToChar(g),this.decodeRowResult+=m,p=u;try{for(var v=(i=void 0,X2(f)),y=v.next();!y.done;y=v.next()){var j=y.value;u+=j}}catch(k){i={error:k}}finally{try{y&&!y.done&&(o=v.return)&&o.call(v)}finally{if(i)throw i.error}}u=n.getNextSet(u)}while(m!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var b=0;try{for(var w=X2(f),N=w.next();!N.done;N=w.next()){var j=N.value;b+=j}}catch(k){l={error:k}}finally{try{N&&!N.done&&(c=w.return)&&c.call(w)}finally{if(l)throw l.error}}if(u===h||!n.get(u))throw new es;if(this.decodeRowResult.length<2)throw new es;this.checkChecksums(this.decodeRowResult),this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-2);var C=this.decodeExtended(this.decodeRowResult),S=(d[1]+d[0])/2,_=p+b/2;return new xl(C,null,0,[new ur(S,r),new ur(_,r)],Dr.CODE_93,new Date().getTime())},t.prototype.findAsteriskPattern=function(r){var n=r.getSize(),a=r.getNextSet(0);this.counters.fill(0);for(var i=this.counters,o=a,l=!1,c=i.length,d=0,u=a;u<n;u++)if(r.get(u)!==l)i[d]++;else{if(d===c-1){if(this.toPattern(i)===t.ASTERISK_ENCODING)return new Int32Array([o,u]);o+=i[0]+i[1],i.copyWithin(0,2,2+d-1),i[d-1]=0,i[d]=0,d--}else d++;i[d]=1,l=!l}throw new es},t.prototype.toPattern=function(r){var n,a,i=0;try{for(var o=X2(r),l=o.next();!l.done;l=o.next()){var c=l.value;i+=c}}catch(p){n={error:p}}finally{try{l&&!l.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}for(var d=0,u=r.length,h=0;h<u;h++){var f=Math.round(r[h]*9/i);if(f<1||f>4)return-1;if(h&1)d<<=f;else for(var m=0;m<f;m++)d=d<<1|1}return d},t.prototype.patternToChar=function(r){for(var n=0;n<t.CHARACTER_ENCODINGS.length;n++)if(t.CHARACTER_ENCODINGS[n]===r)return t.ALPHABET_STRING.charAt(n);throw new es},t.prototype.decodeExtended=function(r){for(var n=r.length,a="",i=0;i<n;i++){var o=r.charAt(i);if(o>="a"&&o<="d"){if(i>=n-1)throw new Ls;var l=r.charAt(i+1),c="\0";switch(o){case"d":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)+32);else throw new Ls;break;case"a":if(l>="A"&&l<="Z")c=String.fromCharCode(l.charCodeAt(0)-64);else throw new Ls;break;case"b":if(l>="A"&&l<="E")c=String.fromCharCode(l.charCodeAt(0)-38);else if(l>="F"&&l<="J")c=String.fromCharCode(l.charCodeAt(0)-11);else if(l>="K"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)+16);else if(l>="P"&&l<="T")c=String.fromCharCode(l.charCodeAt(0)+43);else if(l==="U")c="\0";else if(l==="V")c="@";else if(l==="W")c="`";else if(l>="X"&&l<="Z")c="";else throw new Ls;break;case"c":if(l>="A"&&l<="O")c=String.fromCharCode(l.charCodeAt(0)-32);else if(l==="Z")c=":";else throw new Ls;break}a+=c,i++}else a+=o}return a},t.prototype.checkChecksums=function(r){var n=r.length;this.checkOneChecksum(r,n-2,20),this.checkOneChecksum(r,n-1,15)},t.prototype.checkOneChecksum=function(r,n,a){for(var i=1,o=0,l=n-1;l>=0;l--)o+=i*t.ALPHABET_STRING.indexOf(r.charAt(l)),++i>a&&(i=1);if(r.charAt(n)!==t.ALPHABET_STRING[o%47])throw new no},t.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%abcd*",t.CHARACTER_ENCODINGS=[276,328,324,322,296,292,290,336,274,266,424,420,418,404,402,394,360,356,354,308,282,344,332,326,300,278,436,434,428,422,406,410,364,358,310,314,302,468,466,458,366,374,430,294,474,470,306,350],t.ASTERISK_ENCODING=t.CHARACTER_ENCODINGS[47],t}(Co),Pde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),_de=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Nk=function(s){Pde(t,s);function t(){var r=s!==null&&s.apply(this,arguments)||this;return r.narrowLineWidth=-1,r}return t.prototype.decodeRow=function(r,n,a){var i,o,l=this.decodeStart(n),c=this.decodeEnd(n),d=new En;t.decodeMiddle(n,l[1],c[0],d);var u=d.toString(),h=null;a!=null&&(h=a.get(ti.ALLOWED_LENGTHS)),h==null&&(h=t.DEFAULT_ALLOWED_LENGTHS);var f=u.length,m=!1,p=0;try{for(var g=_de(h),v=g.next();!v.done;v=g.next()){var y=v.value;if(f===y){m=!0;break}y>p&&(p=y)}}catch(w){i={error:w}}finally{try{v&&!v.done&&(o=g.return)&&o.call(g)}finally{if(i)throw i.error}}if(!m&&f>p&&(m=!0),!m)throw new Ls;var j=[new ur(l[1],r),new ur(c[0],r)],b=new xl(u,null,0,j,Dr.ITF,new Date().getTime());return b},t.decodeMiddle=function(r,n,a,i){var o=new Int32Array(10),l=new Int32Array(5),c=new Int32Array(5);for(o.fill(0),l.fill(0),c.fill(0);n<a;){Co.recordPattern(r,n,o);for(var d=0;d<5;d++){var u=2*d;l[d]=o[u],c[d]=o[u+1]}var h=t.decodeDigit(l);i.append(h.toString()),h=this.decodeDigit(c),i.append(h.toString()),o.forEach(function(f){n+=f})}},t.prototype.decodeStart=function(r){var n=t.skipWhiteSpace(r),a=t.findGuardPattern(r,n,t.START_PATTERN);return this.narrowLineWidth=(a[1]-a[0])/4,this.validateQuietZone(r,a[0]),a},t.prototype.validateQuietZone=function(r,n){var a=this.narrowLineWidth*10;a=a<n?a:n;for(var i=n-1;a>0&&i>=0&&!r.get(i);i--)a--;if(a!==0)throw new es},t.skipWhiteSpace=function(r){var n=r.getSize(),a=r.getNextSet(0);if(a===n)throw new es;return a},t.prototype.decodeEnd=function(r){r.reverse();try{var n=t.skipWhiteSpace(r),a=void 0;try{a=t.findGuardPattern(r,n,t.END_PATTERN_REVERSED[0])}catch(o){o instanceof es&&(a=t.findGuardPattern(r,n,t.END_PATTERN_REVERSED[1]))}this.validateQuietZone(r,a[0]);var i=a[0];return a[0]=r.getSize()-a[1],a[1]=r.getSize()-i,a}finally{r.reverse()}},t.findGuardPattern=function(r,n,a){var i=a.length,o=new Int32Array(i),l=r.getSize(),c=!1,d=0,u=n;o.fill(0);for(var h=n;h<l;h++)if(r.get(h)!==c)o[d]++;else{if(d===i-1){if(Co.patternMatchVariance(o,a,t.MAX_INDIVIDUAL_VARIANCE)<t.MAX_AVG_VARIANCE)return[u,h];u+=o[0]+o[1],ei.arraycopy(o,2,o,0,d-1),o[d-1]=0,o[d]=0,d--}else d++;o[d]=1,c=!c}throw new es},t.decodeDigit=function(r){for(var n=t.MAX_AVG_VARIANCE,a=-1,i=t.PATTERNS.length,o=0;o<i;o++){var l=t.PATTERNS[o],c=Co.patternMatchVariance(r,l,t.MAX_INDIVIDUAL_VARIANCE);c<n?(n=c,a=o):c===n&&(a=-1)}if(a>=0)return a%10;throw new es},t.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],t.MAX_AVG_VARIANCE=.38,t.MAX_INDIVIDUAL_VARIANCE=.5,t.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],t.START_PATTERN=Int32Array.from([1,1,1,1]),t.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])],t}(Co),kde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Fp=function(s){kde(t,s);function t(){var r=s!==null&&s.apply(this,arguments)||this;return r.decodeRowStringBuffer="",r}return t.findStartGuardPattern=function(r){for(var n=!1,a,i=0,o=Int32Array.from([0,0,0]);!n;){o=Int32Array.from([0,0,0]),a=t.findGuardPattern(r,i,!1,this.START_END_PATTERN,o);var l=a[0];i=a[1];var c=l-(i-l);c>=0&&(n=r.isRange(c,l,!1))}return a},t.checkChecksum=function(r){return t.checkStandardUPCEANChecksum(r)},t.checkStandardUPCEANChecksum=function(r){var n=r.length;if(n===0)return!1;var a=parseInt(r.charAt(n-1),10);return t.getStandardUPCEANChecksum(r.substring(0,n-1))===a},t.getStandardUPCEANChecksum=function(r){for(var n=r.length,a=0,i=n-1;i>=0;i-=2){var o=r.charAt(i).charCodeAt(0)-48;if(o<0||o>9)throw new Ls;a+=o}a*=3;for(var i=n-2;i>=0;i-=2){var o=r.charAt(i).charCodeAt(0)-48;if(o<0||o>9)throw new Ls;a+=o}return(1e3-a)%10},t.decodeEnd=function(r,n){return t.findGuardPattern(r,n,!1,t.START_END_PATTERN,new Int32Array(t.START_END_PATTERN.length).fill(0))},t.findGuardPatternWithoutCounters=function(r,n,a,i){return this.findGuardPattern(r,n,a,i,new Int32Array(i.length))},t.findGuardPattern=function(r,n,a,i,o){var l=r.getSize();n=a?r.getNextUnset(n):r.getNextSet(n);for(var c=0,d=n,u=i.length,h=a,f=n;f<l;f++)if(r.get(f)!==h)o[c]++;else{if(c===u-1){if(Co.patternMatchVariance(o,i,t.MAX_INDIVIDUAL_VARIANCE)<t.MAX_AVG_VARIANCE)return Int32Array.from([d,f]);d+=o[0]+o[1];for(var m=o.slice(2,o.length),p=0;p<c-1;p++)o[p]=m[p];o[c-1]=0,o[c]=0,c--}else c++;o[c]=1,h=!h}throw new es},t.decodeDigit=function(r,n,a,i){this.recordPattern(r,a,n);for(var o=this.MAX_AVG_VARIANCE,l=-1,c=i.length,d=0;d<c;d++){var u=i[d],h=Co.patternMatchVariance(n,u,t.MAX_INDIVIDUAL_VARIANCE);h<o&&(o=h,l=d)}if(l>=0)return l;throw new es},t.MAX_AVG_VARIANCE=.48,t.MAX_INDIVIDUAL_VARIANCE=.7,t.START_END_PATTERN=Int32Array.from([1,1,1]),t.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),t.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),t.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])],t}(Co),Tde=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Dde=function(){function s(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return s.prototype.decodeRow=function(t,r,n){var a=this.decodeRowStringBuffer,i=this.decodeMiddle(r,n,a),o=a.toString(),l=s.parseExtensionString(o),c=[new ur((n[0]+n[1])/2,t),new ur(i,t)],d=new xl(o,null,0,c,Dr.UPC_EAN_EXTENSION,new Date().getTime());return l!=null&&d.putAllMetadata(l),d},s.prototype.decodeMiddle=function(t,r,n){var a,i,o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var l=t.getSize(),c=r[1],d=0,u=0;u<5&&c<l;u++){var h=Fp.decodeDigit(t,o,c,Fp.L_AND_G_PATTERNS);n+=String.fromCharCode(48+h%10);try{for(var f=(a=void 0,Tde(o)),m=f.next();!m.done;m=f.next()){var p=m.value;c+=p}}catch(v){a={error:v}}finally{try{m&&!m.done&&(i=f.return)&&i.call(f)}finally{if(a)throw a.error}}h>=10&&(d|=1<<4-u),u!==4&&(c=t.getNextSet(c),c=t.getNextUnset(c))}if(n.length!==5)throw new es;var g=this.determineCheckDigit(d);if(s.extensionChecksum(n.toString())!==g)throw new es;return c},s.extensionChecksum=function(t){for(var r=t.length,n=0,a=r-2;a>=0;a-=2)n+=t.charAt(a).charCodeAt(0)-48;n*=3;for(var a=r-1;a>=0;a-=2)n+=t.charAt(a).charCodeAt(0)-48;return n*=3,n%10},s.prototype.determineCheckDigit=function(t){for(var r=0;r<10;r++)if(t===this.CHECK_DIGIT_ENCODINGS[r])return r;throw new es},s.parseExtensionString=function(t){if(t.length!==5)return null;var r=s.parseExtension5String(t);return r==null?null:new Map([[Xo.SUGGESTED_PRICE,r]])},s.parseExtension5String=function(t){var r;switch(t.charAt(0)){case"0":r="";break;case"5":r="$";break;case"9":switch(t){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}r="";break;default:r="";break}var n=parseInt(t.substring(1)),a=(n/100).toString(),i=n%100,o=i<10?"0"+i:i.toString();return r+a+"."+o},s}(),Ode=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Rde=function(){function s(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return s.prototype.decodeRow=function(t,r,n){var a=this.decodeRowStringBuffer,i=this.decodeMiddle(r,n,a),o=a.toString(),l=s.parseExtensionString(o),c=[new ur((n[0]+n[1])/2,t),new ur(i,t)],d=new xl(o,null,0,c,Dr.UPC_EAN_EXTENSION,new Date().getTime());return l!=null&&d.putAllMetadata(l),d},s.prototype.decodeMiddle=function(t,r,n){var a,i,o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var l=t.getSize(),c=r[1],d=0,u=0;u<2&&c<l;u++){var h=Fp.decodeDigit(t,o,c,Fp.L_AND_G_PATTERNS);n+=String.fromCharCode(48+h%10);try{for(var f=(a=void 0,Ode(o)),m=f.next();!m.done;m=f.next()){var p=m.value;c+=p}}catch(g){a={error:g}}finally{try{m&&!m.done&&(i=f.return)&&i.call(f)}finally{if(a)throw a.error}}h>=10&&(d|=1<<1-u),u!==1&&(c=t.getNextSet(c),c=t.getNextUnset(c))}if(n.length!==2)throw new es;if(parseInt(n.toString())%4!==d)throw new es;return c},s.parseExtensionString=function(t){return t.length!==2?null:new Map([[Xo.ISSUE_NUMBER,parseInt(t)]])},s}(),Fde=function(){function s(){}return s.decodeRow=function(t,r,n){var a=Fp.findGuardPattern(r,n,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{var i=new Dde;return i.decodeRow(t,r,a)}catch{var o=new Rde;return o.decodeRow(t,r,a)}},s.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]),s}(),Mde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),yo=function(s){Mde(t,s);function t(){var r=s.call(this)||this;r.decodeRowStringBuffer="",t.L_AND_G_PATTERNS=t.L_PATTERNS.map(function(l){return Int32Array.from(l)});for(var n=10;n<20;n++){for(var a=t.L_PATTERNS[n-10],i=new Int32Array(a.length),o=0;o<a.length;o++)i[o]=a[a.length-o-1];t.L_AND_G_PATTERNS[n]=i}return r}return t.prototype.decodeRow=function(r,n,a){var i=t.findStartGuardPattern(n),o=a==null?null:a.get(ti.NEED_RESULT_POINT_CALLBACK);if(o!=null){var l=new ur((i[0]+i[1])/2,r);o.foundPossibleResultPoint(l)}var c=this.decodeMiddle(n,i,this.decodeRowStringBuffer),d=c.rowOffset,u=c.resultString;if(o!=null){var h=new ur(d,r);o.foundPossibleResultPoint(h)}var f=t.decodeEnd(n,d);if(o!=null){var m=new ur((f[0]+f[1])/2,r);o.foundPossibleResultPoint(m)}var p=f[1],g=p+(p-f[0]);if(g>=n.getSize()||!n.isRange(p,g,!1))throw new es;var v=u.toString();if(v.length<8)throw new Ls;if(!t.checkChecksum(v))throw new no;var y=(i[1]+i[0])/2,j=(f[1]+f[0])/2,b=this.getBarcodeFormat(),w=[new ur(y,r),new ur(j,r)],N=new xl(v,null,0,w,b,new Date().getTime()),C=0;try{var S=Fde.decodeRow(r,n,f[1]);N.putMetadata(Xo.UPC_EAN_EXTENSION,S.getText()),N.putAllMetadata(S.getResultMetadata()),N.addResultPoints(S.getResultPoints()),C=S.getText().length}catch{}var _=a==null?null:a.get(ti.ALLOWED_EAN_EXTENSIONS);if(_!=null){var k=!1;for(var F in _)if(C.toString()===F){k=!0;break}if(!k)throw new es}return b===Dr.EAN_13||Dr.UPC_A,N},t.checkChecksum=function(r){return t.checkStandardUPCEANChecksum(r)},t.checkStandardUPCEANChecksum=function(r){var n=r.length;if(n===0)return!1;var a=parseInt(r.charAt(n-1),10);return t.getStandardUPCEANChecksum(r.substring(0,n-1))===a},t.getStandardUPCEANChecksum=function(r){for(var n=r.length,a=0,i=n-1;i>=0;i-=2){var o=r.charAt(i).charCodeAt(0)-48;if(o<0||o>9)throw new Ls;a+=o}a*=3;for(var i=n-2;i>=0;i-=2){var o=r.charAt(i).charCodeAt(0)-48;if(o<0||o>9)throw new Ls;a+=o}return(1e3-a)%10},t.decodeEnd=function(r,n){return t.findGuardPattern(r,n,!1,t.START_END_PATTERN,new Int32Array(t.START_END_PATTERN.length).fill(0))},t}(Fp),Lde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),wk=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},j4=function(s){Lde(t,s);function t(){var r=s.call(this)||this;return r.decodeMiddleCounters=Int32Array.from([0,0,0,0]),r}return t.prototype.decodeMiddle=function(r,n,a){var i,o,l,c,d=this.decodeMiddleCounters;d[0]=0,d[1]=0,d[2]=0,d[3]=0;for(var u=r.getSize(),h=n[1],f=0,m=0;m<6&&h<u;m++){var p=yo.decodeDigit(r,d,h,yo.L_AND_G_PATTERNS);a+=String.fromCharCode(48+p%10);try{for(var g=(i=void 0,wk(d)),v=g.next();!v.done;v=g.next()){var y=v.value;h+=y}}catch(N){i={error:N}}finally{try{v&&!v.done&&(o=g.return)&&o.call(g)}finally{if(i)throw i.error}}p>=10&&(f|=1<<5-m)}a=t.determineFirstDigit(a,f);var j=yo.findGuardPattern(r,h,!0,yo.MIDDLE_PATTERN,new Int32Array(yo.MIDDLE_PATTERN.length).fill(0));h=j[1];for(var m=0;m<6&&h<u;m++){var p=yo.decodeDigit(r,d,h,yo.L_PATTERNS);a+=String.fromCharCode(48+p);try{for(var b=(l=void 0,wk(d)),w=b.next();!w.done;w=b.next()){var y=w.value;h+=y}}catch(S){l={error:S}}finally{try{w&&!w.done&&(c=b.return)&&c.call(b)}finally{if(l)throw l.error}}}return{rowOffset:h,resultString:a}},t.prototype.getBarcodeFormat=function(){return Dr.EAN_13},t.determineFirstDigit=function(r,n){for(var a=0;a<10;a++)if(n===this.FIRST_DIGIT_ENCODINGS[a])return r=String.fromCharCode(48+a)+r,r;throw new es},t.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26],t}(yo),$de=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Sk=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Ck=function(s){$de(t,s);function t(){var r=s.call(this)||this;return r.decodeMiddleCounters=Int32Array.from([0,0,0,0]),r}return t.prototype.decodeMiddle=function(r,n,a){var i,o,l,c,d=this.decodeMiddleCounters;d[0]=0,d[1]=0,d[2]=0,d[3]=0;for(var u=r.getSize(),h=n[1],f=0;f<4&&h<u;f++){var m=yo.decodeDigit(r,d,h,yo.L_PATTERNS);a+=String.fromCharCode(48+m);try{for(var p=(i=void 0,Sk(d)),g=p.next();!g.done;g=p.next()){var v=g.value;h+=v}}catch(w){i={error:w}}finally{try{g&&!g.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}}var y=yo.findGuardPattern(r,h,!0,yo.MIDDLE_PATTERN,new Int32Array(yo.MIDDLE_PATTERN.length).fill(0));h=y[1];for(var f=0;f<4&&h<u;f++){var m=yo.decodeDigit(r,d,h,yo.L_PATTERNS);a+=String.fromCharCode(48+m);try{for(var j=(l=void 0,Sk(d)),b=j.next();!b.done;b=j.next()){var v=b.value;h+=v}}catch(C){l={error:C}}finally{try{b&&!b.done&&(c=j.return)&&c.call(j)}finally{if(l)throw l.error}}}return{rowOffset:h,resultString:a}},t.prototype.getBarcodeFormat=function(){return Dr.EAN_8},t}(yo),Bde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ak=function(s){Bde(t,s);function t(){var r=s!==null&&s.apply(this,arguments)||this;return r.ean13Reader=new j4,r}return t.prototype.getBarcodeFormat=function(){return Dr.UPC_A},t.prototype.decode=function(r,n){return this.maybeReturnResult(this.ean13Reader.decode(r))},t.prototype.decodeRow=function(r,n,a){return this.maybeReturnResult(this.ean13Reader.decodeRow(r,n,a))},t.prototype.decodeMiddle=function(r,n,a){return this.ean13Reader.decodeMiddle(r,n,a)},t.prototype.maybeReturnResult=function(r){var n=r.getText();if(n.charAt(0)==="0"){var a=new xl(n.substring(1),null,null,r.getResultPoints(),Dr.UPC_A);return r.getResultMetadata()!=null&&a.putAllMetadata(r.getResultMetadata()),a}else throw new es},t.prototype.reset=function(){this.ean13Reader.reset()},t}(yo),Ude=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),zde=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Ek=function(s){Ude(t,s);function t(){var r=s.call(this)||this;return r.decodeMiddleCounters=new Int32Array(4),r}return t.prototype.decodeMiddle=function(r,n,a){var i,o,l=this.decodeMiddleCounters.map(function(v){return v});l[0]=0,l[1]=0,l[2]=0,l[3]=0;for(var c=r.getSize(),d=n[1],u=0,h=0;h<6&&d<c;h++){var f=t.decodeDigit(r,l,d,t.L_AND_G_PATTERNS);a+=String.fromCharCode(48+f%10);try{for(var m=(i=void 0,zde(l)),p=m.next();!p.done;p=m.next()){var g=p.value;d+=g}}catch(v){i={error:v}}finally{try{p&&!p.done&&(o=m.return)&&o.call(m)}finally{if(i)throw i.error}}f>=10&&(u|=1<<5-h)}return t.determineNumSysAndCheckDigit(new En(a),u),d},t.prototype.decodeEnd=function(r,n){return t.findGuardPatternWithoutCounters(r,n,!0,t.MIDDLE_END_PATTERN)},t.prototype.checkChecksum=function(r){return yo.checkChecksum(t.convertUPCEtoUPCA(r))},t.determineNumSysAndCheckDigit=function(r,n){for(var a=0;a<=1;a++)for(var i=0;i<10;i++)if(n===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[a][i]){r.insert(0,"0"+a),r.append("0"+i);return}throw es.getNotFoundInstance()},t.prototype.getBarcodeFormat=function(){return Dr.UPC_E},t.convertUPCEtoUPCA=function(r){var n=r.slice(1,7).split("").map(function(o){return o.charCodeAt(0)}),a=new En;a.append(r.charAt(0));var i=n[5];switch(i){case 0:case 1:case 2:a.appendChars(n,0,2),a.append(i),a.append("0000"),a.appendChars(n,2,3);break;case 3:a.appendChars(n,0,3),a.append("00000"),a.appendChars(n,3,2);break;case 4:a.appendChars(n,0,4),a.append("00000"),a.append(n[4]);break;default:a.appendChars(n,0,5),a.append("0000"),a.append(i);break}return r.length>=8&&a.append(r.charAt(7)),a.toString()},t.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),t.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,1])],t}(yo),qde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ik=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Q2=function(s){qde(t,s);function t(r){var n=s.call(this)||this,a=r==null?null:r.get(ti.POSSIBLE_FORMATS),i=[];return a!=null&&(a.indexOf(Dr.EAN_13)>-1&&i.push(new j4),a.indexOf(Dr.UPC_A)>-1&&i.push(new Ak),a.indexOf(Dr.EAN_8)>-1&&i.push(new Ck),a.indexOf(Dr.UPC_E)>-1&&i.push(new Ek)),i.length===0&&(i.push(new j4),i.push(new Ak),i.push(new Ck),i.push(new Ek)),n.readers=i,n}return t.prototype.decodeRow=function(r,n,a){var i,o;try{for(var l=Ik(this.readers),c=l.next();!c.done;c=l.next()){var d=c.value;try{var u=d.decodeRow(r,n,a),h=u.getBarcodeFormat()===Dr.EAN_13&&u.getText().charAt(0)==="0",f=a==null?null:a.get(ti.POSSIBLE_FORMATS),m=f==null||f.includes(Dr.UPC_A);if(h&&m){var p=u.getRawBytes(),g=new xl(u.getText().substring(1),p,p?p.length:null,u.getResultPoints(),Dr.UPC_A);return g.putAllMetadata(u.getResultMetadata()),g}return u}catch{}}}catch(v){i={error:v}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}throw new es},t.prototype.reset=function(){var r,n;try{for(var a=Ik(this.readers),i=a.next();!i.done;i=a.next()){var o=i.value;o.reset()}}catch(l){r={error:l}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},t}(Co),Vde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Wde=function(s){Vde(t,s);function t(){var r=s!==null&&s.apply(this,arguments)||this;return r.CODA_BAR_CHAR_SET={nnnnnww:"0",nnnnwwn:"1",nnnwnnw:"2",wwnnnnn:"3",nnwnnwn:"4",wnnnnwn:"5",nwnnnnw:"6",nwnnwnn:"7",nwwnnnn:"8",wnnwnnn:"9",nnnwwnn:"-",nnwwnnn:"$",wnnnwnw:":",wnwnnnw:"/",wnwnwnn:".",nnwwwww:"+",nnwwnwn:"A",nwnwnnw:"B",nnnwnww:"C",nnnwwwn:"D"},r}return t.prototype.decodeRow=function(r,n,a){var i=this.getValidRowData(n);if(!i)throw new es;var o=this.codaBarDecodeRow(i.row);if(!o)throw new es;return new xl(o,null,0,[new ur(i.left,r),new ur(i.right,r)],Dr.CODABAR,new Date().getTime())},t.prototype.getValidRowData=function(r){var n=r.toArray(),a=n.indexOf(!0);if(a===-1)return null;var i=n.lastIndexOf(!0);if(i<=a)return null;n=n.slice(a,i+1);for(var o=[],l=n[0],c=1,d=1;d<n.length;d++)n[d]===l?c++:(l=n[d],o.push(c),c=1);return o.push(c),o.length<23&&(o.length+1)%8!==0?null:{row:o,left:a,right:i}},t.prototype.codaBarDecodeRow=function(r){for(var n=[],a=Math.ceil(r.reduce(function(c,d){return(c+d)/2},0));r.length>0;){var i=r.splice(0,8).splice(0,7),o=i.map(function(c){return c<a?"n":"w"}).join("");if(this.CODA_BAR_CHAR_SET[o]===void 0)return null;n.push(this.CODA_BAR_CHAR_SET[o])}var l=n.join("");return this.validCodaBarString(l)?l:null},t.prototype.validCodaBarString=function(r){var n=/^[A-D].{1,}[A-D]$/;return n.test(r)},t}(Co),Hde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Gde=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},hf=function(s){Hde(t,s);function t(){var r=s.call(this)||this;return r.decodeFinderCounters=new Int32Array(4),r.dataCharacterCounters=new Int32Array(8),r.oddRoundingErrors=new Array(4),r.evenRoundingErrors=new Array(4),r.oddCounts=new Array(r.dataCharacterCounters.length/2),r.evenCounts=new Array(r.dataCharacterCounters.length/2),r}return t.prototype.getDecodeFinderCounters=function(){return this.decodeFinderCounters},t.prototype.getDataCharacterCounters=function(){return this.dataCharacterCounters},t.prototype.getOddRoundingErrors=function(){return this.oddRoundingErrors},t.prototype.getEvenRoundingErrors=function(){return this.evenRoundingErrors},t.prototype.getOddCounts=function(){return this.oddCounts},t.prototype.getEvenCounts=function(){return this.evenCounts},t.prototype.parseFinderValue=function(r,n){for(var a=0;a<n.length;a++)if(Co.patternMatchVariance(r,n[a],t.MAX_INDIVIDUAL_VARIANCE)<t.MAX_AVG_VARIANCE)return a;throw new es},t.count=function(r){return ea.sum(new Int32Array(r))},t.increment=function(r,n){for(var a=0,i=n[0],o=1;o<r.length;o++)n[o]>i&&(i=n[o],a=o);r[a]++},t.decrement=function(r,n){for(var a=0,i=n[0],o=1;o<r.length;o++)n[o]<i&&(i=n[o],a=o);r[a]--},t.isFinderPattern=function(r){var n,a,i=r[0]+r[1],o=i+r[2]+r[3],l=i/o;if(l>=t.MIN_FINDER_PATTERN_RATIO&&l<=t.MAX_FINDER_PATTERN_RATIO){var c=Number.MAX_SAFE_INTEGER,d=Number.MIN_SAFE_INTEGER;try{for(var u=Gde(r),h=u.next();!h.done;h=u.next()){var f=h.value;f>d&&(d=f),f<c&&(c=f)}}catch(m){n={error:m}}finally{try{h&&!h.done&&(a=u.return)&&a.call(u)}finally{if(n)throw n.error}}return d<10*c}return!1},t.MAX_AVG_VARIANCE=.2,t.MAX_INDIVIDUAL_VARIANCE=.45,t.MIN_FINDER_PATTERN_RATIO=9.5/12,t.MAX_FINDER_PATTERN_RATIO=12.5/14,t}(Co),E1=function(){function s(t,r){this.value=t,this.checksumPortion=r}return s.prototype.getValue=function(){return this.value},s.prototype.getChecksumPortion=function(){return this.checksumPortion},s.prototype.toString=function(){return this.value+"("+this.checksumPortion+")"},s.prototype.equals=function(t){if(!(t instanceof s))return!1;var r=t;return this.value===r.value&&this.checksumPortion===r.checksumPortion},s.prototype.hashCode=function(){return this.value^this.checksumPortion},s}(),D9=function(){function s(t,r,n,a,i){this.value=t,this.startEnd=r,this.value=t,this.startEnd=r,this.resultPoints=new Array,this.resultPoints.push(new ur(n,i)),this.resultPoints.push(new ur(a,i))}return s.prototype.getValue=function(){return this.value},s.prototype.getStartEnd=function(){return this.startEnd},s.prototype.getResultPoints=function(){return this.resultPoints},s.prototype.equals=function(t){if(!(t instanceof s))return!1;var r=t;return this.value===r.value},s.prototype.hashCode=function(){return this.value},s}(),Kde=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Vx=function(){function s(){}return s.getRSSvalue=function(t,r,n){var a,i,o=0;try{for(var l=Kde(t),c=l.next();!c.done;c=l.next()){var d=c.value;o+=d}}catch(j){a={error:j}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(a)throw a.error}}for(var u=0,h=0,f=t.length,m=0;m<f-1;m++){var p=void 0;for(p=1,h|=1<<m;p<t[m];p++,h&=~(1<<m)){var g=s.combins(o-p-1,f-m-2);if(n&&h===0&&o-p-(f-m-1)>=f-m-1&&(g-=s.combins(o-p-(f-m),f-m-2)),f-m-1>1){for(var v=0,y=o-p-(f-m-2);y>r;y--)v+=s.combins(o-p-y-1,f-m-3);g-=v*(f-1-m)}else o-p>r&&g--;u+=g}o-=p}return u},s.combins=function(t,r){var n,a;t-r>r?(a=r,n=t-r):(a=t-r,n=r);for(var i=1,o=1,l=t;l>n;l--)i*=l,o<=a&&(i/=o,o++);for(;o<=a;)i/=o,o++;return i},s}(),Yde=function(){function s(){}return s.buildBitArray=function(t){var r=t.length*2-1;t[t.length-1].getRightChar()==null&&(r-=1);for(var n=12*r,a=new Bo(n),i=0,o=t[0],l=o.getRightChar().getValue(),c=11;c>=0;--c)l&1<<c&&a.set(i),i++;for(var c=1;c<t.length;++c){for(var d=t[c],u=d.getLeftChar().getValue(),h=11;h>=0;--h)u&1<<h&&a.set(i),i++;if(d.getRightChar()!==null)for(var f=d.getRightChar().getValue(),h=11;h>=0;--h)f&1<<h&&a.set(i),i++}return a},s}(),sf=function(){function s(t,r){r?this.decodedInformation=null:(this.finished=t,this.decodedInformation=r)}return s.prototype.getDecodedInformation=function(){return this.decodedInformation},s.prototype.isFinished=function(){return this.finished},s}(),A3=function(){function s(t){this.newPosition=t}return s.prototype.getNewPosition=function(){return this.newPosition},s}(),Jde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),pd=function(s){Jde(t,s);function t(r,n){var a=s.call(this,r)||this;return a.value=n,a}return t.prototype.getValue=function(){return this.value},t.prototype.isFNC1=function(){return this.value===t.FNC1},t.FNC1="$",t}(A3),Xde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),rf=function(s){Xde(t,s);function t(r,n,a){var i=s.call(this,r)||this;return a?(i.remaining=!0,i.remainingValue=i.remainingValue):(i.remaining=!1,i.remainingValue=0),i.newString=n,i}return t.prototype.getNewString=function(){return this.newString},t.prototype.isRemaining=function(){return this.remaining},t.prototype.getRemainingValue=function(){return this.remainingValue},t}(A3),Qde=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Dx=function(s){Qde(t,s);function t(r,n,a){var i=s.call(this,r)||this;if(n<0||n>10||a<0||a>10)throw new Ls;return i.firstDigit=n,i.secondDigit=a,i}return t.prototype.getFirstDigit=function(){return this.firstDigit},t.prototype.getSecondDigit=function(){return this.secondDigit},t.prototype.getValue=function(){return this.firstDigit*10+this.secondDigit},t.prototype.isFirstDigitFNC1=function(){return this.firstDigit===t.FNC1},t.prototype.isSecondDigitFNC1=function(){return this.secondDigit===t.FNC1},t.prototype.isAnyFNC1=function(){return this.firstDigit===t.FNC1||this.secondDigit===t.FNC1},t.FNC1=10,t}(A3),mj=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Zde=function(){function s(){}return s.parseFieldsInGeneralPurpose=function(t){var r,n,a,i,o,l,c,d;if(!t)return null;if(t.length<2)throw new es;var u=t.substring(0,2);try{for(var h=mj(s.TWO_DIGIT_DATA_LENGTH),f=h.next();!f.done;f=h.next()){var m=f.value;if(m[0]===u)return m[1]===s.VARIABLE_LENGTH?s.processVariableAI(2,m[2],t):s.processFixedAI(2,m[1],t)}}catch(C){r={error:C}}finally{try{f&&!f.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}if(t.length<3)throw new es;var p=t.substring(0,3);try{for(var g=mj(s.THREE_DIGIT_DATA_LENGTH),v=g.next();!v.done;v=g.next()){var m=v.value;if(m[0]===p)return m[1]===s.VARIABLE_LENGTH?s.processVariableAI(3,m[2],t):s.processFixedAI(3,m[1],t)}}catch(C){a={error:C}}finally{try{v&&!v.done&&(i=g.return)&&i.call(g)}finally{if(a)throw a.error}}try{for(var y=mj(s.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH),j=y.next();!j.done;j=y.next()){var m=j.value;if(m[0]===p)return m[1]===s.VARIABLE_LENGTH?s.processVariableAI(4,m[2],t):s.processFixedAI(4,m[1],t)}}catch(C){o={error:C}}finally{try{j&&!j.done&&(l=y.return)&&l.call(y)}finally{if(o)throw o.error}}if(t.length<4)throw new es;var b=t.substring(0,4);try{for(var w=mj(s.FOUR_DIGIT_DATA_LENGTH),N=w.next();!N.done;N=w.next()){var m=N.value;if(m[0]===b)return m[1]===s.VARIABLE_LENGTH?s.processVariableAI(4,m[2],t):s.processFixedAI(4,m[1],t)}}catch(C){c={error:C}}finally{try{N&&!N.done&&(d=w.return)&&d.call(w)}finally{if(c)throw c.error}}throw new es},s.processFixedAI=function(t,r,n){if(n.length<t)throw new es;var a=n.substring(0,t);if(n.length<t+r)throw new es;var i=n.substring(t,t+r),o=n.substring(t+r),l="("+a+")"+i,c=s.parseFieldsInGeneralPurpose(o);return c==null?l:l+c},s.processVariableAI=function(t,r,n){var a=n.substring(0,t),i;n.length<t+r?i=n.length:i=t+r;var o=n.substring(t,i),l=n.substring(i),c="("+a+")"+o,d=s.parseFieldsInGeneralPurpose(l);return d==null?c:c+d},s.VARIABLE_LENGTH=[],s.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",s.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",s.VARIABLE_LENGTH,20],["22",s.VARIABLE_LENGTH,29],["30",s.VARIABLE_LENGTH,8],["37",s.VARIABLE_LENGTH,8],["90",s.VARIABLE_LENGTH,30],["91",s.VARIABLE_LENGTH,30],["92",s.VARIABLE_LENGTH,30],["93",s.VARIABLE_LENGTH,30],["94",s.VARIABLE_LENGTH,30],["95",s.VARIABLE_LENGTH,30],["96",s.VARIABLE_LENGTH,30],["97",s.VARIABLE_LENGTH,3],["98",s.VARIABLE_LENGTH,30],["99",s.VARIABLE_LENGTH,30]],s.THREE_DIGIT_DATA_LENGTH=[["240",s.VARIABLE_LENGTH,30],["241",s.VARIABLE_LENGTH,30],["242",s.VARIABLE_LENGTH,6],["250",s.VARIABLE_LENGTH,30],["251",s.VARIABLE_LENGTH,30],["253",s.VARIABLE_LENGTH,17],["254",s.VARIABLE_LENGTH,20],["400",s.VARIABLE_LENGTH,30],["401",s.VARIABLE_LENGTH,30],["402",17],["403",s.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",s.VARIABLE_LENGTH,20],["421",s.VARIABLE_LENGTH,15],["422",3],["423",s.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],s.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",s.VARIABLE_LENGTH,15],["391",s.VARIABLE_LENGTH,18],["392",s.VARIABLE_LENGTH,15],["393",s.VARIABLE_LENGTH,18],["703",s.VARIABLE_LENGTH,30]],s.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",s.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",s.VARIABLE_LENGTH,20],["8003",s.VARIABLE_LENGTH,30],["8004",s.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",s.VARIABLE_LENGTH,30],["8008",s.VARIABLE_LENGTH,12],["8018",18],["8020",s.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",s.VARIABLE_LENGTH,70],["8200",s.VARIABLE_LENGTH,70]],s}(),Wj=function(){function s(t){this.buffer=new En,this.information=t}return s.prototype.decodeAllCodes=function(t,r){var n=r,a=null;do{var i=this.decodeGeneralPurposeField(n,a),o=Zde.parseFieldsInGeneralPurpose(i.getNewString());if(o!=null&&t.append(o),i.isRemaining()?a=""+i.getRemainingValue():a=null,n===i.getNewPosition())break;n=i.getNewPosition()}while(!0);return t.toString()},s.prototype.isStillNumeric=function(t){if(t+7>this.information.getSize())return t+4<=this.information.getSize();for(var r=t;r<t+3;++r)if(this.information.get(r))return!0;return this.information.get(t+3)},s.prototype.decodeNumeric=function(t){if(t+7>this.information.getSize()){var r=this.extractNumericValueFromBitArray(t,4);return r===0?new Dx(this.information.getSize(),Dx.FNC1,Dx.FNC1):new Dx(this.information.getSize(),r-1,Dx.FNC1)}var n=this.extractNumericValueFromBitArray(t,7),a=(n-8)/11,i=(n-8)%11;return new Dx(t+7,a,i)},s.prototype.extractNumericValueFromBitArray=function(t,r){return s.extractNumericValueFromBitArray(this.information,t,r)},s.extractNumericValueFromBitArray=function(t,r,n){for(var a=0,i=0;i<n;++i)t.get(r+i)&&(a|=1<<n-i-1);return a},s.prototype.decodeGeneralPurposeField=function(t,r){this.buffer.setLengthToZero(),r!=null&&this.buffer.append(r),this.current.setPosition(t);var n=this.parseBlocks();return n!=null&&n.isRemaining()?new rf(this.current.getPosition(),this.buffer.toString(),n.getRemainingValue()):new rf(this.current.getPosition(),this.buffer.toString())},s.prototype.parseBlocks=function(){var t,r;do{var n=this.current.getPosition();this.current.isAlpha()?(r=this.parseAlphaBlock(),t=r.isFinished()):this.current.isIsoIec646()?(r=this.parseIsoIec646Block(),t=r.isFinished()):(r=this.parseNumericBlock(),t=r.isFinished());var a=n!==this.current.getPosition();if(!a&&!t)break}while(!t);return r.getDecodedInformation()},s.prototype.parseNumericBlock=function(){for(;this.isStillNumeric(this.current.getPosition());){var t=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(t.getNewPosition()),t.isFirstDigitFNC1()){var r=void 0;return t.isSecondDigitFNC1()?r=new rf(this.current.getPosition(),this.buffer.toString()):r=new rf(this.current.getPosition(),this.buffer.toString(),t.getSecondDigit()),new sf(!0,r)}if(this.buffer.append(t.getFirstDigit()),t.isSecondDigitFNC1()){var r=new rf(this.current.getPosition(),this.buffer.toString());return new sf(!0,r)}this.buffer.append(t.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new sf(!1)},s.prototype.parseIsoIec646Block=function(){for(;this.isStillIsoIec646(this.current.getPosition());){var t=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(t.getNewPosition()),t.isFNC1()){var r=new rf(this.current.getPosition(),this.buffer.toString());return new sf(!0,r)}this.buffer.append(t.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new sf(!1)},s.prototype.parseAlphaBlock=function(){for(;this.isStillAlpha(this.current.getPosition());){var t=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(t.getNewPosition()),t.isFNC1()){var r=new rf(this.current.getPosition(),this.buffer.toString());return new sf(!0,r)}this.buffer.append(t.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new sf(!1)},s.prototype.isStillIsoIec646=function(t){if(t+5>this.information.getSize())return!1;var r=this.extractNumericValueFromBitArray(t,5);if(r>=5&&r<16)return!0;if(t+7>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(t,7);if(n>=64&&n<116)return!0;if(t+8>this.information.getSize())return!1;var a=this.extractNumericValueFromBitArray(t,8);return a>=232&&a<253},s.prototype.decodeIsoIec646=function(t){var r=this.extractNumericValueFromBitArray(t,5);if(r===15)return new pd(t+5,pd.FNC1);if(r>=5&&r<15)return new pd(t+5,"0"+(r-5));var n=this.extractNumericValueFromBitArray(t,7);if(n>=64&&n<90)return new pd(t+7,""+(n+1));if(n>=90&&n<116)return new pd(t+7,""+(n+7));var a=this.extractNumericValueFromBitArray(t,8),i;switch(a){case 232:i="!";break;case 233:i='"';break;case 234:i="%";break;case 235:i="&";break;case 236:i="'";break;case 237:i="(";break;case 238:i=")";break;case 239:i="*";break;case 240:i="+";break;case 241:i=",";break;case 242:i="-";break;case 243:i=".";break;case 244:i="/";break;case 245:i=":";break;case 246:i=";";break;case 247:i="<";break;case 248:i="=";break;case 249:i=">";break;case 250:i="?";break;case 251:i="_";break;case 252:i=" ";break;default:throw new Ls}return new pd(t+8,i)},s.prototype.isStillAlpha=function(t){if(t+5>this.information.getSize())return!1;var r=this.extractNumericValueFromBitArray(t,5);if(r>=5&&r<16)return!0;if(t+6>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(t,6);return n>=16&&n<63},s.prototype.decodeAlphanumeric=function(t){var r=this.extractNumericValueFromBitArray(t,5);if(r===15)return new pd(t+5,pd.FNC1);if(r>=5&&r<15)return new pd(t+5,"0"+(r-5));var n=this.extractNumericValueFromBitArray(t,6);if(n>=32&&n<58)return new pd(t+6,""+(n+33));var a;switch(n){case 58:a="*";break;case 59:a=",";break;case 60:a="-";break;case 61:a=".";break;case 62:a="/";break;default:throw new hy("Decoding invalid alphanumeric value: "+n)}return new pd(t+6,a)},s.prototype.isAlphaTo646ToAlphaLatch=function(t){if(t+1>this.information.getSize())return!1;for(var r=0;r<5&&r+t<this.information.getSize();++r)if(r===2){if(!this.information.get(t+2))return!1}else if(this.information.get(t+r))return!1;return!0},s.prototype.isAlphaOr646ToNumericLatch=function(t){if(t+3>this.information.getSize())return!1;for(var r=t;r<t+3;++r)if(this.information.get(r))return!1;return!0},s.prototype.isNumericToAlphaNumericLatch=function(t){if(t+1>this.information.getSize())return!1;for(var r=0;r<4&&r+t<this.information.getSize();++r)if(this.information.get(t+r))return!1;return!0},s}(),O9=function(){function s(t){this.information=t,this.generalDecoder=new Wj(t)}return s.prototype.getInformation=function(){return this.information},s.prototype.getGeneralDecoder=function(){return this.generalDecoder},s}(),eue=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ed=function(s){eue(t,s);function t(r){return s.call(this,r)||this}return t.prototype.encodeCompressedGtin=function(r,n){r.append("(01)");var a=r.length();r.append("9"),this.encodeCompressedGtinWithoutAI(r,n,a)},t.prototype.encodeCompressedGtinWithoutAI=function(r,n,a){for(var i=0;i<4;++i){var o=this.getGeneralDecoder().extractNumericValueFromBitArray(n+10*i,10);o/100===0&&r.append("0"),o/10===0&&r.append("0"),r.append(o)}t.appendCheckDigit(r,a)},t.appendCheckDigit=function(r,n){for(var a=0,i=0;i<13;i++){var o=r.charAt(i+n).charCodeAt(0)-48;a+=i&1?o:3*o}a=10-a%10,a===10&&(a=0),r.append(a)},t.GTIN_SIZE=40,t}(O9),tue=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),sue=function(s){tue(t,s);function t(r){return s.call(this,r)||this}return t.prototype.parseInformation=function(){var r=new En;r.append("(01)");var n=r.length(),a=this.getGeneralDecoder().extractNumericValueFromBitArray(t.HEADER_SIZE,4);return r.append(a),this.encodeCompressedGtinWithoutAI(r,t.HEADER_SIZE+4,n),this.getGeneralDecoder().decodeAllCodes(r,t.HEADER_SIZE+44)},t.HEADER_SIZE=4,t}(Ed),rue=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),nue=function(s){rue(t,s);function t(r){return s.call(this,r)||this}return t.prototype.parseInformation=function(){var r=new En;return this.getGeneralDecoder().decodeAllCodes(r,t.HEADER_SIZE)},t.HEADER_SIZE=5,t}(O9),aue=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Hj=function(s){aue(t,s);function t(r){return s.call(this,r)||this}return t.prototype.encodeCompressedWeight=function(r,n,a){var i=this.getGeneralDecoder().extractNumericValueFromBitArray(n,a);this.addWeightCode(r,i);for(var o=this.checkWeight(i),l=1e5,c=0;c<5;++c)o/l===0&&r.append("0"),l/=10;r.append(o)},t}(Ed),iue=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),R9=function(s){iue(t,s);function t(r){return s.call(this,r)||this}return t.prototype.parseInformation=function(){if(this.getInformation().getSize()!==t.HEADER_SIZE+Hj.GTIN_SIZE+t.WEIGHT_SIZE)throw new es;var r=new En;return this.encodeCompressedGtin(r,t.HEADER_SIZE),this.encodeCompressedWeight(r,t.HEADER_SIZE+Hj.GTIN_SIZE,t.WEIGHT_SIZE),r.toString()},t.HEADER_SIZE=5,t.WEIGHT_SIZE=15,t}(Hj),oue=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),lue=function(s){oue(t,s);function t(r){return s.call(this,r)||this}return t.prototype.addWeightCode=function(r,n){r.append("(3103)")},t.prototype.checkWeight=function(r){return r},t}(R9),cue=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),due=function(s){cue(t,s);function t(r){return s.call(this,r)||this}return t.prototype.addWeightCode=function(r,n){n<1e4?r.append("(3202)"):r.append("(3203)")},t.prototype.checkWeight=function(r){return r<1e4?r:r-1e4},t}(R9),uue=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),hue=function(s){uue(t,s);function t(r){return s.call(this,r)||this}return t.prototype.parseInformation=function(){if(this.getInformation().getSize()<t.HEADER_SIZE+Ed.GTIN_SIZE)throw new es;var r=new En;this.encodeCompressedGtin(r,t.HEADER_SIZE);var n=this.getGeneralDecoder().extractNumericValueFromBitArray(t.HEADER_SIZE+Ed.GTIN_SIZE,t.LAST_DIGIT_SIZE);r.append("(392"),r.append(n),r.append(")");var a=this.getGeneralDecoder().decodeGeneralPurposeField(t.HEADER_SIZE+Ed.GTIN_SIZE+t.LAST_DIGIT_SIZE,null);return r.append(a.getNewString()),r.toString()},t.HEADER_SIZE=8,t.LAST_DIGIT_SIZE=2,t}(Ed),mue=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),fue=function(s){mue(t,s);function t(r){return s.call(this,r)||this}return t.prototype.parseInformation=function(){if(this.getInformation().getSize()<t.HEADER_SIZE+Ed.GTIN_SIZE)throw new es;var r=new En;this.encodeCompressedGtin(r,t.HEADER_SIZE);var n=this.getGeneralDecoder().extractNumericValueFromBitArray(t.HEADER_SIZE+Ed.GTIN_SIZE,t.LAST_DIGIT_SIZE);r.append("(393"),r.append(n),r.append(")");var a=this.getGeneralDecoder().extractNumericValueFromBitArray(t.HEADER_SIZE+Ed.GTIN_SIZE+t.LAST_DIGIT_SIZE,t.FIRST_THREE_DIGITS_SIZE);a/100===0&&r.append("0"),a/10===0&&r.append("0"),r.append(a);var i=this.getGeneralDecoder().decodeGeneralPurposeField(t.HEADER_SIZE+Ed.GTIN_SIZE+t.LAST_DIGIT_SIZE+t.FIRST_THREE_DIGITS_SIZE,null);return r.append(i.getNewString()),r.toString()},t.HEADER_SIZE=8,t.LAST_DIGIT_SIZE=2,t.FIRST_THREE_DIGITS_SIZE=10,t}(Ed),xue=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Bh=function(s){xue(t,s);function t(r,n,a){var i=s.call(this,r)||this;return i.dateCode=a,i.firstAIdigits=n,i}return t.prototype.parseInformation=function(){if(this.getInformation().getSize()!==t.HEADER_SIZE+t.GTIN_SIZE+t.WEIGHT_SIZE+t.DATE_SIZE)throw new es;var r=new En;return this.encodeCompressedGtin(r,t.HEADER_SIZE),this.encodeCompressedWeight(r,t.HEADER_SIZE+t.GTIN_SIZE,t.WEIGHT_SIZE),this.encodeCompressedDate(r,t.HEADER_SIZE+t.GTIN_SIZE+t.WEIGHT_SIZE),r.toString()},t.prototype.encodeCompressedDate=function(r,n){var a=this.getGeneralDecoder().extractNumericValueFromBitArray(n,t.DATE_SIZE);if(a!==38400){r.append("("),r.append(this.dateCode),r.append(")");var i=a%32;a/=32;var o=a%12+1;a/=12;var l=a;l/10===0&&r.append("0"),r.append(l),o/10===0&&r.append("0"),r.append(o),i/10===0&&r.append("0"),r.append(i)}},t.prototype.addWeightCode=function(r,n){r.append("("),r.append(this.firstAIdigits),r.append(n/1e5),r.append(")")},t.prototype.checkWeight=function(r){return r%1e5},t.HEADER_SIZE=8,t.WEIGHT_SIZE=20,t.DATE_SIZE=16,t}(Hj);function pue(s){try{if(s.get(1))return new sue(s);if(!s.get(2))return new nue(s);var t=Wj.extractNumericValueFromBitArray(s,1,4);switch(t){case 4:return new lue(s);case 5:return new due(s)}var r=Wj.extractNumericValueFromBitArray(s,1,5);switch(r){case 12:return new hue(s);case 13:return new fue(s)}var n=Wj.extractNumericValueFromBitArray(s,1,7);switch(n){case 56:return new Bh(s,"310","11");case 57:return new Bh(s,"320","11");case 58:return new Bh(s,"310","13");case 59:return new Bh(s,"320","13");case 60:return new Bh(s,"310","15");case 61:return new Bh(s,"320","15");case 62:return new Bh(s,"310","17");case 63:return new Bh(s,"320","17")}}catch(a){throw console.log(a),new hy("unknown decoder: "+s)}}var Pk=function(){function s(t,r,n,a){this.leftchar=t,this.rightchar=r,this.finderpattern=n,this.maybeLast=a}return s.prototype.mayBeLast=function(){return this.maybeLast},s.prototype.getLeftChar=function(){return this.leftchar},s.prototype.getRightChar=function(){return this.rightchar},s.prototype.getFinderPattern=function(){return this.finderpattern},s.prototype.mustBeLast=function(){return this.rightchar==null},s.prototype.toString=function(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"},s.equals=function(t,r){return t instanceof s?s.equalsOrNull(t.leftchar,r.leftchar)&&s.equalsOrNull(t.rightchar,r.rightchar)&&s.equalsOrNull(t.finderpattern,r.finderpattern):!1},s.equalsOrNull=function(t,r){return t===null?r===null:s.equals(t,r)},s.prototype.hashCode=function(){var t=this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue();return t},s}(),gue=function(){function s(t,r,n){this.pairs=t,this.rowNumber=r,this.wasReversed=n}return s.prototype.getPairs=function(){return this.pairs},s.prototype.getRowNumber=function(){return this.rowNumber},s.prototype.isReversed=function(){return this.wasReversed},s.prototype.isEquivalent=function(t){return this.checkEqualitity(this,t)},s.prototype.toString=function(){return"{ "+this.pairs+" }"},s.prototype.equals=function(t,r){return t instanceof s?this.checkEqualitity(t,r)&&t.wasReversed===r.wasReversed:!1},s.prototype.checkEqualitity=function(t,r){if(!(!t||!r)){var n;return t.forEach(function(a,i){r.forEach(function(o){a.getLeftChar().getValue()===o.getLeftChar().getValue()&&a.getRightChar().getValue()===o.getRightChar().getValue()&&a.getFinderPatter().getValue()===o.getFinderPatter().getValue()&&(n=!0)})}),n}},s}(),vue=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Uh=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},yue=function(s){vue(t,s);function t(){var r=s!==null&&s.apply(this,arguments)||this;return r.pairs=new Array(t.MAX_PAIRS),r.rows=new Array,r.startEnd=[2],r}return t.prototype.decodeRow=function(r,n,a){this.pairs.length=0,this.startFromEven=!1;try{return t.constructResult(this.decodeRow2pairs(r,n))}catch{}return this.pairs.length=0,this.startFromEven=!0,t.constructResult(this.decodeRow2pairs(r,n))},t.prototype.reset=function(){this.pairs.length=0,this.rows.length=0},t.prototype.decodeRow2pairs=function(r,n){for(var a=!1;!a;)try{this.pairs.push(this.retrieveNextPair(n,this.pairs,r))}catch(l){if(l instanceof es){if(!this.pairs.length)throw new es;a=!0}}if(this.checkChecksum())return this.pairs;var i;if(this.rows.length?i=!0:i=!1,this.storeRow(r,!1),i){var o=this.checkRowsBoolean(!1);if(o!=null||(o=this.checkRowsBoolean(!0),o!=null))return o}throw new es},t.prototype.checkRowsBoolean=function(r){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,r&&(this.rows=this.rows.reverse());var n=null;try{n=this.checkRows(new Array,0)}catch(a){console.log(a)}return r&&(this.rows=this.rows.reverse()),n},t.prototype.checkRows=function(r,n){for(var a,i,o=n;o<this.rows.length;o++){var l=this.rows[o];this.pairs.length=0;try{for(var c=(a=void 0,Uh(r)),d=c.next();!d.done;d=c.next()){var u=d.value;this.pairs.push(u.getPairs())}}catch(f){a={error:f}}finally{try{d&&!d.done&&(i=c.return)&&i.call(c)}finally{if(a)throw a.error}}if(this.pairs.push(l.getPairs()),!!t.isValidSequence(this.pairs)){if(this.checkChecksum())return this.pairs;var h=new Array(r);h.push(l);try{return this.checkRows(h,o+1)}catch(f){console.log(f)}}}throw new es},t.isValidSequence=function(r){var n,a;try{for(var i=Uh(t.FINDER_PATTERN_SEQUENCES),o=i.next();!o.done;o=i.next()){var l=o.value;if(!(r.length>l.length)){for(var c=!0,d=0;d<r.length;d++)if(r[d].getFinderPattern().getValue()!==l[d]){c=!1;break}if(c)return!0}}}catch(u){n={error:u}}finally{try{o&&!o.done&&(a=i.return)&&a.call(i)}finally{if(n)throw n.error}}return!1},t.prototype.storeRow=function(r,n){for(var a=0,i=!1,o=!1;a<this.rows.length;){var l=this.rows[a];if(l.getRowNumber()>r){o=l.isEquivalent(this.pairs);break}i=l.isEquivalent(this.pairs),a++}o||i||t.isPartialRow(this.pairs,this.rows)||(this.rows.push(a,new gue(this.pairs,r,n)),this.removePartialRows(this.pairs,this.rows))},t.prototype.removePartialRows=function(r,n){var a,i,o,l,c,d;try{for(var u=Uh(n),h=u.next();!h.done;h=u.next()){var f=h.value;if(f.getPairs().length!==r.length){var m=!0;try{for(var p=(o=void 0,Uh(f.getPairs())),g=p.next();!g.done;g=p.next()){var v=g.value,y=!1;try{for(var j=(c=void 0,Uh(r)),b=j.next();!b.done;b=j.next()){var w=b.value;if(Pk.equals(v,w)){y=!0;break}}}catch(N){c={error:N}}finally{try{b&&!b.done&&(d=j.return)&&d.call(j)}finally{if(c)throw c.error}}y||(m=!1)}}catch(N){o={error:N}}finally{try{g&&!g.done&&(l=p.return)&&l.call(p)}finally{if(o)throw o.error}}}}}catch(N){a={error:N}}finally{try{h&&!h.done&&(i=u.return)&&i.call(u)}finally{if(a)throw a.error}}},t.isPartialRow=function(r,n){var a,i,o,l,c,d;try{for(var u=Uh(n),h=u.next();!h.done;h=u.next()){var f=h.value,m=!0;try{for(var p=(o=void 0,Uh(r)),g=p.next();!g.done;g=p.next()){var v=g.value,y=!1;try{for(var j=(c=void 0,Uh(f.getPairs())),b=j.next();!b.done;b=j.next()){var w=b.value;if(v.equals(w)){y=!0;break}}}catch(N){c={error:N}}finally{try{b&&!b.done&&(d=j.return)&&d.call(j)}finally{if(c)throw c.error}}if(!y){m=!1;break}}}catch(N){o={error:N}}finally{try{g&&!g.done&&(l=p.return)&&l.call(p)}finally{if(o)throw o.error}}if(m)return!0}}catch(N){a={error:N}}finally{try{h&&!h.done&&(i=u.return)&&i.call(u)}finally{if(a)throw a.error}}return!1},t.prototype.getRows=function(){return this.rows},t.constructResult=function(r){var n=Yde.buildBitArray(r),a=pue(n),i=a.parseInformation(),o=r[0].getFinderPattern().getResultPoints(),l=r[r.length-1].getFinderPattern().getResultPoints(),c=[o[0],o[1],l[0],l[1]];return new xl(i,null,null,c,Dr.RSS_EXPANDED,null)},t.prototype.checkChecksum=function(){var r=this.pairs.get(0),n=r.getLeftChar(),a=r.getRightChar();if(a===null)return!1;for(var i=a.getChecksumPortion(),o=2,l=1;l<this.pairs.size();++l){var c=this.pairs.get(l);i+=c.getLeftChar().getChecksumPortion(),o++;var d=c.getRightChar();d!=null&&(i+=d.getChecksumPortion(),o++)}i%=211;var u=211*(o-4)+i;return u===n.getValue()},t.getNextSecondBar=function(r,n){var a;return r.get(n)?(a=r.getNextUnset(n),a=r.getNextSet(a)):(a=r.getNextSet(n),a=r.getNextUnset(a)),a},t.prototype.retrieveNextPair=function(r,n,a){var i=n.length%2===0;this.startFromEven&&(i=!i);var o,l=!0,c=-1;do this.findNextPair(r,n,c),o=this.parseFoundFinderPattern(r,a,i),o===null?c=t.getNextSecondBar(r,this.startEnd[0]):l=!1;while(l);var d=this.decodeDataCharacter(r,o,i,!0);if(!this.isEmptyPair(n)&&n[n.length-1].mustBeLast())throw new es;var u;try{u=this.decodeDataCharacter(r,o,i,!1)}catch(h){u=null,console.log(h)}return new Pk(d,u,o,!0)},t.prototype.isEmptyPair=function(r){return r.length===0},t.prototype.findNextPair=function(r,n,a){var i=this.getDecodeFinderCounters();i[0]=0,i[1]=0,i[2]=0,i[3]=0;var o=r.getSize(),l;if(a>=0)l=a;else if(this.isEmptyPair(n))l=0;else{var c=n[n.length-1];l=c.getFinderPattern().getStartEnd()[1]}var d=n.length%2!==0;this.startFromEven&&(d=!d);for(var u=!1;l<o&&(u=!r.get(l),!!u);)l++;for(var h=0,f=l,m=l;m<o;m++)if(r.get(m)!==u)i[h]++;else{if(h===3){if(d&&t.reverseCounters(i),t.isFinderPattern(i)){this.startEnd[0]=f,this.startEnd[1]=m;return}d&&t.reverseCounters(i),f+=i[0]+i[1],i[0]=i[2],i[1]=i[3],i[2]=0,i[3]=0,h--}else h++;i[h]=1,u=!u}throw new es},t.reverseCounters=function(r){for(var n=r.length,a=0;a<n/2;++a){var i=r[a];r[a]=r[n-a-1],r[n-a-1]=i}},t.prototype.parseFoundFinderPattern=function(r,n,a){var i,o,l;if(a){for(var c=this.startEnd[0]-1;c>=0&&!r.get(c);)c--;c++,i=this.startEnd[0]-c,o=c,l=this.startEnd[1]}else o=this.startEnd[0],l=r.getNextUnset(this.startEnd[1]+1),i=l-this.startEnd[1];var d=this.getDecodeFinderCounters();ei.arraycopy(d,0,d,1,d.length-1),d[0]=i;var u;try{u=this.parseFinderValue(d,t.FINDER_PATTERNS)}catch{return null}return new D9(u,[o,l],o,l,n)},t.prototype.decodeDataCharacter=function(r,n,a,i){for(var o=this.getDataCharacterCounters(),l=0;l<o.length;l++)o[l]=0;if(i)t.recordPatternInReverse(r,n.getStartEnd()[0],o);else{t.recordPattern(r,n.getStartEnd()[1],o);for(var c=0,d=o.length-1;c<d;c++,d--){var u=o[c];o[c]=o[d],o[d]=u}}var h=17,f=ea.sum(new Int32Array(o))/h,m=(n.getStartEnd()[1]-n.getStartEnd()[0])/15;if(Math.abs(f-m)/m>.3)throw new es;for(var p=this.getOddCounts(),g=this.getEvenCounts(),v=this.getOddRoundingErrors(),y=this.getEvenRoundingErrors(),c=0;c<o.length;c++){var j=1*o[c]/f,b=j+.5;if(b<1){if(j<.3)throw new es;b=1}else if(b>8){if(j>8.7)throw new es;b=8}var w=c/2;c&1?(g[w]=b,y[w]=j-b):(p[w]=b,v[w]=j-b)}this.adjustOddEvenCounts(h);for(var N=4*n.getValue()+(a?0:2)+(i?0:1)-1,C=0,S=0,c=p.length-1;c>=0;c--){if(t.isNotA1left(n,a,i)){var _=t.WEIGHTS[N][2*c];S+=p[c]*_}C+=p[c]}for(var k=0,c=g.length-1;c>=0;c--)if(t.isNotA1left(n,a,i)){var _=t.WEIGHTS[N][2*c+1];k+=g[c]*_}var F=S+k;if(C&1||C>13||C<4)throw new es;var A=(13-C)/2,T=t.SYMBOL_WIDEST[A],V=9-T,M=Vx.getRSSvalue(p,T,!0),G=Vx.getRSSvalue(g,V,!1),L=t.EVEN_TOTAL_SUBSET[A],J=t.GSUM[A],z=M*L+G+J;return new E1(z,F)},t.isNotA1left=function(r,n,a){return!(r.getValue()===0&&n&&a)},t.prototype.adjustOddEvenCounts=function(r){var n=ea.sum(new Int32Array(this.getOddCounts())),a=ea.sum(new Int32Array(this.getEvenCounts())),i=!1,o=!1;n>13?o=!0:n<4&&(i=!0);var l=!1,c=!1;a>13?c=!0:a<4&&(l=!0);var d=n+a-r,u=(n&1)===1,h=(a&1)===0;if(d===1)if(u){if(h)throw new es;o=!0}else{if(!h)throw new es;c=!0}else if(d===-1)if(u){if(h)throw new es;i=!0}else{if(!h)throw new es;l=!0}else if(d===0){if(u){if(!h)throw new es;n<a?(i=!0,c=!0):(o=!0,l=!0)}else if(h)throw new es}else throw new es;if(i){if(o)throw new es;t.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(o&&t.decrement(this.getOddCounts(),this.getOddRoundingErrors()),l){if(c)throw new es;t.increment(this.getEvenCounts(),this.getOddRoundingErrors())}c&&t.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},t.SYMBOL_WIDEST=[7,5,4,3,1],t.EVEN_TOTAL_SUBSET=[4,20,52,104,204],t.GSUM=[0,348,1388,2948,3988],t.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],t.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],t.FINDER_PAT_A=0,t.FINDER_PAT_B=1,t.FINDER_PAT_C=2,t.FINDER_PAT_D=3,t.FINDER_PAT_E=4,t.FINDER_PAT_F=5,t.FINDER_PATTERN_SEQUENCES=[[t.FINDER_PAT_A,t.FINDER_PAT_A],[t.FINDER_PAT_A,t.FINDER_PAT_B,t.FINDER_PAT_B],[t.FINDER_PAT_A,t.FINDER_PAT_C,t.FINDER_PAT_B,t.FINDER_PAT_D],[t.FINDER_PAT_A,t.FINDER_PAT_E,t.FINDER_PAT_B,t.FINDER_PAT_D,t.FINDER_PAT_C],[t.FINDER_PAT_A,t.FINDER_PAT_E,t.FINDER_PAT_B,t.FINDER_PAT_D,t.FINDER_PAT_D,t.FINDER_PAT_F],[t.FINDER_PAT_A,t.FINDER_PAT_E,t.FINDER_PAT_B,t.FINDER_PAT_D,t.FINDER_PAT_E,t.FINDER_PAT_F,t.FINDER_PAT_F],[t.FINDER_PAT_A,t.FINDER_PAT_A,t.FINDER_PAT_B,t.FINDER_PAT_B,t.FINDER_PAT_C,t.FINDER_PAT_C,t.FINDER_PAT_D,t.FINDER_PAT_D],[t.FINDER_PAT_A,t.FINDER_PAT_A,t.FINDER_PAT_B,t.FINDER_PAT_B,t.FINDER_PAT_C,t.FINDER_PAT_C,t.FINDER_PAT_D,t.FINDER_PAT_E,t.FINDER_PAT_E],[t.FINDER_PAT_A,t.FINDER_PAT_A,t.FINDER_PAT_B,t.FINDER_PAT_B,t.FINDER_PAT_C,t.FINDER_PAT_C,t.FINDER_PAT_D,t.FINDER_PAT_E,t.FINDER_PAT_F,t.FINDER_PAT_F],[t.FINDER_PAT_A,t.FINDER_PAT_A,t.FINDER_PAT_B,t.FINDER_PAT_B,t.FINDER_PAT_C,t.FINDER_PAT_D,t.FINDER_PAT_D,t.FINDER_PAT_E,t.FINDER_PAT_E,t.FINDER_PAT_F,t.FINDER_PAT_F]],t.MAX_PAIRS=11,t}(hf),jue=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),bue=function(s){jue(t,s);function t(r,n,a){var i=s.call(this,r,n)||this;return i.count=0,i.finderPattern=a,i}return t.prototype.getFinderPattern=function(){return this.finderPattern},t.prototype.getCount=function(){return this.count},t.prototype.incrementCount=function(){this.count++},t}(E1),Nue=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Z2=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},_k=function(s){Nue(t,s);function t(){var r=s!==null&&s.apply(this,arguments)||this;return r.possibleLeftPairs=[],r.possibleRightPairs=[],r}return t.prototype.decodeRow=function(r,n,a){var i,o,l,c,d=this.decodePair(n,!1,r,a);t.addOrTally(this.possibleLeftPairs,d),n.reverse();var u=this.decodePair(n,!0,r,a);t.addOrTally(this.possibleRightPairs,u),n.reverse();try{for(var h=Z2(this.possibleLeftPairs),f=h.next();!f.done;f=h.next()){var m=f.value;if(m.getCount()>1)try{for(var p=(l=void 0,Z2(this.possibleRightPairs)),g=p.next();!g.done;g=p.next()){var v=g.value;if(v.getCount()>1&&t.checkChecksum(m,v))return t.constructResult(m,v)}}catch(y){l={error:y}}finally{try{g&&!g.done&&(c=p.return)&&c.call(p)}finally{if(l)throw l.error}}}}catch(y){i={error:y}}finally{try{f&&!f.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}throw new es},t.addOrTally=function(r,n){var a,i;if(n!=null){var o=!1;try{for(var l=Z2(r),c=l.next();!c.done;c=l.next()){var d=c.value;if(d.getValue()===n.getValue()){d.incrementCount(),o=!0;break}}}catch(u){a={error:u}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(a)throw a.error}}o||r.push(n)}},t.prototype.reset=function(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0},t.constructResult=function(r,n){for(var a=4537077*r.getValue()+n.getValue(),i=new String(a).toString(),o=new En,l=13-i.length;l>0;l--)o.append("0");o.append(i);for(var c=0,l=0;l<13;l++){var d=o.charAt(l).charCodeAt(0)-48;c+=l&1?d:3*d}c=10-c%10,c===10&&(c=0),o.append(c.toString());var u=r.getFinderPattern().getResultPoints(),h=n.getFinderPattern().getResultPoints();return new xl(o.toString(),null,0,[u[0],u[1],h[0],h[1]],Dr.RSS_14,new Date().getTime())},t.checkChecksum=function(r,n){var a=(r.getChecksumPortion()+16*n.getChecksumPortion())%79,i=9*r.getFinderPattern().getValue()+n.getFinderPattern().getValue();return i>72&&i--,i>8&&i--,a===i},t.prototype.decodePair=function(r,n,a,i){try{var o=this.findFinderPattern(r,n),l=this.parseFoundFinderPattern(r,a,n,o),c=i==null?null:i.get(ti.NEED_RESULT_POINT_CALLBACK);if(c!=null){var d=(o[0]+o[1])/2;n&&(d=r.getSize()-1-d),c.foundPossibleResultPoint(new ur(d,a))}var u=this.decodeDataCharacter(r,l,!0),h=this.decodeDataCharacter(r,l,!1);return new bue(1597*u.getValue()+h.getValue(),u.getChecksumPortion()+4*h.getChecksumPortion(),l)}catch{return null}},t.prototype.decodeDataCharacter=function(r,n,a){for(var i=this.getDataCharacterCounters(),o=0;o<i.length;o++)i[o]=0;if(a)Co.recordPatternInReverse(r,n.getStartEnd()[0],i);else{Co.recordPattern(r,n.getStartEnd()[1]+1,i);for(var l=0,c=i.length-1;l<c;l++,c--){var d=i[l];i[l]=i[c],i[c]=d}}for(var u=a?16:15,h=ea.sum(new Int32Array(i))/u,f=this.getOddCounts(),m=this.getEvenCounts(),p=this.getOddRoundingErrors(),g=this.getEvenRoundingErrors(),l=0;l<i.length;l++){var v=i[l]/h,y=Math.floor(v+.5);y<1?y=1:y>8&&(y=8);var j=Math.floor(l/2);l&1?(m[j]=y,g[j]=v-y):(f[j]=y,p[j]=v-y)}this.adjustOddEvenCounts(a,u);for(var b=0,w=0,l=f.length-1;l>=0;l--)w*=9,w+=f[l],b+=f[l];for(var N=0,C=0,l=m.length-1;l>=0;l--)N*=9,N+=m[l],C+=m[l];var S=w+3*N;if(a){if(b&1||b>12||b<4)throw new es;var _=(12-b)/2,k=t.OUTSIDE_ODD_WIDEST[_],F=9-k,A=Vx.getRSSvalue(f,k,!1),T=Vx.getRSSvalue(m,F,!0),V=t.OUTSIDE_EVEN_TOTAL_SUBSET[_],M=t.OUTSIDE_GSUM[_];return new E1(A*V+T+M,S)}else{if(C&1||C>10||C<4)throw new es;var _=(10-C)/2,k=t.INSIDE_ODD_WIDEST[_],F=9-k,A=Vx.getRSSvalue(f,k,!0),T=Vx.getRSSvalue(m,F,!1),G=t.INSIDE_ODD_TOTAL_SUBSET[_],M=t.INSIDE_GSUM[_];return new E1(T*G+A+M,S)}},t.prototype.findFinderPattern=function(r,n){var a=this.getDecodeFinderCounters();a[0]=0,a[1]=0,a[2]=0,a[3]=0;for(var i=r.getSize(),o=!1,l=0;l<i&&(o=!r.get(l),n!==o);)l++;for(var c=0,d=l,u=l;u<i;u++)if(r.get(u)!==o)a[c]++;else{if(c===3){if(hf.isFinderPattern(a))return[d,u];d+=a[0]+a[1],a[0]=a[2],a[1]=a[3],a[2]=0,a[3]=0,c--}else c++;a[c]=1,o=!o}throw new es},t.prototype.parseFoundFinderPattern=function(r,n,a,i){for(var o=r.get(i[0]),l=i[0]-1;l>=0&&o!==r.get(l);)l--;l++;var c=i[0]-l,d=this.getDecodeFinderCounters(),u=new Int32Array(d.length);ei.arraycopy(d,0,u,1,d.length-1),u[0]=c;var h=this.parseFinderValue(u,t.FINDER_PATTERNS),f=l,m=i[1];return a&&(f=r.getSize()-1-f,m=r.getSize()-1-m),new D9(h,[l,i[1]],f,m,n)},t.prototype.adjustOddEvenCounts=function(r,n){var a=ea.sum(new Int32Array(this.getOddCounts())),i=ea.sum(new Int32Array(this.getEvenCounts())),o=!1,l=!1,c=!1,d=!1;r?(a>12?l=!0:a<4&&(o=!0),i>12?d=!0:i<4&&(c=!0)):(a>11?l=!0:a<5&&(o=!0),i>10?d=!0:i<4&&(c=!0));var u=a+i-n,h=(a&1)===(r?1:0),f=(i&1)===1;if(u===1)if(h){if(f)throw new es;l=!0}else{if(!f)throw new es;d=!0}else if(u===-1)if(h){if(f)throw new es;o=!0}else{if(!f)throw new es;c=!0}else if(u===0){if(h){if(!f)throw new es;a<i?(o=!0,d=!0):(l=!0,c=!0)}else if(f)throw new es}else throw new es;if(o){if(l)throw new es;hf.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(l&&hf.decrement(this.getOddCounts(),this.getOddRoundingErrors()),c){if(d)throw new es;hf.increment(this.getEvenCounts(),this.getOddRoundingErrors())}d&&hf.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},t.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],t.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],t.OUTSIDE_GSUM=[0,161,961,2015,2715],t.INSIDE_GSUM=[0,336,1036,1516],t.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],t.INSIDE_ODD_WIDEST=[2,4,6,8],t.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])],t}(hf),wue=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Wx=function(s){wue(t,s);function t(r){var n=s.call(this)||this;n.readers=[];var a=r?r.get(ti.POSSIBLE_FORMATS):null,i=r&&r.get(ti.ASSUME_CODE_39_CHECK_DIGIT)!==void 0,o=r&&r.get(ti.ENABLE_CODE_39_EXTENDED_MODE)!==void 0;return a&&((a.includes(Dr.EAN_13)||a.includes(Dr.UPC_A)||a.includes(Dr.EAN_8)||a.includes(Dr.UPC_E))&&n.readers.push(new Q2(r)),a.includes(Dr.CODE_39)&&n.readers.push(new jk(i,o)),a.includes(Dr.CODE_93)&&n.readers.push(new bk),a.includes(Dr.CODE_128)&&n.readers.push(new yk),a.includes(Dr.ITF)&&n.readers.push(new Nk),a.includes(Dr.CODABAR)&&n.readers.push(new Wde),a.includes(Dr.RSS_14)&&n.readers.push(new _k),a.includes(Dr.RSS_EXPANDED)&&(console.warn("RSS Expanded reader IS NOT ready for production yet! use at your own risk."),n.readers.push(new yue))),n.readers.length===0&&(n.readers.push(new Q2(r)),n.readers.push(new jk),n.readers.push(new bk),n.readers.push(new Q2(r)),n.readers.push(new yk),n.readers.push(new Nk),n.readers.push(new _k)),n}return t.prototype.decodeRow=function(r,n,a){for(var i=0;i<this.readers.length;i++)try{return this.readers[i].decodeRow(r,n,a)}catch{}throw new es},t.prototype.reset=function(){this.readers.forEach(function(r){return r.reset()})},t}(Co),Sue=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(s){Sue(t,s);function t(r,n){return r===void 0&&(r=500),s.call(this,new Wx(n),r,n)||this}return t})(Sg);var kk=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},ca=function(){function s(t,r,n){this.ecCodewords=t,this.ecBlocks=[r],n&&this.ecBlocks.push(n)}return s.prototype.getECCodewords=function(){return this.ecCodewords},s.prototype.getECBlocks=function(){return this.ecBlocks},s}(),aa=function(){function s(t,r){this.count=t,this.dataCodewords=r}return s.prototype.getCount=function(){return this.count},s.prototype.getDataCodewords=function(){return this.dataCodewords},s}(),Cue=function(){function s(t,r,n,a,i,o){var l,c;this.versionNumber=t,this.symbolSizeRows=r,this.symbolSizeColumns=n,this.dataRegionSizeRows=a,this.dataRegionSizeColumns=i,this.ecBlocks=o;var d=0,u=o.getECCodewords(),h=o.getECBlocks();try{for(var f=kk(h),m=f.next();!m.done;m=f.next()){var p=m.value;d+=p.getCount()*(p.getDataCodewords()+u)}}catch(g){l={error:g}}finally{try{m&&!m.done&&(c=f.return)&&c.call(f)}finally{if(l)throw l.error}}this.totalCodewords=d}return s.prototype.getVersionNumber=function(){return this.versionNumber},s.prototype.getSymbolSizeRows=function(){return this.symbolSizeRows},s.prototype.getSymbolSizeColumns=function(){return this.symbolSizeColumns},s.prototype.getDataRegionSizeRows=function(){return this.dataRegionSizeRows},s.prototype.getDataRegionSizeColumns=function(){return this.dataRegionSizeColumns},s.prototype.getTotalCodewords=function(){return this.totalCodewords},s.prototype.getECBlocks=function(){return this.ecBlocks},s.getVersionForDimensions=function(t,r){var n,a;if(t&1||r&1)throw new Ls;try{for(var i=kk(s.VERSIONS),o=i.next();!o.done;o=i.next()){var l=o.value;if(l.symbolSizeRows===t&&l.symbolSizeColumns===r)return l}}catch(c){n={error:c}}finally{try{o&&!o.done&&(a=i.return)&&a.call(i)}finally{if(n)throw n.error}}throw new Ls},s.prototype.toString=function(){return""+this.versionNumber},s.buildVersions=function(){return[new s(1,10,10,8,8,new ca(5,new aa(1,3))),new s(2,12,12,10,10,new ca(7,new aa(1,5))),new s(3,14,14,12,12,new ca(10,new aa(1,8))),new s(4,16,16,14,14,new ca(12,new aa(1,12))),new s(5,18,18,16,16,new ca(14,new aa(1,18))),new s(6,20,20,18,18,new ca(18,new aa(1,22))),new s(7,22,22,20,20,new ca(20,new aa(1,30))),new s(8,24,24,22,22,new ca(24,new aa(1,36))),new s(9,26,26,24,24,new ca(28,new aa(1,44))),new s(10,32,32,14,14,new ca(36,new aa(1,62))),new s(11,36,36,16,16,new ca(42,new aa(1,86))),new s(12,40,40,18,18,new ca(48,new aa(1,114))),new s(13,44,44,20,20,new ca(56,new aa(1,144))),new s(14,48,48,22,22,new ca(68,new aa(1,174))),new s(15,52,52,24,24,new ca(42,new aa(2,102))),new s(16,64,64,14,14,new ca(56,new aa(2,140))),new s(17,72,72,16,16,new ca(36,new aa(4,92))),new s(18,80,80,18,18,new ca(48,new aa(4,114))),new s(19,88,88,20,20,new ca(56,new aa(4,144))),new s(20,96,96,22,22,new ca(68,new aa(4,174))),new s(21,104,104,24,24,new ca(56,new aa(6,136))),new s(22,120,120,18,18,new ca(68,new aa(6,175))),new s(23,132,132,20,20,new ca(62,new aa(8,163))),new s(24,144,144,22,22,new ca(62,new aa(8,156),new aa(2,155))),new s(25,8,18,6,16,new ca(7,new aa(1,5))),new s(26,8,32,6,14,new ca(11,new aa(1,10))),new s(27,12,26,10,24,new ca(14,new aa(1,16))),new s(28,12,36,10,16,new ca(18,new aa(1,22))),new s(29,16,36,14,16,new ca(24,new aa(1,32))),new s(30,16,48,14,22,new ca(28,new aa(1,49)))]},s.VERSIONS=s.buildVersions(),s}(),Aue=function(){function s(t){var r=t.getHeight();if(r<8||r>144||r&1)throw new Ls;this.version=s.readVersion(t),this.mappingBitMatrix=this.extractDataRegion(t),this.readMappingMatrix=new fu(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}return s.prototype.getVersion=function(){return this.version},s.readVersion=function(t){var r=t.getHeight(),n=t.getWidth();return Cue.getVersionForDimensions(r,n)},s.prototype.readCodewords=function(){var t=new Int8Array(this.version.getTotalCodewords()),r=0,n=4,a=0,i=this.mappingBitMatrix.getHeight(),o=this.mappingBitMatrix.getWidth(),l=!1,c=!1,d=!1,u=!1;do if(n===i&&a===0&&!l)t[r++]=this.readCorner1(i,o)&255,n-=2,a+=2,l=!0;else if(n===i-2&&a===0&&o&3&&!c)t[r++]=this.readCorner2(i,o)&255,n-=2,a+=2,c=!0;else if(n===i+4&&a===2&&!(o&7)&&!d)t[r++]=this.readCorner3(i,o)&255,n-=2,a+=2,d=!0;else if(n===i-2&&a===0&&(o&7)===4&&!u)t[r++]=this.readCorner4(i,o)&255,n-=2,a+=2,u=!0;else{do n<i&&a>=0&&!this.readMappingMatrix.get(a,n)&&(t[r++]=this.readUtah(n,a,i,o)&255),n-=2,a+=2;while(n>=0&&a<o);n+=1,a+=3;do n>=0&&a<o&&!this.readMappingMatrix.get(a,n)&&(t[r++]=this.readUtah(n,a,i,o)&255),n+=2,a-=2;while(n<i&&a>=0);n+=3,a+=1}while(n<i||a<o);if(r!==this.version.getTotalCodewords())throw new Ls;return t},s.prototype.readModule=function(t,r,n,a){return t<0&&(t+=n,r+=4-(n+4&7)),r<0&&(r+=a,t+=4-(a+4&7)),this.readMappingMatrix.set(r,t),this.mappingBitMatrix.get(r,t)},s.prototype.readUtah=function(t,r,n,a){var i=0;return this.readModule(t-2,r-2,n,a)&&(i|=1),i<<=1,this.readModule(t-2,r-1,n,a)&&(i|=1),i<<=1,this.readModule(t-1,r-2,n,a)&&(i|=1),i<<=1,this.readModule(t-1,r-1,n,a)&&(i|=1),i<<=1,this.readModule(t-1,r,n,a)&&(i|=1),i<<=1,this.readModule(t,r-2,n,a)&&(i|=1),i<<=1,this.readModule(t,r-1,n,a)&&(i|=1),i<<=1,this.readModule(t,r,n,a)&&(i|=1),i},s.prototype.readCorner1=function(t,r){var n=0;return this.readModule(t-1,0,t,r)&&(n|=1),n<<=1,this.readModule(t-1,1,t,r)&&(n|=1),n<<=1,this.readModule(t-1,2,t,r)&&(n|=1),n<<=1,this.readModule(0,r-2,t,r)&&(n|=1),n<<=1,this.readModule(0,r-1,t,r)&&(n|=1),n<<=1,this.readModule(1,r-1,t,r)&&(n|=1),n<<=1,this.readModule(2,r-1,t,r)&&(n|=1),n<<=1,this.readModule(3,r-1,t,r)&&(n|=1),n},s.prototype.readCorner2=function(t,r){var n=0;return this.readModule(t-3,0,t,r)&&(n|=1),n<<=1,this.readModule(t-2,0,t,r)&&(n|=1),n<<=1,this.readModule(t-1,0,t,r)&&(n|=1),n<<=1,this.readModule(0,r-4,t,r)&&(n|=1),n<<=1,this.readModule(0,r-3,t,r)&&(n|=1),n<<=1,this.readModule(0,r-2,t,r)&&(n|=1),n<<=1,this.readModule(0,r-1,t,r)&&(n|=1),n<<=1,this.readModule(1,r-1,t,r)&&(n|=1),n},s.prototype.readCorner3=function(t,r){var n=0;return this.readModule(t-1,0,t,r)&&(n|=1),n<<=1,this.readModule(t-1,r-1,t,r)&&(n|=1),n<<=1,this.readModule(0,r-3,t,r)&&(n|=1),n<<=1,this.readModule(0,r-2,t,r)&&(n|=1),n<<=1,this.readModule(0,r-1,t,r)&&(n|=1),n<<=1,this.readModule(1,r-3,t,r)&&(n|=1),n<<=1,this.readModule(1,r-2,t,r)&&(n|=1),n<<=1,this.readModule(1,r-1,t,r)&&(n|=1),n},s.prototype.readCorner4=function(t,r){var n=0;return this.readModule(t-3,0,t,r)&&(n|=1),n<<=1,this.readModule(t-2,0,t,r)&&(n|=1),n<<=1,this.readModule(t-1,0,t,r)&&(n|=1),n<<=1,this.readModule(0,r-2,t,r)&&(n|=1),n<<=1,this.readModule(0,r-1,t,r)&&(n|=1),n<<=1,this.readModule(1,r-1,t,r)&&(n|=1),n<<=1,this.readModule(2,r-1,t,r)&&(n|=1),n<<=1,this.readModule(3,r-1,t,r)&&(n|=1),n},s.prototype.extractDataRegion=function(t){var r=this.version.getSymbolSizeRows(),n=this.version.getSymbolSizeColumns();if(t.getHeight()!==r)throw new Or("Dimension of bitMatrix must match the version size");for(var a=this.version.getDataRegionSizeRows(),i=this.version.getDataRegionSizeColumns(),o=r/a|0,l=n/i|0,c=o*a,d=l*i,u=new fu(d,c),h=0;h<o;++h)for(var f=h*a,m=0;m<l;++m)for(var p=m*i,g=0;g<a;++g)for(var v=h*(a+2)+1+g,y=f+g,j=0;j<i;++j){var b=m*(i+2)+1+j;if(t.get(b,v)){var w=p+j;u.set(w,y)}}return u},s}(),Tk=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Eue=function(){function s(t,r){this.numDataCodewords=t,this.codewords=r}return s.getDataBlocks=function(t,r){var n,a,i,o,l=r.getECBlocks(),c=0,d=l.getECBlocks();try{for(var u=Tk(d),h=u.next();!h.done;h=u.next()){var f=h.value;c+=f.getCount()}}catch(M){n={error:M}}finally{try{h&&!h.done&&(a=u.return)&&a.call(u)}finally{if(n)throw n.error}}var m=new Array(c),p=0;try{for(var g=Tk(d),v=g.next();!v.done;v=g.next())for(var f=v.value,y=0;y<f.getCount();y++){var j=f.getDataCodewords(),b=l.getECCodewords()+j;m[p++]=new s(j,new Uint8Array(b))}}catch(M){i={error:M}}finally{try{v&&!v.done&&(o=g.return)&&o.call(g)}finally{if(i)throw i.error}}for(var w=m[0].codewords.length,N=w-l.getECCodewords(),C=N-1,S=0,y=0;y<C;y++)for(var _=0;_<p;_++)m[_].codewords[y]=t[S++];for(var k=r.getVersionNumber()===24,F=k?8:p,_=0;_<F;_++)m[_].codewords[N-1]=t[S++];for(var A=m[0].codewords.length,y=N;y<A;y++)for(var _=0;_<p;_++){var T=k?(_+8)%p:_,V=k&&T>7?y-1:y;m[T].codewords[V]=t[S++]}if(S!==t.length)throw new Or;return m},s.prototype.getNumDataCodewords=function(){return this.numDataCodewords},s.prototype.getCodewords=function(){return this.codewords},s}(),F9=function(){function s(t){this.bytes=t,this.byteOffset=0,this.bitOffset=0}return s.prototype.getBitOffset=function(){return this.bitOffset},s.prototype.getByteOffset=function(){return this.byteOffset},s.prototype.readBits=function(t){if(t<1||t>32||t>this.available())throw new Or(""+t);var r=0,n=this.bitOffset,a=this.byteOffset,i=this.bytes;if(n>0){var o=8-n,l=t<o?t:o,c=o-l,d=255>>8-l<<c;r=(i[a]&d)>>c,t-=l,n+=l,n===8&&(n=0,a++)}if(t>0){for(;t>=8;)r=r<<8|i[a]&255,a++,t-=8;if(t>0){var c=8-t,d=255>>c<<c;r=r<<t|(i[a]&d)>>c,n+=t}}return this.bitOffset=n,this.byteOffset=a,r},s.prototype.available=function(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset},s}(),fo;(function(s){s[s.PAD_ENCODE=0]="PAD_ENCODE",s[s.ASCII_ENCODE=1]="ASCII_ENCODE",s[s.C40_ENCODE=2]="C40_ENCODE",s[s.TEXT_ENCODE=3]="TEXT_ENCODE",s[s.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",s[s.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",s[s.BASE256_ENCODE=6]="BASE256_ENCODE"})(fo||(fo={}));var Iue=function(){function s(){}return s.decode=function(t){var r=new F9(t),n=new En,a=new En,i=new Array,o=fo.ASCII_ENCODE;do if(o===fo.ASCII_ENCODE)o=this.decodeAsciiSegment(r,n,a);else{switch(o){case fo.C40_ENCODE:this.decodeC40Segment(r,n);break;case fo.TEXT_ENCODE:this.decodeTextSegment(r,n);break;case fo.ANSIX12_ENCODE:this.decodeAnsiX12Segment(r,n);break;case fo.EDIFACT_ENCODE:this.decodeEdifactSegment(r,n);break;case fo.BASE256_ENCODE:this.decodeBase256Segment(r,n,i);break;default:throw new Ls}o=fo.ASCII_ENCODE}while(o!==fo.PAD_ENCODE&&r.available()>0);return a.length()>0&&n.append(a.toString()),new NN(t,n.toString(),i.length===0?null:i,null)},s.decodeAsciiSegment=function(t,r,n){var a=!1;do{var i=t.readBits(8);if(i===0)throw new Ls;if(i<=128)return a&&(i+=128),r.append(String.fromCharCode(i-1)),fo.ASCII_ENCODE;if(i===129)return fo.PAD_ENCODE;if(i<=229){var o=i-130;o<10&&r.append("0"),r.append(""+o)}else switch(i){case 230:return fo.C40_ENCODE;case 231:return fo.BASE256_ENCODE;case 232:r.append("");break;case 233:case 234:break;case 235:a=!0;break;case 236:r.append("[)>05"),n.insert(0,"");break;case 237:r.append("[)>06"),n.insert(0,"");break;case 238:return fo.ANSIX12_ENCODE;case 239:return fo.TEXT_ENCODE;case 240:return fo.EDIFACT_ENCODE;case 241:break;default:if(i!==254||t.available()!==0)throw new Ls;break}}while(t.available()>0);return fo.ASCII_ENCODE},s.decodeC40Segment=function(t,r){var n=!1,a=[],i=0;do{if(t.available()===8)return;var o=t.readBits(8);if(o===254)return;this.parseTwoBytes(o,t.readBits(8),a);for(var l=0;l<3;l++){var c=a[l];switch(i){case 0:if(c<3)i=c+1;else if(c<this.C40_BASIC_SET_CHARS.length){var d=this.C40_BASIC_SET_CHARS[c];n?(r.append(String.fromCharCode(d.charCodeAt(0)+128)),n=!1):r.append(d)}else throw new Ls;break;case 1:n?(r.append(String.fromCharCode(c+128)),n=!1):r.append(String.fromCharCode(c)),i=0;break;case 2:if(c<this.C40_SHIFT2_SET_CHARS.length){var d=this.C40_SHIFT2_SET_CHARS[c];n?(r.append(String.fromCharCode(d.charCodeAt(0)+128)),n=!1):r.append(d)}else switch(c){case 27:r.append("");break;case 30:n=!0;break;default:throw new Ls}i=0;break;case 3:n?(r.append(String.fromCharCode(c+224)),n=!1):r.append(String.fromCharCode(c+96)),i=0;break;default:throw new Ls}}}while(t.available()>0)},s.decodeTextSegment=function(t,r){var n=!1,a=[],i=0;do{if(t.available()===8)return;var o=t.readBits(8);if(o===254)return;this.parseTwoBytes(o,t.readBits(8),a);for(var l=0;l<3;l++){var c=a[l];switch(i){case 0:if(c<3)i=c+1;else if(c<this.TEXT_BASIC_SET_CHARS.length){var d=this.TEXT_BASIC_SET_CHARS[c];n?(r.append(String.fromCharCode(d.charCodeAt(0)+128)),n=!1):r.append(d)}else throw new Ls;break;case 1:n?(r.append(String.fromCharCode(c+128)),n=!1):r.append(String.fromCharCode(c)),i=0;break;case 2:if(c<this.TEXT_SHIFT2_SET_CHARS.length){var d=this.TEXT_SHIFT2_SET_CHARS[c];n?(r.append(String.fromCharCode(d.charCodeAt(0)+128)),n=!1):r.append(d)}else switch(c){case 27:r.append("");break;case 30:n=!0;break;default:throw new Ls}i=0;break;case 3:if(c<this.TEXT_SHIFT3_SET_CHARS.length){var d=this.TEXT_SHIFT3_SET_CHARS[c];n?(r.append(String.fromCharCode(d.charCodeAt(0)+128)),n=!1):r.append(d),i=0}else throw new Ls;break;default:throw new Ls}}}while(t.available()>0)},s.decodeAnsiX12Segment=function(t,r){var n=[];do{if(t.available()===8)return;var a=t.readBits(8);if(a===254)return;this.parseTwoBytes(a,t.readBits(8),n);for(var i=0;i<3;i++){var o=n[i];switch(o){case 0:r.append("\r");break;case 1:r.append("*");break;case 2:r.append(">");break;case 3:r.append(" ");break;default:if(o<14)r.append(String.fromCharCode(o+44));else if(o<40)r.append(String.fromCharCode(o+51));else throw new Ls;break}}}while(t.available()>0)},s.parseTwoBytes=function(t,r,n){var a=(t<<8)+r-1,i=Math.floor(a/1600);n[0]=i,a-=i*1600,i=Math.floor(a/40),n[1]=i,n[2]=a-i*40},s.decodeEdifactSegment=function(t,r){do{if(t.available()<=16)return;for(var n=0;n<4;n++){var a=t.readBits(6);if(a===31){var i=8-t.getBitOffset();i!==8&&t.readBits(i);return}a&32||(a|=64),r.append(String.fromCharCode(a))}}while(t.available()>0)},s.decodeBase256Segment=function(t,r,n){var a=1+t.getByteOffset(),i=this.unrandomize255State(t.readBits(8),a++),o;if(i===0?o=t.available()/8|0:i<250?o=i:o=250*(i-249)+this.unrandomize255State(t.readBits(8),a++),o<0)throw new Ls;for(var l=new Uint8Array(o),c=0;c<o;c++){if(t.available()<8)throw new Ls;l[c]=this.unrandomize255State(t.readBits(8),a++)}n.push(l);try{r.append(td.decode(l,Gn.ISO88591))}catch(d){throw new hy("Platform does not support required encoding: "+d.message)}},s.unrandomize255State=function(t,r){var n=149*r%255+1,a=t-n;return a>=0?a:a+256},s.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],s.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],s.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],s.TEXT_SHIFT2_SET_CHARS=s.C40_SHIFT2_SET_CHARS,s.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""],s}(),Pue=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},_ue=function(){function s(){this.rsDecoder=new wN(ec.DATA_MATRIX_FIELD_256)}return s.prototype.decode=function(t){var r,n,a=new Aue(t),i=a.getVersion(),o=a.readCodewords(),l=Eue.getDataBlocks(o,i),c=0;try{for(var d=Pue(l),u=d.next();!u.done;u=d.next()){var h=u.value;c+=h.getNumDataCodewords()}}catch(b){r={error:b}}finally{try{u&&!u.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}for(var f=new Uint8Array(c),m=l.length,p=0;p<m;p++){var g=l[p],v=g.getCodewords(),y=g.getNumDataCodewords();this.correctErrors(v,y);for(var j=0;j<y;j++)f[j*m+p]=v[j]}return Iue.decode(f)},s.prototype.correctErrors=function(t,r){var n=new Int32Array(t);try{this.rsDecoder.decode(n,t.length-r)}catch{throw new no}for(var a=0;a<r;a++)t[a]=n[a]},s}(),kue=function(){function s(t){this.image=t,this.rectangleDetector=new y4(this.image)}return s.prototype.detect=function(){var t=this.rectangleDetector.detect(),r=this.detectSolid1(t);if(r=this.detectSolid2(r),r[3]=this.correctTopRight(r),!r[3])throw new es;r=this.shiftToModuleCenter(r);var n=r[0],a=r[1],i=r[2],o=r[3],l=this.transitionsBetween(n,o)+1,c=this.transitionsBetween(i,o)+1;(l&1)===1&&(l+=1),(c&1)===1&&(c+=1),4*l<7*c&&4*c<7*l&&(l=c=Math.max(l,c));var d=s.sampleGrid(this.image,n,a,i,o,l,c);return new S3(d,[n,a,i,o])},s.shiftPoint=function(t,r,n){var a=(r.getX()-t.getX())/(n+1),i=(r.getY()-t.getY())/(n+1);return new ur(t.getX()+a,t.getY()+i)},s.moveAway=function(t,r,n){var a=t.getX(),i=t.getY();return a<r?a-=1:a+=1,i<n?i-=1:i+=1,new ur(a,i)},s.prototype.detectSolid1=function(t){var r=t[0],n=t[1],a=t[3],i=t[2],o=this.transitionsBetween(r,n),l=this.transitionsBetween(n,a),c=this.transitionsBetween(a,i),d=this.transitionsBetween(i,r),u=o,h=[i,r,n,a];return u>l&&(u=l,h[0]=r,h[1]=n,h[2]=a,h[3]=i),u>c&&(u=c,h[0]=n,h[1]=a,h[2]=i,h[3]=r),u>d&&(h[0]=a,h[1]=i,h[2]=r,h[3]=n),h},s.prototype.detectSolid2=function(t){var r=t[0],n=t[1],a=t[2],i=t[3],o=this.transitionsBetween(r,i),l=s.shiftPoint(n,a,(o+1)*4),c=s.shiftPoint(a,n,(o+1)*4),d=this.transitionsBetween(l,r),u=this.transitionsBetween(c,i);return d<u?(t[0]=r,t[1]=n,t[2]=a,t[3]=i):(t[0]=n,t[1]=a,t[2]=i,t[3]=r),t},s.prototype.correctTopRight=function(t){var r=t[0],n=t[1],a=t[2],i=t[3],o=this.transitionsBetween(r,i),l=this.transitionsBetween(n,i),c=s.shiftPoint(r,n,(l+1)*4),d=s.shiftPoint(a,n,(o+1)*4);o=this.transitionsBetween(c,i),l=this.transitionsBetween(d,i);var u=new ur(i.getX()+(a.getX()-n.getX())/(o+1),i.getY()+(a.getY()-n.getY())/(o+1)),h=new ur(i.getX()+(r.getX()-n.getX())/(l+1),i.getY()+(r.getY()-n.getY())/(l+1));if(!this.isValid(u))return this.isValid(h)?h:null;if(!this.isValid(h))return u;var f=this.transitionsBetween(c,u)+this.transitionsBetween(d,u),m=this.transitionsBetween(c,h)+this.transitionsBetween(d,h);return f>m?u:h},s.prototype.shiftToModuleCenter=function(t){var r=t[0],n=t[1],a=t[2],i=t[3],o=this.transitionsBetween(r,i)+1,l=this.transitionsBetween(a,i)+1,c=s.shiftPoint(r,n,l*4),d=s.shiftPoint(a,n,o*4);o=this.transitionsBetween(c,i)+1,l=this.transitionsBetween(d,i)+1,(o&1)===1&&(o+=1),(l&1)===1&&(l+=1);var u=(r.getX()+n.getX()+a.getX()+i.getX())/4,h=(r.getY()+n.getY()+a.getY()+i.getY())/4;r=s.moveAway(r,u,h),n=s.moveAway(n,u,h),a=s.moveAway(a,u,h),i=s.moveAway(i,u,h);var f,m;return c=s.shiftPoint(r,n,l*4),c=s.shiftPoint(c,i,o*4),f=s.shiftPoint(n,r,l*4),f=s.shiftPoint(f,a,o*4),d=s.shiftPoint(a,i,l*4),d=s.shiftPoint(d,n,o*4),m=s.shiftPoint(i,a,l*4),m=s.shiftPoint(m,r,o*4),[c,f,d,m]},s.prototype.isValid=function(t){return t.getX()>=0&&t.getX()<this.image.getWidth()&&t.getY()>0&&t.getY()<this.image.getHeight()},s.sampleGrid=function(t,r,n,a,i,o,l){var c=C3.getInstance();return c.sampleGrid(t,o,l,.5,.5,o-.5,.5,o-.5,l-.5,.5,l-.5,r.getX(),r.getY(),i.getX(),i.getY(),a.getX(),a.getY(),n.getX(),n.getY())},s.prototype.transitionsBetween=function(t,r){var n=Math.trunc(t.getX()),a=Math.trunc(t.getY()),i=Math.trunc(r.getX()),o=Math.trunc(r.getY()),l=Math.abs(o-a)>Math.abs(i-n);if(l){var c=n;n=a,a=c,c=i,i=o,o=c}for(var d=Math.abs(i-n),u=Math.abs(o-a),h=-d/2,f=a<o?1:-1,m=n<i?1:-1,p=0,g=this.image.get(l?a:n,l?n:a),v=n,y=a;v!==i;v+=m){var j=this.image.get(l?y:v,l?v:y);if(j!==g&&(p++,g=j),h+=u,h>0){if(y===o)break;y+=f,h-=d}}return p},s}(),I1=function(){function s(){this.decoder=new _ue}return s.prototype.decode=function(t,r){r===void 0&&(r=null);var n,a;if(r!=null&&r.has(ti.PURE_BARCODE)){var i=s.extractPureBits(t.getBlackMatrix());n=this.decoder.decode(i),a=s.NO_POINTS}else{var o=new kue(t.getBlackMatrix()).detect();n=this.decoder.decode(o.getBits()),a=o.getPoints()}var l=n.getRawBytes(),c=new xl(n.getText(),l,8*l.length,a,Dr.DATA_MATRIX,ei.currentTimeMillis()),d=n.getByteSegments();d!=null&&c.putMetadata(Xo.BYTE_SEGMENTS,d);var u=n.getECLevel();return u!=null&&c.putMetadata(Xo.ERROR_CORRECTION_LEVEL,u),c},s.prototype.reset=function(){},s.extractPureBits=function(t){var r=t.getTopLeftOnBit(),n=t.getBottomRightOnBit();if(r==null||n==null)throw new es;var a=this.moduleSize(r,t),i=r[1],o=n[1],l=r[0],c=n[0],d=(c-l+1)/a,u=(o-i+1)/a;if(d<=0||u<=0)throw new es;var h=a/2;i+=h,l+=h;for(var f=new fu(d,u),m=0;m<u;m++)for(var p=i+m*a,g=0;g<d;g++)t.get(l+g*a,p)&&f.set(g,m);return f},s.moduleSize=function(t,r){for(var n=r.getWidth(),a=t[0],i=t[1];a<n&&r.get(a,i);)a++;if(a===n)throw new es;var o=a-t[0];if(o===0)throw new es;return o},s.NO_POINTS=[],s}(),Tue=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(s){Tue(t,s);function t(r){return r===void 0&&(r=500),s.call(this,new I1,r)||this}return t})(Sg);var Hx;(function(s){s[s.L=0]="L",s[s.M=1]="M",s[s.Q=2]="Q",s[s.H=3]="H"})(Hx||(Hx={}));var Due=function(){function s(t,r,n){this.value=t,this.stringValue=r,this.bits=n,s.FOR_BITS.set(n,this),s.FOR_VALUE.set(t,this)}return s.prototype.getValue=function(){return this.value},s.prototype.getBits=function(){return this.bits},s.fromString=function(t){switch(t){case"L":return s.L;case"M":return s.M;case"Q":return s.Q;case"H":return s.H;default:throw new Li(t+"not available")}},s.prototype.toString=function(){return this.stringValue},s.prototype.equals=function(t){if(!(t instanceof s))return!1;var r=t;return this.value===r.value},s.forBits=function(t){if(t<0||t>=s.FOR_BITS.size)throw new Or;return s.FOR_BITS.get(t)},s.FOR_BITS=new Map,s.FOR_VALUE=new Map,s.L=new s(Hx.L,"L",1),s.M=new s(Hx.M,"M",0),s.Q=new s(Hx.Q,"Q",3),s.H=new s(Hx.H,"H",2),s}(),Oue=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},M9=function(){function s(t){this.errorCorrectionLevel=Due.forBits(t>>3&3),this.dataMask=t&7}return s.numBitsDiffering=function(t,r){return _n.bitCount(t^r)},s.decodeFormatInformation=function(t,r){var n=s.doDecodeFormatInformation(t,r);return n!==null?n:s.doDecodeFormatInformation(t^s.FORMAT_INFO_MASK_QR,r^s.FORMAT_INFO_MASK_QR)},s.doDecodeFormatInformation=function(t,r){var n,a,i=Number.MAX_SAFE_INTEGER,o=0;try{for(var l=Oue(s.FORMAT_INFO_DECODE_LOOKUP),c=l.next();!c.done;c=l.next()){var d=c.value,u=d[0];if(u===t||u===r)return new s(d[1]);var h=s.numBitsDiffering(t,u);h<i&&(o=d[1],i=h),t!==r&&(h=s.numBitsDiffering(r,u),h<i&&(o=d[1],i=h))}}catch(f){n={error:f}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}return i<=3?new s(o):null},s.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},s.prototype.getDataMask=function(){return this.dataMask},s.prototype.hashCode=function(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask},s.prototype.equals=function(t){if(!(t instanceof s))return!1;var r=t;return this.errorCorrectionLevel===r.errorCorrectionLevel&&this.dataMask===r.dataMask},s.FORMAT_INFO_MASK_QR=21522,s.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])],s}(),Rue=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Mt=function(){function s(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.ecCodewordsPerBlock=t,this.ecBlocks=r}return s.prototype.getECCodewordsPerBlock=function(){return this.ecCodewordsPerBlock},s.prototype.getNumBlocks=function(){var t,r,n=0,a=this.ecBlocks;try{for(var i=Rue(a),o=i.next();!o.done;o=i.next()){var l=o.value;n+=l.getCount()}}catch(c){t={error:c}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n},s.prototype.getTotalECCodewords=function(){return this.ecCodewordsPerBlock*this.getNumBlocks()},s.prototype.getECBlocks=function(){return this.ecBlocks},s}(),Ye=function(){function s(t,r){this.count=t,this.dataCodewords=r}return s.prototype.getCount=function(){return this.count},s.prototype.getDataCodewords=function(){return this.dataCodewords},s}(),Fue=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},qf=function(){function s(t,r){for(var n,a,i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];this.versionNumber=t,this.alignmentPatternCenters=r,this.ecBlocks=i;var l=0,c=i[0].getECCodewordsPerBlock(),d=i[0].getECBlocks();try{for(var u=Fue(d),h=u.next();!h.done;h=u.next()){var f=h.value;l+=f.getCount()*(f.getDataCodewords()+c)}}catch(m){n={error:m}}finally{try{h&&!h.done&&(a=u.return)&&a.call(u)}finally{if(n)throw n.error}}this.totalCodewords=l}return s.prototype.getVersionNumber=function(){return this.versionNumber},s.prototype.getAlignmentPatternCenters=function(){return this.alignmentPatternCenters},s.prototype.getTotalCodewords=function(){return this.totalCodewords},s.prototype.getDimensionForVersion=function(){return 17+4*this.versionNumber},s.prototype.getECBlocksForLevel=function(t){return this.ecBlocks[t.getValue()]},s.getProvisionalVersionForDimension=function(t){if(t%4!==1)throw new Ls;try{return this.getVersionForNumber((t-17)/4)}catch{throw new Ls}},s.getVersionForNumber=function(t){if(t<1||t>40)throw new Or;return s.VERSIONS[t-1]},s.decodeVersionInformation=function(t){for(var r=Number.MAX_SAFE_INTEGER,n=0,a=0;a<s.VERSION_DECODE_INFO.length;a++){var i=s.VERSION_DECODE_INFO[a];if(i===t)return s.getVersionForNumber(a+7);var o=M9.numBitsDiffering(t,i);o<r&&(n=a+7,r=o)}return r<=3?s.getVersionForNumber(n):null},s.prototype.buildFunctionPattern=function(){var t=this.getDimensionForVersion(),r=new fu(t);r.setRegion(0,0,9,9),r.setRegion(t-8,0,8,9),r.setRegion(0,t-8,9,8);for(var n=this.alignmentPatternCenters.length,a=0;a<n;a++)for(var i=this.alignmentPatternCenters[a]-2,o=0;o<n;o++)a===0&&(o===0||o===n-1)||a===n-1&&o===0||r.setRegion(this.alignmentPatternCenters[o]-2,i,5,5);return r.setRegion(6,9,1,t-17),r.setRegion(9,6,t-17,1),this.versionNumber>6&&(r.setRegion(t-11,0,3,6),r.setRegion(0,t-11,6,3)),r},s.prototype.toString=function(){return""+this.versionNumber},s.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),s.VERSIONS=[new s(1,new Int32Array(0),new Mt(7,new Ye(1,19)),new Mt(10,new Ye(1,16)),new Mt(13,new Ye(1,13)),new Mt(17,new Ye(1,9))),new s(2,Int32Array.from([6,18]),new Mt(10,new Ye(1,34)),new Mt(16,new Ye(1,28)),new Mt(22,new Ye(1,22)),new Mt(28,new Ye(1,16))),new s(3,Int32Array.from([6,22]),new Mt(15,new Ye(1,55)),new Mt(26,new Ye(1,44)),new Mt(18,new Ye(2,17)),new Mt(22,new Ye(2,13))),new s(4,Int32Array.from([6,26]),new Mt(20,new Ye(1,80)),new Mt(18,new Ye(2,32)),new Mt(26,new Ye(2,24)),new Mt(16,new Ye(4,9))),new s(5,Int32Array.from([6,30]),new Mt(26,new Ye(1,108)),new Mt(24,new Ye(2,43)),new Mt(18,new Ye(2,15),new Ye(2,16)),new Mt(22,new Ye(2,11),new Ye(2,12))),new s(6,Int32Array.from([6,34]),new Mt(18,new Ye(2,68)),new Mt(16,new Ye(4,27)),new Mt(24,new Ye(4,19)),new Mt(28,new Ye(4,15))),new s(7,Int32Array.from([6,22,38]),new Mt(20,new Ye(2,78)),new Mt(18,new Ye(4,31)),new Mt(18,new Ye(2,14),new Ye(4,15)),new Mt(26,new Ye(4,13),new Ye(1,14))),new s(8,Int32Array.from([6,24,42]),new Mt(24,new Ye(2,97)),new Mt(22,new Ye(2,38),new Ye(2,39)),new Mt(22,new Ye(4,18),new Ye(2,19)),new Mt(26,new Ye(4,14),new Ye(2,15))),new s(9,Int32Array.from([6,26,46]),new Mt(30,new Ye(2,116)),new Mt(22,new Ye(3,36),new Ye(2,37)),new Mt(20,new Ye(4,16),new Ye(4,17)),new Mt(24,new Ye(4,12),new Ye(4,13))),new s(10,Int32Array.from([6,28,50]),new Mt(18,new Ye(2,68),new Ye(2,69)),new Mt(26,new Ye(4,43),new Ye(1,44)),new Mt(24,new Ye(6,19),new Ye(2,20)),new Mt(28,new Ye(6,15),new Ye(2,16))),new s(11,Int32Array.from([6,30,54]),new Mt(20,new Ye(4,81)),new Mt(30,new Ye(1,50),new Ye(4,51)),new Mt(28,new Ye(4,22),new Ye(4,23)),new Mt(24,new Ye(3,12),new Ye(8,13))),new s(12,Int32Array.from([6,32,58]),new Mt(24,new Ye(2,92),new Ye(2,93)),new Mt(22,new Ye(6,36),new Ye(2,37)),new Mt(26,new Ye(4,20),new Ye(6,21)),new Mt(28,new Ye(7,14),new Ye(4,15))),new s(13,Int32Array.from([6,34,62]),new Mt(26,new Ye(4,107)),new Mt(22,new Ye(8,37),new Ye(1,38)),new Mt(24,new Ye(8,20),new Ye(4,21)),new Mt(22,new Ye(12,11),new Ye(4,12))),new s(14,Int32Array.from([6,26,46,66]),new Mt(30,new Ye(3,115),new Ye(1,116)),new Mt(24,new Ye(4,40),new Ye(5,41)),new Mt(20,new Ye(11,16),new Ye(5,17)),new Mt(24,new Ye(11,12),new Ye(5,13))),new s(15,Int32Array.from([6,26,48,70]),new Mt(22,new Ye(5,87),new Ye(1,88)),new Mt(24,new Ye(5,41),new Ye(5,42)),new Mt(30,new Ye(5,24),new Ye(7,25)),new Mt(24,new Ye(11,12),new Ye(7,13))),new s(16,Int32Array.from([6,26,50,74]),new Mt(24,new Ye(5,98),new Ye(1,99)),new Mt(28,new Ye(7,45),new Ye(3,46)),new Mt(24,new Ye(15,19),new Ye(2,20)),new Mt(30,new Ye(3,15),new Ye(13,16))),new s(17,Int32Array.from([6,30,54,78]),new Mt(28,new Ye(1,107),new Ye(5,108)),new Mt(28,new Ye(10,46),new Ye(1,47)),new Mt(28,new Ye(1,22),new Ye(15,23)),new Mt(28,new Ye(2,14),new Ye(17,15))),new s(18,Int32Array.from([6,30,56,82]),new Mt(30,new Ye(5,120),new Ye(1,121)),new Mt(26,new Ye(9,43),new Ye(4,44)),new Mt(28,new Ye(17,22),new Ye(1,23)),new Mt(28,new Ye(2,14),new Ye(19,15))),new s(19,Int32Array.from([6,30,58,86]),new Mt(28,new Ye(3,113),new Ye(4,114)),new Mt(26,new Ye(3,44),new Ye(11,45)),new Mt(26,new Ye(17,21),new Ye(4,22)),new Mt(26,new Ye(9,13),new Ye(16,14))),new s(20,Int32Array.from([6,34,62,90]),new Mt(28,new Ye(3,107),new Ye(5,108)),new Mt(26,new Ye(3,41),new Ye(13,42)),new Mt(30,new Ye(15,24),new Ye(5,25)),new Mt(28,new Ye(15,15),new Ye(10,16))),new s(21,Int32Array.from([6,28,50,72,94]),new Mt(28,new Ye(4,116),new Ye(4,117)),new Mt(26,new Ye(17,42)),new Mt(28,new Ye(17,22),new Ye(6,23)),new Mt(30,new Ye(19,16),new Ye(6,17))),new s(22,Int32Array.from([6,26,50,74,98]),new Mt(28,new Ye(2,111),new Ye(7,112)),new Mt(28,new Ye(17,46)),new Mt(30,new Ye(7,24),new Ye(16,25)),new Mt(24,new Ye(34,13))),new s(23,Int32Array.from([6,30,54,78,102]),new Mt(30,new Ye(4,121),new Ye(5,122)),new Mt(28,new Ye(4,47),new Ye(14,48)),new Mt(30,new Ye(11,24),new Ye(14,25)),new Mt(30,new Ye(16,15),new Ye(14,16))),new s(24,Int32Array.from([6,28,54,80,106]),new Mt(30,new Ye(6,117),new Ye(4,118)),new Mt(28,new Ye(6,45),new Ye(14,46)),new Mt(30,new Ye(11,24),new Ye(16,25)),new Mt(30,new Ye(30,16),new Ye(2,17))),new s(25,Int32Array.from([6,32,58,84,110]),new Mt(26,new Ye(8,106),new Ye(4,107)),new Mt(28,new Ye(8,47),new Ye(13,48)),new Mt(30,new Ye(7,24),new Ye(22,25)),new Mt(30,new Ye(22,15),new Ye(13,16))),new s(26,Int32Array.from([6,30,58,86,114]),new Mt(28,new Ye(10,114),new Ye(2,115)),new Mt(28,new Ye(19,46),new Ye(4,47)),new Mt(28,new Ye(28,22),new Ye(6,23)),new Mt(30,new Ye(33,16),new Ye(4,17))),new s(27,Int32Array.from([6,34,62,90,118]),new Mt(30,new Ye(8,122),new Ye(4,123)),new Mt(28,new Ye(22,45),new Ye(3,46)),new Mt(30,new Ye(8,23),new Ye(26,24)),new Mt(30,new Ye(12,15),new Ye(28,16))),new s(28,Int32Array.from([6,26,50,74,98,122]),new Mt(30,new Ye(3,117),new Ye(10,118)),new Mt(28,new Ye(3,45),new Ye(23,46)),new Mt(30,new Ye(4,24),new Ye(31,25)),new Mt(30,new Ye(11,15),new Ye(31,16))),new s(29,Int32Array.from([6,30,54,78,102,126]),new Mt(30,new Ye(7,116),new Ye(7,117)),new Mt(28,new Ye(21,45),new Ye(7,46)),new Mt(30,new Ye(1,23),new Ye(37,24)),new Mt(30,new Ye(19,15),new Ye(26,16))),new s(30,Int32Array.from([6,26,52,78,104,130]),new Mt(30,new Ye(5,115),new Ye(10,116)),new Mt(28,new Ye(19,47),new Ye(10,48)),new Mt(30,new Ye(15,24),new Ye(25,25)),new Mt(30,new Ye(23,15),new Ye(25,16))),new s(31,Int32Array.from([6,30,56,82,108,134]),new Mt(30,new Ye(13,115),new Ye(3,116)),new Mt(28,new Ye(2,46),new Ye(29,47)),new Mt(30,new Ye(42,24),new Ye(1,25)),new Mt(30,new Ye(23,15),new Ye(28,16))),new s(32,Int32Array.from([6,34,60,86,112,138]),new Mt(30,new Ye(17,115)),new Mt(28,new Ye(10,46),new Ye(23,47)),new Mt(30,new Ye(10,24),new Ye(35,25)),new Mt(30,new Ye(19,15),new Ye(35,16))),new s(33,Int32Array.from([6,30,58,86,114,142]),new Mt(30,new Ye(17,115),new Ye(1,116)),new Mt(28,new Ye(14,46),new Ye(21,47)),new Mt(30,new Ye(29,24),new Ye(19,25)),new Mt(30,new Ye(11,15),new Ye(46,16))),new s(34,Int32Array.from([6,34,62,90,118,146]),new Mt(30,new Ye(13,115),new Ye(6,116)),new Mt(28,new Ye(14,46),new Ye(23,47)),new Mt(30,new Ye(44,24),new Ye(7,25)),new Mt(30,new Ye(59,16),new Ye(1,17))),new s(35,Int32Array.from([6,30,54,78,102,126,150]),new Mt(30,new Ye(12,121),new Ye(7,122)),new Mt(28,new Ye(12,47),new Ye(26,48)),new Mt(30,new Ye(39,24),new Ye(14,25)),new Mt(30,new Ye(22,15),new Ye(41,16))),new s(36,Int32Array.from([6,24,50,76,102,128,154]),new Mt(30,new Ye(6,121),new Ye(14,122)),new Mt(28,new Ye(6,47),new Ye(34,48)),new Mt(30,new Ye(46,24),new Ye(10,25)),new Mt(30,new Ye(2,15),new Ye(64,16))),new s(37,Int32Array.from([6,28,54,80,106,132,158]),new Mt(30,new Ye(17,122),new Ye(4,123)),new Mt(28,new Ye(29,46),new Ye(14,47)),new Mt(30,new Ye(49,24),new Ye(10,25)),new Mt(30,new Ye(24,15),new Ye(46,16))),new s(38,Int32Array.from([6,32,58,84,110,136,162]),new Mt(30,new Ye(4,122),new Ye(18,123)),new Mt(28,new Ye(13,46),new Ye(32,47)),new Mt(30,new Ye(48,24),new Ye(14,25)),new Mt(30,new Ye(42,15),new Ye(32,16))),new s(39,Int32Array.from([6,26,54,82,110,138,166]),new Mt(30,new Ye(20,117),new Ye(4,118)),new Mt(28,new Ye(40,47),new Ye(7,48)),new Mt(30,new Ye(43,24),new Ye(22,25)),new Mt(30,new Ye(10,15),new Ye(67,16))),new s(40,Int32Array.from([6,30,58,86,114,142,170]),new Mt(30,new Ye(19,118),new Ye(6,119)),new Mt(28,new Ye(18,47),new Ye(31,48)),new Mt(30,new Ye(34,24),new Ye(34,25)),new Mt(30,new Ye(20,15),new Ye(61,16)))],s}(),To;(function(s){s[s.DATA_MASK_000=0]="DATA_MASK_000",s[s.DATA_MASK_001=1]="DATA_MASK_001",s[s.DATA_MASK_010=2]="DATA_MASK_010",s[s.DATA_MASK_011=3]="DATA_MASK_011",s[s.DATA_MASK_100=4]="DATA_MASK_100",s[s.DATA_MASK_101=5]="DATA_MASK_101",s[s.DATA_MASK_110=6]="DATA_MASK_110",s[s.DATA_MASK_111=7]="DATA_MASK_111"})(To||(To={}));var Dk=function(){function s(t,r){this.value=t,this.isMasked=r}return s.prototype.unmaskBitMatrix=function(t,r){for(var n=0;n<r;n++)for(var a=0;a<r;a++)this.isMasked(n,a)&&t.flip(a,n)},s.values=new Map([[To.DATA_MASK_000,new s(To.DATA_MASK_000,function(t,r){return(t+r&1)===0})],[To.DATA_MASK_001,new s(To.DATA_MASK_001,function(t,r){return(t&1)===0})],[To.DATA_MASK_010,new s(To.DATA_MASK_010,function(t,r){return r%3===0})],[To.DATA_MASK_011,new s(To.DATA_MASK_011,function(t,r){return(t+r)%3===0})],[To.DATA_MASK_100,new s(To.DATA_MASK_100,function(t,r){return(Math.floor(t/2)+Math.floor(r/3)&1)===0})],[To.DATA_MASK_101,new s(To.DATA_MASK_101,function(t,r){return t*r%6===0})],[To.DATA_MASK_110,new s(To.DATA_MASK_110,function(t,r){return t*r%6<3})],[To.DATA_MASK_111,new s(To.DATA_MASK_111,function(t,r){return(t+r+t*r%3&1)===0})]]),s}(),Mue=function(){function s(t){var r=t.getHeight();if(r<21||(r&3)!==1)throw new Ls;this.bitMatrix=t}return s.prototype.readFormatInformation=function(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;for(var t=0,r=0;r<6;r++)t=this.copyBit(r,8,t);t=this.copyBit(7,8,t),t=this.copyBit(8,8,t),t=this.copyBit(8,7,t);for(var n=5;n>=0;n--)t=this.copyBit(8,n,t);for(var a=this.bitMatrix.getHeight(),i=0,o=a-7,n=a-1;n>=o;n--)i=this.copyBit(8,n,i);for(var r=a-8;r<a;r++)i=this.copyBit(r,8,i);if(this.parsedFormatInfo=M9.decodeFormatInformation(t,i),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new Ls},s.prototype.readVersion=function(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;var t=this.bitMatrix.getHeight(),r=Math.floor((t-17)/4);if(r<=6)return qf.getVersionForNumber(r);for(var n=0,a=t-11,i=5;i>=0;i--)for(var o=t-9;o>=a;o--)n=this.copyBit(o,i,n);var l=qf.decodeVersionInformation(n);if(l!==null&&l.getDimensionForVersion()===t)return this.parsedVersion=l,l;n=0;for(var o=5;o>=0;o--)for(var i=t-9;i>=a;i--)n=this.copyBit(o,i,n);if(l=qf.decodeVersionInformation(n),l!==null&&l.getDimensionForVersion()===t)return this.parsedVersion=l,l;throw new Ls},s.prototype.copyBit=function(t,r,n){var a=this.isMirror?this.bitMatrix.get(r,t):this.bitMatrix.get(t,r);return a?n<<1|1:n<<1},s.prototype.readCodewords=function(){var t=this.readFormatInformation(),r=this.readVersion(),n=Dk.values.get(t.getDataMask()),a=this.bitMatrix.getHeight();n.unmaskBitMatrix(this.bitMatrix,a);for(var i=r.buildFunctionPattern(),o=!0,l=new Uint8Array(r.getTotalCodewords()),c=0,d=0,u=0,h=a-1;h>0;h-=2){h===6&&h--;for(var f=0;f<a;f++)for(var m=o?a-1-f:f,p=0;p<2;p++)i.get(h-p,m)||(u++,d<<=1,this.bitMatrix.get(h-p,m)&&(d|=1),u===8&&(l[c++]=d,u=0,d=0));o=!o}if(c!==r.getTotalCodewords())throw new Ls;return l},s.prototype.remask=function(){if(this.parsedFormatInfo!==null){var t=Dk.values.get(this.parsedFormatInfo.getDataMask()),r=this.bitMatrix.getHeight();t.unmaskBitMatrix(this.bitMatrix,r)}},s.prototype.setMirror=function(t){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=t},s.prototype.mirror=function(){for(var t=this.bitMatrix,r=0,n=t.getWidth();r<n;r++)for(var a=r+1,i=t.getHeight();a<i;a++)t.get(r,a)!==t.get(a,r)&&(t.flip(a,r),t.flip(r,a))},s}(),Ok=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Lue=function(){function s(t,r){this.numDataCodewords=t,this.codewords=r}return s.getDataBlocks=function(t,r,n){var a,i,o,l;if(t.length!==r.getTotalCodewords())throw new Or;var c=r.getECBlocksForLevel(n),d=0,u=c.getECBlocks();try{for(var h=Ok(u),f=h.next();!f.done;f=h.next()){var m=f.value;d+=m.getCount()}}catch(V){a={error:V}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(a)throw a.error}}var p=new Array(d),g=0;try{for(var v=Ok(u),y=v.next();!y.done;y=v.next())for(var m=y.value,j=0;j<m.getCount();j++){var b=m.getDataCodewords(),w=c.getECCodewordsPerBlock()+b;p[g++]=new s(b,new Uint8Array(w))}}catch(V){o={error:V}}finally{try{y&&!y.done&&(l=v.return)&&l.call(v)}finally{if(o)throw o.error}}for(var N=p[0].codewords.length,C=p.length-1;C>=0;){var S=p[C].codewords.length;if(S===N)break;C--}C++;for(var _=N-c.getECCodewordsPerBlock(),k=0,j=0;j<_;j++)for(var F=0;F<g;F++)p[F].codewords[j]=t[k++];for(var F=C;F<g;F++)p[F].codewords[_]=t[k++];for(var A=p[0].codewords.length,j=_;j<A;j++)for(var F=0;F<g;F++){var T=F<C?j:j+1;p[F].codewords[T]=t[k++]}return p},s.prototype.getNumDataCodewords=function(){return this.numDataCodewords},s.prototype.getCodewords=function(){return this.codewords},s}(),zc;(function(s){s[s.TERMINATOR=0]="TERMINATOR",s[s.NUMERIC=1]="NUMERIC",s[s.ALPHANUMERIC=2]="ALPHANUMERIC",s[s.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",s[s.BYTE=4]="BYTE",s[s.ECI=5]="ECI",s[s.KANJI=6]="KANJI",s[s.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",s[s.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",s[s.HANZI=9]="HANZI"})(zc||(zc={}));var li=function(){function s(t,r,n,a){this.value=t,this.stringValue=r,this.characterCountBitsForVersions=n,this.bits=a,s.FOR_BITS.set(a,this),s.FOR_VALUE.set(t,this)}return s.forBits=function(t){var r=s.FOR_BITS.get(t);if(r===void 0)throw new Or;return r},s.prototype.getCharacterCountBits=function(t){var r=t.getVersionNumber(),n;return r<=9?n=0:r<=26?n=1:n=2,this.characterCountBitsForVersions[n]},s.prototype.getValue=function(){return this.value},s.prototype.getBits=function(){return this.bits},s.prototype.equals=function(t){if(!(t instanceof s))return!1;var r=t;return this.value===r.value},s.prototype.toString=function(){return this.stringValue},s.FOR_BITS=new Map,s.FOR_VALUE=new Map,s.TERMINATOR=new s(zc.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),s.NUMERIC=new s(zc.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),s.ALPHANUMERIC=new s(zc.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),s.STRUCTURED_APPEND=new s(zc.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),s.BYTE=new s(zc.BYTE,"BYTE",Int32Array.from([8,16,16]),4),s.ECI=new s(zc.ECI,"ECI",Int32Array.from([0,0,0]),7),s.KANJI=new s(zc.KANJI,"KANJI",Int32Array.from([8,10,12]),8),s.FNC1_FIRST_POSITION=new s(zc.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),s.FNC1_SECOND_POSITION=new s(zc.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),s.HANZI=new s(zc.HANZI,"HANZI",Int32Array.from([8,10,12]),13),s}(),$ue=function(){function s(){}return s.decode=function(t,r,n,a){var i=new F9(t),o=new En,l=new Array,c=-1,d=-1;try{var u=null,h=!1,f=void 0;do{if(i.available()<4)f=li.TERMINATOR;else{var m=i.readBits(4);f=li.forBits(m)}switch(f){case li.TERMINATOR:break;case li.FNC1_FIRST_POSITION:case li.FNC1_SECOND_POSITION:h=!0;break;case li.STRUCTURED_APPEND:if(i.available()<16)throw new Ls;c=i.readBits(8),d=i.readBits(8);break;case li.ECI:var p=s.parseECIValue(i);if(u=wo.getCharacterSetECIByValue(p),u===null)throw new Ls;break;case li.HANZI:var g=i.readBits(4),v=i.readBits(f.getCharacterCountBits(r));g===s.GB2312_SUBSET&&s.decodeHanziSegment(i,o,v);break;default:var y=i.readBits(f.getCharacterCountBits(r));switch(f){case li.NUMERIC:s.decodeNumericSegment(i,o,y);break;case li.ALPHANUMERIC:s.decodeAlphanumericSegment(i,o,y,h);break;case li.BYTE:s.decodeByteSegment(i,o,y,u,l,a);break;case li.KANJI:s.decodeKanjiSegment(i,o,y);break;default:throw new Ls}break}}while(f!==li.TERMINATOR)}catch{throw new Ls}return new NN(t,o.toString(),l.length===0?null:l,n===null?null:n.toString(),c,d)},s.decodeHanziSegment=function(t,r,n){if(n*13>t.available())throw new Ls;for(var a=new Uint8Array(2*n),i=0;n>0;){var o=t.readBits(13),l=o/96<<8&4294967295|o%96;l<959?l+=41377:l+=42657,a[i]=l>>8&255,a[i+1]=l&255,i+=2,n--}try{r.append(td.decode(a,Gn.GB2312))}catch(c){throw new Ls(c)}},s.decodeKanjiSegment=function(t,r,n){if(n*13>t.available())throw new Ls;for(var a=new Uint8Array(2*n),i=0;n>0;){var o=t.readBits(13),l=o/192<<8&4294967295|o%192;l<7936?l+=33088:l+=49472,a[i]=l>>8,a[i+1]=l,i+=2,n--}try{r.append(td.decode(a,Gn.SHIFT_JIS))}catch(c){throw new Ls(c)}},s.decodeByteSegment=function(t,r,n,a,i,o){if(8*n>t.available())throw new Ls;for(var l=new Uint8Array(n),c=0;c<n;c++)l[c]=t.readBits(8);var d;a===null?d=Gn.guessEncoding(l,o):d=a.getName();try{r.append(td.decode(l,d))}catch(u){throw new Ls(u)}i.push(l)},s.toAlphaNumericChar=function(t){if(t>=s.ALPHANUMERIC_CHARS.length)throw new Ls;return s.ALPHANUMERIC_CHARS[t]},s.decodeAlphanumericSegment=function(t,r,n,a){for(var i=r.length();n>1;){if(t.available()<11)throw new Ls;var o=t.readBits(11);r.append(s.toAlphaNumericChar(Math.floor(o/45))),r.append(s.toAlphaNumericChar(o%45)),n-=2}if(n===1){if(t.available()<6)throw new Ls;r.append(s.toAlphaNumericChar(t.readBits(6)))}if(a)for(var l=i;l<r.length();l++)r.charAt(l)==="%"&&(l<r.length()-1&&r.charAt(l+1)==="%"?r.deleteCharAt(l+1):r.setCharAt(l,""))},s.decodeNumericSegment=function(t,r,n){for(;n>=3;){if(t.available()<10)throw new Ls;var a=t.readBits(10);if(a>=1e3)throw new Ls;r.append(s.toAlphaNumericChar(Math.floor(a/100))),r.append(s.toAlphaNumericChar(Math.floor(a/10)%10)),r.append(s.toAlphaNumericChar(a%10)),n-=3}if(n===2){if(t.available()<7)throw new Ls;var i=t.readBits(7);if(i>=100)throw new Ls;r.append(s.toAlphaNumericChar(Math.floor(i/10))),r.append(s.toAlphaNumericChar(i%10))}else if(n===1){if(t.available()<4)throw new Ls;var o=t.readBits(4);if(o>=10)throw new Ls;r.append(s.toAlphaNumericChar(o))}},s.parseECIValue=function(t){var r=t.readBits(8);if(!(r&128))return r&127;if((r&192)===128){var n=t.readBits(8);return(r&63)<<8&4294967295|n}if((r&224)===192){var a=t.readBits(16);return(r&31)<<16&4294967295|a}throw new Ls},s.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",s.GB2312_SUBSET=1,s}(),L9=function(){function s(t){this.mirrored=t}return s.prototype.isMirrored=function(){return this.mirrored},s.prototype.applyMirroredCorrection=function(t){if(!(!this.mirrored||t===null||t.length<3)){var r=t[0];t[0]=t[2],t[2]=r}},s}(),Rk=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Bue=function(){function s(){this.rsDecoder=new wN(ec.QR_CODE_FIELD_256)}return s.prototype.decodeBooleanArray=function(t,r){return this.decodeBitMatrix(fu.parseFromBooleanArray(t),r)},s.prototype.decodeBitMatrix=function(t,r){var n=new Mue(t),a=null;try{return this.decodeBitMatrixParser(n,r)}catch(o){a=o}try{n.remask(),n.setMirror(!0),n.readVersion(),n.readFormatInformation(),n.mirror();var i=this.decodeBitMatrixParser(n,r);return i.setOther(new L9(!0)),i}catch(o){throw a!==null?a:o}},s.prototype.decodeBitMatrixParser=function(t,r){var n,a,i,o,l=t.readVersion(),c=t.readFormatInformation().getErrorCorrectionLevel(),d=t.readCodewords(),u=Lue.getDataBlocks(d,l,c),h=0;try{for(var f=Rk(u),m=f.next();!m.done;m=f.next()){var p=m.value;h+=p.getNumDataCodewords()}}catch(C){n={error:C}}finally{try{m&&!m.done&&(a=f.return)&&a.call(f)}finally{if(n)throw n.error}}var g=new Uint8Array(h),v=0;try{for(var y=Rk(u),j=y.next();!j.done;j=y.next()){var p=j.value,b=p.getCodewords(),w=p.getNumDataCodewords();this.correctErrors(b,w);for(var N=0;N<w;N++)g[v++]=b[N]}}catch(C){i={error:C}}finally{try{j&&!j.done&&(o=y.return)&&o.call(y)}finally{if(i)throw i.error}}return $ue.decode(g,l,c,r)},s.prototype.correctErrors=function(t,r){var n=new Int32Array(t);try{this.rsDecoder.decode(n,t.length-r)}catch{throw new no}for(var a=0;a<r;a++)t[a]=n[a]},s}(),Uue=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),zue=function(s){Uue(t,s);function t(r,n,a){var i=s.call(this,r,n)||this;return i.estimatedModuleSize=a,i}return t.prototype.aboutEquals=function(r,n,a){if(Math.abs(n-this.getY())<=r&&Math.abs(a-this.getX())<=r){var i=Math.abs(r-this.estimatedModuleSize);return i<=1||i<=this.estimatedModuleSize}return!1},t.prototype.combineEstimate=function(r,n,a){var i=(this.getX()+n)/2,o=(this.getY()+r)/2,l=(this.estimatedModuleSize+a)/2;return new t(i,o,l)},t}(ur),que=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Vue=function(){function s(t,r,n,a,i,o,l){this.image=t,this.startX=r,this.startY=n,this.width=a,this.height=i,this.moduleSize=o,this.resultPointCallback=l,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}return s.prototype.find=function(){for(var t=this.startX,r=this.height,n=this.width,a=t+n,i=this.startY+r/2,o=new Int32Array(3),l=this.image,c=0;c<r;c++){var d=i+(c&1?-Math.floor((c+1)/2):Math.floor((c+1)/2));o[0]=0,o[1]=0,o[2]=0;for(var u=t;u<a&&!l.get(u,d);)u++;for(var h=0;u<a;){if(l.get(u,d))if(h===1)o[1]++;else if(h===2){if(this.foundPatternCross(o)){var f=this.handlePossibleCenter(o,d,u);if(f!==null)return f}o[0]=o[2],o[1]=1,o[2]=0,h=1}else o[++h]++;else h===1&&h++,o[h]++;u++}if(this.foundPatternCross(o)){var f=this.handlePossibleCenter(o,d,a);if(f!==null)return f}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new es},s.centerFromEnd=function(t,r){return r-t[2]-t[1]/2},s.prototype.foundPatternCross=function(t){for(var r=this.moduleSize,n=r/2,a=0;a<3;a++)if(Math.abs(r-t[a])>=n)return!1;return!0},s.prototype.crossCheckVertical=function(t,r,n,a){var i=this.image,o=i.getHeight(),l=this.crossCheckStateCount;l[0]=0,l[1]=0,l[2]=0;for(var c=t;c>=0&&i.get(r,c)&&l[1]<=n;)l[1]++,c--;if(c<0||l[1]>n)return NaN;for(;c>=0&&!i.get(r,c)&&l[0]<=n;)l[0]++,c--;if(l[0]>n)return NaN;for(c=t+1;c<o&&i.get(r,c)&&l[1]<=n;)l[1]++,c++;if(c===o||l[1]>n)return NaN;for(;c<o&&!i.get(r,c)&&l[2]<=n;)l[2]++,c++;if(l[2]>n)return NaN;var d=l[0]+l[1]+l[2];return 5*Math.abs(d-a)>=2*a?NaN:this.foundPatternCross(l)?s.centerFromEnd(l,c):NaN},s.prototype.handlePossibleCenter=function(t,r,n){var a,i,o=t[0]+t[1]+t[2],l=s.centerFromEnd(t,n),c=this.crossCheckVertical(r,l,2*t[1],o);if(!isNaN(c)){var d=(t[0]+t[1]+t[2])/3;try{for(var u=que(this.possibleCenters),h=u.next();!h.done;h=u.next()){var f=h.value;if(f.aboutEquals(d,c,l))return f.combineEstimate(c,l,d)}}catch(p){a={error:p}}finally{try{h&&!h.done&&(i=u.return)&&i.call(u)}finally{if(a)throw a.error}}var m=new zue(l,c,d);this.possibleCenters.push(m),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(m)}return null},s}(),Wue=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Hue=function(s){Wue(t,s);function t(r,n,a,i){var o=s.call(this,r,n)||this;return o.estimatedModuleSize=a,o.count=i,i===void 0&&(o.count=1),o}return t.prototype.getEstimatedModuleSize=function(){return this.estimatedModuleSize},t.prototype.getCount=function(){return this.count},t.prototype.aboutEquals=function(r,n,a){if(Math.abs(n-this.getY())<=r&&Math.abs(a-this.getX())<=r){var i=Math.abs(r-this.estimatedModuleSize);return i<=1||i<=this.estimatedModuleSize}return!1},t.prototype.combineEstimate=function(r,n,a){var i=this.count+1,o=(this.count*this.getX()+n)/i,l=(this.count*this.getY()+r)/i,c=(this.count*this.estimatedModuleSize+a)/i;return new t(o,l,c,i)},t}(ur),Gue=function(){function s(t){this.bottomLeft=t[0],this.topLeft=t[1],this.topRight=t[2]}return s.prototype.getBottomLeft=function(){return this.bottomLeft},s.prototype.getTopLeft=function(){return this.topLeft},s.prototype.getTopRight=function(){return this.topRight},s}(),a0=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Kue=function(){function s(t,r){this.image=t,this.resultPointCallback=r,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=r}return s.prototype.getImage=function(){return this.image},s.prototype.getPossibleCenters=function(){return this.possibleCenters},s.prototype.find=function(t){var r=t!=null&&t.get(ti.TRY_HARDER)!==void 0,n=t!=null&&t.get(ti.PURE_BARCODE)!==void 0,a=this.image,i=a.getHeight(),o=a.getWidth(),l=Math.floor(3*i/(4*s.MAX_MODULES));(l<s.MIN_SKIP||r)&&(l=s.MIN_SKIP);for(var c=!1,d=new Int32Array(5),u=l-1;u<i&&!c;u+=l){d[0]=0,d[1]=0,d[2]=0,d[3]=0,d[4]=0;for(var h=0,f=0;f<o;f++)if(a.get(f,u))(h&1)===1&&h++,d[h]++;else if(h&1)d[h]++;else if(h===4)if(s.foundPatternCross(d)){var m=this.handlePossibleCenter(d,u,f,n);if(m===!0)if(l=2,this.hasSkipped===!0)c=this.haveMultiplyConfirmedCenters();else{var p=this.findRowSkip();p>d[2]&&(u+=p-d[2]-l,f=o-1)}else{d[0]=d[2],d[1]=d[3],d[2]=d[4],d[3]=1,d[4]=0,h=3;continue}h=0,d[0]=0,d[1]=0,d[2]=0,d[3]=0,d[4]=0}else d[0]=d[2],d[1]=d[3],d[2]=d[4],d[3]=1,d[4]=0,h=3;else d[++h]++;if(s.foundPatternCross(d)){var m=this.handlePossibleCenter(d,u,o,n);m===!0&&(l=d[0],this.hasSkipped&&(c=this.haveMultiplyConfirmedCenters()))}}var g=this.selectBestPatterns();return ur.orderBestPatterns(g),new Gue(g)},s.centerFromEnd=function(t,r){return r-t[4]-t[3]-t[2]/2},s.foundPatternCross=function(t){for(var r=0,n=0;n<5;n++){var a=t[n];if(a===0)return!1;r+=a}if(r<7)return!1;var i=r/7,o=i/2;return Math.abs(i-t[0])<o&&Math.abs(i-t[1])<o&&Math.abs(3*i-t[2])<3*o&&Math.abs(i-t[3])<o&&Math.abs(i-t[4])<o},s.prototype.getCrossCheckStateCount=function(){var t=this.crossCheckStateCount;return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t},s.prototype.crossCheckDiagonal=function(t,r,n,a){for(var i=this.getCrossCheckStateCount(),o=0,l=this.image;t>=o&&r>=o&&l.get(r-o,t-o);)i[2]++,o++;if(t<o||r<o)return!1;for(;t>=o&&r>=o&&!l.get(r-o,t-o)&&i[1]<=n;)i[1]++,o++;if(t<o||r<o||i[1]>n)return!1;for(;t>=o&&r>=o&&l.get(r-o,t-o)&&i[0]<=n;)i[0]++,o++;if(i[0]>n)return!1;var c=l.getHeight(),d=l.getWidth();for(o=1;t+o<c&&r+o<d&&l.get(r+o,t+o);)i[2]++,o++;if(t+o>=c||r+o>=d)return!1;for(;t+o<c&&r+o<d&&!l.get(r+o,t+o)&&i[3]<n;)i[3]++,o++;if(t+o>=c||r+o>=d||i[3]>=n)return!1;for(;t+o<c&&r+o<d&&l.get(r+o,t+o)&&i[4]<n;)i[4]++,o++;if(i[4]>=n)return!1;var u=i[0]+i[1]+i[2]+i[3]+i[4];return Math.abs(u-a)<2*a&&s.foundPatternCross(i)},s.prototype.crossCheckVertical=function(t,r,n,a){for(var i=this.image,o=i.getHeight(),l=this.getCrossCheckStateCount(),c=t;c>=0&&i.get(r,c);)l[2]++,c--;if(c<0)return NaN;for(;c>=0&&!i.get(r,c)&&l[1]<=n;)l[1]++,c--;if(c<0||l[1]>n)return NaN;for(;c>=0&&i.get(r,c)&&l[0]<=n;)l[0]++,c--;if(l[0]>n)return NaN;for(c=t+1;c<o&&i.get(r,c);)l[2]++,c++;if(c===o)return NaN;for(;c<o&&!i.get(r,c)&&l[3]<n;)l[3]++,c++;if(c===o||l[3]>=n)return NaN;for(;c<o&&i.get(r,c)&&l[4]<n;)l[4]++,c++;if(l[4]>=n)return NaN;var d=l[0]+l[1]+l[2]+l[3]+l[4];return 5*Math.abs(d-a)>=2*a?NaN:s.foundPatternCross(l)?s.centerFromEnd(l,c):NaN},s.prototype.crossCheckHorizontal=function(t,r,n,a){for(var i=this.image,o=i.getWidth(),l=this.getCrossCheckStateCount(),c=t;c>=0&&i.get(c,r);)l[2]++,c--;if(c<0)return NaN;for(;c>=0&&!i.get(c,r)&&l[1]<=n;)l[1]++,c--;if(c<0||l[1]>n)return NaN;for(;c>=0&&i.get(c,r)&&l[0]<=n;)l[0]++,c--;if(l[0]>n)return NaN;for(c=t+1;c<o&&i.get(c,r);)l[2]++,c++;if(c===o)return NaN;for(;c<o&&!i.get(c,r)&&l[3]<n;)l[3]++,c++;if(c===o||l[3]>=n)return NaN;for(;c<o&&i.get(c,r)&&l[4]<n;)l[4]++,c++;if(l[4]>=n)return NaN;var d=l[0]+l[1]+l[2]+l[3]+l[4];return 5*Math.abs(d-a)>=a?NaN:s.foundPatternCross(l)?s.centerFromEnd(l,c):NaN},s.prototype.handlePossibleCenter=function(t,r,n,a){var i=t[0]+t[1]+t[2]+t[3]+t[4],o=s.centerFromEnd(t,n),l=this.crossCheckVertical(r,Math.floor(o),t[2],i);if(!isNaN(l)&&(o=this.crossCheckHorizontal(Math.floor(o),Math.floor(l),t[2],i),!isNaN(o)&&(!a||this.crossCheckDiagonal(Math.floor(l),Math.floor(o),t[2],i)))){for(var c=i/7,d=!1,u=this.possibleCenters,h=0,f=u.length;h<f;h++){var m=u[h];if(m.aboutEquals(c,l,o)){u[h]=m.combineEstimate(l,o,c),d=!0;break}}if(!d){var p=new Hue(o,l,c);u.push(p),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(p)}return!0}return!1},s.prototype.findRowSkip=function(){var t,r,n=this.possibleCenters.length;if(n<=1)return 0;var a=null;try{for(var i=a0(this.possibleCenters),o=i.next();!o.done;o=i.next()){var l=o.value;if(l.getCount()>=s.CENTER_QUORUM)if(a==null)a=l;else return this.hasSkipped=!0,Math.floor((Math.abs(a.getX()-l.getX())-Math.abs(a.getY()-l.getY()))/2)}}catch(c){t={error:c}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return 0},s.prototype.haveMultiplyConfirmedCenters=function(){var t,r,n,a,i=0,o=0,l=this.possibleCenters.length;try{for(var c=a0(this.possibleCenters),d=c.next();!d.done;d=c.next()){var u=d.value;u.getCount()>=s.CENTER_QUORUM&&(i++,o+=u.getEstimatedModuleSize())}}catch(g){t={error:g}}finally{try{d&&!d.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}}if(i<3)return!1;var h=o/l,f=0;try{for(var m=a0(this.possibleCenters),p=m.next();!p.done;p=m.next()){var u=p.value;f+=Math.abs(u.getEstimatedModuleSize()-h)}}catch(g){n={error:g}}finally{try{p&&!p.done&&(a=m.return)&&a.call(m)}finally{if(n)throw n.error}}return f<=.05*o},s.prototype.selectBestPatterns=function(){var t,r,n,a,i=this.possibleCenters.length;if(i<3)throw new es;var o=this.possibleCenters,l;if(i>3){var c=0,d=0;try{for(var u=a0(this.possibleCenters),h=u.next();!h.done;h=u.next()){var f=h.value,m=f.getEstimatedModuleSize();c+=m,d+=m*m}}catch(N){t={error:N}}finally{try{h&&!h.done&&(r=u.return)&&r.call(u)}finally{if(t)throw t.error}}l=c/i;var p=Math.sqrt(d/i-l*l);o.sort(function(N,C){var S=Math.abs(C.getEstimatedModuleSize()-l),_=Math.abs(N.getEstimatedModuleSize()-l);return S<_?-1:S>_?1:0});for(var g=Math.max(.2*l,p),v=0;v<o.length&&o.length>3;v++){var y=o[v];Math.abs(y.getEstimatedModuleSize()-l)>g&&(o.splice(v,1),v--)}}if(o.length>3){var c=0;try{for(var j=a0(o),b=j.next();!b.done;b=j.next()){var w=b.value;c+=w.getEstimatedModuleSize()}}catch(C){n={error:C}}finally{try{b&&!b.done&&(a=j.return)&&a.call(j)}finally{if(n)throw n.error}}l=c/o.length,o.sort(function(C,S){if(S.getCount()===C.getCount()){var _=Math.abs(S.getEstimatedModuleSize()-l),k=Math.abs(C.getEstimatedModuleSize()-l);return _<k?1:_>k?-1:0}else return S.getCount()-C.getCount()}),o.splice(3)}return[o[0],o[1],o[2]]},s.CENTER_QUORUM=2,s.MIN_SKIP=3,s.MAX_MODULES=57,s}(),Yue=function(){function s(t){this.image=t}return s.prototype.getImage=function(){return this.image},s.prototype.getResultPointCallback=function(){return this.resultPointCallback},s.prototype.detect=function(t){this.resultPointCallback=t==null?null:t.get(ti.NEED_RESULT_POINT_CALLBACK);var r=new Kue(this.image,this.resultPointCallback),n=r.find(t);return this.processFinderPatternInfo(n)},s.prototype.processFinderPatternInfo=function(t){var r=t.getTopLeft(),n=t.getTopRight(),a=t.getBottomLeft(),i=this.calculateModuleSize(r,n,a);if(i<1)throw new es("No pattern found in proccess finder.");var o=s.computeDimension(r,n,a,i),l=qf.getProvisionalVersionForDimension(o),c=l.getDimensionForVersion()-7,d=null;if(l.getAlignmentPatternCenters().length>0)for(var u=n.getX()-r.getX()+a.getX(),h=n.getY()-r.getY()+a.getY(),f=1-3/c,m=Math.floor(r.getX()+f*(u-r.getX())),p=Math.floor(r.getY()+f*(h-r.getY())),g=4;g<=16;g<<=1)try{d=this.findAlignmentInRegion(i,m,p,g);break}catch(b){if(!(b instanceof es))throw b}var v=s.createTransform(r,n,a,d,o),y=s.sampleGrid(this.image,v,o),j;return d===null?j=[a,r,n]:j=[a,r,n,d],new S3(y,j)},s.createTransform=function(t,r,n,a,i){var o=i-3.5,l,c,d,u;return a!==null?(l=a.getX(),c=a.getY(),d=o-3,u=d):(l=r.getX()-t.getX()+n.getX(),c=r.getY()-t.getY()+n.getY(),d=o,u=o),T9.quadrilateralToQuadrilateral(3.5,3.5,o,3.5,d,u,3.5,o,t.getX(),t.getY(),r.getX(),r.getY(),l,c,n.getX(),n.getY())},s.sampleGrid=function(t,r,n){var a=C3.getInstance();return a.sampleGridWithTransform(t,n,n,r)},s.computeDimension=function(t,r,n,a){var i=ea.round(ur.distance(t,r)/a),o=ea.round(ur.distance(t,n)/a),l=Math.floor((i+o)/2)+7;switch(l&3){case 0:l++;break;case 2:l--;break;case 3:throw new es("Dimensions could be not found.")}return l},s.prototype.calculateModuleSize=function(t,r,n){return(this.calculateModuleSizeOneWay(t,r)+this.calculateModuleSizeOneWay(t,n))/2},s.prototype.calculateModuleSizeOneWay=function(t,r){var n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(r.getX()),Math.floor(r.getY())),a=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(r.getX()),Math.floor(r.getY()),Math.floor(t.getX()),Math.floor(t.getY()));return isNaN(n)?a/7:isNaN(a)?n/7:(n+a)/14},s.prototype.sizeOfBlackWhiteBlackRunBothWays=function(t,r,n,a){var i=this.sizeOfBlackWhiteBlackRun(t,r,n,a),o=1,l=t-(n-t);l<0?(o=t/(t-l),l=0):l>=this.image.getWidth()&&(o=(this.image.getWidth()-1-t)/(l-t),l=this.image.getWidth()-1);var c=Math.floor(r-(a-r)*o);return o=1,c<0?(o=r/(r-c),c=0):c>=this.image.getHeight()&&(o=(this.image.getHeight()-1-r)/(c-r),c=this.image.getHeight()-1),l=Math.floor(t+(l-t)*o),i+=this.sizeOfBlackWhiteBlackRun(t,r,l,c),i-1},s.prototype.sizeOfBlackWhiteBlackRun=function(t,r,n,a){var i=Math.abs(a-r)>Math.abs(n-t);if(i){var o=t;t=r,r=o,o=n,n=a,a=o}for(var l=Math.abs(n-t),c=Math.abs(a-r),d=-l/2,u=t<n?1:-1,h=r<a?1:-1,f=0,m=n+u,p=t,g=r;p!==m;p+=u){var v=i?g:p,y=i?p:g;if(f===1===this.image.get(v,y)){if(f===2)return ea.distance(p,g,t,r);f++}if(d+=c,d>0){if(g===a)break;g+=h,d-=l}}return f===2?ea.distance(n+u,a,t,r):NaN},s.prototype.findAlignmentInRegion=function(t,r,n,a){var i=Math.floor(a*t),o=Math.max(0,r-i),l=Math.min(this.image.getWidth()-1,r+i);if(l-o<t*3)throw new es("Alignment top exceeds estimated module size.");var c=Math.max(0,n-i),d=Math.min(this.image.getHeight()-1,n+i);if(d-c<t*3)throw new es("Alignment bottom exceeds estimated module size.");var u=new Vue(this.image,o,c,l-o,d-c,t,this.resultPointCallback);return u.find()},s}(),P1=function(){function s(){this.decoder=new Bue}return s.prototype.getDecoder=function(){return this.decoder},s.prototype.decode=function(t,r){var n,a;if(r!=null&&r.get(ti.PURE_BARCODE)!==void 0){var i=s.extractPureBits(t.getBlackMatrix());n=this.decoder.decodeBitMatrix(i,r),a=s.NO_POINTS}else{var o=new Yue(t.getBlackMatrix()).detect(r);n=this.decoder.decodeBitMatrix(o.getBits(),r),a=o.getPoints()}n.getOther()instanceof L9&&n.getOther().applyMirroredCorrection(a);var l=new xl(n.getText(),n.getRawBytes(),void 0,a,Dr.QR_CODE,void 0),c=n.getByteSegments();c!==null&&l.putMetadata(Xo.BYTE_SEGMENTS,c);var d=n.getECLevel();return d!==null&&l.putMetadata(Xo.ERROR_CORRECTION_LEVEL,d),n.hasStructuredAppend()&&(l.putMetadata(Xo.STRUCTURED_APPEND_SEQUENCE,n.getStructuredAppendSequenceNumber()),l.putMetadata(Xo.STRUCTURED_APPEND_PARITY,n.getStructuredAppendParity())),l},s.prototype.reset=function(){},s.extractPureBits=function(t){var r=t.getTopLeftOnBit(),n=t.getBottomRightOnBit();if(r===null||n===null)throw new es;var a=this.moduleSize(r,t),i=r[1],o=n[1],l=r[0],c=n[0];if(l>=c||i>=o)throw new es;if(o-i!==c-l&&(c=l+(o-i),c>=t.getWidth()))throw new es;var d=Math.round((c-l+1)/a),u=Math.round((o-i+1)/a);if(d<=0||u<=0)throw new es;if(u!==d)throw new es;var h=Math.floor(a/2);i+=h,l+=h;var f=l+Math.floor((d-1)*a)-c;if(f>0){if(f>h)throw new es;l-=f}var m=i+Math.floor((u-1)*a)-o;if(m>0){if(m>h)throw new es;i-=m}for(var p=new fu(d,u),g=0;g<u;g++)for(var v=i+Math.floor(g*a),y=0;y<d;y++)t.get(l+Math.floor(y*a),v)&&p.set(y,g);return p},s.moduleSize=function(t,r){for(var n=r.getHeight(),a=r.getWidth(),i=t[0],o=t[1],l=!0,c=0;i<a&&o<n;){if(l!==r.get(i,o)){if(++c===5)break;l=!l}i++,o++}if(i===a||o===n)throw new es;return(i-t[0])/7},s.NO_POINTS=new Array,s}(),Jue=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Jn=function(){function s(){}return s.prototype.PDF417Common=function(){},s.getBitCountSum=function(t){return ea.sum(t)},s.toIntArray=function(t){var r,n;if(t==null||!t.length)return s.EMPTY_INT_ARRAY;var a=new Int32Array(t.length),i=0;try{for(var o=Jue(t),l=o.next();!l.done;l=o.next()){var c=l.value;a[i++]=c}}catch(d){r={error:d}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a},s.getCodeword=function(t){var r=So.binarySearch(s.SYMBOL_TABLE,t&262143);return r<0?-1:(s.CODEWORD_TABLE[r]-1)%s.NUMBER_OF_CODEWORDS},s.NUMBER_OF_CODEWORDS=929,s.MAX_CODEWORDS_IN_BARCODE=s.NUMBER_OF_CODEWORDS-1,s.MIN_ROWS_IN_BARCODE=3,s.MAX_ROWS_IN_BARCODE=90,s.MODULES_IN_CODEWORD=17,s.MODULES_IN_STOP_PATTERN=18,s.BARS_IN_MODULE=8,s.EMPTY_INT_ARRAY=new Int32Array([]),s.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),s.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]),s}(),Xue=function(){function s(t,r){this.bits=t,this.points=r}return s.prototype.getBits=function(){return this.bits},s.prototype.getPoints=function(){return this.points},s}(),Que=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Zue=function(){function s(){}return s.detectMultiple=function(t,r,n){var a=t.getBlackMatrix(),i=s.detect(n,a);return i.length||(a=a.clone(),a.rotate180(),i=s.detect(n,a)),new Xue(a,i)},s.detect=function(t,r){for(var n,a,i=new Array,o=0,l=0,c=!1;o<r.getHeight();){var d=s.findVertices(r,o,l);if(d[0]==null&&d[3]==null){if(!c)break;c=!1,l=0;try{for(var u=(n=void 0,Que(i)),h=u.next();!h.done;h=u.next()){var f=h.value;f[1]!=null&&(o=Math.trunc(Math.max(o,f[1].getY()))),f[3]!=null&&(o=Math.max(o,Math.trunc(f[3].getY())))}}catch(m){n={error:m}}finally{try{h&&!h.done&&(a=u.return)&&a.call(u)}finally{if(n)throw n.error}}o+=s.ROW_STEP;continue}if(c=!0,i.push(d),!t)break;d[2]!=null?(l=Math.trunc(d[2].getX()),o=Math.trunc(d[2].getY())):(l=Math.trunc(d[4].getX()),o=Math.trunc(d[4].getY()))}return i},s.findVertices=function(t,r,n){var a=t.getHeight(),i=t.getWidth(),o=new Array(8);return s.copyToResult(o,s.findRowsWithPattern(t,a,i,r,n,s.START_PATTERN),s.INDEXES_START_PATTERN),o[4]!=null&&(n=Math.trunc(o[4].getX()),r=Math.trunc(o[4].getY())),s.copyToResult(o,s.findRowsWithPattern(t,a,i,r,n,s.STOP_PATTERN),s.INDEXES_STOP_PATTERN),o},s.copyToResult=function(t,r,n){for(var a=0;a<n.length;a++)t[n[a]]=r[a]},s.findRowsWithPattern=function(t,r,n,a,i,o){for(var l=new Array(4),c=!1,d=new Int32Array(o.length);a<r;a+=s.ROW_STEP){var u=s.findGuardPattern(t,i,a,n,!1,o,d);if(u!=null){for(;a>0;){var h=s.findGuardPattern(t,i,--a,n,!1,o,d);if(h!=null)u=h;else{a++;break}}l[0]=new ur(u[0],a),l[1]=new ur(u[1],a),c=!0;break}}var f=a+1;if(c){for(var m=0,h=Int32Array.from([Math.trunc(l[0].getX()),Math.trunc(l[1].getX())]);f<r;f++){var u=s.findGuardPattern(t,h[0],f,n,!1,o,d);if(u!=null&&Math.abs(h[0]-u[0])<s.MAX_PATTERN_DRIFT&&Math.abs(h[1]-u[1])<s.MAX_PATTERN_DRIFT)h=u,m=0;else{if(m>s.SKIPPED_ROW_COUNT_MAX)break;m++}}f-=m+1,l[2]=new ur(h[0],f),l[3]=new ur(h[1],f)}return f-a<s.BARCODE_MIN_HEIGHT&&So.fill(l,null),l},s.findGuardPattern=function(t,r,n,a,i,o,l){So.fillWithin(l,0,l.length,0);for(var c=r,d=0;t.get(c,n)&&c>0&&d++<s.MAX_PIXEL_DRIFT;)c--;for(var u=c,h=0,f=o.length,m=i;u<a;u++){var p=t.get(u,n);if(p!==m)l[h]++;else{if(h===f-1){if(s.patternMatchVariance(l,o,s.MAX_INDIVIDUAL_VARIANCE)<s.MAX_AVG_VARIANCE)return new Int32Array([c,u]);c+=l[0]+l[1],ei.arraycopy(l,2,l,0,h-1),l[h-1]=0,l[h]=0,h--}else h++;l[h]=1,m=!m}}return h===f-1&&s.patternMatchVariance(l,o,s.MAX_INDIVIDUAL_VARIANCE)<s.MAX_AVG_VARIANCE?new Int32Array([c,u-1]):null},s.patternMatchVariance=function(t,r,n){for(var a=t.length,i=0,o=0,l=0;l<a;l++)i+=t[l],o+=r[l];if(i<o)return 1/0;var c=i/o;n*=c;for(var d=0,u=0;u<a;u++){var h=t[u],f=r[u]*c,m=h>f?h-f:f-h;if(m>n)return 1/0;d+=m}return d/i},s.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),s.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),s.MAX_AVG_VARIANCE=.42,s.MAX_INDIVIDUAL_VARIANCE=.8,s.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),s.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),s.MAX_PIXEL_DRIFT=3,s.MAX_PATTERN_DRIFT=5,s.SKIPPED_ROW_COUNT_MAX=25,s.ROW_STEP=5,s.BARCODE_MIN_HEIGHT=10,s}(),ehe=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},wf=function(){function s(t,r){if(r.length===0)throw new Or;this.field=t;var n=r.length;if(n>1&&r[0]===0){for(var a=1;a<n&&r[a]===0;)a++;a===n?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(n-a),ei.arraycopy(r,a,this.coefficients,0,this.coefficients.length))}else this.coefficients=r}return s.prototype.getCoefficients=function(){return this.coefficients},s.prototype.getDegree=function(){return this.coefficients.length-1},s.prototype.isZero=function(){return this.coefficients[0]===0},s.prototype.getCoefficient=function(t){return this.coefficients[this.coefficients.length-1-t]},s.prototype.evaluateAt=function(t){var r,n;if(t===0)return this.getCoefficient(0);if(t===1){var a=0;try{for(var i=ehe(this.coefficients),o=i.next();!o.done;o=i.next()){var l=o.value;a=this.field.add(a,l)}}catch(h){r={error:h}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a}for(var c=this.coefficients[0],d=this.coefficients.length,u=1;u<d;u++)c=this.field.add(this.field.multiply(t,c),this.coefficients[u]);return c},s.prototype.add=function(t){if(!this.field.equals(t.field))throw new Or("ModulusPolys do not have same ModulusGF field");if(this.isZero())return t;if(t.isZero())return this;var r=this.coefficients,n=t.coefficients;if(r.length>n.length){var a=r;r=n,n=a}var i=new Int32Array(n.length),o=n.length-r.length;ei.arraycopy(n,0,i,0,o);for(var l=o;l<n.length;l++)i[l]=this.field.add(r[l-o],n[l]);return new s(this.field,i)},s.prototype.subtract=function(t){if(!this.field.equals(t.field))throw new Or("ModulusPolys do not have same ModulusGF field");return t.isZero()?this:this.add(t.negative())},s.prototype.multiply=function(t){return t instanceof s?this.multiplyOther(t):this.multiplyScalar(t)},s.prototype.multiplyOther=function(t){if(!this.field.equals(t.field))throw new Or("ModulusPolys do not have same ModulusGF field");if(this.isZero()||t.isZero())return new s(this.field,new Int32Array([0]));for(var r=this.coefficients,n=r.length,a=t.coefficients,i=a.length,o=new Int32Array(n+i-1),l=0;l<n;l++)for(var c=r[l],d=0;d<i;d++)o[l+d]=this.field.add(o[l+d],this.field.multiply(c,a[d]));return new s(this.field,o)},s.prototype.negative=function(){for(var t=this.coefficients.length,r=new Int32Array(t),n=0;n<t;n++)r[n]=this.field.subtract(0,this.coefficients[n]);return new s(this.field,r)},s.prototype.multiplyScalar=function(t){if(t===0)return new s(this.field,new Int32Array([0]));if(t===1)return this;for(var r=this.coefficients.length,n=new Int32Array(r),a=0;a<r;a++)n[a]=this.field.multiply(this.coefficients[a],t);return new s(this.field,n)},s.prototype.multiplyByMonomial=function(t,r){if(t<0)throw new Or;if(r===0)return new s(this.field,new Int32Array([0]));for(var n=this.coefficients.length,a=new Int32Array(n+t),i=0;i<n;i++)a[i]=this.field.multiply(this.coefficients[i],r);return new s(this.field,a)},s.prototype.toString=function(){for(var t=new En,r=this.getDegree();r>=0;r--){var n=this.getCoefficient(r);n!==0&&(n<0?(t.append(" - "),n=-n):t.length()>0&&t.append(" + "),(r===0||n!==1)&&t.append(n),r!==0&&(r===1?t.append("x"):(t.append("x^"),t.append(r))))}return t.toString()},s}(),the=function(){function s(){}return s.prototype.add=function(t,r){return(t+r)%this.modulus},s.prototype.subtract=function(t,r){return(this.modulus+t-r)%this.modulus},s.prototype.exp=function(t){return this.expTable[t]},s.prototype.log=function(t){if(t===0)throw new Or;return this.logTable[t]},s.prototype.inverse=function(t){if(t===0)throw new k9;return this.expTable[this.modulus-this.logTable[t]-1]},s.prototype.multiply=function(t,r){return t===0||r===0?0:this.expTable[(this.logTable[t]+this.logTable[r])%(this.modulus-1)]},s.prototype.getSize=function(){return this.modulus},s.prototype.equals=function(t){return t===this},s}(),she=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),rhe=function(s){she(t,s);function t(r,n){var a=s.call(this)||this;a.modulus=r,a.expTable=new Int32Array(r),a.logTable=new Int32Array(r);for(var i=1,o=0;o<r;o++)a.expTable[o]=i,i=i*n%r;for(var o=0;o<r-1;o++)a.logTable[a.expTable[o]]=o;return a.zero=new wf(a,new Int32Array([0])),a.one=new wf(a,new Int32Array([1])),a}return t.prototype.getZero=function(){return this.zero},t.prototype.getOne=function(){return this.one},t.prototype.buildMonomial=function(r,n){if(r<0)throw new Or;if(n===0)return this.zero;var a=new Int32Array(r+1);return a[0]=n,new wf(this,a)},t.PDF417_GF=new t(Jn.NUMBER_OF_CODEWORDS,3),t}(the),nhe=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},ahe=function(){function s(){this.field=rhe.PDF417_GF}return s.prototype.decode=function(t,r,n){for(var a,i,o=new wf(this.field,t),l=new Int32Array(r),c=!1,d=r;d>0;d--){var u=o.evaluateAt(this.field.exp(d));l[r-d]=u,u!==0&&(c=!0)}if(!c)return 0;var h=this.field.getOne();if(n!=null)try{for(var f=nhe(n),m=f.next();!m.done;m=f.next()){var p=m.value,g=this.field.exp(t.length-1-p),v=new wf(this.field,new Int32Array([this.field.subtract(0,g),1]));h=h.multiply(v)}}catch(_){a={error:_}}finally{try{m&&!m.done&&(i=f.return)&&i.call(f)}finally{if(a)throw a.error}}for(var y=new wf(this.field,l),j=this.runEuclideanAlgorithm(this.field.buildMonomial(r,1),y,r),b=j[0],w=j[1],N=this.findErrorLocations(b),C=this.findErrorMagnitudes(w,b,N),d=0;d<N.length;d++){var S=t.length-1-this.field.log(N[d]);if(S<0)throw no.getChecksumInstance();t[S]=this.field.subtract(t[S],C[d])}return N.length},s.prototype.runEuclideanAlgorithm=function(t,r,n){if(t.getDegree()<r.getDegree()){var a=t;t=r,r=a}for(var i=t,o=r,l=this.field.getZero(),c=this.field.getOne();o.getDegree()>=Math.round(n/2);){var d=i,u=l;if(i=o,l=c,i.isZero())throw no.getChecksumInstance();o=d;for(var h=this.field.getZero(),f=i.getCoefficient(i.getDegree()),m=this.field.inverse(f);o.getDegree()>=i.getDegree()&&!o.isZero();){var p=o.getDegree()-i.getDegree(),g=this.field.multiply(o.getCoefficient(o.getDegree()),m);h=h.add(this.field.buildMonomial(p,g)),o=o.subtract(i.multiplyByMonomial(p,g))}c=h.multiply(l).subtract(u).negative()}var v=c.getCoefficient(0);if(v===0)throw no.getChecksumInstance();var y=this.field.inverse(v),j=c.multiply(y),b=o.multiply(y);return[j,b]},s.prototype.findErrorLocations=function(t){for(var r=t.getDegree(),n=new Int32Array(r),a=0,i=1;i<this.field.getSize()&&a<r;i++)t.evaluateAt(i)===0&&(n[a]=this.field.inverse(i),a++);if(a!==r)throw no.getChecksumInstance();return n},s.prototype.findErrorMagnitudes=function(t,r,n){for(var a=r.getDegree(),i=new Int32Array(a),o=1;o<=a;o++)i[a-o]=this.field.multiply(o,r.getCoefficient(o));for(var l=new wf(this.field,i),c=n.length,d=new Int32Array(c),o=0;o<c;o++){var u=this.field.inverse(n[o]),h=this.field.subtract(0,t.evaluateAt(u)),f=this.field.inverse(l.evaluateAt(u));d[o]=this.field.multiply(h,f)}return d},s}(),b4=function(){function s(t,r,n,a,i){t instanceof s?this.constructor_2(t):this.constructor_1(t,r,n,a,i)}return s.prototype.constructor_1=function(t,r,n,a,i){var o=r==null||n==null,l=a==null||i==null;if(o&&l)throw new es;o?(r=new ur(0,a.getY()),n=new ur(0,i.getY())):l&&(a=new ur(t.getWidth()-1,r.getY()),i=new ur(t.getWidth()-1,n.getY())),this.image=t,this.topLeft=r,this.bottomLeft=n,this.topRight=a,this.bottomRight=i,this.minX=Math.trunc(Math.min(r.getX(),n.getX())),this.maxX=Math.trunc(Math.max(a.getX(),i.getX())),this.minY=Math.trunc(Math.min(r.getY(),a.getY())),this.maxY=Math.trunc(Math.max(n.getY(),i.getY()))},s.prototype.constructor_2=function(t){this.image=t.image,this.topLeft=t.getTopLeft(),this.bottomLeft=t.getBottomLeft(),this.topRight=t.getTopRight(),this.bottomRight=t.getBottomRight(),this.minX=t.getMinX(),this.maxX=t.getMaxX(),this.minY=t.getMinY(),this.maxY=t.getMaxY()},s.merge=function(t,r){return t==null?r:r==null?t:new s(t.image,t.topLeft,t.bottomLeft,r.topRight,r.bottomRight)},s.prototype.addMissingRows=function(t,r,n){var a=this.topLeft,i=this.bottomLeft,o=this.topRight,l=this.bottomRight;if(t>0){var c=n?this.topLeft:this.topRight,d=Math.trunc(c.getY()-t);d<0&&(d=0);var u=new ur(c.getX(),d);n?a=u:o=u}if(r>0){var h=n?this.bottomLeft:this.bottomRight,f=Math.trunc(h.getY()+r);f>=this.image.getHeight()&&(f=this.image.getHeight()-1);var m=new ur(h.getX(),f);n?i=m:l=m}return new s(this.image,a,i,o,l)},s.prototype.getMinX=function(){return this.minX},s.prototype.getMaxX=function(){return this.maxX},s.prototype.getMinY=function(){return this.minY},s.prototype.getMaxY=function(){return this.maxY},s.prototype.getTopLeft=function(){return this.topLeft},s.prototype.getTopRight=function(){return this.topRight},s.prototype.getBottomLeft=function(){return this.bottomLeft},s.prototype.getBottomRight=function(){return this.bottomRight},s}(),ihe=function(){function s(t,r,n,a){this.columnCount=t,this.errorCorrectionLevel=a,this.rowCountUpperPart=r,this.rowCountLowerPart=n,this.rowCount=r+n}return s.prototype.getColumnCount=function(){return this.columnCount},s.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},s.prototype.getRowCount=function(){return this.rowCount},s.prototype.getRowCountUpperPart=function(){return this.rowCountUpperPart},s.prototype.getRowCountLowerPart=function(){return this.rowCountLowerPart},s}(),E3=function(){function s(){this.buffer=""}return s.form=function(t,r){var n=-1;function a(o,l,c,d,u,h){if(o==="%%")return"%";if(r[++n]!==void 0){o=d?parseInt(d.substr(1)):void 0;var f=u?parseInt(u.substr(1)):void 0,m;switch(h){case"s":m=r[n];break;case"c":m=r[n][0];break;case"f":m=parseFloat(r[n]).toFixed(o);break;case"p":m=parseFloat(r[n]).toPrecision(o);break;case"e":m=parseFloat(r[n]).toExponential(o);break;case"x":m=parseInt(r[n]).toString(f||16);break;case"d":m=parseFloat(parseInt(r[n],f||10).toPrecision(o)).toFixed(0);break}m=typeof m=="object"?JSON.stringify(m):(+m).toString(f);for(var p=parseInt(c),g=c&&c[0]+""=="0"?"0":" ";m.length<p;)m=l!==void 0?m+g:g+m;return m}}var i=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return t.replace(i,a)},s.prototype.format=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.buffer+=s.form(t,r)},s.prototype.toString=function(){return this.buffer},s}(),ohe=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},$9=function(){function s(t){this.boundingBox=new b4(t),this.codewords=new Array(t.getMaxY()-t.getMinY()+1)}return s.prototype.getCodewordNearby=function(t){var r=this.getCodeword(t);if(r!=null)return r;for(var n=1;n<s.MAX_NEARBY_DISTANCE;n++){var a=this.imageRowToCodewordIndex(t)-n;if(a>=0&&(r=this.codewords[a],r!=null)||(a=this.imageRowToCodewordIndex(t)+n,a<this.codewords.length&&(r=this.codewords[a],r!=null)))return r}return null},s.prototype.imageRowToCodewordIndex=function(t){return t-this.boundingBox.getMinY()},s.prototype.setCodeword=function(t,r){this.codewords[this.imageRowToCodewordIndex(t)]=r},s.prototype.getCodeword=function(t){return this.codewords[this.imageRowToCodewordIndex(t)]},s.prototype.getBoundingBox=function(){return this.boundingBox},s.prototype.getCodewords=function(){return this.codewords},s.prototype.toString=function(){var t,r,n=new E3,a=0;try{for(var i=ohe(this.codewords),o=i.next();!o.done;o=i.next()){var l=o.value;if(l==null){n.format("%3d:    |   %n",a++);continue}n.format("%3d: %3d|%3d%n",a++,l.getRowNumber(),l.getValue())}}catch(c){t={error:c}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n.toString()},s.MAX_NEARBY_DISTANCE=5,s}(),lhe=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},che=function(s,t){var r=typeof Symbol=="function"&&s[Symbol.iterator];if(!r)return s;var n=r.call(s),a,i=[],o;try{for(;(t===void 0||t-- >0)&&!(a=n.next()).done;)i.push(a.value)}catch(l){o={error:l}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i},S0=function(){function s(){this.values=new Map}return s.prototype.setValue=function(t){t=Math.trunc(t);var r=this.values.get(t);r==null&&(r=0),r++,this.values.set(t,r)},s.prototype.getValue=function(){var t,r,n=-1,a=new Array,i=function(h,f){var m={getKey:function(){return h},getValue:function(){return f}};m.getValue()>n?(n=m.getValue(),a=[],a.push(m.getKey())):m.getValue()===n&&a.push(m.getKey())};try{for(var o=lhe(this.values.entries()),l=o.next();!l.done;l=o.next()){var c=che(l.value,2),d=c[0],u=c[1];i(d,u)}}catch(h){t={error:h}}finally{try{l&&!l.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return Jn.toIntArray(a)},s.prototype.getConfidence=function(t){return this.values.get(t)},s}(),dhe=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),eS=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Fk=function(s){dhe(t,s);function t(r,n){var a=s.call(this,r)||this;return a._isLeft=n,a}return t.prototype.setRowNumbers=function(){var r,n;try{for(var a=eS(this.getCodewords()),i=a.next();!i.done;i=a.next()){var o=i.value;o!=null&&o.setRowNumberAsRowIndicatorColumn()}}catch(l){r={error:l}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},t.prototype.adjustCompleteIndicatorColumnRowNumbers=function(r){var n=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(n,r);for(var a=this.getBoundingBox(),i=this._isLeft?a.getTopLeft():a.getTopRight(),o=this._isLeft?a.getBottomLeft():a.getBottomRight(),l=this.imageRowToCodewordIndex(Math.trunc(i.getY())),c=this.imageRowToCodewordIndex(Math.trunc(o.getY())),d=-1,u=1,h=0,f=l;f<c;f++)if(n[f]!=null){var m=n[f],p=m.getRowNumber()-d;if(p===0)h++;else if(p===1)u=Math.max(u,h),h=1,d=m.getRowNumber();else if(p<0||m.getRowNumber()>=r.getRowCount()||p>f)n[f]=null;else{var g=void 0;u>2?g=(u-2)*p:g=p;for(var v=g>=f,y=1;y<=g&&!v;y++)v=n[f-y]!=null;v?n[f]=null:(d=m.getRowNumber(),h=1)}}},t.prototype.getRowHeights=function(){var r,n,a=this.getBarcodeMetadata();if(a==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(a);var i=new Int32Array(a.getRowCount());try{for(var o=eS(this.getCodewords()),l=o.next();!l.done;l=o.next()){var c=l.value;if(c!=null){var d=c.getRowNumber();if(d>=i.length)continue;i[d]++}}}catch(u){r={error:u}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return i},t.prototype.adjustIncompleteIndicatorColumnRowNumbers=function(r){for(var n=this.getBoundingBox(),a=this._isLeft?n.getTopLeft():n.getTopRight(),i=this._isLeft?n.getBottomLeft():n.getBottomRight(),o=this.imageRowToCodewordIndex(Math.trunc(a.getY())),l=this.imageRowToCodewordIndex(Math.trunc(i.getY())),c=this.getCodewords(),d=-1,u=o;u<l;u++)if(c[u]!=null){var h=c[u];h.setRowNumberAsRowIndicatorColumn();var f=h.getRowNumber()-d;f===0||(f===1?d=h.getRowNumber():h.getRowNumber()>=r.getRowCount()?c[u]=null:d=h.getRowNumber())}},t.prototype.getBarcodeMetadata=function(){var r,n,a=this.getCodewords(),i=new S0,o=new S0,l=new S0,c=new S0;try{for(var d=eS(a),u=d.next();!u.done;u=d.next()){var h=u.value;if(h!=null){h.setRowNumberAsRowIndicatorColumn();var f=h.getValue()%30,m=h.getRowNumber();switch(this._isLeft||(m+=2),m%3){case 0:o.setValue(f*3+1);break;case 1:c.setValue(f/3),l.setValue(f%3);break;case 2:i.setValue(f+1);break}}}}catch(g){r={error:g}}finally{try{u&&!u.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}if(i.getValue().length===0||o.getValue().length===0||l.getValue().length===0||c.getValue().length===0||i.getValue()[0]<1||o.getValue()[0]+l.getValue()[0]<Jn.MIN_ROWS_IN_BARCODE||o.getValue()[0]+l.getValue()[0]>Jn.MAX_ROWS_IN_BARCODE)return null;var p=new ihe(i.getValue()[0],o.getValue()[0],l.getValue()[0],c.getValue()[0]);return this.removeIncorrectCodewords(a,p),p},t.prototype.removeIncorrectCodewords=function(r,n){for(var a=0;a<r.length;a++){var i=r[a];if(r[a]!=null){var o=i.getValue()%30,l=i.getRowNumber();if(l>n.getRowCount()){r[a]=null;continue}switch(this._isLeft||(l+=2),l%3){case 0:o*3+1!==n.getRowCountUpperPart()&&(r[a]=null);break;case 1:(Math.trunc(o/3)!==n.getErrorCorrectionLevel()||o%3!==n.getRowCountLowerPart())&&(r[a]=null);break;case 2:o+1!==n.getColumnCount()&&(r[a]=null);break}}}},t.prototype.isLeft=function(){return this._isLeft},t.prototype.toString=function(){return"IsLeft: "+this._isLeft+`
`+s.prototype.toString.call(this)},t}($9),uhe=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},hhe=function(){function s(t,r){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=t,this.barcodeColumnCount=t.getColumnCount(),this.boundingBox=r,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}return s.prototype.getDetectionResultColumns=function(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);var t=Jn.MAX_CODEWORDS_IN_BARCODE,r;do r=t,t=this.adjustRowNumbersAndGetCount();while(t>0&&t<r);return this.detectionResultColumns},s.prototype.adjustIndicatorColumnRowNumbers=function(t){t!=null&&t.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)},s.prototype.adjustRowNumbersAndGetCount=function(){var t=this.adjustRowNumbersByRow();if(t===0)return 0;for(var r=1;r<this.barcodeColumnCount+1;r++)for(var n=this.detectionResultColumns[r].getCodewords(),a=0;a<n.length;a++)n[a]!=null&&(n[a].hasValidRowNumber()||this.adjustRowNumbers(r,a,n));return t},s.prototype.adjustRowNumbersByRow=function(){this.adjustRowNumbersFromBothRI();var t=this.adjustRowNumbersFromLRI();return t+this.adjustRowNumbersFromRRI()},s.prototype.adjustRowNumbersFromBothRI=function(){if(!(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)){for(var t=this.detectionResultColumns[0].getCodewords(),r=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),n=0;n<t.length;n++)if(t[n]!=null&&r[n]!=null&&t[n].getRowNumber()===r[n].getRowNumber())for(var a=1;a<=this.barcodeColumnCount;a++){var i=this.detectionResultColumns[a].getCodewords()[n];i!=null&&(i.setRowNumber(t[n].getRowNumber()),i.hasValidRowNumber()||(this.detectionResultColumns[a].getCodewords()[n]=null))}}},s.prototype.adjustRowNumbersFromRRI=function(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;for(var t=0,r=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),n=0;n<r.length;n++)if(r[n]!=null)for(var a=r[n].getRowNumber(),i=0,o=this.barcodeColumnCount+1;o>0&&i<this.ADJUST_ROW_NUMBER_SKIP;o--){var l=this.detectionResultColumns[o].getCodewords()[n];l!=null&&(i=s.adjustRowNumberIfValid(a,i,l),l.hasValidRowNumber()||t++)}return t},s.prototype.adjustRowNumbersFromLRI=function(){if(this.detectionResultColumns[0]==null)return 0;for(var t=0,r=this.detectionResultColumns[0].getCodewords(),n=0;n<r.length;n++)if(r[n]!=null)for(var a=r[n].getRowNumber(),i=0,o=1;o<this.barcodeColumnCount+1&&i<this.ADJUST_ROW_NUMBER_SKIP;o++){var l=this.detectionResultColumns[o].getCodewords()[n];l!=null&&(i=s.adjustRowNumberIfValid(a,i,l),l.hasValidRowNumber()||t++)}return t},s.adjustRowNumberIfValid=function(t,r,n){return n==null||n.hasValidRowNumber()||(n.isValidRowNumber(t)?(n.setRowNumber(t),r=0):++r),r},s.prototype.adjustRowNumbers=function(t,r,n){var a,i;if(this.detectionResultColumns[t-1]!=null){var o=n[r],l=this.detectionResultColumns[t-1].getCodewords(),c=l;this.detectionResultColumns[t+1]!=null&&(c=this.detectionResultColumns[t+1].getCodewords());var d=new Array(14);d[2]=l[r],d[3]=c[r],r>0&&(d[0]=n[r-1],d[4]=l[r-1],d[5]=c[r-1]),r>1&&(d[8]=n[r-2],d[10]=l[r-2],d[11]=c[r-2]),r<n.length-1&&(d[1]=n[r+1],d[6]=l[r+1],d[7]=c[r+1]),r<n.length-2&&(d[9]=n[r+2],d[12]=l[r+2],d[13]=c[r+2]);try{for(var u=uhe(d),h=u.next();!h.done;h=u.next()){var f=h.value;if(s.adjustRowNumber(o,f))return}}catch(m){a={error:m}}finally{try{h&&!h.done&&(i=u.return)&&i.call(u)}finally{if(a)throw a.error}}}},s.adjustRowNumber=function(t,r){return r==null?!1:r.hasValidRowNumber()&&r.getBucket()===t.getBucket()?(t.setRowNumber(r.getRowNumber()),!0):!1},s.prototype.getBarcodeColumnCount=function(){return this.barcodeColumnCount},s.prototype.getBarcodeRowCount=function(){return this.barcodeMetadata.getRowCount()},s.prototype.getBarcodeECLevel=function(){return this.barcodeMetadata.getErrorCorrectionLevel()},s.prototype.setBoundingBox=function(t){this.boundingBox=t},s.prototype.getBoundingBox=function(){return this.boundingBox},s.prototype.setDetectionResultColumn=function(t,r){this.detectionResultColumns[t]=r},s.prototype.getDetectionResultColumn=function(t){return this.detectionResultColumns[t]},s.prototype.toString=function(){var t=this.detectionResultColumns[0];t==null&&(t=this.detectionResultColumns[this.barcodeColumnCount+1]);for(var r=new E3,n=0;n<t.getCodewords().length;n++){r.format("CW %3d:",n);for(var a=0;a<this.barcodeColumnCount+2;a++){if(this.detectionResultColumns[a]==null){r.format("    |   ");continue}var i=this.detectionResultColumns[a].getCodewords()[n];if(i==null){r.format("    |   ");continue}r.format(" %3d|%3d",i.getRowNumber(),i.getValue())}r.format("%n")}return r.toString()},s}(),mhe=function(){function s(t,r,n,a){this.rowNumber=s.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(t),this.endX=Math.trunc(r),this.bucket=Math.trunc(n),this.value=Math.trunc(a)}return s.prototype.hasValidRowNumber=function(){return this.isValidRowNumber(this.rowNumber)},s.prototype.isValidRowNumber=function(t){return t!==s.BARCODE_ROW_UNKNOWN&&this.bucket===t%3*3},s.prototype.setRowNumberAsRowIndicatorColumn=function(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))},s.prototype.getWidth=function(){return this.endX-this.startX},s.prototype.getStartX=function(){return this.startX},s.prototype.getEndX=function(){return this.endX},s.prototype.getBucket=function(){return this.bucket},s.prototype.getValue=function(){return this.value},s.prototype.getRowNumber=function(){return this.rowNumber},s.prototype.setRowNumber=function(t){this.rowNumber=t},s.prototype.toString=function(){return this.rowNumber+"|"+this.value},s.BARCODE_ROW_UNKNOWN=-1,s}(),fhe=function(){function s(){}return s.initialize=function(){for(var t=0;t<Jn.SYMBOL_TABLE.length;t++)for(var r=Jn.SYMBOL_TABLE[t],n=r&1,a=0;a<Jn.BARS_IN_MODULE;a++){for(var i=0;(r&1)===n;)i+=1,r>>=1;n=r&1,s.RATIOS_TABLE[t]||(s.RATIOS_TABLE[t]=new Array(Jn.BARS_IN_MODULE)),s.RATIOS_TABLE[t][Jn.BARS_IN_MODULE-a-1]=Math.fround(i/Jn.MODULES_IN_CODEWORD)}this.bSymbolTableReady=!0},s.getDecodedValue=function(t){var r=s.getDecodedCodewordValue(s.sampleBitCounts(t));return r!==-1?r:s.getClosestDecodedValue(t)},s.sampleBitCounts=function(t){for(var r=ea.sum(t),n=new Int32Array(Jn.BARS_IN_MODULE),a=0,i=0,o=0;o<Jn.MODULES_IN_CODEWORD;o++){var l=r/(2*Jn.MODULES_IN_CODEWORD)+o*r/Jn.MODULES_IN_CODEWORD;i+t[a]<=l&&(i+=t[a],a++),n[a]++}return n},s.getDecodedCodewordValue=function(t){var r=s.getBitValue(t);return Jn.getCodeword(r)===-1?-1:r},s.getBitValue=function(t){for(var r=0,n=0;n<t.length;n++)for(var a=0;a<t[n];a++)r=r<<1|(n%2===0?1:0);return Math.trunc(r)},s.getClosestDecodedValue=function(t){var r=ea.sum(t),n=new Array(Jn.BARS_IN_MODULE);if(r>1)for(var a=0;a<n.length;a++)n[a]=Math.fround(t[a]/r);var i=v4.MAX_VALUE,o=-1;this.bSymbolTableReady||s.initialize();for(var l=0;l<s.RATIOS_TABLE.length;l++){for(var c=0,d=s.RATIOS_TABLE[l],u=0;u<Jn.BARS_IN_MODULE;u++){var h=Math.fround(d[u]-n[u]);if(c+=Math.fround(h*h),c>=i)break}c<i&&(i=c,o=Jn.SYMBOL_TABLE[l])}return o},s.bSymbolTableReady=!1,s.RATIOS_TABLE=new Array(Jn.SYMBOL_TABLE.length).map(function(t){return new Array(Jn.BARS_IN_MODULE)}),s}(),xhe=function(){function s(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}return s.prototype.getSegmentIndex=function(){return this.segmentIndex},s.prototype.setSegmentIndex=function(t){this.segmentIndex=t},s.prototype.getFileId=function(){return this.fileId},s.prototype.setFileId=function(t){this.fileId=t},s.prototype.getOptionalData=function(){return this.optionalData},s.prototype.setOptionalData=function(t){this.optionalData=t},s.prototype.isLastSegment=function(){return this.lastSegment},s.prototype.setLastSegment=function(t){this.lastSegment=t},s.prototype.getSegmentCount=function(){return this.segmentCount},s.prototype.setSegmentCount=function(t){this.segmentCount=t},s.prototype.getSender=function(){return this.sender||null},s.prototype.setSender=function(t){this.sender=t},s.prototype.getAddressee=function(){return this.addressee||null},s.prototype.setAddressee=function(t){this.addressee=t},s.prototype.getFileName=function(){return this.fileName},s.prototype.setFileName=function(t){this.fileName=t},s.prototype.getFileSize=function(){return this.fileSize},s.prototype.setFileSize=function(t){this.fileSize=t},s.prototype.getChecksum=function(){return this.checksum},s.prototype.setChecksum=function(t){this.checksum=t},s.prototype.getTimestamp=function(){return this.timestamp},s.prototype.setTimestamp=function(t){this.timestamp=t},s}(),Mk=function(){function s(){}return s.parseLong=function(t,r){return r===void 0&&(r=void 0),parseInt(t,r)},s}(),phe=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ghe=function(s){phe(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.kind="NullPointerException",t}(lc),vhe=function(){function s(){}return s.prototype.writeBytes=function(t){this.writeBytesOffset(t,0,t.length)},s.prototype.writeBytesOffset=function(t,r,n){if(t==null)throw new ghe;if(r<0||r>t.length||n<0||r+n>t.length||r+n<0)throw new w3;if(n===0)return;for(var a=0;a<n;a++)this.write(t[r+a])},s.prototype.flush=function(){},s.prototype.close=function(){},s}(),yhe=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),jhe=function(s){yhe(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t}(lc),bhe=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Nhe=function(s){bhe(t,s);function t(r){r===void 0&&(r=32);var n=s.call(this)||this;if(n.count=0,r<0)throw new Or("Negative initial size: "+r);return n.buf=new Uint8Array(r),n}return t.prototype.ensureCapacity=function(r){r-this.buf.length>0&&this.grow(r)},t.prototype.grow=function(r){var n=this.buf.length,a=n<<1;if(a-r<0&&(a=r),a<0){if(r<0)throw new jhe;a=_n.MAX_VALUE}this.buf=So.copyOfUint8Array(this.buf,a)},t.prototype.write=function(r){this.ensureCapacity(this.count+1),this.buf[this.count]=r,this.count+=1},t.prototype.writeBytesOffset=function(r,n,a){if(n<0||n>r.length||a<0||n+a-r.length>0)throw new w3;this.ensureCapacity(this.count+a),ei.arraycopy(r,n,this.buf,this.count,a),this.count+=a},t.prototype.writeTo=function(r){r.writeBytesOffset(this.buf,0,this.count)},t.prototype.reset=function(){this.count=0},t.prototype.toByteArray=function(){return So.copyOfUint8Array(this.buf,this.count)},t.prototype.size=function(){return this.count},t.prototype.toString=function(r){return r?typeof r=="string"?this.toString_string(r):this.toString_number(r):this.toString_void()},t.prototype.toString_void=function(){return new String(this.buf).toString()},t.prototype.toString_string=function(r){return new String(this.buf).toString()},t.prototype.toString_number=function(r){return new String(this.buf).toString()},t.prototype.close=function(){},t}(vhe),Ia;(function(s){s[s.ALPHA=0]="ALPHA",s[s.LOWER=1]="LOWER",s[s.MIXED=2]="MIXED",s[s.PUNCT=3]="PUNCT",s[s.ALPHA_SHIFT=4]="ALPHA_SHIFT",s[s.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Ia||(Ia={}));function B9(){if(typeof window<"u")return window.BigInt||null;if(typeof global<"u")return global.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}var fj;function Jh(s){if(typeof fj>"u"&&(fj=B9()),fj===null)throw new Error("BigInt is not supported!");return fj(s)}function whe(){var s=[];s[0]=Jh(1);var t=Jh(900);s[1]=t;for(var r=2;r<16;r++)s[r]=s[r-1]*t;return s}var She=function(){function s(){}return s.decode=function(t,r){var n=new En(""),a=wo.ISO8859_1;n.enableDecoding(a);for(var i=1,o=t[i++],l=new xhe;i<t[0];){switch(o){case s.TEXT_COMPACTION_MODE_LATCH:i=s.textCompaction(t,i,n);break;case s.BYTE_COMPACTION_MODE_LATCH:case s.BYTE_COMPACTION_MODE_LATCH_6:i=s.byteCompaction(o,t,a,i,n);break;case s.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(t[i++]);break;case s.NUMERIC_COMPACTION_MODE_LATCH:i=s.numericCompaction(t,i,n);break;case s.ECI_CHARSET:wo.getCharacterSetECIByValue(t[i++]);break;case s.ECI_GENERAL_PURPOSE:i+=2;break;case s.ECI_USER_DEFINED:i++;break;case s.BEGIN_MACRO_PDF417_CONTROL_BLOCK:i=s.decodeMacroBlock(t,i,l);break;case s.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case s.MACRO_PDF417_TERMINATOR:throw new Ls;default:i--,i=s.textCompaction(t,i,n);break}if(i<t.length)o=t[i++];else throw Ls.getFormatInstance()}if(n.length()===0)throw Ls.getFormatInstance();var c=new NN(null,n.toString(),null,r);return c.setOther(l),c},s.decodeMacroBlock=function(t,r,n){if(r+s.NUMBER_OF_SEQUENCE_CODEWORDS>t[0])throw Ls.getFormatInstance();for(var a=new Int32Array(s.NUMBER_OF_SEQUENCE_CODEWORDS),i=0;i<s.NUMBER_OF_SEQUENCE_CODEWORDS;i++,r++)a[i]=t[r];n.setSegmentIndex(_n.parseInt(s.decodeBase900toBase10(a,s.NUMBER_OF_SEQUENCE_CODEWORDS)));var o=new En;r=s.textCompaction(t,r,o),n.setFileId(o.toString());var l=-1;for(t[r]===s.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(l=r+1);r<t[0];)switch(t[r]){case s.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(r++,t[r]){case s.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:var c=new En;r=s.textCompaction(t,r+1,c),n.setFileName(c.toString());break;case s.MACRO_PDF417_OPTIONAL_FIELD_SENDER:var d=new En;r=s.textCompaction(t,r+1,d),n.setSender(d.toString());break;case s.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:var u=new En;r=s.textCompaction(t,r+1,u),n.setAddressee(u.toString());break;case s.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:var h=new En;r=s.numericCompaction(t,r+1,h),n.setSegmentCount(_n.parseInt(h.toString()));break;case s.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:var f=new En;r=s.numericCompaction(t,r+1,f),n.setTimestamp(Mk.parseLong(f.toString()));break;case s.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:var m=new En;r=s.numericCompaction(t,r+1,m),n.setChecksum(_n.parseInt(m.toString()));break;case s.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:var p=new En;r=s.numericCompaction(t,r+1,p),n.setFileSize(Mk.parseLong(p.toString()));break;default:throw Ls.getFormatInstance()}break;case s.MACRO_PDF417_TERMINATOR:r++,n.setLastSegment(!0);break;default:throw Ls.getFormatInstance()}if(l!==-1){var g=r-l;n.isLastSegment()&&g--,n.setOptionalData(So.copyOfRange(t,l,l+g))}return r},s.textCompaction=function(t,r,n){for(var a=new Int32Array((t[0]-r)*2),i=new Int32Array((t[0]-r)*2),o=0,l=!1;r<t[0]&&!l;){var c=t[r++];if(c<s.TEXT_COMPACTION_MODE_LATCH)a[o]=c/30,a[o+1]=c%30,o+=2;else switch(c){case s.TEXT_COMPACTION_MODE_LATCH:a[o++]=s.TEXT_COMPACTION_MODE_LATCH;break;case s.BYTE_COMPACTION_MODE_LATCH:case s.BYTE_COMPACTION_MODE_LATCH_6:case s.NUMERIC_COMPACTION_MODE_LATCH:case s.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case s.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case s.MACRO_PDF417_TERMINATOR:r--,l=!0;break;case s.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a[o]=s.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,c=t[r++],i[o]=c,o++;break}}return s.decodeTextCompaction(a,i,o,n),r},s.decodeTextCompaction=function(t,r,n,a){for(var i=Ia.ALPHA,o=Ia.ALPHA,l=0;l<n;){var c=t[l],d="";switch(i){case Ia.ALPHA:if(c<26)d=String.fromCharCode(65+c);else switch(c){case 26:d=" ";break;case s.LL:i=Ia.LOWER;break;case s.ML:i=Ia.MIXED;break;case s.PS:o=i,i=Ia.PUNCT_SHIFT;break;case s.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case s.TEXT_COMPACTION_MODE_LATCH:i=Ia.ALPHA;break}break;case Ia.LOWER:if(c<26)d=String.fromCharCode(97+c);else switch(c){case 26:d=" ";break;case s.AS:o=i,i=Ia.ALPHA_SHIFT;break;case s.ML:i=Ia.MIXED;break;case s.PS:o=i,i=Ia.PUNCT_SHIFT;break;case s.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case s.TEXT_COMPACTION_MODE_LATCH:i=Ia.ALPHA;break}break;case Ia.MIXED:if(c<s.PL)d=s.MIXED_CHARS[c];else switch(c){case s.PL:i=Ia.PUNCT;break;case 26:d=" ";break;case s.LL:i=Ia.LOWER;break;case s.AL:i=Ia.ALPHA;break;case s.PS:o=i,i=Ia.PUNCT_SHIFT;break;case s.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case s.TEXT_COMPACTION_MODE_LATCH:i=Ia.ALPHA;break}break;case Ia.PUNCT:if(c<s.PAL)d=s.PUNCT_CHARS[c];else switch(c){case s.PAL:i=Ia.ALPHA;break;case s.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case s.TEXT_COMPACTION_MODE_LATCH:i=Ia.ALPHA;break}break;case Ia.ALPHA_SHIFT:if(i=o,c<26)d=String.fromCharCode(65+c);else switch(c){case 26:d=" ";break;case s.TEXT_COMPACTION_MODE_LATCH:i=Ia.ALPHA;break}break;case Ia.PUNCT_SHIFT:if(i=o,c<s.PAL)d=s.PUNCT_CHARS[c];else switch(c){case s.PAL:i=Ia.ALPHA;break;case s.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(r[l]);break;case s.TEXT_COMPACTION_MODE_LATCH:i=Ia.ALPHA;break}break}d!==""&&a.append(d),l++}},s.byteCompaction=function(t,r,n,a,i){var o=new Nhe,l=0,c=0,d=!1;switch(t){case s.BYTE_COMPACTION_MODE_LATCH:for(var u=new Int32Array(6),h=r[a++];a<r[0]&&!d;)switch(u[l++]=h,c=900*c+h,h=r[a++],h){case s.TEXT_COMPACTION_MODE_LATCH:case s.BYTE_COMPACTION_MODE_LATCH:case s.NUMERIC_COMPACTION_MODE_LATCH:case s.BYTE_COMPACTION_MODE_LATCH_6:case s.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case s.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case s.MACRO_PDF417_TERMINATOR:a--,d=!0;break;default:if(l%5===0&&l>0){for(var f=0;f<6;++f)o.write(Number(Jh(c)>>Jh(8*(5-f))));c=0,l=0}break}a===r[0]&&h<s.TEXT_COMPACTION_MODE_LATCH&&(u[l++]=h);for(var m=0;m<l;m++)o.write(u[m]);break;case s.BYTE_COMPACTION_MODE_LATCH_6:for(;a<r[0]&&!d;){var p=r[a++];if(p<s.TEXT_COMPACTION_MODE_LATCH)l++,c=900*c+p;else switch(p){case s.TEXT_COMPACTION_MODE_LATCH:case s.BYTE_COMPACTION_MODE_LATCH:case s.NUMERIC_COMPACTION_MODE_LATCH:case s.BYTE_COMPACTION_MODE_LATCH_6:case s.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case s.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case s.MACRO_PDF417_TERMINATOR:a--,d=!0;break}if(l%5===0&&l>0){for(var f=0;f<6;++f)o.write(Number(Jh(c)>>Jh(8*(5-f))));c=0,l=0}}break}return i.append(td.decode(o.toByteArray(),n)),a},s.numericCompaction=function(t,r,n){for(var a=0,i=!1,o=new Int32Array(s.MAX_NUMERIC_CODEWORDS);r<t[0]&&!i;){var l=t[r++];if(r===t[0]&&(i=!0),l<s.TEXT_COMPACTION_MODE_LATCH)o[a]=l,a++;else switch(l){case s.TEXT_COMPACTION_MODE_LATCH:case s.BYTE_COMPACTION_MODE_LATCH:case s.BYTE_COMPACTION_MODE_LATCH_6:case s.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case s.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case s.MACRO_PDF417_TERMINATOR:r--,i=!0;break}(a%s.MAX_NUMERIC_CODEWORDS===0||l===s.NUMERIC_COMPACTION_MODE_LATCH||i)&&a>0&&(n.append(s.decodeBase900toBase10(o,a)),a=0)}return r},s.decodeBase900toBase10=function(t,r){for(var n=Jh(0),a=0;a<r;a++)n+=s.EXP900[r-a-1]*Jh(t[a]);var i=n.toString();if(i.charAt(0)!=="1")throw new Ls;return i.substring(1)},s.TEXT_COMPACTION_MODE_LATCH=900,s.BYTE_COMPACTION_MODE_LATCH=901,s.NUMERIC_COMPACTION_MODE_LATCH=902,s.BYTE_COMPACTION_MODE_LATCH_6=924,s.ECI_USER_DEFINED=925,s.ECI_GENERAL_PURPOSE=926,s.ECI_CHARSET=927,s.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,s.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,s.MACRO_PDF417_TERMINATOR=922,s.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,s.MAX_NUMERIC_CODEWORDS=15,s.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,s.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,s.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,s.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,s.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,s.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,s.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,s.PL=25,s.LL=27,s.AS=27,s.ML=28,s.AL=28,s.PS=29,s.PAL=29,s.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,s.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",s.EXP900=B9()?whe():[],s.NUMBER_OF_SEQUENCE_CODEWORDS=2,s}(),i0=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Che=function(){function s(){}return s.decode=function(t,r,n,a,i,o,l){for(var c=new b4(t,r,n,a,i),d=null,u=null,h,f=!0;;f=!1){if(r!=null&&(d=s.getRowIndicatorColumn(t,c,r,!0,o,l)),a!=null&&(u=s.getRowIndicatorColumn(t,c,a,!1,o,l)),h=s.merge(d,u),h==null)throw es.getNotFoundInstance();var m=h.getBoundingBox();if(f&&m!=null&&(m.getMinY()<c.getMinY()||m.getMaxY()>c.getMaxY()))c=m;else break}h.setBoundingBox(c);var p=h.getBarcodeColumnCount()+1;h.setDetectionResultColumn(0,d),h.setDetectionResultColumn(p,u);for(var g=d!=null,v=1;v<=p;v++){var y=g?v:p-v;if(h.getDetectionResultColumn(y)===void 0){var j=void 0;y===0||y===p?j=new Fk(c,y===0):j=new $9(c),h.setDetectionResultColumn(y,j);for(var b=-1,w=b,N=c.getMinY();N<=c.getMaxY();N++){if(b=s.getStartColumn(h,y,N,g),b<0||b>c.getMaxX()){if(w===-1)continue;b=w}var C=s.detectCodeword(t,c.getMinX(),c.getMaxX(),g,b,N,o,l);C!=null&&(j.setCodeword(N,C),w=b,o=Math.min(o,C.getWidth()),l=Math.max(l,C.getWidth()))}}}return s.createDecoderResult(h)},s.merge=function(t,r){if(t==null&&r==null)return null;var n=s.getBarcodeMetadata(t,r);if(n==null)return null;var a=b4.merge(s.adjustBoundingBox(t),s.adjustBoundingBox(r));return new hhe(n,a)},s.adjustBoundingBox=function(t){var r,n;if(t==null)return null;var a=t.getRowHeights();if(a==null)return null;var i=s.getMax(a),o=0;try{for(var l=i0(a),c=l.next();!c.done;c=l.next()){var d=c.value;if(o+=i-d,d>0)break}}catch(m){r={error:m}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}for(var u=t.getCodewords(),h=0;o>0&&u[h]==null;h++)o--;for(var f=0,h=a.length-1;h>=0&&(f+=i-a[h],!(a[h]>0));h--);for(var h=u.length-1;f>0&&u[h]==null;h--)f--;return t.getBoundingBox().addMissingRows(o,f,t.isLeft())},s.getMax=function(t){var r,n,a=-1;try{for(var i=i0(t),o=i.next();!o.done;o=i.next()){var l=o.value;a=Math.max(a,l)}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},s.getBarcodeMetadata=function(t,r){var n;if(t==null||(n=t.getBarcodeMetadata())==null)return r==null?null:r.getBarcodeMetadata();var a;return r==null||(a=r.getBarcodeMetadata())==null?n:n.getColumnCount()!==a.getColumnCount()&&n.getErrorCorrectionLevel()!==a.getErrorCorrectionLevel()&&n.getRowCount()!==a.getRowCount()?null:n},s.getRowIndicatorColumn=function(t,r,n,a,i,o){for(var l=new Fk(r,a),c=0;c<2;c++)for(var d=c===0?1:-1,u=Math.trunc(Math.trunc(n.getX())),h=Math.trunc(Math.trunc(n.getY()));h<=r.getMaxY()&&h>=r.getMinY();h+=d){var f=s.detectCodeword(t,0,t.getWidth(),a,u,h,i,o);f!=null&&(l.setCodeword(h,f),a?u=f.getStartX():u=f.getEndX())}return l},s.adjustCodewordCount=function(t,r){var n=r[0][1],a=n.getValue(),i=t.getBarcodeColumnCount()*t.getBarcodeRowCount()-s.getNumberOfECCodeWords(t.getBarcodeECLevel());if(a.length===0){if(i<1||i>Jn.MAX_CODEWORDS_IN_BARCODE)throw es.getNotFoundInstance();n.setValue(i)}else a[0]!==i&&n.setValue(i)},s.createDecoderResult=function(t){var r=s.createBarcodeMatrix(t);s.adjustCodewordCount(t,r);for(var n=new Array,a=new Int32Array(t.getBarcodeRowCount()*t.getBarcodeColumnCount()),i=[],o=new Array,l=0;l<t.getBarcodeRowCount();l++)for(var c=0;c<t.getBarcodeColumnCount();c++){var d=r[l][c+1].getValue(),u=l*t.getBarcodeColumnCount()+c;d.length===0?n.push(u):d.length===1?a[u]=d[0]:(o.push(u),i.push(d))}for(var h=new Array(i.length),f=0;f<h.length;f++)h[f]=i[f];return s.createDecoderResultFromAmbiguousValues(t.getBarcodeECLevel(),a,Jn.toIntArray(n),Jn.toIntArray(o),h)},s.createDecoderResultFromAmbiguousValues=function(t,r,n,a,i){for(var o=new Int32Array(a.length),l=100;l-- >0;){for(var c=0;c<o.length;c++)r[a[c]]=i[c][o[c]];try{return s.decodeCodewords(r,t,n)}catch(u){var d=u instanceof no;if(!d)throw u}if(o.length===0)throw no.getChecksumInstance();for(var c=0;c<o.length;c++)if(o[c]<i[c].length-1){o[c]++;break}else if(o[c]=0,c===o.length-1)throw no.getChecksumInstance()}throw no.getChecksumInstance()},s.createBarcodeMatrix=function(t){for(var r,n,a,i,o=Array.from({length:t.getBarcodeRowCount()},function(){return new Array(t.getBarcodeColumnCount()+2)}),l=0;l<o.length;l++)for(var c=0;c<o[l].length;c++)o[l][c]=new S0;var d=0;try{for(var u=i0(t.getDetectionResultColumns()),h=u.next();!h.done;h=u.next()){var f=h.value;if(f!=null)try{for(var m=(a=void 0,i0(f.getCodewords())),p=m.next();!p.done;p=m.next()){var g=p.value;if(g!=null){var v=g.getRowNumber();if(v>=0){if(v>=o.length)continue;o[v][d].setValue(g.getValue())}}}}catch(y){a={error:y}}finally{try{p&&!p.done&&(i=m.return)&&i.call(m)}finally{if(a)throw a.error}}d++}}catch(y){r={error:y}}finally{try{h&&!h.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}return o},s.isValidBarcodeColumn=function(t,r){return r>=0&&r<=t.getBarcodeColumnCount()+1},s.getStartColumn=function(t,r,n,a){var i,o,l=a?1:-1,c=null;if(s.isValidBarcodeColumn(t,r-l)&&(c=t.getDetectionResultColumn(r-l).getCodeword(n)),c!=null)return a?c.getEndX():c.getStartX();if(c=t.getDetectionResultColumn(r).getCodewordNearby(n),c!=null)return a?c.getStartX():c.getEndX();if(s.isValidBarcodeColumn(t,r-l)&&(c=t.getDetectionResultColumn(r-l).getCodewordNearby(n)),c!=null)return a?c.getEndX():c.getStartX();for(var d=0;s.isValidBarcodeColumn(t,r-l);){r-=l;try{for(var u=(i=void 0,i0(t.getDetectionResultColumn(r).getCodewords())),h=u.next();!h.done;h=u.next()){var f=h.value;if(f!=null)return(a?f.getEndX():f.getStartX())+l*d*(f.getEndX()-f.getStartX())}}catch(m){i={error:m}}finally{try{h&&!h.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}d++}return a?t.getBoundingBox().getMinX():t.getBoundingBox().getMaxX()},s.detectCodeword=function(t,r,n,a,i,o,l,c){i=s.adjustCodewordStartColumn(t,r,n,a,i,o);var d=s.getModuleBitCount(t,r,n,a,i,o);if(d==null)return null;var u,h=ea.sum(d);if(a)u=i+h;else{for(var f=0;f<d.length/2;f++){var m=d[f];d[f]=d[d.length-1-f],d[d.length-1-f]=m}u=i,i=u-h}if(!s.checkCodewordSkew(h,l,c))return null;var p=fhe.getDecodedValue(d),g=Jn.getCodeword(p);return g===-1?null:new mhe(i,u,s.getCodewordBucketNumber(p),g)},s.getModuleBitCount=function(t,r,n,a,i,o){for(var l=i,c=new Int32Array(8),d=0,u=a?1:-1,h=a;(a?l<n:l>=r)&&d<c.length;)t.get(l,o)===h?(c[d]++,l+=u):(d++,h=!h);return d===c.length||l===(a?n:r)&&d===c.length-1?c:null},s.getNumberOfECCodeWords=function(t){return 2<<t},s.adjustCodewordStartColumn=function(t,r,n,a,i,o){for(var l=i,c=a?-1:1,d=0;d<2;d++){for(;(a?l>=r:l<n)&&a===t.get(l,o);){if(Math.abs(i-l)>s.CODEWORD_SKEW_SIZE)return i;l+=c}c=-c,a=!a}return l},s.checkCodewordSkew=function(t,r,n){return r-s.CODEWORD_SKEW_SIZE<=t&&t<=n+s.CODEWORD_SKEW_SIZE},s.decodeCodewords=function(t,r,n){if(t.length===0)throw Ls.getFormatInstance();var a=1<<r+1,i=s.correctErrors(t,n,a);s.verifyCodewordCount(t,a);var o=She.decode(t,""+r);return o.setErrorsCorrected(i),o.setErasures(n.length),o},s.correctErrors=function(t,r,n){if(r!=null&&r.length>n/2+s.MAX_ERRORS||n<0||n>s.MAX_EC_CODEWORDS)throw no.getChecksumInstance();return s.errorCorrection.decode(t,n,r)},s.verifyCodewordCount=function(t,r){if(t.length<4)throw Ls.getFormatInstance();var n=t[0];if(n>t.length)throw Ls.getFormatInstance();if(n===0)if(r<t.length)t[0]=t.length-r;else throw Ls.getFormatInstance()},s.getBitCountForCodeword=function(t){for(var r=new Int32Array(8),n=0,a=r.length-1;!((t&1)!==n&&(n=t&1,a--,a<0));)r[a]++,t>>=1;return r},s.getCodewordBucketNumber=function(t){return t instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(t):this.getCodewordBucketNumber_number(t)},s.getCodewordBucketNumber_number=function(t){return s.getCodewordBucketNumber(s.getBitCountForCodeword(t))},s.getCodewordBucketNumber_Int32Array=function(t){return(t[0]-t[2]+t[4]-t[6]+9)%9},s.toString=function(t){for(var r=new E3,n=0;n<t.length;n++){r.format("Row %2d: ",n);for(var a=0;a<t[n].length;a++){var i=t[n][a];i.getValue().length===0?r.format("        ",null):r.format("%4d(%2d)",i.getValue()[0],i.getConfidence(i.getValue()[0]))}r.format("%n")}return r.toString()},s.CODEWORD_SKEW_SIZE=2,s.MAX_ERRORS=3,s.MAX_EC_CODEWORDS=512,s.errorCorrection=new ahe,s}(),Ahe=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},_1=function(){function s(){}return s.prototype.decode=function(t,r){r===void 0&&(r=null);var n=s.decode(t,r,!1);if(n==null||n.length===0||n[0]==null)throw es.getNotFoundInstance();return n[0]},s.prototype.decodeMultiple=function(t,r){r===void 0&&(r=null);try{return s.decode(t,r,!0)}catch(n){throw n instanceof Ls||n instanceof no?es.getNotFoundInstance():n}},s.decode=function(t,r,n){var a,i,o=new Array,l=Zue.detectMultiple(t,r,n);try{for(var c=Ahe(l.getPoints()),d=c.next();!d.done;d=c.next()){var u=d.value,h=Che.decode(l.getBits(),u[4],u[5],u[6],u[7],s.getMinCodewordWidth(u),s.getMaxCodewordWidth(u)),f=new xl(h.getText(),h.getRawBytes(),void 0,u,Dr.PDF_417);f.putMetadata(Xo.ERROR_CORRECTION_LEVEL,h.getECLevel());var m=h.getOther();m!=null&&f.putMetadata(Xo.PDF417_EXTRA_METADATA,m),o.push(f)}}catch(p){a={error:p}}finally{try{d&&!d.done&&(i=c.return)&&i.call(c)}finally{if(a)throw a.error}}return o.map(function(p){return p})},s.getMaxWidth=function(t,r){return t==null||r==null?0:Math.trunc(Math.abs(t.getX()-r.getX()))},s.getMinWidth=function(t,r){return t==null||r==null?_n.MAX_VALUE:Math.trunc(Math.abs(t.getX()-r.getX()))},s.getMaxCodewordWidth=function(t){return Math.floor(Math.max(Math.max(s.getMaxWidth(t[0],t[4]),s.getMaxWidth(t[6],t[2])*Jn.MODULES_IN_CODEWORD/Jn.MODULES_IN_STOP_PATTERN),Math.max(s.getMaxWidth(t[1],t[5]),s.getMaxWidth(t[7],t[3])*Jn.MODULES_IN_CODEWORD/Jn.MODULES_IN_STOP_PATTERN)))},s.getMinCodewordWidth=function(t){return Math.floor(Math.min(Math.min(s.getMinWidth(t[0],t[4]),s.getMinWidth(t[6],t[2])*Jn.MODULES_IN_CODEWORD/Jn.MODULES_IN_STOP_PATTERN),Math.min(s.getMinWidth(t[1],t[5]),s.getMinWidth(t[7],t[3])*Jn.MODULES_IN_CODEWORD/Jn.MODULES_IN_STOP_PATTERN)))},s.prototype.reset=function(){},s}(),Ehe=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Lk=function(s){Ehe(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.kind="ReaderException",t}(lc),$k=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},U9=function(){function s(){}return s.prototype.decode=function(t,r){return this.setHints(r),this.decodeInternal(t)},s.prototype.decodeWithState=function(t){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(t)},s.prototype.setHints=function(t){this.hints=t;var r=t!=null&&t.get(ti.TRY_HARDER)!==void 0,n=t==null?null:t.get(ti.POSSIBLE_FORMATS),a=new Array;if(n!=null){var i=n.some(function(o){return o===Dr.UPC_A||o===Dr.UPC_E||o===Dr.EAN_13||o===Dr.EAN_8||o===Dr.CODABAR||o===Dr.CODE_39||o===Dr.CODE_93||o===Dr.CODE_128||o===Dr.ITF||o===Dr.RSS_14||o===Dr.RSS_EXPANDED});i&&!r&&a.push(new Wx(t)),n.includes(Dr.QR_CODE)&&a.push(new P1),n.includes(Dr.DATA_MATRIX)&&a.push(new I1),n.includes(Dr.AZTEC)&&a.push(new A1),n.includes(Dr.PDF_417)&&a.push(new _1),i&&r&&a.push(new Wx(t))}a.length===0&&(r||a.push(new Wx(t)),a.push(new P1),a.push(new I1),a.push(new A1),a.push(new _1),r&&a.push(new Wx(t))),this.readers=a},s.prototype.reset=function(){var t,r;if(this.readers!==null)try{for(var n=$k(this.readers),a=n.next();!a.done;a=n.next()){var i=a.value;i.reset()}}catch(o){t={error:o}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},s.prototype.decodeInternal=function(t){var r,n;if(this.readers===null)throw new Lk("No readers where selected, nothing can be read.");try{for(var a=$k(this.readers),i=a.next();!i.done;i=a.next()){var o=i.value;try{return o.decode(t,this.hints)}catch(l){if(l instanceof Lk)continue}}}catch(l){r={error:l}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}throw new es("No MultiFormat Readers were able to detect the code.")},s}(),Ihe=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(s){Ihe(t,s);function t(r,n){r===void 0&&(r=null),n===void 0&&(n=500);var a=this,i=new U9;return i.setHints(r),a=s.call(this,i,n)||this,a}return t.prototype.decodeBitmap=function(r){return this.reader.decodeWithState(r)},t})(Sg);var Phe=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(s){Phe(t,s);function t(r){return r===void 0&&(r=500),s.call(this,new _1,r)||this}return t})(Sg);var _he=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(s){_he(t,s);function t(r){return r===void 0&&(r=500),s.call(this,new P1,r)||this}return t})(Sg);var N4;(function(s){s[s.ERROR_CORRECTION=0]="ERROR_CORRECTION",s[s.CHARACTER_SET=1]="CHARACTER_SET",s[s.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",s[s.DATA_MATRIX_COMPACT=3]="DATA_MATRIX_COMPACT",s[s.MIN_SIZE=4]="MIN_SIZE",s[s.MAX_SIZE=5]="MAX_SIZE",s[s.MARGIN=6]="MARGIN",s[s.PDF417_COMPACT=7]="PDF417_COMPACT",s[s.PDF417_COMPACTION=8]="PDF417_COMPACTION",s[s.PDF417_DIMENSIONS=9]="PDF417_DIMENSIONS",s[s.AZTEC_LAYERS=10]="AZTEC_LAYERS",s[s.QR_VERSION=11]="QR_VERSION",s[s.GS1_FORMAT=12]="GS1_FORMAT",s[s.FORCE_C40=13]="FORCE_C40"})(N4||(N4={}));const xj=N4;var z9=function(){function s(t){this.field=t,this.cachedGenerators=[],this.cachedGenerators.push(new Im(t,Int32Array.from([1])))}return s.prototype.buildGenerator=function(t){var r=this.cachedGenerators;if(t>=r.length)for(var n=r[r.length-1],a=this.field,i=r.length;i<=t;i++){var o=n.multiply(new Im(a,Int32Array.from([1,a.exp(i-1+a.getGeneratorBase())])));r.push(o),n=o}return r[t]},s.prototype.encode=function(t,r){if(r===0)throw new Or("No error correction bytes");var n=t.length-r;if(n<=0)throw new Or("No data bytes provided");var a=this.buildGenerator(r),i=new Int32Array(n);ei.arraycopy(t,0,i,0,n);var o=new Im(this.field,i);o=o.multiplyByMonomial(r,1);for(var l=o.divide(a)[1],c=l.getCoefficients(),d=r-c.length,u=0;u<d;u++)t[n+u]=0;ei.arraycopy(c,0,t,n+d,c.length)},s}(),C0=function(){function s(){}return s.applyMaskPenaltyRule1=function(t){return s.applyMaskPenaltyRule1Internal(t,!0)+s.applyMaskPenaltyRule1Internal(t,!1)},s.applyMaskPenaltyRule2=function(t){for(var r=0,n=t.getArray(),a=t.getWidth(),i=t.getHeight(),o=0;o<i-1;o++)for(var l=n[o],c=0;c<a-1;c++){var d=l[c];d===l[c+1]&&d===n[o+1][c]&&d===n[o+1][c+1]&&r++}return s.N2*r},s.applyMaskPenaltyRule3=function(t){for(var r=0,n=t.getArray(),a=t.getWidth(),i=t.getHeight(),o=0;o<i;o++)for(var l=0;l<a;l++){var c=n[o];l+6<a&&c[l]===1&&c[l+1]===0&&c[l+2]===1&&c[l+3]===1&&c[l+4]===1&&c[l+5]===0&&c[l+6]===1&&(s.isWhiteHorizontal(c,l-4,l)||s.isWhiteHorizontal(c,l+7,l+11))&&r++,o+6<i&&n[o][l]===1&&n[o+1][l]===0&&n[o+2][l]===1&&n[o+3][l]===1&&n[o+4][l]===1&&n[o+5][l]===0&&n[o+6][l]===1&&(s.isWhiteVertical(n,l,o-4,o)||s.isWhiteVertical(n,l,o+7,o+11))&&r++}return r*s.N3},s.isWhiteHorizontal=function(t,r,n){r=Math.max(r,0),n=Math.min(n,t.length);for(var a=r;a<n;a++)if(t[a]===1)return!1;return!0},s.isWhiteVertical=function(t,r,n,a){n=Math.max(n,0),a=Math.min(a,t.length);for(var i=n;i<a;i++)if(t[i][r]===1)return!1;return!0},s.applyMaskPenaltyRule4=function(t){for(var r=0,n=t.getArray(),a=t.getWidth(),i=t.getHeight(),o=0;o<i;o++)for(var l=n[o],c=0;c<a;c++)l[c]===1&&r++;var d=t.getHeight()*t.getWidth(),u=Math.floor(Math.abs(r*2-d)*10/d);return u*s.N4},s.getDataMaskBit=function(t,r,n){var a,i;switch(t){case 0:a=n+r&1;break;case 1:a=n&1;break;case 2:a=r%3;break;case 3:a=(n+r)%3;break;case 4:a=Math.floor(n/2)+Math.floor(r/3)&1;break;case 5:i=n*r,a=(i&1)+i%3;break;case 6:i=n*r,a=(i&1)+i%3&1;break;case 7:i=n*r,a=i%3+(n+r&1)&1;break;default:throw new Or("Invalid mask pattern: "+t)}return a===0},s.applyMaskPenaltyRule1Internal=function(t,r){for(var n=0,a=r?t.getHeight():t.getWidth(),i=r?t.getWidth():t.getHeight(),o=t.getArray(),l=0;l<a;l++){for(var c=0,d=-1,u=0;u<i;u++){var h=r?o[l][u]:o[u][l];h===d?c++:(c>=5&&(n+=s.N1+(c-5)),c=1,d=h)}c>=5&&(n+=s.N1+(c-5))}return n},s.N1=3,s.N2=3,s.N3=40,s.N4=10,s}(),khe=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},The=function(){function s(t,r){this.width=t,this.height=r;for(var n=new Array(r),a=0;a!==r;a++)n[a]=new Uint8Array(t);this.bytes=n}return s.prototype.getHeight=function(){return this.height},s.prototype.getWidth=function(){return this.width},s.prototype.get=function(t,r){return this.bytes[r][t]},s.prototype.getArray=function(){return this.bytes},s.prototype.setNumber=function(t,r,n){this.bytes[r][t]=n},s.prototype.setBoolean=function(t,r,n){this.bytes[r][t]=n?1:0},s.prototype.clear=function(t){var r,n;try{for(var a=khe(this.bytes),i=a.next();!i.done;i=a.next()){var o=i.value;So.fill(o,t)}}catch(l){r={error:l}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}},s.prototype.equals=function(t){if(!(t instanceof s))return!1;var r=t;if(this.width!==r.width||this.height!==r.height)return!1;for(var n=0,a=this.height;n<a;++n)for(var i=this.bytes[n],o=r.bytes[n],l=0,c=this.width;l<c;++l)if(i[l]!==o[l])return!1;return!0},s.prototype.toString=function(){for(var t=new En,r=0,n=this.height;r<n;++r){for(var a=this.bytes[r],i=0,o=this.width;i<o;++i)switch(a[i]){case 0:t.append(" 0");break;case 1:t.append(" 1");break;default:t.append("  ");break}t.append(`
`)}return t.toString()},s}(),w4=function(){function s(){this.maskPattern=-1}return s.prototype.getMode=function(){return this.mode},s.prototype.getECLevel=function(){return this.ecLevel},s.prototype.getVersion=function(){return this.version},s.prototype.getMaskPattern=function(){return this.maskPattern},s.prototype.getMatrix=function(){return this.matrix},s.prototype.toString=function(){var t=new En;return t.append(`<<
`),t.append(" mode: "),t.append(this.mode?this.mode.toString():"null"),t.append(`
 ecLevel: `),t.append(this.ecLevel?this.ecLevel.toString():"null"),t.append(`
 version: `),t.append(this.version?this.version.toString():"null"),t.append(`
 maskPattern: `),t.append(this.maskPattern.toString()),this.matrix?(t.append(`
 matrix:
`),t.append(this.matrix.toString())):t.append(`
 matrix: null
`),t.append(`>>
`),t.toString()},s.prototype.setMode=function(t){this.mode=t},s.prototype.setECLevel=function(t){this.ecLevel=t},s.prototype.setVersion=function(t){this.version=t},s.prototype.setMaskPattern=function(t){this.maskPattern=t},s.prototype.setMatrix=function(t){this.matrix=t},s.isValidMaskPattern=function(t){return t>=0&&t<s.NUM_MASK_PATTERNS},s.NUM_MASK_PATTERNS=8,s}(),Dhe=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ii=function(s){Dhe(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.kind="WriterException",t}(lc),Bk=function(){function s(){}return s.clearMatrix=function(t){t.clear(255)},s.buildMatrix=function(t,r,n,a,i){s.clearMatrix(i),s.embedBasicPatterns(n,i),s.embedTypeInfo(r,a,i),s.maybeEmbedVersionInfo(n,i),s.embedDataBits(t,a,i)},s.embedBasicPatterns=function(t,r){s.embedPositionDetectionPatternsAndSeparators(r),s.embedDarkDotAtLeftBottomCorner(r),s.maybeEmbedPositionAdjustmentPatterns(t,r),s.embedTimingPatterns(r)},s.embedTypeInfo=function(t,r,n){var a=new Bo;s.makeTypeInfoBits(t,r,a);for(var i=0,o=a.getSize();i<o;++i){var l=a.get(a.getSize()-1-i),c=s.TYPE_INFO_COORDINATES[i],d=c[0],u=c[1];if(n.setBoolean(d,u,l),i<8){var h=n.getWidth()-i-1,f=8;n.setBoolean(h,f,l)}else{var h=8,f=n.getHeight()-7+(i-8);n.setBoolean(h,f,l)}}},s.maybeEmbedVersionInfo=function(t,r){if(!(t.getVersionNumber()<7)){var n=new Bo;s.makeVersionInfoBits(t,n);for(var a=6*3-1,i=0;i<6;++i)for(var o=0;o<3;++o){var l=n.get(a);a--,r.setBoolean(i,r.getHeight()-11+o,l),r.setBoolean(r.getHeight()-11+o,i,l)}}},s.embedDataBits=function(t,r,n){for(var a=0,i=-1,o=n.getWidth()-1,l=n.getHeight()-1;o>0;){for(o===6&&(o-=1);l>=0&&l<n.getHeight();){for(var c=0;c<2;++c){var d=o-c;if(s.isEmpty(n.get(d,l))){var u=void 0;a<t.getSize()?(u=t.get(a),++a):u=!1,r!==255&&C0.getDataMaskBit(r,d,l)&&(u=!u),n.setBoolean(d,l,u)}}l+=i}i=-i,l+=i,o-=2}if(a!==t.getSize())throw new ii("Not all bits consumed: "+a+"/"+t.getSize())},s.findMSBSet=function(t){return 32-_n.numberOfLeadingZeros(t)},s.calculateBCHCode=function(t,r){if(r===0)throw new Or("0 polynomial");var n=s.findMSBSet(r);for(t<<=n-1;s.findMSBSet(t)>=n;)t^=r<<s.findMSBSet(t)-n;return t},s.makeTypeInfoBits=function(t,r,n){if(!w4.isValidMaskPattern(r))throw new ii("Invalid mask pattern");var a=t.getBits()<<3|r;n.appendBits(a,5);var i=s.calculateBCHCode(a,s.TYPE_INFO_POLY);n.appendBits(i,10);var o=new Bo;if(o.appendBits(s.TYPE_INFO_MASK_PATTERN,15),n.xor(o),n.getSize()!==15)throw new ii("should not happen but we got: "+n.getSize())},s.makeVersionInfoBits=function(t,r){r.appendBits(t.getVersionNumber(),6);var n=s.calculateBCHCode(t.getVersionNumber(),s.VERSION_INFO_POLY);if(r.appendBits(n,12),r.getSize()!==18)throw new ii("should not happen but we got: "+r.getSize())},s.isEmpty=function(t){return t===255},s.embedTimingPatterns=function(t){for(var r=8;r<t.getWidth()-8;++r){var n=(r+1)%2;s.isEmpty(t.get(r,6))&&t.setNumber(r,6,n),s.isEmpty(t.get(6,r))&&t.setNumber(6,r,n)}},s.embedDarkDotAtLeftBottomCorner=function(t){if(t.get(8,t.getHeight()-8)===0)throw new ii;t.setNumber(8,t.getHeight()-8,1)},s.embedHorizontalSeparationPattern=function(t,r,n){for(var a=0;a<8;++a){if(!s.isEmpty(n.get(t+a,r)))throw new ii;n.setNumber(t+a,r,0)}},s.embedVerticalSeparationPattern=function(t,r,n){for(var a=0;a<7;++a){if(!s.isEmpty(n.get(t,r+a)))throw new ii;n.setNumber(t,r+a,0)}},s.embedPositionAdjustmentPattern=function(t,r,n){for(var a=0;a<5;++a)for(var i=s.POSITION_ADJUSTMENT_PATTERN[a],o=0;o<5;++o)n.setNumber(t+o,r+a,i[o])},s.embedPositionDetectionPattern=function(t,r,n){for(var a=0;a<7;++a)for(var i=s.POSITION_DETECTION_PATTERN[a],o=0;o<7;++o)n.setNumber(t+o,r+a,i[o])},s.embedPositionDetectionPatternsAndSeparators=function(t){var r=s.POSITION_DETECTION_PATTERN[0].length;s.embedPositionDetectionPattern(0,0,t),s.embedPositionDetectionPattern(t.getWidth()-r,0,t),s.embedPositionDetectionPattern(0,t.getWidth()-r,t);var n=8;s.embedHorizontalSeparationPattern(0,n-1,t),s.embedHorizontalSeparationPattern(t.getWidth()-n,n-1,t),s.embedHorizontalSeparationPattern(0,t.getWidth()-n,t);var a=7;s.embedVerticalSeparationPattern(a,0,t),s.embedVerticalSeparationPattern(t.getHeight()-a-1,0,t),s.embedVerticalSeparationPattern(a,t.getHeight()-a,t)},s.maybeEmbedPositionAdjustmentPatterns=function(t,r){if(!(t.getVersionNumber()<2))for(var n=t.getVersionNumber()-1,a=s.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[n],i=0,o=a.length;i!==o;i++){var l=a[i];if(l>=0)for(var c=0;c!==o;c++){var d=a[c];d>=0&&s.isEmpty(r.get(d,l))&&s.embedPositionAdjustmentPattern(d-2,l-2,r)}}},s.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),s.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),s.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),s.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),s.VERSION_INFO_POLY=7973,s.TYPE_INFO_POLY=1335,s.TYPE_INFO_MASK_PATTERN=21522,s}(),Ohe=function(){function s(t,r){this.dataBytes=t,this.errorCorrectionBytes=r}return s.prototype.getDataBytes=function(){return this.dataBytes},s.prototype.getErrorCorrectionBytes=function(){return this.errorCorrectionBytes},s}(),Uk=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(){function s(){}return s.calculateMaskPenalty=function(t){return C0.applyMaskPenaltyRule1(t)+C0.applyMaskPenaltyRule2(t)+C0.applyMaskPenaltyRule3(t)+C0.applyMaskPenaltyRule4(t)},s.encode=function(t,r,n){n===void 0&&(n=null);var a=s.DEFAULT_BYTE_MODE_ENCODING,i=n!==null&&n.get(xj.CHARACTER_SET)!==void 0;i&&(a=n.get(xj.CHARACTER_SET).toString());var o=this.chooseMode(t,a),l=new Bo;if(o===li.BYTE&&(i||s.DEFAULT_BYTE_MODE_ENCODING!==a)){var c=wo.getCharacterSetECIByName(a);c!==void 0&&this.appendECI(c,l)}this.appendModeInfo(o,l);var d=new Bo;this.appendBytes(t,o,d,a);var u;if(n!==null&&n.get(xj.QR_VERSION)!==void 0){var h=Number.parseInt(n.get(xj.QR_VERSION).toString(),10);u=qf.getVersionForNumber(h);var f=this.calculateBitsNeeded(o,l,d,u);if(!this.willFit(f,u,r))throw new ii("Data too big for requested version")}else u=this.recommendVersion(r,o,l,d);var m=new Bo;m.appendBitArray(l);var p=o===li.BYTE?d.getSizeInBytes():t.length;this.appendLengthInfo(p,u,o,m),m.appendBitArray(d);var g=u.getECBlocksForLevel(r),v=u.getTotalCodewords()-g.getTotalECCodewords();this.terminateBits(v,m);var y=this.interleaveWithECBytes(m,u.getTotalCodewords(),v,g.getNumBlocks()),j=new w4;j.setECLevel(r),j.setMode(o),j.setVersion(u);var b=u.getDimensionForVersion(),w=new The(b,b),N=this.chooseMaskPattern(y,r,u,w);return j.setMaskPattern(N),Bk.buildMatrix(y,r,u,N,w),j.setMatrix(w),j},s.recommendVersion=function(t,r,n,a){var i=this.calculateBitsNeeded(r,n,a,qf.getVersionForNumber(1)),o=this.chooseVersion(i,t),l=this.calculateBitsNeeded(r,n,a,o);return this.chooseVersion(l,t)},s.calculateBitsNeeded=function(t,r,n,a){return r.getSize()+t.getCharacterCountBits(a)+n.getSize()},s.getAlphanumericCode=function(t){return t<s.ALPHANUMERIC_TABLE.length?s.ALPHANUMERIC_TABLE[t]:-1},s.chooseMode=function(t,r){if(r===void 0&&(r=null),wo.SJIS.getName()===r&&this.isOnlyDoubleByteKanji(t))return li.KANJI;for(var n=!1,a=!1,i=0,o=t.length;i<o;++i){var l=t.charAt(i);if(s.isDigit(l))n=!0;else if(this.getAlphanumericCode(l.charCodeAt(0))!==-1)a=!0;else return li.BYTE}return a?li.ALPHANUMERIC:n?li.NUMERIC:li.BYTE},s.isOnlyDoubleByteKanji=function(t){var r;try{r=td.encode(t,wo.SJIS)}catch{return!1}var n=r.length;if(n%2!==0)return!1;for(var a=0;a<n;a+=2){var i=r[a]&255;if((i<129||i>159)&&(i<224||i>235))return!1}return!0},s.chooseMaskPattern=function(t,r,n,a){for(var i=Number.MAX_SAFE_INTEGER,o=-1,l=0;l<w4.NUM_MASK_PATTERNS;l++){Bk.buildMatrix(t,r,n,l,a);var c=this.calculateMaskPenalty(a);c<i&&(i=c,o=l)}return o},s.chooseVersion=function(t,r){for(var n=1;n<=40;n++){var a=qf.getVersionForNumber(n);if(s.willFit(t,a,r))return a}throw new ii("Data too big")},s.willFit=function(t,r,n){var a=r.getTotalCodewords(),i=r.getECBlocksForLevel(n),o=i.getTotalECCodewords(),l=a-o,c=(t+7)/8;return l>=c},s.terminateBits=function(t,r){var n=t*8;if(r.getSize()>n)throw new ii("data bits cannot fit in the QR Code"+r.getSize()+" > "+n);for(var a=0;a<4&&r.getSize()<n;++a)r.appendBit(!1);var i=r.getSize()&7;if(i>0)for(var a=i;a<8;a++)r.appendBit(!1);for(var o=t-r.getSizeInBytes(),a=0;a<o;++a)r.appendBits(a&1?17:236,8);if(r.getSize()!==n)throw new ii("Bits size does not equal capacity")},s.getNumDataBytesAndNumECBytesForBlockID=function(t,r,n,a,i,o){if(a>=n)throw new ii("Block ID too large");var l=t%n,c=n-l,d=Math.floor(t/n),u=d+1,h=Math.floor(r/n),f=h+1,m=d-h,p=u-f;if(m!==p)throw new ii("EC bytes mismatch");if(n!==c+l)throw new ii("RS blocks mismatch");if(t!==(h+m)*c+(f+p)*l)throw new ii("Total bytes mismatch");a<c?(i[0]=h,o[0]=m):(i[0]=f,o[0]=p)},s.interleaveWithECBytes=function(t,r,n,a){var i,o,l,c;if(t.getSizeInBytes()!==n)throw new ii("Number of bits and data bytes does not match");for(var d=0,u=0,h=0,f=new Array,m=0;m<a;++m){var p=new Int32Array(1),g=new Int32Array(1);s.getNumDataBytesAndNumECBytesForBlockID(r,n,a,m,p,g);var v=p[0],y=new Uint8Array(v);t.toBytes(8*d,y,0,v);var j=s.generateECBytes(y,g[0]);f.push(new Ohe(y,j)),u=Math.max(u,v),h=Math.max(h,j.length),d+=p[0]}if(n!==d)throw new ii("Data bytes does not match offset");for(var b=new Bo,m=0;m<u;++m)try{for(var w=(i=void 0,Uk(f)),N=w.next();!N.done;N=w.next()){var C=N.value,y=C.getDataBytes();m<y.length&&b.appendBits(y[m],8)}}catch(F){i={error:F}}finally{try{N&&!N.done&&(o=w.return)&&o.call(w)}finally{if(i)throw i.error}}for(var m=0;m<h;++m)try{for(var S=(l=void 0,Uk(f)),_=S.next();!_.done;_=S.next()){var C=_.value,j=C.getErrorCorrectionBytes();m<j.length&&b.appendBits(j[m],8)}}catch(F){l={error:F}}finally{try{_&&!_.done&&(c=S.return)&&c.call(S)}finally{if(l)throw l.error}}if(r!==b.getSizeInBytes())throw new ii("Interleaving error: "+r+" and "+b.getSizeInBytes()+" differ.");return b},s.generateECBytes=function(t,r){for(var n=t.length,a=new Int32Array(n+r),i=0;i<n;i++)a[i]=t[i]&255;new z9(ec.QR_CODE_FIELD_256).encode(a,r);for(var o=new Uint8Array(r),i=0;i<r;i++)o[i]=a[n+i];return o},s.appendModeInfo=function(t,r){r.appendBits(t.getBits(),4)},s.appendLengthInfo=function(t,r,n,a){var i=n.getCharacterCountBits(r);if(t>=1<<i)throw new ii(t+" is bigger than "+((1<<i)-1));a.appendBits(t,i)},s.appendBytes=function(t,r,n,a){switch(r){case li.NUMERIC:s.appendNumericBytes(t,n);break;case li.ALPHANUMERIC:s.appendAlphanumericBytes(t,n);break;case li.BYTE:s.append8BitBytes(t,n,a);break;case li.KANJI:s.appendKanjiBytes(t,n);break;default:throw new ii("Invalid mode: "+r)}},s.getDigit=function(t){return t.charCodeAt(0)-48},s.isDigit=function(t){var r=s.getDigit(t);return r>=0&&r<=9},s.appendNumericBytes=function(t,r){for(var n=t.length,a=0;a<n;){var i=s.getDigit(t.charAt(a));if(a+2<n){var o=s.getDigit(t.charAt(a+1)),l=s.getDigit(t.charAt(a+2));r.appendBits(i*100+o*10+l,10),a+=3}else if(a+1<n){var o=s.getDigit(t.charAt(a+1));r.appendBits(i*10+o,7),a+=2}else r.appendBits(i,4),a++}},s.appendAlphanumericBytes=function(t,r){for(var n=t.length,a=0;a<n;){var i=s.getAlphanumericCode(t.charCodeAt(a));if(i===-1)throw new ii;if(a+1<n){var o=s.getAlphanumericCode(t.charCodeAt(a+1));if(o===-1)throw new ii;r.appendBits(i*45+o,11),a+=2}else r.appendBits(i,6),a++}},s.append8BitBytes=function(t,r,n){var a;try{a=td.encode(t,n)}catch(c){throw new ii(c)}for(var i=0,o=a.length;i!==o;i++){var l=a[i];r.appendBits(l,8)}},s.appendKanjiBytes=function(t,r){var n;try{n=td.encode(t,wo.SJIS)}catch(h){throw new ii(h)}for(var a=n.length,i=0;i<a;i+=2){var o=n[i]&255,l=n[i+1]&255,c=o<<8&4294967295|l,d=-1;if(c>=33088&&c<=40956?d=c-33088:c>=57408&&c<=60351&&(d=c-49472),d===-1)throw new ii("Invalid byte sequence");var u=(d>>8)*192+(d&255);r.appendBits(u,13)}},s.appendECI=function(t,r){r.appendBits(li.ECI.getBits(),4),r.appendBits(t.getValue(),8)},s.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),s.DEFAULT_BYTE_MODE_ENCODING=wo.UTF8.getName(),s})();var Rhe=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(s){Rhe(t,s);function t(r,n,a,i,o,l,c,d){var u=s.call(this,l,c)||this;if(u.yuvData=r,u.dataWidth=n,u.dataHeight=a,u.left=i,u.top=o,i+l>n||o+c>a)throw new Or("Crop rectangle does not fit within image data.");return d&&u.reverseHorizontal(l,c),u}return t.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Or("Requested row is outside the image: "+r);var a=this.getWidth();(n==null||n.length<a)&&(n=new Uint8ClampedArray(a));var i=(r+this.top)*this.dataWidth+this.left;return ei.arraycopy(this.yuvData,i,n,0,a),n},t.prototype.getMatrix=function(){var r=this.getWidth(),n=this.getHeight();if(r===this.dataWidth&&n===this.dataHeight)return this.yuvData;var a=r*n,i=new Uint8ClampedArray(a),o=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return ei.arraycopy(this.yuvData,o,i,0,a),i;for(var l=0;l<n;l++){var c=l*r;ei.arraycopy(this.yuvData,o,i,c,r),o+=this.dataWidth}return i},t.prototype.isCropSupported=function(){return!0},t.prototype.crop=function(r,n,a,i){return new t(this.yuvData,this.dataWidth,this.dataHeight,this.left+r,this.top+n,a,i,!1)},t.prototype.renderThumbnail=function(){for(var r=this.getWidth()/t.THUMBNAIL_SCALE_FACTOR,n=this.getHeight()/t.THUMBNAIL_SCALE_FACTOR,a=new Int32Array(r*n),i=this.yuvData,o=this.top*this.dataWidth+this.left,l=0;l<n;l++){for(var c=l*r,d=0;d<r;d++){var u=i[o+d*t.THUMBNAIL_SCALE_FACTOR]&255;a[c+d]=4278190080|u*65793}o+=this.dataWidth*t.THUMBNAIL_SCALE_FACTOR}return a},t.prototype.getThumbnailWidth=function(){return this.getWidth()/t.THUMBNAIL_SCALE_FACTOR},t.prototype.getThumbnailHeight=function(){return this.getHeight()/t.THUMBNAIL_SCALE_FACTOR},t.prototype.reverseHorizontal=function(r,n){for(var a=this.yuvData,i=0,o=this.top*this.dataWidth+this.left;i<n;i++,o+=this.dataWidth)for(var l=o+r/2,c=o,d=o+r-1;c<l;c++,d--){var u=a[c];a[c]=a[d],a[d]=u}},t.prototype.invert=function(){return new bN(this)},t.THUMBNAIL_SCALE_FACTOR=2,t})(uy);var Fhe=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(s){Fhe(t,s);function t(r,n,a,i,o,l,c){var d=s.call(this,n,a)||this;if(d.dataWidth=i,d.dataHeight=o,d.left=l,d.top=c,r.BYTES_PER_ELEMENT===4){for(var u=n*a,h=new Uint8ClampedArray(u),f=0;f<u;f++){var m=r[f],p=m>>16&255,g=m>>7&510,v=m&255;h[f]=(p+g+v)/4&255}d.luminances=h}else d.luminances=r;if(i===void 0&&(d.dataWidth=n),o===void 0&&(d.dataHeight=a),l===void 0&&(d.left=0),c===void 0&&(d.top=0),d.left+n>d.dataWidth||d.top+a>d.dataHeight)throw new Or("Crop rectangle does not fit within image data.");return d}return t.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Or("Requested row is outside the image: "+r);var a=this.getWidth();(n==null||n.length<a)&&(n=new Uint8ClampedArray(a));var i=(r+this.top)*this.dataWidth+this.left;return ei.arraycopy(this.luminances,i,n,0,a),n},t.prototype.getMatrix=function(){var r=this.getWidth(),n=this.getHeight();if(r===this.dataWidth&&n===this.dataHeight)return this.luminances;var a=r*n,i=new Uint8ClampedArray(a),o=this.top*this.dataWidth+this.left;if(r===this.dataWidth)return ei.arraycopy(this.luminances,o,i,0,a),i;for(var l=0;l<n;l++){var c=l*r;ei.arraycopy(this.luminances,o,i,c,r),o+=this.dataWidth}return i},t.prototype.isCropSupported=function(){return!0},t.prototype.crop=function(r,n,a,i){return new t(this.luminances,a,i,this.dataWidth,this.dataHeight,this.left+r,this.top+n)},t.prototype.invert=function(){return new bN(this)},t})(uy);var Mhe=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Lhe=function(s){Mhe(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.forName=function(r){return this.getCharacterSetECIByName(r)},t}(wo),$he=function(){function s(){}return s.ISO_8859_1=wo.ISO8859_1,s}(),S4,Bhe=301,Uhe=function(s,t){for(var r=1,n=0;n<255;n++)t[n]=r,s[r]=n,r*=2,r>=256&&(r^=Bhe);return{LOG:s,ALOG:t}};S4=Uhe([],[]),S4.LOG;S4.ALOG;var zk;(function(s){s[s.FORCE_NONE=0]="FORCE_NONE",s[s.FORCE_SQUARE=1]="FORCE_SQUARE",s[s.FORCE_RECTANGLE=2]="FORCE_RECTANGLE"})(zk||(zk={}));var qk=129,q9=230,zhe=231,qhe=235,Vhe=236,Whe=237,Hhe=238,Ghe=239,Khe=240,tS=254,Yhe=254,Vk="[)>05",Wk="[)>06",Hk="",ja=0,Yo=1,Sl=2,xo=3,Do=4,ol=5,Jhe=function(){function s(){}return s.prototype.getEncodingMode=function(){return ja},s.prototype.encode=function(t){var r=Id.determineConsecutiveDigitCount(t.getMessage(),t.pos);if(r>=2)t.writeCodeword(this.encodeASCIIDigits(t.getMessage().charCodeAt(t.pos),t.getMessage().charCodeAt(t.pos+1))),t.pos+=2;else{var n=t.getCurrentChar(),a=Id.lookAheadTest(t.getMessage(),t.pos,this.getEncodingMode());if(a!==this.getEncodingMode())switch(a){case ol:t.writeCodeword(zhe),t.signalEncoderChange(ol);return;case Yo:t.writeCodeword(q9),t.signalEncoderChange(Yo);return;case xo:t.writeCodeword(Hhe),t.signalEncoderChange(xo);break;case Sl:t.writeCodeword(Ghe),t.signalEncoderChange(Sl);break;case Do:t.writeCodeword(Khe),t.signalEncoderChange(Do);break;default:throw new Error("Illegal mode: "+a)}else Id.isExtendedASCII(n)?(t.writeCodeword(qhe),t.writeCodeword(n-128+1),t.pos++):(t.writeCodeword(n+1),t.pos++)}},s.prototype.encodeASCIIDigits=function(t,r){if(Id.isDigit(t)&&Id.isDigit(r)){var n=(t-48)*10+(r-48);return n+130}throw new Error("not digits: "+t+r)},s}(),Xhe=function(){function s(){}return s.prototype.getEncodingMode=function(){return ol},s.prototype.encode=function(t){var r=new En;for(r.append(0);t.hasMoreCharacters();){var n=t.getCurrentChar();r.append(n),t.pos++;var a=Id.lookAheadTest(t.getMessage(),t.pos,this.getEncodingMode());if(a!==this.getEncodingMode()){t.signalEncoderChange(ja);break}}var i=r.length()-1,o=1,l=t.getCodewordCount()+i+o;t.updateSymbolInfo(l);var c=t.getSymbolInfo().getDataCapacity()-l>0;if(t.hasMoreCharacters()||c)if(i<=249)r.setCharAt(0,Gn.getCharAt(i));else if(i<=1555)r.setCharAt(0,Gn.getCharAt(Math.floor(i/250)+249)),r.insert(1,Gn.getCharAt(i%250));else throw new Error("Message length not in valid ranges: "+i);for(var d=0,n=r.length();d<n;d++)t.writeCodeword(this.randomize255State(r.charAt(d).charCodeAt(0),t.getCodewordCount()+1))},s.prototype.randomize255State=function(t,r){var n=149*r%255+1,a=t+n;return a<=255?a:a-256},s}(),I3=function(){function s(){}return s.prototype.getEncodingMode=function(){return Yo},s.prototype.encodeMaximal=function(t){for(var r=new En,n=0,a=t.pos,i=0;t.hasMoreCharacters();){var o=t.getCurrentChar();t.pos++,n=this.encodeChar(o,r),r.length()%3===0&&(a=t.pos,i=r.length())}if(i!==r.length()){var l=Math.floor(r.length()/3*2),c=Math.floor(t.getCodewordCount()+l+1);t.updateSymbolInfo(c);var d=t.getSymbolInfo().getDataCapacity()-c,u=Math.floor(r.length()%3);(u===2&&d!==2||u===1&&(n>3||d!==1))&&(t.pos=a)}r.length()>0&&t.writeCodeword(q9),this.handleEOD(t,r)},s.prototype.encode=function(t){for(var r=new En;t.hasMoreCharacters();){var n=t.getCurrentChar();t.pos++;var a=this.encodeChar(n,r),i=Math.floor(r.length()/3)*2,o=t.getCodewordCount()+i;t.updateSymbolInfo(o);var l=t.getSymbolInfo().getDataCapacity()-o;if(!t.hasMoreCharacters()){var c=new En;for(r.length()%3===2&&l!==2&&(a=this.backtrackOneCharacter(t,r,c,a));r.length()%3===1&&(a>3||l!==1);)a=this.backtrackOneCharacter(t,r,c,a);break}var d=r.length();if(d%3===0){var u=Id.lookAheadTest(t.getMessage(),t.pos,this.getEncodingMode());if(u!==this.getEncodingMode()){t.signalEncoderChange(ja);break}}}this.handleEOD(t,r)},s.prototype.backtrackOneCharacter=function(t,r,n,a){var i=r.length(),o=r.toString().substring(0,i-a);r.setLengthToZero(),r.append(o),t.pos--;var l=t.getCurrentChar();return a=this.encodeChar(l,n),t.resetSymbolInfo(),a},s.prototype.writeNextTriplet=function(t,r){t.writeCodewords(this.encodeToCodewords(r.toString()));var n=r.toString().substring(3);r.setLengthToZero(),r.append(n)},s.prototype.handleEOD=function(t,r){var n=Math.floor(r.length()/3*2),a=r.length()%3,i=t.getCodewordCount()+n;t.updateSymbolInfo(i);var o=t.getSymbolInfo().getDataCapacity()-i;if(a===2){for(r.append("\0");r.length()>=3;)this.writeNextTriplet(t,r);t.hasMoreCharacters()&&t.writeCodeword(tS)}else if(o===1&&a===1){for(;r.length()>=3;)this.writeNextTriplet(t,r);t.hasMoreCharacters()&&t.writeCodeword(tS),t.pos--}else if(a===0){for(;r.length()>=3;)this.writeNextTriplet(t,r);(o>0||t.hasMoreCharacters())&&t.writeCodeword(tS)}else throw new Error("Unexpected case. Please report!");t.signalEncoderChange(ja)},s.prototype.encodeChar=function(t,r){if(t===32)return r.append(3),1;if(t>=48&&t<=57)return r.append(t-48+4),1;if(t>=65&&t<=90)return r.append(t-65+14),1;if(t<32)return r.append(0),r.append(t),2;if(t<=47)return r.append(1),r.append(t-33),2;if(t<=64)return r.append(1),r.append(t-58+15),2;if(t<=95)return r.append(1),r.append(t-91+22),2;if(t<=127)return r.append(2),r.append(t-96),2;r.append("1");var n=2;return n+=this.encodeChar(t-128,r),n},s.prototype.encodeToCodewords=function(t){var r=1600*t.charCodeAt(0)+40*t.charCodeAt(1)+t.charCodeAt(2)+1,n=r/256,a=r%256,i=new En;return i.append(n),i.append(a),i.toString()},s}(),Qhe=function(){function s(){}return s.prototype.getEncodingMode=function(){return Do},s.prototype.encode=function(t){for(var r=new En;t.hasMoreCharacters();){var n=t.getCurrentChar();this.encodeChar(n,r),t.pos++;var a=r.length();if(a>=4){t.writeCodewords(this.encodeToCodewords(r.toString()));var i=r.toString().substring(4);r.setLengthToZero(),r.append(i);var o=Id.lookAheadTest(t.getMessage(),t.pos,this.getEncodingMode());if(o!==this.getEncodingMode()){t.signalEncoderChange(ja);break}}}r.append(Gn.getCharAt(31)),this.handleEOD(t,r)},s.prototype.handleEOD=function(t,r){try{var n=r.length();if(n===0)return;if(n===1){t.updateSymbolInfo();var a=t.getSymbolInfo().getDataCapacity()-t.getCodewordCount(),i=t.getRemainingCharacters();if(i>a&&(t.updateSymbolInfo(t.getCodewordCount()+1),a=t.getSymbolInfo().getDataCapacity()-t.getCodewordCount()),i<=a&&a<=2)return}if(n>4)throw new Error("Count must not exceed 4");var o=n-1,l=this.encodeToCodewords(r.toString()),c=!t.hasMoreCharacters(),d=c&&o<=2;if(o<=2){t.updateSymbolInfo(t.getCodewordCount()+o);var a=t.getSymbolInfo().getDataCapacity()-t.getCodewordCount();a>=3&&(d=!1,t.updateSymbolInfo(t.getCodewordCount()+l.length))}d?(t.resetSymbolInfo(),t.pos-=o):t.writeCodewords(l)}finally{t.signalEncoderChange(ja)}},s.prototype.encodeChar=function(t,r){t>=32&&t<=63?r.append(t):t>=64&&t<=94?r.append(Gn.getCharAt(t-64)):Id.illegalCharacter(Gn.getCharAt(t))},s.prototype.encodeToCodewords=function(t){var r=t.length;if(r===0)throw new Error("StringBuilder must not be empty");var n=t.charAt(0).charCodeAt(0),a=r>=2?t.charAt(1).charCodeAt(0):0,i=r>=3?t.charAt(2).charCodeAt(0):0,o=r>=4?t.charAt(3).charCodeAt(0):0,l=(n<<18)+(a<<12)+(i<<6)+o,c=l>>16&255,d=l>>8&255,u=l&255,h=new En;return h.append(c),r>=2&&h.append(d),r>=3&&h.append(u),h.toString()},s}(),Zhe=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),eme=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},ia=function(){function s(t,r,n,a,i,o,l,c){l===void 0&&(l=0),c===void 0&&(c=0),this.rectangular=t,this.dataCapacity=r,this.errorCodewords=n,this.matrixWidth=a,this.matrixHeight=i,this.dataRegions=o,this.rsBlockData=l,this.rsBlockError=c}return s.lookup=function(t,r,n,a,i){var o,l;r===void 0&&(r=0),n===void 0&&(n=null),a===void 0&&(a=null),i===void 0&&(i=!0);try{for(var c=eme(sme),d=c.next();!d.done;d=c.next()){var u=d.value;if(!(r===1&&u.rectangular)&&!(r===2&&!u.rectangular)&&!(n!=null&&(u.getSymbolWidth()<n.getWidth()||u.getSymbolHeight()<n.getHeight()))&&!(a!=null&&(u.getSymbolWidth()>a.getWidth()||u.getSymbolHeight()>a.getHeight()))&&t<=u.dataCapacity)return u}}catch(h){o={error:h}}finally{try{d&&!d.done&&(l=c.return)&&l.call(c)}finally{if(o)throw o.error}}if(i)throw new Error("Can't find a symbol arrangement that matches the message. Data codewords: "+t);return null},s.prototype.getHorizontalDataRegions=function(){switch(this.dataRegions){case 1:return 1;case 2:case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},s.prototype.getVerticalDataRegions=function(){switch(this.dataRegions){case 1:case 2:return 1;case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},s.prototype.getSymbolDataWidth=function(){return this.getHorizontalDataRegions()*this.matrixWidth},s.prototype.getSymbolDataHeight=function(){return this.getVerticalDataRegions()*this.matrixHeight},s.prototype.getSymbolWidth=function(){return this.getSymbolDataWidth()+this.getHorizontalDataRegions()*2},s.prototype.getSymbolHeight=function(){return this.getSymbolDataHeight()+this.getVerticalDataRegions()*2},s.prototype.getCodewordCount=function(){return this.dataCapacity+this.errorCodewords},s.prototype.getInterleavedBlockCount=function(){return this.rsBlockData?this.dataCapacity/this.rsBlockData:1},s.prototype.getDataCapacity=function(){return this.dataCapacity},s.prototype.getErrorCodewords=function(){return this.errorCodewords},s.prototype.getDataLengthForInterleavedBlock=function(t){return this.rsBlockData},s.prototype.getErrorLengthForInterleavedBlock=function(t){return this.rsBlockError},s}(),tme=function(s){Zhe(t,s);function t(){return s.call(this,!1,1558,620,22,22,36,-1,62)||this}return t.prototype.getInterleavedBlockCount=function(){return 10},t.prototype.getDataLengthForInterleavedBlock=function(r){return r<=8?156:155},t}(ia),sme=[new ia(!1,3,5,8,8,1),new ia(!1,5,7,10,10,1),new ia(!0,5,7,16,6,1),new ia(!1,8,10,12,12,1),new ia(!0,10,11,14,6,2),new ia(!1,12,12,14,14,1),new ia(!0,16,14,24,10,1),new ia(!1,18,14,16,16,1),new ia(!1,22,18,18,18,1),new ia(!0,22,18,16,10,2),new ia(!1,30,20,20,20,1),new ia(!0,32,24,16,14,2),new ia(!1,36,24,22,22,1),new ia(!1,44,28,24,24,1),new ia(!0,49,28,22,14,2),new ia(!1,62,36,14,14,4),new ia(!1,86,42,16,16,4),new ia(!1,114,48,18,18,4),new ia(!1,144,56,20,20,4),new ia(!1,174,68,22,22,4),new ia(!1,204,84,24,24,4,102,42),new ia(!1,280,112,14,14,16,140,56),new ia(!1,368,144,16,16,16,92,36),new ia(!1,456,192,18,18,16,114,48),new ia(!1,576,224,20,20,16,144,56),new ia(!1,696,272,22,22,16,174,68),new ia(!1,816,336,24,24,16,136,56),new ia(!1,1050,408,18,18,36,175,68),new ia(!1,1304,496,20,20,36,163,62),new tme],rme=function(){function s(t){this.msg=t,this.pos=0,this.skipAtEnd=0;for(var r=t.split("").map(function(l){return l.charCodeAt(0)}),n=new En,a=0,i=r.length;a<i;a++){var o=String.fromCharCode(r[a]&255);if(o==="?"&&t.charAt(a)!=="?")throw new Error("Message contains characters outside ISO-8859-1 encoding.");n.append(o)}this.msg=n.toString(),this.shape=0,this.codewords=new En,this.newEncoding=-1}return s.prototype.setSymbolShape=function(t){this.shape=t},s.prototype.setSizeConstraints=function(t,r){this.minSize=t,this.maxSize=r},s.prototype.getMessage=function(){return this.msg},s.prototype.setSkipAtEnd=function(t){this.skipAtEnd=t},s.prototype.getCurrentChar=function(){return this.msg.charCodeAt(this.pos)},s.prototype.getCurrent=function(){return this.msg.charCodeAt(this.pos)},s.prototype.getCodewords=function(){return this.codewords},s.prototype.writeCodewords=function(t){this.codewords.append(t)},s.prototype.writeCodeword=function(t){this.codewords.append(t)},s.prototype.getCodewordCount=function(){return this.codewords.length()},s.prototype.getNewEncoding=function(){return this.newEncoding},s.prototype.signalEncoderChange=function(t){this.newEncoding=t},s.prototype.resetEncoderSignal=function(){this.newEncoding=-1},s.prototype.hasMoreCharacters=function(){return this.pos<this.getTotalMessageCharCount()},s.prototype.getTotalMessageCharCount=function(){return this.msg.length-this.skipAtEnd},s.prototype.getRemainingCharacters=function(){return this.getTotalMessageCharCount()-this.pos},s.prototype.getSymbolInfo=function(){return this.symbolInfo},s.prototype.updateSymbolInfo=function(t){t===void 0&&(t=this.getCodewordCount()),(this.symbolInfo==null||t>this.symbolInfo.getDataCapacity())&&(this.symbolInfo=ia.lookup(t,this.shape,this.minSize,this.maxSize,!0))},s.prototype.resetSymbolInfo=function(){this.symbolInfo=null},s}(),nme=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ame=function(s){nme(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.getEncodingMode=function(){return xo},t.prototype.encode=function(r){for(var n=new En;r.hasMoreCharacters();){var a=r.getCurrentChar();r.pos++,this.encodeChar(a,n);var i=n.length();if(i%3===0){this.writeNextTriplet(r,n);var o=Id.lookAheadTest(r.getMessage(),r.pos,this.getEncodingMode());if(o!==this.getEncodingMode()){r.signalEncoderChange(ja);break}}}this.handleEOD(r,n)},t.prototype.encodeChar=function(r,n){switch(r){case 13:n.append(0);break;case 42:n.append(1);break;case 62:n.append(2);break;case 32:n.append(3);break;default:r>=48&&r<=57?n.append(r-48+4):r>=65&&r<=90?n.append(r-65+14):Id.illegalCharacter(Gn.getCharAt(r));break}return 1},t.prototype.handleEOD=function(r,n){r.updateSymbolInfo();var a=r.getSymbolInfo().getDataCapacity()-r.getCodewordCount(),i=n.length();r.pos-=i,(r.getRemainingCharacters()>1||a>1||r.getRemainingCharacters()!==a)&&r.writeCodeword(Yhe),r.getNewEncoding()<0&&r.signalEncoderChange(ja)},t}(I3),ime=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),ome=function(s){ime(t,s);function t(){return s!==null&&s.apply(this,arguments)||this}return t.prototype.getEncodingMode=function(){return Sl},t.prototype.encodeChar=function(r,n){if(r===32)return n.append(3),1;if(r>=48&&r<=57)return n.append(r-48+4),1;if(r>=97&&r<=122)return n.append(r-97+14),1;if(r<32)return n.append(0),n.append(r),2;if(r<=47)return n.append(1),n.append(r-33),2;if(r<=64)return n.append(1),n.append(r-58+15),2;if(r>=91&&r<=95)return n.append(1),n.append(r-91+22),2;if(r===96)return n.append(2),n.append(0),2;if(r<=90)return n.append(2),n.append(r-65+1),2;if(r<=127)return n.append(2),n.append(r-123+27),2;n.append("1");var a=2;return a+=this.encodeChar(r-128,n),a},t}(I3),Id=function(){function s(){}return s.randomize253State=function(t){var r=149*t%253+1,n=qk+r;return n<=254?n:n-254},s.encodeHighLevel=function(t,r,n,a,i){r===void 0&&(r=0),n===void 0&&(n=null),a===void 0&&(a=null),i===void 0&&(i=!1);var o=new I3,l=[new Jhe,o,new ome,new ame,new Qhe,new Xhe],c=new rme(t);c.setSymbolShape(r),c.setSizeConstraints(n,a),t.startsWith(Vk)&&t.endsWith(Hk)?(c.writeCodeword(Vhe),c.setSkipAtEnd(2),c.pos+=Vk.length):t.startsWith(Wk)&&t.endsWith(Hk)&&(c.writeCodeword(Whe),c.setSkipAtEnd(2),c.pos+=Wk.length);var d=ja;for(i&&(o.encodeMaximal(c),d=c.getNewEncoding(),c.resetEncoderSignal());c.hasMoreCharacters();)l[d].encode(c),c.getNewEncoding()>=0&&(d=c.getNewEncoding(),c.resetEncoderSignal());var u=c.getCodewordCount();c.updateSymbolInfo();var h=c.getSymbolInfo().getDataCapacity();u<h&&d!==ja&&d!==ol&&d!==Do&&c.writeCodeword("");var f=c.getCodewords();for(f.length()<h&&f.append(qk);f.length()<h;)f.append(this.randomize253State(f.length()+1));return c.getCodewords().toString()},s.lookAheadTest=function(t,r,n){var a=this.lookAheadTestIntern(t,r,n);if(n===xo&&a===xo){for(var i=Math.min(r+3,t.length),o=r;o<i;o++)if(!this.isNativeX12(t.charCodeAt(o)))return ja}else if(n===Do&&a===Do){for(var i=Math.min(r+4,t.length),o=r;o<i;o++)if(!this.isNativeEDIFACT(t.charCodeAt(o)))return ja}return a},s.lookAheadTestIntern=function(t,r,n){if(r>=t.length)return n;var a;n===ja?a=[0,1,1,1,1,1.25]:(a=[1,2,2,2,2,2.25],a[n]=0);for(var i=0,o=new Uint8Array(6),l=[];;){if(r+i===t.length){So.fill(o,0),So.fill(l,0);var c=this.findMinimums(a,l,_n.MAX_VALUE,o),d=this.getMinimumCount(o);if(l[ja]===c)return ja;if(d===1){if(o[ol]>0)return ol;if(o[Do]>0)return Do;if(o[Sl]>0)return Sl;if(o[xo]>0)return xo}return Yo}var u=t.charCodeAt(r+i);if(i++,this.isDigit(u)?a[ja]+=.5:this.isExtendedASCII(u)?(a[ja]=Math.ceil(a[ja]),a[ja]+=2):(a[ja]=Math.ceil(a[ja]),a[ja]++),this.isNativeC40(u)?a[Yo]+=2/3:this.isExtendedASCII(u)?a[Yo]+=8/3:a[Yo]+=4/3,this.isNativeText(u)?a[Sl]+=2/3:this.isExtendedASCII(u)?a[Sl]+=8/3:a[Sl]+=4/3,this.isNativeX12(u)?a[xo]+=2/3:this.isExtendedASCII(u)?a[xo]+=13/3:a[xo]+=10/3,this.isNativeEDIFACT(u)?a[Do]+=3/4:this.isExtendedASCII(u)?a[Do]+=17/4:a[Do]+=13/4,this.isSpecialB256(u)?a[ol]+=4:a[ol]++,i>=4){if(So.fill(o,0),So.fill(l,0),this.findMinimums(a,l,_n.MAX_VALUE,o),l[ja]<this.min(l[ol],l[Yo],l[Sl],l[xo],l[Do]))return ja;if(l[ol]<l[ja]||l[ol]+1<this.min(l[Yo],l[Sl],l[xo],l[Do]))return ol;if(l[Do]+1<this.min(l[ol],l[Yo],l[Sl],l[xo],l[ja]))return Do;if(l[Sl]+1<this.min(l[ol],l[Yo],l[Do],l[xo],l[ja]))return Sl;if(l[xo]+1<this.min(l[ol],l[Yo],l[Do],l[Sl],l[ja]))return xo;if(l[Yo]+1<this.min(l[ja],l[ol],l[Do],l[Sl])){if(l[Yo]<l[xo])return Yo;if(l[Yo]===l[xo]){for(var h=r+i+1;h<t.length;){var f=t.charCodeAt(h);if(this.isX12TermSep(f))return xo;if(!this.isNativeX12(f))break;h++}return Yo}}}}},s.min=function(t,r,n,a,i){var o=Math.min(t,Math.min(r,Math.min(n,a)));return i===void 0?o:Math.min(o,i)},s.findMinimums=function(t,r,n,a){for(var i=0;i<6;i++){var o=r[i]=Math.ceil(t[i]);n>o&&(n=o,So.fill(a,0)),n===o&&(a[i]=a[i]+1)}return n},s.getMinimumCount=function(t){for(var r=0,n=0;n<6;n++)r+=t[n];return r||0},s.isDigit=function(t){return t>=48&&t<=57},s.isExtendedASCII=function(t){return t>=128&&t<=255},s.isNativeC40=function(t){return t===32||t>=48&&t<=57||t>=65&&t<=90},s.isNativeText=function(t){return t===32||t>=48&&t<=57||t>=97&&t<=122},s.isNativeX12=function(t){return this.isX12TermSep(t)||t===32||t>=48&&t<=57||t>=65&&t<=90},s.isX12TermSep=function(t){return t===13||t===42||t===62},s.isNativeEDIFACT=function(t){return t>=32&&t<=94},s.isSpecialB256=function(t){return!1},s.determineConsecutiveDigitCount=function(t,r){r===void 0&&(r=0);for(var n=t.length,a=r;a<n&&this.isDigit(t.charCodeAt(a));)a++;return a-r},s.illegalCharacter=function(t){var r=_n.toHexString(t.charCodeAt(0));throw r="0000".substring(0,4-r.length)+r,new Error("Illegal character: "+t+" (0x"+r+")")},s}(),sS=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Gk=function(){function s(t){this.charset=t,this.name=t.name}return s.prototype.canEncode=function(t){try{return td.encode(t,this.charset)!=null}catch{return!1}},s}(),lme=function(){function s(t,r,n){var a,i,o,l,c,d;this.ENCODERS=["IBM437","ISO-8859-2","ISO-8859-3","ISO-8859-4","ISO-8859-5","ISO-8859-6","ISO-8859-7","ISO-8859-8","ISO-8859-9","ISO-8859-10","ISO-8859-11","ISO-8859-13","ISO-8859-14","ISO-8859-15","ISO-8859-16","windows-1250","windows-1251","windows-1252","windows-1256","Shift_JIS"].map(function(k){return new Gk(Lhe.forName(k))}),this.encoders=[];var u=[];u.push(new Gk($he.ISO_8859_1));for(var h=r!=null&&r.name.startsWith("UTF"),f=0;f<t.length;f++){var m=!1;try{for(var p=(a=void 0,sS(u)),g=p.next();!g.done;g=p.next()){var v=g.value,y=t.charAt(f),j=y.charCodeAt(0);if(j===n||v.canEncode(y)){m=!0;break}}}catch(k){a={error:k}}finally{try{g&&!g.done&&(i=p.return)&&i.call(p)}finally{if(a)throw a.error}}if(!m)try{for(var b=(o=void 0,sS(this.ENCODERS)),w=b.next();!w.done;w=b.next()){var v=w.value;if(v.canEncode(t.charAt(f))){u.push(v),m=!0;break}}}catch(k){o={error:k}}finally{try{w&&!w.done&&(l=b.return)&&l.call(b)}finally{if(o)throw o.error}}m||(h=!0)}if(u.length===1&&!h)this.encoders=[u[0]];else{this.encoders=[];var N=0;try{for(var C=sS(u),S=C.next();!S.done;S=C.next()){var v=S.value;this.encoders[N++]=v}}catch(k){c={error:k}}finally{try{S&&!S.done&&(d=C.return)&&d.call(C)}finally{if(c)throw c.error}}}var _=-1;if(r!=null){for(var f=0;f<this.encoders.length;f++)if(this.encoders[f]!=null&&r.name===this.encoders[f].name){_=f;break}}this.priorityEncoderIndex=_}return s.prototype.length=function(){return this.encoders.length},s.prototype.getCharsetName=function(t){if(!(t<this.length()))throw new Error("index must be less than length");return this.encoders[t].name},s.prototype.getCharset=function(t){if(!(t<this.length()))throw new Error("index must be less than length");return this.encoders[t].charset},s.prototype.getECIValue=function(t){return this.encoders[t].charset.getValueIdentifier()},s.prototype.getPriorityEncoderIndex=function(){return this.priorityEncoderIndex},s.prototype.canEncode=function(t,r){if(!(r<this.length()))throw new Error("index must be less than length");return!0},s.prototype.encode=function(t,r){if(!(r<this.length()))throw new Error("index must be less than length");return td.encode(Gn.getCharAt(t),this.encoders[r].name)},s}(),cme=3,dme=function(){function s(t,r,n){this.fnc1=n;var a=new lme(t,r,n);if(a.length()===1)for(var i=0;i<this.bytes.length;i++){var o=t.charAt(i).charCodeAt(0);this.bytes[i]=o===n?1e3:o}else this.bytes=this.encodeMinimally(t,a,n)}return s.prototype.getFNC1Character=function(){return this.fnc1},s.prototype.length=function(){return this.bytes.length},s.prototype.haveNCharacters=function(t,r){if(t+r-1>=this.bytes.length)return!1;for(var n=0;n<r;n++)if(this.isECI(t+n))return!1;return!0},s.prototype.charAt=function(t){if(t<0||t>=this.length())throw new Error(""+t);if(this.isECI(t))throw new Error("value at "+t+" is not a character but an ECI");return this.isFNC1(t)?this.fnc1:this.bytes[t]},s.prototype.subSequence=function(t,r){if(t<0||t>r||r>this.length())throw new Error(""+t);for(var n=new En,a=t;a<r;a++){if(this.isECI(a))throw new Error("value at "+a+" is not a character but an ECI");n.append(this.charAt(a))}return n.toString()},s.prototype.isECI=function(t){if(t<0||t>=this.length())throw new Error(""+t);return this.bytes[t]>255&&this.bytes[t]<=999},s.prototype.isFNC1=function(t){if(t<0||t>=this.length())throw new Error(""+t);return this.bytes[t]===1e3},s.prototype.getECIValue=function(t){if(t<0||t>=this.length())throw new Error(""+t);if(!this.isECI(t))throw new Error("value at "+t+" is not an ECI but a character");return this.bytes[t]-256},s.prototype.addEdge=function(t,r,n){(t[r][n.encoderIndex]==null||t[r][n.encoderIndex].cachedTotalSize>n.cachedTotalSize)&&(t[r][n.encoderIndex]=n)},s.prototype.addEdges=function(t,r,n,a,i,o){var l=t.charAt(a).charCodeAt(0),c=0,d=r.length();r.getPriorityEncoderIndex()>=0&&(l===o||r.canEncode(l,r.getPriorityEncoderIndex()))&&(c=r.getPriorityEncoderIndex(),d=c+1);for(var u=c;u<d;u++)(l===o||r.canEncode(l,u))&&this.addEdge(n,a+1,new Kk(l,r,u,i,o))},s.prototype.encodeMinimally=function(t,r,n){var a=t.length,i=new Kk[a+1][r.length()];this.addEdges(t,r,i,0,null,n);for(var o=1;o<=a;o++){for(var l=0;l<r.length();l++)i[o][l]!=null&&o<a&&this.addEdges(t,r,i,o,i[o][l],n);for(var l=0;l<r.length();l++)i[o-1][l]=null}for(var c=-1,d=_n.MAX_VALUE,l=0;l<r.length();l++)if(i[a][l]!=null){var u=i[a][l];u.cachedTotalSize<d&&(d=u.cachedTotalSize,c=l)}if(c<0)throw new Error('Failed to encode "'+t+'"');for(var h=[],f=i[a][c];f!=null;){if(f.isFNC1())h.unshift(1e3);else for(var m=r.encode(f.c,f.encoderIndex),o=m.length-1;o>=0;o--)h.unshift(m[o]&255);var p=f.previous===null?0:f.previous.encoderIndex;p!==f.encoderIndex&&h.unshift(256+r.getECIValue(f.encoderIndex)),f=f.previous}for(var g=[],o=0;o<g.length;o++)g[o]=h[o];return g},s}(),Kk=function(){function s(t,r,n,a,i){this.c=t,this.encoderSet=r,this.encoderIndex=n,this.previous=a,this.fnc1=i,this.c=t===i?1e3:t;var o=this.isFNC1()?1:r.encode(t,n).length,l=a===null?0:a.encoderIndex;l!==n&&(o+=cme),a!=null&&(o+=a.cachedTotalSize),this.cachedTotalSize=o}return s.prototype.isFNC1=function(){return this.c===1e3},s}(),ume=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var Yk;(function(s){s[s.ASCII=0]="ASCII",s[s.C40=1]="C40",s[s.TEXT=2]="TEXT",s[s.X12=3]="X12",s[s.EDF=4]="EDF",s[s.B256=5]="B256"})(Yk||(Yk={}));(function(s){ume(t,s);function t(r,n,a,i,o){var l=s.call(this,r,n,a)||this;return l.shape=i,l.macroId=o,l}return t.prototype.getMacroId=function(){return this.macroId},t.prototype.getShapeHint=function(){return this.shape},t})(dme);var hme=function(){function s(){}return s.prototype.isCompact=function(){return this.compact},s.prototype.setCompact=function(t){this.compact=t},s.prototype.getSize=function(){return this.size},s.prototype.setSize=function(t){this.size=t},s.prototype.getLayers=function(){return this.layers},s.prototype.setLayers=function(t){this.layers=t},s.prototype.getCodeWords=function(){return this.codeWords},s.prototype.setCodeWords=function(t){this.codeWords=t},s.prototype.getMatrix=function(){return this.matrix},s.prototype.setMatrix=function(t){this.matrix=t},s}(),Jk=function(){function s(){}return s.singletonList=function(t){return[t]},s.min=function(t,r){return t.sort(r)[0]},s}(),mme=function(){function s(t){this.previous=t}return s.prototype.getPrevious=function(){return this.previous},s}(),fme=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),P3=function(s){fme(t,s);function t(r,n,a){var i=s.call(this,r)||this;return i.value=n,i.bitCount=a,i}return t.prototype.appendTo=function(r,n){r.appendBits(this.value,this.bitCount)},t.prototype.add=function(r,n){return new t(this,r,n)},t.prototype.addBinaryShift=function(r,n){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new t(this,r,n)},t.prototype.toString=function(){var r=this.value&(1<<this.bitCount)-1;return r|=1<<this.bitCount,"<"+_n.toBinaryString(r|1<<this.bitCount).substring(1)+">"},t}(mme),xme=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},s(t,r)};return function(t,r){s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),pme=function(s){xme(t,s);function t(r,n,a){var i=s.call(this,r,0,0)||this;return i.binaryShiftStart=n,i.binaryShiftByteCount=a,i}return t.prototype.appendTo=function(r,n){for(var a=0;a<this.binaryShiftByteCount;a++)(a===0||a===31&&this.binaryShiftByteCount<=62)&&(r.appendBits(31,5),this.binaryShiftByteCount>62?r.appendBits(this.binaryShiftByteCount-31,16):a===0?r.appendBits(Math.min(this.binaryShiftByteCount,31),5):r.appendBits(this.binaryShiftByteCount-31,5)),r.appendBits(n[this.binaryShiftStart+a],8)},t.prototype.addBinaryShift=function(r,n){return new t(this,r,n)},t.prototype.toString=function(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"},t}(P3);function gme(s,t,r){return new pme(s,t,r)}function o0(s,t,r){return new P3(s,t,r)}var vme=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Pm=0,k1=1,Zc=2,V9=3,iu=4,yme=new P3(null,0,0),rS=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])],jme=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function bme(s){var t,r;try{for(var n=jme(s),a=n.next();!a.done;a=n.next()){var i=a.value;So.fill(i,-1)}}catch(o){t={error:o}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return s[Pm][iu]=0,s[k1][iu]=0,s[k1][Pm]=28,s[V9][iu]=0,s[Zc][iu]=0,s[Zc][Pm]=15,s}var W9=bme(So.createInt32Array(6,6)),Nme=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},wme=function(){function s(t,r,n,a){this.token=t,this.mode=r,this.binaryShiftByteCount=n,this.bitCount=a}return s.prototype.getMode=function(){return this.mode},s.prototype.getToken=function(){return this.token},s.prototype.getBinaryShiftByteCount=function(){return this.binaryShiftByteCount},s.prototype.getBitCount=function(){return this.bitCount},s.prototype.latchAndAppend=function(t,r){var n=this.bitCount,a=this.token;if(t!==this.mode){var i=rS[this.mode][t];a=o0(a,i&65535,i>>16),n+=i>>16}var o=t===Zc?4:5;return a=o0(a,r,o),new s(a,t,0,n+o)},s.prototype.shiftAndAppend=function(t,r){var n=this.token,a=this.mode===Zc?4:5;return n=o0(n,W9[this.mode][t],a),n=o0(n,r,5),new s(n,this.mode,0,this.bitCount+a+5)},s.prototype.addBinaryShiftChar=function(t){var r=this.token,n=this.mode,a=this.bitCount;if(this.mode===iu||this.mode===Zc){var i=rS[n][Pm];r=o0(r,i&65535,i>>16),a+=i>>16,n=Pm}var o=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,l=new s(r,n,this.binaryShiftByteCount+1,a+o);return l.binaryShiftByteCount===2078&&(l=l.endBinaryShift(t+1)),l},s.prototype.endBinaryShift=function(t){if(this.binaryShiftByteCount===0)return this;var r=this.token;return r=gme(r,t-this.binaryShiftByteCount,this.binaryShiftByteCount),new s(r,this.mode,0,this.bitCount)},s.prototype.isBetterThanOrEqualTo=function(t){var r=this.bitCount+(rS[this.mode][t.mode]>>16);return this.binaryShiftByteCount<t.binaryShiftByteCount?r+=s.calculateBinaryShiftCost(t)-s.calculateBinaryShiftCost(this):this.binaryShiftByteCount>t.binaryShiftByteCount&&t.binaryShiftByteCount>0&&(r+=10),r<=t.bitCount},s.prototype.toBitArray=function(t){for(var r,n,a=[],i=this.endBinaryShift(t.length).token;i!==null;i=i.getPrevious())a.unshift(i);var o=new Bo;try{for(var l=Nme(a),c=l.next();!c.done;c=l.next()){var d=c.value;d.appendTo(o,t)}}catch(u){r={error:u}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return o},s.prototype.toString=function(){return Gn.format("%s bits=%d bytes=%d",vme[this.mode],this.bitCount,this.binaryShiftByteCount)},s.calculateBinaryShiftCost=function(t){return t.binaryShiftByteCount>62?21:t.binaryShiftByteCount>31?20:t.binaryShiftByteCount>0?10:0},s.INITIAL_STATE=new s(yme,Pm,0,0),s}();function Sme(s){var t=Gn.getCharCode(" "),r=Gn.getCharCode("."),n=Gn.getCharCode(",");s[Pm][t]=1;for(var a=Gn.getCharCode("Z"),i=Gn.getCharCode("A"),o=i;o<=a;o++)s[Pm][o]=o-i+2;s[k1][t]=1;for(var l=Gn.getCharCode("z"),c=Gn.getCharCode("a"),o=c;o<=l;o++)s[k1][o]=o-c+2;s[Zc][t]=1;for(var d=Gn.getCharCode("9"),u=Gn.getCharCode("0"),o=u;o<=d;o++)s[Zc][o]=o-u+2;s[Zc][n]=12,s[Zc][r]=13;for(var h=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""],f=0;f<h.length;f++)s[V9][Gn.getCharCode(h[f])]=f;for(var m=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"],f=0;f<m.length;f++)Gn.getCharCode(m[f])>0&&(s[iu][Gn.getCharCode(m[f])]=f);return s}var nS=Sme(So.createInt32Array(5,256)),pj=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Cme=function(){function s(t){this.text=t}return s.prototype.encode=function(){for(var t=Gn.getCharCode(" "),r=Gn.getCharCode(`
`),n=Jk.singletonList(wme.INITIAL_STATE),a=0;a<this.text.length;a++){var i=void 0,o=a+1<this.text.length?this.text[a+1]:0;switch(this.text[a]){case Gn.getCharCode("\r"):i=o===r?2:0;break;case Gn.getCharCode("."):i=o===t?3:0;break;case Gn.getCharCode(","):i=o===t?4:0;break;case Gn.getCharCode(":"):i=o===t?5:0;break;default:i=0}i>0?(n=s.updateStateListForPair(n,a,i),a++):n=this.updateStateListForChar(n,a)}var l=Jk.min(n,function(c,d){return c.getBitCount()-d.getBitCount()});return l.toBitArray(this.text)},s.prototype.updateStateListForChar=function(t,r){var n,a,i=[];try{for(var o=pj(t),l=o.next();!l.done;l=o.next()){var c=l.value;this.updateStateForChar(c,r,i)}}catch(d){n={error:d}}finally{try{l&&!l.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}return s.simplifyStates(i)},s.prototype.updateStateForChar=function(t,r,n){for(var a=this.text[r]&255,i=nS[t.getMode()][a]>0,o=null,l=0;l<=iu;l++){var c=nS[l][a];if(c>0){if(o==null&&(o=t.endBinaryShift(r)),!i||l===t.getMode()||l===Zc){var d=o.latchAndAppend(l,c);n.push(d)}if(!i&&W9[t.getMode()][l]>=0){var u=o.shiftAndAppend(l,c);n.push(u)}}}if(t.getBinaryShiftByteCount()>0||nS[t.getMode()][a]===0){var h=t.addBinaryShiftChar(r);n.push(h)}},s.updateStateListForPair=function(t,r,n){var a,i,o=[];try{for(var l=pj(t),c=l.next();!c.done;c=l.next()){var d=c.value;this.updateStateForPair(d,r,n,o)}}catch(u){a={error:u}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(a)throw a.error}}return this.simplifyStates(o)},s.updateStateForPair=function(t,r,n,a){var i=t.endBinaryShift(r);if(a.push(i.latchAndAppend(iu,n)),t.getMode()!==iu&&a.push(i.shiftAndAppend(iu,n)),n===3||n===4){var o=i.latchAndAppend(Zc,16-n).latchAndAppend(Zc,1);a.push(o)}if(t.getBinaryShiftByteCount()>0){var l=t.addBinaryShiftChar(r).addBinaryShiftChar(r+1);a.push(l)}},s.simplifyStates=function(t){var r,n,a,i,o=[];try{for(var l=pj(t),c=l.next();!c.done;c=l.next()){var d=c.value,u=!0,h=function(v){if(v.isBetterThanOrEqualTo(d))return u=!1,"break";d.isBetterThanOrEqualTo(v)&&(o=o.filter(function(y){return y!==v}))};try{for(var f=(a=void 0,pj(o)),m=f.next();!m.done;m=f.next()){var p=m.value,g=h(p);if(g==="break")break}}catch(v){a={error:v}}finally{try{m&&!m.done&&(i=f.return)&&i.call(f)}finally{if(a)throw a.error}}u&&o.push(d)}}catch(v){r={error:v}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}return o},s}(),Ame=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(){function s(){}return s.encodeBytes=function(t){return s.encode(t,s.DEFAULT_EC_PERCENT,s.DEFAULT_AZTEC_LAYERS)},s.encode=function(t,r,n){var a=new Cme(t).encode(),i=_n.truncDivision(a.getSize()*r,100)+11,o=a.getSize()+i,l,c,d,u,h;if(n!==s.DEFAULT_AZTEC_LAYERS){if(l=n<0,c=Math.abs(n),c>(l?s.MAX_NB_BITS_COMPACT:s.MAX_NB_BITS))throw new Or(Gn.format("Illegal value %s for layers",n));d=s.totalBitsInLayer(c,l),u=s.WORD_SIZE[c];var f=d-d%u;if(h=s.stuffBits(a,u),h.getSize()+i>f)throw new Or("Data to large for user specified layer");if(l&&h.getSize()>u*64)throw new Or("Data to large for user specified layer")}else{u=0,h=null;for(var m=0;;m++){if(m>s.MAX_NB_BITS)throw new Or("Data too large for an Aztec code");if(l=m<=3,c=l?m+1:m,d=s.totalBitsInLayer(c,l),!(o>d)){(h==null||u!==s.WORD_SIZE[c])&&(u=s.WORD_SIZE[c],h=s.stuffBits(a,u));var f=d-d%u;if(!(l&&h.getSize()>u*64)&&h.getSize()+i<=f)break}}}var p=s.generateCheckWords(h,d,u),g=h.getSize()/u,v=s.generateModeMessage(l,c,g),y=(l?11:14)+c*4,j=new Int32Array(y),b;if(l){b=y;for(var m=0;m<j.length;m++)j[m]=m}else{b=y+1+2*_n.truncDivision(_n.truncDivision(y,2)-1,15);for(var w=_n.truncDivision(y,2),N=_n.truncDivision(b,2),m=0;m<w;m++){var C=m+_n.truncDivision(m,15);j[w-m-1]=N-C-1,j[w+m]=N+C+1}}for(var S=new fu(b),m=0,_=0;m<c;m++){for(var k=(c-m)*4+(l?9:12),F=0;F<k;F++)for(var A=F*2,T=0;T<2;T++)p.get(_+A+T)&&S.set(j[m*2+T],j[m*2+F]),p.get(_+k*2+A+T)&&S.set(j[m*2+F],j[y-1-m*2-T]),p.get(_+k*4+A+T)&&S.set(j[y-1-m*2-T],j[y-1-m*2-F]),p.get(_+k*6+A+T)&&S.set(j[y-1-m*2-F],j[m*2+T]);_+=k*8}if(s.drawModeMessage(S,l,b,v),l)s.drawBullsEye(S,_n.truncDivision(b,2),5);else{s.drawBullsEye(S,_n.truncDivision(b,2),7);for(var m=0,F=0;m<_n.truncDivision(y,2)-1;m+=15,F+=16)for(var T=_n.truncDivision(b,2)&1;T<b;T+=2)S.set(_n.truncDivision(b,2)-F,T),S.set(_n.truncDivision(b,2)+F,T),S.set(T,_n.truncDivision(b,2)-F),S.set(T,_n.truncDivision(b,2)+F)}var V=new hme;return V.setCompact(l),V.setSize(b),V.setLayers(c),V.setCodeWords(g),V.setMatrix(S),V},s.drawBullsEye=function(t,r,n){for(var a=0;a<n;a+=2)for(var i=r-a;i<=r+a;i++)t.set(i,r-a),t.set(i,r+a),t.set(r-a,i),t.set(r+a,i);t.set(r-n,r-n),t.set(r-n+1,r-n),t.set(r-n,r-n+1),t.set(r+n,r-n),t.set(r+n,r-n+1),t.set(r+n,r+n-1)},s.generateModeMessage=function(t,r,n){var a=new Bo;return t?(a.appendBits(r-1,2),a.appendBits(n-1,6),a=s.generateCheckWords(a,28,4)):(a.appendBits(r-1,5),a.appendBits(n-1,11),a=s.generateCheckWords(a,40,4)),a},s.drawModeMessage=function(t,r,n,a){var i=_n.truncDivision(n,2);if(r)for(var o=0;o<7;o++){var l=i-3+o;a.get(o)&&t.set(l,i-5),a.get(o+7)&&t.set(i+5,l),a.get(20-o)&&t.set(l,i+5),a.get(27-o)&&t.set(i-5,l)}else for(var o=0;o<10;o++){var l=i-5+o+_n.truncDivision(o,5);a.get(o)&&t.set(l,i-7),a.get(o+10)&&t.set(i+7,l),a.get(29-o)&&t.set(l,i+7),a.get(39-o)&&t.set(i-7,l)}},s.generateCheckWords=function(t,r,n){var a,i,o=t.getSize()/n,l=new z9(s.getGF(n)),c=_n.truncDivision(r,n),d=s.bitsToWords(t,n,c);l.encode(d,c-o);var u=r%n,h=new Bo;h.appendBits(0,u);try{for(var f=Ame(Array.from(d)),m=f.next();!m.done;m=f.next()){var p=m.value;h.appendBits(p,n)}}catch(g){a={error:g}}finally{try{m&&!m.done&&(i=f.return)&&i.call(f)}finally{if(a)throw a.error}}return h},s.bitsToWords=function(t,r,n){var a=new Int32Array(n),i,o;for(i=0,o=t.getSize()/r;i<o;i++){for(var l=0,c=0;c<r;c++)l|=t.get(i*r+c)?1<<r-c-1:0;a[i]=l}return a},s.getGF=function(t){switch(t){case 4:return ec.AZTEC_PARAM;case 6:return ec.AZTEC_DATA_6;case 8:return ec.AZTEC_DATA_8;case 10:return ec.AZTEC_DATA_10;case 12:return ec.AZTEC_DATA_12;default:throw new Or("Unsupported word size "+t)}},s.stuffBits=function(t,r){for(var n=new Bo,a=t.getSize(),i=(1<<r)-2,o=0;o<a;o+=r){for(var l=0,c=0;c<r;c++)(o+c>=a||t.get(o+c))&&(l|=1<<r-1-c);(l&i)===i?(n.appendBits(l&i,r),o--):l&i?n.appendBits(l,r):(n.appendBits(l|1,r),o--)}return n},s.totalBitsInLayer=function(t,r){return((r?88:112)+16*t)*t},s.DEFAULT_EC_PERCENT=33,s.DEFAULT_AZTEC_LAYERS=0,s.MAX_NB_BITS=32,s.MAX_NB_BITS_COMPACT=4,s.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]),s})();var Eme=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},s(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ime=function(s){Eme(t,s);function t(r){var n=s.call(this,r.width,r.height)||this;return n.canvas=r,n.tempCanvasElement=null,n.buffer=t.makeBufferFromCanvasImageData(r),n}return t.makeBufferFromCanvasImageData=function(r){var n;try{n=r.getContext("2d",{willReadFrequently:!0})}catch{n=r.getContext("2d")}if(!n)throw new Error("Couldn't get canvas context.");var a=n.getImageData(0,0,r.width,r.height);return t.toGrayscaleBuffer(a.data,r.width,r.height)},t.toGrayscaleBuffer=function(r,n,a){for(var i=new Uint8ClampedArray(n*a),o=0,l=0,c=r.length;o<c;o+=4,l++){var d=void 0,u=r[o+3];if(u===0)d=255;else{var h=r[o],f=r[o+1],m=r[o+2];d=306*h+601*f+117*m+512>>10}i[l]=d}return i},t.prototype.getRow=function(r,n){if(r<0||r>=this.getHeight())throw new Or("Requested row is outside the image: "+r);var a=this.getWidth(),i=r*a;return n===null?n=this.buffer.slice(i,i+a):(n.length<a&&(n=new Uint8ClampedArray(a)),n.set(this.buffer.slice(i,i+a))),n},t.prototype.getMatrix=function(){return this.buffer},t.prototype.isCropSupported=function(){return!0},t.prototype.crop=function(r,n,a,i){return s.prototype.crop.call(this,r,n,a,i),this},t.prototype.isRotateSupported=function(){return!0},t.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},t.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},t.prototype.invert=function(){return new bN(this)},t.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var r=this.canvas.ownerDocument.createElement("canvas");r.width=this.canvas.width,r.height=this.canvas.height,this.tempCanvasElement=r}return this.tempCanvasElement},t.prototype.rotate=function(r){var n=this.getTempCanvasElement();if(!n)throw new Error("Could not create a Canvas element.");var a=r*t.DEGREE_TO_RADIANS,i=this.canvas.width,o=this.canvas.height,l=Math.ceil(Math.abs(Math.cos(a))*i+Math.abs(Math.sin(a))*o),c=Math.ceil(Math.abs(Math.sin(a))*i+Math.abs(Math.cos(a))*o);n.width=l,n.height=c;var d=n.getContext("2d");if(!d)throw new Error("Could not create a Canvas Context element.");return d.translate(l/2,c/2),d.rotate(a),d.drawImage(this.canvas,i/-2,o/-2),this.buffer=t.makeBufferFromCanvasImageData(n),this},t.DEGREE_TO_RADIANS=Math.PI/180,t}(uy);function H9(){return typeof navigator<"u"}function Pme(){return H9()&&!!navigator.mediaDevices}function _me(){return!!(Pme()&&navigator.mediaDevices.enumerateDevices)}var Gx=function(){return Gx=Object.assign||function(s){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(s[a]=t[a])}return s},Gx.apply(this,arguments)},yi=function(s,t,r,n){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{d(n.next(u))}catch(h){o(h)}}function c(u){try{d(n.throw(u))}catch(h){o(h)}}function d(u){u.done?i(u.value):a(u.value).then(l,c)}d((n=n.apply(s,t||[])).next())})},ji=function(s,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(d){return function(u){return c([d,u])}}function c(d){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,a&&(i=d[0]&2?a.return:d[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,d[1])).done)return i;switch(a=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,a=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){r.label=d[1];break}if(d[0]===6&&r.label<i[1]){r.label=i[1],i=d;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(d);break}i[2]&&r.ops.pop(),r.trys.pop();continue}d=t.call(s,r)}catch(u){d=[6,u],a=0}finally{n=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}},aS=function(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},kme={delayBetweenScanAttempts:500,delayBetweenScanSuccess:500,tryPlayVideoTimeout:5e3},Cg=function(){function s(t,r,n){r===void 0&&(r=new Map),n===void 0&&(n={}),this.reader=t,this.hints=r,this.options=Gx(Gx({},kme),n)}return Object.defineProperty(s.prototype,"possibleFormats",{set:function(t){this.hints.set(ti.POSSIBLE_FORMATS,t)},enumerable:!1,configurable:!0}),s.addVideoSource=function(t,r){try{t.srcObject=r}catch{console.error("got interrupted by new loading request")}},s.mediaStreamSetTorch=function(t,r){return yi(this,void 0,void 0,function(){return ji(this,function(n){switch(n.label){case 0:return[4,t.applyConstraints({advanced:[{fillLightMode:r?"flash":"off",torch:!!r}]})];case 1:return n.sent(),[2]}})})},s.mediaStreamIsTorchCompatible=function(t){var r,n,a=t.getVideoTracks();try{for(var i=aS(a),o=i.next();!o.done;o=i.next()){var l=o.value;if(s.mediaStreamIsTorchCompatibleTrack(l))return!0}}catch(c){r={error:c}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return!1},s.mediaStreamIsTorchCompatibleTrack=function(t){try{var r=t.getCapabilities();return"torch"in r}catch(n){return console.error(n),console.warn("Your browser may be not fully compatible with WebRTC and/or ImageCapture specs. Torch will not be available."),!1}},s.isVideoPlaying=function(t){return t.currentTime>0&&!t.paused&&t.readyState>2},s.getMediaElement=function(t,r){var n=document.getElementById(t);if(!n)throw new Li("element with id '".concat(t,"' not found"));if(n.nodeName.toLowerCase()!==r.toLowerCase())throw new Li("element with id '".concat(t,"' must be an ").concat(r," element"));return n},s.createVideoElement=function(t){if(t instanceof HTMLVideoElement)return t;if(typeof t=="string")return s.getMediaElement(t,"video");if(!t&&typeof document<"u"){var r=document.createElement("video");return r.width=200,r.height=200,r}throw new Error("Couldn't get videoElement from videoSource!")},s.prepareImageElement=function(t){if(t instanceof HTMLImageElement)return t;if(typeof t=="string")return s.getMediaElement(t,"img");if(typeof t>"u"){var r=document.createElement("img");return r.width=200,r.height=200,r}throw new Error("Couldn't get imageElement from imageSource!")},s.prepareVideoElement=function(t){var r=s.createVideoElement(t);return r.setAttribute("autoplay","true"),r.setAttribute("muted","true"),r.setAttribute("playsinline","true"),r},s.isImageLoaded=function(t){return!(!t.complete||t.naturalWidth===0)},s.createBinaryBitmapFromCanvas=function(t){var r=new Ime(t),n=new _9(r);return new P9(n)},s.drawImageOnCanvas=function(t,r){t.drawImage(r,0,0)},s.getMediaElementDimensions=function(t){if(t instanceof HTMLVideoElement)return{height:t.videoHeight,width:t.videoWidth};if(t instanceof HTMLImageElement)return{height:t.naturalHeight||t.height,width:t.naturalWidth||t.width};throw new Error("Couldn't find the Source's dimensions!")},s.createCaptureCanvas=function(t){if(!t)throw new Li("Cannot create a capture canvas without a media element.");if(typeof document>"u")throw new Error(`The page "Document" is undefined, make sure you're running in a browser.`);var r=document.createElement("canvas"),n=s.getMediaElementDimensions(t),a=n.width,i=n.height;return r.style.width=a+"px",r.style.height=i+"px",r.width=a,r.height=i,r},s.tryPlayVideo=function(t){return yi(this,void 0,void 0,function(){var r;return ji(this,function(n){switch(n.label){case 0:if(t!=null&&t.ended)return console.error("Trying to play video that has ended."),[2,!1];if(s.isVideoPlaying(t))return console.warn("Trying to play video that is already playing."),[2,!0];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,t.play()];case 2:return n.sent(),[2,!0];case 3:return r=n.sent(),console.warn("It was not possible to play the video.",r),[2,!1];case 4:return[2]}})})},s.createCanvasFromMediaElement=function(t){var r=s.createCaptureCanvas(t),n=r.getContext("2d");if(!n)throw new Error("Couldn't find Canvas 2D Context.");return s.drawImageOnCanvas(n,t),r},s.createBinaryBitmapFromMediaElem=function(t){var r=s.createCanvasFromMediaElement(t);return s.createBinaryBitmapFromCanvas(r)},s.destroyImageElement=function(t){t.src="",t.removeAttribute("src"),t=void 0},s.listVideoInputDevices=function(){return yi(this,void 0,void 0,function(){var t,r,n,a,i,o,l,c,d,u,h,f;return ji(this,function(m){switch(m.label){case 0:if(!H9())throw new Error("Can't enumerate devices, navigator is not present.");if(!_me())throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:t=m.sent(),r=[];try{for(n=aS(t),a=n.next();!a.done;a=n.next())i=a.value,o=i.kind==="video"?"videoinput":i.kind,o==="videoinput"&&(l=i.deviceId||i.id,c=i.label||"Video device ".concat(r.length+1),d=i.groupId,u={deviceId:l,label:c,kind:o,groupId:d},r.push(u))}catch(p){h={error:p}}finally{try{a&&!a.done&&(f=n.return)&&f.call(n)}finally{if(h)throw h.error}}return[2,r]}})})},s.findDeviceById=function(t){return yi(this,void 0,void 0,function(){var r;return ji(this,function(n){switch(n.label){case 0:return[4,s.listVideoInputDevices()];case 1:return r=n.sent(),r?[2,r.find(function(a){return a.deviceId===t})]:[2]}})})},s.cleanVideoSource=function(t){if(t){try{t.srcObject=null}catch{t.src=""}t&&t.removeAttribute("src")}},s.releaseAllStreams=function(){s.streamTracker.length!==0&&s.streamTracker.forEach(function(t){t.getTracks().forEach(function(r){return r.stop()})}),s.streamTracker=[]},s.playVideoOnLoadAsync=function(t,r){return yi(this,void 0,void 0,function(){var n;return ji(this,function(a){switch(a.label){case 0:return[4,s.tryPlayVideo(t)];case 1:return n=a.sent(),n?[2,!0]:[2,new Promise(function(i,o){var l=setTimeout(function(){s.isVideoPlaying(t)||(o(!1),t.removeEventListener("canplay",c))},r),c=function(){s.tryPlayVideo(t).then(function(d){clearTimeout(l),t.removeEventListener("canplay",c),i(d)})};t.addEventListener("canplay",c)})]}})})},s.attachStreamToVideo=function(t,r,n){return n===void 0&&(n=5e3),yi(this,void 0,void 0,function(){var a;return ji(this,function(i){switch(i.label){case 0:return a=s.prepareVideoElement(r),s.addVideoSource(a,t),[4,s.playVideoOnLoadAsync(a,n)];case 1:return i.sent(),[2,a]}})})},s._waitImageLoad=function(t){return new Promise(function(r,n){var a=1e4,i=setTimeout(function(){s.isImageLoaded(t)||(t.removeEventListener("load",o),n())},a),o=function(){clearTimeout(i),t.removeEventListener("load",o),r()};t.addEventListener("load",o)})},s.checkCallbackFnOrThrow=function(t){if(!t)throw new Li("`callbackFn` is a required parameter, you cannot capture results without it.")},s.disposeMediaStream=function(t){t.getVideoTracks().forEach(function(r){return r.stop()}),t=void 0},s.prototype.decode=function(t){var r=s.createCanvasFromMediaElement(t);return this.decodeFromCanvas(r)},s.prototype.decodeBitmap=function(t){return this.reader.decode(t,this.hints)},s.prototype.decodeFromCanvas=function(t){var r=s.createBinaryBitmapFromCanvas(t);return this.decodeBitmap(r)},s.prototype.decodeFromImageElement=function(t){return yi(this,void 0,void 0,function(){var r;return ji(this,function(n){switch(n.label){case 0:if(!t)throw new Li("An image element must be provided.");return r=s.prepareImageElement(t),[4,this._decodeOnLoadImage(r)];case 1:return[2,n.sent()]}})})},s.prototype.decodeFromImageUrl=function(t){return yi(this,void 0,void 0,function(){var r;return ji(this,function(n){switch(n.label){case 0:if(!t)throw new Li("An URL must be provided.");r=s.prepareImageElement(),r.src=t,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this.decodeFromImageElement(r)];case 2:return[2,n.sent()];case 3:return s.destroyImageElement(r),[7];case 4:return[2]}})})},s.prototype.decodeFromConstraints=function(t,r,n){return yi(this,void 0,void 0,function(){var a,i;return ji(this,function(o){switch(o.label){case 0:return s.checkCallbackFnOrThrow(n),[4,this.getUserMedia(t)];case 1:a=o.sent(),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,this.decodeFromStream(a,r,n)];case 3:return[2,o.sent()];case 4:throw i=o.sent(),s.disposeMediaStream(a),i;case 5:return[2]}})})},s.prototype.decodeFromStream=function(t,r,n){return yi(this,void 0,void 0,function(){var a,i,o,l,c,d,u,h,f,m=this;return ji(this,function(p){switch(p.label){case 0:return s.checkCallbackFnOrThrow(n),a=this.options.tryPlayVideoTimeout,[4,s.attachStreamToVideo(t,r,a)];case 1:return i=p.sent(),o=function(){s.disposeMediaStream(t),s.cleanVideoSource(i)},l=this.scan(i,n,o),c=t.getVideoTracks(),d=Gx(Gx({},l),{stop:function(){l.stop()},streamVideoConstraintsApply:function(g,v){return yi(this,void 0,void 0,function(){var y,j,b,w,N,C,S;return ji(this,function(_){switch(_.label){case 0:y=v?c.filter(v):c,_.label=1;case 1:_.trys.push([1,6,7,8]),j=aS(y),b=j.next(),_.label=2;case 2:return b.done?[3,5]:(w=b.value,[4,w.applyConstraints(g)]);case 3:_.sent(),_.label=4;case 4:return b=j.next(),[3,2];case 5:return[3,8];case 6:return N=_.sent(),C={error:N},[3,8];case 7:try{b&&!b.done&&(S=j.return)&&S.call(j)}finally{if(C)throw C.error}return[7];case 8:return[2]}})})},streamVideoConstraintsGet:function(g){return c.find(g).getConstraints()},streamVideoSettingsGet:function(g){return c.find(g).getSettings()},streamVideoCapabilitiesGet:function(g){return c.find(g).getCapabilities()}}),u=s.mediaStreamIsTorchCompatible(t),u&&(h=c==null?void 0:c.find(function(g){return s.mediaStreamIsTorchCompatibleTrack(g)}),f=function(g){return yi(m,void 0,void 0,function(){return ji(this,function(v){switch(v.label){case 0:return[4,s.mediaStreamSetTorch(h,g)];case 1:return v.sent(),[2]}})})},d.switchTorch=f,d.stop=function(){return yi(m,void 0,void 0,function(){return ji(this,function(g){switch(g.label){case 0:return l.stop(),[4,f(!1)];case 1:return g.sent(),[2]}})})}),[2,d]}})})},s.prototype.decodeFromVideoDevice=function(t,r,n){return yi(this,void 0,void 0,function(){var a,i;return ji(this,function(o){switch(o.label){case 0:return s.checkCallbackFnOrThrow(n),t?a={deviceId:{exact:t}}:a={facingMode:"environment"},i={video:a},[4,this.decodeFromConstraints(i,r,n)];case 1:return[2,o.sent()]}})})},s.prototype.decodeFromVideoElement=function(t,r){return yi(this,void 0,void 0,function(){var n,a;return ji(this,function(i){switch(i.label){case 0:if(s.checkCallbackFnOrThrow(r),!t)throw new Li("A video element must be provided.");return n=s.prepareVideoElement(t),a=this.options.tryPlayVideoTimeout,[4,s.playVideoOnLoadAsync(n,a)];case 1:return i.sent(),[2,this.scan(n,r)]}})})},s.prototype.decodeFromVideoUrl=function(t,r){return yi(this,void 0,void 0,function(){var n,a,i,o;return ji(this,function(l){switch(l.label){case 0:if(s.checkCallbackFnOrThrow(r),!t)throw new Li("An URL must be provided.");return n=s.prepareVideoElement(),n.src=t,a=function(){s.cleanVideoSource(n)},i=this.options.tryPlayVideoTimeout,[4,s.playVideoOnLoadAsync(n,i)];case 1:return l.sent(),o=this.scan(n,r,a),[2,o]}})})},s.prototype.decodeOnceFromConstraints=function(t,r){return yi(this,void 0,void 0,function(){var n;return ji(this,function(a){switch(a.label){case 0:return[4,this.getUserMedia(t)];case 1:return n=a.sent(),[4,this.decodeOnceFromStream(n,r)];case 2:return[2,a.sent()]}})})},s.prototype.decodeOnceFromStream=function(t,r){return yi(this,void 0,void 0,function(){var n,a,i;return ji(this,function(o){switch(o.label){case 0:return n=!!r,[4,s.attachStreamToVideo(t,r)];case 1:a=o.sent(),o.label=2;case 2:return o.trys.push([2,,4,5]),[4,this.scanOneResult(a)];case 3:return i=o.sent(),[2,i];case 4:return n||s.cleanVideoSource(a),[7];case 5:return[2]}})})},s.prototype.decodeOnceFromVideoDevice=function(t,r){return yi(this,void 0,void 0,function(){var n,a;return ji(this,function(i){switch(i.label){case 0:return t?n={deviceId:{exact:t}}:n={facingMode:"environment"},a={video:n},[4,this.decodeOnceFromConstraints(a,r)];case 1:return[2,i.sent()]}})})},s.prototype.decodeOnceFromVideoElement=function(t){return yi(this,void 0,void 0,function(){var r,n;return ji(this,function(a){switch(a.label){case 0:if(!t)throw new Li("A video element must be provided.");return r=s.prepareVideoElement(t),n=this.options.tryPlayVideoTimeout,[4,s.playVideoOnLoadAsync(r,n)];case 1:return a.sent(),[4,this.scanOneResult(r)];case 2:return[2,a.sent()]}})})},s.prototype.decodeOnceFromVideoUrl=function(t){return yi(this,void 0,void 0,function(){var r,n;return ji(this,function(a){switch(a.label){case 0:if(!t)throw new Li("An URL must be provided.");r=s.prepareVideoElement(),r.src=t,n=this.decodeOnceFromVideoElement(r),a.label=1;case 1:return a.trys.push([1,,3,4]),[4,n];case 2:return[2,a.sent()];case 3:return s.cleanVideoSource(r),[7];case 4:return[2]}})})},s.prototype.scanOneResult=function(t,r,n,a){var i=this;return r===void 0&&(r=!0),n===void 0&&(n=!0),a===void 0&&(a=!0),new Promise(function(o,l){i.scan(t,function(c,d,u){if(c){o(c),u.stop();return}if(d){if(d instanceof es&&r||d instanceof no&&n||d instanceof Ls&&a)return;u.stop(),l(d)}})})},s.prototype.scan=function(t,r,n){var a=this;s.checkCallbackFnOrThrow(r);var i=s.createCaptureCanvas(t),o;try{o=i.getContext("2d",{willReadFrequently:!0})}catch{o=i.getContext("2d")}if(!o)throw new Error("Couldn't create canvas for visual element scan.");var l=function(){o=void 0,i=void 0},c=!1,d,u=function(){c=!0,clearTimeout(d),l(),n&&n()},h={stop:u},f=function(){if(!c)try{s.drawImageOnCanvas(o,t);var m=a.decodeFromCanvas(i);r(m,void 0,h),d=setTimeout(f,a.options.delayBetweenScanSuccess)}catch(y){r(void 0,y,h);var p=y instanceof no,g=y instanceof Ls,v=y instanceof es;if(p||g||v){d=setTimeout(f,a.options.delayBetweenScanAttempts);return}l(),n&&n(y)}};return f(),h},s.prototype._decodeOnLoadImage=function(t){return yi(this,void 0,void 0,function(){var r;return ji(this,function(n){switch(n.label){case 0:return r=s.isImageLoaded(t),r?[3,2]:[4,s._waitImageLoad(t)];case 1:n.sent(),n.label=2;case 2:return[2,this.decode(t)]}})})},s.prototype.getUserMedia=function(t){return yi(this,void 0,void 0,function(){var r;return ji(this,function(n){switch(n.label){case 0:return[4,navigator.mediaDevices.getUserMedia(t)];case 1:return r=n.sent(),s.streamTracker.push(r),[2,r]}})})},s.streamTracker=[],s}(),Tme=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},s(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(s){Tme(t,s);function t(r,n){return s.call(this,new A1,r,n)||this}return t})(Cg);var Dme=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},s(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(s){Dme(t,s);function t(r,n){return s.call(this,new Wx(r),r,n)||this}return t})(Cg);var Ome=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},s(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(s){Ome(t,s);function t(r,n){return s.call(this,new I1,r,n)||this}return t})(Cg);var Rme=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},s(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Fme=function(s){Rme(t,s);function t(r,n){var a=this,i=new U9;return i.setHints(r),a=s.call(this,i,r,n)||this,a.reader=i,a}return Object.defineProperty(t.prototype,"possibleFormats",{set:function(r){this.hints.set(ti.POSSIBLE_FORMATS,r),this.reader.setHints(this.hints)},enumerable:!1,configurable:!0}),t.prototype.decodeBitmap=function(r){return this.reader.decodeWithState(r)},t.prototype.setHints=function(r){this.hints=r,this.reader.setHints(this.hints)},t}(Cg),Mme=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},s(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(s){Mme(t,s);function t(r,n){return s.call(this,new _1,r,n)||this}return t})(Cg);var Lme=function(){var s=function(t,r){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},s(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");s(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();(function(s){Lme(t,s);function t(r,n){return s.call(this,new P1,r,n)||this}return t})(Cg);var G9={exports:{}};(function(s,t){(function(n,a){s.exports=a(x)})(v0,function(r){return function(n){var a={};function i(o){if(a[o])return a[o].exports;var l=a[o]={i:o,l:!1,exports:{}};return n[o].call(l.exports,l,l.exports,i),l.l=!0,l.exports}return i.m=n,i.c=a,i.d=function(o,l,c){i.o(o,l)||Object.defineProperty(o,l,{enumerable:!0,get:c})},i.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},i.t=function(o,l){if(l&1&&(o=i(o)),l&8||l&4&&typeof o=="object"&&o&&o.__esModule)return o;var c=Object.create(null);if(i.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:o}),l&2&&typeof o!="string")for(var d in o)i.d(c,d,(function(u){return o[u]}).bind(null,d));return c},i.n=function(o){var l=o&&o.__esModule?function(){return o.default}:function(){return o};return i.d(l,"a",l),l},i.o=function(o,l){return Object.prototype.hasOwnProperty.call(o,l)},i.p="",i(i.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(n,a,i){i.r(a);var o=i("react"),l=function(){var f=function(m,p){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,v){g.__proto__=v}||function(g,v){for(var y in v)v.hasOwnProperty(y)&&(g[y]=v[y])},f(m,p)};return function(m,p){f(m,p);function g(){this.constructor=m}m.prototype=p===null?Object.create(p):(g.prototype=p.prototype,new g)}}(),c=function(){return c=Object.assign||function(f){for(var m,p=1,g=arguments.length;p<g;p++){m=arguments[p];for(var v in m)Object.prototype.hasOwnProperty.call(m,v)&&(f[v]=m[v])}return f},c.apply(this,arguments)},d=function(f,m){var p={};for(var g in f)Object.prototype.hasOwnProperty.call(f,g)&&m.indexOf(g)<0&&(p[g]=f[g]);if(f!=null&&typeof Object.getOwnPropertySymbols=="function")for(var v=0,g=Object.getOwnPropertySymbols(f);v<g.length;v++)m.indexOf(g[v])<0&&Object.prototype.propertyIsEnumerable.call(f,g[v])&&(p[g[v]]=f[g[v]]);return p};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(m){var p=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return p?new Promise(function(g,v){p.call(navigator,m,g,v)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function u(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var h=function(f){l(m,f);function m(p){var g=f.call(this,p)||this;return g.canvas=null,g.ctx=null,g.requestUserMediaId=0,g.unmounted=!1,g.state={hasUserMedia:!1},g}return m.prototype.componentDidMount=function(){var p=this,g=p.state,v=p.props;if(this.unmounted=!1,!u()){v.onUserMediaError("getUserMedia not supported");return}g.hasUserMedia||this.requestUserMedia(),v.children&&typeof v.children!="function"&&console.warn("children must be a function")},m.prototype.componentDidUpdate=function(p){var g=this.props;if(!u()){g.onUserMediaError("getUserMedia not supported");return}var v=JSON.stringify(p.audioConstraints)!==JSON.stringify(g.audioConstraints),y=JSON.stringify(p.videoConstraints)!==JSON.stringify(g.videoConstraints),j=p.minScreenshotWidth!==g.minScreenshotWidth,b=p.minScreenshotHeight!==g.minScreenshotHeight;(y||j||b)&&(this.canvas=null,this.ctx=null),(v||y)&&(this.stopAndCleanup(),this.requestUserMedia())},m.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},m.stopMediaStream=function(p){p&&(p.getVideoTracks&&p.getAudioTracks?(p.getVideoTracks().map(function(g){p.removeTrack(g),g.stop()}),p.getAudioTracks().map(function(g){p.removeTrack(g),g.stop()})):p.stop())},m.prototype.stopAndCleanup=function(){var p=this.state;p.hasUserMedia&&(m.stopMediaStream(this.stream),p.src&&window.URL.revokeObjectURL(p.src))},m.prototype.getScreenshot=function(p){var g=this,v=g.state,y=g.props;if(!v.hasUserMedia)return null;var j=this.getCanvas(p);return j&&j.toDataURL(y.screenshotFormat,y.screenshotQuality)},m.prototype.getCanvas=function(p){var g=this,v=g.state,y=g.props;if(!this.video||!v.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var j=this.video.videoWidth,b=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var w=j/b;j=y.minScreenshotWidth||this.video.clientWidth,b=j/w,y.minScreenshotHeight&&b<y.minScreenshotHeight&&(b=y.minScreenshotHeight,j=b*w)}this.canvas=document.createElement("canvas"),this.canvas.width=(p==null?void 0:p.width)||j,this.canvas.height=(p==null?void 0:p.height)||b,this.ctx=this.canvas.getContext("2d")}var N=this,C=N.ctx,S=N.canvas;return C&&S&&(S.width=(p==null?void 0:p.width)||S.width,S.height=(p==null?void 0:p.height)||S.height,y.mirrored&&(C.translate(S.width,0),C.scale(-1,1)),C.imageSmoothingEnabled=y.imageSmoothing,C.drawImage(this.video,0,0,(p==null?void 0:p.width)||S.width,(p==null?void 0:p.height)||S.height),y.mirrored&&(C.scale(-1,1),C.translate(-S.width,0))),S},m.prototype.requestUserMedia=function(){var p=this,g=this.props,v=function(b,w){var N={video:typeof w<"u"?w:!0};g.audio&&(N.audio=typeof b<"u"?b:!0),p.requestUserMediaId++;var C=p.requestUserMediaId;navigator.mediaDevices.getUserMedia(N).then(function(S){p.unmounted||C!==p.requestUserMediaId?m.stopMediaStream(S):p.handleUserMedia(null,S)}).catch(function(S){p.handleUserMedia(S)})};if("mediaDevices"in navigator)v(g.audioConstraints,g.videoConstraints);else{var y=function(b){return{optional:[{sourceId:b}]}},j=function(b){var w=b.deviceId;return typeof w=="string"?w:Array.isArray(w)&&w.length>0?w[0]:typeof w=="object"&&w.ideal?w.ideal:null};MediaStreamTrack.getSources(function(b){var w=null,N=null;b.forEach(function(_){_.kind==="audio"?w=_.id:_.kind==="video"&&(N=_.id)});var C=j(g.audioConstraints);C&&(w=C);var S=j(g.videoConstraints);S&&(N=S),v(y(w),y(N))})}},m.prototype.handleUserMedia=function(p,g){var v=this.props;if(p||!g){this.setState({hasUserMedia:!1}),v.onUserMediaError(p);return}this.stream=g;try{this.video&&(this.video.srcObject=g),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(g)})}v.onUserMedia(g)},m.prototype.render=function(){var p=this,g=this,v=g.state,y=g.props,j=y.audio;y.forceScreenshotSourceSize;var b=y.disablePictureInPicture;y.onUserMedia,y.onUserMediaError,y.screenshotFormat,y.screenshotQuality,y.minScreenshotWidth,y.minScreenshotHeight,y.audioConstraints,y.videoConstraints,y.imageSmoothing;var w=y.mirrored,N=y.style,C=N===void 0?{}:N,S=y.children,_=d(y,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),k=w?c(c({},C),{transform:(C.transform||"")+" scaleX(-1)"}):C,F={getScreenshot:this.getScreenshot.bind(this)};return o.createElement(o.Fragment,null,o.createElement("video",c({autoPlay:!0,disablePictureInPicture:b,src:v.src,muted:!j,playsInline:!0,ref:function(A){p.video=A},style:k},_)),S&&S(F))},m.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},m}(o.Component);a.default=h},react:function(n,a){n.exports=r}}).default})})(G9);var $me=G9.exports;const Bme=Ca($me);function Ume({onScan:s,onProductFound:t,trigger:r,className:n}){const[a,i]=x.useState(!1),[o,l]=x.useState(!1),[c,d]=x.useState([]),[u,h]=x.useState(""),[f,m]=x.useState("camera"),[p,g]=x.useState(!1),[v,y]=x.useState(null),j=x.useRef(null),b=x.useRef(null),{toast:w}=za();x.useEffect(()=>(a&&(b.current=new Fme),()=>{b.current&&b.current.reset()}),[a]),x.useEffect(()=>{a&&f==="camera"&&N()},[a,f]);const N=async()=>{try{const M=await navigator.mediaDevices.getUserMedia({video:!0});y(!0),M.getTracks().forEach(G=>G.stop())}catch{y(!1),w({title:"Camera Permission Required",description:"Please allow camera access to use barcode scanning.",variant:"destructive"})}},C=x.useCallback(async()=>{if(!(!b.current||!j.current))try{l(!0);const M=j.current.video;if(!M)throw new Error("Camera not available");const G=await b.current.decodeFromVideoElement(M);if(G){const L=G.getText();_(L)}}catch(M){console.error("Scanning error:",M),setTimeout(()=>{o&&C()},100)}},[o]),S=()=>{l(!1),b.current&&b.current.reset()},_=async M=>{const G=new Date;try{const L=await k(M),J={barcode:M,timestamp:G,success:!0,product:L};d(z=>[J,...z.slice(0,9)]),s(M),L&&t&&t(L),w({title:"Barcode Scanned",description:L?`Found: ${L.name}`:`Barcode: ${M}`}),S()}catch(L){const J={barcode:M,timestamp:G,success:!1,error:L instanceof Error?L.message:"Unknown error"};d(z=>[J,...z.slice(0,9)]),w({title:"Scan Error",description:`Failed to process barcode: ${M}`,variant:"destructive"})}},k=async M=>({id:`product-${M}`,name:`Product ${M}`,sku:M,price:29.99,stock:10,category:"Electronics"}),F=()=>{u.trim()&&(_(u.trim()),h(""))},A=()=>{d([])},T=()=>{g(!p)},V={width:p?1280:640,height:p?720:480,facingMode:"environment"};return e.jsxs(ts,{open:a,onOpenChange:i,children:[e.jsx(ki,{asChild:!0,children:r||e.jsxs(I,{variant:"outline",className:n,children:[e.jsx(dl,{className:"w-4 h-4 mr-2"}),"Scan Barcode"]})}),e.jsxs(ss,{className:`${p?"max-w-6xl h-[90vh]":"max-w-2xl"} p-0`,children:[e.jsx(as,{className:"p-6 pb-0",children:e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(dl,{className:"w-5 h-5"}),"Barcode Scanner"]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs(an,{value:f,onValueChange:m,children:[e.jsxs(on,{className:"grid w-full grid-cols-2",children:[e.jsxs(vt,{value:"camera",className:"flex items-center gap-2",children:[e.jsx(Zj,{className:"w-4 h-4"}),"Camera Scan"]}),e.jsxs(vt,{value:"manual",className:"flex items-center gap-2",children:[e.jsx(Rn,{className:"w-4 h-4"}),"Manual Entry"]})]}),e.jsx(yt,{value:"camera",className:"space-y-4",children:v===!1?e.jsx(ne,{children:e.jsxs(ie,{className:"p-6 text-center",children:[e.jsx(Ln,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Camera Access Required"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Please allow camera access to use barcode scanning."}),e.jsxs(I,{onClick:N,children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Retry Permission"]})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Bme,{ref:j,audio:!1,videoConstraints:V,className:"w-full rounded-lg border"}),o&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20 rounded-lg",children:e.jsxs("div",{className:"bg-white/90 p-4 rounded-lg flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full"}),e.jsx("span",{className:"text-sm font-medium",children:"Scanning..."})]})}),e.jsx(I,{variant:"outline",size:"sm",className:"absolute top-2 right-2",onClick:T,children:p?e.jsx(jY,{className:"w-4 h-4"}):e.jsx(vY,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"flex gap-2",children:o?e.jsxs(I,{onClick:S,variant:"destructive",className:"flex-1",children:[e.jsx(aY,{className:"w-4 h-4 mr-2"}),"Stop Scanning"]}):e.jsxs(I,{onClick:C,className:"flex-1",children:[e.jsx(Zj,{className:"w-4 h-4 mr-2"}),"Start Scanning"]})})]})}),e.jsx(yt,{value:"manual",className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"manual-barcode",children:"Enter Barcode/SKU"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ge,{id:"manual-barcode",value:u,onChange:M=>h(M.target.value),placeholder:"Enter barcode or SKU...",onKeyPress:M=>M.key==="Enter"&&F()}),e.jsx(I,{onClick:F,disabled:!u.trim(),children:e.jsx(Rn,{className:"w-4 h-4"})})]})]})})]}),c.length>0&&e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between",children:[e.jsx(Se,{className:"text-lg",children:"Recent Scans"}),e.jsx(I,{variant:"outline",size:"sm",onClick:A,children:"Clear"})]}),e.jsx(ie,{className:"space-y-3",children:c.slice(0,5).map((M,G)=>e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${M.success?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[M.success?e.jsx(bs,{className:"w-5 h-5 text-green-600"}):e.jsx(Ln,{className:"w-5 h-5 text-red-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:M.barcode}),M.product&&e.jsx("p",{className:"text-sm text-muted-foreground",children:M.product.name}),M.error&&e.jsx("p",{className:"text-sm text-red-600",children:M.error})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(Oe,{variant:M.success?"default":"destructive",children:M.success?"Success":"Error"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:M.timestamp.toLocaleTimeString()})]})]},G))})]})]})]})]})}var zme=Array.isArray,cc=zme,qme=typeof v0=="object"&&v0&&v0.Object===Object&&v0,K9=qme,Vme=K9,Wme=typeof self=="object"&&self&&self.Object===Object&&self,Hme=Vme||Wme||Function("return this")(),ju=Hme,Gme=ju,Kme=Gme.Symbol,my=Kme,Xk=my,Y9=Object.prototype,Yme=Y9.hasOwnProperty,Jme=Y9.toString,l0=Xk?Xk.toStringTag:void 0;function Xme(s){var t=Yme.call(s,l0),r=s[l0];try{s[l0]=void 0;var n=!0}catch{}var a=Jme.call(s);return n&&(t?s[l0]=r:delete s[l0]),a}var Qme=Xme,Zme=Object.prototype,efe=Zme.toString;function tfe(s){return efe.call(s)}var sfe=tfe,Qk=my,rfe=Qme,nfe=sfe,afe="[object Null]",ife="[object Undefined]",Zk=Qk?Qk.toStringTag:void 0;function ofe(s){return s==null?s===void 0?ife:afe:Zk&&Zk in Object(s)?rfe(s):nfe(s)}var gh=ofe;function lfe(s){return s!=null&&typeof s=="object"}var vh=lfe,cfe=gh,dfe=vh,ufe="[object Symbol]";function hfe(s){return typeof s=="symbol"||dfe(s)&&cfe(s)==ufe}var Ag=hfe,mfe=cc,ffe=Ag,xfe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,pfe=/^\w*$/;function gfe(s,t){if(mfe(s))return!1;var r=typeof s;return r=="number"||r=="symbol"||r=="boolean"||s==null||ffe(s)?!0:pfe.test(s)||!xfe.test(s)||t!=null&&s in Object(t)}var _3=gfe;function vfe(s){var t=typeof s;return s!=null&&(t=="object"||t=="function")}var Wm=vfe;const Eg=Ca(Wm);var yfe=gh,jfe=Wm,bfe="[object AsyncFunction]",Nfe="[object Function]",wfe="[object GeneratorFunction]",Sfe="[object Proxy]";function Cfe(s){if(!jfe(s))return!1;var t=yfe(s);return t==Nfe||t==wfe||t==bfe||t==Sfe}var k3=Cfe;const Lr=Ca(k3);var Afe=ju,Efe=Afe["__core-js_shared__"],Ife=Efe,iS=Ife,eT=function(){var s=/[^.]+$/.exec(iS&&iS.keys&&iS.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}();function Pfe(s){return!!eT&&eT in s}var _fe=Pfe,kfe=Function.prototype,Tfe=kfe.toString;function Dfe(s){if(s!=null){try{return Tfe.call(s)}catch{}try{return s+""}catch{}}return""}var J9=Dfe,Ofe=k3,Rfe=_fe,Ffe=Wm,Mfe=J9,Lfe=/[\\^$.*+?()[\]{}|]/g,$fe=/^\[object .+?Constructor\]$/,Bfe=Function.prototype,Ufe=Object.prototype,zfe=Bfe.toString,qfe=Ufe.hasOwnProperty,Vfe=RegExp("^"+zfe.call(qfe).replace(Lfe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Wfe(s){if(!Ffe(s)||Rfe(s))return!1;var t=Ofe(s)?Vfe:$fe;return t.test(Mfe(s))}var Hfe=Wfe;function Gfe(s,t){return s==null?void 0:s[t]}var Kfe=Gfe,Yfe=Hfe,Jfe=Kfe;function Xfe(s,t){var r=Jfe(s,t);return Yfe(r)?r:void 0}var xx=Xfe,Qfe=xx,Zfe=Qfe(Object,"create"),SN=Zfe,tT=SN;function exe(){this.__data__=tT?tT(null):{},this.size=0}var txe=exe;function sxe(s){var t=this.has(s)&&delete this.__data__[s];return this.size-=t?1:0,t}var rxe=sxe,nxe=SN,axe="__lodash_hash_undefined__",ixe=Object.prototype,oxe=ixe.hasOwnProperty;function lxe(s){var t=this.__data__;if(nxe){var r=t[s];return r===axe?void 0:r}return oxe.call(t,s)?t[s]:void 0}var cxe=lxe,dxe=SN,uxe=Object.prototype,hxe=uxe.hasOwnProperty;function mxe(s){var t=this.__data__;return dxe?t[s]!==void 0:hxe.call(t,s)}var fxe=mxe,xxe=SN,pxe="__lodash_hash_undefined__";function gxe(s,t){var r=this.__data__;return this.size+=this.has(s)?0:1,r[s]=xxe&&t===void 0?pxe:t,this}var vxe=gxe,yxe=txe,jxe=rxe,bxe=cxe,Nxe=fxe,wxe=vxe;function Ig(s){var t=-1,r=s==null?0:s.length;for(this.clear();++t<r;){var n=s[t];this.set(n[0],n[1])}}Ig.prototype.clear=yxe;Ig.prototype.delete=jxe;Ig.prototype.get=bxe;Ig.prototype.has=Nxe;Ig.prototype.set=wxe;var Sxe=Ig;function Cxe(){this.__data__=[],this.size=0}var Axe=Cxe;function Exe(s,t){return s===t||s!==s&&t!==t}var T3=Exe,Ixe=T3;function Pxe(s,t){for(var r=s.length;r--;)if(Ixe(s[r][0],t))return r;return-1}var CN=Pxe,_xe=CN,kxe=Array.prototype,Txe=kxe.splice;function Dxe(s){var t=this.__data__,r=_xe(t,s);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():Txe.call(t,r,1),--this.size,!0}var Oxe=Dxe,Rxe=CN;function Fxe(s){var t=this.__data__,r=Rxe(t,s);return r<0?void 0:t[r][1]}var Mxe=Fxe,Lxe=CN;function $xe(s){return Lxe(this.__data__,s)>-1}var Bxe=$xe,Uxe=CN;function zxe(s,t){var r=this.__data__,n=Uxe(r,s);return n<0?(++this.size,r.push([s,t])):r[n][1]=t,this}var qxe=zxe,Vxe=Axe,Wxe=Oxe,Hxe=Mxe,Gxe=Bxe,Kxe=qxe;function Pg(s){var t=-1,r=s==null?0:s.length;for(this.clear();++t<r;){var n=s[t];this.set(n[0],n[1])}}Pg.prototype.clear=Vxe;Pg.prototype.delete=Wxe;Pg.prototype.get=Hxe;Pg.prototype.has=Gxe;Pg.prototype.set=Kxe;var AN=Pg,Yxe=xx,Jxe=ju,Xxe=Yxe(Jxe,"Map"),D3=Xxe,sT=Sxe,Qxe=AN,Zxe=D3;function epe(){this.size=0,this.__data__={hash:new sT,map:new(Zxe||Qxe),string:new sT}}var tpe=epe;function spe(s){var t=typeof s;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?s!=="__proto__":s===null}var rpe=spe,npe=rpe;function ape(s,t){var r=s.__data__;return npe(t)?r[typeof t=="string"?"string":"hash"]:r.map}var EN=ape,ipe=EN;function ope(s){var t=ipe(this,s).delete(s);return this.size-=t?1:0,t}var lpe=ope,cpe=EN;function dpe(s){return cpe(this,s).get(s)}var upe=dpe,hpe=EN;function mpe(s){return hpe(this,s).has(s)}var fpe=mpe,xpe=EN;function ppe(s,t){var r=xpe(this,s),n=r.size;return r.set(s,t),this.size+=r.size==n?0:1,this}var gpe=ppe,vpe=tpe,ype=lpe,jpe=upe,bpe=fpe,Npe=gpe;function _g(s){var t=-1,r=s==null?0:s.length;for(this.clear();++t<r;){var n=s[t];this.set(n[0],n[1])}}_g.prototype.clear=vpe;_g.prototype.delete=ype;_g.prototype.get=jpe;_g.prototype.has=bpe;_g.prototype.set=Npe;var O3=_g,X9=O3,wpe="Expected a function";function R3(s,t){if(typeof s!="function"||t!=null&&typeof t!="function")throw new TypeError(wpe);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],i=r.cache;if(i.has(a))return i.get(a);var o=s.apply(this,n);return r.cache=i.set(a,o)||i,o};return r.cache=new(R3.Cache||X9),r}R3.Cache=X9;var Q9=R3;const Spe=Ca(Q9);var Cpe=Q9,Ape=500;function Epe(s){var t=Cpe(s,function(n){return r.size===Ape&&r.clear(),n}),r=t.cache;return t}var Ipe=Epe,Ppe=Ipe,_pe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,kpe=/\\(\\)?/g,Tpe=Ppe(function(s){var t=[];return s.charCodeAt(0)===46&&t.push(""),s.replace(_pe,function(r,n,a,i){t.push(a?i.replace(kpe,"$1"):n||r)}),t}),Dpe=Tpe;function Ope(s,t){for(var r=-1,n=s==null?0:s.length,a=Array(n);++r<n;)a[r]=t(s[r],r,s);return a}var F3=Ope,rT=my,Rpe=F3,Fpe=cc,Mpe=Ag,nT=rT?rT.prototype:void 0,aT=nT?nT.toString:void 0;function Z9(s){if(typeof s=="string")return s;if(Fpe(s))return Rpe(s,Z9)+"";if(Mpe(s))return aT?aT.call(s):"";var t=s+"";return t=="0"&&1/s==-1/0?"-0":t}var Lpe=Z9,$pe=Lpe;function Bpe(s){return s==null?"":$pe(s)}var eB=Bpe,Upe=cc,zpe=_3,qpe=Dpe,Vpe=eB;function Wpe(s,t){return Upe(s)?s:zpe(s,t)?[s]:qpe(Vpe(s))}var tB=Wpe,Hpe=Ag;function Gpe(s){if(typeof s=="string"||Hpe(s))return s;var t=s+"";return t=="0"&&1/s==-1/0?"-0":t}var IN=Gpe,Kpe=tB,Ype=IN;function Jpe(s,t){t=Kpe(t,s);for(var r=0,n=t.length;s!=null&&r<n;)s=s[Ype(t[r++])];return r&&r==n?s:void 0}var M3=Jpe,Xpe=M3;function Qpe(s,t,r){var n=s==null?void 0:Xpe(s,t);return n===void 0?r:n}var sB=Qpe;const Pc=Ca(sB);function Zpe(s){return s==null}var ege=Zpe;const Fr=Ca(ege);var tge=gh,sge=cc,rge=vh,nge="[object String]";function age(s){return typeof s=="string"||!sge(s)&&rge(s)&&tge(s)==nge}var ige=age;const ax=Ca(ige);var rB={exports:{}},Aa={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L3=Symbol.for("react.element"),$3=Symbol.for("react.portal"),PN=Symbol.for("react.fragment"),_N=Symbol.for("react.strict_mode"),kN=Symbol.for("react.profiler"),TN=Symbol.for("react.provider"),DN=Symbol.for("react.context"),oge=Symbol.for("react.server_context"),ON=Symbol.for("react.forward_ref"),RN=Symbol.for("react.suspense"),FN=Symbol.for("react.suspense_list"),MN=Symbol.for("react.memo"),LN=Symbol.for("react.lazy"),lge=Symbol.for("react.offscreen"),nB;nB=Symbol.for("react.module.reference");function ld(s){if(typeof s=="object"&&s!==null){var t=s.$$typeof;switch(t){case L3:switch(s=s.type,s){case PN:case kN:case _N:case RN:case FN:return s;default:switch(s=s&&s.$$typeof,s){case oge:case DN:case ON:case LN:case MN:case TN:return s;default:return t}}case $3:return t}}}Aa.ContextConsumer=DN;Aa.ContextProvider=TN;Aa.Element=L3;Aa.ForwardRef=ON;Aa.Fragment=PN;Aa.Lazy=LN;Aa.Memo=MN;Aa.Portal=$3;Aa.Profiler=kN;Aa.StrictMode=_N;Aa.Suspense=RN;Aa.SuspenseList=FN;Aa.isAsyncMode=function(){return!1};Aa.isConcurrentMode=function(){return!1};Aa.isContextConsumer=function(s){return ld(s)===DN};Aa.isContextProvider=function(s){return ld(s)===TN};Aa.isElement=function(s){return typeof s=="object"&&s!==null&&s.$$typeof===L3};Aa.isForwardRef=function(s){return ld(s)===ON};Aa.isFragment=function(s){return ld(s)===PN};Aa.isLazy=function(s){return ld(s)===LN};Aa.isMemo=function(s){return ld(s)===MN};Aa.isPortal=function(s){return ld(s)===$3};Aa.isProfiler=function(s){return ld(s)===kN};Aa.isStrictMode=function(s){return ld(s)===_N};Aa.isSuspense=function(s){return ld(s)===RN};Aa.isSuspenseList=function(s){return ld(s)===FN};Aa.isValidElementType=function(s){return typeof s=="string"||typeof s=="function"||s===PN||s===kN||s===_N||s===RN||s===FN||s===lge||typeof s=="object"&&s!==null&&(s.$$typeof===LN||s.$$typeof===MN||s.$$typeof===TN||s.$$typeof===DN||s.$$typeof===ON||s.$$typeof===nB||s.getModuleId!==void 0)};Aa.typeOf=ld;rB.exports=Aa;var cge=rB.exports,dge=gh,uge=vh,hge="[object Number]";function mge(s){return typeof s=="number"||uge(s)&&dge(s)==hge}var aB=mge;const fge=Ca(aB);var xge=aB;function pge(s){return xge(s)&&s!=+s}var gge=pge;const kg=Ca(gge);var kl=function(t){return t===0?0:t>0?1:-1},Sf=function(t){return ax(t)&&t.indexOf("%")===t.length-1},ks=function(t){return fge(t)&&!kg(t)},vge=function(t){return Fr(t)},Ao=function(t){return ks(t)||ax(t)},yge=0,Hm=function(t){var r=++yge;return"".concat(t||"").concat(r)},Tl=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!ks(t)&&!ax(t))return n;var i;if(Sf(t)){var o=t.indexOf("%");i=r*parseFloat(t.slice(0,o))/100}else i=+t;return kg(i)&&(i=n),a&&i>r&&(i=r),i},Zh=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},jge=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,n={},a=0;a<r;a++)if(!n[t[a]])n[t[a]]=!0;else return!0;return!1},Ni=function(t,r){return ks(t)&&ks(r)?function(n){return t+n*(r-t)}:function(){return r}};function T1(s,t,r){return!s||!s.length?null:s.find(function(n){return n&&(typeof t=="function"?t(n):Pc(n,t))===r})}var bge=function(t){if(!t||!t.length)return null;for(var r=t.length,n=0,a=0,i=0,o=0,l=1/0,c=-1/0,d=0,u=0,h=0;h<r;h++)d=t[h].cx||0,u=t[h].cy||0,n+=d,a+=u,i+=d*u,o+=d*d,l=Math.min(l,d),c=Math.max(c,d);var f=r*o!==n*n?(r*i-n*a)/(r*o-n*n):0;return{xmin:l,xmax:c,a:f,b:(a-f*n)/r}},Nge=function(t,r){return ks(t)&&ks(r)?t-r:ax(t)&&ax(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function sp(s,t){for(var r in s)if({}.hasOwnProperty.call(s,r)&&(!{}.hasOwnProperty.call(t,r)||s[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(s,n))return!1;return!0}function C4(s){"@babel/helpers - typeof";return C4=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C4(s)}var wge=["viewBox","children"],Sge=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],iT=["points","pathLength"],oS={svg:wge,polygon:iT,polyline:iT},B3=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],D1=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(x.isValidElement(t)&&(n=t.props),!Eg(n))return null;var a={};return Object.keys(n).forEach(function(i){B3.includes(i)&&(a[i]=r||function(o){return n[i](n,o)})}),a},Cge=function(t,r,n){return function(a){return t(r,n,a),null}},Mm=function(t,r,n){if(!Eg(t)||C4(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(i){var o=t[i];B3.includes(i)&&typeof o=="function"&&(a||(a={}),a[i]=Cge(o,r,n))}),a},Age=["children"],Ege=["children"];function oT(s,t){if(s==null)return{};var r=Ige(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function Ige(s,t){if(s==null)return{};var r={};for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n)){if(t.indexOf(n)>=0)continue;r[n]=s[n]}return r}function A4(s){"@babel/helpers - typeof";return A4=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A4(s)}var lT={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},rh=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},cT=null,lS=null,U3=function s(t){if(t===cT&&Array.isArray(lS))return lS;var r=[];return x.Children.forEach(t,function(n){Fr(n)||(cge.isFragment(n)?r=r.concat(s(n.props.children)):r.push(n))}),lS=r,cT=t,r};function Ml(s,t){var r=[],n=[];return Array.isArray(t)?n=t.map(function(a){return rh(a)}):n=[rh(t)],U3(s).forEach(function(a){var i=Pc(a,"type.displayName")||Pc(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}function bc(s,t){var r=Ml(s,t);return r&&r[0]}var dT=function(t){if(!t||!t.props)return!1;var r=t.props,n=r.width,a=r.height;return!(!ks(n)||n<=0||!ks(a)||a<=0)},Pge=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],_ge=function(t){return t&&t.type&&ax(t.type)&&Pge.indexOf(t.type)>=0},iB=function(t){return t&&A4(t)==="object"&&"clipDot"in t},kge=function(t,r,n,a){var i,o=(i=oS==null?void 0:oS[a])!==null&&i!==void 0?i:[];return r.startsWith("data-")||!Lr(t)&&(a&&o.includes(r)||Sge.includes(r))||n&&B3.includes(r)},xr=function(t,r,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(x.isValidElement(t)&&(a=t.props),!Eg(a))return null;var i={};return Object.keys(a).forEach(function(o){var l;kge((l=a)===null||l===void 0?void 0:l[o],o,r,n)&&(i[o]=a[o])}),i},E4=function s(t,r){if(t===r)return!0;var n=x.Children.count(t);if(n!==x.Children.count(r))return!1;if(n===0)return!0;if(n===1)return uT(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<n;a++){var i=t[a],o=r[a];if(Array.isArray(i)||Array.isArray(o)){if(!s(i,o))return!1}else if(!uT(i,o))return!1}return!0},uT=function(t,r){if(Fr(t)&&Fr(r))return!0;if(!Fr(t)&&!Fr(r)){var n=t.props||{},a=n.children,i=oT(n,Age),o=r.props||{},l=o.children,c=oT(o,Ege);return a&&l?sp(i,c)&&E4(a,l):!a&&!l?sp(i,c):!1}return!1},hT=function(t,r){var n=[],a={};return U3(t).forEach(function(i,o){if(_ge(i))n.push(i);else if(i){var l=rh(i.type),c=r[l]||{},d=c.handler,u=c.once;if(d&&(!u||!a[l])){var h=d(i,l,o);n.push(h),a[l]=!0}}}),n},Tge=function(t){var r=t&&t.type;return r&&lT[r]?lT[r]:null},Dge=function(t,r){return U3(r).indexOf(t)},Oge=["children","width","height","viewBox","className","style","title","desc"];function I4(){return I4=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},I4.apply(this,arguments)}function Rge(s,t){if(s==null)return{};var r=Fge(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function Fge(s,t){if(s==null)return{};var r={};for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n)){if(t.indexOf(n)>=0)continue;r[n]=s[n]}return r}function P4(s){var t=s.children,r=s.width,n=s.height,a=s.viewBox,i=s.className,o=s.style,l=s.title,c=s.desc,d=Rge(s,Oge),u=a||{width:r,height:n,x:0,y:0},h=Jr("recharts-surface",i);return xe.createElement("svg",I4({},xr(d,!0,"svg"),{className:h,width:r,height:n,style:o,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),xe.createElement("title",null,l),xe.createElement("desc",null,c),t)}var Mge=["children","className"];function _4(){return _4=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},_4.apply(this,arguments)}function Lge(s,t){if(s==null)return{};var r=$ge(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function $ge(s,t){if(s==null)return{};var r={};for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n)){if(t.indexOf(n)>=0)continue;r[n]=s[n]}return r}var mn=xe.forwardRef(function(s,t){var r=s.children,n=s.className,a=Lge(s,Mge),i=Jr("recharts-layer",n);return xe.createElement("g",_4({className:i},xr(a,!0),{ref:t}),r)}),kd=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function Bge(s,t,r){var n=-1,a=s.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(a);++n<a;)i[n]=s[n+t];return i}var Uge=Bge,zge=Uge;function qge(s,t,r){var n=s.length;return r=r===void 0?n:r,!t&&r>=n?s:zge(s,t,r)}var Vge=qge,Wge="\\ud800-\\udfff",Hge="\\u0300-\\u036f",Gge="\\ufe20-\\ufe2f",Kge="\\u20d0-\\u20ff",Yge=Hge+Gge+Kge,Jge="\\ufe0e\\ufe0f",Xge="\\u200d",Qge=RegExp("["+Xge+Wge+Yge+Jge+"]");function Zge(s){return Qge.test(s)}var oB=Zge;function e0e(s){return s.split("")}var t0e=e0e,lB="\\ud800-\\udfff",s0e="\\u0300-\\u036f",r0e="\\ufe20-\\ufe2f",n0e="\\u20d0-\\u20ff",a0e=s0e+r0e+n0e,i0e="\\ufe0e\\ufe0f",o0e="["+lB+"]",k4="["+a0e+"]",T4="\\ud83c[\\udffb-\\udfff]",l0e="(?:"+k4+"|"+T4+")",cB="[^"+lB+"]",dB="(?:\\ud83c[\\udde6-\\uddff]){2}",uB="[\\ud800-\\udbff][\\udc00-\\udfff]",c0e="\\u200d",hB=l0e+"?",mB="["+i0e+"]?",d0e="(?:"+c0e+"(?:"+[cB,dB,uB].join("|")+")"+mB+hB+")*",u0e=mB+hB+d0e,h0e="(?:"+[cB+k4+"?",k4,dB,uB,o0e].join("|")+")",m0e=RegExp(T4+"(?="+T4+")|"+h0e+u0e,"g");function f0e(s){return s.match(m0e)||[]}var x0e=f0e,p0e=t0e,g0e=oB,v0e=x0e;function y0e(s){return g0e(s)?v0e(s):p0e(s)}var j0e=y0e,b0e=Vge,N0e=oB,w0e=j0e,S0e=eB;function C0e(s){return function(t){t=S0e(t);var r=N0e(t)?w0e(t):void 0,n=r?r[0]:t.charAt(0),a=r?b0e(r,1).join(""):t.slice(1);return n[s]()+a}}var A0e=C0e,E0e=A0e,I0e=E0e("toUpperCase"),P0e=I0e;const $N=Ca(P0e);function Xa(s){return function(){return s}}const fB=Math.cos,O1=Math.sin,Ld=Math.sqrt,R1=Math.PI,BN=2*R1,D4=Math.PI,O4=2*D4,mf=1e-6,_0e=O4-mf;function xB(s){this._+=s[0];for(let t=1,r=s.length;t<r;++t)this._+=arguments[t]+s[t]}function k0e(s){let t=Math.floor(s);if(!(t>=0))throw new Error(`invalid digits: ${s}`);if(t>15)return xB;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class T0e{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?xB:k0e(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,o){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+o}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,l=this._y1,c=n-t,d=a-r,u=o-t,h=l-r,f=u*u+h*h;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(f>mf)if(!(Math.abs(h*c-d*u)>mf)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let m=n-o,p=a-l,g=c*c+d*d,v=m*m+p*p,y=Math.sqrt(g),j=Math.sqrt(f),b=i*Math.tan((D4-Math.acos((g+f-v)/(2*y*j)))/2),w=b/j,N=b/y;Math.abs(w-1)>mf&&this._append`L${t+w*u},${r+w*h}`,this._append`A${i},${i},0,0,${+(h*m>u*p)},${this._x1=t+N*c},${this._y1=r+N*d}`}}arc(t,r,n,a,i,o){if(t=+t,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),c=n*Math.sin(a),d=t+l,u=r+c,h=1^o,f=o?a-i:i-a;this._x1===null?this._append`M${d},${u}`:(Math.abs(this._x1-d)>mf||Math.abs(this._y1-u)>mf)&&this._append`L${d},${u}`,n&&(f<0&&(f=f%O4+O4),f>_0e?this._append`A${n},${n},0,1,${h},${t-l},${r-c}A${n},${n},0,1,${h},${this._x1=d},${this._y1=u}`:f>mf&&this._append`A${n},${n},0,${+(f>=D4)},${h},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function z3(s){let t=3;return s.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return s},()=>new T0e(t)}function q3(s){return typeof s=="object"&&"length"in s?s:Array.from(s)}function pB(s){this._context=s}pB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(s,t){switch(s=+s,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(s,t):this._context.moveTo(s,t);break;case 1:this._point=2;default:this._context.lineTo(s,t);break}}};function UN(s){return new pB(s)}function gB(s){return s[0]}function vB(s){return s[1]}function yB(s,t){var r=Xa(!0),n=null,a=UN,i=null,o=z3(l);s=typeof s=="function"?s:s===void 0?gB:Xa(s),t=typeof t=="function"?t:t===void 0?vB:Xa(t);function l(c){var d,u=(c=q3(c)).length,h,f=!1,m;for(n==null&&(i=a(m=o())),d=0;d<=u;++d)!(d<u&&r(h=c[d],d,c))===f&&((f=!f)?i.lineStart():i.lineEnd()),f&&i.point(+s(h,d,c),+t(h,d,c));if(m)return i=null,m+""||null}return l.x=function(c){return arguments.length?(s=typeof c=="function"?c:Xa(+c),l):s},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:Xa(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Xa(!!c),l):r},l.curve=function(c){return arguments.length?(a=c,n!=null&&(i=a(n)),l):a},l.context=function(c){return arguments.length?(c==null?n=i=null:i=a(n=c),l):n},l}function gj(s,t,r){var n=null,a=Xa(!0),i=null,o=UN,l=null,c=z3(d);s=typeof s=="function"?s:s===void 0?gB:Xa(+s),t=typeof t=="function"?t:Xa(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?vB:Xa(+r);function d(h){var f,m,p,g=(h=q3(h)).length,v,y=!1,j,b=new Array(g),w=new Array(g);for(i==null&&(l=o(j=c())),f=0;f<=g;++f){if(!(f<g&&a(v=h[f],f,h))===y)if(y=!y)m=f,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),p=f-1;p>=m;--p)l.point(b[p],w[p]);l.lineEnd(),l.areaEnd()}y&&(b[f]=+s(v,f,h),w[f]=+t(v,f,h),l.point(n?+n(v,f,h):b[f],r?+r(v,f,h):w[f]))}if(j)return l=null,j+""||null}function u(){return yB().defined(a).curve(o).context(i)}return d.x=function(h){return arguments.length?(s=typeof h=="function"?h:Xa(+h),n=null,d):s},d.x0=function(h){return arguments.length?(s=typeof h=="function"?h:Xa(+h),d):s},d.x1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:Xa(+h),d):n},d.y=function(h){return arguments.length?(t=typeof h=="function"?h:Xa(+h),r=null,d):t},d.y0=function(h){return arguments.length?(t=typeof h=="function"?h:Xa(+h),d):t},d.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:Xa(+h),d):r},d.lineX0=d.lineY0=function(){return u().x(s).y(t)},d.lineY1=function(){return u().x(s).y(r)},d.lineX1=function(){return u().x(n).y(t)},d.defined=function(h){return arguments.length?(a=typeof h=="function"?h:Xa(!!h),d):a},d.curve=function(h){return arguments.length?(o=h,i!=null&&(l=o(i)),d):o},d.context=function(h){return arguments.length?(h==null?i=l=null:l=o(i=h),d):i},d}class jB{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function D0e(s){return new jB(s,!0)}function O0e(s){return new jB(s,!1)}const V3={draw(s,t){const r=Ld(t/R1);s.moveTo(r,0),s.arc(0,0,r,0,BN)}},R0e={draw(s,t){const r=Ld(t/5)/2;s.moveTo(-3*r,-r),s.lineTo(-r,-r),s.lineTo(-r,-3*r),s.lineTo(r,-3*r),s.lineTo(r,-r),s.lineTo(3*r,-r),s.lineTo(3*r,r),s.lineTo(r,r),s.lineTo(r,3*r),s.lineTo(-r,3*r),s.lineTo(-r,r),s.lineTo(-3*r,r),s.closePath()}},bB=Ld(1/3),F0e=bB*2,M0e={draw(s,t){const r=Ld(t/F0e),n=r*bB;s.moveTo(0,-r),s.lineTo(n,0),s.lineTo(0,r),s.lineTo(-n,0),s.closePath()}},L0e={draw(s,t){const r=Ld(t),n=-r/2;s.rect(n,n,r,r)}},$0e=.8908130915292852,NB=O1(R1/10)/O1(7*R1/10),B0e=O1(BN/10)*NB,U0e=-fB(BN/10)*NB,z0e={draw(s,t){const r=Ld(t*$0e),n=B0e*r,a=U0e*r;s.moveTo(0,-r),s.lineTo(n,a);for(let i=1;i<5;++i){const o=BN*i/5,l=fB(o),c=O1(o);s.lineTo(c*r,-l*r),s.lineTo(l*n-c*a,c*n+l*a)}s.closePath()}},cS=Ld(3),q0e={draw(s,t){const r=-Ld(t/(cS*3));s.moveTo(0,r*2),s.lineTo(-cS*r,-r),s.lineTo(cS*r,-r),s.closePath()}},Lc=-.5,$c=Ld(3)/2,R4=1/Ld(12),V0e=(R4/2+1)*3,W0e={draw(s,t){const r=Ld(t/V0e),n=r/2,a=r*R4,i=n,o=r*R4+r,l=-i,c=o;s.moveTo(n,a),s.lineTo(i,o),s.lineTo(l,c),s.lineTo(Lc*n-$c*a,$c*n+Lc*a),s.lineTo(Lc*i-$c*o,$c*i+Lc*o),s.lineTo(Lc*l-$c*c,$c*l+Lc*c),s.lineTo(Lc*n+$c*a,Lc*a-$c*n),s.lineTo(Lc*i+$c*o,Lc*o-$c*i),s.lineTo(Lc*l+$c*c,Lc*c-$c*l),s.closePath()}};function H0e(s,t){let r=null,n=z3(a);s=typeof s=="function"?s:Xa(s||V3),t=typeof t=="function"?t:Xa(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),s.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(s=typeof i=="function"?i:Xa(i),a):s},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:Xa(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function F1(){}function M1(s,t,r){s._context.bezierCurveTo((2*s._x0+s._x1)/3,(2*s._y0+s._y1)/3,(s._x0+2*s._x1)/3,(s._y0+2*s._y1)/3,(s._x0+4*s._x1+t)/6,(s._y0+4*s._y1+r)/6)}function wB(s){this._context=s}wB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:M1(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(s,t){switch(s=+s,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(s,t):this._context.moveTo(s,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:M1(this,s,t);break}this._x0=this._x1,this._x1=s,this._y0=this._y1,this._y1=t}};function G0e(s){return new wB(s)}function SB(s){this._context=s}SB.prototype={areaStart:F1,areaEnd:F1,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(s,t){switch(s=+s,t=+t,this._point){case 0:this._point=1,this._x2=s,this._y2=t;break;case 1:this._point=2,this._x3=s,this._y3=t;break;case 2:this._point=3,this._x4=s,this._y4=t,this._context.moveTo((this._x0+4*this._x1+s)/6,(this._y0+4*this._y1+t)/6);break;default:M1(this,s,t);break}this._x0=this._x1,this._x1=s,this._y0=this._y1,this._y1=t}};function K0e(s){return new SB(s)}function CB(s){this._context=s}CB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(s,t){switch(s=+s,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+s)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:M1(this,s,t);break}this._x0=this._x1,this._x1=s,this._y0=this._y1,this._y1=t}};function Y0e(s){return new CB(s)}function AB(s){this._context=s}AB.prototype={areaStart:F1,areaEnd:F1,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(s,t){s=+s,t=+t,this._point?this._context.lineTo(s,t):(this._point=1,this._context.moveTo(s,t))}};function J0e(s){return new AB(s)}function mT(s){return s<0?-1:1}function fT(s,t,r){var n=s._x1-s._x0,a=t-s._x1,i=(s._y1-s._y0)/(n||a<0&&-0),o=(r-s._y1)/(a||n<0&&-0),l=(i*a+o*n)/(n+a);return(mT(i)+mT(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(l))||0}function xT(s,t){var r=s._x1-s._x0;return r?(3*(s._y1-s._y0)/r-t)/2:t}function dS(s,t,r){var n=s._x0,a=s._y0,i=s._x1,o=s._y1,l=(i-n)/3;s._context.bezierCurveTo(n+l,a+l*t,i-l,o-l*r,i,o)}function L1(s){this._context=s}L1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:dS(this,this._t0,xT(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(s,t){var r=NaN;if(s=+s,t=+t,!(s===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(s,t):this._context.moveTo(s,t);break;case 1:this._point=2;break;case 2:this._point=3,dS(this,xT(this,r=fT(this,s,t)),r);break;default:dS(this,this._t0,r=fT(this,s,t));break}this._x0=this._x1,this._x1=s,this._y0=this._y1,this._y1=t,this._t0=r}}};function EB(s){this._context=new IB(s)}(EB.prototype=Object.create(L1.prototype)).point=function(s,t){L1.prototype.point.call(this,t,s)};function IB(s){this._context=s}IB.prototype={moveTo:function(s,t){this._context.moveTo(t,s)},closePath:function(){this._context.closePath()},lineTo:function(s,t){this._context.lineTo(t,s)},bezierCurveTo:function(s,t,r,n,a,i){this._context.bezierCurveTo(t,s,n,r,i,a)}};function X0e(s){return new L1(s)}function Q0e(s){return new EB(s)}function PB(s){this._context=s}PB.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var s=this._x,t=this._y,r=s.length;if(r)if(this._line?this._context.lineTo(s[0],t[0]):this._context.moveTo(s[0],t[0]),r===2)this._context.lineTo(s[1],t[1]);else for(var n=pT(s),a=pT(t),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],s[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(s,t){this._x.push(+s),this._y.push(+t)}};function pT(s){var t,r=s.length-1,n,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=s[0]+2*s[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*s[t]+2*s[t+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*s[r-1]+s[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[r-1]=(s[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*s[t+1]-a[t+1];return[a,i]}function Z0e(s){return new PB(s)}function zN(s,t){this._context=s,this._t=t}zN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(s,t){switch(s=+s,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(s,t):this._context.moveTo(s,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(s,t);else{var r=this._x*(1-this._t)+s*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=s,this._y=t}};function eve(s){return new zN(s,.5)}function tve(s){return new zN(s,0)}function sve(s){return new zN(s,1)}function Mp(s,t){if((o=s.length)>1)for(var r=1,n,a,i=s[t[0]],o,l=i.length;r<o;++r)for(a=i,i=s[t[r]],n=0;n<l;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function F4(s){for(var t=s.length,r=new Array(t);--t>=0;)r[t]=t;return r}function rve(s,t){return s[t]}function nve(s){const t=[];return t.key=s,t}function ave(){var s=Xa([]),t=F4,r=Mp,n=rve;function a(i){var o=Array.from(s.apply(this,arguments),nve),l,c=o.length,d=-1,u;for(const h of i)for(l=0,++d;l<c;++l)(o[l][d]=[0,+n(h,o[l].key,d,i)]).data=h;for(l=0,u=q3(t(o));l<c;++l)o[u[l]].index=l;return r(o,u),o}return a.keys=function(i){return arguments.length?(s=typeof i=="function"?i:Xa(Array.from(i)),a):s},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:Xa(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?F4:typeof i=="function"?i:Xa(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??Mp,a):r},a}function ive(s,t){if((n=s.length)>0){for(var r,n,a=0,i=s[0].length,o;a<i;++a){for(o=r=0;r<n;++r)o+=s[r][a][1]||0;if(o)for(r=0;r<n;++r)s[r][a][1]/=o}Mp(s,t)}}function ove(s,t){if((a=s.length)>0){for(var r=0,n=s[t[0]],a,i=n.length;r<i;++r){for(var o=0,l=0;o<a;++o)l+=s[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}Mp(s,t)}}function lve(s,t){if(!(!((o=s.length)>0)||!((i=(a=s[t[0]]).length)>0))){for(var r=0,n=1,a,i,o;n<i;++n){for(var l=0,c=0,d=0;l<o;++l){for(var u=s[t[l]],h=u[n][1]||0,f=u[n-1][1]||0,m=(h-f)/2,p=0;p<l;++p){var g=s[t[p]],v=g[n][1]||0,y=g[n-1][1]||0;m+=v-y}c+=h,d+=m*h}a[n-1][1]+=a[n-1][0]=r,c&&(r-=d/c)}a[n-1][1]+=a[n-1][0]=r,Mp(s,t)}}function hv(s){"@babel/helpers - typeof";return hv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hv(s)}var cve=["type","size","sizeType"];function M4(){return M4=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},M4.apply(this,arguments)}function gT(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function vT(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gT(Object(r),!0).forEach(function(n){dve(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):gT(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function dve(s,t,r){return t=uve(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function uve(s){var t=hve(s,"string");return hv(t)=="symbol"?t:t+""}function hve(s,t){if(hv(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(hv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function mve(s,t){if(s==null)return{};var r=fve(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function fve(s,t){if(s==null)return{};var r={};for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n)){if(t.indexOf(n)>=0)continue;r[n]=s[n]}return r}var _B={symbolCircle:V3,symbolCross:R0e,symbolDiamond:M0e,symbolSquare:L0e,symbolStar:z0e,symbolTriangle:q0e,symbolWye:W0e},xve=Math.PI/180,pve=function(t){var r="symbol".concat($N(t));return _B[r]||V3},gve=function(t,r,n){if(r==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*xve;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},vve=function(t,r){_B["symbol".concat($N(t))]=r},qN=function(t){var r=t.type,n=r===void 0?"circle":r,a=t.size,i=a===void 0?64:a,o=t.sizeType,l=o===void 0?"area":o,c=mve(t,cve),d=vT(vT({},c),{},{type:n,size:i,sizeType:l}),u=function(){var v=pve(n),y=H0e().type(v).size(gve(i,l,n));return y()},h=d.className,f=d.cx,m=d.cy,p=xr(d,!0);return f===+f&&m===+m&&i===+i?xe.createElement("path",M4({},p,{className:Jr("recharts-symbols",h),transform:"translate(".concat(f,", ").concat(m,")"),d:u()})):null};qN.registerSymbol=vve;function Lp(s){"@babel/helpers - typeof";return Lp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lp(s)}function L4(){return L4=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},L4.apply(this,arguments)}function yT(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function yve(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yT(Object(r),!0).forEach(function(n){mv(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):yT(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function jve(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function bve(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,TB(n.key),n)}}function Nve(s,t,r){return t&&bve(s.prototype,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function wve(s,t,r){return t=$1(t),Sve(s,kB()?Reflect.construct(t,r||[],$1(s).constructor):t.apply(s,r))}function Sve(s,t){if(t&&(Lp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cve(s)}function Cve(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function kB(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kB=function(){return!!s})()}function $1(s){return $1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$1(s)}function Ave(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&$4(s,t)}function $4(s,t){return $4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},$4(s,t)}function mv(s,t,r){return t=TB(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function TB(s){var t=Eve(s,"string");return Lp(t)=="symbol"?t:t+""}function Eve(s,t){if(Lp(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Lp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}var Bc=32,W3=function(s){function t(){return jve(this,t),wve(this,t,arguments)}return Ave(t,s),Nve(t,[{key:"renderIcon",value:function(n){var a=this.props.inactiveColor,i=Bc/2,o=Bc/6,l=Bc/3,c=n.inactive?a:n.color;if(n.type==="plainline")return xe.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:n.payload.strokeDasharray,x1:0,y1:i,x2:Bc,y2:i,className:"recharts-legend-icon"});if(n.type==="line")return xe.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(i,"h").concat(l,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*l,",").concat(i,`
            H`).concat(Bc,"M").concat(2*l,",").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(l,",").concat(i),className:"recharts-legend-icon"});if(n.type==="rect")return xe.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(Bc/8,"h").concat(Bc,"v").concat(Bc*3/4,"h").concat(-Bc,"z"),className:"recharts-legend-icon"});if(xe.isValidElement(n.legendIcon)){var d=yve({},n);return delete d.legendIcon,xe.cloneElement(n.legendIcon,d)}return xe.createElement(qN,{fill:c,cx:i,cy:i,size:Bc,sizeType:"diameter",type:n.type})}},{key:"renderItems",value:function(){var n=this,a=this.props,i=a.payload,o=a.iconSize,l=a.layout,c=a.formatter,d=a.inactiveColor,u={x:0,y:0,width:Bc,height:Bc},h={display:l==="horizontal"?"inline-block":"block",marginRight:10},f={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(m,p){var g=m.formatter||c,v=Jr(mv(mv({"recharts-legend-item":!0},"legend-item-".concat(p),!0),"inactive",m.inactive));if(m.type==="none")return null;var y=Lr(m.value)?null:m.value;kd(!Lr(m.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var j=m.inactive?d:m.color;return xe.createElement("li",L4({className:v,style:h,key:"legend-item-".concat(p)},Mm(n.props,m,p)),xe.createElement(P4,{width:o,height:o,viewBox:u,style:f},n.renderIcon(m)),xe.createElement("span",{className:"recharts-legend-item-text",style:{color:j}},g?g(y,m,p):y))})}},{key:"render",value:function(){var n=this.props,a=n.payload,i=n.layout,o=n.align;if(!a||!a.length)return null;var l={padding:0,margin:0,textAlign:i==="horizontal"?o:"left"};return xe.createElement("ul",{className:"recharts-default-legend",style:l},this.renderItems())}}])}(x.PureComponent);mv(W3,"displayName","Legend");mv(W3,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var Ive=AN;function Pve(){this.__data__=new Ive,this.size=0}var _ve=Pve;function kve(s){var t=this.__data__,r=t.delete(s);return this.size=t.size,r}var Tve=kve;function Dve(s){return this.__data__.get(s)}var Ove=Dve;function Rve(s){return this.__data__.has(s)}var Fve=Rve,Mve=AN,Lve=D3,$ve=O3,Bve=200;function Uve(s,t){var r=this.__data__;if(r instanceof Mve){var n=r.__data__;if(!Lve||n.length<Bve-1)return n.push([s,t]),this.size=++r.size,this;r=this.__data__=new $ve(n)}return r.set(s,t),this.size=r.size,this}var zve=Uve,qve=AN,Vve=_ve,Wve=Tve,Hve=Ove,Gve=Fve,Kve=zve;function Tg(s){var t=this.__data__=new qve(s);this.size=t.size}Tg.prototype.clear=Vve;Tg.prototype.delete=Wve;Tg.prototype.get=Hve;Tg.prototype.has=Gve;Tg.prototype.set=Kve;var DB=Tg,Yve="__lodash_hash_undefined__";function Jve(s){return this.__data__.set(s,Yve),this}var Xve=Jve;function Qve(s){return this.__data__.has(s)}var Zve=Qve,eye=O3,tye=Xve,sye=Zve;function B1(s){var t=-1,r=s==null?0:s.length;for(this.__data__=new eye;++t<r;)this.add(s[t])}B1.prototype.add=B1.prototype.push=tye;B1.prototype.has=sye;var OB=B1;function rye(s,t){for(var r=-1,n=s==null?0:s.length;++r<n;)if(t(s[r],r,s))return!0;return!1}var RB=rye;function nye(s,t){return s.has(t)}var FB=nye,aye=OB,iye=RB,oye=FB,lye=1,cye=2;function dye(s,t,r,n,a,i){var o=r&lye,l=s.length,c=t.length;if(l!=c&&!(o&&c>l))return!1;var d=i.get(s),u=i.get(t);if(d&&u)return d==t&&u==s;var h=-1,f=!0,m=r&cye?new aye:void 0;for(i.set(s,t),i.set(t,s);++h<l;){var p=s[h],g=t[h];if(n)var v=o?n(g,p,h,t,s,i):n(p,g,h,s,t,i);if(v!==void 0){if(v)continue;f=!1;break}if(m){if(!iye(t,function(y,j){if(!oye(m,j)&&(p===y||a(p,y,r,n,i)))return m.push(j)})){f=!1;break}}else if(!(p===g||a(p,g,r,n,i))){f=!1;break}}return i.delete(s),i.delete(t),f}var MB=dye,uye=ju,hye=uye.Uint8Array,mye=hye;function fye(s){var t=-1,r=Array(s.size);return s.forEach(function(n,a){r[++t]=[a,n]}),r}var xye=fye;function pye(s){var t=-1,r=Array(s.size);return s.forEach(function(n){r[++t]=n}),r}var H3=pye,jT=my,bT=mye,gye=T3,vye=MB,yye=xye,jye=H3,bye=1,Nye=2,wye="[object Boolean]",Sye="[object Date]",Cye="[object Error]",Aye="[object Map]",Eye="[object Number]",Iye="[object RegExp]",Pye="[object Set]",_ye="[object String]",kye="[object Symbol]",Tye="[object ArrayBuffer]",Dye="[object DataView]",NT=jT?jT.prototype:void 0,uS=NT?NT.valueOf:void 0;function Oye(s,t,r,n,a,i,o){switch(r){case Dye:if(s.byteLength!=t.byteLength||s.byteOffset!=t.byteOffset)return!1;s=s.buffer,t=t.buffer;case Tye:return!(s.byteLength!=t.byteLength||!i(new bT(s),new bT(t)));case wye:case Sye:case Eye:return gye(+s,+t);case Cye:return s.name==t.name&&s.message==t.message;case Iye:case _ye:return s==t+"";case Aye:var l=yye;case Pye:var c=n&bye;if(l||(l=jye),s.size!=t.size&&!c)return!1;var d=o.get(s);if(d)return d==t;n|=Nye,o.set(s,t);var u=vye(l(s),l(t),n,a,i,o);return o.delete(s),u;case kye:if(uS)return uS.call(s)==uS.call(t)}return!1}var Rye=Oye;function Fye(s,t){for(var r=-1,n=t.length,a=s.length;++r<n;)s[a+r]=t[r];return s}var LB=Fye,Mye=LB,Lye=cc;function $ye(s,t,r){var n=t(s);return Lye(s)?n:Mye(n,r(s))}var Bye=$ye;function Uye(s,t){for(var r=-1,n=s==null?0:s.length,a=0,i=[];++r<n;){var o=s[r];t(o,r,s)&&(i[a++]=o)}return i}var zye=Uye;function qye(){return[]}var Vye=qye,Wye=zye,Hye=Vye,Gye=Object.prototype,Kye=Gye.propertyIsEnumerable,wT=Object.getOwnPropertySymbols,Yye=wT?function(s){return s==null?[]:(s=Object(s),Wye(wT(s),function(t){return Kye.call(s,t)}))}:Hye,Jye=Yye;function Xye(s,t){for(var r=-1,n=Array(s);++r<s;)n[r]=t(r);return n}var Qye=Xye,Zye=gh,eje=vh,tje="[object Arguments]";function sje(s){return eje(s)&&Zye(s)==tje}var rje=sje,ST=rje,nje=vh,$B=Object.prototype,aje=$B.hasOwnProperty,ije=$B.propertyIsEnumerable,oje=ST(function(){return arguments}())?ST:function(s){return nje(s)&&aje.call(s,"callee")&&!ije.call(s,"callee")},G3=oje,U1={exports:{}};function lje(){return!1}var cje=lje;U1.exports;(function(s,t){var r=ju,n=cje,a=t&&!t.nodeType&&t,i=a&&!0&&s&&!s.nodeType&&s,o=i&&i.exports===a,l=o?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||n;s.exports=d})(U1,U1.exports);var BB=U1.exports,dje=9007199254740991,uje=/^(?:0|[1-9]\d*)$/;function hje(s,t){var r=typeof s;return t=t??dje,!!t&&(r=="number"||r!="symbol"&&uje.test(s))&&s>-1&&s%1==0&&s<t}var K3=hje,mje=9007199254740991;function fje(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=mje}var Y3=fje,xje=gh,pje=Y3,gje=vh,vje="[object Arguments]",yje="[object Array]",jje="[object Boolean]",bje="[object Date]",Nje="[object Error]",wje="[object Function]",Sje="[object Map]",Cje="[object Number]",Aje="[object Object]",Eje="[object RegExp]",Ije="[object Set]",Pje="[object String]",_je="[object WeakMap]",kje="[object ArrayBuffer]",Tje="[object DataView]",Dje="[object Float32Array]",Oje="[object Float64Array]",Rje="[object Int8Array]",Fje="[object Int16Array]",Mje="[object Int32Array]",Lje="[object Uint8Array]",$je="[object Uint8ClampedArray]",Bje="[object Uint16Array]",Uje="[object Uint32Array]",oi={};oi[Dje]=oi[Oje]=oi[Rje]=oi[Fje]=oi[Mje]=oi[Lje]=oi[$je]=oi[Bje]=oi[Uje]=!0;oi[vje]=oi[yje]=oi[kje]=oi[jje]=oi[Tje]=oi[bje]=oi[Nje]=oi[wje]=oi[Sje]=oi[Cje]=oi[Aje]=oi[Eje]=oi[Ije]=oi[Pje]=oi[_je]=!1;function zje(s){return gje(s)&&pje(s.length)&&!!oi[xje(s)]}var qje=zje;function Vje(s){return function(t){return s(t)}}var UB=Vje,z1={exports:{}};z1.exports;(function(s,t){var r=K9,n=t&&!t.nodeType&&t,a=n&&!0&&s&&!s.nodeType&&s,i=a&&a.exports===n,o=i&&r.process,l=function(){try{var c=a&&a.require&&a.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}}();s.exports=l})(z1,z1.exports);var Wje=z1.exports,Hje=qje,Gje=UB,CT=Wje,AT=CT&&CT.isTypedArray,Kje=AT?Gje(AT):Hje,zB=Kje,Yje=Qye,Jje=G3,Xje=cc,Qje=BB,Zje=K3,e1e=zB,t1e=Object.prototype,s1e=t1e.hasOwnProperty;function r1e(s,t){var r=Xje(s),n=!r&&Jje(s),a=!r&&!n&&Qje(s),i=!r&&!n&&!a&&e1e(s),o=r||n||a||i,l=o?Yje(s.length,String):[],c=l.length;for(var d in s)(t||s1e.call(s,d))&&!(o&&(d=="length"||a&&(d=="offset"||d=="parent")||i&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||Zje(d,c)))&&l.push(d);return l}var n1e=r1e,a1e=Object.prototype;function i1e(s){var t=s&&s.constructor,r=typeof t=="function"&&t.prototype||a1e;return s===r}var o1e=i1e;function l1e(s,t){return function(r){return s(t(r))}}var qB=l1e,c1e=qB,d1e=c1e(Object.keys,Object),u1e=d1e,h1e=o1e,m1e=u1e,f1e=Object.prototype,x1e=f1e.hasOwnProperty;function p1e(s){if(!h1e(s))return m1e(s);var t=[];for(var r in Object(s))x1e.call(s,r)&&r!="constructor"&&t.push(r);return t}var g1e=p1e,v1e=k3,y1e=Y3;function j1e(s){return s!=null&&y1e(s.length)&&!v1e(s)}var fy=j1e,b1e=n1e,N1e=g1e,w1e=fy;function S1e(s){return w1e(s)?b1e(s):N1e(s)}var VN=S1e,C1e=Bye,A1e=Jye,E1e=VN;function I1e(s){return C1e(s,E1e,A1e)}var P1e=I1e,ET=P1e,_1e=1,k1e=Object.prototype,T1e=k1e.hasOwnProperty;function D1e(s,t,r,n,a,i){var o=r&_1e,l=ET(s),c=l.length,d=ET(t),u=d.length;if(c!=u&&!o)return!1;for(var h=c;h--;){var f=l[h];if(!(o?f in t:T1e.call(t,f)))return!1}var m=i.get(s),p=i.get(t);if(m&&p)return m==t&&p==s;var g=!0;i.set(s,t),i.set(t,s);for(var v=o;++h<c;){f=l[h];var y=s[f],j=t[f];if(n)var b=o?n(j,y,f,t,s,i):n(y,j,f,s,t,i);if(!(b===void 0?y===j||a(y,j,r,n,i):b)){g=!1;break}v||(v=f=="constructor")}if(g&&!v){var w=s.constructor,N=t.constructor;w!=N&&"constructor"in s&&"constructor"in t&&!(typeof w=="function"&&w instanceof w&&typeof N=="function"&&N instanceof N)&&(g=!1)}return i.delete(s),i.delete(t),g}var O1e=D1e,R1e=xx,F1e=ju,M1e=R1e(F1e,"DataView"),L1e=M1e,$1e=xx,B1e=ju,U1e=$1e(B1e,"Promise"),z1e=U1e,q1e=xx,V1e=ju,W1e=q1e(V1e,"Set"),VB=W1e,H1e=xx,G1e=ju,K1e=H1e(G1e,"WeakMap"),Y1e=K1e,B4=L1e,U4=D3,z4=z1e,q4=VB,V4=Y1e,WB=gh,Dg=J9,IT="[object Map]",J1e="[object Object]",PT="[object Promise]",_T="[object Set]",kT="[object WeakMap]",TT="[object DataView]",X1e=Dg(B4),Q1e=Dg(U4),Z1e=Dg(z4),ebe=Dg(q4),tbe=Dg(V4),ff=WB;(B4&&ff(new B4(new ArrayBuffer(1)))!=TT||U4&&ff(new U4)!=IT||z4&&ff(z4.resolve())!=PT||q4&&ff(new q4)!=_T||V4&&ff(new V4)!=kT)&&(ff=function(s){var t=WB(s),r=t==J1e?s.constructor:void 0,n=r?Dg(r):"";if(n)switch(n){case X1e:return TT;case Q1e:return IT;case Z1e:return PT;case ebe:return _T;case tbe:return kT}return t});var sbe=ff,hS=DB,rbe=MB,nbe=Rye,abe=O1e,DT=sbe,OT=cc,RT=BB,ibe=zB,obe=1,FT="[object Arguments]",MT="[object Array]",vj="[object Object]",lbe=Object.prototype,LT=lbe.hasOwnProperty;function cbe(s,t,r,n,a,i){var o=OT(s),l=OT(t),c=o?MT:DT(s),d=l?MT:DT(t);c=c==FT?vj:c,d=d==FT?vj:d;var u=c==vj,h=d==vj,f=c==d;if(f&&RT(s)){if(!RT(t))return!1;o=!0,u=!1}if(f&&!u)return i||(i=new hS),o||ibe(s)?rbe(s,t,r,n,a,i):nbe(s,t,c,r,n,a,i);if(!(r&obe)){var m=u&&LT.call(s,"__wrapped__"),p=h&&LT.call(t,"__wrapped__");if(m||p){var g=m?s.value():s,v=p?t.value():t;return i||(i=new hS),a(g,v,r,n,i)}}return f?(i||(i=new hS),abe(s,t,r,n,a,i)):!1}var dbe=cbe,ube=dbe,$T=vh;function HB(s,t,r,n,a){return s===t?!0:s==null||t==null||!$T(s)&&!$T(t)?s!==s&&t!==t:ube(s,t,r,n,HB,a)}var J3=HB,hbe=DB,mbe=J3,fbe=1,xbe=2;function pbe(s,t,r,n){var a=r.length,i=a,o=!n;if(s==null)return!i;for(s=Object(s);a--;){var l=r[a];if(o&&l[2]?l[1]!==s[l[0]]:!(l[0]in s))return!1}for(;++a<i;){l=r[a];var c=l[0],d=s[c],u=l[1];if(o&&l[2]){if(d===void 0&&!(c in s))return!1}else{var h=new hbe;if(n)var f=n(d,u,c,s,t,h);if(!(f===void 0?mbe(u,d,fbe|xbe,n,h):f))return!1}}return!0}var gbe=pbe,vbe=Wm;function ybe(s){return s===s&&!vbe(s)}var GB=ybe,jbe=GB,bbe=VN;function Nbe(s){for(var t=bbe(s),r=t.length;r--;){var n=t[r],a=s[n];t[r]=[n,a,jbe(a)]}return t}var wbe=Nbe;function Sbe(s,t){return function(r){return r==null?!1:r[s]===t&&(t!==void 0||s in Object(r))}}var KB=Sbe,Cbe=gbe,Abe=wbe,Ebe=KB;function Ibe(s){var t=Abe(s);return t.length==1&&t[0][2]?Ebe(t[0][0],t[0][1]):function(r){return r===s||Cbe(r,s,t)}}var Pbe=Ibe;function _be(s,t){return s!=null&&t in Object(s)}var kbe=_be,Tbe=tB,Dbe=G3,Obe=cc,Rbe=K3,Fbe=Y3,Mbe=IN;function Lbe(s,t,r){t=Tbe(t,s);for(var n=-1,a=t.length,i=!1;++n<a;){var o=Mbe(t[n]);if(!(i=s!=null&&r(s,o)))break;s=s[o]}return i||++n!=a?i:(a=s==null?0:s.length,!!a&&Fbe(a)&&Rbe(o,a)&&(Obe(s)||Dbe(s)))}var $be=Lbe,Bbe=kbe,Ube=$be;function zbe(s,t){return s!=null&&Ube(s,t,Bbe)}var qbe=zbe,Vbe=J3,Wbe=sB,Hbe=qbe,Gbe=_3,Kbe=GB,Ybe=KB,Jbe=IN,Xbe=1,Qbe=2;function Zbe(s,t){return Gbe(s)&&Kbe(t)?Ybe(Jbe(s),t):function(r){var n=Wbe(r,s);return n===void 0&&n===t?Hbe(r,s):Vbe(t,n,Xbe|Qbe)}}var eNe=Zbe;function tNe(s){return s}var Og=tNe;function sNe(s){return function(t){return t==null?void 0:t[s]}}var rNe=sNe,nNe=M3;function aNe(s){return function(t){return nNe(t,s)}}var iNe=aNe,oNe=rNe,lNe=iNe,cNe=_3,dNe=IN;function uNe(s){return cNe(s)?oNe(dNe(s)):lNe(s)}var hNe=uNe,mNe=Pbe,fNe=eNe,xNe=Og,pNe=cc,gNe=hNe;function vNe(s){return typeof s=="function"?s:s==null?xNe:typeof s=="object"?pNe(s)?fNe(s[0],s[1]):mNe(s):gNe(s)}var bu=vNe;function yNe(s,t,r,n){for(var a=s.length,i=r+(n?1:-1);n?i--:++i<a;)if(t(s[i],i,s))return i;return-1}var YB=yNe;function jNe(s){return s!==s}var bNe=jNe;function NNe(s,t,r){for(var n=r-1,a=s.length;++n<a;)if(s[n]===t)return n;return-1}var wNe=NNe,SNe=YB,CNe=bNe,ANe=wNe;function ENe(s,t,r){return t===t?ANe(s,t,r):SNe(s,CNe,r)}var INe=ENe,PNe=INe;function _Ne(s,t){var r=s==null?0:s.length;return!!r&&PNe(s,t,0)>-1}var kNe=_Ne;function TNe(s,t,r){for(var n=-1,a=s==null?0:s.length;++n<a;)if(r(t,s[n]))return!0;return!1}var DNe=TNe;function ONe(){}var RNe=ONe,mS=VB,FNe=RNe,MNe=H3,LNe=1/0,$Ne=mS&&1/MNe(new mS([,-0]))[1]==LNe?function(s){return new mS(s)}:FNe,BNe=$Ne,UNe=OB,zNe=kNe,qNe=DNe,VNe=FB,WNe=BNe,HNe=H3,GNe=200;function KNe(s,t,r){var n=-1,a=zNe,i=s.length,o=!0,l=[],c=l;if(r)o=!1,a=qNe;else if(i>=GNe){var d=t?null:WNe(s);if(d)return HNe(d);o=!1,a=VNe,c=new UNe}else c=t?[]:l;e:for(;++n<i;){var u=s[n],h=t?t(u):u;if(u=r||u!==0?u:0,o&&h===h){for(var f=c.length;f--;)if(c[f]===h)continue e;t&&c.push(h),l.push(u)}else a(c,h,r)||(c!==l&&c.push(h),l.push(u))}return l}var YNe=KNe,JNe=bu,XNe=YNe;function QNe(s,t){return s&&s.length?XNe(s,JNe(t)):[]}var ZNe=QNe;const BT=Ca(ZNe);function JB(s,t,r){return t===!0?BT(s,r):Lr(t)?BT(s,t):s}function $p(s){"@babel/helpers - typeof";return $p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$p(s)}var ewe=["ref"];function UT(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function Ou(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?UT(Object(r),!0).forEach(function(n){WN(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):UT(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function twe(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function zT(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,QB(n.key),n)}}function swe(s,t,r){return t&&zT(s.prototype,t),r&&zT(s,r),Object.defineProperty(s,"prototype",{writable:!1}),s}function rwe(s,t,r){return t=q1(t),nwe(s,XB()?Reflect.construct(t,r||[],q1(s).constructor):t.apply(s,r))}function nwe(s,t){if(t&&($p(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return awe(s)}function awe(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function XB(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(XB=function(){return!!s})()}function q1(s){return q1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},q1(s)}function iwe(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&W4(s,t)}function W4(s,t){return W4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},W4(s,t)}function WN(s,t,r){return t=QB(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function QB(s){var t=owe(s,"string");return $p(t)=="symbol"?t:t+""}function owe(s,t){if($p(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if($p(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}function lwe(s,t){if(s==null)return{};var r=cwe(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function cwe(s,t){if(s==null)return{};var r={};for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n)){if(t.indexOf(n)>=0)continue;r[n]=s[n]}return r}function dwe(s){return s.value}function uwe(s,t){if(xe.isValidElement(s))return xe.cloneElement(s,t);if(typeof s=="function")return xe.createElement(s,t);t.ref;var r=lwe(t,ewe);return xe.createElement(W3,r)}var qT=1,rp=function(s){function t(){var r;twe(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=rwe(this,t,[].concat(a)),WN(r,"lastBoundingBox",{width:-1,height:-1}),r}return iwe(t,s),swe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();return n.height=this.wrapperNode.offsetHeight,n.width=this.wrapperNode.offsetWidth,n}return null}},{key:"updateBBox",value:function(){var n=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>qT||Math.abs(a.height-this.lastBoundingBox.height)>qT)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,n&&n(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,n&&n(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Ou({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(n){var a=this.props,i=a.layout,o=a.align,l=a.verticalAlign,c=a.margin,d=a.chartWidth,u=a.chartHeight,h,f;if(!n||(n.left===void 0||n.left===null)&&(n.right===void 0||n.right===null))if(o==="center"&&i==="vertical"){var m=this.getBBoxSnapshot();h={left:((d||0)-m.width)/2}}else h=o==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!n||(n.top===void 0||n.top===null)&&(n.bottom===void 0||n.bottom===null))if(l==="middle"){var p=this.getBBoxSnapshot();f={top:((u||0)-p.height)/2}}else f=l==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return Ou(Ou({},h),f)}},{key:"render",value:function(){var n=this,a=this.props,i=a.content,o=a.width,l=a.height,c=a.wrapperStyle,d=a.payloadUniqBy,u=a.payload,h=Ou(Ou({position:"absolute",width:o||"auto",height:l||"auto"},this.getDefaultPosition(c)),c);return xe.createElement("div",{className:"recharts-legend-wrapper",style:h,ref:function(m){n.wrapperNode=m}},uwe(i,Ou(Ou({},this.props),{},{payload:JB(u,d,dwe)})))}}],[{key:"getWithHeight",value:function(n,a){var i=Ou(Ou({},this.defaultProps),n.props),o=i.layout;return o==="vertical"&&ks(n.props.height)?{height:n.props.height}:o==="horizontal"?{width:n.props.width||a}:null}}])}(x.PureComponent);WN(rp,"displayName","Legend");WN(rp,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var VT=my,hwe=G3,mwe=cc,WT=VT?VT.isConcatSpreadable:void 0;function fwe(s){return mwe(s)||hwe(s)||!!(WT&&s&&s[WT])}var xwe=fwe,pwe=LB,gwe=xwe;function ZB(s,t,r,n,a){var i=-1,o=s.length;for(r||(r=gwe),a||(a=[]);++i<o;){var l=s[i];t>0&&r(l)?t>1?ZB(l,t-1,r,n,a):pwe(a,l):n||(a[a.length]=l)}return a}var eU=ZB;function vwe(s){return function(t,r,n){for(var a=-1,i=Object(t),o=n(t),l=o.length;l--;){var c=o[s?l:++a];if(r(i[c],c,i)===!1)break}return t}}var ywe=vwe,jwe=ywe,bwe=jwe(),Nwe=bwe,wwe=Nwe,Swe=VN;function Cwe(s,t){return s&&wwe(s,t,Swe)}var tU=Cwe,Awe=fy;function Ewe(s,t){return function(r,n){if(r==null)return r;if(!Awe(r))return s(r,n);for(var a=r.length,i=t?a:-1,o=Object(r);(t?i--:++i<a)&&n(o[i],i,o)!==!1;);return r}}var Iwe=Ewe,Pwe=tU,_we=Iwe,kwe=_we(Pwe),X3=kwe,Twe=X3,Dwe=fy;function Owe(s,t){var r=-1,n=Dwe(s)?Array(s.length):[];return Twe(s,function(a,i,o){n[++r]=t(a,i,o)}),n}var sU=Owe;function Rwe(s,t){var r=s.length;for(s.sort(t);r--;)s[r]=s[r].value;return s}var Fwe=Rwe,HT=Ag;function Mwe(s,t){if(s!==t){var r=s!==void 0,n=s===null,a=s===s,i=HT(s),o=t!==void 0,l=t===null,c=t===t,d=HT(t);if(!l&&!d&&!i&&s>t||i&&o&&c&&!l&&!d||n&&o&&c||!r&&c||!a)return 1;if(!n&&!i&&!d&&s<t||d&&r&&a&&!n&&!i||l&&r&&a||!o&&a||!c)return-1}return 0}var Lwe=Mwe,$we=Lwe;function Bwe(s,t,r){for(var n=-1,a=s.criteria,i=t.criteria,o=a.length,l=r.length;++n<o;){var c=$we(a[n],i[n]);if(c){if(n>=l)return c;var d=r[n];return c*(d=="desc"?-1:1)}}return s.index-t.index}var Uwe=Bwe,fS=F3,zwe=M3,qwe=bu,Vwe=sU,Wwe=Fwe,Hwe=UB,Gwe=Uwe,Kwe=Og,Ywe=cc;function Jwe(s,t,r){t.length?t=fS(t,function(i){return Ywe(i)?function(o){return zwe(o,i.length===1?i[0]:i)}:i}):t=[Kwe];var n=-1;t=fS(t,Hwe(qwe));var a=Vwe(s,function(i,o,l){var c=fS(t,function(d){return d(i)});return{criteria:c,index:++n,value:i}});return Wwe(a,function(i,o){return Gwe(i,o,r)})}var Xwe=Jwe;function Qwe(s,t,r){switch(r.length){case 0:return s.call(t);case 1:return s.call(t,r[0]);case 2:return s.call(t,r[0],r[1]);case 3:return s.call(t,r[0],r[1],r[2])}return s.apply(t,r)}var Zwe=Qwe,e2e=Zwe,GT=Math.max;function t2e(s,t,r){return t=GT(t===void 0?s.length-1:t,0),function(){for(var n=arguments,a=-1,i=GT(n.length-t,0),o=Array(i);++a<i;)o[a]=n[t+a];a=-1;for(var l=Array(t+1);++a<t;)l[a]=n[a];return l[t]=r(o),e2e(s,this,l)}}var s2e=t2e;function r2e(s){return function(){return s}}var n2e=r2e,a2e=xx,i2e=function(){try{var s=a2e(Object,"defineProperty");return s({},"",{}),s}catch{}}(),rU=i2e,o2e=n2e,KT=rU,l2e=Og,c2e=KT?function(s,t){return KT(s,"toString",{configurable:!0,enumerable:!1,value:o2e(t),writable:!0})}:l2e,d2e=c2e,u2e=800,h2e=16,m2e=Date.now;function f2e(s){var t=0,r=0;return function(){var n=m2e(),a=h2e-(n-r);if(r=n,a>0){if(++t>=u2e)return arguments[0]}else t=0;return s.apply(void 0,arguments)}}var x2e=f2e,p2e=d2e,g2e=x2e,v2e=g2e(p2e),y2e=v2e,j2e=Og,b2e=s2e,N2e=y2e;function w2e(s,t){return N2e(b2e(s,t,j2e),s+"")}var S2e=w2e,C2e=T3,A2e=fy,E2e=K3,I2e=Wm;function P2e(s,t,r){if(!I2e(r))return!1;var n=typeof t;return(n=="number"?A2e(r)&&E2e(t,r.length):n=="string"&&t in r)?C2e(r[t],s):!1}var HN=P2e,_2e=eU,k2e=Xwe,T2e=S2e,YT=HN,D2e=T2e(function(s,t){if(s==null)return[];var r=t.length;return r>1&&YT(s,t[0],t[1])?t=[]:r>2&&YT(t[0],t[1],t[2])&&(t=[t[0]]),k2e(s,_2e(t,1),[])}),O2e=D2e;const Q3=Ca(O2e);function fv(s){"@babel/helpers - typeof";return fv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fv(s)}function H4(){return H4=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},H4.apply(this,arguments)}function R2e(s,t){return $2e(s)||L2e(s,t)||M2e(s,t)||F2e()}function F2e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M2e(s,t){if(s){if(typeof s=="string")return JT(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return JT(s,t)}}function JT(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=s[r];return n}function L2e(s,t){var r=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(s)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function $2e(s){if(Array.isArray(s))return s}function XT(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function xS(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XT(Object(r),!0).forEach(function(n){B2e(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):XT(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function B2e(s,t,r){return t=U2e(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function U2e(s){var t=z2e(s,"string");return fv(t)=="symbol"?t:t+""}function z2e(s,t){if(fv(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(fv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function q2e(s){return Array.isArray(s)&&Ao(s[0])&&Ao(s[1])?s.join(" ~ "):s}var V2e=function(t){var r=t.separator,n=r===void 0?" : ":r,a=t.contentStyle,i=a===void 0?{}:a,o=t.itemStyle,l=o===void 0?{}:o,c=t.labelStyle,d=c===void 0?{}:c,u=t.payload,h=t.formatter,f=t.itemSorter,m=t.wrapperClassName,p=t.labelClassName,g=t.label,v=t.labelFormatter,y=t.accessibilityLayer,j=y===void 0?!1:y,b=function(){if(u&&u.length){var T={padding:0,margin:0},V=(f?Q3(u,f):u).map(function(M,G){if(M.type==="none")return null;var L=xS({display:"block",paddingTop:4,paddingBottom:4,color:M.color||"#000"},l),J=M.formatter||h||q2e,z=M.value,U=M.name,oe=z,Q=U;if(J&&oe!=null&&Q!=null){var P=J(z,U,M,G,u);if(Array.isArray(P)){var q=R2e(P,2);oe=q[0],Q=q[1]}else oe=P}return xe.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(G),style:L},Ao(Q)?xe.createElement("span",{className:"recharts-tooltip-item-name"},Q):null,Ao(Q)?xe.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,xe.createElement("span",{className:"recharts-tooltip-item-value"},oe),xe.createElement("span",{className:"recharts-tooltip-item-unit"},M.unit||""))});return xe.createElement("ul",{className:"recharts-tooltip-item-list",style:T},V)}return null},w=xS({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),N=xS({margin:0},d),C=!Fr(g),S=C?g:"",_=Jr("recharts-default-tooltip",m),k=Jr("recharts-tooltip-label",p);C&&v&&u!==void 0&&u!==null&&(S=v(g,u));var F=j?{role:"status","aria-live":"assertive"}:{};return xe.createElement("div",H4({className:_,style:w},F),xe.createElement("p",{className:k,style:N},xe.isValidElement(S)?S:"".concat(S)),b())};function xv(s){"@babel/helpers - typeof";return xv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xv(s)}function yj(s,t,r){return t=W2e(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function W2e(s){var t=H2e(s,"string");return xv(t)=="symbol"?t:t+""}function H2e(s,t){if(xv(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(xv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}var c0="recharts-tooltip-wrapper",G2e={visibility:"hidden"};function K2e(s){var t=s.coordinate,r=s.translateX,n=s.translateY;return Jr(c0,yj(yj(yj(yj({},"".concat(c0,"-right"),ks(r)&&t&&ks(t.x)&&r>=t.x),"".concat(c0,"-left"),ks(r)&&t&&ks(t.x)&&r<t.x),"".concat(c0,"-bottom"),ks(n)&&t&&ks(t.y)&&n>=t.y),"".concat(c0,"-top"),ks(n)&&t&&ks(t.y)&&n<t.y))}function QT(s){var t=s.allowEscapeViewBox,r=s.coordinate,n=s.key,a=s.offsetTopLeft,i=s.position,o=s.reverseDirection,l=s.tooltipDimension,c=s.viewBox,d=s.viewBoxDimension;if(i&&ks(i[n]))return i[n];var u=r[n]-l-a,h=r[n]+a;if(t[n])return o[n]?u:h;if(o[n]){var f=u,m=c[n];return f<m?Math.max(h,c[n]):Math.max(u,c[n])}var p=h+l,g=c[n]+d;return p>g?Math.max(u,c[n]):Math.max(h,c[n])}function Y2e(s){var t=s.translateX,r=s.translateY,n=s.useTranslate3d;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function J2e(s){var t=s.allowEscapeViewBox,r=s.coordinate,n=s.offsetTopLeft,a=s.position,i=s.reverseDirection,o=s.tooltipBox,l=s.useTranslate3d,c=s.viewBox,d,u,h;return o.height>0&&o.width>0&&r?(u=QT({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),h=QT({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),d=Y2e({translateX:u,translateY:h,useTranslate3d:l})):d=G2e,{cssProperties:d,cssClasses:K2e({translateX:u,translateY:h,coordinate:r})}}function Bp(s){"@babel/helpers - typeof";return Bp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bp(s)}function ZT(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function eD(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZT(Object(r),!0).forEach(function(n){K4(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):ZT(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function X2e(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function Q2e(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,aU(n.key),n)}}function Z2e(s,t,r){return t&&Q2e(s.prototype,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function eSe(s,t,r){return t=V1(t),tSe(s,nU()?Reflect.construct(t,r||[],V1(s).constructor):t.apply(s,r))}function tSe(s,t){if(t&&(Bp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sSe(s)}function sSe(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function nU(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nU=function(){return!!s})()}function V1(s){return V1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},V1(s)}function rSe(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&G4(s,t)}function G4(s,t){return G4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},G4(s,t)}function K4(s,t,r){return t=aU(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function aU(s){var t=nSe(s,"string");return Bp(t)=="symbol"?t:t+""}function nSe(s,t){if(Bp(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Bp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}var tD=1,aSe=function(s){function t(){var r;X2e(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=eSe(this,t,[].concat(a)),K4(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),K4(r,"handleKeyDown",function(o){if(o.key==="Escape"){var l,c,d,u;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(l=(c=r.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&l!==void 0?l:0,y:(d=(u=r.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&d!==void 0?d:0}})}}),r}return rSe(t,s),Z2e(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var n=this.wrapperNode.getBoundingClientRect();(Math.abs(n.width-this.state.lastBoundingBox.width)>tD||Math.abs(n.height-this.state.lastBoundingBox.height)>tD)&&this.setState({lastBoundingBox:{width:n.width,height:n.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var n,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var n=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,l=a.animationDuration,c=a.animationEasing,d=a.children,u=a.coordinate,h=a.hasPayload,f=a.isAnimationActive,m=a.offset,p=a.position,g=a.reverseDirection,v=a.useTranslate3d,y=a.viewBox,j=a.wrapperStyle,b=J2e({allowEscapeViewBox:o,coordinate:u,offsetTopLeft:m,position:p,reverseDirection:g,tooltipBox:this.state.lastBoundingBox,useTranslate3d:v,viewBox:y}),w=b.cssClasses,N=b.cssProperties,C=eD(eD({transition:f&&i?"transform ".concat(l,"ms ").concat(c):void 0},N),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&h?"visible":"hidden",position:"absolute",top:0,left:0},j);return xe.createElement("div",{tabIndex:-1,className:w,style:C,ref:function(_){n.wrapperNode=_}},d)}}])}(x.PureComponent),iSe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},yh={isSsr:iSe()};function Up(s){"@babel/helpers - typeof";return Up=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Up(s)}function sD(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function rD(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sD(Object(r),!0).forEach(function(n){Z3(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):sD(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function oSe(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function lSe(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,oU(n.key),n)}}function cSe(s,t,r){return t&&lSe(s.prototype,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function dSe(s,t,r){return t=W1(t),uSe(s,iU()?Reflect.construct(t,r||[],W1(s).constructor):t.apply(s,r))}function uSe(s,t){if(t&&(Up(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hSe(s)}function hSe(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function iU(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(iU=function(){return!!s})()}function W1(s){return W1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},W1(s)}function mSe(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&Y4(s,t)}function Y4(s,t){return Y4=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},Y4(s,t)}function Z3(s,t,r){return t=oU(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function oU(s){var t=fSe(s,"string");return Up(t)=="symbol"?t:t+""}function fSe(s,t){if(Up(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Up(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}function xSe(s){return s.dataKey}function pSe(s,t){return xe.isValidElement(s)?xe.cloneElement(s,t):typeof s=="function"?xe.createElement(s,t):xe.createElement(V2e,t)}var Mo=function(s){function t(){return oSe(this,t),dSe(this,t,arguments)}return mSe(t,s),cSe(t,[{key:"render",value:function(){var n=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,l=a.animationDuration,c=a.animationEasing,d=a.content,u=a.coordinate,h=a.filterNull,f=a.isAnimationActive,m=a.offset,p=a.payload,g=a.payloadUniqBy,v=a.position,y=a.reverseDirection,j=a.useTranslate3d,b=a.viewBox,w=a.wrapperStyle,N=p??[];h&&N.length&&(N=JB(p.filter(function(S){return S.value!=null&&(S.hide!==!0||n.props.includeHidden)}),g,xSe));var C=N.length>0;return xe.createElement(aSe,{allowEscapeViewBox:o,animationDuration:l,animationEasing:c,isAnimationActive:f,active:i,coordinate:u,hasPayload:C,offset:m,position:v,reverseDirection:y,useTranslate3d:j,viewBox:b,wrapperStyle:w},pSe(d,rD(rD({},this.props),{},{payload:N})))}}])}(x.PureComponent);Z3(Mo,"displayName","Tooltip");Z3(Mo,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!yh.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var gSe=ju,vSe=function(){return gSe.Date.now()},ySe=vSe,jSe=/\s/;function bSe(s){for(var t=s.length;t--&&jSe.test(s.charAt(t)););return t}var NSe=bSe,wSe=NSe,SSe=/^\s+/;function CSe(s){return s&&s.slice(0,wSe(s)+1).replace(SSe,"")}var ASe=CSe,ESe=ASe,nD=Wm,ISe=Ag,aD=NaN,PSe=/^[-+]0x[0-9a-f]+$/i,_Se=/^0b[01]+$/i,kSe=/^0o[0-7]+$/i,TSe=parseInt;function DSe(s){if(typeof s=="number")return s;if(ISe(s))return aD;if(nD(s)){var t=typeof s.valueOf=="function"?s.valueOf():s;s=nD(t)?t+"":t}if(typeof s!="string")return s===0?s:+s;s=ESe(s);var r=_Se.test(s);return r||kSe.test(s)?TSe(s.slice(2),r?2:8):PSe.test(s)?aD:+s}var lU=DSe,OSe=Wm,pS=ySe,iD=lU,RSe="Expected a function",FSe=Math.max,MSe=Math.min;function LSe(s,t,r){var n,a,i,o,l,c,d=0,u=!1,h=!1,f=!0;if(typeof s!="function")throw new TypeError(RSe);t=iD(t)||0,OSe(r)&&(u=!!r.leading,h="maxWait"in r,i=h?FSe(iD(r.maxWait)||0,t):i,f="trailing"in r?!!r.trailing:f);function m(C){var S=n,_=a;return n=a=void 0,d=C,o=s.apply(_,S),o}function p(C){return d=C,l=setTimeout(y,t),u?m(C):o}function g(C){var S=C-c,_=C-d,k=t-S;return h?MSe(k,i-_):k}function v(C){var S=C-c,_=C-d;return c===void 0||S>=t||S<0||h&&_>=i}function y(){var C=pS();if(v(C))return j(C);l=setTimeout(y,g(C))}function j(C){return l=void 0,f&&n?m(C):(n=a=void 0,o)}function b(){l!==void 0&&clearTimeout(l),d=0,n=c=a=l=void 0}function w(){return l===void 0?o:j(pS())}function N(){var C=pS(),S=v(C);if(n=arguments,a=this,c=C,S){if(l===void 0)return p(c);if(h)return clearTimeout(l),l=setTimeout(y,t),m(c)}return l===void 0&&(l=setTimeout(y,t)),o}return N.cancel=b,N.flush=w,N}var $Se=LSe,BSe=$Se,USe=Wm,zSe="Expected a function";function qSe(s,t,r){var n=!0,a=!0;if(typeof s!="function")throw new TypeError(zSe);return USe(r)&&(n="leading"in r?!!r.leading:n,a="trailing"in r?!!r.trailing:a),BSe(s,t,{leading:n,maxWait:t,trailing:a})}var VSe=qSe;const cU=Ca(VSe);function pv(s){"@babel/helpers - typeof";return pv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pv(s)}function oD(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function jj(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oD(Object(r),!0).forEach(function(n){WSe(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):oD(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function WSe(s,t,r){return t=HSe(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function HSe(s){var t=GSe(s,"string");return pv(t)=="symbol"?t:t+""}function GSe(s,t){if(pv(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(pv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function KSe(s,t){return QSe(s)||XSe(s,t)||JSe(s,t)||YSe()}function YSe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JSe(s,t){if(s){if(typeof s=="string")return lD(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lD(s,t)}}function lD(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=s[r];return n}function XSe(s,t){var r=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(s)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function QSe(s){if(Array.isArray(s))return s}var eu=x.forwardRef(function(s,t){var r=s.aspect,n=s.initialDimension,a=n===void 0?{width:-1,height:-1}:n,i=s.width,o=i===void 0?"100%":i,l=s.height,c=l===void 0?"100%":l,d=s.minWidth,u=d===void 0?0:d,h=s.minHeight,f=s.maxHeight,m=s.children,p=s.debounce,g=p===void 0?0:p,v=s.id,y=s.className,j=s.onResize,b=s.style,w=b===void 0?{}:b,N=x.useRef(null),C=x.useRef();C.current=j,x.useImperativeHandle(t,function(){return Object.defineProperty(N.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),N.current},configurable:!0})});var S=x.useState({containerWidth:a.width,containerHeight:a.height}),_=KSe(S,2),k=_[0],F=_[1],A=x.useCallback(function(V,M){F(function(G){var L=Math.round(V),J=Math.round(M);return G.containerWidth===L&&G.containerHeight===J?G:{containerWidth:L,containerHeight:J}})},[]);x.useEffect(function(){var V=function(U){var oe,Q=U[0].contentRect,P=Q.width,q=Q.height;A(P,q),(oe=C.current)===null||oe===void 0||oe.call(C,P,q)};g>0&&(V=cU(V,g,{trailing:!0,leading:!1}));var M=new ResizeObserver(V),G=N.current.getBoundingClientRect(),L=G.width,J=G.height;return A(L,J),M.observe(N.current),function(){M.disconnect()}},[A,g]);var T=x.useMemo(function(){var V=k.containerWidth,M=k.containerHeight;if(V<0||M<0)return null;kd(Sf(o)||Sf(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,o,c),kd(!r||r>0,"The aspect(%s) must be greater than zero.",r);var G=Sf(o)?V:o,L=Sf(c)?M:c;r&&r>0&&(G?L=G/r:L&&(G=L*r),f&&L>f&&(L=f)),kd(G>0||L>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,G,L,o,c,u,h,r);var J=!Array.isArray(m)&&rh(m.type).endsWith("Chart");return xe.Children.map(m,function(z){return xe.isValidElement(z)?x.cloneElement(z,jj({width:G,height:L},J?{style:jj({height:"100%",width:"100%",maxHeight:L,maxWidth:G},z.props.style)}:{})):z})},[r,m,c,f,h,u,k,o]);return xe.createElement("div",{id:v?"".concat(v):void 0,className:Jr("recharts-responsive-container",y),style:jj(jj({},w),{},{width:o,height:c,minWidth:u,minHeight:h,maxHeight:f}),ref:N},T)}),xy=function(t){return null};xy.displayName="Cell";function gv(s){"@babel/helpers - typeof";return gv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gv(s)}function cD(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function J4(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cD(Object(r),!0).forEach(function(n){ZSe(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):cD(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function ZSe(s,t,r){return t=eCe(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function eCe(s){var t=tCe(s,"string");return gv(t)=="symbol"?t:t+""}function tCe(s,t){if(gv(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(gv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}var Ox={widthCache:{},cacheCount:0},sCe=2e3,rCe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},dD="recharts_measurement_span";function nCe(s){var t=J4({},s);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var V0=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||yh.isSsr)return{width:0,height:0};var n=nCe(r),a=JSON.stringify({text:t,copyStyle:n});if(Ox.widthCache[a])return Ox.widthCache[a];try{var i=document.getElementById(dD);i||(i=document.createElement("span"),i.setAttribute("id",dD),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var o=J4(J4({},rCe),n);Object.assign(i.style,o),i.textContent="".concat(t);var l=i.getBoundingClientRect(),c={width:l.width,height:l.height};return Ox.widthCache[a]=c,++Ox.cacheCount>sCe&&(Ox.cacheCount=0,Ox.widthCache={}),c}catch{return{width:0,height:0}}},aCe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function vv(s){"@babel/helpers - typeof";return vv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vv(s)}function H1(s,t){return cCe(s)||lCe(s,t)||oCe(s,t)||iCe()}function iCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function oCe(s,t){if(s){if(typeof s=="string")return uD(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uD(s,t)}}function uD(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=s[r];return n}function lCe(s,t){var r=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(s)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function cCe(s){if(Array.isArray(s))return s}function dCe(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function hD(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,hCe(n.key),n)}}function uCe(s,t,r){return t&&hD(s.prototype,t),r&&hD(s,r),Object.defineProperty(s,"prototype",{writable:!1}),s}function hCe(s){var t=mCe(s,"string");return vv(t)=="symbol"?t:t+""}function mCe(s,t){if(vv(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(vv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}var mD=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,fD=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,fCe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,xCe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,dU={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},pCe=Object.keys(dU),Kx="NaN";function gCe(s,t){return s*dU[t]}var bj=function(){function s(t,r){dCe(this,s),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!fCe.test(r)&&(this.num=NaN,this.unit=""),pCe.includes(r)&&(this.num=gCe(t,r),this.unit="px")}return uCe(s,[{key:"add",value:function(r){return this.unit!==r.unit?new s(NaN,""):new s(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new s(NaN,""):new s(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new s(NaN,""):new s(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new s(NaN,""):new s(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var n,a=(n=xCe.exec(r))!==null&&n!==void 0?n:[],i=H1(a,3),o=i[1],l=i[2];return new s(parseFloat(o),l??"")}}])}();function uU(s){if(s.includes(Kx))return Kx;for(var t=s;t.includes("*")||t.includes("/");){var r,n=(r=mD.exec(t))!==null&&r!==void 0?r:[],a=H1(n,4),i=a[1],o=a[2],l=a[3],c=bj.parse(i??""),d=bj.parse(l??""),u=o==="*"?c.multiply(d):c.divide(d);if(u.isNaN())return Kx;t=t.replace(mD,u.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var h,f=(h=fD.exec(t))!==null&&h!==void 0?h:[],m=H1(f,4),p=m[1],g=m[2],v=m[3],y=bj.parse(p??""),j=bj.parse(v??""),b=g==="+"?y.add(j):y.subtract(j);if(b.isNaN())return Kx;t=t.replace(fD,b.toString())}return t}var xD=/\(([^()]*)\)/;function vCe(s){for(var t=s;t.includes("(");){var r=xD.exec(t),n=H1(r,2),a=n[1];t=t.replace(xD,uU(a))}return t}function yCe(s){var t=s.replace(/\s+/g,"");return t=vCe(t),t=uU(t),t}function jCe(s){try{return yCe(s)}catch{return Kx}}function gS(s){var t=jCe(s.slice(5,-1));return t===Kx?"":t}var bCe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],NCe=["dx","dy","angle","className","breakAll"];function X4(){return X4=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},X4.apply(this,arguments)}function pD(s,t){if(s==null)return{};var r=wCe(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function wCe(s,t){if(s==null)return{};var r={};for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n)){if(t.indexOf(n)>=0)continue;r[n]=s[n]}return r}function gD(s,t){return ECe(s)||ACe(s,t)||CCe(s,t)||SCe()}function SCe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CCe(s,t){if(s){if(typeof s=="string")return vD(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vD(s,t)}}function vD(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=s[r];return n}function ACe(s,t){var r=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(s)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function ECe(s){if(Array.isArray(s))return s}var hU=/[ \f\n\r\t\v\u2028\u2029]+/,mU=function(t){var r=t.children,n=t.breakAll,a=t.style;try{var i=[];Fr(r)||(n?i=r.toString().split(""):i=r.toString().split(hU));var o=i.map(function(c){return{word:c,width:V0(c,a).width}}),l=n?0:V0("",a).width;return{wordsWithComputedWidth:o,spaceWidth:l}}catch{return null}},ICe=function(t,r,n,a,i){var o=t.maxLines,l=t.children,c=t.style,d=t.breakAll,u=ks(o),h=l,f=function(){var G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return G.reduce(function(L,J){var z=J.word,U=J.width,oe=L[L.length-1];if(oe&&(a==null||i||oe.width+U+n<Number(a)))oe.words.push(z),oe.width+=U+n;else{var Q={words:[z],width:U};L.push(Q)}return L},[])},m=f(r),p=function(G){return G.reduce(function(L,J){return L.width>J.width?L:J})};if(!u)return m;for(var g="",v=function(G){var L=h.slice(0,G),J=mU({breakAll:d,style:c,children:L+g}).wordsWithComputedWidth,z=f(J),U=z.length>o||p(z).width>Number(a);return[U,z]},y=0,j=h.length-1,b=0,w;y<=j&&b<=h.length-1;){var N=Math.floor((y+j)/2),C=N-1,S=v(C),_=gD(S,2),k=_[0],F=_[1],A=v(N),T=gD(A,1),V=T[0];if(!k&&!V&&(y=N+1),k&&V&&(j=N-1),!k&&V){w=F;break}b++}return w||m},yD=function(t){var r=Fr(t)?[]:t.toString().split(hU);return[{words:r}]},PCe=function(t){var r=t.width,n=t.scaleToFit,a=t.children,i=t.style,o=t.breakAll,l=t.maxLines;if((r||n)&&!yh.isSsr){var c,d,u=mU({breakAll:o,children:a,style:i});if(u){var h=u.wordsWithComputedWidth,f=u.spaceWidth;c=h,d=f}else return yD(a);return ICe({breakAll:o,children:a,maxLines:l,style:i},c,d,r,n)}return yD(a)},jD="#808080",ix=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,o=t.lineHeight,l=o===void 0?"1em":o,c=t.capHeight,d=c===void 0?"0.71em":c,u=t.scaleToFit,h=u===void 0?!1:u,f=t.textAnchor,m=f===void 0?"start":f,p=t.verticalAnchor,g=p===void 0?"end":p,v=t.fill,y=v===void 0?jD:v,j=pD(t,bCe),b=x.useMemo(function(){return PCe({breakAll:j.breakAll,children:j.children,maxLines:j.maxLines,scaleToFit:h,style:j.style,width:j.width})},[j.breakAll,j.children,j.maxLines,h,j.style,j.width]),w=j.dx,N=j.dy,C=j.angle,S=j.className,_=j.breakAll,k=pD(j,NCe);if(!Ao(n)||!Ao(i))return null;var F=n+(ks(w)?w:0),A=i+(ks(N)?N:0),T;switch(g){case"start":T=gS("calc(".concat(d,")"));break;case"middle":T=gS("calc(".concat((b.length-1)/2," * -").concat(l," + (").concat(d," / 2))"));break;default:T=gS("calc(".concat(b.length-1," * -").concat(l,")"));break}var V=[];if(h){var M=b[0].width,G=j.width;V.push("scale(".concat((ks(G)?G/M:1)/M,")"))}return C&&V.push("rotate(".concat(C,", ").concat(F,", ").concat(A,")")),V.length&&(k.transform=V.join(" ")),xe.createElement("text",X4({},xr(k,!0),{x:F,y:A,className:Jr("recharts-text",S),textAnchor:m,fill:y.includes("url")?jD:y}),b.map(function(L,J){var z=L.words.join(_?"":" ");return xe.createElement("tspan",{x:F,dy:J===0?T:l,key:"".concat(z,"-").concat(J)},z)}))};function _m(s,t){return s==null||t==null?NaN:s<t?-1:s>t?1:s>=t?0:NaN}function _Ce(s,t){return s==null||t==null?NaN:t<s?-1:t>s?1:t>=s?0:NaN}function eE(s){let t,r,n;s.length!==2?(t=_m,r=(l,c)=>_m(s(l),c),n=(l,c)=>s(l)-c):(t=s===_m||s===_Ce?s:kCe,r=s,n=s);function a(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const h=d+u>>>1;r(l[h],c)<0?d=h+1:u=h}while(d<u)}return d}function i(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const h=d+u>>>1;r(l[h],c)<=0?d=h+1:u=h}while(d<u)}return d}function o(l,c,d=0,u=l.length){const h=a(l,c,d,u-1);return h>d&&n(l[h-1],c)>-n(l[h],c)?h-1:h}return{left:a,center:o,right:i}}function kCe(){return 0}function fU(s){return s===null?NaN:+s}function*TCe(s,t){for(let r of s)r!=null&&(r=+r)>=r&&(yield r)}const DCe=eE(_m),py=DCe.right;eE(fU).center;class bD extends Map{constructor(t,r=FCe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(ND(this,t))}has(t){return super.has(ND(this,t))}set(t,r){return super.set(OCe(this,t),r)}delete(t){return super.delete(RCe(this,t))}}function ND({_intern:s,_key:t},r){const n=t(r);return s.has(n)?s.get(n):r}function OCe({_intern:s,_key:t},r){const n=t(r);return s.has(n)?s.get(n):(s.set(n,r),r)}function RCe({_intern:s,_key:t},r){const n=t(r);return s.has(n)&&(r=s.get(n),s.delete(n)),r}function FCe(s){return s!==null&&typeof s=="object"?s.valueOf():s}function MCe(s=_m){if(s===_m)return xU;if(typeof s!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=s(t,r);return n||n===0?n:(s(r,r)===0)-(s(t,t)===0)}}function xU(s,t){return(s==null||!(s>=s))-(t==null||!(t>=t))||(s<t?-1:s>t?1:0)}const LCe=Math.sqrt(50),$Ce=Math.sqrt(10),BCe=Math.sqrt(2);function G1(s,t,r){const n=(t-s)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),o=i>=LCe?10:i>=$Ce?5:i>=BCe?2:1;let l,c,d;return a<0?(d=Math.pow(10,-a)/o,l=Math.round(s*d),c=Math.round(t*d),l/d<s&&++l,c/d>t&&--c,d=-d):(d=Math.pow(10,a)*o,l=Math.round(s/d),c=Math.round(t/d),l*d<s&&++l,c*d>t&&--c),c<l&&.5<=r&&r<2?G1(s,t,r*2):[l,c,d]}function Q4(s,t,r){if(t=+t,s=+s,r=+r,!(r>0))return[];if(s===t)return[s];const n=t<s,[a,i,o]=n?G1(t,s,r):G1(s,t,r);if(!(i>=a))return[];const l=i-a+1,c=new Array(l);if(n)if(o<0)for(let d=0;d<l;++d)c[d]=(i-d)/-o;else for(let d=0;d<l;++d)c[d]=(i-d)*o;else if(o<0)for(let d=0;d<l;++d)c[d]=(a+d)/-o;else for(let d=0;d<l;++d)c[d]=(a+d)*o;return c}function Z4(s,t,r){return t=+t,s=+s,r=+r,G1(s,t,r)[2]}function eA(s,t,r){t=+t,s=+s,r=+r;const n=t<s,a=n?Z4(t,s,r):Z4(s,t,r);return(n?-1:1)*(a<0?1/-a:a)}function wD(s,t){let r;for(const n of s)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function SD(s,t){let r;for(const n of s)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function pU(s,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(s.length-1,n)),!(r<=t&&t<=n))return s;for(a=a===void 0?xU:MCe(a);n>r;){if(n-r>600){const c=n-r+1,d=t-r+1,u=Math.log(c),h=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*h*(c-h)/c)*(d-c/2<0?-1:1),m=Math.max(r,Math.floor(t-d*h/c+f)),p=Math.min(n,Math.floor(t+(c-d)*h/c+f));pU(s,t,m,p,a)}const i=s[t];let o=r,l=n;for(d0(s,r,t),a(s[n],i)>0&&d0(s,r,n);o<l;){for(d0(s,o,l),++o,--l;a(s[o],i)<0;)++o;for(;a(s[l],i)>0;)--l}a(s[r],i)===0?d0(s,r,l):(++l,d0(s,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return s}function d0(s,t,r){const n=s[t];s[t]=s[r],s[r]=n}function UCe(s,t,r){if(s=Float64Array.from(TCe(s)),!(!(n=s.length)||isNaN(t=+t))){if(t<=0||n<2)return SD(s);if(t>=1)return wD(s);var n,a=(n-1)*t,i=Math.floor(a),o=wD(pU(s,i).subarray(0,i+1)),l=SD(s.subarray(i+1));return o+(l-o)*(a-i)}}function zCe(s,t,r=fU){if(!(!(n=s.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(s[0],0,s);if(t>=1)return+r(s[n-1],n-1,s);var n,a=(n-1)*t,i=Math.floor(a),o=+r(s[i],i,s),l=+r(s[i+1],i+1,s);return o+(l-o)*(a-i)}}function qCe(s,t,r){s=+s,t=+t,r=(a=arguments.length)<2?(t=s,s=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-s)/r))|0,i=new Array(a);++n<a;)i[n]=s+n*r;return i}function cd(s,t){switch(arguments.length){case 0:break;case 1:this.range(s);break;default:this.range(t).domain(s);break}return this}function jh(s,t){switch(arguments.length){case 0:break;case 1:{typeof s=="function"?this.interpolator(s):this.range(s);break}default:{this.domain(s),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const tA=Symbol("implicit");function tE(){var s=new bD,t=[],r=[],n=tA;function a(i){let o=s.get(i);if(o===void 0){if(n!==tA)return n;s.set(i,o=t.push(i)-1)}return r[o%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],s=new bD;for(const o of i)s.has(o)||s.set(o,t.push(o)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return tE(t,r).unknown(n)},cd.apply(a,arguments),a}function yv(){var s=tE().unknown(void 0),t=s.domain,r=s.range,n=0,a=1,i,o,l=!1,c=0,d=0,u=.5;delete s.unknown;function h(){var f=t().length,m=a<n,p=m?a:n,g=m?n:a;i=(g-p)/Math.max(1,f-c+d*2),l&&(i=Math.floor(i)),p+=(g-p-i*(f-c))*u,o=i*(1-c),l&&(p=Math.round(p),o=Math.round(o));var v=qCe(f).map(function(y){return p+i*y});return r(m?v.reverse():v)}return s.domain=function(f){return arguments.length?(t(f),h()):t()},s.range=function(f){return arguments.length?([n,a]=f,n=+n,a=+a,h()):[n,a]},s.rangeRound=function(f){return[n,a]=f,n=+n,a=+a,l=!0,h()},s.bandwidth=function(){return o},s.step=function(){return i},s.round=function(f){return arguments.length?(l=!!f,h()):l},s.padding=function(f){return arguments.length?(c=Math.min(1,d=+f),h()):c},s.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),h()):c},s.paddingOuter=function(f){return arguments.length?(d=+f,h()):d},s.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),h()):u},s.copy=function(){return yv(t(),[n,a]).round(l).paddingInner(c).paddingOuter(d).align(u)},cd.apply(h(),arguments)}function gU(s){var t=s.copy;return s.padding=s.paddingOuter,delete s.paddingInner,delete s.paddingOuter,s.copy=function(){return gU(t())},s}function W0(){return gU(yv.apply(null,arguments).paddingInner(1))}function sE(s,t,r){s.prototype=t.prototype=r,r.constructor=s}function vU(s,t){var r=Object.create(s.prototype);for(var n in t)r[n]=t[n];return r}function gy(){}var jv=.7,K1=1/jv,np="\\s*([+-]?\\d+)\\s*",bv="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",uu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",VCe=/^#([0-9a-f]{3,8})$/,WCe=new RegExp(`^rgb\\(${np},${np},${np}\\)$`),HCe=new RegExp(`^rgb\\(${uu},${uu},${uu}\\)$`),GCe=new RegExp(`^rgba\\(${np},${np},${np},${bv}\\)$`),KCe=new RegExp(`^rgba\\(${uu},${uu},${uu},${bv}\\)$`),YCe=new RegExp(`^hsl\\(${bv},${uu},${uu}\\)$`),JCe=new RegExp(`^hsla\\(${bv},${uu},${uu},${bv}\\)$`),CD={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};sE(gy,Nv,{copy(s){return Object.assign(new this.constructor,this,s)},displayable(){return this.rgb().displayable()},hex:AD,formatHex:AD,formatHex8:XCe,formatHsl:QCe,formatRgb:ED,toString:ED});function AD(){return this.rgb().formatHex()}function XCe(){return this.rgb().formatHex8()}function QCe(){return yU(this).formatHsl()}function ED(){return this.rgb().formatRgb()}function Nv(s){var t,r;return s=(s+"").trim().toLowerCase(),(t=VCe.exec(s))?(r=t[1].length,t=parseInt(t[1],16),r===6?ID(t):r===3?new sc(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Nj(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Nj(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=WCe.exec(s))?new sc(t[1],t[2],t[3],1):(t=HCe.exec(s))?new sc(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=GCe.exec(s))?Nj(t[1],t[2],t[3],t[4]):(t=KCe.exec(s))?Nj(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=YCe.exec(s))?kD(t[1],t[2]/100,t[3]/100,1):(t=JCe.exec(s))?kD(t[1],t[2]/100,t[3]/100,t[4]):CD.hasOwnProperty(s)?ID(CD[s]):s==="transparent"?new sc(NaN,NaN,NaN,0):null}function ID(s){return new sc(s>>16&255,s>>8&255,s&255,1)}function Nj(s,t,r,n){return n<=0&&(s=t=r=NaN),new sc(s,t,r,n)}function ZCe(s){return s instanceof gy||(s=Nv(s)),s?(s=s.rgb(),new sc(s.r,s.g,s.b,s.opacity)):new sc}function sA(s,t,r,n){return arguments.length===1?ZCe(s):new sc(s,t,r,n??1)}function sc(s,t,r,n){this.r=+s,this.g=+t,this.b=+r,this.opacity=+n}sE(sc,sA,vU(gy,{brighter(s){return s=s==null?K1:Math.pow(K1,s),new sc(this.r*s,this.g*s,this.b*s,this.opacity)},darker(s){return s=s==null?jv:Math.pow(jv,s),new sc(this.r*s,this.g*s,this.b*s,this.opacity)},rgb(){return this},clamp(){return new sc(Vf(this.r),Vf(this.g),Vf(this.b),Y1(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:PD,formatHex:PD,formatHex8:e4e,formatRgb:_D,toString:_D}));function PD(){return`#${Cf(this.r)}${Cf(this.g)}${Cf(this.b)}`}function e4e(){return`#${Cf(this.r)}${Cf(this.g)}${Cf(this.b)}${Cf((isNaN(this.opacity)?1:this.opacity)*255)}`}function _D(){const s=Y1(this.opacity);return`${s===1?"rgb(":"rgba("}${Vf(this.r)}, ${Vf(this.g)}, ${Vf(this.b)}${s===1?")":`, ${s})`}`}function Y1(s){return isNaN(s)?1:Math.max(0,Math.min(1,s))}function Vf(s){return Math.max(0,Math.min(255,Math.round(s)||0))}function Cf(s){return s=Vf(s),(s<16?"0":"")+s.toString(16)}function kD(s,t,r,n){return n<=0?s=t=r=NaN:r<=0||r>=1?s=t=NaN:t<=0&&(s=NaN),new Pd(s,t,r,n)}function yU(s){if(s instanceof Pd)return new Pd(s.h,s.s,s.l,s.opacity);if(s instanceof gy||(s=Nv(s)),!s)return new Pd;if(s instanceof Pd)return s;s=s.rgb();var t=s.r/255,r=s.g/255,n=s.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),o=NaN,l=i-a,c=(i+a)/2;return l?(t===i?o=(r-n)/l+(r<n)*6:r===i?o=(n-t)/l+2:o=(t-r)/l+4,l/=c<.5?i+a:2-i-a,o*=60):l=c>0&&c<1?0:o,new Pd(o,l,c,s.opacity)}function t4e(s,t,r,n){return arguments.length===1?yU(s):new Pd(s,t,r,n??1)}function Pd(s,t,r,n){this.h=+s,this.s=+t,this.l=+r,this.opacity=+n}sE(Pd,t4e,vU(gy,{brighter(s){return s=s==null?K1:Math.pow(K1,s),new Pd(this.h,this.s,this.l*s,this.opacity)},darker(s){return s=s==null?jv:Math.pow(jv,s),new Pd(this.h,this.s,this.l*s,this.opacity)},rgb(){var s=this.h%360+(this.h<0)*360,t=isNaN(s)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new sc(vS(s>=240?s-240:s+120,a,n),vS(s,a,n),vS(s<120?s+240:s-120,a,n),this.opacity)},clamp(){return new Pd(TD(this.h),wj(this.s),wj(this.l),Y1(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const s=Y1(this.opacity);return`${s===1?"hsl(":"hsla("}${TD(this.h)}, ${wj(this.s)*100}%, ${wj(this.l)*100}%${s===1?")":`, ${s})`}`}}));function TD(s){return s=(s||0)%360,s<0?s+360:s}function wj(s){return Math.max(0,Math.min(1,s||0))}function vS(s,t,r){return(s<60?t+(r-t)*s/60:s<180?r:s<240?t+(r-t)*(240-s)/60:t)*255}const rE=s=>()=>s;function s4e(s,t){return function(r){return s+r*t}}function r4e(s,t,r){return s=Math.pow(s,r),t=Math.pow(t,r)-s,r=1/r,function(n){return Math.pow(s+n*t,r)}}function n4e(s){return(s=+s)==1?jU:function(t,r){return r-t?r4e(t,r,s):rE(isNaN(t)?r:t)}}function jU(s,t){var r=t-s;return r?s4e(s,r):rE(isNaN(s)?t:s)}const DD=function s(t){var r=n4e(t);function n(a,i){var o=r((a=sA(a)).r,(i=sA(i)).r),l=r(a.g,i.g),c=r(a.b,i.b),d=jU(a.opacity,i.opacity);return function(u){return a.r=o(u),a.g=l(u),a.b=c(u),a.opacity=d(u),a+""}}return n.gamma=s,n}(1);function a4e(s,t){t||(t=[]);var r=s?Math.min(t.length,s.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=s[a]*(1-i)+t[a]*i;return n}}function i4e(s){return ArrayBuffer.isView(s)&&!(s instanceof DataView)}function o4e(s,t){var r=t?t.length:0,n=s?Math.min(r,s.length):0,a=new Array(n),i=new Array(r),o;for(o=0;o<n;++o)a[o]=Rg(s[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(l){for(o=0;o<n;++o)i[o]=a[o](l);return i}}function l4e(s,t){var r=new Date;return s=+s,t=+t,function(n){return r.setTime(s*(1-n)+t*n),r}}function J1(s,t){return s=+s,t=+t,function(r){return s*(1-r)+t*r}}function c4e(s,t){var r={},n={},a;(s===null||typeof s!="object")&&(s={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in s?r[a]=Rg(s[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var rA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yS=new RegExp(rA.source,"g");function d4e(s){return function(){return s}}function u4e(s){return function(t){return s(t)+""}}function h4e(s,t){var r=rA.lastIndex=yS.lastIndex=0,n,a,i,o=-1,l=[],c=[];for(s=s+"",t=t+"";(n=rA.exec(s))&&(a=yS.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),l[o]?l[o]+=i:l[++o]=i),(n=n[0])===(a=a[0])?l[o]?l[o]+=a:l[++o]=a:(l[++o]=null,c.push({i:o,x:J1(n,a)})),r=yS.lastIndex;return r<t.length&&(i=t.slice(r),l[o]?l[o]+=i:l[++o]=i),l.length<2?c[0]?u4e(c[0].x):d4e(t):(t=c.length,function(d){for(var u=0,h;u<t;++u)l[(h=c[u]).i]=h.x(d);return l.join("")})}function Rg(s,t){var r=typeof t,n;return t==null||r==="boolean"?rE(t):(r==="number"?J1:r==="string"?(n=Nv(t))?(t=n,DD):h4e:t instanceof Nv?DD:t instanceof Date?l4e:i4e(t)?a4e:Array.isArray(t)?o4e:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?c4e:J1)(s,t)}function nE(s,t){return s=+s,t=+t,function(r){return Math.round(s*(1-r)+t*r)}}function m4e(s,t){t===void 0&&(t=s,s=Rg);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=s(a,a=t[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return i[l](o-l)}}function f4e(s){return function(){return s}}function X1(s){return+s}var OD=[0,1];function Dl(s){return s}function nA(s,t){return(t-=s=+s)?function(r){return(r-s)/t}:f4e(isNaN(t)?NaN:.5)}function x4e(s,t){var r;return s>t&&(r=s,s=t,t=r),function(n){return Math.max(s,Math.min(t,n))}}function p4e(s,t,r){var n=s[0],a=s[1],i=t[0],o=t[1];return a<n?(n=nA(a,n),i=r(o,i)):(n=nA(n,a),i=r(i,o)),function(l){return i(n(l))}}function g4e(s,t,r){var n=Math.min(s.length,t.length)-1,a=new Array(n),i=new Array(n),o=-1;for(s[n]<s[0]&&(s=s.slice().reverse(),t=t.slice().reverse());++o<n;)a[o]=nA(s[o],s[o+1]),i[o]=r(t[o],t[o+1]);return function(l){var c=py(s,l,1,n)-1;return i[c](a[c](l))}}function vy(s,t){return t.domain(s.domain()).range(s.range()).interpolate(s.interpolate()).clamp(s.clamp()).unknown(s.unknown())}function GN(){var s=OD,t=OD,r=Rg,n,a,i,o=Dl,l,c,d;function u(){var f=Math.min(s.length,t.length);return o!==Dl&&(o=x4e(s[0],s[f-1])),l=f>2?g4e:p4e,c=d=null,h}function h(f){return f==null||isNaN(f=+f)?i:(c||(c=l(s.map(n),t,r)))(n(o(f)))}return h.invert=function(f){return o(a((d||(d=l(t,s.map(n),J1)))(f)))},h.domain=function(f){return arguments.length?(s=Array.from(f,X1),u()):s.slice()},h.range=function(f){return arguments.length?(t=Array.from(f),u()):t.slice()},h.rangeRound=function(f){return t=Array.from(f),r=nE,u()},h.clamp=function(f){return arguments.length?(o=f?!0:Dl,u()):o!==Dl},h.interpolate=function(f){return arguments.length?(r=f,u()):r},h.unknown=function(f){return arguments.length?(i=f,h):i},function(f,m){return n=f,a=m,u()}}function aE(){return GN()(Dl,Dl)}function v4e(s){return Math.abs(s=Math.round(s))>=1e21?s.toLocaleString("en").replace(/,/g,""):s.toString(10)}function Q1(s,t){if((r=(s=t?s.toExponential(t-1):s.toExponential()).indexOf("e"))<0)return null;var r,n=s.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+s.slice(r+1)]}function zp(s){return s=Q1(Math.abs(s)),s?s[1]:NaN}function y4e(s,t){return function(r,n){for(var a=r.length,i=[],o=0,l=s[0],c=0;a>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),i.push(r.substring(a-=l,a+l)),!((c+=l+1)>n));)l=s[o=(o+1)%s.length];return i.reverse().join(t)}}function j4e(s){return function(t){return t.replace(/[0-9]/g,function(r){return s[+r]})}}var b4e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function wv(s){if(!(t=b4e.exec(s)))throw new Error("invalid format: "+s);var t;return new iE({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}wv.prototype=iE.prototype;function iE(s){this.fill=s.fill===void 0?" ":s.fill+"",this.align=s.align===void 0?">":s.align+"",this.sign=s.sign===void 0?"-":s.sign+"",this.symbol=s.symbol===void 0?"":s.symbol+"",this.zero=!!s.zero,this.width=s.width===void 0?void 0:+s.width,this.comma=!!s.comma,this.precision=s.precision===void 0?void 0:+s.precision,this.trim=!!s.trim,this.type=s.type===void 0?"":s.type+""}iE.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function N4e(s){e:for(var t=s.length,r=1,n=-1,a;r<t;++r)switch(s[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+s[r])break e;n>0&&(n=0);break}return n>0?s.slice(0,n)+s.slice(a+1):s}var bU;function w4e(s,t){var r=Q1(s,t);if(!r)return s+"";var n=r[0],a=r[1],i=a-(bU=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=n.length;return i===o?n:i>o?n+new Array(i-o+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+Q1(s,Math.max(0,t+i-1))[0]}function RD(s,t){var r=Q1(s,t);if(!r)return s+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const FD={"%":(s,t)=>(s*100).toFixed(t),b:s=>Math.round(s).toString(2),c:s=>s+"",d:v4e,e:(s,t)=>s.toExponential(t),f:(s,t)=>s.toFixed(t),g:(s,t)=>s.toPrecision(t),o:s=>Math.round(s).toString(8),p:(s,t)=>RD(s*100,t),r:RD,s:w4e,X:s=>Math.round(s).toString(16).toUpperCase(),x:s=>Math.round(s).toString(16)};function MD(s){return s}var LD=Array.prototype.map,$D=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function S4e(s){var t=s.grouping===void 0||s.thousands===void 0?MD:y4e(LD.call(s.grouping,Number),s.thousands+""),r=s.currency===void 0?"":s.currency[0]+"",n=s.currency===void 0?"":s.currency[1]+"",a=s.decimal===void 0?".":s.decimal+"",i=s.numerals===void 0?MD:j4e(LD.call(s.numerals,String)),o=s.percent===void 0?"%":s.percent+"",l=s.minus===void 0?"":s.minus+"",c=s.nan===void 0?"NaN":s.nan+"";function d(h){h=wv(h);var f=h.fill,m=h.align,p=h.sign,g=h.symbol,v=h.zero,y=h.width,j=h.comma,b=h.precision,w=h.trim,N=h.type;N==="n"?(j=!0,N="g"):FD[N]||(b===void 0&&(b=12),w=!0,N="g"),(v||f==="0"&&m==="=")&&(v=!0,f="0",m="=");var C=g==="$"?r:g==="#"&&/[boxX]/.test(N)?"0"+N.toLowerCase():"",S=g==="$"?n:/[%p]/.test(N)?o:"",_=FD[N],k=/[defgprs%]/.test(N);b=b===void 0?6:/[gprs]/.test(N)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function F(A){var T=C,V=S,M,G,L;if(N==="c")V=_(A)+V,A="";else{A=+A;var J=A<0||1/A<0;if(A=isNaN(A)?c:_(Math.abs(A),b),w&&(A=N4e(A)),J&&+A==0&&p!=="+"&&(J=!1),T=(J?p==="("?p:l:p==="-"||p==="("?"":p)+T,V=(N==="s"?$D[8+bU/3]:"")+V+(J&&p==="("?")":""),k){for(M=-1,G=A.length;++M<G;)if(L=A.charCodeAt(M),48>L||L>57){V=(L===46?a+A.slice(M+1):A.slice(M))+V,A=A.slice(0,M);break}}}j&&!v&&(A=t(A,1/0));var z=T.length+A.length+V.length,U=z<y?new Array(y-z+1).join(f):"";switch(j&&v&&(A=t(U+A,U.length?y-V.length:1/0),U=""),m){case"<":A=T+A+V+U;break;case"=":A=T+U+A+V;break;case"^":A=U.slice(0,z=U.length>>1)+T+A+V+U.slice(z);break;default:A=U+T+A+V;break}return i(A)}return F.toString=function(){return h+""},F}function u(h,f){var m=d((h=wv(h),h.type="f",h)),p=Math.max(-8,Math.min(8,Math.floor(zp(f)/3)))*3,g=Math.pow(10,-p),v=$D[8+p/3];return function(y){return m(g*y)+v}}return{format:d,formatPrefix:u}}var Sj,oE,NU;C4e({thousands:",",grouping:[3],currency:["$",""]});function C4e(s){return Sj=S4e(s),oE=Sj.format,NU=Sj.formatPrefix,Sj}function A4e(s){return Math.max(0,-zp(Math.abs(s)))}function E4e(s,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(zp(t)/3)))*3-zp(Math.abs(s)))}function I4e(s,t){return s=Math.abs(s),t=Math.abs(t)-s,Math.max(0,zp(t)-zp(s))+1}function wU(s,t,r,n){var a=eA(s,t,r),i;switch(n=wv(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(s),Math.abs(t));return n.precision==null&&!isNaN(i=E4e(a,o))&&(n.precision=i),NU(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=I4e(a,Math.max(Math.abs(s),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=A4e(a))&&(n.precision=i-(n.type==="%")*2);break}}return oE(n)}function Gm(s){var t=s.domain;return s.ticks=function(r){var n=t();return Q4(n[0],n[n.length-1],r??10)},s.tickFormat=function(r,n){var a=t();return wU(a[0],a[a.length-1],r??10,n)},s.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,o=n[a],l=n[i],c,d,u=10;for(l<o&&(d=o,o=l,l=d,d=a,a=i,i=d);u-- >0;){if(d=Z4(o,l,r),d===c)return n[a]=o,n[i]=l,t(n);if(d>0)o=Math.floor(o/d)*d,l=Math.ceil(l/d)*d;else if(d<0)o=Math.ceil(o*d)/d,l=Math.floor(l*d)/d;else break;c=d}return s},s}function Z1(){var s=aE();return s.copy=function(){return vy(s,Z1())},cd.apply(s,arguments),Gm(s)}function SU(s){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(s=Array.from(n,X1),r):s.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return SU(s).unknown(t)},s=arguments.length?Array.from(s,X1):[0,1],Gm(r)}function CU(s,t){s=s.slice();var r=0,n=s.length-1,a=s[r],i=s[n],o;return i<a&&(o=r,r=n,n=o,o=a,a=i,i=o),s[r]=t.floor(a),s[n]=t.ceil(i),s}function BD(s){return Math.log(s)}function UD(s){return Math.exp(s)}function P4e(s){return-Math.log(-s)}function _4e(s){return-Math.exp(-s)}function k4e(s){return isFinite(s)?+("1e"+s):s<0?0:s}function T4e(s){return s===10?k4e:s===Math.E?Math.exp:t=>Math.pow(s,t)}function D4e(s){return s===Math.E?Math.log:s===10&&Math.log10||s===2&&Math.log2||(s=Math.log(s),t=>Math.log(t)/s)}function zD(s){return(t,r)=>-s(-t,r)}function lE(s){const t=s(BD,UD),r=t.domain;let n=10,a,i;function o(){return a=D4e(n),i=T4e(n),r()[0]<0?(a=zD(a),i=zD(i),s(P4e,_4e)):s(BD,UD),t}return t.base=function(l){return arguments.length?(n=+l,o()):n},t.domain=function(l){return arguments.length?(r(l),o()):r()},t.ticks=l=>{const c=r();let d=c[0],u=c[c.length-1];const h=u<d;h&&([d,u]=[u,d]);let f=a(d),m=a(u),p,g;const v=l==null?10:+l;let y=[];if(!(n%1)&&m-f<v){if(f=Math.floor(f),m=Math.ceil(m),d>0){for(;f<=m;++f)for(p=1;p<n;++p)if(g=f<0?p/i(-f):p*i(f),!(g<d)){if(g>u)break;y.push(g)}}else for(;f<=m;++f)for(p=n-1;p>=1;--p)if(g=f>0?p/i(-f):p*i(f),!(g<d)){if(g>u)break;y.push(g)}y.length*2<v&&(y=Q4(d,u,v))}else y=Q4(f,m,Math.min(m-f,v)).map(i);return h?y.reverse():y},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=wv(c)).precision==null&&(c.trim=!0),c=oE(c)),l===1/0)return c;const d=Math.max(1,n*l/t.ticks().length);return u=>{let h=u/i(Math.round(a(u)));return h*n<n-.5&&(h*=n),h<=d?c(u):""}},t.nice=()=>r(CU(r(),{floor:l=>i(Math.floor(a(l))),ceil:l=>i(Math.ceil(a(l)))})),t}function AU(){const s=lE(GN()).domain([1,10]);return s.copy=()=>vy(s,AU()).base(s.base()),cd.apply(s,arguments),s}function qD(s){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/s))}}function VD(s){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*s}}function cE(s){var t=1,r=s(qD(t),VD(t));return r.constant=function(n){return arguments.length?s(qD(t=+n),VD(t)):t},Gm(r)}function EU(){var s=cE(GN());return s.copy=function(){return vy(s,EU()).constant(s.constant())},cd.apply(s,arguments)}function WD(s){return function(t){return t<0?-Math.pow(-t,s):Math.pow(t,s)}}function O4e(s){return s<0?-Math.sqrt(-s):Math.sqrt(s)}function R4e(s){return s<0?-s*s:s*s}function dE(s){var t=s(Dl,Dl),r=1;function n(){return r===1?s(Dl,Dl):r===.5?s(O4e,R4e):s(WD(r),WD(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},Gm(t)}function uE(){var s=dE(GN());return s.copy=function(){return vy(s,uE()).exponent(s.exponent())},cd.apply(s,arguments),s}function F4e(){return uE.apply(null,arguments).exponent(.5)}function HD(s){return Math.sign(s)*s*s}function M4e(s){return Math.sign(s)*Math.sqrt(Math.abs(s))}function IU(){var s=aE(),t=[0,1],r=!1,n;function a(i){var o=M4e(s(i));return isNaN(o)?n:r?Math.round(o):o}return a.invert=function(i){return s.invert(HD(i))},a.domain=function(i){return arguments.length?(s.domain(i),a):s.domain()},a.range=function(i){return arguments.length?(s.range((t=Array.from(i,X1)).map(HD)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(s.clamp(i),a):s.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return IU(s.domain(),t).round(r).clamp(s.clamp()).unknown(n)},cd.apply(a,arguments),Gm(a)}function PU(){var s=[],t=[],r=[],n;function a(){var o=0,l=Math.max(1,t.length);for(r=new Array(l-1);++o<l;)r[o-1]=zCe(s,o/l);return i}function i(o){return o==null||isNaN(o=+o)?n:t[py(r,o)]}return i.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:s[0],l<r.length?r[l]:s[s.length-1]]},i.domain=function(o){if(!arguments.length)return s.slice();s=[];for(let l of o)l!=null&&!isNaN(l=+l)&&s.push(l);return s.sort(_m),a()},i.range=function(o){return arguments.length?(t=Array.from(o),a()):t.slice()},i.unknown=function(o){return arguments.length?(n=o,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return PU().domain(s).range(t).unknown(n)},cd.apply(i,arguments)}function _U(){var s=0,t=1,r=1,n=[.5],a=[0,1],i;function o(c){return c!=null&&c<=c?a[py(n,c,0,r)]:i}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*s)/(r+1);return o}return o.domain=function(c){return arguments.length?([s,t]=c,s=+s,t=+t,l()):[s,t]},o.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,l()):a.slice()},o.invertExtent=function(c){var d=a.indexOf(c);return d<0?[NaN,NaN]:d<1?[s,n[0]]:d>=r?[n[r-1],t]:[n[d-1],n[d]]},o.unknown=function(c){return arguments.length&&(i=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return _U().domain([s,t]).range(a).unknown(i)},cd.apply(Gm(o),arguments)}function kU(){var s=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[py(s,i,0,n)]:r}return a.domain=function(i){return arguments.length?(s=Array.from(i),n=Math.min(s.length,t.length-1),a):s.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(s.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var o=t.indexOf(i);return[s[o-1],s[o]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return kU().domain(s).range(t).unknown(r)},cd.apply(a,arguments)}const jS=new Date,bS=new Date;function Po(s,t,r,n){function a(i){return s(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(s(i=new Date(+i)),i),a.ceil=i=>(s(i=new Date(i-1)),t(i,1),s(i),i),a.round=i=>{const o=a(i),l=a.ceil(i);return i-o<l-i?o:l},a.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),a.range=(i,o,l)=>{const c=[];if(i=a.ceil(i),l=l==null?1:Math.floor(l),!(i<o)||!(l>0))return c;let d;do c.push(d=new Date(+i)),t(i,l),s(i);while(d<i&&i<o);return c},a.filter=i=>Po(o=>{if(o>=o)for(;s(o),!i(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!i(o););else for(;--l>=0;)for(;t(o,1),!i(o););}),r&&(a.count=(i,o)=>(jS.setTime(+i),bS.setTime(+o),s(jS),s(bS),Math.floor(r(jS,bS))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?o=>n(o)%i===0:o=>a.count(0,o)%i===0):a)),a}const eb=Po(()=>{},(s,t)=>{s.setTime(+s+t)},(s,t)=>t-s);eb.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?Po(t=>{t.setTime(Math.floor(t/s)*s)},(t,r)=>{t.setTime(+t+r*s)},(t,r)=>(r-t)/s):eb);eb.range;const Ju=1e3,ed=Ju*60,Xu=ed*60,hh=Xu*24,hE=hh*7,GD=hh*30,NS=hh*365,Af=Po(s=>{s.setTime(s-s.getMilliseconds())},(s,t)=>{s.setTime(+s+t*Ju)},(s,t)=>(t-s)/Ju,s=>s.getUTCSeconds());Af.range;const mE=Po(s=>{s.setTime(s-s.getMilliseconds()-s.getSeconds()*Ju)},(s,t)=>{s.setTime(+s+t*ed)},(s,t)=>(t-s)/ed,s=>s.getMinutes());mE.range;const fE=Po(s=>{s.setUTCSeconds(0,0)},(s,t)=>{s.setTime(+s+t*ed)},(s,t)=>(t-s)/ed,s=>s.getUTCMinutes());fE.range;const xE=Po(s=>{s.setTime(s-s.getMilliseconds()-s.getSeconds()*Ju-s.getMinutes()*ed)},(s,t)=>{s.setTime(+s+t*Xu)},(s,t)=>(t-s)/Xu,s=>s.getHours());xE.range;const pE=Po(s=>{s.setUTCMinutes(0,0,0)},(s,t)=>{s.setTime(+s+t*Xu)},(s,t)=>(t-s)/Xu,s=>s.getUTCHours());pE.range;const yy=Po(s=>s.setHours(0,0,0,0),(s,t)=>s.setDate(s.getDate()+t),(s,t)=>(t-s-(t.getTimezoneOffset()-s.getTimezoneOffset())*ed)/hh,s=>s.getDate()-1);yy.range;const KN=Po(s=>{s.setUTCHours(0,0,0,0)},(s,t)=>{s.setUTCDate(s.getUTCDate()+t)},(s,t)=>(t-s)/hh,s=>s.getUTCDate()-1);KN.range;const TU=Po(s=>{s.setUTCHours(0,0,0,0)},(s,t)=>{s.setUTCDate(s.getUTCDate()+t)},(s,t)=>(t-s)/hh,s=>Math.floor(s/hh));TU.range;function px(s){return Po(t=>{t.setDate(t.getDate()-(t.getDay()+7-s)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*ed)/hE)}const YN=px(0),tb=px(1),L4e=px(2),$4e=px(3),qp=px(4),B4e=px(5),U4e=px(6);YN.range;tb.range;L4e.range;$4e.range;qp.range;B4e.range;U4e.range;function gx(s){return Po(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-s)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/hE)}const JN=gx(0),sb=gx(1),z4e=gx(2),q4e=gx(3),Vp=gx(4),V4e=gx(5),W4e=gx(6);JN.range;sb.range;z4e.range;q4e.range;Vp.range;V4e.range;W4e.range;const gE=Po(s=>{s.setDate(1),s.setHours(0,0,0,0)},(s,t)=>{s.setMonth(s.getMonth()+t)},(s,t)=>t.getMonth()-s.getMonth()+(t.getFullYear()-s.getFullYear())*12,s=>s.getMonth());gE.range;const vE=Po(s=>{s.setUTCDate(1),s.setUTCHours(0,0,0,0)},(s,t)=>{s.setUTCMonth(s.getUTCMonth()+t)},(s,t)=>t.getUTCMonth()-s.getUTCMonth()+(t.getUTCFullYear()-s.getUTCFullYear())*12,s=>s.getUTCMonth());vE.range;const mh=Po(s=>{s.setMonth(0,1),s.setHours(0,0,0,0)},(s,t)=>{s.setFullYear(s.getFullYear()+t)},(s,t)=>t.getFullYear()-s.getFullYear(),s=>s.getFullYear());mh.every=s=>!isFinite(s=Math.floor(s))||!(s>0)?null:Po(t=>{t.setFullYear(Math.floor(t.getFullYear()/s)*s),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*s)});mh.range;const fh=Po(s=>{s.setUTCMonth(0,1),s.setUTCHours(0,0,0,0)},(s,t)=>{s.setUTCFullYear(s.getUTCFullYear()+t)},(s,t)=>t.getUTCFullYear()-s.getUTCFullYear(),s=>s.getUTCFullYear());fh.every=s=>!isFinite(s=Math.floor(s))||!(s>0)?null:Po(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/s)*s),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*s)});fh.range;function DU(s,t,r,n,a,i){const o=[[Af,1,Ju],[Af,5,5*Ju],[Af,15,15*Ju],[Af,30,30*Ju],[i,1,ed],[i,5,5*ed],[i,15,15*ed],[i,30,30*ed],[a,1,Xu],[a,3,3*Xu],[a,6,6*Xu],[a,12,12*Xu],[n,1,hh],[n,2,2*hh],[r,1,hE],[t,1,GD],[t,3,3*GD],[s,1,NS]];function l(d,u,h){const f=u<d;f&&([d,u]=[u,d]);const m=h&&typeof h.range=="function"?h:c(d,u,h),p=m?m.range(d,+u+1):[];return f?p.reverse():p}function c(d,u,h){const f=Math.abs(u-d)/h,m=eE(([,,v])=>v).right(o,f);if(m===o.length)return s.every(eA(d/NS,u/NS,h));if(m===0)return eb.every(Math.max(eA(d,u,h),1));const[p,g]=o[f/o[m-1][2]<o[m][2]/f?m-1:m];return p.every(g)}return[l,c]}const[H4e,G4e]=DU(fh,vE,JN,TU,pE,fE),[K4e,Y4e]=DU(mh,gE,YN,yy,xE,mE);function wS(s){if(0<=s.y&&s.y<100){var t=new Date(-1,s.m,s.d,s.H,s.M,s.S,s.L);return t.setFullYear(s.y),t}return new Date(s.y,s.m,s.d,s.H,s.M,s.S,s.L)}function SS(s){if(0<=s.y&&s.y<100){var t=new Date(Date.UTC(-1,s.m,s.d,s.H,s.M,s.S,s.L));return t.setUTCFullYear(s.y),t}return new Date(Date.UTC(s.y,s.m,s.d,s.H,s.M,s.S,s.L))}function u0(s,t,r){return{y:s,m:t,d:r,H:0,M:0,S:0,L:0}}function J4e(s){var t=s.dateTime,r=s.date,n=s.time,a=s.periods,i=s.days,o=s.shortDays,l=s.months,c=s.shortMonths,d=h0(a),u=m0(a),h=h0(i),f=m0(i),m=h0(o),p=m0(o),g=h0(l),v=m0(l),y=h0(c),j=m0(c),b={a:J,A:z,b:U,B:oe,c:null,d:ZD,e:ZD,f:yAe,g:PAe,G:kAe,H:pAe,I:gAe,j:vAe,L:OU,m:jAe,M:bAe,p:Q,q:P,Q:sO,s:rO,S:NAe,u:wAe,U:SAe,V:CAe,w:AAe,W:EAe,x:null,X:null,y:IAe,Y:_Ae,Z:TAe,"%":tO},w={a:q,A:D,b:se,B:he,c:null,d:eO,e:eO,f:FAe,g:HAe,G:KAe,H:DAe,I:OAe,j:RAe,L:FU,m:MAe,M:LAe,p:be,q:pe,Q:sO,s:rO,S:$Ae,u:BAe,U:UAe,V:zAe,w:qAe,W:VAe,x:null,X:null,y:WAe,Y:GAe,Z:YAe,"%":tO},N={a:F,A,b:T,B:V,c:M,d:XD,e:XD,f:hAe,g:JD,G:YD,H:QD,I:QD,j:lAe,L:uAe,m:oAe,M:cAe,p:k,q:iAe,Q:fAe,s:xAe,S:dAe,u:tAe,U:sAe,V:rAe,w:eAe,W:nAe,x:G,X:L,y:JD,Y:YD,Z:aAe,"%":mAe};b.x=C(r,b),b.X=C(n,b),b.c=C(t,b),w.x=C(r,w),w.X=C(n,w),w.c=C(t,w);function C(Ae,Ee){return function($e){var O=[],te=-1,re=0,le=Ae.length,Z,K,X;for($e instanceof Date||($e=new Date(+$e));++te<le;)Ae.charCodeAt(te)===37&&(O.push(Ae.slice(re,te)),(K=KD[Z=Ae.charAt(++te)])!=null?Z=Ae.charAt(++te):K=Z==="e"?" ":"0",(X=Ee[Z])&&(Z=X($e,K)),O.push(Z),re=te+1);return O.push(Ae.slice(re,te)),O.join("")}}function S(Ae,Ee){return function($e){var O=u0(1900,void 0,1),te=_(O,Ae,$e+="",0),re,le;if(te!=$e.length)return null;if("Q"in O)return new Date(O.Q);if("s"in O)return new Date(O.s*1e3+("L"in O?O.L:0));if(Ee&&!("Z"in O)&&(O.Z=0),"p"in O&&(O.H=O.H%12+O.p*12),O.m===void 0&&(O.m="q"in O?O.q:0),"V"in O){if(O.V<1||O.V>53)return null;"w"in O||(O.w=1),"Z"in O?(re=SS(u0(O.y,0,1)),le=re.getUTCDay(),re=le>4||le===0?sb.ceil(re):sb(re),re=KN.offset(re,(O.V-1)*7),O.y=re.getUTCFullYear(),O.m=re.getUTCMonth(),O.d=re.getUTCDate()+(O.w+6)%7):(re=wS(u0(O.y,0,1)),le=re.getDay(),re=le>4||le===0?tb.ceil(re):tb(re),re=yy.offset(re,(O.V-1)*7),O.y=re.getFullYear(),O.m=re.getMonth(),O.d=re.getDate()+(O.w+6)%7)}else("W"in O||"U"in O)&&("w"in O||(O.w="u"in O?O.u%7:"W"in O?1:0),le="Z"in O?SS(u0(O.y,0,1)).getUTCDay():wS(u0(O.y,0,1)).getDay(),O.m=0,O.d="W"in O?(O.w+6)%7+O.W*7-(le+5)%7:O.w+O.U*7-(le+6)%7);return"Z"in O?(O.H+=O.Z/100|0,O.M+=O.Z%100,SS(O)):wS(O)}}function _(Ae,Ee,$e,O){for(var te=0,re=Ee.length,le=$e.length,Z,K;te<re;){if(O>=le)return-1;if(Z=Ee.charCodeAt(te++),Z===37){if(Z=Ee.charAt(te++),K=N[Z in KD?Ee.charAt(te++):Z],!K||(O=K(Ae,$e,O))<0)return-1}else if(Z!=$e.charCodeAt(O++))return-1}return O}function k(Ae,Ee,$e){var O=d.exec(Ee.slice($e));return O?(Ae.p=u.get(O[0].toLowerCase()),$e+O[0].length):-1}function F(Ae,Ee,$e){var O=m.exec(Ee.slice($e));return O?(Ae.w=p.get(O[0].toLowerCase()),$e+O[0].length):-1}function A(Ae,Ee,$e){var O=h.exec(Ee.slice($e));return O?(Ae.w=f.get(O[0].toLowerCase()),$e+O[0].length):-1}function T(Ae,Ee,$e){var O=y.exec(Ee.slice($e));return O?(Ae.m=j.get(O[0].toLowerCase()),$e+O[0].length):-1}function V(Ae,Ee,$e){var O=g.exec(Ee.slice($e));return O?(Ae.m=v.get(O[0].toLowerCase()),$e+O[0].length):-1}function M(Ae,Ee,$e){return _(Ae,t,Ee,$e)}function G(Ae,Ee,$e){return _(Ae,r,Ee,$e)}function L(Ae,Ee,$e){return _(Ae,n,Ee,$e)}function J(Ae){return o[Ae.getDay()]}function z(Ae){return i[Ae.getDay()]}function U(Ae){return c[Ae.getMonth()]}function oe(Ae){return l[Ae.getMonth()]}function Q(Ae){return a[+(Ae.getHours()>=12)]}function P(Ae){return 1+~~(Ae.getMonth()/3)}function q(Ae){return o[Ae.getUTCDay()]}function D(Ae){return i[Ae.getUTCDay()]}function se(Ae){return c[Ae.getUTCMonth()]}function he(Ae){return l[Ae.getUTCMonth()]}function be(Ae){return a[+(Ae.getUTCHours()>=12)]}function pe(Ae){return 1+~~(Ae.getUTCMonth()/3)}return{format:function(Ae){var Ee=C(Ae+="",b);return Ee.toString=function(){return Ae},Ee},parse:function(Ae){var Ee=S(Ae+="",!1);return Ee.toString=function(){return Ae},Ee},utcFormat:function(Ae){var Ee=C(Ae+="",w);return Ee.toString=function(){return Ae},Ee},utcParse:function(Ae){var Ee=S(Ae+="",!0);return Ee.toString=function(){return Ae},Ee}}}var KD={"-":"",_:" ",0:"0"},Uo=/^\s*\d+/,X4e=/^%/,Q4e=/[\\^$*+?|[\]().{}]/g;function ra(s,t,r){var n=s<0?"-":"",a=(n?-s:s)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function Z4e(s){return s.replace(Q4e,"\\$&")}function h0(s){return new RegExp("^(?:"+s.map(Z4e).join("|")+")","i")}function m0(s){return new Map(s.map((t,r)=>[t.toLowerCase(),r]))}function eAe(s,t,r){var n=Uo.exec(t.slice(r,r+1));return n?(s.w=+n[0],r+n[0].length):-1}function tAe(s,t,r){var n=Uo.exec(t.slice(r,r+1));return n?(s.u=+n[0],r+n[0].length):-1}function sAe(s,t,r){var n=Uo.exec(t.slice(r,r+2));return n?(s.U=+n[0],r+n[0].length):-1}function rAe(s,t,r){var n=Uo.exec(t.slice(r,r+2));return n?(s.V=+n[0],r+n[0].length):-1}function nAe(s,t,r){var n=Uo.exec(t.slice(r,r+2));return n?(s.W=+n[0],r+n[0].length):-1}function YD(s,t,r){var n=Uo.exec(t.slice(r,r+4));return n?(s.y=+n[0],r+n[0].length):-1}function JD(s,t,r){var n=Uo.exec(t.slice(r,r+2));return n?(s.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function aAe(s,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(s.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function iAe(s,t,r){var n=Uo.exec(t.slice(r,r+1));return n?(s.q=n[0]*3-3,r+n[0].length):-1}function oAe(s,t,r){var n=Uo.exec(t.slice(r,r+2));return n?(s.m=n[0]-1,r+n[0].length):-1}function XD(s,t,r){var n=Uo.exec(t.slice(r,r+2));return n?(s.d=+n[0],r+n[0].length):-1}function lAe(s,t,r){var n=Uo.exec(t.slice(r,r+3));return n?(s.m=0,s.d=+n[0],r+n[0].length):-1}function QD(s,t,r){var n=Uo.exec(t.slice(r,r+2));return n?(s.H=+n[0],r+n[0].length):-1}function cAe(s,t,r){var n=Uo.exec(t.slice(r,r+2));return n?(s.M=+n[0],r+n[0].length):-1}function dAe(s,t,r){var n=Uo.exec(t.slice(r,r+2));return n?(s.S=+n[0],r+n[0].length):-1}function uAe(s,t,r){var n=Uo.exec(t.slice(r,r+3));return n?(s.L=+n[0],r+n[0].length):-1}function hAe(s,t,r){var n=Uo.exec(t.slice(r,r+6));return n?(s.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function mAe(s,t,r){var n=X4e.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function fAe(s,t,r){var n=Uo.exec(t.slice(r));return n?(s.Q=+n[0],r+n[0].length):-1}function xAe(s,t,r){var n=Uo.exec(t.slice(r));return n?(s.s=+n[0],r+n[0].length):-1}function ZD(s,t){return ra(s.getDate(),t,2)}function pAe(s,t){return ra(s.getHours(),t,2)}function gAe(s,t){return ra(s.getHours()%12||12,t,2)}function vAe(s,t){return ra(1+yy.count(mh(s),s),t,3)}function OU(s,t){return ra(s.getMilliseconds(),t,3)}function yAe(s,t){return OU(s,t)+"000"}function jAe(s,t){return ra(s.getMonth()+1,t,2)}function bAe(s,t){return ra(s.getMinutes(),t,2)}function NAe(s,t){return ra(s.getSeconds(),t,2)}function wAe(s){var t=s.getDay();return t===0?7:t}function SAe(s,t){return ra(YN.count(mh(s)-1,s),t,2)}function RU(s){var t=s.getDay();return t>=4||t===0?qp(s):qp.ceil(s)}function CAe(s,t){return s=RU(s),ra(qp.count(mh(s),s)+(mh(s).getDay()===4),t,2)}function AAe(s){return s.getDay()}function EAe(s,t){return ra(tb.count(mh(s)-1,s),t,2)}function IAe(s,t){return ra(s.getFullYear()%100,t,2)}function PAe(s,t){return s=RU(s),ra(s.getFullYear()%100,t,2)}function _Ae(s,t){return ra(s.getFullYear()%1e4,t,4)}function kAe(s,t){var r=s.getDay();return s=r>=4||r===0?qp(s):qp.ceil(s),ra(s.getFullYear()%1e4,t,4)}function TAe(s){var t=s.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+ra(t/60|0,"0",2)+ra(t%60,"0",2)}function eO(s,t){return ra(s.getUTCDate(),t,2)}function DAe(s,t){return ra(s.getUTCHours(),t,2)}function OAe(s,t){return ra(s.getUTCHours()%12||12,t,2)}function RAe(s,t){return ra(1+KN.count(fh(s),s),t,3)}function FU(s,t){return ra(s.getUTCMilliseconds(),t,3)}function FAe(s,t){return FU(s,t)+"000"}function MAe(s,t){return ra(s.getUTCMonth()+1,t,2)}function LAe(s,t){return ra(s.getUTCMinutes(),t,2)}function $Ae(s,t){return ra(s.getUTCSeconds(),t,2)}function BAe(s){var t=s.getUTCDay();return t===0?7:t}function UAe(s,t){return ra(JN.count(fh(s)-1,s),t,2)}function MU(s){var t=s.getUTCDay();return t>=4||t===0?Vp(s):Vp.ceil(s)}function zAe(s,t){return s=MU(s),ra(Vp.count(fh(s),s)+(fh(s).getUTCDay()===4),t,2)}function qAe(s){return s.getUTCDay()}function VAe(s,t){return ra(sb.count(fh(s)-1,s),t,2)}function WAe(s,t){return ra(s.getUTCFullYear()%100,t,2)}function HAe(s,t){return s=MU(s),ra(s.getUTCFullYear()%100,t,2)}function GAe(s,t){return ra(s.getUTCFullYear()%1e4,t,4)}function KAe(s,t){var r=s.getUTCDay();return s=r>=4||r===0?Vp(s):Vp.ceil(s),ra(s.getUTCFullYear()%1e4,t,4)}function YAe(){return"+0000"}function tO(){return"%"}function sO(s){return+s}function rO(s){return Math.floor(+s/1e3)}var Rx,LU,$U;JAe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function JAe(s){return Rx=J4e(s),LU=Rx.format,Rx.parse,$U=Rx.utcFormat,Rx.utcParse,Rx}function XAe(s){return new Date(s)}function QAe(s){return s instanceof Date?+s:+new Date(+s)}function yE(s,t,r,n,a,i,o,l,c,d){var u=aE(),h=u.invert,f=u.domain,m=d(".%L"),p=d(":%S"),g=d("%I:%M"),v=d("%I %p"),y=d("%a %d"),j=d("%b %d"),b=d("%B"),w=d("%Y");function N(C){return(c(C)<C?m:l(C)<C?p:o(C)<C?g:i(C)<C?v:n(C)<C?a(C)<C?y:j:r(C)<C?b:w)(C)}return u.invert=function(C){return new Date(h(C))},u.domain=function(C){return arguments.length?f(Array.from(C,QAe)):f().map(XAe)},u.ticks=function(C){var S=f();return s(S[0],S[S.length-1],C??10)},u.tickFormat=function(C,S){return S==null?N:d(S)},u.nice=function(C){var S=f();return(!C||typeof C.range!="function")&&(C=t(S[0],S[S.length-1],C??10)),C?f(CU(S,C)):u},u.copy=function(){return vy(u,yE(s,t,r,n,a,i,o,l,c,d))},u}function ZAe(){return cd.apply(yE(K4e,Y4e,mh,gE,YN,yy,xE,mE,Af,LU).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function e5e(){return cd.apply(yE(H4e,G4e,fh,vE,JN,KN,pE,fE,Af,$U).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function XN(){var s=0,t=1,r,n,a,i,o=Dl,l=!1,c;function d(h){return h==null||isNaN(h=+h)?c:o(a===0?.5:(h=(i(h)-r)*a,l?Math.max(0,Math.min(1,h)):h))}d.domain=function(h){return arguments.length?([s,t]=h,r=i(s=+s),n=i(t=+t),a=r===n?0:1/(n-r),d):[s,t]},d.clamp=function(h){return arguments.length?(l=!!h,d):l},d.interpolator=function(h){return arguments.length?(o=h,d):o};function u(h){return function(f){var m,p;return arguments.length?([m,p]=f,o=h(m,p),d):[o(0),o(1)]}}return d.range=u(Rg),d.rangeRound=u(nE),d.unknown=function(h){return arguments.length?(c=h,d):c},function(h){return i=h,r=h(s),n=h(t),a=r===n?0:1/(n-r),d}}function Km(s,t){return t.domain(s.domain()).interpolator(s.interpolator()).clamp(s.clamp()).unknown(s.unknown())}function BU(){var s=Gm(XN()(Dl));return s.copy=function(){return Km(s,BU())},jh.apply(s,arguments)}function UU(){var s=lE(XN()).domain([1,10]);return s.copy=function(){return Km(s,UU()).base(s.base())},jh.apply(s,arguments)}function zU(){var s=cE(XN());return s.copy=function(){return Km(s,zU()).constant(s.constant())},jh.apply(s,arguments)}function jE(){var s=dE(XN());return s.copy=function(){return Km(s,jE()).exponent(s.exponent())},jh.apply(s,arguments)}function t5e(){return jE.apply(null,arguments).exponent(.5)}function qU(){var s=[],t=Dl;function r(n){if(n!=null&&!isNaN(n=+n))return t((py(s,n,1)-1)/(s.length-1))}return r.domain=function(n){if(!arguments.length)return s.slice();s=[];for(let a of n)a!=null&&!isNaN(a=+a)&&s.push(a);return s.sort(_m),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return s.map((n,a)=>t(a/(s.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>UCe(s,i/n))},r.copy=function(){return qU(t).domain(s)},jh.apply(r,arguments)}function QN(){var s=0,t=.5,r=1,n=1,a,i,o,l,c,d=Dl,u,h=!1,f;function m(g){return isNaN(g=+g)?f:(g=.5+((g=+u(g))-i)*(n*g<n*i?l:c),d(h?Math.max(0,Math.min(1,g)):g))}m.domain=function(g){return arguments.length?([s,t,r]=g,a=u(s=+s),i=u(t=+t),o=u(r=+r),l=a===i?0:.5/(i-a),c=i===o?0:.5/(o-i),n=i<a?-1:1,m):[s,t,r]},m.clamp=function(g){return arguments.length?(h=!!g,m):h},m.interpolator=function(g){return arguments.length?(d=g,m):d};function p(g){return function(v){var y,j,b;return arguments.length?([y,j,b]=v,d=m4e(g,[y,j,b]),m):[d(0),d(.5),d(1)]}}return m.range=p(Rg),m.rangeRound=p(nE),m.unknown=function(g){return arguments.length?(f=g,m):f},function(g){return u=g,a=g(s),i=g(t),o=g(r),l=a===i?0:.5/(i-a),c=i===o?0:.5/(o-i),n=i<a?-1:1,m}}function VU(){var s=Gm(QN()(Dl));return s.copy=function(){return Km(s,VU())},jh.apply(s,arguments)}function WU(){var s=lE(QN()).domain([.1,1,10]);return s.copy=function(){return Km(s,WU()).base(s.base())},jh.apply(s,arguments)}function HU(){var s=cE(QN());return s.copy=function(){return Km(s,HU()).constant(s.constant())},jh.apply(s,arguments)}function bE(){var s=dE(QN());return s.copy=function(){return Km(s,bE()).exponent(s.exponent())},jh.apply(s,arguments)}function s5e(){return bE.apply(null,arguments).exponent(.5)}const nO=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:yv,scaleDiverging:VU,scaleDivergingLog:WU,scaleDivergingPow:bE,scaleDivergingSqrt:s5e,scaleDivergingSymlog:HU,scaleIdentity:SU,scaleImplicit:tA,scaleLinear:Z1,scaleLog:AU,scaleOrdinal:tE,scalePoint:W0,scalePow:uE,scaleQuantile:PU,scaleQuantize:_U,scaleRadial:IU,scaleSequential:BU,scaleSequentialLog:UU,scaleSequentialPow:jE,scaleSequentialQuantile:qU,scaleSequentialSqrt:t5e,scaleSequentialSymlog:zU,scaleSqrt:F4e,scaleSymlog:EU,scaleThreshold:kU,scaleTime:ZAe,scaleUtc:e5e,tickFormat:wU},Symbol.toStringTag,{value:"Module"}));var r5e=Ag;function n5e(s,t,r){for(var n=-1,a=s.length;++n<a;){var i=s[n],o=t(i);if(o!=null&&(l===void 0?o===o&&!r5e(o):r(o,l)))var l=o,c=i}return c}var ZN=n5e;function a5e(s,t){return s>t}var GU=a5e,i5e=ZN,o5e=GU,l5e=Og;function c5e(s){return s&&s.length?i5e(s,l5e,o5e):void 0}var d5e=c5e;const gm=Ca(d5e);function u5e(s,t){return s<t}var KU=u5e,h5e=ZN,m5e=KU,f5e=Og;function x5e(s){return s&&s.length?h5e(s,f5e,m5e):void 0}var p5e=x5e;const ew=Ca(p5e);var g5e=F3,v5e=bu,y5e=sU,j5e=cc;function b5e(s,t){var r=j5e(s)?g5e:y5e;return r(s,v5e(t))}var N5e=b5e,w5e=eU,S5e=N5e;function C5e(s,t){return w5e(S5e(s,t),1)}var A5e=C5e;const E5e=Ca(A5e);var I5e=J3;function P5e(s,t){return I5e(s,t)}var _5e=P5e;const Lm=Ca(_5e);var Fg=1e9,k5e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},wE,gi=!0,nd="[DecimalError] ",Wf=nd+"Invalid argument: ",NE=nd+"Exponent out of range: ",Mg=Math.floor,xf=Math.pow,T5e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ac,Fo=1e7,ci=7,YU=9007199254740991,rb=Mg(YU/ci),sr={};sr.absoluteValue=sr.abs=function(){var s=new this.constructor(this);return s.s&&(s.s=1),s};sr.comparedTo=sr.cmp=function(s){var t,r,n,a,i=this;if(s=new i.constructor(s),i.s!==s.s)return i.s||-s.s;if(i.e!==s.e)return i.e>s.e^i.s<0?1:-1;for(n=i.d.length,a=s.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==s.d[t])return i.d[t]>s.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};sr.decimalPlaces=sr.dp=function(){var s=this,t=s.d.length-1,r=(t-s.e)*ci;if(t=s.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};sr.dividedBy=sr.div=function(s){return nh(this,new this.constructor(s))};sr.dividedToIntegerBy=sr.idiv=function(s){var t=this,r=t.constructor;return Ba(nh(t,new r(s),0,1),r.precision)};sr.equals=sr.eq=function(s){return!this.cmp(s)};sr.exponent=function(){return ao(this)};sr.greaterThan=sr.gt=function(s){return this.cmp(s)>0};sr.greaterThanOrEqualTo=sr.gte=function(s){return this.cmp(s)>=0};sr.isInteger=sr.isint=function(){return this.e>this.d.length-2};sr.isNegative=sr.isneg=function(){return this.s<0};sr.isPositive=sr.ispos=function(){return this.s>0};sr.isZero=function(){return this.s===0};sr.lessThan=sr.lt=function(s){return this.cmp(s)<0};sr.lessThanOrEqualTo=sr.lte=function(s){return this.cmp(s)<1};sr.logarithm=sr.log=function(s){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(s===void 0)s=new n(10);else if(s=new n(s),s.s<1||s.eq(Ac))throw Error(nd+"NaN");if(r.s<1)throw Error(nd+(r.s?"NaN":"-Infinity"));return r.eq(Ac)?new n(0):(gi=!1,t=nh(Sv(r,i),Sv(s,i),i),gi=!0,Ba(t,a))};sr.minus=sr.sub=function(s){var t=this;return s=new t.constructor(s),t.s==s.s?QU(t,s):JU(t,(s.s=-s.s,s))};sr.modulo=sr.mod=function(s){var t,r=this,n=r.constructor,a=n.precision;if(s=new n(s),!s.s)throw Error(nd+"NaN");return r.s?(gi=!1,t=nh(r,s,0,1).times(s),gi=!0,r.minus(t)):Ba(new n(r),a)};sr.naturalExponential=sr.exp=function(){return XU(this)};sr.naturalLogarithm=sr.ln=function(){return Sv(this)};sr.negated=sr.neg=function(){var s=new this.constructor(this);return s.s=-s.s||0,s};sr.plus=sr.add=function(s){var t=this;return s=new t.constructor(s),t.s==s.s?JU(t,s):QU(t,(s.s=-s.s,s))};sr.precision=sr.sd=function(s){var t,r,n,a=this;if(s!==void 0&&s!==!!s&&s!==1&&s!==0)throw Error(Wf+s);if(t=ao(a)+1,n=a.d.length-1,r=n*ci+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return s&&t>r?t:r};sr.squareRoot=sr.sqrt=function(){var s,t,r,n,a,i,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(nd+"NaN")}for(s=ao(l),gi=!1,a=Math.sqrt(+l),a==0||a==1/0?(t=ou(l.d),(t.length+s)%2==0&&(t+="0"),a=Math.sqrt(t),s=Mg((s+1)/2)-(s<0||s%2),a==1/0?t="5e"+s:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+s),n=new c(t)):n=new c(a.toString()),r=c.precision,a=o=r+3;;)if(i=n,n=i.plus(nh(l,i,o+2)).times(.5),ou(i.d).slice(0,o)===(t=ou(n.d)).slice(0,o)){if(t=t.slice(o-3,o+1),a==o&&t=="4999"){if(Ba(i,r+1,0),i.times(i).eq(l)){n=i;break}}else if(t!="9999")break;o+=4}return gi=!0,Ba(n,r)};sr.times=sr.mul=function(s){var t,r,n,a,i,o,l,c,d,u=this,h=u.constructor,f=u.d,m=(s=new h(s)).d;if(!u.s||!s.s)return new h(0);for(s.s*=u.s,r=u.e+s.e,c=f.length,d=m.length,c<d&&(i=f,f=m,m=i,o=c,c=d,d=o),i=[],o=c+d,n=o;n--;)i.push(0);for(n=d;--n>=0;){for(t=0,a=c+n;a>n;)l=i[a]+m[n]*f[a-n-1]+t,i[a--]=l%Fo|0,t=l/Fo|0;i[a]=(i[a]+t)%Fo|0}for(;!i[--o];)i.pop();return t?++r:i.shift(),s.d=i,s.e=r,gi?Ba(s,h.precision):s};sr.toDecimalPlaces=sr.todp=function(s,t){var r=this,n=r.constructor;return r=new n(r),s===void 0?r:(xu(s,0,Fg),t===void 0?t=n.rounding:xu(t,0,8),Ba(r,s+ao(r)+1,t))};sr.toExponential=function(s,t){var r,n=this,a=n.constructor;return s===void 0?r=ox(n,!0):(xu(s,0,Fg),t===void 0?t=a.rounding:xu(t,0,8),n=Ba(new a(n),s+1,t),r=ox(n,!0,s+1)),r};sr.toFixed=function(s,t){var r,n,a=this,i=a.constructor;return s===void 0?ox(a):(xu(s,0,Fg),t===void 0?t=i.rounding:xu(t,0,8),n=Ba(new i(a),s+ao(a)+1,t),r=ox(n.abs(),!1,s+ao(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};sr.toInteger=sr.toint=function(){var s=this,t=s.constructor;return Ba(new t(s),ao(s)+1,t.rounding)};sr.toNumber=function(){return+this};sr.toPower=sr.pow=function(s){var t,r,n,a,i,o,l=this,c=l.constructor,d=12,u=+(s=new c(s));if(!s.s)return new c(Ac);if(l=new c(l),!l.s){if(s.s<1)throw Error(nd+"Infinity");return l}if(l.eq(Ac))return l;if(n=c.precision,s.eq(Ac))return Ba(l,n);if(t=s.e,r=s.d.length-1,o=t>=r,i=l.s,o){if((r=u<0?-u:u)<=YU){for(a=new c(Ac),t=Math.ceil(n/ci+4),gi=!1;r%2&&(a=a.times(l),iO(a.d,t)),r=Mg(r/2),r!==0;)l=l.times(l),iO(l.d,t);return gi=!0,s.s<0?new c(Ac).div(a):Ba(a,n)}}else if(i<0)throw Error(nd+"NaN");return i=i<0&&s.d[Math.max(t,r)]&1?-1:1,l.s=1,gi=!1,a=s.times(Sv(l,n+d)),gi=!0,a=XU(a),a.s=i,a};sr.toPrecision=function(s,t){var r,n,a=this,i=a.constructor;return s===void 0?(r=ao(a),n=ox(a,r<=i.toExpNeg||r>=i.toExpPos)):(xu(s,1,Fg),t===void 0?t=i.rounding:xu(t,0,8),a=Ba(new i(a),s,t),r=ao(a),n=ox(a,s<=r||r<=i.toExpNeg,s)),n};sr.toSignificantDigits=sr.tosd=function(s,t){var r=this,n=r.constructor;return s===void 0?(s=n.precision,t=n.rounding):(xu(s,1,Fg),t===void 0?t=n.rounding:xu(t,0,8)),Ba(new n(r),s,t)};sr.toString=sr.valueOf=sr.val=sr.toJSON=sr[Symbol.for("nodejs.util.inspect.custom")]=function(){var s=this,t=ao(s),r=s.constructor;return ox(s,t<=r.toExpNeg||t>=r.toExpPos)};function JU(s,t){var r,n,a,i,o,l,c,d,u=s.constructor,h=u.precision;if(!s.s||!t.s)return t.s||(t=new u(s)),gi?Ba(t,h):t;if(c=s.d,d=t.d,o=s.e,a=t.e,c=c.slice(),i=o-a,i){for(i<0?(n=c,i=-i,l=d.length):(n=d,a=o,l=c.length),o=Math.ceil(h/ci),l=o>l?o+1:l+1,i>l&&(i=l,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(l=c.length,i=d.length,l-i<0&&(i=l,n=d,d=c,c=n),r=0;i;)r=(c[--i]=c[i]+d[i]+r)/Fo|0,c[i]%=Fo;for(r&&(c.unshift(r),++a),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=a,gi?Ba(t,h):t}function xu(s,t,r){if(s!==~~s||s<t||s>r)throw Error(Wf+s)}function ou(s){var t,r,n,a=s.length-1,i="",o=s[0];if(a>0){for(i+=o,t=1;t<a;t++)n=s[t]+"",r=ci-n.length,r&&(i+=Xh(r)),i+=n;o=s[t],n=o+"",r=ci-n.length,r&&(i+=Xh(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var nh=function(){function s(n,a){var i,o=0,l=n.length;for(n=n.slice();l--;)i=n[l]*a+o,n[l]=i%Fo|0,o=i/Fo|0;return o&&n.unshift(o),n}function t(n,a,i,o){var l,c;if(i!=o)c=i>o?1:-1;else for(l=c=0;l<i;l++)if(n[l]!=a[l]){c=n[l]>a[l]?1:-1;break}return c}function r(n,a,i){for(var o=0;i--;)n[i]-=o,o=n[i]<a[i]?1:0,n[i]=o*Fo+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,o){var l,c,d,u,h,f,m,p,g,v,y,j,b,w,N,C,S,_,k=n.constructor,F=n.s==a.s?1:-1,A=n.d,T=a.d;if(!n.s)return new k(n);if(!a.s)throw Error(nd+"Division by zero");for(c=n.e-a.e,S=T.length,N=A.length,m=new k(F),p=m.d=[],d=0;T[d]==(A[d]||0);)++d;if(T[d]>(A[d]||0)&&--c,i==null?j=i=k.precision:o?j=i+(ao(n)-ao(a))+1:j=i,j<0)return new k(0);if(j=j/ci+2|0,d=0,S==1)for(u=0,T=T[0],j++;(d<N||u)&&j--;d++)b=u*Fo+(A[d]||0),p[d]=b/T|0,u=b%T|0;else{for(u=Fo/(T[0]+1)|0,u>1&&(T=s(T,u),A=s(A,u),S=T.length,N=A.length),w=S,g=A.slice(0,S),v=g.length;v<S;)g[v++]=0;_=T.slice(),_.unshift(0),C=T[0],T[1]>=Fo/2&&++C;do u=0,l=t(T,g,S,v),l<0?(y=g[0],S!=v&&(y=y*Fo+(g[1]||0)),u=y/C|0,u>1?(u>=Fo&&(u=Fo-1),h=s(T,u),f=h.length,v=g.length,l=t(h,g,f,v),l==1&&(u--,r(h,S<f?_:T,f))):(u==0&&(l=u=1),h=T.slice()),f=h.length,f<v&&h.unshift(0),r(g,h,v),l==-1&&(v=g.length,l=t(T,g,S,v),l<1&&(u++,r(g,S<v?_:T,v))),v=g.length):l===0&&(u++,g=[0]),p[d++]=u,l&&g[0]?g[v++]=A[w]||0:(g=[A[w]],v=1);while((w++<N||g[0]!==void 0)&&j--)}return p[0]||p.shift(),m.e=c,Ba(m,o?i+ao(m)+1:i)}}();function XU(s,t){var r,n,a,i,o,l,c=0,d=0,u=s.constructor,h=u.precision;if(ao(s)>16)throw Error(NE+ao(s));if(!s.s)return new u(Ac);for(gi=!1,l=h,o=new u(.03125);s.abs().gte(.1);)s=s.times(o),d+=5;for(n=Math.log(xf(2,d))/Math.LN10*2+5|0,l+=n,r=a=i=new u(Ac),u.precision=l;;){if(a=Ba(a.times(s),l),r=r.times(++c),o=i.plus(nh(a,r,l)),ou(o.d).slice(0,l)===ou(i.d).slice(0,l)){for(;d--;)i=Ba(i.times(i),l);return u.precision=h,t==null?(gi=!0,Ba(i,h)):i}i=o}}function ao(s){for(var t=s.e*ci,r=s.d[0];r>=10;r/=10)t++;return t}function CS(s,t,r){if(t>s.LN10.sd())throw gi=!0,r&&(s.precision=r),Error(nd+"LN10 precision limit exceeded");return Ba(new s(s.LN10),t)}function Xh(s){for(var t="";s--;)t+="0";return t}function Sv(s,t){var r,n,a,i,o,l,c,d,u,h=1,f=10,m=s,p=m.d,g=m.constructor,v=g.precision;if(m.s<1)throw Error(nd+(m.s?"NaN":"-Infinity"));if(m.eq(Ac))return new g(0);if(t==null?(gi=!1,d=v):d=t,m.eq(10))return t==null&&(gi=!0),CS(g,d);if(d+=f,g.precision=d,r=ou(p),n=r.charAt(0),i=ao(m),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)m=m.times(s),r=ou(m.d),n=r.charAt(0),h++;i=ao(m),n>1?(m=new g("0."+r),i++):m=new g(n+"."+r.slice(1))}else return c=CS(g,d+2,v).times(i+""),m=Sv(new g(n+"."+r.slice(1)),d-f).plus(c),g.precision=v,t==null?(gi=!0,Ba(m,v)):m;for(l=o=m=nh(m.minus(Ac),m.plus(Ac),d),u=Ba(m.times(m),d),a=3;;){if(o=Ba(o.times(u),d),c=l.plus(nh(o,new g(a),d)),ou(c.d).slice(0,d)===ou(l.d).slice(0,d))return l=l.times(2),i!==0&&(l=l.plus(CS(g,d+2,v).times(i+""))),l=nh(l,new g(h),d),g.precision=v,t==null?(gi=!0,Ba(l,v)):l;l=c,a+=2}}function aO(s,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,s.e=Mg(r/ci),s.d=[],n=(r+1)%ci,r<0&&(n+=ci),n<a){for(n&&s.d.push(+t.slice(0,n)),a-=ci;n<a;)s.d.push(+t.slice(n,n+=ci));t=t.slice(n),n=ci-t.length}else n-=a;for(;n--;)t+="0";if(s.d.push(+t),gi&&(s.e>rb||s.e<-rb))throw Error(NE+r)}else s.s=0,s.e=0,s.d=[0];return s}function Ba(s,t,r){var n,a,i,o,l,c,d,u,h=s.d;for(o=1,i=h[0];i>=10;i/=10)o++;if(n=t-o,n<0)n+=ci,a=t,d=h[u=0];else{if(u=Math.ceil((n+1)/ci),i=h.length,u>=i)return s;for(d=i=h[u],o=1;i>=10;i/=10)o++;n%=ci,a=n-ci+o}if(r!==void 0&&(i=xf(10,o-a-1),l=d/i%10|0,c=t<0||h[u+1]!==void 0||d%i,c=r<4?(l||c)&&(r==0||r==(s.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?a>0?d/xf(10,o-a):0:h[u-1])%10&1||r==(s.s<0?8:7))),t<1||!h[0])return c?(i=ao(s),h.length=1,t=t-i-1,h[0]=xf(10,(ci-t%ci)%ci),s.e=Mg(-t/ci)||0):(h.length=1,h[0]=s.e=s.s=0),s;if(n==0?(h.length=u,i=1,u--):(h.length=u+1,i=xf(10,ci-n),h[u]=a>0?(d/xf(10,o-a)%xf(10,a)|0)*i:0),c)for(;;)if(u==0){(h[0]+=i)==Fo&&(h[0]=1,++s.e);break}else{if(h[u]+=i,h[u]!=Fo)break;h[u--]=0,i=1}for(n=h.length;h[--n]===0;)h.pop();if(gi&&(s.e>rb||s.e<-rb))throw Error(NE+ao(s));return s}function QU(s,t){var r,n,a,i,o,l,c,d,u,h,f=s.constructor,m=f.precision;if(!s.s||!t.s)return t.s?t.s=-t.s:t=new f(s),gi?Ba(t,m):t;if(c=s.d,h=t.d,n=t.e,d=s.e,c=c.slice(),o=d-n,o){for(u=o<0,u?(r=c,o=-o,l=h.length):(r=h,n=d,l=c.length),a=Math.max(Math.ceil(m/ci),l)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=c.length,l=h.length,u=a<l,u&&(l=a),a=0;a<l;a++)if(c[a]!=h[a]){u=c[a]<h[a];break}o=0}for(u&&(r=c,c=h,h=r,t.s=-t.s),l=c.length,a=h.length-l;a>0;--a)c[l++]=0;for(a=h.length;a>o;){if(c[--a]<h[a]){for(i=a;i&&c[--i]===0;)c[i]=Fo-1;--c[i],c[a]+=Fo}c[a]-=h[a]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,gi?Ba(t,m):t):new f(0)}function ox(s,t,r){var n,a=ao(s),i=ou(s.d),o=i.length;return t?(r&&(n=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+Xh(n):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+Xh(-a-1)+i,r&&(n=r-o)>0&&(i+=Xh(n))):a>=o?(i+=Xh(a+1-o),r&&(n=r-a-1)>0&&(i=i+"."+Xh(n))):((n=a+1)<o&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-o)>0&&(a+1===o&&(i+="."),i+=Xh(n))),s.s<0?"-"+i:i}function iO(s,t){if(s.length>t)return s.length=t,!0}function ZU(s){var t,r,n;function a(i){var o=this;if(!(o instanceof a))return new a(i);if(o.constructor=a,i instanceof a){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Wf+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return aO(o,i.toString())}else if(typeof i!="string")throw Error(Wf+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,T5e.test(i))aO(o,i);else throw Error(Wf+i)}if(a.prototype=sr,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=ZU,a.config=a.set=D5e,s===void 0&&(s={}),s)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)s.hasOwnProperty(r=n[t++])||(s[r]=this[r]);return a.config(s),a}function D5e(s){if(!s||typeof s!="object")throw Error(nd+"Object expected");var t,r,n,a=["precision",1,Fg,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=s[r=a[t]])!==void 0)if(Mg(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Wf+r+": "+n);if((n=s[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Wf+r+": "+n);return this}var wE=ZU(k5e);Ac=new wE(1);const _a=wE;function O5e(s){return L5e(s)||M5e(s)||F5e(s)||R5e()}function R5e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function F5e(s,t){if(s){if(typeof s=="string")return aA(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aA(s,t)}}function M5e(s){if(typeof Symbol<"u"&&Symbol.iterator in Object(s))return Array.from(s)}function L5e(s){if(Array.isArray(s))return aA(s)}function aA(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=s[r];return n}var $5e=function(t){return t},ez={},tz=function(t){return t===ez},oO=function(t){return function r(){return arguments.length===0||arguments.length===1&&tz(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},B5e=function s(t,r){return t===1?r:oO(function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var o=a.filter(function(l){return l!==ez}).length;return o>=t?r.apply(void 0,a):s(t-o,oO(function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];var u=a.map(function(h){return tz(h)?c.shift():h});return r.apply(void 0,O5e(u).concat(c))}))})},tw=function(t){return B5e(t.length,t)},iA=function(t,r){for(var n=[],a=t;a<r;++a)n[a-t]=a;return n},U5e=tw(function(s,t){return Array.isArray(t)?t.map(s):Object.keys(t).map(function(r){return t[r]}).map(s)}),z5e=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return $5e;var a=r.reverse(),i=a[0],o=a.slice(1);return function(){return o.reduce(function(l,c){return c(l)},i.apply(void 0,arguments))}},oA=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},sz=function(t){var r=null,n=null;return function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return r&&i.every(function(l,c){return l===r[c]})||(r=i,n=t.apply(void 0,i)),n}};function q5e(s){var t;return s===0?t=1:t=Math.floor(new _a(s).abs().log(10).toNumber())+1,t}function V5e(s,t,r){for(var n=new _a(s),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}var W5e=tw(function(s,t,r){var n=+s,a=+t;return n+r*(a-n)}),H5e=tw(function(s,t,r){var n=t-+s;return n=n||1/0,(r-s)/n}),G5e=tw(function(s,t,r){var n=t-+s;return n=n||1/0,Math.max(0,Math.min(1,(r-s)/n))});const sw={rangeStep:V5e,getDigitCount:q5e,interpolateNumber:W5e,uninterpolateNumber:H5e,uninterpolateTruncation:G5e};function lA(s){return J5e(s)||Y5e(s)||rz(s)||K5e()}function K5e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Y5e(s){if(typeof Symbol<"u"&&Symbol.iterator in Object(s))return Array.from(s)}function J5e(s){if(Array.isArray(s))return cA(s)}function Cv(s,t){return Z5e(s)||Q5e(s,t)||rz(s,t)||X5e()}function X5e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rz(s,t){if(s){if(typeof s=="string")return cA(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cA(s,t)}}function cA(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=s[r];return n}function Q5e(s,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(s)))){var r=[],n=!0,a=!1,i=void 0;try{for(var o=s[Symbol.iterator](),l;!(n=(l=o.next()).done)&&(r.push(l.value),!(t&&r.length===t));n=!0);}catch(c){a=!0,i=c}finally{try{!n&&o.return!=null&&o.return()}finally{if(a)throw i}}return r}}function Z5e(s){if(Array.isArray(s))return s}function nz(s){var t=Cv(s,2),r=t[0],n=t[1],a=r,i=n;return r>n&&(a=n,i=r),[a,i]}function az(s,t,r){if(s.lte(0))return new _a(0);var n=sw.getDigitCount(s.toNumber()),a=new _a(10).pow(n),i=s.div(a),o=n!==1?.05:.1,l=new _a(Math.ceil(i.div(o).toNumber())).add(r).mul(o),c=l.mul(a);return t?c:new _a(Math.ceil(c))}function e3e(s,t,r){var n=1,a=new _a(s);if(!a.isint()&&r){var i=Math.abs(s);i<1?(n=new _a(10).pow(sw.getDigitCount(s)-1),a=new _a(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new _a(Math.floor(s)))}else s===0?a=new _a(Math.floor((t-1)/2)):r||(a=new _a(Math.floor(s)));var o=Math.floor((t-1)/2),l=z5e(U5e(function(c){return a.add(new _a(c-o).mul(n)).toNumber()}),iA);return l(0,t)}function iz(s,t,r,n){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-s)/(r-1)))return{step:new _a(0),tickMin:new _a(0),tickMax:new _a(0)};var i=az(new _a(t).sub(s).div(r-1),n,a),o;s<=0&&t>=0?o=new _a(0):(o=new _a(s).add(t).div(2),o=o.sub(new _a(o).mod(i)));var l=Math.ceil(o.sub(s).div(i).toNumber()),c=Math.ceil(new _a(t).sub(o).div(i).toNumber()),d=l+c+1;return d>r?iz(s,t,r,n,a+1):(d<r&&(c=t>0?c+(r-d):c,l=t>0?l:l+(r-d)),{step:i,tickMin:o.sub(new _a(l).mul(i)),tickMax:o.add(new _a(c).mul(i))})}function t3e(s){var t=Cv(s,2),r=t[0],n=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(a,2),l=nz([r,n]),c=Cv(l,2),d=c[0],u=c[1];if(d===-1/0||u===1/0){var h=u===1/0?[d].concat(lA(iA(0,a-1).map(function(){return 1/0}))):[].concat(lA(iA(0,a-1).map(function(){return-1/0})),[u]);return r>n?oA(h):h}if(d===u)return e3e(d,a,i);var f=iz(d,u,o,i),m=f.step,p=f.tickMin,g=f.tickMax,v=sw.rangeStep(p,g.add(new _a(.1).mul(m)),m);return r>n?oA(v):v}function s3e(s,t){var r=Cv(s,2),n=r[0],a=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=nz([n,a]),l=Cv(o,2),c=l[0],d=l[1];if(c===-1/0||d===1/0)return[n,a];if(c===d)return[c];var u=Math.max(t,2),h=az(new _a(d).sub(c).div(u-1),i,0),f=[].concat(lA(sw.rangeStep(new _a(c),new _a(d).sub(new _a(.99).mul(h)),h)),[d]);return n>a?oA(f):f}var r3e=sz(t3e),n3e=sz(s3e),a3e="Invariant failed";function lx(s,t){throw new Error(a3e)}var i3e=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Wp(s){"@babel/helpers - typeof";return Wp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wp(s)}function nb(){return nb=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},nb.apply(this,arguments)}function o3e(s,t){return u3e(s)||d3e(s,t)||c3e(s,t)||l3e()}function l3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c3e(s,t){if(s){if(typeof s=="string")return lO(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lO(s,t)}}function lO(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=s[r];return n}function d3e(s,t){var r=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(s)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function u3e(s){if(Array.isArray(s))return s}function h3e(s,t){if(s==null)return{};var r=m3e(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function m3e(s,t){if(s==null)return{};var r={};for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n)){if(t.indexOf(n)>=0)continue;r[n]=s[n]}return r}function f3e(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function x3e(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,cz(n.key),n)}}function p3e(s,t,r){return t&&x3e(s.prototype,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function g3e(s,t,r){return t=ab(t),v3e(s,oz()?Reflect.construct(t,r||[],ab(s).constructor):t.apply(s,r))}function v3e(s,t){if(t&&(Wp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return y3e(s)}function y3e(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function oz(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oz=function(){return!!s})()}function ab(s){return ab=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ab(s)}function j3e(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&dA(s,t)}function dA(s,t){return dA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},dA(s,t)}function lz(s,t,r){return t=cz(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function cz(s){var t=b3e(s,"string");return Wp(t)=="symbol"?t:t+""}function b3e(s,t){if(Wp(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Wp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}var Lg=function(s){function t(){return f3e(this,t),g3e(this,t,arguments)}return j3e(t,s),p3e(t,[{key:"render",value:function(){var n=this.props,a=n.offset,i=n.layout,o=n.width,l=n.dataKey,c=n.data,d=n.dataPointFormatter,u=n.xAxis,h=n.yAxis,f=h3e(n,i3e),m=xr(f,!1);this.props.direction==="x"&&u.type!=="number"&&lx();var p=c.map(function(g){var v=d(g,l),y=v.x,j=v.y,b=v.value,w=v.errorVal;if(!w)return null;var N=[],C,S;if(Array.isArray(w)){var _=o3e(w,2);C=_[0],S=_[1]}else C=S=w;if(i==="vertical"){var k=u.scale,F=j+a,A=F+o,T=F-o,V=k(b-C),M=k(b+S);N.push({x1:M,y1:A,x2:M,y2:T}),N.push({x1:V,y1:F,x2:M,y2:F}),N.push({x1:V,y1:A,x2:V,y2:T})}else if(i==="horizontal"){var G=h.scale,L=y+a,J=L-o,z=L+o,U=G(b-C),oe=G(b+S);N.push({x1:J,y1:oe,x2:z,y2:oe}),N.push({x1:L,y1:U,x2:L,y2:oe}),N.push({x1:J,y1:U,x2:z,y2:U})}return xe.createElement(mn,nb({className:"recharts-errorBar",key:"bar-".concat(N.map(function(Q){return"".concat(Q.x1,"-").concat(Q.x2,"-").concat(Q.y1,"-").concat(Q.y2)}))},m),N.map(function(Q){return xe.createElement("line",nb({},Q,{key:"line-".concat(Q.x1,"-").concat(Q.x2,"-").concat(Q.y1,"-").concat(Q.y2)}))}))});return xe.createElement(mn,{className:"recharts-errorBars"},p)}}])}(xe.Component);lz(Lg,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});lz(Lg,"displayName","ErrorBar");function Av(s){"@babel/helpers - typeof";return Av=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Av(s)}function cO(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function nf(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cO(Object(r),!0).forEach(function(n){N3e(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):cO(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function N3e(s,t,r){return t=w3e(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function w3e(s){var t=S3e(s,"string");return Av(t)=="symbol"?t:t+""}function S3e(s,t){if(Av(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Av(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}var dz=function(t){var r=t.children,n=t.formattedGraphicalItems,a=t.legendWidth,i=t.legendContent,o=bc(r,rp);if(!o)return null;var l=rp.defaultProps,c=l!==void 0?nf(nf({},l),o.props):{},d;return o.props&&o.props.payload?d=o.props&&o.props.payload:i==="children"?d=(n||[]).reduce(function(u,h){var f=h.item,m=h.props,p=m.sectors||m.data||[];return u.concat(p.map(function(g){return{type:o.props.iconType||f.props.legendType,value:g.name,color:g.fill,payload:g}}))},[]):d=(n||[]).map(function(u){var h=u.item,f=h.type.defaultProps,m=f!==void 0?nf(nf({},f),h.props):{},p=m.dataKey,g=m.name,v=m.legendType,y=m.hide;return{inactive:y,dataKey:p,type:c.iconType||v||"square",color:SE(h),value:g||p,payload:m}}),nf(nf(nf({},c),rp.getWithHeight(o,a)),{},{payload:d,item:o})};function Ev(s){"@babel/helpers - typeof";return Ev=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ev(s)}function dO(s){return I3e(s)||E3e(s)||A3e(s)||C3e()}function C3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function A3e(s,t){if(s){if(typeof s=="string")return uA(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uA(s,t)}}function E3e(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function I3e(s){if(Array.isArray(s))return uA(s)}function uA(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=s[r];return n}function uO(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function _i(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uO(Object(r),!0).forEach(function(n){ap(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):uO(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function ap(s,t,r){return t=P3e(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function P3e(s){var t=_3e(s,"string");return Ev(t)=="symbol"?t:t+""}function _3e(s,t){if(Ev(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Ev(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function ui(s,t,r){return Fr(s)||Fr(t)?r:Ao(t)?Pc(s,t,r):Lr(t)?t(s):r}function H0(s,t,r,n){var a=E5e(s,function(l){return ui(l,t)});if(r==="number"){var i=a.filter(function(l){return ks(l)||parseFloat(l)});return i.length?[ew(i),gm(i)]:[1/0,-1/0]}var o=n?a.filter(function(l){return!Fr(l)}):a;return o.map(function(l){return Ao(l)||l instanceof Date?l:""})}var k3e=function(t){var r,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=-1,l=(r=n==null?void 0:n.length)!==null&&r!==void 0?r:0;if(l<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var c=i.range,d=0;d<l;d++){var u=d>0?a[d-1].coordinate:a[l-1].coordinate,h=a[d].coordinate,f=d>=l-1?a[0].coordinate:a[d+1].coordinate,m=void 0;if(kl(h-u)!==kl(f-h)){var p=[];if(kl(f-h)===kl(c[1]-c[0])){m=f;var g=h+c[1]-c[0];p[0]=Math.min(g,(g+u)/2),p[1]=Math.max(g,(g+u)/2)}else{m=u;var v=f+c[1]-c[0];p[0]=Math.min(h,(v+h)/2),p[1]=Math.max(h,(v+h)/2)}var y=[Math.min(h,(m+h)/2),Math.max(h,(m+h)/2)];if(t>y[0]&&t<=y[1]||t>=p[0]&&t<=p[1]){o=a[d].index;break}}else{var j=Math.min(u,f),b=Math.max(u,f);if(t>(j+h)/2&&t<=(b+h)/2){o=a[d].index;break}}}else for(var w=0;w<l;w++)if(w===0&&t<=(n[w].coordinate+n[w+1].coordinate)/2||w>0&&w<l-1&&t>(n[w].coordinate+n[w-1].coordinate)/2&&t<=(n[w].coordinate+n[w+1].coordinate)/2||w===l-1&&t>(n[w].coordinate+n[w-1].coordinate)/2){o=n[w].index;break}return o},SE=function(t){var r,n=t,a=n.type.displayName,i=(r=t.type)!==null&&r!==void 0&&r.defaultProps?_i(_i({},t.type.defaultProps),t.props):t.props,o=i.stroke,l=i.fill,c;switch(a){case"Line":c=o;break;case"Area":case"Radar":c=o&&o!=="none"?o:l;break;default:c=l;break}return c},T3e=function(t){var r=t.barSize,n=t.totalSize,a=t.stackGroups,i=a===void 0?{}:a;if(!i)return{};for(var o={},l=Object.keys(i),c=0,d=l.length;c<d;c++)for(var u=i[l[c]].stackGroups,h=Object.keys(u),f=0,m=h.length;f<m;f++){var p=u[h[f]],g=p.items,v=p.cateAxisId,y=g.filter(function(S){return rh(S.type).indexOf("Bar")>=0});if(y&&y.length){var j=y[0].type.defaultProps,b=j!==void 0?_i(_i({},j),y[0].props):y[0].props,w=b.barSize,N=b[v];o[N]||(o[N]=[]);var C=Fr(w)?r:w;o[N].push({item:y[0],stackList:y.slice(1),barSize:Fr(C)?void 0:Tl(C,n,0)})}}return o},D3e=function(t){var r=t.barGap,n=t.barCategoryGap,a=t.bandSize,i=t.sizeList,o=i===void 0?[]:i,l=t.maxBarSize,c=o.length;if(c<1)return null;var d=Tl(r,a,0,!0),u,h=[];if(o[0].barSize===+o[0].barSize){var f=!1,m=a/c,p=o.reduce(function(w,N){return w+N.barSize||0},0);p+=(c-1)*d,p>=a&&(p-=(c-1)*d,d=0),p>=a&&m>0&&(f=!0,m*=.9,p=c*m);var g=(a-p)/2>>0,v={offset:g-d,size:0};u=o.reduce(function(w,N){var C={item:N.item,position:{offset:v.offset+v.size+d,size:f?m:N.barSize}},S=[].concat(dO(w),[C]);return v=S[S.length-1].position,N.stackList&&N.stackList.length&&N.stackList.forEach(function(_){S.push({item:_,position:v})}),S},h)}else{var y=Tl(n,a,0,!0);a-2*y-(c-1)*d<=0&&(d=0);var j=(a-2*y-(c-1)*d)/c;j>1&&(j>>=0);var b=l===+l?Math.min(j,l):j;u=o.reduce(function(w,N,C){var S=[].concat(dO(w),[{item:N.item,position:{offset:y+(j+d)*C+(j-b)/2,size:b}}]);return N.stackList&&N.stackList.length&&N.stackList.forEach(function(_){S.push({item:_,position:S[S.length-1].position})}),S},h)}return u},O3e=function(t,r,n,a){var i=n.children,o=n.width,l=n.margin,c=o-(l.left||0)-(l.right||0),d=dz({children:i,legendWidth:c});if(d){var u=a||{},h=u.width,f=u.height,m=d.align,p=d.verticalAlign,g=d.layout;if((g==="vertical"||g==="horizontal"&&p==="middle")&&m!=="center"&&ks(t[m]))return _i(_i({},t),{},ap({},m,t[m]+(h||0)));if((g==="horizontal"||g==="vertical"&&m==="center")&&p!=="middle"&&ks(t[p]))return _i(_i({},t),{},ap({},p,t[p]+(f||0)))}return t},R3e=function(t,r,n){return Fr(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||n==="x"?r==="xAxis":n==="y"?r==="yAxis":!0},uz=function(t,r,n,a,i){var o=r.props.children,l=Ml(o,Lg).filter(function(d){return R3e(a,i,d.props.direction)});if(l&&l.length){var c=l.map(function(d){return d.props.dataKey});return t.reduce(function(d,u){var h=ui(u,n);if(Fr(h))return d;var f=Array.isArray(h)?[ew(h),gm(h)]:[h,h],m=c.reduce(function(p,g){var v=ui(u,g,0),y=f[0]-Math.abs(Array.isArray(v)?v[0]:v),j=f[1]+Math.abs(Array.isArray(v)?v[1]:v);return[Math.min(y,p[0]),Math.max(j,p[1])]},[1/0,-1/0]);return[Math.min(m[0],d[0]),Math.max(m[1],d[1])]},[1/0,-1/0])}return null},F3e=function(t,r,n,a,i){var o=r.map(function(l){return uz(t,l,n,i,a)}).filter(function(l){return!Fr(l)});return o&&o.length?o.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]):null},hz=function(t,r,n,a,i){var o=r.map(function(c){var d=c.props.dataKey;return n==="number"&&d&&uz(t,c,d,a)||H0(t,d,n,i)});if(n==="number")return o.reduce(function(c,d){return[Math.min(c[0],d[0]),Math.max(c[1],d[1])]},[1/0,-1/0]);var l={};return o.reduce(function(c,d){for(var u=0,h=d.length;u<h;u++)l[d[u]]||(l[d[u]]=!0,c.push(d[u]));return c},[])},mz=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},fz=function(t,r,n,a){if(a)return t.map(function(c){return c.coordinate});var i,o,l=t.map(function(c){return c.coordinate===r&&(i=!0),c.coordinate===n&&(o=!0),c.coordinate});return i||l.push(r),o||l.push(n),l},Qu=function(t,r,n){if(!t)return null;var a=t.scale,i=t.duplicateDomain,o=t.type,l=t.range,c=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,d=(r||n)&&o==="category"&&a.bandwidth?a.bandwidth()/c:0;if(d=t.axisType==="angleAxis"&&(l==null?void 0:l.length)>=2?kl(l[0]-l[1])*2*d:d,r&&(t.ticks||t.niceTicks)){var u=(t.ticks||t.niceTicks).map(function(h){var f=i?i.indexOf(h):h;return{coordinate:a(f)+d,value:h,offset:d}});return u.filter(function(h){return!kg(h.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(h,f){return{coordinate:a(h)+d,value:h,index:f,offset:d}}):a.ticks&&!n?a.ticks(t.tickCount).map(function(h){return{coordinate:a(h)+d,value:h,offset:d}}):a.domain().map(function(h,f){return{coordinate:a(h)+d,value:i?i[h]:h,index:f,offset:d}})},AS=new WeakMap,Cj=function(t,r){if(typeof r!="function")return t;AS.has(t)||AS.set(t,new WeakMap);var n=AS.get(t);if(n.has(r))return n.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return n.set(r,a),a},xz=function(t,r,n){var a=t.scale,i=t.type,o=t.layout,l=t.axisType;if(a==="auto")return o==="radial"&&l==="radiusAxis"?{scale:yv(),realScaleType:"band"}:o==="radial"&&l==="angleAxis"?{scale:Z1(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!n)?{scale:W0(),realScaleType:"point"}:i==="category"?{scale:yv(),realScaleType:"band"}:{scale:Z1(),realScaleType:"linear"};if(ax(a)){var c="scale".concat($N(a));return{scale:(nO[c]||W0)(),realScaleType:nO[c]?c:"point"}}return Lr(a)?{scale:a}:{scale:W0(),realScaleType:"point"}},hO=1e-4,pz=function(t){var r=t.domain();if(!(!r||r.length<=2)){var n=r.length,a=t.range(),i=Math.min(a[0],a[1])-hO,o=Math.max(a[0],a[1])+hO,l=t(r[0]),c=t(r[n-1]);(l<i||l>o||c<i||c>o)&&t.domain([r[0],r[n-1]])}},M3e=function(t,r){if(!t)return null;for(var n=0,a=t.length;n<a;n++)if(t[n].item===r)return t[n].position;return null},L3e=function(t,r){if(!r||r.length!==2||!ks(r[0])||!ks(r[1]))return t;var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),i=[t[0],t[1]];return(!ks(t[0])||t[0]<n)&&(i[0]=n),(!ks(t[1])||t[1]>a)&&(i[1]=a),i[0]>a&&(i[0]=a),i[1]<n&&(i[1]=n),i},$3e=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,o=0,l=0;l<r;++l){var c=kg(t[l][n][1])?t[l][n][0]:t[l][n][1];c>=0?(t[l][n][0]=i,t[l][n][1]=i+c,i=t[l][n][1]):(t[l][n][0]=o,t[l][n][1]=o+c,o=t[l][n][1])}},B3e=function(t){var r=t.length;if(!(r<=0))for(var n=0,a=t[0].length;n<a;++n)for(var i=0,o=0;o<r;++o){var l=kg(t[o][n][1])?t[o][n][0]:t[o][n][1];l>=0?(t[o][n][0]=i,t[o][n][1]=i+l,i=t[o][n][1]):(t[o][n][0]=0,t[o][n][1]=0)}},U3e={sign:$3e,expand:ive,none:Mp,silhouette:ove,wiggle:lve,positive:B3e},z3e=function(t,r,n){var a=r.map(function(l){return l.props.dataKey}),i=U3e[n],o=ave().keys(a).value(function(l,c){return+ui(l,c,0)}).order(F4).offset(i);return o(t)},q3e=function(t,r,n,a,i,o){if(!t)return null;var l=o?r.reverse():r,c={},d=l.reduce(function(h,f){var m,p=(m=f.type)!==null&&m!==void 0&&m.defaultProps?_i(_i({},f.type.defaultProps),f.props):f.props,g=p.stackId,v=p.hide;if(v)return h;var y=p[n],j=h[y]||{hasStack:!1,stackGroups:{}};if(Ao(g)){var b=j.stackGroups[g]||{numericAxisId:n,cateAxisId:a,items:[]};b.items.push(f),j.hasStack=!0,j.stackGroups[g]=b}else j.stackGroups[Hm("_stackId_")]={numericAxisId:n,cateAxisId:a,items:[f]};return _i(_i({},h),{},ap({},y,j))},c),u={};return Object.keys(d).reduce(function(h,f){var m=d[f];if(m.hasStack){var p={};m.stackGroups=Object.keys(m.stackGroups).reduce(function(g,v){var y=m.stackGroups[v];return _i(_i({},g),{},ap({},v,{numericAxisId:n,cateAxisId:a,items:y.items,stackedData:z3e(t,y.items,i)}))},p)}return _i(_i({},h),{},ap({},f,m))},u)},gz=function(t,r){var n=r.realScaleType,a=r.type,i=r.tickCount,o=r.originalDomain,l=r.allowDecimals,c=n||r.scale;if(c!=="auto"&&c!=="linear")return null;if(i&&a==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var d=t.domain();if(!d.length)return null;var u=r3e(d,i,l);return t.domain([ew(u),gm(u)]),{niceTicks:u}}if(i&&a==="number"){var h=t.domain(),f=n3e(h,i,l);return{niceTicks:f}}return null};function Hp(s){var t=s.axis,r=s.ticks,n=s.bandSize,a=s.entry,i=s.index,o=s.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Fr(a[t.dataKey])){var l=T1(r,"value",a[t.dataKey]);if(l)return l.coordinate+n/2}return r[i]?r[i].coordinate+n/2:null}var c=ui(a,Fr(o)?t.dataKey:o);return Fr(c)?null:t.scale(c)}var mO=function(t){var r=t.axis,n=t.ticks,a=t.offset,i=t.bandSize,o=t.entry,l=t.index;if(r.type==="category")return n[l]?n[l].coordinate+a:null;var c=ui(o,r.dataKey,r.domain[l]);return Fr(c)?null:r.scale(c)-i/2+a},V3e=function(t){var r=t.numericAxis,n=r.scale.domain();if(r.type==="number"){var a=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]);return a<=0&&i>=0?0:i<0?i:a}return n[0]},W3e=function(t,r){var n,a=(n=t.type)!==null&&n!==void 0&&n.defaultProps?_i(_i({},t.type.defaultProps),t.props):t.props,i=a.stackId;if(Ao(i)){var o=r[i];if(o){var l=o.items.indexOf(t);return l>=0?o.stackedData[l]:null}}return null},H3e=function(t){return t.reduce(function(r,n){return[ew(n.concat([r[0]]).filter(ks)),gm(n.concat([r[1]]).filter(ks))]},[1/0,-1/0])},vz=function(t,r,n){return Object.keys(t).reduce(function(a,i){var o=t[i],l=o.stackedData,c=l.reduce(function(d,u){var h=H3e(u.slice(r,n+1));return[Math.min(d[0],h[0]),Math.max(d[1],h[1])]},[1/0,-1/0]);return[Math.min(c[0],a[0]),Math.max(c[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},fO=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,xO=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,hA=function(t,r,n){if(Lr(t))return t(r,n);if(!Array.isArray(t))return r;var a=[];if(ks(t[0]))a[0]=n?t[0]:Math.min(t[0],r[0]);else if(fO.test(t[0])){var i=+fO.exec(t[0])[1];a[0]=r[0]-i}else Lr(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(ks(t[1]))a[1]=n?t[1]:Math.max(t[1],r[1]);else if(xO.test(t[1])){var o=+xO.exec(t[1])[1];a[1]=r[1]+o}else Lr(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},ib=function(t,r,n){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!n||a>0)return a}if(t&&r&&r.length>=2){for(var i=Q3(r,function(h){return h.coordinate}),o=1/0,l=1,c=i.length;l<c;l++){var d=i[l],u=i[l-1];o=Math.min((d.coordinate||0)-(u.coordinate||0),o)}return o===1/0?0:o}return n?void 0:0},pO=function(t,r,n){return!t||!t.length||Lm(t,Pc(n,"type.defaultProps.domain"))?r:t},yz=function(t,r){var n=t.type.defaultProps?_i(_i({},t.type.defaultProps),t.props):t.props,a=n.dataKey,i=n.name,o=n.unit,l=n.formatter,c=n.tooltipType,d=n.chartType,u=n.hide;return _i(_i({},xr(t,!1)),{},{dataKey:a,unit:o,formatter:l,name:i||a,color:SE(t),value:ui(r,a),type:c,payload:r,chartType:d,hide:u})};function Iv(s){"@babel/helpers - typeof";return Iv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iv(s)}function gO(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function Mu(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gO(Object(r),!0).forEach(function(n){jz(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):gO(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function jz(s,t,r){return t=G3e(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function G3e(s){var t=K3e(s,"string");return Iv(t)=="symbol"?t:t+""}function K3e(s,t){if(Iv(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Iv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function Y3e(s,t){return Z3e(s)||Q3e(s,t)||X3e(s,t)||J3e()}function J3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function X3e(s,t){if(s){if(typeof s=="string")return vO(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vO(s,t)}}function vO(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=s[r];return n}function Q3e(s,t){var r=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(s)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function Z3e(s){if(Array.isArray(s))return s}var ob=Math.PI/180,eEe=function(t){return t*180/Math.PI},si=function(t,r,n,a){return{x:t+Math.cos(-ob*a)*n,y:r+Math.sin(-ob*a)*n}},bz=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},tEe=function(t,r,n,a,i){var o=t.width,l=t.height,c=t.startAngle,d=t.endAngle,u=Tl(t.cx,o,o/2),h=Tl(t.cy,l,l/2),f=bz(o,l,n),m=Tl(t.innerRadius,f,0),p=Tl(t.outerRadius,f,f*.8),g=Object.keys(r);return g.reduce(function(v,y){var j=r[y],b=j.domain,w=j.reversed,N;if(Fr(j.range))a==="angleAxis"?N=[c,d]:a==="radiusAxis"&&(N=[m,p]),w&&(N=[N[1],N[0]]);else{N=j.range;var C=N,S=Y3e(C,2);c=S[0],d=S[1]}var _=xz(j,i),k=_.realScaleType,F=_.scale;F.domain(b).range(N),pz(F);var A=gz(F,Mu(Mu({},j),{},{realScaleType:k})),T=Mu(Mu(Mu({},j),A),{},{range:N,radius:p,realScaleType:k,scale:F,cx:u,cy:h,innerRadius:m,outerRadius:p,startAngle:c,endAngle:d});return Mu(Mu({},v),{},jz({},y,T))},{})},sEe=function(t,r){var n=t.x,a=t.y,i=r.x,o=r.y;return Math.sqrt(Math.pow(n-i,2)+Math.pow(a-o,2))},rEe=function(t,r){var n=t.x,a=t.y,i=r.cx,o=r.cy,l=sEe({x:n,y:a},{x:i,y:o});if(l<=0)return{radius:l};var c=(n-i)/l,d=Math.acos(c);return a>o&&(d=2*Math.PI-d),{radius:l,angle:eEe(d),angleInRadian:d}},nEe=function(t){var r=t.startAngle,n=t.endAngle,a=Math.floor(r/360),i=Math.floor(n/360),o=Math.min(a,i);return{startAngle:r-o*360,endAngle:n-o*360}},aEe=function(t,r){var n=r.startAngle,a=r.endAngle,i=Math.floor(n/360),o=Math.floor(a/360),l=Math.min(i,o);return t+l*360},yO=function(t,r){var n=t.x,a=t.y,i=rEe({x:n,y:a},r),o=i.radius,l=i.angle,c=r.innerRadius,d=r.outerRadius;if(o<c||o>d)return!1;if(o===0)return!0;var u=nEe(r),h=u.startAngle,f=u.endAngle,m=l,p;if(h<=f){for(;m>f;)m-=360;for(;m<h;)m+=360;p=m>=h&&m<=f}else{for(;m>h;)m-=360;for(;m<f;)m+=360;p=m>=f&&m<=h}return p?Mu(Mu({},r),{},{radius:o,angle:aEe(m,r)}):null},Nz=function(t){return!x.isValidElement(t)&&!Lr(t)&&typeof t!="boolean"?t.className:""};function Pv(s){"@babel/helpers - typeof";return Pv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pv(s)}var iEe=["offset"];function oEe(s){return uEe(s)||dEe(s)||cEe(s)||lEe()}function lEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cEe(s,t){if(s){if(typeof s=="string")return mA(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mA(s,t)}}function dEe(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function uEe(s){if(Array.isArray(s))return mA(s)}function mA(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=s[r];return n}function hEe(s,t){if(s==null)return{};var r=mEe(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function mEe(s,t){if(s==null)return{};var r={};for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n)){if(t.indexOf(n)>=0)continue;r[n]=s[n]}return r}function jO(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function ho(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jO(Object(r),!0).forEach(function(n){fEe(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):jO(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function fEe(s,t,r){return t=xEe(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function xEe(s){var t=pEe(s,"string");return Pv(t)=="symbol"?t:t+""}function pEe(s,t){if(Pv(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Pv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function _v(){return _v=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},_v.apply(this,arguments)}var gEe=function(t){var r=t.value,n=t.formatter,a=Fr(t.children)?r:t.children;return Lr(n)?n(a):a},vEe=function(t,r){var n=kl(r-t),a=Math.min(Math.abs(r-t),360);return n*a},yEe=function(t,r,n){var a=t.position,i=t.viewBox,o=t.offset,l=t.className,c=i,d=c.cx,u=c.cy,h=c.innerRadius,f=c.outerRadius,m=c.startAngle,p=c.endAngle,g=c.clockWise,v=(h+f)/2,y=vEe(m,p),j=y>=0?1:-1,b,w;a==="insideStart"?(b=m+j*o,w=g):a==="insideEnd"?(b=p-j*o,w=!g):a==="end"&&(b=p+j*o,w=g),w=y<=0?w:!w;var N=si(d,u,v,b),C=si(d,u,v,b+(w?1:-1)*359),S="M".concat(N.x,",").concat(N.y,`
    A`).concat(v,",").concat(v,",0,1,").concat(w?0:1,`,
    `).concat(C.x,",").concat(C.y),_=Fr(t.id)?Hm("recharts-radial-line-"):t.id;return xe.createElement("text",_v({},n,{dominantBaseline:"central",className:Jr("recharts-radial-bar-label",l)}),xe.createElement("defs",null,xe.createElement("path",{id:_,d:S})),xe.createElement("textPath",{xlinkHref:"#".concat(_)},r))},jEe=function(t){var r=t.viewBox,n=t.offset,a=t.position,i=r,o=i.cx,l=i.cy,c=i.innerRadius,d=i.outerRadius,u=i.startAngle,h=i.endAngle,f=(u+h)/2;if(a==="outside"){var m=si(o,l,d+n,f),p=m.x,g=m.y;return{x:p,y:g,textAnchor:p>=o?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"end"};var v=(c+d)/2,y=si(o,l,v,f),j=y.x,b=y.y;return{x:j,y:b,textAnchor:"middle",verticalAnchor:"middle"}},bEe=function(t){var r=t.viewBox,n=t.parentViewBox,a=t.offset,i=t.position,o=r,l=o.x,c=o.y,d=o.width,u=o.height,h=u>=0?1:-1,f=h*a,m=h>0?"end":"start",p=h>0?"start":"end",g=d>=0?1:-1,v=g*a,y=g>0?"end":"start",j=g>0?"start":"end";if(i==="top"){var b={x:l+d/2,y:c-h*a,textAnchor:"middle",verticalAnchor:m};return ho(ho({},b),n?{height:Math.max(c-n.y,0),width:d}:{})}if(i==="bottom"){var w={x:l+d/2,y:c+u+f,textAnchor:"middle",verticalAnchor:p};return ho(ho({},w),n?{height:Math.max(n.y+n.height-(c+u),0),width:d}:{})}if(i==="left"){var N={x:l-v,y:c+u/2,textAnchor:y,verticalAnchor:"middle"};return ho(ho({},N),n?{width:Math.max(N.x-n.x,0),height:u}:{})}if(i==="right"){var C={x:l+d+v,y:c+u/2,textAnchor:j,verticalAnchor:"middle"};return ho(ho({},C),n?{width:Math.max(n.x+n.width-C.x,0),height:u}:{})}var S=n?{width:d,height:u}:{};return i==="insideLeft"?ho({x:l+v,y:c+u/2,textAnchor:j,verticalAnchor:"middle"},S):i==="insideRight"?ho({x:l+d-v,y:c+u/2,textAnchor:y,verticalAnchor:"middle"},S):i==="insideTop"?ho({x:l+d/2,y:c+f,textAnchor:"middle",verticalAnchor:p},S):i==="insideBottom"?ho({x:l+d/2,y:c+u-f,textAnchor:"middle",verticalAnchor:m},S):i==="insideTopLeft"?ho({x:l+v,y:c+f,textAnchor:j,verticalAnchor:p},S):i==="insideTopRight"?ho({x:l+d-v,y:c+f,textAnchor:y,verticalAnchor:p},S):i==="insideBottomLeft"?ho({x:l+v,y:c+u-f,textAnchor:j,verticalAnchor:m},S):i==="insideBottomRight"?ho({x:l+d-v,y:c+u-f,textAnchor:y,verticalAnchor:m},S):Eg(i)&&(ks(i.x)||Sf(i.x))&&(ks(i.y)||Sf(i.y))?ho({x:l+Tl(i.x,d),y:c+Tl(i.y,u),textAnchor:"end",verticalAnchor:"end"},S):ho({x:l+d/2,y:c+u/2,textAnchor:"middle",verticalAnchor:"middle"},S)},NEe=function(t){return"cx"in t&&ks(t.cx)};function Lo(s){var t=s.offset,r=t===void 0?5:t,n=hEe(s,iEe),a=ho({offset:r},n),i=a.viewBox,o=a.position,l=a.value,c=a.children,d=a.content,u=a.className,h=u===void 0?"":u,f=a.textBreakAll;if(!i||Fr(l)&&Fr(c)&&!x.isValidElement(d)&&!Lr(d))return null;if(x.isValidElement(d))return x.cloneElement(d,a);var m;if(Lr(d)){if(m=x.createElement(d,a),x.isValidElement(m))return m}else m=gEe(a);var p=NEe(i),g=xr(a,!0);if(p&&(o==="insideStart"||o==="insideEnd"||o==="end"))return yEe(a,m,g);var v=p?jEe(a):bEe(a);return xe.createElement(ix,_v({className:Jr("recharts-label",h)},g,v,{breakAll:f}),m)}Lo.displayName="Label";var wz=function(t){var r=t.cx,n=t.cy,a=t.angle,i=t.startAngle,o=t.endAngle,l=t.r,c=t.radius,d=t.innerRadius,u=t.outerRadius,h=t.x,f=t.y,m=t.top,p=t.left,g=t.width,v=t.height,y=t.clockWise,j=t.labelViewBox;if(j)return j;if(ks(g)&&ks(v)){if(ks(h)&&ks(f))return{x:h,y:f,width:g,height:v};if(ks(m)&&ks(p))return{x:m,y:p,width:g,height:v}}return ks(h)&&ks(f)?{x:h,y:f,width:0,height:0}:ks(r)&&ks(n)?{cx:r,cy:n,startAngle:i||a||0,endAngle:o||a||0,innerRadius:d||0,outerRadius:u||c||l||0,clockWise:y}:t.viewBox?t.viewBox:{}},wEe=function(t,r){return t?t===!0?xe.createElement(Lo,{key:"label-implicit",viewBox:r}):Ao(t)?xe.createElement(Lo,{key:"label-implicit",viewBox:r,value:t}):x.isValidElement(t)?t.type===Lo?x.cloneElement(t,{key:"label-implicit",viewBox:r}):xe.createElement(Lo,{key:"label-implicit",content:t,viewBox:r}):Lr(t)?xe.createElement(Lo,{key:"label-implicit",content:t,viewBox:r}):Eg(t)?xe.createElement(Lo,_v({viewBox:r},t,{key:"label-implicit"})):null:null},SEe=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var a=t.children,i=wz(t),o=Ml(a,Lo).map(function(c,d){return x.cloneElement(c,{viewBox:r||i,key:"label-".concat(d)})});if(!n)return o;var l=wEe(t.label,r||i);return[l].concat(oEe(o))};Lo.parseViewBox=wz;Lo.renderCallByParent=SEe;function CEe(s){var t=s==null?0:s.length;return t?s[t-1]:void 0}var AEe=CEe;const EEe=Ca(AEe);function kv(s){"@babel/helpers - typeof";return kv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kv(s)}var IEe=["valueAccessor"],PEe=["data","dataKey","clockWise","id","textBreakAll"];function _Ee(s){return OEe(s)||DEe(s)||TEe(s)||kEe()}function kEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TEe(s,t){if(s){if(typeof s=="string")return fA(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fA(s,t)}}function DEe(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function OEe(s){if(Array.isArray(s))return fA(s)}function fA(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=s[r];return n}function lb(){return lb=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},lb.apply(this,arguments)}function bO(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function NO(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bO(Object(r),!0).forEach(function(n){REe(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):bO(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function REe(s,t,r){return t=FEe(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function FEe(s){var t=MEe(s,"string");return kv(t)=="symbol"?t:t+""}function MEe(s,t){if(kv(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(kv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function wO(s,t){if(s==null)return{};var r=LEe(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function LEe(s,t){if(s==null)return{};var r={};for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n)){if(t.indexOf(n)>=0)continue;r[n]=s[n]}return r}var $Ee=function(t){return Array.isArray(t.value)?EEe(t.value):t.value};function Td(s){var t=s.valueAccessor,r=t===void 0?$Ee:t,n=wO(s,IEe),a=n.data,i=n.dataKey,o=n.clockWise,l=n.id,c=n.textBreakAll,d=wO(n,PEe);return!a||!a.length?null:xe.createElement(mn,{className:"recharts-label-list"},a.map(function(u,h){var f=Fr(i)?r(u,h):ui(u&&u.payload,i),m=Fr(l)?{}:{id:"".concat(l,"-").concat(h)};return xe.createElement(Lo,lb({},xr(u,!0),d,m,{parentViewBox:u.parentViewBox,value:f,textBreakAll:c,viewBox:Lo.parseViewBox(Fr(o)?u:NO(NO({},u),{},{clockWise:o})),key:"label-".concat(h),index:h}))}))}Td.displayName="LabelList";function BEe(s,t){return s?s===!0?xe.createElement(Td,{key:"labelList-implicit",data:t}):xe.isValidElement(s)||Lr(s)?xe.createElement(Td,{key:"labelList-implicit",data:t,content:s}):Eg(s)?xe.createElement(Td,lb({data:t},s,{key:"labelList-implicit"})):null:null}function UEe(s,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!s||!s.children&&r&&!s.label)return null;var n=s.children,a=Ml(n,Td).map(function(o,l){return x.cloneElement(o,{data:t,key:"labelList-".concat(l)})});if(!r)return a;var i=BEe(s.label,t);return[i].concat(_Ee(a))}Td.renderCallByParent=UEe;function Tv(s){"@babel/helpers - typeof";return Tv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tv(s)}function xA(){return xA=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},xA.apply(this,arguments)}function SO(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function CO(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SO(Object(r),!0).forEach(function(n){zEe(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):SO(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function zEe(s,t,r){return t=qEe(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function qEe(s){var t=VEe(s,"string");return Tv(t)=="symbol"?t:t+""}function VEe(s,t){if(Tv(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Tv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}var WEe=function(t,r){var n=kl(r-t),a=Math.min(Math.abs(r-t),359.999);return n*a},Aj=function(t){var r=t.cx,n=t.cy,a=t.radius,i=t.angle,o=t.sign,l=t.isExternal,c=t.cornerRadius,d=t.cornerIsExternal,u=c*(l?1:-1)+a,h=Math.asin(c/u)/ob,f=d?i:i+o*h,m=si(r,n,u,f),p=si(r,n,a,f),g=d?i-o*h:i,v=si(r,n,u*Math.cos(h*ob),g);return{center:m,circleTangency:p,lineTangency:v,theta:h}},Sz=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,o=t.startAngle,l=t.endAngle,c=WEe(o,l),d=o+c,u=si(r,n,i,o),h=si(r,n,i,d),f="M ".concat(u.x,",").concat(u.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(o>d),`,
    `).concat(h.x,",").concat(h.y,`
  `);if(a>0){var m=si(r,n,a,o),p=si(r,n,a,d);f+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(o<=d),`,
            `).concat(m.x,",").concat(m.y," Z")}else f+="L ".concat(r,",").concat(n," Z");return f},HEe=function(t){var r=t.cx,n=t.cy,a=t.innerRadius,i=t.outerRadius,o=t.cornerRadius,l=t.forceCornerRadius,c=t.cornerIsExternal,d=t.startAngle,u=t.endAngle,h=kl(u-d),f=Aj({cx:r,cy:n,radius:i,angle:d,sign:h,cornerRadius:o,cornerIsExternal:c}),m=f.circleTangency,p=f.lineTangency,g=f.theta,v=Aj({cx:r,cy:n,radius:i,angle:u,sign:-h,cornerRadius:o,cornerIsExternal:c}),y=v.circleTangency,j=v.lineTangency,b=v.theta,w=c?Math.abs(d-u):Math.abs(d-u)-g-b;if(w<0)return l?"M ".concat(p.x,",").concat(p.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):Sz({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:d,endAngle:u});var N="M ".concat(p.x,",").concat(p.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(w>180),",").concat(+(h<0),",").concat(y.x,",").concat(y.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(j.x,",").concat(j.y,`
  `);if(a>0){var C=Aj({cx:r,cy:n,radius:a,angle:d,sign:h,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),S=C.circleTangency,_=C.lineTangency,k=C.theta,F=Aj({cx:r,cy:n,radius:a,angle:u,sign:-h,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),A=F.circleTangency,T=F.lineTangency,V=F.theta,M=c?Math.abs(d-u):Math.abs(d-u)-k-V;if(M<0&&o===0)return"".concat(N,"L").concat(r,",").concat(n,"Z");N+="L".concat(T.x,",").concat(T.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(A.x,",").concat(A.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(M>180),",").concat(+(h>0),",").concat(S.x,",").concat(S.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(_.x,",").concat(_.y,"Z")}else N+="L".concat(r,",").concat(n,"Z");return N},GEe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Cz=function(t){var r=CO(CO({},GEe),t),n=r.cx,a=r.cy,i=r.innerRadius,o=r.outerRadius,l=r.cornerRadius,c=r.forceCornerRadius,d=r.cornerIsExternal,u=r.startAngle,h=r.endAngle,f=r.className;if(o<i||u===h)return null;var m=Jr("recharts-sector",f),p=o-i,g=Tl(l,p,0,!0),v;return g>0&&Math.abs(u-h)<360?v=HEe({cx:n,cy:a,innerRadius:i,outerRadius:o,cornerRadius:Math.min(g,p/2),forceCornerRadius:c,cornerIsExternal:d,startAngle:u,endAngle:h}):v=Sz({cx:n,cy:a,innerRadius:i,outerRadius:o,startAngle:u,endAngle:h}),xe.createElement("path",xA({},xr(r,!0),{className:m,d:v,role:"img"}))};function Dv(s){"@babel/helpers - typeof";return Dv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dv(s)}function pA(){return pA=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},pA.apply(this,arguments)}function AO(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function EO(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AO(Object(r),!0).forEach(function(n){KEe(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):AO(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function KEe(s,t,r){return t=YEe(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function YEe(s){var t=JEe(s,"string");return Dv(t)=="symbol"?t:t+""}function JEe(s,t){if(Dv(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Dv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}var IO={curveBasisClosed:K0e,curveBasisOpen:Y0e,curveBasis:G0e,curveBumpX:D0e,curveBumpY:O0e,curveLinearClosed:J0e,curveLinear:UN,curveMonotoneX:X0e,curveMonotoneY:Q0e,curveNatural:Z0e,curveStep:eve,curveStepAfter:sve,curveStepBefore:tve},Ej=function(t){return t.x===+t.x&&t.y===+t.y},f0=function(t){return t.x},x0=function(t){return t.y},XEe=function(t,r){if(Lr(t))return t;var n="curve".concat($N(t));return(n==="curveMonotone"||n==="curveBump")&&r?IO["".concat(n).concat(r==="vertical"?"Y":"X")]:IO[n]||UN},QEe=function(t){var r=t.type,n=r===void 0?"linear":r,a=t.points,i=a===void 0?[]:a,o=t.baseLine,l=t.layout,c=t.connectNulls,d=c===void 0?!1:c,u=XEe(n,l),h=d?i.filter(function(g){return Ej(g)}):i,f;if(Array.isArray(o)){var m=d?o.filter(function(g){return Ej(g)}):o,p=h.map(function(g,v){return EO(EO({},g),{},{base:m[v]})});return l==="vertical"?f=gj().y(x0).x1(f0).x0(function(g){return g.base.x}):f=gj().x(f0).y1(x0).y0(function(g){return g.base.y}),f.defined(Ej).curve(u),f(p)}return l==="vertical"&&ks(o)?f=gj().y(x0).x1(f0).x0(o):ks(o)?f=gj().x(f0).y1(x0).y0(o):f=yB().x(f0).y(x0),f.defined(Ej).curve(u),f(h)},km=function(t){var r=t.className,n=t.points,a=t.path,i=t.pathRef;if((!n||!n.length)&&!a)return null;var o=n&&n.length?QEe(t):a;return x.createElement("path",pA({},xr(t,!1),D1(t),{className:Jr("recharts-curve",r),d:o,ref:i}))},Az={exports:{}},ZEe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",eIe=ZEe,tIe=eIe;function Ez(){}function Iz(){}Iz.resetWarningCache=Ez;var sIe=function(){function s(n,a,i,o,l,c){if(c!==tIe){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}s.isRequired=s;function t(){return s}var r={array:s,bigint:s,bool:s,func:s,number:s,object:s,string:s,symbol:s,any:s,arrayOf:t,element:s,elementType:s,instanceOf:t,node:s,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:Iz,resetWarningCache:Ez};return r.PropTypes=r,r};Az.exports=sIe();var rIe=Az.exports;const da=Ca(rIe);var nIe=Object.getOwnPropertyNames,aIe=Object.getOwnPropertySymbols,iIe=Object.prototype.hasOwnProperty;function PO(s,t){return function(n,a,i){return s(n,a,i)&&t(n,a,i)}}function Ij(s){return function(r,n,a){if(!r||!n||typeof r!="object"||typeof n!="object")return s(r,n,a);var i=a.cache,o=i.get(r),l=i.get(n);if(o&&l)return o===n&&l===r;i.set(r,n),i.set(n,r);var c=s(r,n,a);return i.delete(r),i.delete(n),c}}function _O(s){return nIe(s).concat(aIe(s))}var oIe=Object.hasOwn||function(s,t){return iIe.call(s,t)};function vx(s,t){return s===t||!s&&!t&&s!==s&&t!==t}var lIe="__v",cIe="__o",dIe="_owner",kO=Object.getOwnPropertyDescriptor,TO=Object.keys;function uIe(s,t,r){var n=s.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(s[n],t[n],n,n,s,t,r))return!1;return!0}function hIe(s,t){return vx(s.getTime(),t.getTime())}function mIe(s,t){return s.name===t.name&&s.message===t.message&&s.cause===t.cause&&s.stack===t.stack}function fIe(s,t){return s===t}function DO(s,t,r){var n=s.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),i=s.entries(),o,l,c=0;(o=i.next())&&!o.done;){for(var d=t.entries(),u=!1,h=0;(l=d.next())&&!l.done;){if(a[h]){h++;continue}var f=o.value,m=l.value;if(r.equals(f[0],m[0],c,h,s,t,r)&&r.equals(f[1],m[1],f[0],m[0],s,t,r)){u=a[h]=!0;break}h++}if(!u)return!1;c++}return!0}var xIe=vx;function pIe(s,t,r){var n=TO(s),a=n.length;if(TO(t).length!==a)return!1;for(;a-- >0;)if(!Pz(s,t,r,n[a]))return!1;return!0}function p0(s,t,r){var n=_O(s),a=n.length;if(_O(t).length!==a)return!1;for(var i,o,l;a-- >0;)if(i=n[a],!Pz(s,t,r,i)||(o=kO(s,i),l=kO(t,i),(o||l)&&(!o||!l||o.configurable!==l.configurable||o.enumerable!==l.enumerable||o.writable!==l.writable)))return!1;return!0}function gIe(s,t){return vx(s.valueOf(),t.valueOf())}function vIe(s,t){return s.source===t.source&&s.flags===t.flags}function OO(s,t,r){var n=s.size;if(n!==t.size)return!1;if(!n)return!0;for(var a=new Array(n),i=s.values(),o,l;(o=i.next())&&!o.done;){for(var c=t.values(),d=!1,u=0;(l=c.next())&&!l.done;){if(!a[u]&&r.equals(o.value,l.value,o.value,l.value,s,t,r)){d=a[u]=!0;break}u++}if(!d)return!1}return!0}function yIe(s,t){var r=s.length;if(t.length!==r)return!1;for(;r-- >0;)if(s[r]!==t[r])return!1;return!0}function jIe(s,t){return s.hostname===t.hostname&&s.pathname===t.pathname&&s.protocol===t.protocol&&s.port===t.port&&s.hash===t.hash&&s.username===t.username&&s.password===t.password}function Pz(s,t,r,n){return(n===dIe||n===cIe||n===lIe)&&(s.$$typeof||t.$$typeof)?!0:oIe(t,n)&&r.equals(s[n],t[n],n,n,s,t,r)}var bIe="[object Arguments]",NIe="[object Boolean]",wIe="[object Date]",SIe="[object Error]",CIe="[object Map]",AIe="[object Number]",EIe="[object Object]",IIe="[object RegExp]",PIe="[object Set]",_Ie="[object String]",kIe="[object URL]",TIe=Array.isArray,RO=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,FO=Object.assign,DIe=Object.prototype.toString.call.bind(Object.prototype.toString);function OIe(s){var t=s.areArraysEqual,r=s.areDatesEqual,n=s.areErrorsEqual,a=s.areFunctionsEqual,i=s.areMapsEqual,o=s.areNumbersEqual,l=s.areObjectsEqual,c=s.arePrimitiveWrappersEqual,d=s.areRegExpsEqual,u=s.areSetsEqual,h=s.areTypedArraysEqual,f=s.areUrlsEqual;return function(p,g,v){if(p===g)return!0;if(p==null||g==null)return!1;var y=typeof p;if(y!==typeof g)return!1;if(y!=="object")return y==="number"?o(p,g,v):y==="function"?a(p,g,v):!1;var j=p.constructor;if(j!==g.constructor)return!1;if(j===Object)return l(p,g,v);if(TIe(p))return t(p,g,v);if(RO!=null&&RO(p))return h(p,g,v);if(j===Date)return r(p,g,v);if(j===RegExp)return d(p,g,v);if(j===Map)return i(p,g,v);if(j===Set)return u(p,g,v);var b=DIe(p);return b===wIe?r(p,g,v):b===IIe?d(p,g,v):b===CIe?i(p,g,v):b===PIe?u(p,g,v):b===EIe?typeof p.then!="function"&&typeof g.then!="function"&&l(p,g,v):b===kIe?f(p,g,v):b===SIe?n(p,g,v):b===bIe?l(p,g,v):b===NIe||b===AIe||b===_Ie?c(p,g,v):!1}}function RIe(s){var t=s.circular,r=s.createCustomConfig,n=s.strict,a={areArraysEqual:n?p0:uIe,areDatesEqual:hIe,areErrorsEqual:mIe,areFunctionsEqual:fIe,areMapsEqual:n?PO(DO,p0):DO,areNumbersEqual:xIe,areObjectsEqual:n?p0:pIe,arePrimitiveWrappersEqual:gIe,areRegExpsEqual:vIe,areSetsEqual:n?PO(OO,p0):OO,areTypedArraysEqual:n?p0:yIe,areUrlsEqual:jIe};if(r&&(a=FO({},a,r(a))),t){var i=Ij(a.areArraysEqual),o=Ij(a.areMapsEqual),l=Ij(a.areObjectsEqual),c=Ij(a.areSetsEqual);a=FO({},a,{areArraysEqual:i,areMapsEqual:o,areObjectsEqual:l,areSetsEqual:c})}return a}function FIe(s){return function(t,r,n,a,i,o,l){return s(t,r,l)}}function MIe(s){var t=s.circular,r=s.comparator,n=s.createState,a=s.equals,i=s.strict;if(n)return function(c,d){var u=n(),h=u.cache,f=h===void 0?t?new WeakMap:void 0:h,m=u.meta;return r(c,d,{cache:f,equals:a,meta:m,strict:i})};if(t)return function(c,d){return r(c,d,{cache:new WeakMap,equals:a,meta:void 0,strict:i})};var o={cache:void 0,equals:a,meta:void 0,strict:i};return function(c,d){return r(c,d,o)}}var LIe=Ym();Ym({strict:!0});Ym({circular:!0});Ym({circular:!0,strict:!0});Ym({createInternalComparator:function(){return vx}});Ym({strict:!0,createInternalComparator:function(){return vx}});Ym({circular:!0,createInternalComparator:function(){return vx}});Ym({circular:!0,createInternalComparator:function(){return vx},strict:!0});function Ym(s){s===void 0&&(s={});var t=s.circular,r=t===void 0?!1:t,n=s.createInternalComparator,a=s.createState,i=s.strict,o=i===void 0?!1:i,l=RIe(s),c=OIe(l),d=n?n(c):FIe(c);return MIe({circular:r,comparator:c,createState:a,equals:d,strict:o})}function $Ie(s){typeof requestAnimationFrame<"u"&&requestAnimationFrame(s)}function MO(s){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=function a(i){r<0&&(r=i),i-r>t?(s(i),r=-1):$Ie(a)};requestAnimationFrame(n)}function gA(s){"@babel/helpers - typeof";return gA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gA(s)}function BIe(s){return VIe(s)||qIe(s)||zIe(s)||UIe()}function UIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zIe(s,t){if(s){if(typeof s=="string")return LO(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LO(s,t)}}function LO(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=s[r];return n}function qIe(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function VIe(s){if(Array.isArray(s))return s}function WIe(){var s={},t=function(){return null},r=!1,n=function a(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var o=i,l=BIe(o),c=l[0],d=l.slice(1);if(typeof c=="number"){MO(a.bind(null,d),c);return}a(c),MO(a.bind(null,d));return}gA(i)==="object"&&(s=i,t(s)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,n(i)},subscribe:function(i){return t=i,function(){t=function(){return null}}}}}function Ov(s){"@babel/helpers - typeof";return Ov=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ov(s)}function $O(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function BO(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$O(Object(r),!0).forEach(function(n){_z(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):$O(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function _z(s,t,r){return t=HIe(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function HIe(s){var t=GIe(s,"string");return Ov(t)==="symbol"?t:String(t)}function GIe(s,t){if(Ov(s)!=="object"||s===null)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Ov(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}var KIe=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(n,a){return n.filter(function(i){return a.includes(i)})})},YIe=function(t){return t},JIe=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},G0=function(t,r){return Object.keys(r).reduce(function(n,a){return BO(BO({},n),{},_z({},a,t(a,r[a])))},{})},UO=function(t,r,n){return t.map(function(a){return"".concat(JIe(a)," ").concat(r,"ms ").concat(n)}).join(",")};function XIe(s,t){return e6e(s)||ZIe(s,t)||kz(s,t)||QIe()}function QIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZIe(s,t){var r=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(s)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function e6e(s){if(Array.isArray(s))return s}function t6e(s){return n6e(s)||r6e(s)||kz(s)||s6e()}function s6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kz(s,t){if(s){if(typeof s=="string")return vA(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return vA(s,t)}}function r6e(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function n6e(s){if(Array.isArray(s))return vA(s)}function vA(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=s[r];return n}var cb=1e-4,Tz=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},Dz=function(t,r){return t.map(function(n,a){return n*Math.pow(r,a)}).reduce(function(n,a){return n+a})},zO=function(t,r){return function(n){var a=Tz(t,r);return Dz(a,n)}},a6e=function(t,r){return function(n){var a=Tz(t,r),i=[].concat(t6e(a.map(function(o,l){return o*l}).slice(1)),[0]);return Dz(i,n)}},qO=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0],i=r[1],o=r[2],l=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,i=0,o=1,l=1;break;case"ease":a=.25,i=.1,o=.25,l=1;break;case"ease-in":a=.42,i=0,o=1,l=1;break;case"ease-out":a=.42,i=0,o=.58,l=1;break;case"ease-in-out":a=0,i=0,o=.58,l=1;break;default:{var c=r[0].split("(");if(c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4){var d=c[1].split(")")[0].split(",").map(function(v){return parseFloat(v)}),u=XIe(d,4);a=u[0],i=u[1],o=u[2],l=u[3]}}}var h=zO(a,o),f=zO(i,l),m=a6e(a,o),p=function(y){return y>1?1:y<0?0:y},g=function(y){for(var j=y>1?1:y,b=j,w=0;w<8;++w){var N=h(b)-j,C=m(b);if(Math.abs(N-j)<cb||C<cb)return f(b);b=p(b-N/C)}return f(b)};return g.isStepper=!1,g},i6e=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,n=r===void 0?100:r,a=t.damping,i=a===void 0?8:a,o=t.dt,l=o===void 0?17:o,c=function(u,h,f){var m=-(u-h)*n,p=f*i,g=f+(m-p)*l/1e3,v=f*l/1e3+u;return Math.abs(v-h)<cb&&Math.abs(g)<cb?[h,0]:[v,g]};return c.isStepper=!0,c.dt=l,c},o6e=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return qO(a);case"spring":return i6e();default:if(a.split("(")[0]==="cubic-bezier")return qO(a)}return typeof a=="function"?a:null};function Rv(s){"@babel/helpers - typeof";return Rv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rv(s)}function VO(s){return d6e(s)||c6e(s)||Oz(s)||l6e()}function l6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function c6e(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function d6e(s){if(Array.isArray(s))return jA(s)}function WO(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function Jo(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WO(Object(r),!0).forEach(function(n){yA(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):WO(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function yA(s,t,r){return t=u6e(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function u6e(s){var t=h6e(s,"string");return Rv(t)==="symbol"?t:String(t)}function h6e(s,t){if(Rv(s)!=="object"||s===null)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Rv(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function m6e(s,t){return p6e(s)||x6e(s,t)||Oz(s,t)||f6e()}function f6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Oz(s,t){if(s){if(typeof s=="string")return jA(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jA(s,t)}}function jA(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=s[r];return n}function x6e(s,t){var r=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(s)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function p6e(s){if(Array.isArray(s))return s}var db=function(t,r,n){return t+(r-t)*n},bA=function(t){var r=t.from,n=t.to;return r!==n},g6e=function s(t,r,n){var a=G0(function(i,o){if(bA(o)){var l=t(o.from,o.to,o.velocity),c=m6e(l,2),d=c[0],u=c[1];return Jo(Jo({},o),{},{from:d,velocity:u})}return o},r);return n<1?G0(function(i,o){return bA(o)?Jo(Jo({},o),{},{velocity:db(o.velocity,a[i].velocity,n),from:db(o.from,a[i].from,n)}):o},r):s(t,a,n-1)};const v6e=function(s,t,r,n,a){var i=KIe(s,t),o=i.reduce(function(v,y){return Jo(Jo({},v),{},yA({},y,[s[y],t[y]]))},{}),l=i.reduce(function(v,y){return Jo(Jo({},v),{},yA({},y,{from:s[y],velocity:0,to:t[y]}))},{}),c=-1,d,u,h=function(){return null},f=function(){return G0(function(y,j){return j.from},l)},m=function(){return!Object.values(l).filter(bA).length},p=function(y){d||(d=y);var j=y-d,b=j/r.dt;l=g6e(r,l,b),a(Jo(Jo(Jo({},s),t),f())),d=y,m()||(c=requestAnimationFrame(h))},g=function(y){u||(u=y);var j=(y-u)/n,b=G0(function(N,C){return db.apply(void 0,VO(C).concat([r(j)]))},o);if(a(Jo(Jo(Jo({},s),t),b)),j<1)c=requestAnimationFrame(h);else{var w=G0(function(N,C){return db.apply(void 0,VO(C).concat([r(1)]))},o);a(Jo(Jo(Jo({},s),t),w))}};return h=r.isStepper?p:g,function(){return requestAnimationFrame(h),function(){cancelAnimationFrame(c)}}};function Gp(s){"@babel/helpers - typeof";return Gp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gp(s)}var y6e=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function j6e(s,t){if(s==null)return{};var r=b6e(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function b6e(s,t){if(s==null)return{};var r={},n=Object.keys(s),a,i;for(i=0;i<n.length;i++)a=n[i],!(t.indexOf(a)>=0)&&(r[a]=s[a]);return r}function ES(s){return C6e(s)||S6e(s)||w6e(s)||N6e()}function N6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w6e(s,t){if(s){if(typeof s=="string")return NA(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return NA(s,t)}}function S6e(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function C6e(s){if(Array.isArray(s))return NA(s)}function NA(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=s[r];return n}function HO(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function gd(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HO(Object(r),!0).forEach(function(n){A0(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):HO(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function A0(s,t,r){return t=Rz(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function A6e(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function E6e(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,Rz(n.key),n)}}function I6e(s,t,r){return t&&E6e(s.prototype,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function Rz(s){var t=P6e(s,"string");return Gp(t)==="symbol"?t:String(t)}function P6e(s,t){if(Gp(s)!=="object"||s===null)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Gp(n)!=="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function _6e(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&wA(s,t)}function wA(s,t){return wA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},wA(s,t)}function k6e(s){var t=T6e();return function(){var n=ub(s),a;if(t){var i=ub(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return SA(this,a)}}function SA(s,t){if(t&&(Gp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return CA(s)}function CA(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function T6e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ub(s){return ub=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ub(s)}var ad=function(s){_6e(r,s);var t=k6e(r);function r(n,a){var i;A6e(this,r),i=t.call(this,n,a);var o=i.props,l=o.isActive,c=o.attributeName,d=o.from,u=o.to,h=o.steps,f=o.children,m=o.duration;if(i.handleStyleChange=i.handleStyleChange.bind(CA(i)),i.changeStyle=i.changeStyle.bind(CA(i)),!l||m<=0)return i.state={style:{}},typeof f=="function"&&(i.state={style:u}),SA(i);if(h&&h.length)i.state={style:h[0].style};else if(d){if(typeof f=="function")return i.state={style:d},SA(i);i.state={style:c?A0({},c,d):d}}else i.state={style:{}};return i}return I6e(r,[{key:"componentDidMount",value:function(){var a=this.props,i=a.isActive,o=a.canBegin;this.mounted=!0,!(!i||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var i=this.props,o=i.isActive,l=i.canBegin,c=i.attributeName,d=i.shouldReAnimate,u=i.to,h=i.from,f=this.state.style;if(l){if(!o){var m={style:c?A0({},c,u):u};this.state&&f&&(c&&f[c]!==u||!c&&f!==u)&&this.setState(m);return}if(!(LIe(a.to,u)&&a.canBegin&&a.isActive)){var p=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var g=p||d?h:a.to;if(this.state&&f){var v={style:c?A0({},c,g):g};(c&&f[c]!==g||!c&&f!==g)&&this.setState(v)}this.runAnimation(gd(gd({},this.props),{},{from:g,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var i=this,o=a.from,l=a.to,c=a.duration,d=a.easing,u=a.begin,h=a.onAnimationEnd,f=a.onAnimationStart,m=v6e(o,l,o6e(d),c,this.changeStyle),p=function(){i.stopJSAnimation=m()};this.manager.start([f,u,p,c,h])}},{key:"runStepAnimation",value:function(a){var i=this,o=a.steps,l=a.begin,c=a.onAnimationStart,d=o[0],u=d.style,h=d.duration,f=h===void 0?0:h,m=function(g,v,y){if(y===0)return g;var j=v.duration,b=v.easing,w=b===void 0?"ease":b,N=v.style,C=v.properties,S=v.onAnimationEnd,_=y>0?o[y-1]:v,k=C||Object.keys(N);if(typeof w=="function"||w==="spring")return[].concat(ES(g),[i.runJSAnimation.bind(i,{from:_.style,to:N,duration:j,easing:w}),j]);var F=UO(k,j,w),A=gd(gd(gd({},_.style),N),{},{transition:F});return[].concat(ES(g),[A,j,S]).filter(YIe)};return this.manager.start([c].concat(ES(o.reduce(m,[u,Math.max(f,l)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=WIe());var i=a.begin,o=a.duration,l=a.attributeName,c=a.to,d=a.easing,u=a.onAnimationStart,h=a.onAnimationEnd,f=a.steps,m=a.children,p=this.manager;if(this.unSubscribe=p.subscribe(this.handleStyleChange),typeof d=="function"||typeof m=="function"||d==="spring"){this.runJSAnimation(a);return}if(f.length>1){this.runStepAnimation(a);return}var g=l?A0({},l,c):c,v=UO(Object.keys(g),o,d);p.start([u,i,gd(gd({},g),{},{transition:v}),o,h])}},{key:"render",value:function(){var a=this.props,i=a.children;a.begin;var o=a.duration;a.attributeName,a.easing;var l=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var c=j6e(a,y6e),d=x.Children.count(i),u=this.state.style;if(typeof i=="function")return i(u);if(!l||d===0||o<=0)return i;var h=function(m){var p=m.props,g=p.style,v=g===void 0?{}:g,y=p.className,j=x.cloneElement(m,gd(gd({},c),{},{style:gd(gd({},v),u),className:y}));return j};return d===1?h(x.Children.only(i)):xe.createElement("div",null,x.Children.map(i,function(f){return h(f)}))}}]),r}(x.PureComponent);ad.displayName="Animate";ad.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};ad.propTypes={from:da.oneOfType([da.object,da.string]),to:da.oneOfType([da.object,da.string]),attributeName:da.string,duration:da.number,begin:da.number,easing:da.oneOfType([da.string,da.func]),steps:da.arrayOf(da.shape({duration:da.number.isRequired,style:da.object.isRequired,easing:da.oneOfType([da.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),da.func]),properties:da.arrayOf("string"),onAnimationEnd:da.func})),children:da.oneOfType([da.node,da.func]),isActive:da.bool,canBegin:da.bool,onAnimationEnd:da.func,shouldReAnimate:da.bool,onAnimationStart:da.func,onAnimationReStart:da.func};function Fv(s){"@babel/helpers - typeof";return Fv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fv(s)}function hb(){return hb=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},hb.apply(this,arguments)}function D6e(s,t){return M6e(s)||F6e(s,t)||R6e(s,t)||O6e()}function O6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function R6e(s,t){if(s){if(typeof s=="string")return GO(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GO(s,t)}}function GO(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=s[r];return n}function F6e(s,t){var r=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(s)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function M6e(s){if(Array.isArray(s))return s}function KO(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function YO(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KO(Object(r),!0).forEach(function(n){L6e(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):KO(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function L6e(s,t,r){return t=$6e(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function $6e(s){var t=B6e(s,"string");return Fv(t)=="symbol"?t:t+""}function B6e(s,t){if(Fv(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Fv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}var JO=function(t,r,n,a,i){var o=Math.min(Math.abs(n)/2,Math.abs(a)/2),l=a>=0?1:-1,c=n>=0?1:-1,d=a>=0&&n>=0||a<0&&n<0?1:0,u;if(o>0&&i instanceof Array){for(var h=[0,0,0,0],f=0,m=4;f<m;f++)h[f]=i[f]>o?o:i[f];u="M".concat(t,",").concat(r+l*h[0]),h[0]>0&&(u+="A ".concat(h[0],",").concat(h[0],",0,0,").concat(d,",").concat(t+c*h[0],",").concat(r)),u+="L ".concat(t+n-c*h[1],",").concat(r),h[1]>0&&(u+="A ".concat(h[1],",").concat(h[1],",0,0,").concat(d,`,
        `).concat(t+n,",").concat(r+l*h[1])),u+="L ".concat(t+n,",").concat(r+a-l*h[2]),h[2]>0&&(u+="A ".concat(h[2],",").concat(h[2],",0,0,").concat(d,`,
        `).concat(t+n-c*h[2],",").concat(r+a)),u+="L ".concat(t+c*h[3],",").concat(r+a),h[3]>0&&(u+="A ".concat(h[3],",").concat(h[3],",0,0,").concat(d,`,
        `).concat(t,",").concat(r+a-l*h[3])),u+="Z"}else if(o>0&&i===+i&&i>0){var p=Math.min(o,i);u="M ".concat(t,",").concat(r+l*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(d,",").concat(t+c*p,",").concat(r,`
            L `).concat(t+n-c*p,",").concat(r,`
            A `).concat(p,",").concat(p,",0,0,").concat(d,",").concat(t+n,",").concat(r+l*p,`
            L `).concat(t+n,",").concat(r+a-l*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(d,",").concat(t+n-c*p,",").concat(r+a,`
            L `).concat(t+c*p,",").concat(r+a,`
            A `).concat(p,",").concat(p,",0,0,").concat(d,",").concat(t,",").concat(r+a-l*p," Z")}else u="M ".concat(t,",").concat(r," h ").concat(n," v ").concat(a," h ").concat(-n," Z");return u},U6e=function(t,r){if(!t||!r)return!1;var n=t.x,a=t.y,i=r.x,o=r.y,l=r.width,c=r.height;if(Math.abs(l)>0&&Math.abs(c)>0){var d=Math.min(i,i+l),u=Math.max(i,i+l),h=Math.min(o,o+c),f=Math.max(o,o+c);return n>=d&&n<=u&&a>=h&&a<=f}return!1},z6e={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},CE=function(t){var r=YO(YO({},z6e),t),n=x.useRef(),a=x.useState(-1),i=D6e(a,2),o=i[0],l=i[1];x.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var w=n.current.getTotalLength();w&&l(w)}catch{}},[]);var c=r.x,d=r.y,u=r.width,h=r.height,f=r.radius,m=r.className,p=r.animationEasing,g=r.animationDuration,v=r.animationBegin,y=r.isAnimationActive,j=r.isUpdateAnimationActive;if(c!==+c||d!==+d||u!==+u||h!==+h||u===0||h===0)return null;var b=Jr("recharts-rectangle",m);return j?xe.createElement(ad,{canBegin:o>0,from:{width:u,height:h,x:c,y:d},to:{width:u,height:h,x:c,y:d},duration:g,animationEasing:p,isActive:j},function(w){var N=w.width,C=w.height,S=w.x,_=w.y;return xe.createElement(ad,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:v,duration:g,isActive:y,easing:p},xe.createElement("path",hb({},xr(r,!0),{className:b,d:JO(S,_,N,C,f),ref:n})))}):xe.createElement("path",hb({},xr(r,!0),{className:b,d:JO(c,d,u,h,f)}))},q6e=["points","className","baseLinePoints","connectNulls"];function Yx(){return Yx=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},Yx.apply(this,arguments)}function V6e(s,t){if(s==null)return{};var r=W6e(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function W6e(s,t){if(s==null)return{};var r={};for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n)){if(t.indexOf(n)>=0)continue;r[n]=s[n]}return r}function XO(s){return Y6e(s)||K6e(s)||G6e(s)||H6e()}function H6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function G6e(s,t){if(s){if(typeof s=="string")return AA(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return AA(s,t)}}function K6e(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function Y6e(s){if(Array.isArray(s))return AA(s)}function AA(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=s[r];return n}var QO=function(t){return t&&t.x===+t.x&&t.y===+t.y},J6e=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(n){QO(n)?r[r.length-1].push(n):r[r.length-1].length>0&&r.push([])}),QO(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},K0=function(t,r){var n=J6e(t);r&&(n=[n.reduce(function(i,o){return[].concat(XO(i),XO(o))},[])]);var a=n.map(function(i){return i.reduce(function(o,l,c){return"".concat(o).concat(c===0?"M":"L").concat(l.x,",").concat(l.y)},"")}).join("");return n.length===1?"".concat(a,"Z"):a},X6e=function(t,r,n){var a=K0(t,n);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(K0(r.reverse(),n).slice(1))},Q6e=function(t){var r=t.points,n=t.className,a=t.baseLinePoints,i=t.connectNulls,o=V6e(t,q6e);if(!r||!r.length)return null;var l=Jr("recharts-polygon",n);if(a&&a.length){var c=o.stroke&&o.stroke!=="none",d=X6e(r,a,i);return xe.createElement("g",{className:l},xe.createElement("path",Yx({},xr(o,!0),{fill:d.slice(-1)==="Z"?o.fill:"none",stroke:"none",d})),c?xe.createElement("path",Yx({},xr(o,!0),{fill:"none",d:K0(r,i)})):null,c?xe.createElement("path",Yx({},xr(o,!0),{fill:"none",d:K0(a,i)})):null)}var u=K0(r,i);return xe.createElement("path",Yx({},xr(o,!0),{fill:u.slice(-1)==="Z"?o.fill:"none",className:l,d:u}))};function EA(){return EA=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},EA.apply(this,arguments)}var jy=function(t){var r=t.cx,n=t.cy,a=t.r,i=t.className,o=Jr("recharts-dot",i);return r===+r&&n===+n&&a===+a?x.createElement("circle",EA({},xr(t,!1),D1(t),{className:o,cx:r,cy:n,r:a})):null};function Mv(s){"@babel/helpers - typeof";return Mv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mv(s)}var Z6e=["x","y","top","left","width","height","className"];function IA(){return IA=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},IA.apply(this,arguments)}function ZO(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function ePe(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZO(Object(r),!0).forEach(function(n){tPe(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):ZO(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function tPe(s,t,r){return t=sPe(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function sPe(s){var t=rPe(s,"string");return Mv(t)=="symbol"?t:t+""}function rPe(s,t){if(Mv(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Mv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function nPe(s,t){if(s==null)return{};var r=aPe(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function aPe(s,t){if(s==null)return{};var r={};for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n)){if(t.indexOf(n)>=0)continue;r[n]=s[n]}return r}var iPe=function(t,r,n,a,i,o){return"M".concat(t,",").concat(i,"v").concat(a,"M").concat(o,",").concat(r,"h").concat(n)},oPe=function(t){var r=t.x,n=r===void 0?0:r,a=t.y,i=a===void 0?0:a,o=t.top,l=o===void 0?0:o,c=t.left,d=c===void 0?0:c,u=t.width,h=u===void 0?0:u,f=t.height,m=f===void 0?0:f,p=t.className,g=nPe(t,Z6e),v=ePe({x:n,y:i,top:l,left:d,width:h,height:m},g);return!ks(n)||!ks(i)||!ks(h)||!ks(m)||!ks(l)||!ks(d)?null:xe.createElement("path",IA({},xr(v,!0),{className:Jr("recharts-cross",p),d:iPe(n,i,h,m,l,d)}))},lPe=ZN,cPe=GU,dPe=bu;function uPe(s,t){return s&&s.length?lPe(s,dPe(t),cPe):void 0}var hPe=uPe;const mPe=Ca(hPe);var fPe=ZN,xPe=bu,pPe=KU;function gPe(s,t){return s&&s.length?fPe(s,xPe(t),pPe):void 0}var vPe=gPe;const yPe=Ca(vPe);var jPe=["cx","cy","angle","ticks","axisLine"],bPe=["ticks","tick","angle","tickFormatter","stroke"];function Kp(s){"@babel/helpers - typeof";return Kp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kp(s)}function Y0(){return Y0=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},Y0.apply(this,arguments)}function e8(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function af(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?e8(Object(r),!0).forEach(function(n){rw(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):e8(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function t8(s,t){if(s==null)return{};var r=NPe(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function NPe(s,t){if(s==null)return{};var r={};for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n)){if(t.indexOf(n)>=0)continue;r[n]=s[n]}return r}function wPe(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function s8(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,Mz(n.key),n)}}function SPe(s,t,r){return t&&s8(s.prototype,t),r&&s8(s,r),Object.defineProperty(s,"prototype",{writable:!1}),s}function CPe(s,t,r){return t=mb(t),APe(s,Fz()?Reflect.construct(t,r||[],mb(s).constructor):t.apply(s,r))}function APe(s,t){if(t&&(Kp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return EPe(s)}function EPe(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function Fz(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Fz=function(){return!!s})()}function mb(s){return mb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},mb(s)}function IPe(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&PA(s,t)}function PA(s,t){return PA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},PA(s,t)}function rw(s,t,r){return t=Mz(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function Mz(s){var t=PPe(s,"string");return Kp(t)=="symbol"?t:t+""}function PPe(s,t){if(Kp(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Kp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}var nw=function(s){function t(){return wPe(this,t),CPe(this,t,arguments)}return IPe(t,s),SPe(t,[{key:"getTickValueCoord",value:function(n){var a=n.coordinate,i=this.props,o=i.angle,l=i.cx,c=i.cy;return si(l,c,a,o)}},{key:"getTickTextAnchor",value:function(){var n=this.props.orientation,a;switch(n){case"left":a="end";break;case"right":a="start";break;default:a="middle";break}return a}},{key:"getViewBox",value:function(){var n=this.props,a=n.cx,i=n.cy,o=n.angle,l=n.ticks,c=mPe(l,function(u){return u.coordinate||0}),d=yPe(l,function(u){return u.coordinate||0});return{cx:a,cy:i,startAngle:o,endAngle:o,innerRadius:d.coordinate||0,outerRadius:c.coordinate||0}}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,i=n.cy,o=n.angle,l=n.ticks,c=n.axisLine,d=t8(n,jPe),u=l.reduce(function(p,g){return[Math.min(p[0],g.coordinate),Math.max(p[1],g.coordinate)]},[1/0,-1/0]),h=si(a,i,u[0],o),f=si(a,i,u[1],o),m=af(af(af({},xr(d,!1)),{},{fill:"none"},xr(c,!1)),{},{x1:h.x,y1:h.y,x2:f.x,y2:f.y});return xe.createElement("line",Y0({className:"recharts-polar-radius-axis-line"},m))}},{key:"renderTicks",value:function(){var n=this,a=this.props,i=a.ticks,o=a.tick,l=a.angle,c=a.tickFormatter,d=a.stroke,u=t8(a,bPe),h=this.getTickTextAnchor(),f=xr(u,!1),m=xr(o,!1),p=i.map(function(g,v){var y=n.getTickValueCoord(g),j=af(af(af(af({textAnchor:h,transform:"rotate(".concat(90-l,", ").concat(y.x,", ").concat(y.y,")")},f),{},{stroke:"none",fill:d},m),{},{index:v},y),{},{payload:g});return xe.createElement(mn,Y0({className:Jr("recharts-polar-radius-axis-tick",Nz(o)),key:"tick-".concat(g.coordinate)},Mm(n.props,g,v)),t.renderTickItem(o,j,c?c(g.value,v):g.value))});return xe.createElement(mn,{className:"recharts-polar-radius-axis-ticks"},p)}},{key:"render",value:function(){var n=this.props,a=n.ticks,i=n.axisLine,o=n.tick;return!a||!a.length?null:xe.createElement(mn,{className:Jr("recharts-polar-radius-axis",this.props.className)},i&&this.renderAxisLine(),o&&this.renderTicks(),Lo.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(n,a,i){var o;return xe.isValidElement(n)?o=xe.cloneElement(n,a):Lr(n)?o=n(a):o=xe.createElement(ix,Y0({},a,{className:"recharts-polar-radius-axis-tick-value"}),i),o}}])}(x.PureComponent);rw(nw,"displayName","PolarRadiusAxis");rw(nw,"axisType","radiusAxis");rw(nw,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function Yp(s){"@babel/helpers - typeof";return Yp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yp(s)}function gf(){return gf=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},gf.apply(this,arguments)}function r8(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function of(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?r8(Object(r),!0).forEach(function(n){aw(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):r8(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function _Pe(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function n8(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,$z(n.key),n)}}function kPe(s,t,r){return t&&n8(s.prototype,t),r&&n8(s,r),Object.defineProperty(s,"prototype",{writable:!1}),s}function TPe(s,t,r){return t=fb(t),DPe(s,Lz()?Reflect.construct(t,r||[],fb(s).constructor):t.apply(s,r))}function DPe(s,t){if(t&&(Yp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OPe(s)}function OPe(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function Lz(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Lz=function(){return!!s})()}function fb(s){return fb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},fb(s)}function RPe(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&_A(s,t)}function _A(s,t){return _A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},_A(s,t)}function aw(s,t,r){return t=$z(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function $z(s){var t=FPe(s,"string");return Yp(t)=="symbol"?t:t+""}function FPe(s,t){if(Yp(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Yp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}var MPe=Math.PI/180,a8=1e-5,iw=function(s){function t(){return _Pe(this,t),TPe(this,t,arguments)}return RPe(t,s),kPe(t,[{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.cx,o=a.cy,l=a.radius,c=a.orientation,d=a.tickSize,u=d||8,h=si(i,o,l,n.coordinate),f=si(i,o,l+(c==="inner"?-1:1)*u,n.coordinate);return{x1:h.x,y1:h.y,x2:f.x,y2:f.y}}},{key:"getTickTextAnchor",value:function(n){var a=this.props.orientation,i=Math.cos(-n.coordinate*MPe),o;return i>a8?o=a==="outer"?"start":"end":i<-a8?o=a==="outer"?"end":"start":o="middle",o}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.cx,i=n.cy,o=n.radius,l=n.axisLine,c=n.axisLineType,d=of(of({},xr(this.props,!1)),{},{fill:"none"},xr(l,!1));if(c==="circle")return xe.createElement(jy,gf({className:"recharts-polar-angle-axis-line"},d,{cx:a,cy:i,r:o}));var u=this.props.ticks,h=u.map(function(f){return si(a,i,o,f.coordinate)});return xe.createElement(Q6e,gf({className:"recharts-polar-angle-axis-line"},d,{points:h}))}},{key:"renderTicks",value:function(){var n=this,a=this.props,i=a.ticks,o=a.tick,l=a.tickLine,c=a.tickFormatter,d=a.stroke,u=xr(this.props,!1),h=xr(o,!1),f=of(of({},u),{},{fill:"none"},xr(l,!1)),m=i.map(function(p,g){var v=n.getTickLineCoord(p),y=n.getTickTextAnchor(p),j=of(of(of({textAnchor:y},u),{},{stroke:"none",fill:d},h),{},{index:g,payload:p,x:v.x2,y:v.y2});return xe.createElement(mn,gf({className:Jr("recharts-polar-angle-axis-tick",Nz(o)),key:"tick-".concat(p.coordinate)},Mm(n.props,p,g)),l&&xe.createElement("line",gf({className:"recharts-polar-angle-axis-tick-line"},f,v)),o&&t.renderTickItem(o,j,c?c(p.value,g):p.value))});return xe.createElement(mn,{className:"recharts-polar-angle-axis-ticks"},m)}},{key:"render",value:function(){var n=this.props,a=n.ticks,i=n.radius,o=n.axisLine;return i<=0||!a||!a.length?null:xe.createElement(mn,{className:Jr("recharts-polar-angle-axis",this.props.className)},o&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(n,a,i){var o;return xe.isValidElement(n)?o=xe.cloneElement(n,a):Lr(n)?o=n(a):o=xe.createElement(ix,gf({},a,{className:"recharts-polar-angle-axis-tick-value"}),i),o}}])}(x.PureComponent);aw(iw,"displayName","PolarAngleAxis");aw(iw,"axisType","angleAxis");aw(iw,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var LPe=qB,$Pe=LPe(Object.getPrototypeOf,Object),BPe=$Pe,UPe=gh,zPe=BPe,qPe=vh,VPe="[object Object]",WPe=Function.prototype,HPe=Object.prototype,Bz=WPe.toString,GPe=HPe.hasOwnProperty,KPe=Bz.call(Object);function YPe(s){if(!qPe(s)||UPe(s)!=VPe)return!1;var t=zPe(s);if(t===null)return!0;var r=GPe.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&Bz.call(r)==KPe}var JPe=YPe;const XPe=Ca(JPe);var QPe=gh,ZPe=vh,e_e="[object Boolean]";function t_e(s){return s===!0||s===!1||ZPe(s)&&QPe(s)==e_e}var s_e=t_e;const r_e=Ca(s_e);function Lv(s){"@babel/helpers - typeof";return Lv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lv(s)}function xb(){return xb=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},xb.apply(this,arguments)}function n_e(s,t){return l_e(s)||o_e(s,t)||i_e(s,t)||a_e()}function a_e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function i_e(s,t){if(s){if(typeof s=="string")return i8(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i8(s,t)}}function i8(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=s[r];return n}function o_e(s,t){var r=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(s)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function l_e(s){if(Array.isArray(s))return s}function o8(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function l8(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?o8(Object(r),!0).forEach(function(n){c_e(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):o8(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function c_e(s,t,r){return t=d_e(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function d_e(s){var t=u_e(s,"string");return Lv(t)=="symbol"?t:t+""}function u_e(s,t){if(Lv(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Lv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}var c8=function(t,r,n,a,i){var o=n-a,l;return l="M ".concat(t,",").concat(r),l+="L ".concat(t+n,",").concat(r),l+="L ".concat(t+n-o/2,",").concat(r+i),l+="L ".concat(t+n-o/2-a,",").concat(r+i),l+="L ".concat(t,",").concat(r," Z"),l},h_e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},m_e=function(t){var r=l8(l8({},h_e),t),n=x.useRef(),a=x.useState(-1),i=n_e(a,2),o=i[0],l=i[1];x.useEffect(function(){if(n.current&&n.current.getTotalLength)try{var b=n.current.getTotalLength();b&&l(b)}catch{}},[]);var c=r.x,d=r.y,u=r.upperWidth,h=r.lowerWidth,f=r.height,m=r.className,p=r.animationEasing,g=r.animationDuration,v=r.animationBegin,y=r.isUpdateAnimationActive;if(c!==+c||d!==+d||u!==+u||h!==+h||f!==+f||u===0&&h===0||f===0)return null;var j=Jr("recharts-trapezoid",m);return y?xe.createElement(ad,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:f,x:c,y:d},to:{upperWidth:u,lowerWidth:h,height:f,x:c,y:d},duration:g,animationEasing:p,isActive:y},function(b){var w=b.upperWidth,N=b.lowerWidth,C=b.height,S=b.x,_=b.y;return xe.createElement(ad,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:v,duration:g,easing:p},xe.createElement("path",xb({},xr(r,!0),{className:j,d:c8(S,_,w,N,C),ref:n})))}):xe.createElement("g",null,xe.createElement("path",xb({},xr(r,!0),{className:j,d:c8(c,d,u,h,f)})))},f_e=["option","shapeType","propTransformer","activeClassName","isActive"];function $v(s){"@babel/helpers - typeof";return $v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$v(s)}function x_e(s,t){if(s==null)return{};var r=p_e(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function p_e(s,t){if(s==null)return{};var r={};for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n)){if(t.indexOf(n)>=0)continue;r[n]=s[n]}return r}function d8(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function pb(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d8(Object(r),!0).forEach(function(n){g_e(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):d8(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function g_e(s,t,r){return t=v_e(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function v_e(s){var t=y_e(s,"string");return $v(t)=="symbol"?t:t+""}function y_e(s,t){if($v(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if($v(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function j_e(s,t){return pb(pb({},t),s)}function b_e(s,t){return s==="symbols"}function u8(s){var t=s.shapeType,r=s.elementProps;switch(t){case"rectangle":return xe.createElement(CE,r);case"trapezoid":return xe.createElement(m_e,r);case"sector":return xe.createElement(Cz,r);case"symbols":if(b_e(t))return xe.createElement(qN,r);break;default:return null}}function N_e(s){return x.isValidElement(s)?s.props:s}function gb(s){var t=s.option,r=s.shapeType,n=s.propTransformer,a=n===void 0?j_e:n,i=s.activeClassName,o=i===void 0?"recharts-active-shape":i,l=s.isActive,c=x_e(s,f_e),d;if(x.isValidElement(t))d=x.cloneElement(t,pb(pb({},c),N_e(t)));else if(Lr(t))d=t(c);else if(XPe(t)&&!r_e(t)){var u=a(t,c);d=xe.createElement(u8,{shapeType:r,elementProps:u})}else{var h=c;d=xe.createElement(u8,{shapeType:r,elementProps:h})}return l?xe.createElement(mn,{className:o},d):d}function ow(s,t){return t!=null&&"trapezoids"in s.props}function lw(s,t){return t!=null&&"sectors"in s.props}function Bv(s,t){return t!=null&&"points"in s.props}function w_e(s,t){var r,n,a=s.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||s.x===t.x,i=s.y===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.y)||s.y===t.y;return a&&i}function S_e(s,t){var r=s.endAngle===t.endAngle,n=s.startAngle===t.startAngle;return r&&n}function C_e(s,t){var r=s.x===t.x,n=s.y===t.y,a=s.z===t.z;return r&&n&&a}function A_e(s,t){var r;return ow(s,t)?r=w_e:lw(s,t)?r=S_e:Bv(s,t)&&(r=C_e),r}function E_e(s,t){var r;return ow(s,t)?r="trapezoids":lw(s,t)?r="sectors":Bv(s,t)&&(r="points"),r}function I_e(s,t){if(ow(s,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(lw(s,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}return Bv(s,t)?t.payload:{}}function P_e(s){var t=s.activeTooltipItem,r=s.graphicalItem,n=s.itemData,a=E_e(r,t),i=I_e(r,t),o=n.filter(function(c,d){var u=Lm(i,c),h=r.props[a].filter(function(p){var g=A_e(r,t);return g(p,t)}),f=r.props[a].indexOf(h[h.length-1]),m=d===f;return u&&m}),l=n.indexOf(o[o.length-1]);return l}var Gj;function Jp(s){"@babel/helpers - typeof";return Jp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jp(s)}function Jx(){return Jx=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},Jx.apply(this,arguments)}function h8(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function Ja(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h8(Object(r),!0).forEach(function(n){Qc(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):h8(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function __e(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function m8(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,zz(n.key),n)}}function k_e(s,t,r){return t&&m8(s.prototype,t),r&&m8(s,r),Object.defineProperty(s,"prototype",{writable:!1}),s}function T_e(s,t,r){return t=vb(t),D_e(s,Uz()?Reflect.construct(t,r||[],vb(s).constructor):t.apply(s,r))}function D_e(s,t){if(t&&(Jp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return O_e(s)}function O_e(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function Uz(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Uz=function(){return!!s})()}function vb(s){return vb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},vb(s)}function R_e(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&kA(s,t)}function kA(s,t){return kA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},kA(s,t)}function Qc(s,t,r){return t=zz(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function zz(s){var t=F_e(s,"string");return Jp(t)=="symbol"?t:t+""}function F_e(s,t){if(Jp(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Jp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}var bh=function(s){function t(r){var n;return __e(this,t),n=T_e(this,t,[r]),Qc(n,"pieRef",null),Qc(n,"sectorRefs",[]),Qc(n,"id",Hm("recharts-pie-")),Qc(n,"handleAnimationEnd",function(){var a=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),Lr(a)&&a()}),Qc(n,"handleAnimationStart",function(){var a=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),Lr(a)&&a()}),n.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},n}return R_e(t,s),k_e(t,[{key:"isActiveIndex",value:function(n){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(n)!==-1:n===a}},{key:"hasActiveIndex",value:function(){var n=this.props.activeIndex;return Array.isArray(n)?n.length!==0:n||n===0}},{key:"renderLabels",value:function(n){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.label,l=i.labelLine,c=i.dataKey,d=i.valueKey,u=xr(this.props,!1),h=xr(o,!1),f=xr(l,!1),m=o&&o.offsetRadius||20,p=n.map(function(g,v){var y=(g.startAngle+g.endAngle)/2,j=si(g.cx,g.cy,g.outerRadius+m,y),b=Ja(Ja(Ja(Ja({},u),g),{},{stroke:"none"},h),{},{index:v,textAnchor:t.getTextAnchor(j.x,g.cx)},j),w=Ja(Ja(Ja(Ja({},u),g),{},{fill:"none",stroke:g.fill},f),{},{index:v,points:[si(g.cx,g.cy,g.outerRadius,y),j]}),N=c;return Fr(c)&&Fr(d)?N="value":Fr(c)&&(N=d),xe.createElement(mn,{key:"label-".concat(g.startAngle,"-").concat(g.endAngle,"-").concat(g.midAngle,"-").concat(v)},l&&t.renderLabelLineItem(l,w,"line"),t.renderLabelItem(o,b,ui(g,N)))});return xe.createElement(mn,{className:"recharts-pie-labels"},p)}},{key:"renderSectorsStatically",value:function(n){var a=this,i=this.props,o=i.activeShape,l=i.blendStroke,c=i.inactiveShape;return n.map(function(d,u){if((d==null?void 0:d.startAngle)===0&&(d==null?void 0:d.endAngle)===0&&n.length!==1)return null;var h=a.isActiveIndex(u),f=c&&a.hasActiveIndex()?c:null,m=h?o:f,p=Ja(Ja({},d),{},{stroke:l?d.fill:d.stroke,tabIndex:-1});return xe.createElement(mn,Jx({ref:function(v){v&&!a.sectorRefs.includes(v)&&a.sectorRefs.push(v)},tabIndex:-1,className:"recharts-pie-sector"},Mm(a.props,d,u),{key:"sector-".concat(d==null?void 0:d.startAngle,"-").concat(d==null?void 0:d.endAngle,"-").concat(d.midAngle,"-").concat(u)}),xe.createElement(gb,Jx({option:m,isActive:h,shapeType:"sector"},p)))})}},{key:"renderSectorsWithAnimation",value:function(){var n=this,a=this.props,i=a.sectors,o=a.isAnimationActive,l=a.animationBegin,c=a.animationDuration,d=a.animationEasing,u=a.animationId,h=this.state,f=h.prevSectors,m=h.prevIsAnimationActive;return xe.createElement(ad,{begin:l,duration:c,isActive:o,easing:d,from:{t:0},to:{t:1},key:"pie-".concat(u,"-").concat(m),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(p){var g=p.t,v=[],y=i&&i[0],j=y.startAngle;return i.forEach(function(b,w){var N=f&&f[w],C=w>0?Pc(b,"paddingAngle",0):0;if(N){var S=Ni(N.endAngle-N.startAngle,b.endAngle-b.startAngle),_=Ja(Ja({},b),{},{startAngle:j+C,endAngle:j+S(g)+C});v.push(_),j=_.endAngle}else{var k=b.endAngle,F=b.startAngle,A=Ni(0,k-F),T=A(g),V=Ja(Ja({},b),{},{startAngle:j+C,endAngle:j+T+C});v.push(V),j=V.endAngle}}),xe.createElement(mn,null,n.renderSectorsStatically(v))})}},{key:"attachKeyboardHandlers",value:function(n){var a=this;n.onkeydown=function(i){if(!i.altKey)switch(i.key){case"ArrowLeft":{var o=++a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[o].focus(),a.setState({sectorToFocus:o});break}case"ArrowRight":{var l=--a.state.sectorToFocus<0?a.sectorRefs.length-1:a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[l].focus(),a.setState({sectorToFocus:l});break}case"Escape":{a.sectorRefs[a.state.sectorToFocus].blur(),a.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var n=this.props,a=n.sectors,i=n.isAnimationActive,o=this.state.prevSectors;return i&&a&&a.length&&(!o||!Lm(o,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var n=this,a=this.props,i=a.hide,o=a.sectors,l=a.className,c=a.label,d=a.cx,u=a.cy,h=a.innerRadius,f=a.outerRadius,m=a.isAnimationActive,p=this.state.isAnimationFinished;if(i||!o||!o.length||!ks(d)||!ks(u)||!ks(h)||!ks(f))return null;var g=Jr("recharts-pie",l);return xe.createElement(mn,{tabIndex:this.props.rootTabIndex,className:g,ref:function(y){n.pieRef=y}},this.renderSectors(),c&&this.renderLabels(o),Lo.renderCallByParent(this.props,null,!1),(!m||p)&&Td.renderCallByParent(this.props,o,!1))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return a.prevIsAnimationActive!==n.isAnimationActive?{prevIsAnimationActive:n.isAnimationActive,prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:[],isAnimationFinished:!0}:n.isAnimationActive&&n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curSectors:n.sectors,prevSectors:a.curSectors,isAnimationFinished:!0}:n.sectors!==a.curSectors?{curSectors:n.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(n,a){return n>a?"start":n<a?"end":"middle"}},{key:"renderLabelLineItem",value:function(n,a,i){if(xe.isValidElement(n))return xe.cloneElement(n,a);if(Lr(n))return n(a);var o=Jr("recharts-pie-label-line",typeof n!="boolean"?n.className:"");return xe.createElement(km,Jx({},a,{key:i,type:"linear",className:o}))}},{key:"renderLabelItem",value:function(n,a,i){if(xe.isValidElement(n))return xe.cloneElement(n,a);var o=i;if(Lr(n)&&(o=n(a),xe.isValidElement(o)))return o;var l=Jr("recharts-pie-label-text",typeof n!="boolean"&&!Lr(n)?n.className:"");return xe.createElement(ix,Jx({},a,{alignmentBaseline:"middle",className:l}),o)}}])}(x.PureComponent);Gj=bh;Qc(bh,"displayName","Pie");Qc(bh,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!yh.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Qc(bh,"parseDeltaAngle",function(s,t){var r=kl(t-s),n=Math.min(Math.abs(t-s),360);return r*n});Qc(bh,"getRealPieData",function(s){var t=s.data,r=s.children,n=xr(s,!1),a=Ml(r,xy);return t&&t.length?t.map(function(i,o){return Ja(Ja(Ja({payload:i},n),i),a&&a[o]&&a[o].props)}):a&&a.length?a.map(function(i){return Ja(Ja({},n),i.props)}):[]});Qc(bh,"parseCoordinateOfPie",function(s,t){var r=t.top,n=t.left,a=t.width,i=t.height,o=bz(a,i),l=n+Tl(s.cx,a,a/2),c=r+Tl(s.cy,i,i/2),d=Tl(s.innerRadius,o,0),u=Tl(s.outerRadius,o,o*.8),h=s.maxRadius||Math.sqrt(a*a+i*i)/2;return{cx:l,cy:c,innerRadius:d,outerRadius:u,maxRadius:h}});Qc(bh,"getComposedData",function(s){var t=s.item,r=s.offset,n=t.type.defaultProps!==void 0?Ja(Ja({},t.type.defaultProps),t.props):t.props,a=Gj.getRealPieData(n);if(!a||!a.length)return null;var i=n.cornerRadius,o=n.startAngle,l=n.endAngle,c=n.paddingAngle,d=n.dataKey,u=n.nameKey,h=n.valueKey,f=n.tooltipType,m=Math.abs(n.minAngle),p=Gj.parseCoordinateOfPie(n,r),g=Gj.parseDeltaAngle(o,l),v=Math.abs(g),y=d;Fr(d)&&Fr(h)?(kd(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),y="value"):Fr(d)&&(kd(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),y=h);var j=a.filter(function(_){return ui(_,y,0)!==0}).length,b=(v>=360?j:j-1)*c,w=v-j*m-b,N=a.reduce(function(_,k){var F=ui(k,y,0);return _+(ks(F)?F:0)},0),C;if(N>0){var S;C=a.map(function(_,k){var F=ui(_,y,0),A=ui(_,u,k),T=(ks(F)?F:0)/N,V;k?V=S.endAngle+kl(g)*c*(F!==0?1:0):V=o;var M=V+kl(g)*((F!==0?m:0)+T*w),G=(V+M)/2,L=(p.innerRadius+p.outerRadius)/2,J=[{name:A,value:F,payload:_,dataKey:y,type:f}],z=si(p.cx,p.cy,L,G);return S=Ja(Ja(Ja({percent:T,cornerRadius:i,name:A,tooltipPayload:J,midAngle:G,middleRadius:L,tooltipPosition:z},_),p),{},{value:ui(_,y),startAngle:V,endAngle:M,payload:_,paddingAngle:kl(g)*c}),S})}return Ja(Ja({},p),{},{sectors:C,data:a})});var M_e=Math.ceil,L_e=Math.max;function $_e(s,t,r,n){for(var a=-1,i=L_e(M_e((t-s)/(r||1)),0),o=Array(i);i--;)o[n?i:++a]=s,s+=r;return o}var B_e=$_e,U_e=lU,f8=1/0,z_e=17976931348623157e292;function q_e(s){if(!s)return s===0?s:0;if(s=U_e(s),s===f8||s===-f8){var t=s<0?-1:1;return t*z_e}return s===s?s:0}var qz=q_e,V_e=B_e,W_e=HN,IS=qz;function H_e(s){return function(t,r,n){return n&&typeof n!="number"&&W_e(t,r,n)&&(r=n=void 0),t=IS(t),r===void 0?(r=t,t=0):r=IS(r),n=n===void 0?t<r?1:-1:IS(n),V_e(t,r,n,s)}}var G_e=H_e,K_e=G_e,Y_e=K_e(),J_e=Y_e;const yb=Ca(J_e);function Uv(s){"@babel/helpers - typeof";return Uv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uv(s)}function x8(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function p8(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x8(Object(r),!0).forEach(function(n){Vz(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):x8(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function Vz(s,t,r){return t=X_e(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function X_e(s){var t=Q_e(s,"string");return Uv(t)=="symbol"?t:t+""}function Q_e(s,t){if(Uv(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Uv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}var Z_e=["Webkit","Moz","O","ms"],eke=function(t,r){var n=t.replace(/(\w)/,function(i){return i.toUpperCase()}),a=Z_e.reduce(function(i,o){return p8(p8({},i),{},Vz({},o+n,r))},{});return a[t]=r,a};function Xp(s){"@babel/helpers - typeof";return Xp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xp(s)}function jb(){return jb=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},jb.apply(this,arguments)}function g8(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function PS(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g8(Object(r),!0).forEach(function(n){jc(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):g8(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function tke(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function v8(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,Hz(n.key),n)}}function ske(s,t,r){return t&&v8(s.prototype,t),r&&v8(s,r),Object.defineProperty(s,"prototype",{writable:!1}),s}function rke(s,t,r){return t=bb(t),nke(s,Wz()?Reflect.construct(t,r||[],bb(s).constructor):t.apply(s,r))}function nke(s,t){if(t&&(Xp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ake(s)}function ake(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function Wz(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Wz=function(){return!!s})()}function bb(s){return bb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},bb(s)}function ike(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&TA(s,t)}function TA(s,t){return TA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},TA(s,t)}function jc(s,t,r){return t=Hz(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function Hz(s){var t=oke(s,"string");return Xp(t)=="symbol"?t:t+""}function oke(s,t){if(Xp(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Xp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}var lke=function(t){var r=t.data,n=t.startIndex,a=t.endIndex,i=t.x,o=t.width,l=t.travellerWidth;if(!r||!r.length)return{};var c=r.length,d=W0().domain(yb(0,c)).range([i,i+o-l]),u=d.domain().map(function(h){return d(h)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:d(n),endX:d(a),scale:d,scaleValues:u}},y8=function(t){return t.changedTouches&&!!t.changedTouches.length},Qp=function(s){function t(r){var n;return tke(this,t),n=rke(this,t,[r]),jc(n,"handleDrag",function(a){n.leaveTimer&&(clearTimeout(n.leaveTimer),n.leaveTimer=null),n.state.isTravellerMoving?n.handleTravellerMove(a):n.state.isSlideMoving&&n.handleSlideDrag(a)}),jc(n,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&n.handleDrag(a.changedTouches[0])}),jc(n,"handleDragEnd",function(){n.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=n.props,i=a.endIndex,o=a.onDragEnd,l=a.startIndex;o==null||o({endIndex:i,startIndex:l})}),n.detachDragEndListener()}),jc(n,"handleLeaveWrapper",function(){(n.state.isTravellerMoving||n.state.isSlideMoving)&&(n.leaveTimer=window.setTimeout(n.handleDragEnd,n.props.leaveTimeOut))}),jc(n,"handleEnterSlideOrTraveller",function(){n.setState({isTextActive:!0})}),jc(n,"handleLeaveSlideOrTraveller",function(){n.setState({isTextActive:!1})}),jc(n,"handleSlideDragStart",function(a){var i=y8(a)?a.changedTouches[0]:a;n.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),n.attachDragEndListener()}),n.travellerDragStartHandlers={startX:n.handleTravellerDragStart.bind(n,"startX"),endX:n.handleTravellerDragStart.bind(n,"endX")},n.state={},n}return ike(t,s),ske(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(n){var a=n.startX,i=n.endX,o=this.state.scaleValues,l=this.props,c=l.gap,d=l.data,u=d.length-1,h=Math.min(a,i),f=Math.max(a,i),m=t.getIndexInRange(o,h),p=t.getIndexInRange(o,f);return{startIndex:m-m%c,endIndex:p===u?u:p-p%c}}},{key:"getTextOfTick",value:function(n){var a=this.props,i=a.data,o=a.tickFormatter,l=a.dataKey,c=ui(i[n],l,n);return Lr(o)?o(c,n):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(n){var a=this.state,i=a.slideMoveStartX,o=a.startX,l=a.endX,c=this.props,d=c.x,u=c.width,h=c.travellerWidth,f=c.startIndex,m=c.endIndex,p=c.onChange,g=n.pageX-i;g>0?g=Math.min(g,d+u-h-l,d+u-h-o):g<0&&(g=Math.max(g,d-o,d-l));var v=this.getIndex({startX:o+g,endX:l+g});(v.startIndex!==f||v.endIndex!==m)&&p&&p(v),this.setState({startX:o+g,endX:l+g,slideMoveStartX:n.pageX})}},{key:"handleTravellerDragStart",value:function(n,a){var i=y8(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:n,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(n){var a=this.state,i=a.brushMoveStartX,o=a.movingTravellerId,l=a.endX,c=a.startX,d=this.state[o],u=this.props,h=u.x,f=u.width,m=u.travellerWidth,p=u.onChange,g=u.gap,v=u.data,y={startX:this.state.startX,endX:this.state.endX},j=n.pageX-i;j>0?j=Math.min(j,h+f-m-d):j<0&&(j=Math.max(j,h-d)),y[o]=d+j;var b=this.getIndex(y),w=b.startIndex,N=b.endIndex,C=function(){var _=v.length-1;return o==="startX"&&(l>c?w%g===0:N%g===0)||l<c&&N===_||o==="endX"&&(l>c?N%g===0:w%g===0)||l>c&&N===_};this.setState(jc(jc({},o,d+j),"brushMoveStartX",n.pageX),function(){p&&C()&&p(b)})}},{key:"handleTravellerMoveKeyboard",value:function(n,a){var i=this,o=this.state,l=o.scaleValues,c=o.startX,d=o.endX,u=this.state[a],h=l.indexOf(u);if(h!==-1){var f=h+n;if(!(f===-1||f>=l.length)){var m=l[f];a==="startX"&&m>=d||a==="endX"&&m<=c||this.setState(jc({},a,m),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,l=n.height,c=n.fill,d=n.stroke;return xe.createElement("rect",{stroke:d,fill:c,x:a,y:i,width:o,height:l})}},{key:"renderPanorama",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,l=n.height,c=n.data,d=n.children,u=n.padding,h=x.Children.only(d);return h?xe.cloneElement(h,{x:a,y:i,width:o,height:l,margin:u,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(n,a){var i,o,l=this,c=this.props,d=c.y,u=c.travellerWidth,h=c.height,f=c.traveller,m=c.ariaLabel,p=c.data,g=c.startIndex,v=c.endIndex,y=Math.max(n,this.props.x),j=PS(PS({},xr(this.props,!1)),{},{x:y,y:d,width:u,height:h}),b=m||"Min value: ".concat((i=p[g])===null||i===void 0?void 0:i.name,", Max value: ").concat((o=p[v])===null||o===void 0?void 0:o.name);return xe.createElement(mn,{tabIndex:0,role:"slider","aria-label":b,"aria-valuenow":n,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(N){["ArrowLeft","ArrowRight"].includes(N.key)&&(N.preventDefault(),N.stopPropagation(),l.handleTravellerMoveKeyboard(N.key==="ArrowRight"?1:-1,a))},onFocus:function(){l.setState({isTravellerFocused:!0})},onBlur:function(){l.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(f,j))}},{key:"renderSlide",value:function(n,a){var i=this.props,o=i.y,l=i.height,c=i.stroke,d=i.travellerWidth,u=Math.min(n,a)+d,h=Math.max(Math.abs(a-n)-d,0);return xe.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:u,y:o,width:h,height:l})}},{key:"renderText",value:function(){var n=this.props,a=n.startIndex,i=n.endIndex,o=n.y,l=n.height,c=n.travellerWidth,d=n.stroke,u=this.state,h=u.startX,f=u.endX,m=5,p={pointerEvents:"none",fill:d};return xe.createElement(mn,{className:"recharts-brush-texts"},xe.createElement(ix,jb({textAnchor:"end",verticalAnchor:"middle",x:Math.min(h,f)-m,y:o+l/2},p),this.getTextOfTick(a)),xe.createElement(ix,jb({textAnchor:"start",verticalAnchor:"middle",x:Math.max(h,f)+c+m,y:o+l/2},p),this.getTextOfTick(i)))}},{key:"render",value:function(){var n=this.props,a=n.data,i=n.className,o=n.children,l=n.x,c=n.y,d=n.width,u=n.height,h=n.alwaysShowText,f=this.state,m=f.startX,p=f.endX,g=f.isTextActive,v=f.isSlideMoving,y=f.isTravellerMoving,j=f.isTravellerFocused;if(!a||!a.length||!ks(l)||!ks(c)||!ks(d)||!ks(u)||d<=0||u<=0)return null;var b=Jr("recharts-brush",i),w=xe.Children.count(o)===1,N=eke("userSelect","none");return xe.createElement(mn,{className:b,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:N},this.renderBackground(),w&&this.renderPanorama(),this.renderSlide(m,p),this.renderTravellerLayer(m,"startX"),this.renderTravellerLayer(p,"endX"),(g||v||y||j||h)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(n){var a=n.x,i=n.y,o=n.width,l=n.height,c=n.stroke,d=Math.floor(i+l/2)-1;return xe.createElement(xe.Fragment,null,xe.createElement("rect",{x:a,y:i,width:o,height:l,fill:c,stroke:"none"}),xe.createElement("line",{x1:a+1,y1:d,x2:a+o-1,y2:d,fill:"none",stroke:"#fff"}),xe.createElement("line",{x1:a+1,y1:d+2,x2:a+o-1,y2:d+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(n,a){var i;return xe.isValidElement(n)?i=xe.cloneElement(n,a):Lr(n)?i=n(a):i=t.renderDefaultTraveller(a),i}},{key:"getDerivedStateFromProps",value:function(n,a){var i=n.data,o=n.width,l=n.x,c=n.travellerWidth,d=n.updateId,u=n.startIndex,h=n.endIndex;if(i!==a.prevData||d!==a.prevUpdateId)return PS({prevData:i,prevTravellerWidth:c,prevUpdateId:d,prevX:l,prevWidth:o},i&&i.length?lke({data:i,width:o,x:l,travellerWidth:c,startIndex:u,endIndex:h}):{scale:null,scaleValues:null});if(a.scale&&(o!==a.prevWidth||l!==a.prevX||c!==a.prevTravellerWidth)){a.scale.range([l,l+o-c]);var f=a.scale.domain().map(function(m){return a.scale(m)});return{prevData:i,prevTravellerWidth:c,prevUpdateId:d,prevX:l,prevWidth:o,startX:a.scale(n.startIndex),endX:a.scale(n.endIndex),scaleValues:f}}return null}},{key:"getIndexInRange",value:function(n,a){for(var i=n.length,o=0,l=i-1;l-o>1;){var c=Math.floor((o+l)/2);n[c]>a?l=c:o=c}return a>=n[l]?l:o}}])}(x.PureComponent);jc(Qp,"displayName","Brush");jc(Qp,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var cke=X3;function dke(s,t){var r;return cke(s,function(n,a,i){return r=t(n,a,i),!r}),!!r}var uke=dke,hke=RB,mke=bu,fke=uke,xke=cc,pke=HN;function gke(s,t,r){var n=xke(s)?hke:fke;return r&&pke(s,t,r)&&(t=void 0),n(s,mke(t))}var vke=gke;const yke=Ca(vke);var hu=function(t,r){var n=t.alwaysShow,a=t.ifOverflow;return n&&(a="extendDomain"),a===r},j8=rU;function jke(s,t,r){t=="__proto__"&&j8?j8(s,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):s[t]=r}var bke=jke,Nke=bke,wke=tU,Ske=bu;function Cke(s,t){var r={};return t=Ske(t),wke(s,function(n,a,i){Nke(r,a,t(n,a,i))}),r}var Ake=Cke;const Eke=Ca(Ake);function Ike(s,t){for(var r=-1,n=s==null?0:s.length;++r<n;)if(!t(s[r],r,s))return!1;return!0}var Pke=Ike,_ke=X3;function kke(s,t){var r=!0;return _ke(s,function(n,a,i){return r=!!t(n,a,i),r}),r}var Tke=kke,Dke=Pke,Oke=Tke,Rke=bu,Fke=cc,Mke=HN;function Lke(s,t,r){var n=Fke(s)?Dke:Oke;return r&&Mke(s,t,r)&&(t=void 0),n(s,Rke(t))}var $ke=Lke;const Gz=Ca($ke);var Bke=["x","y"];function zv(s){"@babel/helpers - typeof";return zv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zv(s)}function DA(){return DA=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},DA.apply(this,arguments)}function b8(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function g0(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b8(Object(r),!0).forEach(function(n){Uke(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):b8(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function Uke(s,t,r){return t=zke(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function zke(s){var t=qke(s,"string");return zv(t)=="symbol"?t:t+""}function qke(s,t){if(zv(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(zv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function Vke(s,t){if(s==null)return{};var r=Wke(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function Wke(s,t){if(s==null)return{};var r={};for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n)){if(t.indexOf(n)>=0)continue;r[n]=s[n]}return r}function Hke(s,t){var r=s.x,n=s.y,a=Vke(s,Bke),i="".concat(r),o=parseInt(i,10),l="".concat(n),c=parseInt(l,10),d="".concat(t.height||a.height),u=parseInt(d,10),h="".concat(t.width||a.width),f=parseInt(h,10);return g0(g0(g0(g0(g0({},t),a),o?{x:o}:{}),c?{y:c}:{}),{},{height:u,width:f,name:t.name,radius:t.radius})}function N8(s){return xe.createElement(gb,DA({shapeType:"rectangle",propTransformer:Hke,activeClassName:"recharts-active-bar"},s))}var Gke=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(n,a){if(typeof t=="number")return t;var i=ks(n)||vge(n);return i?t(n,a):(i||lx(),r)}},Kke=["value","background"],Kz;function Zp(s){"@babel/helpers - typeof";return Zp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zp(s)}function Yke(s,t){if(s==null)return{};var r=Jke(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function Jke(s,t){if(s==null)return{};var r={};for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n)){if(t.indexOf(n)>=0)continue;r[n]=s[n]}return r}function Nb(){return Nb=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},Nb.apply(this,arguments)}function w8(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function Zi(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?w8(Object(r),!0).forEach(function(n){vm(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):w8(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function Xke(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function S8(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,Jz(n.key),n)}}function Qke(s,t,r){return t&&S8(s.prototype,t),r&&S8(s,r),Object.defineProperty(s,"prototype",{writable:!1}),s}function Zke(s,t,r){return t=wb(t),eTe(s,Yz()?Reflect.construct(t,r||[],wb(s).constructor):t.apply(s,r))}function eTe(s,t){if(t&&(Zp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tTe(s)}function tTe(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function Yz(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Yz=function(){return!!s})()}function wb(s){return wb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},wb(s)}function sTe(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&OA(s,t)}function OA(s,t){return OA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},OA(s,t)}function vm(s,t,r){return t=Jz(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function Jz(s){var t=rTe(s,"string");return Zp(t)=="symbol"?t:t+""}function rTe(s,t){if(Zp(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Zp(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}var sd=function(s){function t(){var r;Xke(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=Zke(this,t,[].concat(a)),vm(r,"state",{isAnimationFinished:!1}),vm(r,"id",Hm("recharts-bar-")),vm(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),o&&o()}),vm(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),o&&o()}),r}return sTe(t,s),Qke(t,[{key:"renderRectanglesStatically",value:function(n){var a=this,i=this.props,o=i.shape,l=i.dataKey,c=i.activeIndex,d=i.activeBar,u=xr(this.props,!1);return n&&n.map(function(h,f){var m=f===c,p=m?d:o,g=Zi(Zi(Zi({},u),h),{},{isActive:m,option:p,index:f,dataKey:l,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return xe.createElement(mn,Nb({className:"recharts-bar-rectangle"},Mm(a.props,h,f),{key:"rectangle-".concat(h==null?void 0:h.x,"-").concat(h==null?void 0:h.y,"-").concat(h==null?void 0:h.value,"-").concat(f)}),xe.createElement(N8,g))})}},{key:"renderRectanglesWithAnimation",value:function(){var n=this,a=this.props,i=a.data,o=a.layout,l=a.isAnimationActive,c=a.animationBegin,d=a.animationDuration,u=a.animationEasing,h=a.animationId,f=this.state.prevData;return xe.createElement(ad,{begin:c,duration:d,isActive:l,easing:u,from:{t:0},to:{t:1},key:"bar-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(m){var p=m.t,g=i.map(function(v,y){var j=f&&f[y];if(j){var b=Ni(j.x,v.x),w=Ni(j.y,v.y),N=Ni(j.width,v.width),C=Ni(j.height,v.height);return Zi(Zi({},v),{},{x:b(p),y:w(p),width:N(p),height:C(p)})}if(o==="horizontal"){var S=Ni(0,v.height),_=S(p);return Zi(Zi({},v),{},{y:v.y+v.height-_,height:_})}var k=Ni(0,v.width),F=k(p);return Zi(Zi({},v),{},{width:F})});return xe.createElement(mn,null,n.renderRectanglesStatically(g))})}},{key:"renderRectangles",value:function(){var n=this.props,a=n.data,i=n.isAnimationActive,o=this.state.prevData;return i&&a&&a.length&&(!o||!Lm(o,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var n=this,a=this.props,i=a.data,o=a.dataKey,l=a.activeIndex,c=xr(this.props.background,!1);return i.map(function(d,u){d.value;var h=d.background,f=Yke(d,Kke);if(!h)return null;var m=Zi(Zi(Zi(Zi(Zi({},f),{},{fill:"#eee"},h),c),Mm(n.props,d,u)),{},{onAnimationStart:n.handleAnimationStart,onAnimationEnd:n.handleAnimationEnd,dataKey:o,index:u,className:"recharts-bar-background-rectangle"});return xe.createElement(N8,Nb({key:"background-bar-".concat(u),option:n.props.background,isActive:u===l},m))})}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.data,l=i.xAxis,c=i.yAxis,d=i.layout,u=i.children,h=Ml(u,Lg);if(!h)return null;var f=d==="vertical"?o[0].height/2:o[0].width/2,m=function(v,y){var j=Array.isArray(v.value)?v.value[1]:v.value;return{x:v.x,y:v.y,value:j,errorVal:ui(v,y)}},p={clipPath:n?"url(#clipPath-".concat(a,")"):null};return xe.createElement(mn,p,h.map(function(g){return xe.cloneElement(g,{key:"error-bar-".concat(a,"-").concat(g.props.dataKey),data:o,xAxis:l,yAxis:c,layout:d,offset:f,dataPointFormatter:m})}))}},{key:"render",value:function(){var n=this.props,a=n.hide,i=n.data,o=n.className,l=n.xAxis,c=n.yAxis,d=n.left,u=n.top,h=n.width,f=n.height,m=n.isAnimationActive,p=n.background,g=n.id;if(a||!i||!i.length)return null;var v=this.state.isAnimationFinished,y=Jr("recharts-bar",o),j=l&&l.allowDataOverflow,b=c&&c.allowDataOverflow,w=j||b,N=Fr(g)?this.id:g;return xe.createElement(mn,{className:y},j||b?xe.createElement("defs",null,xe.createElement("clipPath",{id:"clipPath-".concat(N)},xe.createElement("rect",{x:j?d:d-h/2,y:b?u:u-f/2,width:j?h:h*2,height:b?f:f*2}))):null,xe.createElement(mn,{className:"recharts-bar-rectangles",clipPath:w?"url(#clipPath-".concat(N,")"):null},p?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(w,N),(!m||v)&&Td.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curData:n.data,prevData:a.curData}:n.data!==a.curData?{curData:n.data}:null}}])}(x.PureComponent);Kz=sd;vm(sd,"displayName","Bar");vm(sd,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!yh.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});vm(sd,"getComposedData",function(s){var t=s.props,r=s.item,n=s.barPosition,a=s.bandSize,i=s.xAxis,o=s.yAxis,l=s.xAxisTicks,c=s.yAxisTicks,d=s.stackedData,u=s.dataStartIndex,h=s.displayedData,f=s.offset,m=M3e(n,r);if(!m)return null;var p=t.layout,g=r.type.defaultProps,v=g!==void 0?Zi(Zi({},g),r.props):r.props,y=v.dataKey,j=v.children,b=v.minPointSize,w=p==="horizontal"?o:i,N=d?w.scale.domain():null,C=V3e({numericAxis:w}),S=Ml(j,xy),_=h.map(function(k,F){var A,T,V,M,G,L;d?A=L3e(d[u+F],N):(A=ui(k,y),Array.isArray(A)||(A=[C,A]));var J=Gke(b,Kz.defaultProps.minPointSize)(A[1],F);if(p==="horizontal"){var z,U=[o.scale(A[0]),o.scale(A[1])],oe=U[0],Q=U[1];T=mO({axis:i,ticks:l,bandSize:a,offset:m.offset,entry:k,index:F}),V=(z=Q??oe)!==null&&z!==void 0?z:void 0,M=m.size;var P=oe-Q;if(G=Number.isNaN(P)?0:P,L={x:T,y:o.y,width:M,height:o.height},Math.abs(J)>0&&Math.abs(G)<Math.abs(J)){var q=kl(G||J)*(Math.abs(J)-Math.abs(G));V-=q,G+=q}}else{var D=[i.scale(A[0]),i.scale(A[1])],se=D[0],he=D[1];if(T=se,V=mO({axis:o,ticks:c,bandSize:a,offset:m.offset,entry:k,index:F}),M=he-se,G=m.size,L={x:i.x,y:V,width:i.width,height:G},Math.abs(J)>0&&Math.abs(M)<Math.abs(J)){var be=kl(M||J)*(Math.abs(J)-Math.abs(M));M+=be}}return Zi(Zi(Zi({},k),{},{x:T,y:V,width:M,height:G,value:d?A:A[1],payload:k,background:L},S&&S[F]&&S[F].props),{},{tooltipPayload:[yz(r,k)],tooltipPosition:{x:T+M/2,y:V+G/2}})});return Zi({data:_,layout:p},f)});function qv(s){"@babel/helpers - typeof";return qv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qv(s)}function nTe(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function C8(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,Xz(n.key),n)}}function aTe(s,t,r){return t&&C8(s.prototype,t),r&&C8(s,r),Object.defineProperty(s,"prototype",{writable:!1}),s}function A8(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function bd(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?A8(Object(r),!0).forEach(function(n){cw(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):A8(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function cw(s,t,r){return t=Xz(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function Xz(s){var t=iTe(s,"string");return qv(t)=="symbol"?t:t+""}function iTe(s,t){if(qv(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(qv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}var dw=function(t,r,n,a,i){var o=t.width,l=t.height,c=t.layout,d=t.children,u=Object.keys(r),h={left:n.left,leftMirror:n.left,right:o-n.right,rightMirror:o-n.right,top:n.top,topMirror:n.top,bottom:l-n.bottom,bottomMirror:l-n.bottom},f=!!bc(d,sd);return u.reduce(function(m,p){var g=r[p],v=g.orientation,y=g.domain,j=g.padding,b=j===void 0?{}:j,w=g.mirror,N=g.reversed,C="".concat(v).concat(w?"Mirror":""),S,_,k,F,A;if(g.type==="number"&&(g.padding==="gap"||g.padding==="no-gap")){var T=y[1]-y[0],V=1/0,M=g.categoricalDomain.sort(Nge);if(M.forEach(function(D,se){se>0&&(V=Math.min((D||0)-(M[se-1]||0),V))}),Number.isFinite(V)){var G=V/T,L=g.layout==="vertical"?n.height:n.width;if(g.padding==="gap"&&(S=G*L/2),g.padding==="no-gap"){var J=Tl(t.barCategoryGap,G*L),z=G*L/2;S=z-J-(z-J)/L*J}}}a==="xAxis"?_=[n.left+(b.left||0)+(S||0),n.left+n.width-(b.right||0)-(S||0)]:a==="yAxis"?_=c==="horizontal"?[n.top+n.height-(b.bottom||0),n.top+(b.top||0)]:[n.top+(b.top||0)+(S||0),n.top+n.height-(b.bottom||0)-(S||0)]:_=g.range,N&&(_=[_[1],_[0]]);var U=xz(g,i,f),oe=U.scale,Q=U.realScaleType;oe.domain(y).range(_),pz(oe);var P=gz(oe,bd(bd({},g),{},{realScaleType:Q}));a==="xAxis"?(A=v==="top"&&!w||v==="bottom"&&w,k=n.left,F=h[C]-A*g.height):a==="yAxis"&&(A=v==="left"&&!w||v==="right"&&w,k=h[C]-A*g.width,F=n.top);var q=bd(bd(bd({},g),P),{},{realScaleType:Q,x:k,y:F,scale:oe,width:a==="xAxis"?n.width:g.width,height:a==="yAxis"?n.height:g.height});return q.bandSize=ib(q,P),!g.hide&&a==="xAxis"?h[C]+=(A?-1:1)*q.height:g.hide||(h[C]+=(A?-1:1)*q.width),bd(bd({},m),{},cw({},p,q))},{})},Qz=function(t,r){var n=t.x,a=t.y,i=r.x,o=r.y;return{x:Math.min(n,i),y:Math.min(a,o),width:Math.abs(i-n),height:Math.abs(o-a)}},oTe=function(t){var r=t.x1,n=t.y1,a=t.x2,i=t.y2;return Qz({x:r,y:n},{x:a,y:i})},Zz=function(){function s(t){nTe(this,s),this.scale=t}return aTe(s,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.bandAware,i=n.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+o}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(r)+l}default:return this.scale(r)}if(a){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+c}return this.scale(r)}}},{key:"isInRange",value:function(r){var n=this.range(),a=n[0],i=n[n.length-1];return a<=i?r>=a&&r<=i:r>=i&&r<=a}}],[{key:"create",value:function(r){return new s(r)}}])}();cw(Zz,"EPS",1e-4);var AE=function(t){var r=Object.keys(t).reduce(function(n,a){return bd(bd({},n),{},cw({},a,Zz.create(t[a])))},{});return bd(bd({},r),{},{apply:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.bandAware,l=i.position;return Eke(a,function(c,d){return r[d].apply(c,{bandAware:o,position:l})})},isInRange:function(a){return Gz(a,function(i,o){return r[o].isInRange(i)})}})};function lTe(s){return(s%180+180)%180}var cTe=function(t){var r=t.width,n=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=lTe(a),o=i*Math.PI/180,l=Math.atan(n/r),c=o>l&&o<Math.PI-l?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},dTe=bu,uTe=fy,hTe=VN;function mTe(s){return function(t,r,n){var a=Object(t);if(!uTe(t)){var i=dTe(r);t=hTe(t),r=function(l){return i(a[l],l,a)}}var o=s(t,r,n);return o>-1?a[i?t[o]:o]:void 0}}var fTe=mTe,xTe=qz;function pTe(s){var t=xTe(s),r=t%1;return t===t?r?t-r:t:0}var gTe=pTe,vTe=YB,yTe=bu,jTe=gTe,bTe=Math.max;function NTe(s,t,r){var n=s==null?0:s.length;if(!n)return-1;var a=r==null?0:jTe(r);return a<0&&(a=bTe(n+a,0)),vTe(s,yTe(t),a)}var wTe=NTe,STe=fTe,CTe=wTe,ATe=STe(CTe),ETe=ATe;const ITe=Ca(ETe);var PTe=Spe(function(s){return{x:s.left,y:s.top,width:s.width,height:s.height}},function(s){return["l",s.left,"t",s.top,"w",s.width,"h",s.height].join("")}),EE=x.createContext(void 0),IE=x.createContext(void 0),eq=x.createContext(void 0),tq=x.createContext({}),sq=x.createContext(void 0),rq=x.createContext(0),nq=x.createContext(0),E8=function(t){var r=t.state,n=r.xAxisMap,a=r.yAxisMap,i=r.offset,o=t.clipPathId,l=t.children,c=t.width,d=t.height,u=PTe(i);return xe.createElement(EE.Provider,{value:n},xe.createElement(IE.Provider,{value:a},xe.createElement(tq.Provider,{value:i},xe.createElement(eq.Provider,{value:u},xe.createElement(sq.Provider,{value:o},xe.createElement(rq.Provider,{value:d},xe.createElement(nq.Provider,{value:c},l)))))))},_Te=function(){return x.useContext(sq)},aq=function(t){var r=x.useContext(EE);r==null&&lx();var n=r[t];return n==null&&lx(),n},kTe=function(){var t=x.useContext(EE);return Zh(t)},TTe=function(){var t=x.useContext(IE),r=ITe(t,function(n){return Gz(n.domain,Number.isFinite)});return r||Zh(t)},iq=function(t){var r=x.useContext(IE);r==null&&lx();var n=r[t];return n==null&&lx(),n},DTe=function(){var t=x.useContext(eq);return t},OTe=function(){return x.useContext(tq)},PE=function(){return x.useContext(nq)},_E=function(){return x.useContext(rq)};function eg(s){"@babel/helpers - typeof";return eg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eg(s)}function RTe(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function FTe(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,lq(n.key),n)}}function MTe(s,t,r){return t&&FTe(s.prototype,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function LTe(s,t,r){return t=Sb(t),$Te(s,oq()?Reflect.construct(t,r||[],Sb(s).constructor):t.apply(s,r))}function $Te(s,t){if(t&&(eg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BTe(s)}function BTe(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function oq(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oq=function(){return!!s})()}function Sb(s){return Sb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Sb(s)}function UTe(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&RA(s,t)}function RA(s,t){return RA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},RA(s,t)}function I8(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function P8(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?I8(Object(r),!0).forEach(function(n){kE(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):I8(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function kE(s,t,r){return t=lq(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function lq(s){var t=zTe(s,"string");return eg(t)=="symbol"?t:t+""}function zTe(s,t){if(eg(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(eg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}function qTe(s,t){return GTe(s)||HTe(s,t)||WTe(s,t)||VTe()}function VTe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WTe(s,t){if(s){if(typeof s=="string")return _8(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _8(s,t)}}function _8(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=s[r];return n}function HTe(s,t){var r=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(s)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function GTe(s){if(Array.isArray(s))return s}function FA(){return FA=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},FA.apply(this,arguments)}var KTe=function(t,r){var n;return xe.isValidElement(t)?n=xe.cloneElement(t,r):Lr(t)?n=t(r):n=xe.createElement("line",FA({},r,{className:"recharts-reference-line-line"})),n},YTe=function(t,r,n,a,i,o,l,c,d){var u=i.x,h=i.y,f=i.width,m=i.height;if(n){var p=d.y,g=t.y.apply(p,{position:o});if(hu(d,"discard")&&!t.y.isInRange(g))return null;var v=[{x:u+f,y:g},{x:u,y:g}];return c==="left"?v.reverse():v}if(r){var y=d.x,j=t.x.apply(y,{position:o});if(hu(d,"discard")&&!t.x.isInRange(j))return null;var b=[{x:j,y:h+m},{x:j,y:h}];return l==="top"?b.reverse():b}if(a){var w=d.segment,N=w.map(function(C){return t.apply(C,{position:o})});return hu(d,"discard")&&yke(N,function(C){return!t.isInRange(C)})?null:N}return null};function JTe(s){var t=s.x,r=s.y,n=s.segment,a=s.xAxisId,i=s.yAxisId,o=s.shape,l=s.className,c=s.alwaysShow,d=_Te(),u=aq(a),h=iq(i),f=DTe();if(!d||!f)return null;kd(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var m=AE({x:u.scale,y:h.scale}),p=Ao(t),g=Ao(r),v=n&&n.length===2,y=YTe(m,p,g,v,f,s.position,u.orientation,h.orientation,s);if(!y)return null;var j=qTe(y,2),b=j[0],w=b.x,N=b.y,C=j[1],S=C.x,_=C.y,k=hu(s,"hidden")?"url(#".concat(d,")"):void 0,F=P8(P8({clipPath:k},xr(s,!0)),{},{x1:w,y1:N,x2:S,y2:_});return xe.createElement(mn,{className:Jr("recharts-reference-line",l)},KTe(o,F),Lo.renderCallByParent(s,oTe({x1:w,y1:N,x2:S,y2:_})))}var uw=function(s){function t(){return RTe(this,t),LTe(this,t,arguments)}return UTe(t,s),MTe(t,[{key:"render",value:function(){return xe.createElement(JTe,this.props)}}])}(xe.Component);kE(uw,"displayName","ReferenceLine");kE(uw,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function MA(){return MA=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},MA.apply(this,arguments)}function tg(s){"@babel/helpers - typeof";return tg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tg(s)}function k8(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function T8(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?k8(Object(r),!0).forEach(function(n){hw(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):k8(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function XTe(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function QTe(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,dq(n.key),n)}}function ZTe(s,t,r){return t&&QTe(s.prototype,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function eDe(s,t,r){return t=Cb(t),tDe(s,cq()?Reflect.construct(t,r||[],Cb(s).constructor):t.apply(s,r))}function tDe(s,t){if(t&&(tg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return sDe(s)}function sDe(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function cq(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cq=function(){return!!s})()}function Cb(s){return Cb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Cb(s)}function rDe(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&LA(s,t)}function LA(s,t){return LA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},LA(s,t)}function hw(s,t,r){return t=dq(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function dq(s){var t=nDe(s,"string");return tg(t)=="symbol"?t:t+""}function nDe(s,t){if(tg(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(tg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}var aDe=function(t){var r=t.x,n=t.y,a=t.xAxis,i=t.yAxis,o=AE({x:a.scale,y:i.scale}),l=o.apply({x:r,y:n},{bandAware:!0});return hu(t,"discard")&&!o.isInRange(l)?null:l},mw=function(s){function t(){return XTe(this,t),eDe(this,t,arguments)}return rDe(t,s),ZTe(t,[{key:"render",value:function(){var n=this.props,a=n.x,i=n.y,o=n.r,l=n.alwaysShow,c=n.clipPathId,d=Ao(a),u=Ao(i);if(kd(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!d||!u)return null;var h=aDe(this.props);if(!h)return null;var f=h.x,m=h.y,p=this.props,g=p.shape,v=p.className,y=hu(this.props,"hidden")?"url(#".concat(c,")"):void 0,j=T8(T8({clipPath:y},xr(this.props,!0)),{},{cx:f,cy:m});return xe.createElement(mn,{className:Jr("recharts-reference-dot",v)},t.renderDot(g,j),Lo.renderCallByParent(this.props,{x:f-o,y:m-o,width:2*o,height:2*o}))}}])}(xe.Component);hw(mw,"displayName","ReferenceDot");hw(mw,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});hw(mw,"renderDot",function(s,t){var r;return xe.isValidElement(s)?r=xe.cloneElement(s,t):Lr(s)?r=s(t):r=xe.createElement(jy,MA({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function $A(){return $A=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},$A.apply(this,arguments)}function sg(s){"@babel/helpers - typeof";return sg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sg(s)}function D8(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function O8(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?D8(Object(r),!0).forEach(function(n){fw(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):D8(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function iDe(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function oDe(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,hq(n.key),n)}}function lDe(s,t,r){return t&&oDe(s.prototype,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function cDe(s,t,r){return t=Ab(t),dDe(s,uq()?Reflect.construct(t,r||[],Ab(s).constructor):t.apply(s,r))}function dDe(s,t){if(t&&(sg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return uDe(s)}function uDe(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function uq(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uq=function(){return!!s})()}function Ab(s){return Ab=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ab(s)}function hDe(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&BA(s,t)}function BA(s,t){return BA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},BA(s,t)}function fw(s,t,r){return t=hq(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function hq(s){var t=mDe(s,"string");return sg(t)=="symbol"?t:t+""}function mDe(s,t){if(sg(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(sg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}var fDe=function(t,r,n,a,i){var o=i.x1,l=i.x2,c=i.y1,d=i.y2,u=i.xAxis,h=i.yAxis;if(!u||!h)return null;var f=AE({x:u.scale,y:h.scale}),m={x:t?f.x.apply(o,{position:"start"}):f.x.rangeMin,y:n?f.y.apply(c,{position:"start"}):f.y.rangeMin},p={x:r?f.x.apply(l,{position:"end"}):f.x.rangeMax,y:a?f.y.apply(d,{position:"end"}):f.y.rangeMax};return hu(i,"discard")&&(!f.isInRange(m)||!f.isInRange(p))?null:Qz(m,p)},xw=function(s){function t(){return iDe(this,t),cDe(this,t,arguments)}return hDe(t,s),lDe(t,[{key:"render",value:function(){var n=this.props,a=n.x1,i=n.x2,o=n.y1,l=n.y2,c=n.className,d=n.alwaysShow,u=n.clipPathId;kd(d===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var h=Ao(a),f=Ao(i),m=Ao(o),p=Ao(l),g=this.props.shape;if(!h&&!f&&!m&&!p&&!g)return null;var v=fDe(h,f,m,p,this.props);if(!v&&!g)return null;var y=hu(this.props,"hidden")?"url(#".concat(u,")"):void 0;return xe.createElement(mn,{className:Jr("recharts-reference-area",c)},t.renderRect(g,O8(O8({clipPath:y},xr(this.props,!0)),v)),Lo.renderCallByParent(this.props,v))}}])}(xe.Component);fw(xw,"displayName","ReferenceArea");fw(xw,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});fw(xw,"renderRect",function(s,t){var r;return xe.isValidElement(s)?r=xe.cloneElement(s,t):Lr(s)?r=s(t):r=xe.createElement(CE,$A({},t,{className:"recharts-reference-area-rect"})),r});function mq(s,t,r){if(t<1)return[];if(t===1&&r===void 0)return s;for(var n=[],a=0;a<s.length;a+=t)n.push(s[a]);return n}function xDe(s,t,r){var n={width:s.width+t.width,height:s.height+t.height};return cTe(n,r)}function pDe(s,t,r){var n=r==="width",a=s.x,i=s.y,o=s.width,l=s.height;return t===1?{start:n?a:i,end:n?a+o:i+l}:{start:n?a+o:i+l,end:n?a:i}}function Eb(s,t,r,n,a){if(s*t<s*n||s*t>s*a)return!1;var i=r();return s*(t-s*i/2-n)>=0&&s*(t+s*i/2-a)<=0}function gDe(s,t){return mq(s,t+1)}function vDe(s,t,r,n,a){for(var i=(n||[]).slice(),o=t.start,l=t.end,c=0,d=1,u=o,h=function(){var p=n==null?void 0:n[c];if(p===void 0)return{v:mq(n,d)};var g=c,v,y=function(){return v===void 0&&(v=r(p,g)),v},j=p.coordinate,b=c===0||Eb(s,j,y,u,l);b||(c=0,u=o,d+=1),b&&(u=j+s*(y()/2+a),c+=d)},f;d<=i.length;)if(f=h(),f)return f.v;return[]}function Vv(s){"@babel/helpers - typeof";return Vv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vv(s)}function R8(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function cl(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R8(Object(r),!0).forEach(function(n){yDe(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):R8(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function yDe(s,t,r){return t=jDe(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function jDe(s){var t=bDe(s,"string");return Vv(t)=="symbol"?t:t+""}function bDe(s,t){if(Vv(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Vv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function NDe(s,t,r,n,a){for(var i=(n||[]).slice(),o=i.length,l=t.start,c=t.end,d=function(f){var m=i[f],p,g=function(){return p===void 0&&(p=r(m,f)),p};if(f===o-1){var v=s*(m.coordinate+s*g()/2-c);i[f]=m=cl(cl({},m),{},{tickCoord:v>0?m.coordinate-v*s:m.coordinate})}else i[f]=m=cl(cl({},m),{},{tickCoord:m.coordinate});var y=Eb(s,m.tickCoord,g,l,c);y&&(c=m.tickCoord-s*(g()/2+a),i[f]=cl(cl({},m),{},{isShow:!0}))},u=o-1;u>=0;u--)d(u);return i}function wDe(s,t,r,n,a,i){var o=(n||[]).slice(),l=o.length,c=t.start,d=t.end;if(i){var u=n[l-1],h=r(u,l-1),f=s*(u.coordinate+s*h/2-d);o[l-1]=u=cl(cl({},u),{},{tickCoord:f>0?u.coordinate-f*s:u.coordinate});var m=Eb(s,u.tickCoord,function(){return h},c,d);m&&(d=u.tickCoord-s*(h/2+a),o[l-1]=cl(cl({},u),{},{isShow:!0}))}for(var p=i?l-1:l,g=function(j){var b=o[j],w,N=function(){return w===void 0&&(w=r(b,j)),w};if(j===0){var C=s*(b.coordinate-s*N()/2-c);o[j]=b=cl(cl({},b),{},{tickCoord:C<0?b.coordinate-C*s:b.coordinate})}else o[j]=b=cl(cl({},b),{},{tickCoord:b.coordinate});var S=Eb(s,b.tickCoord,N,c,d);S&&(c=b.tickCoord+s*(N()/2+a),o[j]=cl(cl({},b),{},{isShow:!0}))},v=0;v<p;v++)g(v);return o}function TE(s,t,r){var n=s.tick,a=s.ticks,i=s.viewBox,o=s.minTickGap,l=s.orientation,c=s.interval,d=s.tickFormatter,u=s.unit,h=s.angle;if(!a||!a.length||!n)return[];if(ks(c)||yh.isSsr)return gDe(a,typeof c=="number"&&ks(c)?c:0);var f=[],m=l==="top"||l==="bottom"?"width":"height",p=u&&m==="width"?V0(u,{fontSize:t,letterSpacing:r}):{width:0,height:0},g=function(b,w){var N=Lr(d)?d(b.value,w):b.value;return m==="width"?xDe(V0(N,{fontSize:t,letterSpacing:r}),p,h):V0(N,{fontSize:t,letterSpacing:r})[m]},v=a.length>=2?kl(a[1].coordinate-a[0].coordinate):1,y=pDe(i,v,m);return c==="equidistantPreserveStart"?vDe(v,y,g,a,o):(c==="preserveStart"||c==="preserveStartEnd"?f=wDe(v,y,g,a,o,c==="preserveStartEnd"):f=NDe(v,y,g,a,o),f.filter(function(j){return j.isShow}))}var SDe=["viewBox"],CDe=["viewBox"],ADe=["ticks"];function rg(s){"@babel/helpers - typeof";return rg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rg(s)}function Xx(){return Xx=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},Xx.apply(this,arguments)}function F8(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function uo(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?F8(Object(r),!0).forEach(function(n){DE(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):F8(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function _S(s,t){if(s==null)return{};var r=EDe(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function EDe(s,t){if(s==null)return{};var r={};for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n)){if(t.indexOf(n)>=0)continue;r[n]=s[n]}return r}function IDe(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function M8(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,xq(n.key),n)}}function PDe(s,t,r){return t&&M8(s.prototype,t),r&&M8(s,r),Object.defineProperty(s,"prototype",{writable:!1}),s}function _De(s,t,r){return t=Ib(t),kDe(s,fq()?Reflect.construct(t,r||[],Ib(s).constructor):t.apply(s,r))}function kDe(s,t){if(t&&(rg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return TDe(s)}function TDe(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function fq(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fq=function(){return!!s})()}function Ib(s){return Ib=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ib(s)}function DDe(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&UA(s,t)}function UA(s,t){return UA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},UA(s,t)}function DE(s,t,r){return t=xq(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function xq(s){var t=ODe(s,"string");return rg(t)=="symbol"?t:t+""}function ODe(s,t){if(rg(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(rg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}var $g=function(s){function t(r){var n;return IDe(this,t),n=_De(this,t,[r]),n.state={fontSize:"",letterSpacing:""},n}return DDe(t,s),PDe(t,[{key:"shouldComponentUpdate",value:function(n,a){var i=n.viewBox,o=_S(n,SDe),l=this.props,c=l.viewBox,d=_S(l,CDe);return!sp(i,c)||!sp(o,d)||!sp(a,this.state)}},{key:"componentDidMount",value:function(){var n=this.layerReference;if(n){var a=n.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(n){var a=this.props,i=a.x,o=a.y,l=a.width,c=a.height,d=a.orientation,u=a.tickSize,h=a.mirror,f=a.tickMargin,m,p,g,v,y,j,b=h?-1:1,w=n.tickSize||u,N=ks(n.tickCoord)?n.tickCoord:n.coordinate;switch(d){case"top":m=p=n.coordinate,v=o+ +!h*c,g=v-b*w,j=g-b*f,y=N;break;case"left":g=v=n.coordinate,p=i+ +!h*l,m=p-b*w,y=m-b*f,j=N;break;case"right":g=v=n.coordinate,p=i+ +h*l,m=p+b*w,y=m+b*f,j=N;break;default:m=p=n.coordinate,v=o+ +h*c,g=v+b*w,j=g+b*f,y=N;break}return{line:{x1:m,y1:g,x2:p,y2:v},tick:{x:y,y:j}}}},{key:"getTickTextAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,o;switch(a){case"left":o=i?"start":"end";break;case"right":o=i?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var n=this.props,a=n.orientation,i=n.mirror,o="end";switch(a){case"left":case"right":o="middle";break;case"top":o=i?"start":"end";break;default:o=i?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var n=this.props,a=n.x,i=n.y,o=n.width,l=n.height,c=n.orientation,d=n.mirror,u=n.axisLine,h=uo(uo(uo({},xr(this.props,!1)),xr(u,!1)),{},{fill:"none"});if(c==="top"||c==="bottom"){var f=+(c==="top"&&!d||c==="bottom"&&d);h=uo(uo({},h),{},{x1:a,y1:i+f*l,x2:a+o,y2:i+f*l})}else{var m=+(c==="left"&&!d||c==="right"&&d);h=uo(uo({},h),{},{x1:a+m*o,y1:i,x2:a+m*o,y2:i+l})}return xe.createElement("line",Xx({},h,{className:Jr("recharts-cartesian-axis-line",Pc(u,"className"))}))}},{key:"renderTicks",value:function(n,a,i){var o=this,l=this.props,c=l.tickLine,d=l.stroke,u=l.tick,h=l.tickFormatter,f=l.unit,m=TE(uo(uo({},this.props),{},{ticks:n}),a,i),p=this.getTickTextAnchor(),g=this.getTickVerticalAnchor(),v=xr(this.props,!1),y=xr(u,!1),j=uo(uo({},v),{},{fill:"none"},xr(c,!1)),b=m.map(function(w,N){var C=o.getTickLineCoord(w),S=C.line,_=C.tick,k=uo(uo(uo(uo({textAnchor:p,verticalAnchor:g},v),{},{stroke:"none",fill:d},y),_),{},{index:N,payload:w,visibleTicksCount:m.length,tickFormatter:h});return xe.createElement(mn,Xx({className:"recharts-cartesian-axis-tick",key:"tick-".concat(w.value,"-").concat(w.coordinate,"-").concat(w.tickCoord)},Mm(o.props,w,N)),c&&xe.createElement("line",Xx({},j,S,{className:Jr("recharts-cartesian-axis-tick-line",Pc(c,"className"))})),u&&t.renderTickItem(u,k,"".concat(Lr(h)?h(w.value,N):w.value).concat(f||"")))});return xe.createElement("g",{className:"recharts-cartesian-axis-ticks"},b)}},{key:"render",value:function(){var n=this,a=this.props,i=a.axisLine,o=a.width,l=a.height,c=a.ticksGenerator,d=a.className,u=a.hide;if(u)return null;var h=this.props,f=h.ticks,m=_S(h,ADe),p=f;return Lr(c)&&(p=f&&f.length>0?c(this.props):c(m)),o<=0||l<=0||!p||!p.length?null:xe.createElement(mn,{className:Jr("recharts-cartesian-axis",d),ref:function(v){n.layerReference=v}},i&&this.renderAxisLine(),this.renderTicks(p,this.state.fontSize,this.state.letterSpacing),Lo.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(n,a,i){var o,l=Jr(a.className,"recharts-cartesian-axis-tick-value");return xe.isValidElement(n)?o=xe.cloneElement(n,uo(uo({},a),{},{className:l})):Lr(n)?o=n(uo(uo({},a),{},{className:l})):o=xe.createElement(ix,Xx({},a,{className:"recharts-cartesian-axis-tick-value"}),i),o}}])}(x.Component);DE($g,"displayName","CartesianAxis");DE($g,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var RDe=["x1","y1","x2","y2","key"],FDe=["offset"];function cx(s){"@babel/helpers - typeof";return cx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cx(s)}function L8(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function hl(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?L8(Object(r),!0).forEach(function(n){MDe(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):L8(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function MDe(s,t,r){return t=LDe(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function LDe(s){var t=$De(s,"string");return cx(t)=="symbol"?t:t+""}function $De(s,t){if(cx(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(cx(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function Ef(){return Ef=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},Ef.apply(this,arguments)}function $8(s,t){if(s==null)return{};var r=BDe(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function BDe(s,t){if(s==null)return{};var r={};for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n)){if(t.indexOf(n)>=0)continue;r[n]=s[n]}return r}var UDe=function(t){var r=t.fill;if(!r||r==="none")return null;var n=t.fillOpacity,a=t.x,i=t.y,o=t.width,l=t.height,c=t.ry;return xe.createElement("rect",{x:a,y:i,ry:c,width:o,height:l,stroke:"none",fill:r,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function pq(s,t){var r;if(xe.isValidElement(s))r=xe.cloneElement(s,t);else if(Lr(s))r=s(t);else{var n=t.x1,a=t.y1,i=t.x2,o=t.y2,l=t.key,c=$8(t,RDe),d=xr(c,!1);d.offset;var u=$8(d,FDe);r=xe.createElement("line",Ef({},u,{x1:n,y1:a,x2:i,y2:o,fill:"none",key:l}))}return r}function zDe(s){var t=s.x,r=s.width,n=s.horizontal,a=n===void 0?!0:n,i=s.horizontalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(l,c){var d=hl(hl({},s),{},{x1:t,y1:l,x2:t+r,y2:l,key:"line-".concat(c),index:c});return pq(a,d)});return xe.createElement("g",{className:"recharts-cartesian-grid-horizontal"},o)}function qDe(s){var t=s.y,r=s.height,n=s.vertical,a=n===void 0?!0:n,i=s.verticalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(l,c){var d=hl(hl({},s),{},{x1:l,y1:t,x2:l,y2:t+r,key:"line-".concat(c),index:c});return pq(a,d)});return xe.createElement("g",{className:"recharts-cartesian-grid-vertical"},o)}function VDe(s){var t=s.horizontalFill,r=s.fillOpacity,n=s.x,a=s.y,i=s.width,o=s.height,l=s.horizontalPoints,c=s.horizontal,d=c===void 0?!0:c;if(!d||!t||!t.length)return null;var u=l.map(function(f){return Math.round(f+a-a)}).sort(function(f,m){return f-m});a!==u[0]&&u.unshift(0);var h=u.map(function(f,m){var p=!u[m+1],g=p?a+o-f:u[m+1]-f;if(g<=0)return null;var v=m%t.length;return xe.createElement("rect",{key:"react-".concat(m),y:f,x:n,height:g,width:i,stroke:"none",fill:t[v],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return xe.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},h)}function WDe(s){var t=s.vertical,r=t===void 0?!0:t,n=s.verticalFill,a=s.fillOpacity,i=s.x,o=s.y,l=s.width,c=s.height,d=s.verticalPoints;if(!r||!n||!n.length)return null;var u=d.map(function(f){return Math.round(f+i-i)}).sort(function(f,m){return f-m});i!==u[0]&&u.unshift(0);var h=u.map(function(f,m){var p=!u[m+1],g=p?i+l-f:u[m+1]-f;if(g<=0)return null;var v=m%n.length;return xe.createElement("rect",{key:"react-".concat(m),x:f,y:o,width:g,height:c,stroke:"none",fill:n[v],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return xe.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},h)}var HDe=function(t,r){var n=t.xAxis,a=t.width,i=t.height,o=t.offset;return fz(TE(hl(hl(hl({},$g.defaultProps),n),{},{ticks:Qu(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.left,o.left+o.width,r)},GDe=function(t,r){var n=t.yAxis,a=t.width,i=t.height,o=t.offset;return fz(TE(hl(hl(hl({},$g.defaultProps),n),{},{ticks:Qu(n,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.top,o.top+o.height,r)},Fx={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function Zu(s){var t,r,n,a,i,o,l=PE(),c=_E(),d=OTe(),u=hl(hl({},s),{},{stroke:(t=s.stroke)!==null&&t!==void 0?t:Fx.stroke,fill:(r=s.fill)!==null&&r!==void 0?r:Fx.fill,horizontal:(n=s.horizontal)!==null&&n!==void 0?n:Fx.horizontal,horizontalFill:(a=s.horizontalFill)!==null&&a!==void 0?a:Fx.horizontalFill,vertical:(i=s.vertical)!==null&&i!==void 0?i:Fx.vertical,verticalFill:(o=s.verticalFill)!==null&&o!==void 0?o:Fx.verticalFill,x:ks(s.x)?s.x:d.left,y:ks(s.y)?s.y:d.top,width:ks(s.width)?s.width:d.width,height:ks(s.height)?s.height:d.height}),h=u.x,f=u.y,m=u.width,p=u.height,g=u.syncWithTicks,v=u.horizontalValues,y=u.verticalValues,j=kTe(),b=TTe();if(!ks(m)||m<=0||!ks(p)||p<=0||!ks(h)||h!==+h||!ks(f)||f!==+f)return null;var w=u.verticalCoordinatesGenerator||HDe,N=u.horizontalCoordinatesGenerator||GDe,C=u.horizontalPoints,S=u.verticalPoints;if((!C||!C.length)&&Lr(N)){var _=v&&v.length,k=N({yAxis:b?hl(hl({},b),{},{ticks:_?v:b.ticks}):void 0,width:l,height:c,offset:d},_?!0:g);kd(Array.isArray(k),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(cx(k),"]")),Array.isArray(k)&&(C=k)}if((!S||!S.length)&&Lr(w)){var F=y&&y.length,A=w({xAxis:j?hl(hl({},j),{},{ticks:F?y:j.ticks}):void 0,width:l,height:c,offset:d},F?!0:g);kd(Array.isArray(A),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(cx(A),"]")),Array.isArray(A)&&(S=A)}return xe.createElement("g",{className:"recharts-cartesian-grid"},xe.createElement(UDe,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),xe.createElement(zDe,Ef({},u,{offset:d,horizontalPoints:C,xAxis:j,yAxis:b})),xe.createElement(qDe,Ef({},u,{offset:d,verticalPoints:S,xAxis:j,yAxis:b})),xe.createElement(VDe,Ef({},u,{horizontalPoints:C})),xe.createElement(WDe,Ef({},u,{verticalPoints:S})))}Zu.displayName="CartesianGrid";var KDe=["type","layout","connectNulls","ref"],YDe=["key"];function ng(s){"@babel/helpers - typeof";return ng=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ng(s)}function B8(s,t){if(s==null)return{};var r=JDe(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function JDe(s,t){if(s==null)return{};var r={};for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n)){if(t.indexOf(n)>=0)continue;r[n]=s[n]}return r}function J0(){return J0=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},J0.apply(this,arguments)}function U8(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function yc(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?U8(Object(r),!0).forEach(function(n){Nd(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):U8(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function Mx(s){return eOe(s)||ZDe(s)||QDe(s)||XDe()}function XDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QDe(s,t){if(s){if(typeof s=="string")return zA(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zA(s,t)}}function ZDe(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function eOe(s){if(Array.isArray(s))return zA(s)}function zA(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=s[r];return n}function tOe(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function z8(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,vq(n.key),n)}}function sOe(s,t,r){return t&&z8(s.prototype,t),r&&z8(s,r),Object.defineProperty(s,"prototype",{writable:!1}),s}function rOe(s,t,r){return t=Pb(t),nOe(s,gq()?Reflect.construct(t,r||[],Pb(s).constructor):t.apply(s,r))}function nOe(s,t){if(t&&(ng(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return aOe(s)}function aOe(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function gq(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gq=function(){return!!s})()}function Pb(s){return Pb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Pb(s)}function iOe(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&qA(s,t)}function qA(s,t){return qA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},qA(s,t)}function Nd(s,t,r){return t=vq(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function vq(s){var t=oOe(s,"string");return ng(t)=="symbol"?t:t+""}function oOe(s,t){if(ng(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(ng(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}var ag=function(s){function t(){var r;tOe(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=rOe(this,t,[].concat(a)),Nd(r,"state",{isAnimationFinished:!0,totalLength:0}),Nd(r,"generateSimpleStrokeDasharray",function(o,l){return"".concat(l,"px ").concat(o-l,"px")}),Nd(r,"getStrokeDasharray",function(o,l,c){var d=c.reduce(function(y,j){return y+j});if(!d)return r.generateSimpleStrokeDasharray(l,o);for(var u=Math.floor(o/d),h=o%d,f=l-o,m=[],p=0,g=0;p<c.length;g+=c[p],++p)if(g+c[p]>h){m=[].concat(Mx(c.slice(0,p)),[h-g]);break}var v=m.length%2===0?[0,f]:[f];return[].concat(Mx(t.repeat(c,u)),Mx(m),v).map(function(y){return"".concat(y,"px")}).join(", ")}),Nd(r,"id",Hm("recharts-line-")),Nd(r,"pathRef",function(o){r.mainCurve=o}),Nd(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0}),r.props.onAnimationEnd&&r.props.onAnimationEnd()}),Nd(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1}),r.props.onAnimationStart&&r.props.onAnimationStart()}),r}return iOe(t,s),sOe(t,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();this.setState({totalLength:n})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var n=this.getTotalLength();n!==this.state.totalLength&&this.setState({totalLength:n})}}},{key:"getTotalLength",value:function(){var n=this.mainCurve;try{return n&&n.getTotalLength&&n.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(n,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.points,l=i.xAxis,c=i.yAxis,d=i.layout,u=i.children,h=Ml(u,Lg);if(!h)return null;var f=function(g,v){return{x:g.x,y:g.y,value:g.value,errorVal:ui(g.payload,v)}},m={clipPath:n?"url(#clipPath-".concat(a,")"):null};return xe.createElement(mn,m,h.map(function(p){return xe.cloneElement(p,{key:"bar-".concat(p.props.dataKey),data:o,xAxis:l,yAxis:c,layout:d,dataPointFormatter:f})}))}},{key:"renderDots",value:function(n,a,i){var o=this.props.isAnimationActive;if(o&&!this.state.isAnimationFinished)return null;var l=this.props,c=l.dot,d=l.points,u=l.dataKey,h=xr(this.props,!1),f=xr(c,!0),m=d.map(function(g,v){var y=yc(yc(yc({key:"dot-".concat(v),r:3},h),f),{},{index:v,cx:g.x,cy:g.y,value:g.value,dataKey:u,payload:g.payload,points:d});return t.renderDotItem(c,y)}),p={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return xe.createElement(mn,J0({className:"recharts-line-dots",key:"dots"},p),m)}},{key:"renderCurveStatically",value:function(n,a,i,o){var l=this.props,c=l.type,d=l.layout,u=l.connectNulls;l.ref;var h=B8(l,KDe),f=yc(yc(yc({},xr(h,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:a?"url(#clipPath-".concat(i,")"):null,points:n},o),{},{type:c,layout:d,connectNulls:u});return xe.createElement(km,J0({},f,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(n,a){var i=this,o=this.props,l=o.points,c=o.strokeDasharray,d=o.isAnimationActive,u=o.animationBegin,h=o.animationDuration,f=o.animationEasing,m=o.animationId,p=o.animateNewValues,g=o.width,v=o.height,y=this.state,j=y.prevPoints,b=y.totalLength;return xe.createElement(ad,{begin:u,duration:h,isActive:d,easing:f,from:{t:0},to:{t:1},key:"line-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(w){var N=w.t;if(j){var C=j.length/l.length,S=l.map(function(T,V){var M=Math.floor(V*C);if(j[M]){var G=j[M],L=Ni(G.x,T.x),J=Ni(G.y,T.y);return yc(yc({},T),{},{x:L(N),y:J(N)})}if(p){var z=Ni(g*2,T.x),U=Ni(v/2,T.y);return yc(yc({},T),{},{x:z(N),y:U(N)})}return yc(yc({},T),{},{x:T.x,y:T.y})});return i.renderCurveStatically(S,n,a)}var _=Ni(0,b),k=_(N),F;if(c){var A="".concat(c).split(/[,\s]+/gim).map(function(T){return parseFloat(T)});F=i.getStrokeDasharray(k,b,A)}else F=i.generateSimpleStrokeDasharray(b,k);return i.renderCurveStatically(l,n,a,{strokeDasharray:F})})}},{key:"renderCurve",value:function(n,a){var i=this.props,o=i.points,l=i.isAnimationActive,c=this.state,d=c.prevPoints,u=c.totalLength;return l&&o&&o.length&&(!d&&u>0||!Lm(d,o))?this.renderCurveWithAnimation(n,a):this.renderCurveStatically(o,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,o=a.dot,l=a.points,c=a.className,d=a.xAxis,u=a.yAxis,h=a.top,f=a.left,m=a.width,p=a.height,g=a.isAnimationActive,v=a.id;if(i||!l||!l.length)return null;var y=this.state.isAnimationFinished,j=l.length===1,b=Jr("recharts-line",c),w=d&&d.allowDataOverflow,N=u&&u.allowDataOverflow,C=w||N,S=Fr(v)?this.id:v,_=(n=xr(o,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},k=_.r,F=k===void 0?3:k,A=_.strokeWidth,T=A===void 0?2:A,V=iB(o)?o:{},M=V.clipDot,G=M===void 0?!0:M,L=F*2+T;return xe.createElement(mn,{className:b},w||N?xe.createElement("defs",null,xe.createElement("clipPath",{id:"clipPath-".concat(S)},xe.createElement("rect",{x:w?f:f-m/2,y:N?h:h-p/2,width:w?m:m*2,height:N?p:p*2})),!G&&xe.createElement("clipPath",{id:"clipPath-dots-".concat(S)},xe.createElement("rect",{x:f-L/2,y:h-L/2,width:m+L,height:p+L}))):null,!j&&this.renderCurve(C,S),this.renderErrorBar(C,S),(j||o)&&this.renderDots(C,G,S),(!g||y)&&Td.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}},{key:"repeat",value:function(n,a){for(var i=n.length%2!==0?[].concat(Mx(n),[0]):n,o=[],l=0;l<a;++l)o=[].concat(Mx(o),Mx(i));return o}},{key:"renderDotItem",value:function(n,a){var i;if(xe.isValidElement(n))i=xe.cloneElement(n,a);else if(Lr(n))i=n(a);else{var o=a.key,l=B8(a,YDe),c=Jr("recharts-line-dot",typeof n!="boolean"?n.className:"");i=xe.createElement(jy,J0({key:o},l,{className:c}))}return i}}])}(x.PureComponent);Nd(ag,"displayName","Line");Nd(ag,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!yh.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});Nd(ag,"getComposedData",function(s){var t=s.props,r=s.xAxis,n=s.yAxis,a=s.xAxisTicks,i=s.yAxisTicks,o=s.dataKey,l=s.bandSize,c=s.displayedData,d=s.offset,u=t.layout,h=c.map(function(f,m){var p=ui(f,o);return u==="horizontal"?{x:Hp({axis:r,ticks:a,bandSize:l,entry:f,index:m}),y:Fr(p)?null:n.scale(p),value:p,payload:f}:{x:Fr(p)?null:r.scale(p),y:Hp({axis:n,ticks:i,bandSize:l,entry:f,index:m}),value:p,payload:f}});return yc({points:h,layout:u},d)});var lOe=["layout","type","stroke","connectNulls","isRange","ref"],cOe=["key"],yq;function ig(s){"@babel/helpers - typeof";return ig=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ig(s)}function jq(s,t){if(s==null)return{};var r=dOe(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function dOe(s,t){if(s==null)return{};var r={};for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n)){if(t.indexOf(n)>=0)continue;r[n]=s[n]}return r}function If(){return If=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},If.apply(this,arguments)}function q8(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function Wh(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?q8(Object(r),!0).forEach(function(n){lu(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):q8(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function uOe(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function V8(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,Nq(n.key),n)}}function hOe(s,t,r){return t&&V8(s.prototype,t),r&&V8(s,r),Object.defineProperty(s,"prototype",{writable:!1}),s}function mOe(s,t,r){return t=_b(t),fOe(s,bq()?Reflect.construct(t,r||[],_b(s).constructor):t.apply(s,r))}function fOe(s,t){if(t&&(ig(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xOe(s)}function xOe(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function bq(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bq=function(){return!!s})()}function _b(s){return _b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_b(s)}function pOe(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&VA(s,t)}function VA(s,t){return VA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},VA(s,t)}function lu(s,t,r){return t=Nq(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function Nq(s){var t=gOe(s,"string");return ig(t)=="symbol"?t:t+""}function gOe(s,t){if(ig(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(ig(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}var _c=function(s){function t(){var r;uOe(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=mOe(this,t,[].concat(a)),lu(r,"state",{isAnimationFinished:!0}),lu(r,"id",Hm("recharts-area-")),lu(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),Lr(o)&&o()}),lu(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),Lr(o)&&o()}),r}return pOe(t,s),hOe(t,[{key:"renderDots",value:function(n,a,i){var o=this.props.isAnimationActive,l=this.state.isAnimationFinished;if(o&&!l)return null;var c=this.props,d=c.dot,u=c.points,h=c.dataKey,f=xr(this.props,!1),m=xr(d,!0),p=u.map(function(v,y){var j=Wh(Wh(Wh({key:"dot-".concat(y),r:3},f),m),{},{index:y,cx:v.x,cy:v.y,dataKey:h,value:v.value,payload:v.payload,points:u});return t.renderDotItem(d,j)}),g={clipPath:n?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return xe.createElement(mn,If({className:"recharts-area-dots"},g),p)}},{key:"renderHorizontalRect",value:function(n){var a=this.props,i=a.baseLine,o=a.points,l=a.strokeWidth,c=o[0].x,d=o[o.length-1].x,u=n*Math.abs(c-d),h=gm(o.map(function(f){return f.y||0}));return ks(i)&&typeof i=="number"?h=Math.max(i,h):i&&Array.isArray(i)&&i.length&&(h=Math.max(gm(i.map(function(f){return f.y||0})),h)),ks(h)?xe.createElement("rect",{x:c<d?c:c-u,y:0,width:u,height:Math.floor(h+(l?parseInt("".concat(l),10):1))}):null}},{key:"renderVerticalRect",value:function(n){var a=this.props,i=a.baseLine,o=a.points,l=a.strokeWidth,c=o[0].y,d=o[o.length-1].y,u=n*Math.abs(c-d),h=gm(o.map(function(f){return f.x||0}));return ks(i)&&typeof i=="number"?h=Math.max(i,h):i&&Array.isArray(i)&&i.length&&(h=Math.max(gm(i.map(function(f){return f.x||0})),h)),ks(h)?xe.createElement("rect",{x:0,y:c<d?c:c-u,width:h+(l?parseInt("".concat(l),10):1),height:Math.floor(u)}):null}},{key:"renderClipRect",value:function(n){var a=this.props.layout;return a==="vertical"?this.renderVerticalRect(n):this.renderHorizontalRect(n)}},{key:"renderAreaStatically",value:function(n,a,i,o){var l=this.props,c=l.layout,d=l.type,u=l.stroke,h=l.connectNulls,f=l.isRange;l.ref;var m=jq(l,lOe);return xe.createElement(mn,{clipPath:i?"url(#clipPath-".concat(o,")"):null},xe.createElement(km,If({},xr(m,!0),{points:n,connectNulls:h,type:d,baseLine:a,layout:c,stroke:"none",className:"recharts-area-area"})),u!=="none"&&xe.createElement(km,If({},xr(this.props,!1),{className:"recharts-area-curve",layout:c,type:d,connectNulls:h,fill:"none",points:n})),u!=="none"&&f&&xe.createElement(km,If({},xr(this.props,!1),{className:"recharts-area-curve",layout:c,type:d,connectNulls:h,fill:"none",points:a})))}},{key:"renderAreaWithAnimation",value:function(n,a){var i=this,o=this.props,l=o.points,c=o.baseLine,d=o.isAnimationActive,u=o.animationBegin,h=o.animationDuration,f=o.animationEasing,m=o.animationId,p=this.state,g=p.prevPoints,v=p.prevBaseLine;return xe.createElement(ad,{begin:u,duration:h,isActive:d,easing:f,from:{t:0},to:{t:1},key:"area-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(y){var j=y.t;if(g){var b=g.length/l.length,w=l.map(function(_,k){var F=Math.floor(k*b);if(g[F]){var A=g[F],T=Ni(A.x,_.x),V=Ni(A.y,_.y);return Wh(Wh({},_),{},{x:T(j),y:V(j)})}return _}),N;if(ks(c)&&typeof c=="number"){var C=Ni(v,c);N=C(j)}else if(Fr(c)||kg(c)){var S=Ni(v,0);N=S(j)}else N=c.map(function(_,k){var F=Math.floor(k*b);if(v[F]){var A=v[F],T=Ni(A.x,_.x),V=Ni(A.y,_.y);return Wh(Wh({},_),{},{x:T(j),y:V(j)})}return _});return i.renderAreaStatically(w,N,n,a)}return xe.createElement(mn,null,xe.createElement("defs",null,xe.createElement("clipPath",{id:"animationClipPath-".concat(a)},i.renderClipRect(j))),xe.createElement(mn,{clipPath:"url(#animationClipPath-".concat(a,")")},i.renderAreaStatically(l,c,n,a)))})}},{key:"renderArea",value:function(n,a){var i=this.props,o=i.points,l=i.baseLine,c=i.isAnimationActive,d=this.state,u=d.prevPoints,h=d.prevBaseLine,f=d.totalLength;return c&&o&&o.length&&(!u&&f>0||!Lm(u,o)||!Lm(h,l))?this.renderAreaWithAnimation(n,a):this.renderAreaStatically(o,l,n,a)}},{key:"render",value:function(){var n,a=this.props,i=a.hide,o=a.dot,l=a.points,c=a.className,d=a.top,u=a.left,h=a.xAxis,f=a.yAxis,m=a.width,p=a.height,g=a.isAnimationActive,v=a.id;if(i||!l||!l.length)return null;var y=this.state.isAnimationFinished,j=l.length===1,b=Jr("recharts-area",c),w=h&&h.allowDataOverflow,N=f&&f.allowDataOverflow,C=w||N,S=Fr(v)?this.id:v,_=(n=xr(o,!1))!==null&&n!==void 0?n:{r:3,strokeWidth:2},k=_.r,F=k===void 0?3:k,A=_.strokeWidth,T=A===void 0?2:A,V=iB(o)?o:{},M=V.clipDot,G=M===void 0?!0:M,L=F*2+T;return xe.createElement(mn,{className:b},w||N?xe.createElement("defs",null,xe.createElement("clipPath",{id:"clipPath-".concat(S)},xe.createElement("rect",{x:w?u:u-m/2,y:N?d:d-p/2,width:w?m:m*2,height:N?p:p*2})),!G&&xe.createElement("clipPath",{id:"clipPath-dots-".concat(S)},xe.createElement("rect",{x:u-L/2,y:d-L/2,width:m+L,height:p+L}))):null,j?null:this.renderArea(C,S),(o||j)&&this.renderDots(C,G,S),(!g||y)&&Td.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,curBaseLine:n.baseLine,prevPoints:a.curPoints,prevBaseLine:a.curBaseLine}:n.points!==a.curPoints||n.baseLine!==a.curBaseLine?{curPoints:n.points,curBaseLine:n.baseLine}:null}}])}(x.PureComponent);yq=_c;lu(_c,"displayName","Area");lu(_c,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!yh.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});lu(_c,"getBaseValue",function(s,t,r,n){var a=s.layout,i=s.baseValue,o=t.props.baseValue,l=o??i;if(ks(l)&&typeof l=="number")return l;var c=a==="horizontal"?n:r,d=c.scale.domain();if(c.type==="number"){var u=Math.max(d[0],d[1]),h=Math.min(d[0],d[1]);return l==="dataMin"?h:l==="dataMax"||u<0?u:Math.max(Math.min(d[0],d[1]),0)}return l==="dataMin"?d[0]:l==="dataMax"?d[1]:d[0]});lu(_c,"getComposedData",function(s){var t=s.props,r=s.item,n=s.xAxis,a=s.yAxis,i=s.xAxisTicks,o=s.yAxisTicks,l=s.bandSize,c=s.dataKey,d=s.stackedData,u=s.dataStartIndex,h=s.displayedData,f=s.offset,m=t.layout,p=d&&d.length,g=yq.getBaseValue(t,r,n,a),v=m==="horizontal",y=!1,j=h.map(function(w,N){var C;p?C=d[u+N]:(C=ui(w,c),Array.isArray(C)?y=!0:C=[g,C]);var S=C[1]==null||p&&ui(w,c)==null;return v?{x:Hp({axis:n,ticks:i,bandSize:l,entry:w,index:N}),y:S?null:a.scale(C[1]),value:C,payload:w}:{x:S?null:n.scale(C[1]),y:Hp({axis:a,ticks:o,bandSize:l,entry:w,index:N}),value:C,payload:w}}),b;return p||y?b=j.map(function(w){var N=Array.isArray(w.value)?w.value[0]:null;return v?{x:w.x,y:N!=null&&w.y!=null?a.scale(N):null}:{x:N!=null?n.scale(N):null,y:w.y}}):b=v?a.scale(g):n.scale(g),Wh({points:j,baseLine:b,layout:m,isRange:y},f)});lu(_c,"renderDotItem",function(s,t){var r;if(xe.isValidElement(s))r=xe.cloneElement(s,t);else if(Lr(s))r=s(t);else{var n=Jr("recharts-area-dot",typeof s!="boolean"?s.className:""),a=t.key,i=jq(t,cOe);r=xe.createElement(jy,If({},i,{key:a,className:n}))}return r});function og(s){"@babel/helpers - typeof";return og=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},og(s)}function vOe(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function yOe(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,Cq(n.key),n)}}function jOe(s,t,r){return t&&yOe(s.prototype,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function bOe(s,t,r){return t=kb(t),NOe(s,wq()?Reflect.construct(t,r||[],kb(s).constructor):t.apply(s,r))}function NOe(s,t){if(t&&(og(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wOe(s)}function wOe(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function wq(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wq=function(){return!!s})()}function kb(s){return kb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},kb(s)}function SOe(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&WA(s,t)}function WA(s,t){return WA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},WA(s,t)}function Sq(s,t,r){return t=Cq(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function Cq(s){var t=COe(s,"string");return og(t)=="symbol"?t:t+""}function COe(s,t){if(og(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(og(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}var by=function(s){function t(){return vOe(this,t),bOe(this,t,arguments)}return SOe(t,s),jOe(t,[{key:"render",value:function(){return null}}])}(x.Component);Sq(by,"displayName","ZAxis");Sq(by,"defaultProps",{zAxisId:0,range:[64,64],scale:"auto",type:"number"});var AOe=["option","isActive"];function X0(){return X0=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},X0.apply(this,arguments)}function EOe(s,t){if(s==null)return{};var r=IOe(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function IOe(s,t){if(s==null)return{};var r={};for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n)){if(t.indexOf(n)>=0)continue;r[n]=s[n]}return r}function POe(s){var t=s.option,r=s.isActive,n=EOe(s,AOe);return typeof t=="string"?x.createElement(gb,X0({option:x.createElement(qN,X0({type:t},n)),isActive:r,shapeType:"symbols"},n)):x.createElement(gb,X0({option:t,isActive:r,shapeType:"symbols"},n))}function lg(s){"@babel/helpers - typeof";return lg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lg(s)}function Q0(){return Q0=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},Q0.apply(this,arguments)}function W8(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function Vc(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?W8(Object(r),!0).forEach(function(n){ym(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):W8(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function _Oe(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function H8(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,Eq(n.key),n)}}function kOe(s,t,r){return t&&H8(s.prototype,t),r&&H8(s,r),Object.defineProperty(s,"prototype",{writable:!1}),s}function TOe(s,t,r){return t=Tb(t),DOe(s,Aq()?Reflect.construct(t,r||[],Tb(s).constructor):t.apply(s,r))}function DOe(s,t){if(t&&(lg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OOe(s)}function OOe(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function Aq(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Aq=function(){return!!s})()}function Tb(s){return Tb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Tb(s)}function ROe(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&HA(s,t)}function HA(s,t){return HA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},HA(s,t)}function ym(s,t,r){return t=Eq(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function Eq(s){var t=FOe(s,"string");return lg(t)=="symbol"?t:t+""}function FOe(s,t){if(lg(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(lg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}var yx=function(s){function t(){var r;_Oe(this,t);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return r=TOe(this,t,[].concat(a)),ym(r,"state",{isAnimationFinished:!1}),ym(r,"handleAnimationEnd",function(){r.setState({isAnimationFinished:!0})}),ym(r,"handleAnimationStart",function(){r.setState({isAnimationFinished:!1})}),ym(r,"id",Hm("recharts-scatter-")),r}return ROe(t,s),kOe(t,[{key:"renderSymbolsStatically",value:function(n){var a=this,i=this.props,o=i.shape,l=i.activeShape,c=i.activeIndex,d=xr(this.props,!1);return n.map(function(u,h){var f=c===h,m=f?l:o,p=Vc(Vc({},d),u);return xe.createElement(mn,Q0({className:"recharts-scatter-symbol",key:"symbol-".concat(u==null?void 0:u.cx,"-").concat(u==null?void 0:u.cy,"-").concat(u==null?void 0:u.size,"-").concat(h)},Mm(a.props,u,h),{role:"img"}),xe.createElement(POe,Q0({option:m,isActive:f,key:"symbol-".concat(h)},p)))})}},{key:"renderSymbolsWithAnimation",value:function(){var n=this,a=this.props,i=a.points,o=a.isAnimationActive,l=a.animationBegin,c=a.animationDuration,d=a.animationEasing,u=a.animationId,h=this.state.prevPoints;return xe.createElement(ad,{begin:l,duration:c,isActive:o,easing:d,from:{t:0},to:{t:1},key:"pie-".concat(u),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(f){var m=f.t,p=i.map(function(g,v){var y=h&&h[v];if(y){var j=Ni(y.cx,g.cx),b=Ni(y.cy,g.cy),w=Ni(y.size,g.size);return Vc(Vc({},g),{},{cx:j(m),cy:b(m),size:w(m)})}var N=Ni(0,g.size);return Vc(Vc({},g),{},{size:N(m)})});return xe.createElement(mn,null,n.renderSymbolsStatically(p))})}},{key:"renderSymbols",value:function(){var n=this.props,a=n.points,i=n.isAnimationActive,o=this.state.prevPoints;return i&&a&&a.length&&(!o||!Lm(o,a))?this.renderSymbolsWithAnimation():this.renderSymbolsStatically(a)}},{key:"renderErrorBar",value:function(){var n=this.props.isAnimationActive;if(n&&!this.state.isAnimationFinished)return null;var a=this.props,i=a.points,o=a.xAxis,l=a.yAxis,c=a.children,d=Ml(c,Lg);return d?d.map(function(u,h){var f=u.props,m=f.direction,p=f.dataKey;return xe.cloneElement(u,{key:"".concat(m,"-").concat(p,"-").concat(i[h]),data:i,xAxis:o,yAxis:l,layout:m==="x"?"vertical":"horizontal",dataPointFormatter:function(v,y){return{x:v.cx,y:v.cy,value:m==="x"?+v.node.x:+v.node.y,errorVal:ui(v,y)}}})}):null}},{key:"renderLine",value:function(){var n=this.props,a=n.points,i=n.line,o=n.lineType,l=n.lineJointType,c=xr(this.props,!1),d=xr(i,!1),u,h;if(o==="joint")u=a.map(function(b){return{x:b.cx,y:b.cy}});else if(o==="fitting"){var f=bge(a),m=f.xmin,p=f.xmax,g=f.a,v=f.b,y=function(w){return g*w+v};u=[{x:m,y:y(m)},{x:p,y:y(p)}]}var j=Vc(Vc(Vc({},c),{},{fill:"none",stroke:c&&c.fill},d),{},{points:u});return xe.isValidElement(i)?h=xe.cloneElement(i,j):Lr(i)?h=i(j):h=xe.createElement(km,Q0({},j,{type:l})),xe.createElement(mn,{className:"recharts-scatter-line",key:"recharts-scatter-line"},h)}},{key:"render",value:function(){var n=this.props,a=n.hide,i=n.points,o=n.line,l=n.className,c=n.xAxis,d=n.yAxis,u=n.left,h=n.top,f=n.width,m=n.height,p=n.id,g=n.isAnimationActive;if(a||!i||!i.length)return null;var v=this.state.isAnimationFinished,y=Jr("recharts-scatter",l),j=c&&c.allowDataOverflow,b=d&&d.allowDataOverflow,w=j||b,N=Fr(p)?this.id:p;return xe.createElement(mn,{className:y,clipPath:w?"url(#clipPath-".concat(N,")"):null},j||b?xe.createElement("defs",null,xe.createElement("clipPath",{id:"clipPath-".concat(N)},xe.createElement("rect",{x:j?u:u-f/2,y:b?h:h-m/2,width:j?f:f*2,height:b?m:m*2}))):null,o&&this.renderLine(),this.renderErrorBar(),xe.createElement(mn,{key:"recharts-scatter-symbols"},this.renderSymbols()),(!g||v)&&Td.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(n,a){return n.animationId!==a.prevAnimationId?{prevAnimationId:n.animationId,curPoints:n.points,prevPoints:a.curPoints}:n.points!==a.curPoints?{curPoints:n.points}:null}}])}(x.PureComponent);ym(yx,"displayName","Scatter");ym(yx,"defaultProps",{xAxisId:0,yAxisId:0,zAxisId:0,legendType:"circle",lineType:"joint",lineJointType:"linear",data:[],shape:"circle",hide:!1,isAnimationActive:!yh.isSsr,animationBegin:0,animationDuration:400,animationEasing:"linear"});ym(yx,"getComposedData",function(s){var t=s.xAxis,r=s.yAxis,n=s.zAxis,a=s.item,i=s.displayedData,o=s.xAxisTicks,l=s.yAxisTicks,c=s.offset,d=a.props.tooltipType,u=Ml(a.props.children,xy),h=Fr(t.dataKey)?a.props.dataKey:t.dataKey,f=Fr(r.dataKey)?a.props.dataKey:r.dataKey,m=n&&n.dataKey,p=n?n.range:by.defaultProps.range,g=p&&p[0],v=t.scale.bandwidth?t.scale.bandwidth():0,y=r.scale.bandwidth?r.scale.bandwidth():0,j=i.map(function(b,w){var N=ui(b,h),C=ui(b,f),S=!Fr(m)&&ui(b,m)||"-",_=[{name:Fr(t.dataKey)?a.props.name:t.name||t.dataKey,unit:t.unit||"",value:N,payload:b,dataKey:h,type:d},{name:Fr(r.dataKey)?a.props.name:r.name||r.dataKey,unit:r.unit||"",value:C,payload:b,dataKey:f,type:d}];S!=="-"&&_.push({name:n.name||n.dataKey,unit:n.unit||"",value:S,payload:b,dataKey:m,type:d});var k=Hp({axis:t,ticks:o,bandSize:v,entry:b,index:w,dataKey:h}),F=Hp({axis:r,ticks:l,bandSize:y,entry:b,index:w,dataKey:f}),A=S!=="-"?n.scale(S):g,T=Math.sqrt(Math.max(A,0)/Math.PI);return Vc(Vc({},b),{},{cx:k,cy:F,x:k-T,y:F-T,xAxis:t,yAxis:r,zAxis:n,width:2*T,height:2*T,size:A,node:{x:N,y:C,z:S},tooltipPayload:_,tooltipPosition:{x:k,y:F},payload:b},u&&u[w]&&u[w].props)});return Vc({points:j},c)});function cg(s){"@babel/helpers - typeof";return cg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cg(s)}function MOe(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function LOe(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,_q(n.key),n)}}function $Oe(s,t,r){return t&&LOe(s.prototype,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function BOe(s,t,r){return t=Db(t),UOe(s,Iq()?Reflect.construct(t,r||[],Db(s).constructor):t.apply(s,r))}function UOe(s,t){if(t&&(cg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zOe(s)}function zOe(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function Iq(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Iq=function(){return!!s})()}function Db(s){return Db=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Db(s)}function qOe(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&GA(s,t)}function GA(s,t){return GA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},GA(s,t)}function Pq(s,t,r){return t=_q(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function _q(s){var t=VOe(s,"string");return cg(t)=="symbol"?t:t+""}function VOe(s,t){if(cg(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(cg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}function KA(){return KA=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},KA.apply(this,arguments)}function WOe(s){var t=s.xAxisId,r=PE(),n=_E(),a=aq(t);return a==null?null:x.createElement($g,KA({},a,{className:Jr("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:n},ticksGenerator:function(o){return Qu(o,!0)}}))}var rc=function(s){function t(){return MOe(this,t),BOe(this,t,arguments)}return qOe(t,s),$Oe(t,[{key:"render",value:function(){return x.createElement(WOe,this.props)}}])}(x.Component);Pq(rc,"displayName","XAxis");Pq(rc,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function dg(s){"@babel/helpers - typeof";return dg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dg(s)}function HOe(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function GOe(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,Dq(n.key),n)}}function KOe(s,t,r){return t&&GOe(s.prototype,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function YOe(s,t,r){return t=Ob(t),JOe(s,kq()?Reflect.construct(t,r||[],Ob(s).constructor):t.apply(s,r))}function JOe(s,t){if(t&&(dg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return XOe(s)}function XOe(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function kq(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kq=function(){return!!s})()}function Ob(s){return Ob=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ob(s)}function QOe(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&YA(s,t)}function YA(s,t){return YA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},YA(s,t)}function Tq(s,t,r){return t=Dq(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function Dq(s){var t=ZOe(s,"string");return dg(t)=="symbol"?t:t+""}function ZOe(s,t){if(dg(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(dg(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}function JA(){return JA=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},JA.apply(this,arguments)}var e8e=function(t){var r=t.yAxisId,n=PE(),a=_E(),i=iq(r);return i==null?null:x.createElement($g,JA({},i,{className:Jr("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:n,height:a},ticksGenerator:function(l){return Qu(l,!0)}}))},_l=function(s){function t(){return HOe(this,t),YOe(this,t,arguments)}return QOe(t,s),KOe(t,[{key:"render",value:function(){return x.createElement(e8e,this.props)}}])}(x.Component);Tq(_l,"displayName","YAxis");Tq(_l,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function G8(s){return n8e(s)||r8e(s)||s8e(s)||t8e()}function t8e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function s8e(s,t){if(s){if(typeof s=="string")return XA(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XA(s,t)}}function r8e(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function n8e(s){if(Array.isArray(s))return XA(s)}function XA(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=s[r];return n}var QA=function(t,r,n,a,i){var o=Ml(t,uw),l=Ml(t,mw),c=[].concat(G8(o),G8(l)),d=Ml(t,xw),u="".concat(a,"Id"),h=a[0],f=r;if(c.length&&(f=c.reduce(function(g,v){if(v.props[u]===n&&hu(v.props,"extendDomain")&&ks(v.props[h])){var y=v.props[h];return[Math.min(g[0],y),Math.max(g[1],y)]}return g},f)),d.length){var m="".concat(h,"1"),p="".concat(h,"2");f=d.reduce(function(g,v){if(v.props[u]===n&&hu(v.props,"extendDomain")&&ks(v.props[m])&&ks(v.props[p])){var y=v.props[m],j=v.props[p];return[Math.min(g[0],y,j),Math.max(g[1],y,j)]}return g},f)}return i&&i.length&&(f=i.reduce(function(g,v){return ks(v)?[Math.min(g[0],v),Math.max(g[1],v)]:g},f)),f},Oq={exports:{}};(function(s){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,d,u){this.fn=c,this.context=d,this.once=u||!1}function i(c,d,u,h,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new a(u,h||c,f),p=r?r+d:d;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],m]:c._events[p].push(m):(c._events[p]=m,c._eventsCount++),c}function o(c,d){--c._eventsCount===0?c._events=new n:delete c._events[d]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],u,h;if(this._eventsCount===0)return d;for(h in u=this._events)t.call(u,h)&&d.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(u)):d},l.prototype.listeners=function(d){var u=r?r+d:d,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var f=0,m=h.length,p=new Array(m);f<m;f++)p[f]=h[f].fn;return p},l.prototype.listenerCount=function(d){var u=r?r+d:d,h=this._events[u];return h?h.fn?1:h.length:0},l.prototype.emit=function(d,u,h,f,m,p){var g=r?r+d:d;if(!this._events[g])return!1;var v=this._events[g],y=arguments.length,j,b;if(v.fn){switch(v.once&&this.removeListener(d,v.fn,void 0,!0),y){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,u),!0;case 3:return v.fn.call(v.context,u,h),!0;case 4:return v.fn.call(v.context,u,h,f),!0;case 5:return v.fn.call(v.context,u,h,f,m),!0;case 6:return v.fn.call(v.context,u,h,f,m,p),!0}for(b=1,j=new Array(y-1);b<y;b++)j[b-1]=arguments[b];v.fn.apply(v.context,j)}else{var w=v.length,N;for(b=0;b<w;b++)switch(v[b].once&&this.removeListener(d,v[b].fn,void 0,!0),y){case 1:v[b].fn.call(v[b].context);break;case 2:v[b].fn.call(v[b].context,u);break;case 3:v[b].fn.call(v[b].context,u,h);break;case 4:v[b].fn.call(v[b].context,u,h,f);break;default:if(!j)for(N=1,j=new Array(y-1);N<y;N++)j[N-1]=arguments[N];v[b].fn.apply(v[b].context,j)}}return!0},l.prototype.on=function(d,u,h){return i(this,d,u,h,!1)},l.prototype.once=function(d,u,h){return i(this,d,u,h,!0)},l.prototype.removeListener=function(d,u,h,f){var m=r?r+d:d;if(!this._events[m])return this;if(!u)return o(this,m),this;var p=this._events[m];if(p.fn)p.fn===u&&(!f||p.once)&&(!h||p.context===h)&&o(this,m);else{for(var g=0,v=[],y=p.length;g<y;g++)(p[g].fn!==u||f&&!p[g].once||h&&p[g].context!==h)&&v.push(p[g]);v.length?this._events[m]=v.length===1?v[0]:v:o(this,m)}return this},l.prototype.removeAllListeners=function(d){var u;return d?(u=r?r+d:d,this._events[u]&&o(this,u)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,s.exports=l})(Oq);var a8e=Oq.exports;const i8e=Ca(a8e);var kS=new i8e,TS="recharts.syncMouseEvents";function Wv(s){"@babel/helpers - typeof";return Wv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wv(s)}function o8e(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function l8e(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,Rq(n.key),n)}}function c8e(s,t,r){return t&&l8e(s.prototype,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function DS(s,t,r){return t=Rq(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function Rq(s){var t=d8e(s,"string");return Wv(t)=="symbol"?t:t+""}function d8e(s,t){if(Wv(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Wv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(s)}var u8e=function(){function s(){o8e(this,s),DS(this,"activeIndex",0),DS(this,"coordinateList",[]),DS(this,"layout","horizontal")}return c8e(s,[{key:"setDetails",value:function(r){var n,a=r.coordinateList,i=a===void 0?null:a,o=r.container,l=o===void 0?null:o,c=r.layout,d=c===void 0?null:c,u=r.offset,h=u===void 0?null:u,f=r.mouseHandlerCallback,m=f===void 0?null:f;this.coordinateList=(n=i??this.coordinateList)!==null&&n!==void 0?n:[],this.container=l??this.container,this.layout=d??this.layout,this.offset=h??this.offset,this.mouseHandlerCallback=m??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,n;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),i=a.x,o=a.y,l=a.height,c=this.coordinateList[this.activeIndex].coordinate,d=((r=window)===null||r===void 0?void 0:r.scrollX)||0,u=((n=window)===null||n===void 0?void 0:n.scrollY)||0,h=i+c+d,f=o+this.offset.top+l/2+u;this.mouseHandlerCallback({pageX:h,pageY:f})}}}])}();function h8e(s,t,r){if(r==="number"&&t===!0&&Array.isArray(s)){var n=s==null?void 0:s[0],a=s==null?void 0:s[1];if(n&&a&&ks(n)&&ks(a))return!0}return!1}function m8e(s,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:s==="horizontal"?t.x-a:r.left+.5,y:s==="horizontal"?r.top+.5:t.y-a,width:s==="horizontal"?n:r.width-1,height:s==="horizontal"?r.height-1:n}}function Fq(s){var t=s.cx,r=s.cy,n=s.radius,a=s.startAngle,i=s.endAngle,o=si(t,r,n,a),l=si(t,r,n,i);return{points:[o,l],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function f8e(s,t,r){var n,a,i,o;if(s==="horizontal")n=t.x,i=n,a=r.top,o=r.top+r.height;else if(s==="vertical")a=t.y,o=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(s==="centric"){var l=t.cx,c=t.cy,d=t.innerRadius,u=t.outerRadius,h=t.angle,f=si(l,c,d,h),m=si(l,c,u,h);n=f.x,a=f.y,i=m.x,o=m.y}else return Fq(t);return[{x:n,y:a},{x:i,y:o}]}function Hv(s){"@babel/helpers - typeof";return Hv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hv(s)}function K8(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function Pj(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?K8(Object(r),!0).forEach(function(n){x8e(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):K8(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function x8e(s,t,r){return t=p8e(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function p8e(s){var t=g8e(s,"string");return Hv(t)=="symbol"?t:t+""}function g8e(s,t){if(Hv(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(Hv(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function v8e(s){var t,r,n=s.element,a=s.tooltipEventType,i=s.isActive,o=s.activeCoordinate,l=s.activePayload,c=s.offset,d=s.activeTooltipIndex,u=s.tooltipAxisBandSize,h=s.layout,f=s.chartName,m=(t=n.props.cursor)!==null&&t!==void 0?t:(r=n.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!n||!m||!i||!o||f!=="ScatterChart"&&a!=="axis")return null;var p,g=km;if(f==="ScatterChart")p=o,g=oPe;else if(f==="BarChart")p=m8e(h,o,c,u),g=CE;else if(h==="radial"){var v=Fq(o),y=v.cx,j=v.cy,b=v.radius,w=v.startAngle,N=v.endAngle;p={cx:y,cy:j,startAngle:w,endAngle:N,innerRadius:b,outerRadius:b},g=Cz}else p={points:f8e(h,o,c)},g=km;var C=Pj(Pj(Pj(Pj({stroke:"#ccc",pointerEvents:"none"},c),p),xr(m,!1)),{},{payload:l,payloadIndex:d,className:Jr("recharts-tooltip-cursor",m.className)});return x.isValidElement(m)?x.cloneElement(m,C):x.createElement(g,C)}var y8e=["item"],j8e=["children","className","width","height","style","compact","title","desc"];function ug(s){"@babel/helpers - typeof";return ug=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ug(s)}function Qx(){return Qx=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(s[n]=r[n])}return s},Qx.apply(this,arguments)}function Y8(s,t){return w8e(s)||N8e(s,t)||Lq(s,t)||b8e()}function b8e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function N8e(s,t){var r=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(r!=null){var n,a,i,o,l=[],c=!0,d=!1;try{if(i=(r=r.call(s)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(u){d=!0,a=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(d)throw a}}return l}}function w8e(s){if(Array.isArray(s))return s}function J8(s,t){if(s==null)return{};var r=S8e(s,t),n,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);for(a=0;a<i.length;a++)n=i[a],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(r[n]=s[n])}return r}function S8e(s,t){if(s==null)return{};var r={};for(var n in s)if(Object.prototype.hasOwnProperty.call(s,n)){if(t.indexOf(n)>=0)continue;r[n]=s[n]}return r}function C8e(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}function A8e(s,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,$q(n.key),n)}}function E8e(s,t,r){return t&&A8e(s.prototype,t),Object.defineProperty(s,"prototype",{writable:!1}),s}function I8e(s,t,r){return t=Rb(t),P8e(s,Mq()?Reflect.construct(t,r||[],Rb(s).constructor):t.apply(s,r))}function P8e(s,t){if(t&&(ug(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _8e(s)}function _8e(s){if(s===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return s}function Mq(){try{var s=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Mq=function(){return!!s})()}function Rb(s){return Rb=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Rb(s)}function k8e(s,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");s.prototype=Object.create(t&&t.prototype,{constructor:{value:s,writable:!0,configurable:!0}}),Object.defineProperty(s,"prototype",{writable:!1}),t&&ZA(s,t)}function ZA(s,t){return ZA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,a){return n.__proto__=a,n},ZA(s,t)}function hg(s){return O8e(s)||D8e(s)||Lq(s)||T8e()}function T8e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lq(s,t){if(s){if(typeof s=="string")return e5(s,t);var r=Object.prototype.toString.call(s).slice(8,-1);if(r==="Object"&&s.constructor&&(r=s.constructor.name),r==="Map"||r==="Set")return Array.from(s);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e5(s,t)}}function D8e(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function O8e(s){if(Array.isArray(s))return e5(s)}function e5(s,t){(t==null||t>s.length)&&(t=s.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=s[r];return n}function X8(s,t){var r=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable})),r.push.apply(r,n)}return r}function ls(s){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X8(Object(r),!0).forEach(function(n){Br(s,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(r)):X8(Object(r)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(r,n))})}return s}function Br(s,t,r){return t=$q(t),t in s?Object.defineProperty(s,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[t]=r,s}function $q(s){var t=R8e(s,"string");return ug(t)=="symbol"?t:t+""}function R8e(s,t){if(ug(s)!="object"||!s)return s;var r=s[Symbol.toPrimitive];if(r!==void 0){var n=r.call(s,t);if(ug(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}var F8e={xAxis:["bottom","top"],yAxis:["left","right"]},M8e={width:"100%",height:"100%"},Bq={x:0,y:0};function _j(s){return s}var L8e=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},$8e=function(t,r,n,a){var i=r.find(function(u){return u&&u.index===n});if(i){if(t==="horizontal")return{x:i.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:i.coordinate};if(t==="centric"){var o=i.coordinate,l=a.radius;return ls(ls(ls({},a),si(a.cx,a.cy,l,o)),{},{angle:o,radius:l})}var c=i.coordinate,d=a.angle;return ls(ls(ls({},a),si(a.cx,a.cy,c,d)),{},{angle:d,radius:c})}return Bq},pw=function(t,r){var n=r.graphicalItems,a=r.dataStartIndex,i=r.dataEndIndex,o=(n??[]).reduce(function(l,c){var d=c.props.data;return d&&d.length?[].concat(hg(l),hg(d)):l},[]);return o.length>0?o:t&&t.length&&ks(a)&&ks(i)?t.slice(a,i+1):[]};function Uq(s){return s==="number"?[0,"auto"]:void 0}var t5=function(t,r,n,a){var i=t.graphicalItems,o=t.tooltipAxis,l=pw(r,t);return n<0||!i||!i.length||n>=l.length?null:i.reduce(function(c,d){var u,h=(u=d.props.data)!==null&&u!==void 0?u:r;h&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=n&&(h=h.slice(t.dataStartIndex,t.dataEndIndex+1));var f;if(o.dataKey&&!o.allowDuplicatedCategory){var m=h===void 0?l:h;f=T1(m,o.dataKey,a)}else f=h&&h[n]||l[n];return f?[].concat(hg(c),[yz(d,f)]):c},[])},Q8=function(t,r,n,a){var i=a||{x:t.chartX,y:t.chartY},o=L8e(i,n),l=t.orderedTooltipTicks,c=t.tooltipAxis,d=t.tooltipTicks,u=k3e(o,l,d,c);if(u>=0&&d){var h=d[u]&&d[u].value,f=t5(t,r,u,h),m=$8e(n,l,u,i);return{activeTooltipIndex:u,activeLabel:h,activePayload:f,activeCoordinate:m}}return null},B8e=function(t,r){var n=r.axes,a=r.graphicalItems,i=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.layout,h=t.children,f=t.stackOffset,m=mz(u,i);return n.reduce(function(p,g){var v,y=g.type.defaultProps!==void 0?ls(ls({},g.type.defaultProps),g.props):g.props,j=y.type,b=y.dataKey,w=y.allowDataOverflow,N=y.allowDuplicatedCategory,C=y.scale,S=y.ticks,_=y.includeHidden,k=y[o];if(p[k])return p;var F=pw(t.data,{graphicalItems:a.filter(function(P){var q,D=o in P.props?P.props[o]:(q=P.type.defaultProps)===null||q===void 0?void 0:q[o];return D===k}),dataStartIndex:c,dataEndIndex:d}),A=F.length,T,V,M;h8e(y.domain,w,j)&&(T=hA(y.domain,null,w),m&&(j==="number"||C!=="auto")&&(M=H0(F,b,"category")));var G=Uq(j);if(!T||T.length===0){var L,J=(L=y.domain)!==null&&L!==void 0?L:G;if(b){if(T=H0(F,b,j),j==="category"&&m){var z=jge(T);N&&z?(V=T,T=yb(0,A)):N||(T=pO(J,T,g).reduce(function(P,q){return P.indexOf(q)>=0?P:[].concat(hg(P),[q])},[]))}else if(j==="category")N?T=T.filter(function(P){return P!==""&&!Fr(P)}):T=pO(J,T,g).reduce(function(P,q){return P.indexOf(q)>=0||q===""||Fr(q)?P:[].concat(hg(P),[q])},[]);else if(j==="number"){var U=F3e(F,a.filter(function(P){var q,D,se=o in P.props?P.props[o]:(q=P.type.defaultProps)===null||q===void 0?void 0:q[o],he="hide"in P.props?P.props.hide:(D=P.type.defaultProps)===null||D===void 0?void 0:D.hide;return se===k&&(_||!he)}),b,i,u);U&&(T=U)}m&&(j==="number"||C!=="auto")&&(M=H0(F,b,"category"))}else m?T=yb(0,A):l&&l[k]&&l[k].hasStack&&j==="number"?T=f==="expand"?[0,1]:vz(l[k].stackGroups,c,d):T=hz(F,a.filter(function(P){var q=o in P.props?P.props[o]:P.type.defaultProps[o],D="hide"in P.props?P.props.hide:P.type.defaultProps.hide;return q===k&&(_||!D)}),j,u,!0);if(j==="number")T=QA(h,T,k,i,S),J&&(T=hA(J,T,w));else if(j==="category"&&J){var oe=J,Q=T.every(function(P){return oe.indexOf(P)>=0});Q&&(T=oe)}}return ls(ls({},p),{},Br({},k,ls(ls({},y),{},{axisType:i,domain:T,categoricalDomain:M,duplicateDomain:V,originalDomain:(v=y.domain)!==null&&v!==void 0?v:G,isCategorical:m,layout:u})))},{})},U8e=function(t,r){var n=r.graphicalItems,a=r.Axis,i=r.axisType,o=r.axisIdKey,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.layout,h=t.children,f=pw(t.data,{graphicalItems:n,dataStartIndex:c,dataEndIndex:d}),m=f.length,p=mz(u,i),g=-1;return n.reduce(function(v,y){var j=y.type.defaultProps!==void 0?ls(ls({},y.type.defaultProps),y.props):y.props,b=j[o],w=Uq("number");if(!v[b]){g++;var N;return p?N=yb(0,m):l&&l[b]&&l[b].hasStack?(N=vz(l[b].stackGroups,c,d),N=QA(h,N,b,i)):(N=hA(w,hz(f,n.filter(function(C){var S,_,k=o in C.props?C.props[o]:(S=C.type.defaultProps)===null||S===void 0?void 0:S[o],F="hide"in C.props?C.props.hide:(_=C.type.defaultProps)===null||_===void 0?void 0:_.hide;return k===b&&!F}),"number",u),a.defaultProps.allowDataOverflow),N=QA(h,N,b,i)),ls(ls({},v),{},Br({},b,ls(ls({axisType:i},a.defaultProps),{},{hide:!0,orientation:Pc(F8e,"".concat(i,".").concat(g%2),null),domain:N,originalDomain:w,isCategorical:p,layout:u})))}return v},{})},z8e=function(t,r){var n=r.axisType,a=n===void 0?"xAxis":n,i=r.AxisComp,o=r.graphicalItems,l=r.stackGroups,c=r.dataStartIndex,d=r.dataEndIndex,u=t.children,h="".concat(a,"Id"),f=Ml(u,i),m={};return f&&f.length?m=B8e(t,{axes:f,graphicalItems:o,axisType:a,axisIdKey:h,stackGroups:l,dataStartIndex:c,dataEndIndex:d}):o&&o.length&&(m=U8e(t,{Axis:i,graphicalItems:o,axisType:a,axisIdKey:h,stackGroups:l,dataStartIndex:c,dataEndIndex:d})),m},q8e=function(t){var r=Zh(t),n=Qu(r,!1,!0);return{tooltipTicks:n,orderedTooltipTicks:Q3(n,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:ib(r,n)}},Z8=function(t){var r=t.children,n=t.defaultShowTooltip,a=bc(r,Qp),i=0,o=0;return t.data&&t.data.length!==0&&(o=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(i=a.props.startIndex),a.props.endIndex>=0&&(o=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!n}},V8e=function(t){return!t||!t.length?!1:t.some(function(r){var n=rh(r&&r.type);return n&&n.indexOf("Bar")>=0})},eR=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},W8e=function(t,r){var n=t.props,a=t.graphicalItems,i=t.xAxisMap,o=i===void 0?{}:i,l=t.yAxisMap,c=l===void 0?{}:l,d=n.width,u=n.height,h=n.children,f=n.margin||{},m=bc(h,Qp),p=bc(h,rp),g=Object.keys(c).reduce(function(N,C){var S=c[C],_=S.orientation;return!S.mirror&&!S.hide?ls(ls({},N),{},Br({},_,N[_]+S.width)):N},{left:f.left||0,right:f.right||0}),v=Object.keys(o).reduce(function(N,C){var S=o[C],_=S.orientation;return!S.mirror&&!S.hide?ls(ls({},N),{},Br({},_,Pc(N,"".concat(_))+S.height)):N},{top:f.top||0,bottom:f.bottom||0}),y=ls(ls({},v),g),j=y.bottom;m&&(y.bottom+=m.props.height||Qp.defaultProps.height),p&&r&&(y=O3e(y,a,n,r));var b=d-y.left-y.right,w=u-y.top-y.bottom;return ls(ls({brushBottom:j},y),{},{width:Math.max(b,0),height:Math.max(w,0)})},H8e=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},Ny=function(t){var r=t.chartName,n=t.GraphicalChild,a=t.defaultTooltipEventType,i=a===void 0?"axis":a,o=t.validateTooltipEventTypes,l=o===void 0?["axis"]:o,c=t.axisComponents,d=t.legendContent,u=t.formatAxisMap,h=t.defaultProps,f=function(y,j){var b=j.graphicalItems,w=j.stackGroups,N=j.offset,C=j.updateId,S=j.dataStartIndex,_=j.dataEndIndex,k=y.barSize,F=y.layout,A=y.barGap,T=y.barCategoryGap,V=y.maxBarSize,M=eR(F),G=M.numericAxisName,L=M.cateAxisName,J=V8e(b),z=[];return b.forEach(function(U,oe){var Q=pw(y.data,{graphicalItems:[U],dataStartIndex:S,dataEndIndex:_}),P=U.type.defaultProps!==void 0?ls(ls({},U.type.defaultProps),U.props):U.props,q=P.dataKey,D=P.maxBarSize,se=P["".concat(G,"Id")],he=P["".concat(L,"Id")],be={},pe=c.reduce(function(ue,ve){var Le=j["".concat(ve.axisType,"Map")],Me=P["".concat(ve.axisType,"Id")];Le&&Le[Me]||ve.axisType==="zAxis"||lx();var tt=Le[Me];return ls(ls({},ue),{},Br(Br({},ve.axisType,tt),"".concat(ve.axisType,"Ticks"),Qu(tt)))},be),Ae=pe[L],Ee=pe["".concat(L,"Ticks")],$e=w&&w[se]&&w[se].hasStack&&W3e(U,w[se].stackGroups),O=rh(U.type).indexOf("Bar")>=0,te=ib(Ae,Ee),re=[],le=J&&T3e({barSize:k,stackGroups:w,totalSize:H8e(pe,L)});if(O){var Z,K,X=Fr(D)?V:D,ce=(Z=(K=ib(Ae,Ee,!0))!==null&&K!==void 0?K:X)!==null&&Z!==void 0?Z:0;re=D3e({barGap:A,barCategoryGap:T,bandSize:ce!==te?ce:te,sizeList:le[he],maxBarSize:X}),ce!==te&&(re=re.map(function(ue){return ls(ls({},ue),{},{position:ls(ls({},ue.position),{},{offset:ue.position.offset-ce/2})})}))}var Y=U&&U.type&&U.type.getComposedData;Y&&z.push({props:ls(ls({},Y(ls(ls({},pe),{},{displayedData:Q,props:y,dataKey:q,item:U,bandSize:te,barPosition:re,offset:N,stackedData:$e,layout:F,dataStartIndex:S,dataEndIndex:_}))),{},Br(Br(Br({key:U.key||"item-".concat(oe)},G,pe[G]),L,pe[L]),"animationId",C)),childIndex:Dge(U,y.children),item:U})}),z},m=function(y,j){var b=y.props,w=y.dataStartIndex,N=y.dataEndIndex,C=y.updateId;if(!dT({props:b}))return null;var S=b.children,_=b.layout,k=b.stackOffset,F=b.data,A=b.reverseStackOrder,T=eR(_),V=T.numericAxisName,M=T.cateAxisName,G=Ml(S,n),L=q3e(F,G,"".concat(V,"Id"),"".concat(M,"Id"),k,A),J=c.reduce(function(P,q){var D="".concat(q.axisType,"Map");return ls(ls({},P),{},Br({},D,z8e(b,ls(ls({},q),{},{graphicalItems:G,stackGroups:q.axisType===V&&L,dataStartIndex:w,dataEndIndex:N}))))},{}),z=W8e(ls(ls({},J),{},{props:b,graphicalItems:G}),j==null?void 0:j.legendBBox);Object.keys(J).forEach(function(P){J[P]=u(b,J[P],z,P.replace("Map",""),r)});var U=J["".concat(M,"Map")],oe=q8e(U),Q=f(b,ls(ls({},J),{},{dataStartIndex:w,dataEndIndex:N,updateId:C,graphicalItems:G,stackGroups:L,offset:z}));return ls(ls({formattedGraphicalItems:Q,graphicalItems:G,offset:z,stackGroups:L},oe),J)},p=function(v){function y(j){var b,w,N;return C8e(this,y),N=I8e(this,y,[j]),Br(N,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Br(N,"accessibilityManager",new u8e),Br(N,"handleLegendBBoxUpdate",function(C){if(C){var S=N.state,_=S.dataStartIndex,k=S.dataEndIndex,F=S.updateId;N.setState(ls({legendBBox:C},m({props:N.props,dataStartIndex:_,dataEndIndex:k,updateId:F},ls(ls({},N.state),{},{legendBBox:C}))))}}),Br(N,"handleReceiveSyncEvent",function(C,S,_){if(N.props.syncId===C){if(_===N.eventEmitterSymbol&&typeof N.props.syncMethod!="function")return;N.applySyncEvent(S)}}),Br(N,"handleBrushChange",function(C){var S=C.startIndex,_=C.endIndex;if(S!==N.state.dataStartIndex||_!==N.state.dataEndIndex){var k=N.state.updateId;N.setState(function(){return ls({dataStartIndex:S,dataEndIndex:_},m({props:N.props,dataStartIndex:S,dataEndIndex:_,updateId:k},N.state))}),N.triggerSyncEvent({dataStartIndex:S,dataEndIndex:_})}}),Br(N,"handleMouseEnter",function(C){var S=N.getMouseInfo(C);if(S){var _=ls(ls({},S),{},{isTooltipActive:!0});N.setState(_),N.triggerSyncEvent(_);var k=N.props.onMouseEnter;Lr(k)&&k(_,C)}}),Br(N,"triggeredAfterMouseMove",function(C){var S=N.getMouseInfo(C),_=S?ls(ls({},S),{},{isTooltipActive:!0}):{isTooltipActive:!1};N.setState(_),N.triggerSyncEvent(_);var k=N.props.onMouseMove;Lr(k)&&k(_,C)}),Br(N,"handleItemMouseEnter",function(C){N.setState(function(){return{isTooltipActive:!0,activeItem:C,activePayload:C.tooltipPayload,activeCoordinate:C.tooltipPosition||{x:C.cx,y:C.cy}}})}),Br(N,"handleItemMouseLeave",function(){N.setState(function(){return{isTooltipActive:!1}})}),Br(N,"handleMouseMove",function(C){C.persist(),N.throttleTriggeredAfterMouseMove(C)}),Br(N,"handleMouseLeave",function(C){N.throttleTriggeredAfterMouseMove.cancel();var S={isTooltipActive:!1};N.setState(S),N.triggerSyncEvent(S);var _=N.props.onMouseLeave;Lr(_)&&_(S,C)}),Br(N,"handleOuterEvent",function(C){var S=Tge(C),_=Pc(N.props,"".concat(S));if(S&&Lr(_)){var k,F;/.*touch.*/i.test(S)?F=N.getMouseInfo(C.changedTouches[0]):F=N.getMouseInfo(C),_((k=F)!==null&&k!==void 0?k:{},C)}}),Br(N,"handleClick",function(C){var S=N.getMouseInfo(C);if(S){var _=ls(ls({},S),{},{isTooltipActive:!0});N.setState(_),N.triggerSyncEvent(_);var k=N.props.onClick;Lr(k)&&k(_,C)}}),Br(N,"handleMouseDown",function(C){var S=N.props.onMouseDown;if(Lr(S)){var _=N.getMouseInfo(C);S(_,C)}}),Br(N,"handleMouseUp",function(C){var S=N.props.onMouseUp;if(Lr(S)){var _=N.getMouseInfo(C);S(_,C)}}),Br(N,"handleTouchMove",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&N.throttleTriggeredAfterMouseMove(C.changedTouches[0])}),Br(N,"handleTouchStart",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&N.handleMouseDown(C.changedTouches[0])}),Br(N,"handleTouchEnd",function(C){C.changedTouches!=null&&C.changedTouches.length>0&&N.handleMouseUp(C.changedTouches[0])}),Br(N,"handleDoubleClick",function(C){var S=N.props.onDoubleClick;if(Lr(S)){var _=N.getMouseInfo(C);S(_,C)}}),Br(N,"handleContextMenu",function(C){var S=N.props.onContextMenu;if(Lr(S)){var _=N.getMouseInfo(C);S(_,C)}}),Br(N,"triggerSyncEvent",function(C){N.props.syncId!==void 0&&kS.emit(TS,N.props.syncId,C,N.eventEmitterSymbol)}),Br(N,"applySyncEvent",function(C){var S=N.props,_=S.layout,k=S.syncMethod,F=N.state.updateId,A=C.dataStartIndex,T=C.dataEndIndex;if(C.dataStartIndex!==void 0||C.dataEndIndex!==void 0)N.setState(ls({dataStartIndex:A,dataEndIndex:T},m({props:N.props,dataStartIndex:A,dataEndIndex:T,updateId:F},N.state)));else if(C.activeTooltipIndex!==void 0){var V=C.chartX,M=C.chartY,G=C.activeTooltipIndex,L=N.state,J=L.offset,z=L.tooltipTicks;if(!J)return;if(typeof k=="function")G=k(z,C);else if(k==="value"){G=-1;for(var U=0;U<z.length;U++)if(z[U].value===C.activeLabel){G=U;break}}var oe=ls(ls({},J),{},{x:J.left,y:J.top}),Q=Math.min(V,oe.x+oe.width),P=Math.min(M,oe.y+oe.height),q=z[G]&&z[G].value,D=t5(N.state,N.props.data,G),se=z[G]?{x:_==="horizontal"?z[G].coordinate:Q,y:_==="horizontal"?P:z[G].coordinate}:Bq;N.setState(ls(ls({},C),{},{activeLabel:q,activeCoordinate:se,activePayload:D,activeTooltipIndex:G}))}else N.setState(C)}),Br(N,"renderCursor",function(C){var S,_=N.state,k=_.isTooltipActive,F=_.activeCoordinate,A=_.activePayload,T=_.offset,V=_.activeTooltipIndex,M=_.tooltipAxisBandSize,G=N.getTooltipEventType(),L=(S=C.props.active)!==null&&S!==void 0?S:k,J=N.props.layout,z=C.key||"_recharts-cursor";return xe.createElement(v8e,{key:z,activeCoordinate:F,activePayload:A,activeTooltipIndex:V,chartName:r,element:C,isActive:L,layout:J,offset:T,tooltipAxisBandSize:M,tooltipEventType:G})}),Br(N,"renderPolarAxis",function(C,S,_){var k=Pc(C,"type.axisType"),F=Pc(N.state,"".concat(k,"Map")),A=C.type.defaultProps,T=A!==void 0?ls(ls({},A),C.props):C.props,V=F&&F[T["".concat(k,"Id")]];return x.cloneElement(C,ls(ls({},V),{},{className:Jr(k,V.className),key:C.key||"".concat(S,"-").concat(_),ticks:Qu(V,!0)}))}),Br(N,"renderPolarGrid",function(C){var S=C.props,_=S.radialLines,k=S.polarAngles,F=S.polarRadius,A=N.state,T=A.radiusAxisMap,V=A.angleAxisMap,M=Zh(T),G=Zh(V),L=G.cx,J=G.cy,z=G.innerRadius,U=G.outerRadius;return x.cloneElement(C,{polarAngles:Array.isArray(k)?k:Qu(G,!0).map(function(oe){return oe.coordinate}),polarRadius:Array.isArray(F)?F:Qu(M,!0).map(function(oe){return oe.coordinate}),cx:L,cy:J,innerRadius:z,outerRadius:U,key:C.key||"polar-grid",radialLines:_})}),Br(N,"renderLegend",function(){var C=N.state.formattedGraphicalItems,S=N.props,_=S.children,k=S.width,F=S.height,A=N.props.margin||{},T=k-(A.left||0)-(A.right||0),V=dz({children:_,formattedGraphicalItems:C,legendWidth:T,legendContent:d});if(!V)return null;var M=V.item,G=J8(V,y8e);return x.cloneElement(M,ls(ls({},G),{},{chartWidth:k,chartHeight:F,margin:A,onBBoxUpdate:N.handleLegendBBoxUpdate}))}),Br(N,"renderTooltip",function(){var C,S=N.props,_=S.children,k=S.accessibilityLayer,F=bc(_,Mo);if(!F)return null;var A=N.state,T=A.isTooltipActive,V=A.activeCoordinate,M=A.activePayload,G=A.activeLabel,L=A.offset,J=(C=F.props.active)!==null&&C!==void 0?C:T;return x.cloneElement(F,{viewBox:ls(ls({},L),{},{x:L.left,y:L.top}),active:J,label:G,payload:J?M:[],coordinate:V,accessibilityLayer:k})}),Br(N,"renderBrush",function(C){var S=N.props,_=S.margin,k=S.data,F=N.state,A=F.offset,T=F.dataStartIndex,V=F.dataEndIndex,M=F.updateId;return x.cloneElement(C,{key:C.key||"_recharts-brush",onChange:Cj(N.handleBrushChange,C.props.onChange),data:k,x:ks(C.props.x)?C.props.x:A.left,y:ks(C.props.y)?C.props.y:A.top+A.height+A.brushBottom-(_.bottom||0),width:ks(C.props.width)?C.props.width:A.width,startIndex:T,endIndex:V,updateId:"brush-".concat(M)})}),Br(N,"renderReferenceElement",function(C,S,_){if(!C)return null;var k=N,F=k.clipPathId,A=N.state,T=A.xAxisMap,V=A.yAxisMap,M=A.offset,G=C.type.defaultProps||{},L=C.props,J=L.xAxisId,z=J===void 0?G.xAxisId:J,U=L.yAxisId,oe=U===void 0?G.yAxisId:U;return x.cloneElement(C,{key:C.key||"".concat(S,"-").concat(_),xAxis:T[z],yAxis:V[oe],viewBox:{x:M.left,y:M.top,width:M.width,height:M.height},clipPathId:F})}),Br(N,"renderActivePoints",function(C){var S=C.item,_=C.activePoint,k=C.basePoint,F=C.childIndex,A=C.isRange,T=[],V=S.props.key,M=S.item.type.defaultProps!==void 0?ls(ls({},S.item.type.defaultProps),S.item.props):S.item.props,G=M.activeDot,L=M.dataKey,J=ls(ls({index:F,dataKey:L,cx:_.x,cy:_.y,r:4,fill:SE(S.item),strokeWidth:2,stroke:"#fff",payload:_.payload,value:_.value},xr(G,!1)),D1(G));return T.push(y.renderActiveDot(G,J,"".concat(V,"-activePoint-").concat(F))),k?T.push(y.renderActiveDot(G,ls(ls({},J),{},{cx:k.x,cy:k.y}),"".concat(V,"-basePoint-").concat(F))):A&&T.push(null),T}),Br(N,"renderGraphicChild",function(C,S,_){var k=N.filterFormatItem(C,S,_);if(!k)return null;var F=N.getTooltipEventType(),A=N.state,T=A.isTooltipActive,V=A.tooltipAxis,M=A.activeTooltipIndex,G=A.activeLabel,L=N.props.children,J=bc(L,Mo),z=k.props,U=z.points,oe=z.isRange,Q=z.baseLine,P=k.item.type.defaultProps!==void 0?ls(ls({},k.item.type.defaultProps),k.item.props):k.item.props,q=P.activeDot,D=P.hide,se=P.activeBar,he=P.activeShape,be=!!(!D&&T&&J&&(q||se||he)),pe={};F!=="axis"&&J&&J.props.trigger==="click"?pe={onClick:Cj(N.handleItemMouseEnter,C.props.onClick)}:F!=="axis"&&(pe={onMouseLeave:Cj(N.handleItemMouseLeave,C.props.onMouseLeave),onMouseEnter:Cj(N.handleItemMouseEnter,C.props.onMouseEnter)});var Ae=x.cloneElement(C,ls(ls({},k.props),pe));function Ee(ve){return typeof V.dataKey=="function"?V.dataKey(ve.payload):null}if(be)if(M>=0){var $e,O;if(V.dataKey&&!V.allowDuplicatedCategory){var te=typeof V.dataKey=="function"?Ee:"payload.".concat(V.dataKey.toString());$e=T1(U,te,G),O=oe&&Q&&T1(Q,te,G)}else $e=U==null?void 0:U[M],O=oe&&Q&&Q[M];if(he||se){var re=C.props.activeIndex!==void 0?C.props.activeIndex:M;return[x.cloneElement(C,ls(ls(ls({},k.props),pe),{},{activeIndex:re})),null,null]}if(!Fr($e))return[Ae].concat(hg(N.renderActivePoints({item:k,activePoint:$e,basePoint:O,childIndex:M,isRange:oe})))}else{var le,Z=(le=N.getItemByXY(N.state.activeCoordinate))!==null&&le!==void 0?le:{graphicalItem:Ae},K=Z.graphicalItem,X=K.item,ce=X===void 0?C:X,Y=K.childIndex,ue=ls(ls(ls({},k.props),pe),{},{activeIndex:Y});return[x.cloneElement(ce,ue),null,null]}return oe?[Ae,null,null]:[Ae,null]}),Br(N,"renderCustomized",function(C,S,_){return x.cloneElement(C,ls(ls({key:"recharts-customized-".concat(_)},N.props),N.state))}),Br(N,"renderMap",{CartesianGrid:{handler:_j,once:!0},ReferenceArea:{handler:N.renderReferenceElement},ReferenceLine:{handler:_j},ReferenceDot:{handler:N.renderReferenceElement},XAxis:{handler:_j},YAxis:{handler:_j},Brush:{handler:N.renderBrush,once:!0},Bar:{handler:N.renderGraphicChild},Line:{handler:N.renderGraphicChild},Area:{handler:N.renderGraphicChild},Radar:{handler:N.renderGraphicChild},RadialBar:{handler:N.renderGraphicChild},Scatter:{handler:N.renderGraphicChild},Pie:{handler:N.renderGraphicChild},Funnel:{handler:N.renderGraphicChild},Tooltip:{handler:N.renderCursor,once:!0},PolarGrid:{handler:N.renderPolarGrid,once:!0},PolarAngleAxis:{handler:N.renderPolarAxis},PolarRadiusAxis:{handler:N.renderPolarAxis},Customized:{handler:N.renderCustomized}}),N.clipPathId="".concat((b=j.id)!==null&&b!==void 0?b:Hm("recharts"),"-clip"),N.throttleTriggeredAfterMouseMove=cU(N.triggeredAfterMouseMove,(w=j.throttleDelay)!==null&&w!==void 0?w:1e3/60),N.state={},N}return k8e(y,v),E8e(y,[{key:"componentDidMount",value:function(){var b,w;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(b=this.props.margin.left)!==null&&b!==void 0?b:0,top:(w=this.props.margin.top)!==null&&w!==void 0?w:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var b=this.props,w=b.children,N=b.data,C=b.height,S=b.layout,_=bc(w,Mo);if(_){var k=_.props.defaultIndex;if(!(typeof k!="number"||k<0||k>this.state.tooltipTicks.length-1)){var F=this.state.tooltipTicks[k]&&this.state.tooltipTicks[k].value,A=t5(this.state,N,k,F),T=this.state.tooltipTicks[k].coordinate,V=(this.state.offset.top+C)/2,M=S==="horizontal",G=M?{x:T,y:V}:{y:T,x:V},L=this.state.formattedGraphicalItems.find(function(z){var U=z.item;return U.type.name==="Scatter"});L&&(G=ls(ls({},G),L.props.points[k].tooltipPosition),A=L.props.points[k].tooltipPayload);var J={activeTooltipIndex:k,isTooltipActive:!0,activeLabel:F,activePayload:A,activeCoordinate:G};this.setState(J),this.renderCursor(_),this.accessibilityManager.setIndex(k)}}}},{key:"getSnapshotBeforeUpdate",value:function(b,w){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==w.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==b.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==b.margin){var N,C;this.accessibilityManager.setDetails({offset:{left:(N=this.props.margin.left)!==null&&N!==void 0?N:0,top:(C=this.props.margin.top)!==null&&C!==void 0?C:0}})}return null}},{key:"componentDidUpdate",value:function(b){E4([bc(b.children,Mo)],[bc(this.props.children,Mo)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var b=bc(this.props.children,Mo);if(b&&typeof b.props.shared=="boolean"){var w=b.props.shared?"axis":"item";return l.indexOf(w)>=0?w:i}return i}},{key:"getMouseInfo",value:function(b){if(!this.container)return null;var w=this.container,N=w.getBoundingClientRect(),C=aCe(N),S={chartX:Math.round(b.pageX-C.left),chartY:Math.round(b.pageY-C.top)},_=N.width/w.offsetWidth||1,k=this.inRange(S.chartX,S.chartY,_);if(!k)return null;var F=this.state,A=F.xAxisMap,T=F.yAxisMap,V=this.getTooltipEventType(),M=Q8(this.state,this.props.data,this.props.layout,k);if(V!=="axis"&&A&&T){var G=Zh(A).scale,L=Zh(T).scale,J=G&&G.invert?G.invert(S.chartX):null,z=L&&L.invert?L.invert(S.chartY):null;return ls(ls({},S),{},{xValue:J,yValue:z},M)}return M?ls(ls({},S),M):null}},{key:"inRange",value:function(b,w){var N=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,C=this.props.layout,S=b/N,_=w/N;if(C==="horizontal"||C==="vertical"){var k=this.state.offset,F=S>=k.left&&S<=k.left+k.width&&_>=k.top&&_<=k.top+k.height;return F?{x:S,y:_}:null}var A=this.state,T=A.angleAxisMap,V=A.radiusAxisMap;if(T&&V){var M=Zh(T);return yO({x:S,y:_},M)}return null}},{key:"parseEventsOfWrapper",value:function(){var b=this.props.children,w=this.getTooltipEventType(),N=bc(b,Mo),C={};N&&w==="axis"&&(N.props.trigger==="click"?C={onClick:this.handleClick}:C={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var S=D1(this.props,this.handleOuterEvent);return ls(ls({},S),C)}},{key:"addListener",value:function(){kS.on(TS,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){kS.removeListener(TS,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(b,w,N){for(var C=this.state.formattedGraphicalItems,S=0,_=C.length;S<_;S++){var k=C[S];if(k.item===b||k.props.key===b.key||w===rh(k.item.type)&&N===k.childIndex)return k}return null}},{key:"renderClipPath",value:function(){var b=this.clipPathId,w=this.state.offset,N=w.left,C=w.top,S=w.height,_=w.width;return xe.createElement("defs",null,xe.createElement("clipPath",{id:b},xe.createElement("rect",{x:N,y:C,height:S,width:_})))}},{key:"getXScales",value:function(){var b=this.state.xAxisMap;return b?Object.entries(b).reduce(function(w,N){var C=Y8(N,2),S=C[0],_=C[1];return ls(ls({},w),{},Br({},S,_.scale))},{}):null}},{key:"getYScales",value:function(){var b=this.state.yAxisMap;return b?Object.entries(b).reduce(function(w,N){var C=Y8(N,2),S=C[0],_=C[1];return ls(ls({},w),{},Br({},S,_.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(b){var w;return(w=this.state.xAxisMap)===null||w===void 0||(w=w[b])===null||w===void 0?void 0:w.scale}},{key:"getYScaleByAxisId",value:function(b){var w;return(w=this.state.yAxisMap)===null||w===void 0||(w=w[b])===null||w===void 0?void 0:w.scale}},{key:"getItemByXY",value:function(b){var w=this.state,N=w.formattedGraphicalItems,C=w.activeItem;if(N&&N.length)for(var S=0,_=N.length;S<_;S++){var k=N[S],F=k.props,A=k.item,T=A.type.defaultProps!==void 0?ls(ls({},A.type.defaultProps),A.props):A.props,V=rh(A.type);if(V==="Bar"){var M=(F.data||[]).find(function(z){return U6e(b,z)});if(M)return{graphicalItem:k,payload:M}}else if(V==="RadialBar"){var G=(F.data||[]).find(function(z){return yO(b,z)});if(G)return{graphicalItem:k,payload:G}}else if(ow(k,C)||lw(k,C)||Bv(k,C)){var L=P_e({graphicalItem:k,activeTooltipItem:C,itemData:T.data}),J=T.activeIndex===void 0?L:T.activeIndex;return{graphicalItem:ls(ls({},k),{},{childIndex:J}),payload:Bv(k,C)?T.data[L]:k.props.data[L]}}}return null}},{key:"render",value:function(){var b=this;if(!dT(this))return null;var w=this.props,N=w.children,C=w.className,S=w.width,_=w.height,k=w.style,F=w.compact,A=w.title,T=w.desc,V=J8(w,j8e),M=xr(V,!1);if(F)return xe.createElement(E8,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},xe.createElement(P4,Qx({},M,{width:S,height:_,title:A,desc:T}),this.renderClipPath(),hT(N,this.renderMap)));if(this.props.accessibilityLayer){var G,L;M.tabIndex=(G=this.props.tabIndex)!==null&&G!==void 0?G:0,M.role=(L=this.props.role)!==null&&L!==void 0?L:"application",M.onKeyDown=function(z){b.accessibilityManager.keyboardEvent(z)},M.onFocus=function(){b.accessibilityManager.focus()}}var J=this.parseEventsOfWrapper();return xe.createElement(E8,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},xe.createElement("div",Qx({className:Jr("recharts-wrapper",C),style:ls({position:"relative",cursor:"default",width:S,height:_},k)},J,{ref:function(U){b.container=U}}),xe.createElement(P4,Qx({},M,{width:S,height:_,title:A,desc:T,style:M8e}),this.renderClipPath(),hT(N,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(x.Component);Br(p,"displayName",r),Br(p,"defaultProps",ls({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},h)),Br(p,"getDerivedStateFromProps",function(v,y){var j=v.dataKey,b=v.data,w=v.children,N=v.width,C=v.height,S=v.layout,_=v.stackOffset,k=v.margin,F=y.dataStartIndex,A=y.dataEndIndex;if(y.updateId===void 0){var T=Z8(v);return ls(ls(ls({},T),{},{updateId:0},m(ls(ls({props:v},T),{},{updateId:0}),y)),{},{prevDataKey:j,prevData:b,prevWidth:N,prevHeight:C,prevLayout:S,prevStackOffset:_,prevMargin:k,prevChildren:w})}if(j!==y.prevDataKey||b!==y.prevData||N!==y.prevWidth||C!==y.prevHeight||S!==y.prevLayout||_!==y.prevStackOffset||!sp(k,y.prevMargin)){var V=Z8(v),M={chartX:y.chartX,chartY:y.chartY,isTooltipActive:y.isTooltipActive},G=ls(ls({},Q8(y,b,S)),{},{updateId:y.updateId+1}),L=ls(ls(ls({},V),M),G);return ls(ls(ls({},L),m(ls({props:v},L),y)),{},{prevDataKey:j,prevData:b,prevWidth:N,prevHeight:C,prevLayout:S,prevStackOffset:_,prevMargin:k,prevChildren:w})}if(!E4(w,y.prevChildren)){var J,z,U,oe,Q=bc(w,Qp),P=Q&&(J=(z=Q.props)===null||z===void 0?void 0:z.startIndex)!==null&&J!==void 0?J:F,q=Q&&(U=(oe=Q.props)===null||oe===void 0?void 0:oe.endIndex)!==null&&U!==void 0?U:A,D=P!==F||q!==A,se=!Fr(b),he=se&&!D?y.updateId:y.updateId+1;return ls(ls({updateId:he},m(ls(ls({props:v},y),{},{updateId:he,dataStartIndex:P,dataEndIndex:q}),y)),{},{prevChildren:w,dataStartIndex:P,dataEndIndex:q})}return null}),Br(p,"renderActiveDot",function(v,y,j){var b;return x.isValidElement(v)?b=x.cloneElement(v,y):Lr(v)?b=v(y):b=xe.createElement(jy,y),xe.createElement(mn,{className:"recharts-active-dot",key:j},b)});var g=x.forwardRef(function(y,j){return xe.createElement(p,Qx({},y,{ref:j}))});return g.displayName=p.displayName,g},Fb=Ny({chartName:"BarChart",GraphicalChild:sd,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:rc},{axisType:"yAxis",AxisComp:_l}],formatAxisMap:dw}),G8e=Ny({chartName:"PieChart",GraphicalChild:bh,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:iw},{axisType:"radiusAxis",AxisComp:nw}],formatAxisMap:tEe,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),zq=Ny({chartName:"ScatterChart",GraphicalChild:yx,defaultTooltipEventType:"item",validateTooltipEventTypes:["item"],axisComponents:[{axisType:"xAxis",AxisComp:rc},{axisType:"yAxis",AxisComp:_l},{axisType:"zAxis",AxisComp:by}],formatAxisMap:dw}),qq=Ny({chartName:"AreaChart",GraphicalChild:_c,axisComponents:[{axisType:"xAxis",AxisComp:rc},{axisType:"yAxis",AxisComp:_l}],formatAxisMap:dw}),K8e=Ny({chartName:"ComposedChart",GraphicalChild:[ag,_c,sd,yx],axisComponents:[{axisType:"xAxis",AxisComp:rc},{axisType:"yAxis",AxisComp:_l},{axisType:"zAxis",AxisComp:by}],formatAxisMap:dw});const tR=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884D8","#82CA9D"];function Y8e({products:s,movements:t,locations:r,categories:n,alerts:a,analytics:i,kpis:o,onRefresh:l}){const[c,d]=x.useState("30d"),[u,h]=x.useState("all"),[f,m]=x.useState("value"),p=x.useMemo(()=>{const j=s.reduce((S,_)=>{let k="Uncategorized";if(_.categoryId){const M=n.find(G=>G.id===_.categoryId);k=(M==null?void 0:M.name)||"Unknown Category"}else _.category&&(k=_.category);const F=S.find(M=>M.name===k),A=parseFloat(_.stockQuantity||0),V=parseFloat(_.unitPrice||0)*A;return F?(F.value+=A,F.revenue+=V):S.push({name:k,value:A,revenue:V}),S},[]).filter(S=>S.value>0),b=s.map(S=>{const _=parseFloat(S.stockQuantity||0),k=parseFloat(S.costPrice||0),F=parseFloat(S.unitPrice||0),A=_*k,T=_*F;return{name:S.name,sku:S.sku,stock:_,costValue:A,retailValue:T,value:A}}).sort((S,_)=>_.value-S.value).slice(0,10),w=r.map(S=>{if(S.stockMetrics)return{name:S.name,stock:S.stockMetrics.totalStock,value:S.stockMetrics.totalValue,retailValue:S.stockMetrics.totalRetailValue,products:S.stockMetrics.uniqueProducts};let _=0,k=0,F=0,A=0;return s.forEach(T=>{var M;const V=(M=T.locations)==null?void 0:M.find(G=>G.locationId===S.id);if(V){const G=parseFloat(V.quantity||0),L=parseFloat(T.costPrice||0),J=parseFloat(T.unitPrice||0);_+=G,k+=G*L,F+=G*J,A++}}),{name:S.name,stock:_,value:Math.round(k*100)/100,retailValue:Math.round(F*100)/100,products:A}}),N=x.useMemo(()=>Array.from({length:30},(_,k)=>{const A=new Date(Date.now()-(29-k)*24*60*60*1e3).toISOString().split("T")[0],T=t.filter(L=>new Date(L.movementDate).toISOString().split("T")[0]===A),V=T.filter(L=>["INBOUND","PURCHASE","TRANSFER_IN","ADJUSTMENT_IN","RETURN_IN"].includes(L.movementType)).reduce((L,J)=>L+Math.abs(Number(J.quantity||0)),0),M=T.filter(L=>["OUTBOUND","SALE","TRANSFER_OUT","ADJUSTMENT_OUT","RETURN_OUT","DAMAGE","THEFT"].includes(L.movementType)).reduce((L,J)=>L+Math.abs(Number(J.quantity||0)),0),G=T.filter(L=>["ADJUSTMENT_IN","ADJUSTMENT_OUT","CYCLE_COUNT"].includes(L.movementType)).reduce((L,J)=>L+Math.abs(Number(J.quantity||0)),0);return{date:A,incoming:V,outgoing:M,adjustments:G}}),[t]),C=x.useMemo(()=>s.filter(S=>parseFloat(S.stockQuantity||0)>0).map(S=>{var M;const _=t.filter(G=>G.productId===S.id),k=new Date(Date.now()-90*24*60*60*1e3),A=_.filter(G=>new Date(G.movementDate)>=k).filter(G=>["OUTBOUND","SALE","TRANSFER_OUT","ADJUSTMENT_OUT","RETURN_OUT","DAMAGE","THEFT"].includes(G.movementType)).reduce((G,L)=>G+Math.abs(Number(L.quantity||0)),0),T=parseFloat(S.stockQuantity||0),V=T>0?A/T*4:0;return{name:S.name,stock:T,turnover:Math.round(V*100)/100,category:S.categoryId?((M=n.find(G=>G.id===S.categoryId))==null?void 0:M.name)||"Unknown Category":"Uncategorized"}}).sort((S,_)=>_.turnover-S.turnover).slice(0,15),[s,t]);return{categoryData:j,topProducts:b,locationData:w,movementTrends:N,turnoverData:C}},[s,r,t,n]),g=x.useMemo(()=>{const y=s.length,j=s.reduce((C,S)=>C+parseFloat(S.unitPrice||0)*parseFloat(S.stockQuantity||0),0),b=s.filter(C=>parseFloat(C.stockQuantity||0)<=(C.reorderPoint||10)).length,w=s.filter(C=>parseFloat(C.stockQuantity||0)===0).length,N=p.turnoverData.reduce((C,S)=>C+S.turnover,0)/p.turnoverData.length;return{totalProducts:y,totalValue:j,lowStockItems:b,outOfStockItems:w,avgTurnover:N||0}},[s,p]),v=({active:y,payload:j,label:b})=>y&&j&&j.length?e.jsxs("div",{className:"bg-white p-3 border rounded-lg shadow-lg",children:[e.jsx("p",{className:"font-medium",children:b}),j.map((w,N)=>e.jsxs("p",{style:{color:w.color},children:[w.name,": ",w.value]},N))]}):null;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Advanced Analytics"}),e.jsx("p",{className:"text-muted-foreground",children:"Comprehensive inventory insights and trends"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(rt,{value:c,onValueChange:d,children:[e.jsx(nt,{className:"w-32",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"7d",children:"Last 7 days"}),e.jsx(W,{value:"30d",children:"Last 30 days"}),e.jsx(W,{value:"90d",children:"Last 90 days"}),e.jsx(W,{value:"1y",children:"Last year"})]})]}),l&&e.jsxs(I,{variant:"outline",size:"sm",onClick:l,children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Hr,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Products"}),e.jsx("p",{className:"text-xl font-bold",children:g.totalProducts})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(Mr,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Value"}),e.jsxs("p",{className:"text-xl font-bold",children:["$",g.totalValue.toLocaleString()]})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-lg flex items-center justify-center",children:e.jsx(Is,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Low Stock"}),e.jsx("p",{className:"text-xl font-bold",children:g.lowStockItems})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx(Hr,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Out of Stock"}),e.jsx("p",{className:"text-xl font-bold",children:g.outOfStockItems})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(or,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Turnover"}),e.jsxs("p",{className:"text-xl font-bold",children:[g.avgTurnover.toFixed(1),"x"]})]})]})})})]}),e.jsxs(an,{defaultValue:"overview",className:"space-y-4",children:[e.jsxs(on,{className:"grid w-full grid-cols-4",children:[e.jsx(vt,{value:"overview",children:"Overview"}),e.jsx(vt,{value:"trends",children:"Trends"}),e.jsx(vt,{value:"performance",children:"Performance"}),e.jsx(vt,{value:"optimization",children:"Optimization"})]}),e.jsxs(yt,{value:"overview",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Eo,{className:"w-5 h-5"}),"Category Distribution"]})}),e.jsx(ie,{children:e.jsx(eu,{width:"100%",height:300,children:e.jsxs(G8e,{children:[e.jsx(bh,{data:p.categoryData,cx:"50%",cy:"50%",labelLine:!1,label:({name:y,percent:j})=>`${y} ${(j*100).toFixed(0)}%`,outerRadius:80,fill:"#8884d8",dataKey:"value",children:p.categoryData.map((y,j)=>e.jsx(xy,{fill:tR[j%tR.length]},`cell-${j}`))}),e.jsx(Mo,{content:e.jsx(v,{})})]})})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(lr,{className:"w-5 h-5"}),"Top Products by Value"]})}),e.jsx(ie,{children:e.jsx(eu,{width:"100%",height:300,children:e.jsxs(Fb,{data:p.topProducts.slice(0,8),children:[e.jsx(Zu,{strokeDasharray:"3 3"}),e.jsx(rc,{dataKey:"name",angle:-45,textAnchor:"end",height:100,fontSize:12}),e.jsx(_l,{}),e.jsx(Mo,{content:e.jsx(v,{})}),e.jsx(sd,{dataKey:"value",fill:"#8884d8"})]})})})]})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(wa,{className:"w-5 h-5"}),"Stock Distribution by Location"]})}),e.jsx(ie,{children:e.jsx(eu,{width:"100%",height:300,children:e.jsxs(Fb,{data:p.locationData,children:[e.jsx(Zu,{strokeDasharray:"3 3"}),e.jsx(rc,{dataKey:"name"}),e.jsx(_l,{yAxisId:"left"}),e.jsx(_l,{yAxisId:"right",orientation:"right"}),e.jsx(Mo,{content:e.jsx(v,{})}),e.jsx(sd,{yAxisId:"left",dataKey:"stock",fill:"#82CA9D",name:"Stock Quantity"}),e.jsx(sd,{yAxisId:"right",dataKey:"value",fill:"#8884D8",name:"Total Value ($)"})]})})})]})]}),e.jsx(yt,{value:"trends",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx($s,{className:"w-5 h-5"}),"Inventory Movement Trends"]})}),e.jsx(ie,{children:e.jsx(eu,{width:"100%",height:400,children:e.jsxs(qq,{data:p.movementTrends,children:[e.jsx(Zu,{strokeDasharray:"3 3"}),e.jsx(rc,{dataKey:"date"}),e.jsx(_l,{}),e.jsx(Mo,{content:e.jsx(v,{})}),e.jsx(_c,{type:"monotone",dataKey:"incoming",stackId:"1",stroke:"#8884d8",fill:"#8884d8"}),e.jsx(_c,{type:"monotone",dataKey:"outgoing",stackId:"1",stroke:"#82ca9d",fill:"#82ca9d"}),e.jsx(_c,{type:"monotone",dataKey:"adjustments",stackId:"1",stroke:"#ffc658",fill:"#ffc658"})]})})})]})}),e.jsx(yt,{value:"performance",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Za,{className:"w-5 h-5"}),"Stock Turnover Analysis"]})}),e.jsx(ie,{children:e.jsx(eu,{width:"100%",height:400,children:e.jsxs(zq,{data:p.turnoverData,children:[e.jsx(Zu,{strokeDasharray:"3 3"}),e.jsx(rc,{dataKey:"stock",name:"Stock Level"}),e.jsx(_l,{dataKey:"turnover",name:"Turnover Rate"}),e.jsx(Mo,{cursor:{strokeDasharray:"3 3"}}),e.jsx(yx,{dataKey:"turnover",fill:"#8884d8"})]})})})]})}),e.jsx(yt,{value:"optimization",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(wa,{className:"w-5 h-5"}),"Optimization Recommendations"]})}),e.jsx(ie,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 rounded-lg",children:[e.jsx($s,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-900",children:"Increase Stock for Fast Movers"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Products with high turnover rates should have increased stock levels"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-amber-50 rounded-lg",children:[e.jsx(Is,{className:"w-5 h-5 text-amber-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-amber-900",children:"Review Low Stock Items"}),e.jsxs("p",{className:"text-sm text-amber-700",children:[g.lowStockItems," items need immediate attention"]})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[e.jsx(Hr,{className:"w-5 h-5 text-green-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-900",children:"Optimize Location Distribution"}),e.jsxs("p",{className:"text-sm text-green-700",children:["Balance stock across ",r.length," locations for better efficiency"]})]})]})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(or,{className:"w-5 h-5"}),"Performance Metrics"]})}),e.jsx(ie,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Inventory Turnover"}),e.jsxs(Oe,{variant:"outline",children:[g.avgTurnover.toFixed(1),"x"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Stock Accuracy"}),e.jsx(Oe,{variant:"outline",children:"98.5%"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Fill Rate"}),e.jsx(Oe,{variant:"outline",children:"94.2%"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Carrying Cost"}),e.jsx(Oe,{variant:"outline",children:"12.3%"})]})]})})]})]})})]})]})}function J8e({onImport:s,onExport:t,trigger:r,className:n}){const[a,i]=x.useState(!1),[o,l]=x.useState("import"),[c,d]=x.useState(null),[u,h]=x.useState("csv"),[f,m]=x.useState(null),[p,g]=x.useState(!1),[v,y]=x.useState(0),[j,b]=x.useState("csv"),[w,N]=x.useState({category:"all",location:"all",status:"all"}),C=x.useRef(null),{toast:S}=za(),_=G=>{var J,z;const L=(J=G.target.files)==null?void 0:J[0];if(L){d(L),m(null);const U=(z=L.name.split(".").pop())==null?void 0:z.toLowerCase();h(U==="xlsx"||U==="xls"?"excel":U==="json"?"json":"csv")}},k=async()=>{if(c){g(!0),y(0);try{const G=setInterval(()=>{y(U=>U>=90?(clearInterval(G),90):U+10)},200),L=await c.text();let J=[];u==="csv"?J=F(L):u==="json"?J=JSON.parse(L):u==="excel"&&(J=F(L));const z=A(J);clearInterval(G),y(100),setTimeout(()=>{m(z),g(!1),z.success?(S({title:"Import Successful",description:`Successfully imported ${z.processed} items`}),s&&s(J)):S({title:"Import Failed",description:`Found ${z.errors.length} errors`,variant:"destructive"})},500)}catch{g(!1),y(0),S({title:"Import Error",description:"Failed to process the file",variant:"destructive"})}}},F=G=>{const L=G.split(`
`).filter(U=>U.trim());if(L.length<2)return[];const J=L[0].split(",").map(U=>U.trim().replace(/"/g,"")),z=[];for(let U=1;U<L.length;U++){const oe=L[U].split(",").map(P=>P.trim().replace(/"/g,"")),Q={};J.forEach((P,q)=>{Q[P]=oe[q]||""}),z.push(Q)}return z},A=G=>{const L=[],J=[];let z=0;return G.forEach((U,oe)=>{const Q=oe+2;if(!U.name||!U.sku){L.push(`Row ${Q}: Missing required fields (name, sku)`);return}U.price&&isNaN(parseFloat(U.price))&&L.push(`Row ${Q}: Invalid price format`),U.stock&&isNaN(parseInt(U.stock))&&L.push(`Row ${Q}: Invalid stock quantity`),U.category||J.push(`Row ${Q}: Missing category (will be set to 'Uncategorized')`),z++}),{success:L.length===0,processed:z,errors:L,warnings:J}},T=()=>{t&&t(j),S({title:"Export Started",description:`Exporting data in ${j.toUpperCase()} format`}),i(!1)},V=()=>{d(null),m(null),y(0),C.current&&(C.current.value="")},M=()=>{const G=[["name","sku","description","category","price","stock","reorder_point","location"],["Sample Product 1","SKU001","Sample description","Electronics","29.99","100","10","Main Warehouse"],["Sample Product 2","SKU002","Another sample","Clothing","19.99","50","5","Store Location"]].map(U=>U.join(",")).join(`
`),L=new Blob([G],{type:"text/csv"}),J=window.URL.createObjectURL(L),z=document.createElement("a");z.href=J,z.download="inventory_template.csv",document.body.appendChild(z),z.click(),document.body.removeChild(z),window.URL.revokeObjectURL(J)};return e.jsxs(ts,{open:a,onOpenChange:i,children:[e.jsx(ki,{asChild:!0,children:r||e.jsxs(I,{variant:"outline",className:n,children:[e.jsx(Pl,{className:"w-4 h-4 mr-2"}),"Bulk Operations"]})}),e.jsxs(ss,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(as,{children:e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(Yf,{className:"w-5 h-5"}),"Bulk Import/Export Operations"]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex space-x-1 bg-muted p-1 rounded-lg",children:[e.jsxs("button",{className:`flex-1 px-3 py-2 text-sm font-medium rounded-md transition-colors ${o==="import"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"}`,onClick:()=>l("import"),children:[e.jsx(Pl,{className:"w-4 h-4 mr-2 inline"}),"Import Data"]}),e.jsxs("button",{className:`flex-1 px-3 py-2 text-sm font-medium rounded-md transition-colors ${o==="export"?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"}`,onClick:()=>l("export"),children:[e.jsx(An,{className:"w-4 h-4 mr-2 inline"}),"Export Data"]})]}),o==="import"&&e.jsx("div",{className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{className:"text-lg",children:"Import Inventory Data"})}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"import-file",children:"Select File"}),e.jsx(ge,{id:"import-file",type:"file",accept:".csv,.xlsx,.xls,.json",onChange:_,ref:C}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Supported formats: CSV, Excel (.xlsx, .xls), JSON"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"import-format",children:"File Format"}),e.jsxs(rt,{value:u,onValueChange:h,children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"csv",children:"CSV"}),e.jsx(W,{value:"excel",children:"Excel"}),e.jsx(W,{value:"json",children:"JSON"})]})]})]}),c&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Zt,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:c.name}),e.jsxs(Oe,{variant:"outline",children:[(c.size/1024).toFixed(1)," KB"]})]}),e.jsx(I,{variant:"ghost",size:"sm",onClick:V,children:e.jsx(ma,{className:"w-4 h-4"})})]}),p&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"Processing..."}),e.jsxs("span",{children:[v,"%"]})]}),e.jsx(No,{value:v})]}),f&&e.jsx(ne,{className:f.success?"border-green-200 bg-green-50":"border-red-200 bg-red-50",children:e.jsxs(ie,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[f.success?e.jsx(bs,{className:"w-5 h-5 text-green-600"}):e.jsx(Ln,{className:"w-5 h-5 text-red-600"}),e.jsx("span",{className:"font-medium",children:f.success?"Import Successful":"Import Failed"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:["Processed: ",f.processed," items"]}),f.errors.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-red-600",children:"Errors:"}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:f.errors.map((G,L)=>e.jsx("li",{className:"text-red-600",children:G},L))})]}),f.warnings.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-amber-600",children:"Warnings:"}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:f.warnings.map((G,L)=>e.jsx("li",{className:"text-amber-600",children:G},L))})]})]})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{onClick:M,variant:"outline",children:[e.jsx(An,{className:"w-4 h-4 mr-2"}),"Download Template"]}),e.jsx(I,{onClick:k,disabled:!c||p,className:"flex-1",children:p?e.jsxs(e.Fragment,{children:[e.jsx(Ts,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Pl,{className:"w-4 h-4 mr-2"}),"Import Data"]})})]})]})]})}),o==="export"&&e.jsx("div",{className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{className:"text-lg",children:"Export Inventory Data"})}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"export-format",children:"Export Format"}),e.jsxs(rt,{value:j,onValueChange:b,children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"csv",children:"CSV"}),e.jsx(W,{value:"excel",children:"Excel"}),e.jsx(W,{value:"json",children:"JSON"}),e.jsx(W,{value:"pdf",children:"PDF Report"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"export-category",children:"Category"}),e.jsxs(rt,{value:w.category,onValueChange:G=>N(L=>({...L,category:G})),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Categories"}),e.jsx(W,{value:"electronics",children:"Electronics"}),e.jsx(W,{value:"clothing",children:"Clothing"}),e.jsx(W,{value:"books",children:"Books"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"export-location",children:"Location"}),e.jsxs(rt,{value:w.location,onValueChange:G=>N(L=>({...L,location:G})),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Locations"}),e.jsx(W,{value:"main-warehouse",children:"Main Warehouse"}),e.jsx(W,{value:"store-location",children:"Store Location"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"export-status",children:"Status"}),e.jsxs(rt,{value:w.status,onValueChange:G=>N(L=>({...L,status:G})),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Status"}),e.jsx(W,{value:"active",children:"Active"}),e.jsx(W,{value:"inactive",children:"Inactive"}),e.jsx(W,{value:"discontinued",children:"Discontinued"})]})]})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(I,{onClick:T,className:"flex-1",children:[e.jsx(An,{className:"w-4 h-4 mr-2"}),"Export Data"]})})]})]})})]})]})]})}function X8e({products:s,movements:t,locations:r,alerts:n,kpis:a,onApplyRecommendation:i,onRefresh:o}){const[l,c]=x.useState("all"),[d,u]=x.useState("all"),[h,f]=x.useState(new Set),{toast:m}=za(),p=x.useMemo(()=>{if(t.length===0)return 100;const S=s.map(F=>{const T=t.filter(G=>G.productId===F.id).reduce((G,L)=>{const J=Number(L.quantity||0);return["INBOUND","PURCHASE","TRANSFER_IN","ADJUSTMENT_IN","RETURN_IN"].includes(L.movementType)?G+J:["OUTBOUND","SALE","TRANSFER_OUT","ADJUSTMENT_OUT","RETURN_OUT","DAMAGE","THEFT"].includes(L.movementType)?G-J:G},0),V=Number(F.stockQuantity||0);return{variance:Math.abs(T-V),actualStock:V}}),_=S.reduce((F,A)=>F+A.variance,0),k=S.reduce((F,A)=>F+A.actualStock,0);return k>0?Math.max(0,100-_/k*100):100},[s,t]),g=x.useMemo(()=>{const S=s.filter(k=>Number(k.stockQuantity||0)===0).length,_=s.length;return _>0?Math.max(0,100-S/_*100):100},[s]),v=x.useMemo(()=>{const S=s.length,_=s.filter(G=>{const L=typeof G.stockQuantity=="string"?parseFloat(G.stockQuantity):G.stockQuantity,J=typeof G.reorderPoint=="string"?parseFloat(G.reorderPoint):G.reorderPoint||10;return L<=J}).length,k=s.filter(G=>(typeof G.stockQuantity=="string"?parseFloat(G.stockQuantity):G.stockQuantity)===0).length,F=(a==null?void 0:a.inventoryTurnover)||6,A=Math.max(0,100-_/S*100),T=Math.max(0,100-k/S*100),V=Math.min(100,F/12*100),M=(A+T+V+p+g)/5;return{overallScore:Math.round(M),costOptimization:Math.round(A),spaceUtilization:Math.round(T),turnoverRate:Math.round(V),stockAccuracy:Math.round(p),fillRate:Math.round(g)}},[s,a,p,g]),j=x.useMemo(()=>{const S=[];return s.forEach(_=>{const k=typeof _.stockQuantity=="string"?parseFloat(_.stockQuantity):_.stockQuantity,F=typeof _.reorderPoint=="string"?parseFloat(_.reorderPoint):_.reorderPoint||10,A=typeof _.unitPrice=="string"?parseFloat(_.unitPrice):_.unitPrice||0,T=typeof _.costPrice=="string"?parseFloat(_.costPrice):_.costPrice||0;if(k<=F&&k>0&&S.push({id:`low-stock-${_.id}`,type:"reorder_point",priority:k<=F*.5?"high":"medium",title:`Reorder ${_.name}`,description:`Stock level (${k}) is below reorder point (${F}). Consider placing a purchase order.`,impact:"risk_reduction",potentialSavings:k*T*.1,confidence:95,products:[_.id],action:`Increase stock to ${F*2} units`,estimatedEffort:"low"}),k>F*3&&S.push({id:`overstock-${_.id}`,type:"stock_adjustment",priority:"medium",title:`Reduce Overstock for ${_.name}`,description:`High stock level (${k}) may indicate overstocking. Consider reducing inventory.`,impact:"cost_savings",potentialSavings:(k-F*2)*T*.2,confidence:80,products:[_.id],action:`Reduce stock to ${F*2} units`,estimatedEffort:"medium"}),A>T*2.5&&T>0){const z=((A-T)/T*100).toFixed(1);S.push({id:`pricing-${_.id}`,type:"pricing",priority:"low",title:`Optimize Pricing for ${_.name}`,description:`High markup (${z}%) may impact sales volume.`,impact:"revenue_increase",potentialRevenue:k*A*.05,confidence:70,products:[_.id],action:"Consider reducing price by 5-10%",estimatedEffort:"low"})}else T===0&&A>0&&S.push({id:`pricing-${_.id}`,type:"pricing",priority:"medium",title:`Review Pricing for ${_.name}`,description:"Product has zero cost price but positive selling price. Review cost structure.",impact:"efficiency",potentialSavings:0,confidence:85,products:[_.id],action:"Update cost price or review pricing strategy",estimatedEffort:"low"});const V=t.filter(z=>z.productId===_.id),M=new Date(Date.now()-90*24*60*60*1e3),G=V.filter(z=>new Date(z.movementDate)>=M),J=G.filter(z=>["OUTBOUND","SALE","TRANSFER_OUT","ADJUSTMENT_OUT","RETURN_OUT","DAMAGE","THEFT"].includes(z.movementType)).length/3;k>0&&J<1&&G.length>0&&S.push({id:`discontinue-${_.id}`,type:"discontinuation",priority:"low",title:`Consider Discontinuing ${_.name}`,description:`Low movement rate (${J.toFixed(1)} movements/month) suggests this product may not be profitable.`,impact:"cost_savings",potentialSavings:k*T,confidence:60,products:[_.id],action:"Phase out product or run clearance sale",estimatedEffort:"high"})}),r.length>1&&S.push({id:"location-balance",type:"location_transfer",priority:"medium",title:"Balance Stock Across Locations",description:`Optimize inventory distribution across ${r.length} locations for better efficiency.`,impact:"efficiency",potentialSavings:5e3,confidence:85,products:s.slice(0,5).map(_=>_.id),locations:r.map(_=>_.id),action:"Transfer stock between locations based on demand patterns",estimatedEffort:"medium"}),S.sort((_,k)=>{const F={high:3,medium:2,low:1};return F[k.priority]-F[_.priority]})},[s,r]).filter(S=>{var F;const _=l==="all"||((F=s.find(A=>A.id===S.products[0]))==null?void 0:F.category)===l,k=d==="all"||S.priority===d;return _&&k}),b=S=>{f(_=>new Set([..._,S.id])),m({title:"Recommendation Applied",description:S.title}),i&&i(S)},w=S=>{switch(S){case"high":return"bg-red-100 text-red-800 border-red-200";case"medium":return"bg-amber-100 text-amber-800 border-amber-200";case"low":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},N=S=>{switch(S){case"cost_savings":return e.jsx($o,{className:"w-4 h-4 text-green-600"});case"revenue_increase":return e.jsx($s,{className:"w-4 h-4 text-blue-600"});case"efficiency":return e.jsx(Za,{className:"w-4 h-4 text-purple-600"});case"risk_reduction":return e.jsx(Is,{className:"w-4 h-4 text-amber-600"});default:return e.jsx(wa,{className:"w-4 h-4 text-gray-600"})}},C=S=>{switch(S){case"low":return"text-green-600";case"medium":return"text-amber-600";case"high":return"text-red-600";default:return"text-gray-600"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Inventory Optimization"}),e.jsx("p",{className:"text-muted-foreground",children:"AI-powered recommendations to optimize your inventory performance"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(rt,{value:l,onValueChange:c,children:[e.jsx(nt,{className:"w-40",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Categories"}),e.jsx(W,{value:"electronics",children:"Electronics"}),e.jsx(W,{value:"clothing",children:"Clothing"}),e.jsx(W,{value:"books",children:"Books"})]})]}),e.jsxs(rt,{value:d,onValueChange:u,children:[e.jsx(nt,{className:"w-32",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Priority"}),e.jsx(W,{value:"high",children:"High"}),e.jsx(W,{value:"medium",children:"Medium"}),e.jsx(W,{value:"low",children:"Low"})]})]}),o&&e.jsxs(I,{variant:"outline",size:"sm",onClick:o,children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4",children:[e.jsx(ne,{children:e.jsxs(ie,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(wa,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Overall Score"}),e.jsxs("p",{className:"text-xl font-bold",children:[v.overallScore,"%"]})]})]}),e.jsx(No,{value:v.overallScore,className:"mt-2"})]})}),e.jsx(ne,{children:e.jsxs(ie,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(Mr,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Cost Optimization"}),e.jsxs("p",{className:"text-xl font-bold",children:[v.costOptimization,"%"]})]})]}),e.jsx(No,{value:v.costOptimization,className:"mt-2"})]})}),e.jsx(ne,{children:e.jsxs(ie,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(Hr,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Space Utilization"}),e.jsxs("p",{className:"text-xl font-bold",children:[v.spaceUtilization,"%"]})]})]}),e.jsx(No,{value:v.spaceUtilization,className:"mt-2"})]})}),e.jsx(ne,{children:e.jsxs(ie,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-lg flex items-center justify-center",children:e.jsx(or,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Turnover Rate"}),e.jsxs("p",{className:"text-xl font-bold",children:[v.turnoverRate,"%"]})]})]}),e.jsx(No,{value:v.turnoverRate,className:"mt-2"})]})}),e.jsx(ne,{children:e.jsxs(ie,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(bs,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Stock Accuracy"}),e.jsxs("p",{className:"text-xl font-bold",children:[v.stockAccuracy,"%"]})]})]}),e.jsx(No,{value:v.stockAccuracy,className:"mt-2"})]})}),e.jsx(ne,{children:e.jsxs(ie,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(lr,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Fill Rate"}),e.jsxs("p",{className:"text-xl font-bold",children:[v.fillRate,"%"]})]})]}),e.jsx(No,{value:v.fillRate,className:"mt-2"})]})})]}),e.jsxs(an,{defaultValue:"recommendations",className:"space-y-4",children:[e.jsxs(on,{className:"grid w-full grid-cols-3",children:[e.jsx(vt,{value:"recommendations",children:"Recommendations"}),e.jsx(vt,{value:"insights",children:"Insights"}),e.jsx(vt,{value:"actions",children:"Action Plan"})]}),e.jsx(yt,{value:"recommendations",className:"space-y-4",children:e.jsxs("div",{className:"space-y-4",children:[j.map(S=>e.jsx(ne,{className:h.has(S.id)?"opacity-50":"",children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"font-semibold",children:S.title}),e.jsx(Oe,{className:w(S.priority),children:S.priority}),N(S.impact)]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:S.description}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Confidence:"}),e.jsxs("span",{className:"font-medium",children:[S.confidence,"%"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Effort:"}),e.jsx("span",{className:`font-medium ${C(S.estimatedEffort)}`,children:S.estimatedEffort})]}),S.potentialSavings&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Savings:"}),e.jsxs("span",{className:"font-medium text-green-600",children:["$",S.potentialSavings.toLocaleString()]})]}),S.potentialRevenue&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-muted-foreground",children:"Revenue:"}),e.jsxs("span",{className:"font-medium text-blue-600",children:["$",S.potentialRevenue.toLocaleString()]})]})]}),e.jsxs("div",{className:"mt-3 p-2 bg-muted rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium",children:"Action:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:S.action})]})]}),e.jsx("div",{className:"ml-4",children:h.has(S.id)?e.jsxs(I,{variant:"outline",disabled:!0,children:[e.jsx(bs,{className:"w-4 h-4 mr-2"}),"Applied"]}):e.jsx(I,{onClick:()=>b(S),size:"sm",children:"Apply"})})]})})},S.id)),j.length===0&&e.jsx(ne,{children:e.jsxs(ie,{className:"p-8 text-center",children:[e.jsx(bs,{className:"w-12 h-12 text-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Recommendations"}),e.jsx("p",{className:"text-muted-foreground",children:"Your inventory is well optimized! No immediate recommendations at this time."})]})})]})}),e.jsx(yt,{value:"insights",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(ic,{className:"w-5 h-5"}),"Key Insights"]})}),e.jsxs(ie,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 rounded-lg",children:[e.jsx($s,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-900",children:"High Turnover Products"}),e.jsxs("p",{className:"text-sm text-blue-700",children:[s.filter(S=>{const _=t.filter(T=>T.productId===S.id),k=new Date(Date.now()-30*24*60*60*1e3);return _.filter(T=>new Date(T.movementDate)>=k).filter(T=>["OUTBOUND","SALE","TRANSFER_OUT","ADJUSTMENT_OUT","RETURN_OUT","DAMAGE","THEFT"].includes(T.movementType)).length>=3}).length," products showing excellent movement"]})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-amber-50 rounded-lg",children:[e.jsx(Is,{className:"w-5 h-5 text-amber-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-amber-900",children:"Attention Needed"}),e.jsxs("p",{className:"text-sm text-amber-700",children:[n.length," items require immediate attention"]})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[e.jsx(Hr,{className:"w-5 h-5 text-green-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-900",children:"Space Optimization"}),e.jsxs("p",{className:"text-sm text-green-700",children:["Potential to free up ",Math.floor(s.length*.1)," storage locations"]})]})]})]})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(lr,{className:"w-5 h-5"}),"Performance Trends"]})}),e.jsxs(ie,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Inventory Turnover"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Lu,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm text-green-600",children:"+12%"})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Stock Accuracy"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Lu,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm text-green-600",children:"+2.1%"})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Carrying Costs"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Gh,{className:"w-4 h-4 text-red-600"}),e.jsx("span",{className:"text-sm text-red-600",children:"-5.3%"})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Fill Rate"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(rM,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm text-gray-600",children:"0.0%"})]})]})]})]})]})}),e.jsx(yt,{value:"actions",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(en,{className:"w-5 h-5"}),"Recommended Action Plan"]})}),e.jsx(ie,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-bold text-red-600",children:"1"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:"Address High Priority Items"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[j.filter(S=>S.priority==="high").length," high priority recommendations"]})]}),e.jsxs(I,{size:"sm",variant:"outline",children:[e.jsx(An,{className:"w-4 h-4 mr-2"}),"Export List"]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg",children:[e.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-bold text-amber-600",children:"2"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:"Review Medium Priority Items"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[j.filter(S=>S.priority==="medium").length," medium priority recommendations"]})]}),e.jsx(I,{size:"sm",variant:"outline",children:"Schedule Review"})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-bold text-green-600",children:"3"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:"Monitor Performance"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Track optimization metrics and adjust strategies"})]}),e.jsx(I,{size:"sm",variant:"outline",children:"Set Alerts"})]})]})})]})})]})]})}function Q8e({forecasts:s,insights:t,recommendations:r,products:n,movements:a,alerts:i,onRefresh:o}){console.log("DemandForecasting received insights:",t),console.log("DemandForecasting received alerts:",i);const[l,c]=x.useState("3m"),[d,u]=x.useState("all"),[h,f]=x.useState("demand"),[m,p]=x.useState([]),[g,v]=x.useState(!0),[y,j]=x.useState("overview"),b=x.useMemo(()=>{console.log("DemandForecasting - Processing movements:",a),console.log("DemandForecasting - Movements count:",(a==null?void 0:a.length)||0);const F=[],A=new Date;A.setMonth(A.getMonth()-1);const T={};a.forEach(V=>{console.log("Processing movement:",{movementDate:V.movementDate,movementType:V.movementType,quantity:V.quantity});const M=new Date(V.movementDate).toISOString().split("T")[0],G=Math.abs(Number(V.quantity||0));["OUTBOUND","SALE","TRANSFER_OUT","ADJUSTMENT_OUT","RETURN_OUT","DAMAGE","THEFT"].includes(V.movementType)?(T[M]=(T[M]||0)+G,console.log("Added to daily demand:",M,G,"Total:",T[M])):console.log("Movement type not counted as demand:",V.movementType)}),console.log("Final daily demand:",T);for(let V=0;V<60;V++){const M=new Date(A);M.setDate(M.getDate()+V);const G=M.toISOString().split("T")[0],L=T[G]||0,J=V>=30;let z=0,U=50;if(J){const Q=[];for(let P=1;P<=30;P++){const q=new Date(M);q.setDate(q.getDate()-P);const D=q.toISOString().split("T")[0];T[D]&&Q.push(T[D])}if(Q.length>0){const P=Q.reduce((q,D)=>q+D,0)/Q.length;z=Math.round(P),U=Math.min(95,60+Q.length*1.5)}}if(V>=30)for(let Q=1;Q<=30;Q++){const P=new Date(M);P.setDate(P.getDate()-Q),P.toISOString().split("T")[0];const q=new Date(M);q.setDate(q.getDate()-Q-30),q.toISOString().split("T")[0]}let oe=L;if(!J&&L>0){const Q=L*(.1+Math.random()*.1)*(Math.random()>.5?1:-1);oe=Math.max(0,L+Q)}F.push({date:G,actual:J?0:L,forecast:J?z:oe,confidence:J?U:100,seasonality:1,error:!J&&L>0?Math.abs(L-oe):void 0,trend:V<30?L>(J?z:L)?"up":L<(J?z:L)?"down":"stable":"stable"})}return console.log("Generated forecast data:",F),console.log("Forecast data length:",F.length),console.log("Sample forecast data:",F.slice(0,5)),F},[a,d]),w=x.useMemo(()=>{const F=b.filter(M=>M.error!==void 0&&M.actual>0);if(F.length===0){const M=Object.values(a.reduce((G,L)=>{if(["OUTBOUND","SALE","TRANSFER_OUT","ADJUSTMENT_OUT","RETURN_OUT","DAMAGE","THEFT"].includes(L.movementType)){const J=new Date(L.movementDate).toISOString().split("T")[0];G[J]=(G[J]||0)+Math.abs(Number(L.quantity||0))}return G},{})).reduce((G,L)=>G+L,0);return Number(M)>50?85:Number(M)>20?75:Number(M)>0?65:0}const T=F.reduce((M,G)=>M+(G.error||0),0)/F.length,V=Math.max(0,100-T/50*100);return Math.round(V)},[b,a]),N=x.useMemo(()=>({totalForecastedDemand:0,totalCurrentStock:0,highRiskItems:0,avgConfidence:0,forecastAccuracy:w}),[w]),C=({active:F,payload:A,label:T})=>F&&A&&A.length?e.jsxs("div",{className:"bg-white p-3 border rounded-lg shadow-lg",children:[e.jsx("p",{className:"font-medium",children:T}),A.map((V,M)=>e.jsxs("p",{style:{color:V.color},children:[V.name,": ",V.value]},M))]}):null,S=F=>{switch(F){case"high":return"bg-red-100 text-red-800 border-red-200";case"medium":return"bg-amber-100 text-amber-800 border-amber-200";case"low":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},_=F=>{switch(F){case"increase":return e.jsx($s,{className:"w-4 h-4 text-green-600"});case"decrease":return e.jsx($o,{className:"w-4 h-4 text-red-600"});case"maintain":return e.jsx(bs,{className:"w-4 h-4 text-blue-600"});default:return e.jsx(wa,{className:"w-4 h-4 text-gray-600"})}},k=x.useMemo(()=>b.filter(F=>{const A=new Date(F.date),T=new Date,V=parseInt(l.replace("m","")),M=new Date(T.getFullYear(),T.getMonth()-V,T.getDate());return A>=M}),[b,l]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"AI Demand Forecasting"}),e.jsx("p",{className:"text-muted-foreground",children:"Predictive analytics powered by machine learning"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(rt,{value:l,onValueChange:c,children:[e.jsx(nt,{className:"w-32",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"1m",children:"1 Month"}),e.jsx(W,{value:"3m",children:"3 Months"}),e.jsx(W,{value:"6m",children:"6 Months"}),e.jsx(W,{value:"1y",children:"1 Year"})]})]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>v(!g),children:[g?e.jsx(bp,{className:"w-4 h-4 mr-2"}):e.jsx(ir,{className:"w-4 h-4 mr-2"}),g?"Hide":"Show"," Confidence"]}),o&&e.jsxs(I,{variant:"outline",size:"sm",onClick:o,children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(sa,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Forecast Accuracy"}),e.jsxs("p",{className:"text-xl font-bold",children:[N.forecastAccuracy,"%"]})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx($s,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Forecasted Demand"}),e.jsx("p",{className:"text-xl font-bold",children:N.totalForecastedDemand.toLocaleString()})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(Hr,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Current Stock"}),e.jsx("p",{className:"text-xl font-bold",children:N.totalCurrentStock.toLocaleString()})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx(Is,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"High Risk Items"}),e.jsx("p",{className:"text-xl font-bold",children:N.highRiskItems})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-lg flex items-center justify-center",children:e.jsx(wa,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Confidence"}),e.jsxs("p",{className:"text-xl font-bold",children:[N.avgConfidence,"%"]})]})]})})})]}),e.jsxs(an,{value:y,onValueChange:j,children:[e.jsxs(on,{className:"grid w-full grid-cols-4",children:[e.jsx(vt,{value:"overview",children:"Overview"}),e.jsx(vt,{value:"products",children:"Product Forecasts"}),e.jsx(vt,{value:"trends",children:"Trends"}),e.jsx(vt,{value:"insights",children:"Insights"})]}),e.jsx(yt,{value:"overview",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx($s,{className:"w-5 h-5"}),"Demand Forecast"]})}),e.jsx(ie,{children:e.jsx(eu,{width:"100%",height:300,children:e.jsxs(K8e,{data:k,children:[e.jsx(Zu,{strokeDasharray:"3 3"}),e.jsx(rc,{dataKey:"date",tickFormatter:F=>new Date(F).toLocaleDateString()}),e.jsx(_l,{}),e.jsx(Mo,{content:e.jsx(C,{})}),e.jsx(_c,{type:"monotone",dataKey:"actual",fill:"#8884d8",fillOpacity:.3,stroke:"#8884d8"}),e.jsx(ag,{type:"monotone",dataKey:"forecast",stroke:"#82ca9d",strokeWidth:2,dot:!1}),g&&e.jsx(ag,{type:"monotone",dataKey:"confidence",stroke:"#ffc658",strokeDasharray:"5 5",dot:!1}),e.jsx(uw,{y:0,stroke:"#666"})]})})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(wa,{className:"w-5 h-5"}),"Forecast Accuracy"]})}),e.jsx(ie,{children:e.jsx(eu,{width:"100%",height:300,children:e.jsxs(Fb,{data:k.slice(-30),children:[e.jsx(Zu,{strokeDasharray:"3 3"}),e.jsx(rc,{dataKey:"date",tickFormatter:F=>new Date(F).toLocaleDateString()}),e.jsx(_l,{}),e.jsx(Mo,{content:e.jsx(C,{})}),e.jsx(sd,{dataKey:"error",fill:"#ff7300"})]})})})]})]})}),e.jsx(yt,{value:"products",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Hr,{className:"w-5 h-5"}),"Product-Level Forecasts"]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:(s||[]).map(F=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[_(F.recommendation),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:F.productName}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Current: ",F.currentStock," | Forecast: ",F.forecastedDemand]})]})]})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-medium",children:[F.confidence,"% confidence"]}),e.jsxs(Oe,{className:S(F.riskLevel),children:[F.riskLevel," risk"]})]}),e.jsx("div",{className:"w-20 h-20",children:e.jsx(eu,{width:"100%",height:"100%",children:e.jsx(Fb,{data:[{name:"Current",value:F.currentStock},{name:"Forecast",value:F.forecastedDemand}],children:e.jsx(sd,{dataKey:"value",fill:"#8884d8"})})})})]})]},F.productId))})})]})}),e.jsx(yt,{value:"trends",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Xn,{className:"w-5 h-5"}),"Seasonal Patterns"]})}),e.jsx(ie,{children:e.jsx(eu,{width:"100%",height:300,children:e.jsxs(qq,{data:k,children:[e.jsx(Zu,{strokeDasharray:"3 3"}),e.jsx(rc,{dataKey:"date"}),e.jsx(_l,{}),e.jsx(Mo,{content:e.jsx(C,{})}),e.jsx(_c,{type:"monotone",dataKey:"seasonality",stroke:"#8884d8",fill:"#8884d8",fillOpacity:.3})]})})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(or,{className:"w-5 h-5"}),"Trend Analysis"]})}),e.jsx(ie,{children:e.jsx(eu,{width:"100%",height:300,children:e.jsxs(zq,{data:k,children:[e.jsx(Zu,{strokeDasharray:"3 3"}),e.jsx(rc,{dataKey:"date"}),e.jsx(_l,{}),e.jsx(Mo,{content:e.jsx(C,{})}),e.jsx(yx,{dataKey:"forecast",fill:"#8884d8"})]})})})]})]})}),e.jsx(yt,{value:"insights",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(sa,{className:"w-5 h-5"}),"AI Insights"]})}),e.jsx(ie,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-lg ${(t==null?void 0:t.demandTrend)>0?"bg-blue-50":(t==null?void 0:t.demandTrend)<0?"bg-red-50":"bg-gray-50"}`,children:[(t==null?void 0:t.demandTrend)>0?e.jsx($s,{className:"w-5 h-5 text-blue-600 mt-0.5"}):(t==null?void 0:t.demandTrend)<0?e.jsx($o,{className:"w-5 h-5 text-red-600 mt-0.5"}):e.jsx(or,{className:"w-5 h-5 text-gray-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:`font-medium ${(t==null?void 0:t.demandTrend)>0?"text-blue-900":(t==null?void 0:t.demandTrend)<0?"text-red-900":"text-gray-900"}`,children:"Demand Trend"}),e.jsxs("p",{className:`text-sm ${(t==null?void 0:t.demandTrend)>0?"text-blue-700":(t==null?void 0:t.demandTrend)<0?"text-red-700":"text-gray-700"}`,children:[(t==null?void 0:t.demandTrend)>0?`+${t.demandTrend}%`:(t==null?void 0:t.demandTrend)<0?`${t.demandTrend}%`:"Stable"," demand change over the period"]})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[e.jsx(bs,{className:"w-5 h-5 text-green-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-900",children:"Forecast Accuracy"}),e.jsxs("p",{className:"text-sm text-green-700",children:[Math.round(((t==null?void 0:t.overallAccuracy)||0)*100),"% accuracy based on historical data"]})]})]}),i&&i.length>0?e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-amber-50 rounded-lg",children:[e.jsx(Is,{className:"w-5 h-5 text-amber-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-amber-900",children:"Risk Alerts"}),e.jsxs("p",{className:"text-sm text-amber-700",children:[i.length," products need immediate attention"]}),e.jsxs("div",{className:"mt-2 space-y-1",children:[i.slice(0,3).map(F=>{var A,T;return e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"font-medium",children:((A=F.product)==null?void 0:A.name)||"Unknown Product"}),e.jsx("span",{className:"text-amber-600 ml-2",children:(T=F.alertType)==null?void 0:T.replace("_"," ").toLowerCase()})]},F.id)}),i.length>3&&e.jsxs("div",{className:"text-xs text-amber-600",children:["+",i.length-3," more alerts"]})]})]})]}):e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-green-50 rounded-lg",children:[e.jsx(bs,{className:"w-5 h-5 text-green-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-900",children:"No Risk Alerts"}),e.jsx("p",{className:"text-sm text-green-700",children:"All products are performing within normal parameters"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 rounded-lg",children:[e.jsx(lr,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-900",children:"Performance Summary"}),e.jsxs("p",{className:"text-sm text-blue-700",children:[(t==null?void 0:t.totalProducts)||0," products, ",(t==null?void 0:t.totalMovements)||0," movements, avg ",(t==null?void 0:t.avgDailyDemand)||0," units/day"]})]})]})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Hr,{className:"w-5 h-5"}),"Top Performing Products"]})}),e.jsx(ie,{className:"space-y-4",children:t!=null&&t.topPerformingProducts&&t.topPerformingProducts.length>0?e.jsx("div",{className:"space-y-3",children:t.topPerformingProducts.map((F,A)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:["#",A+1]}),e.jsx("p",{className:"font-medium",children:F.productName})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[F.totalMovements," movements  Stock: ",F.stockLevel]})]}),e.jsx(Oe,{variant:F.totalMovements>10?"default":"secondary",children:F.totalMovements>10?"High":"Medium"})]},F.productId))}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Hr,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No movement data available for analysis"})]})})]})]})})]})]})}function Z8e(){var Vn,De,ut,Pe,_t,bt,ps,Pr,Wr,Zs,wr,xa,cr,Zn,Hi,Gi,Ti,Ea,Ki,mi,Da,fi,qa,Ne,Dt,ye,Be,Ft,Kt,Jt,kt,gs,fn,xi,$n,Ur,Yi,Ji,rn,Ll,zo,Qo,Xi,_o,qo,$l,Zo,el,ot,qs,Sn,hr,Fn,Rr;const[s,t]=x.useState(""),[r,n]=x.useState("all"),[a,i]=x.useState("all"),[o,l]=x.useState("all"),[c]=x.useState("30d"),[d]=x.useState("3m"),[u,h]=x.useState(!1),[f,m]=x.useState(!1),[p,g]=x.useState(!1),[v,y]=x.useState(!1),[j,b]=x.useState(!1),[w,N]=x.useState(!1),[C,S]=x.useState(!1),[_,k]=x.useState(!1),[F,A]=x.useState(!1),[T,V]=x.useState(""),[M,G]=x.useState(!1),[L,J]=x.useState(!1),[z,U]=x.useState(!1),[oe,Q]=x.useState(null),[P,q]=x.useState(null),[D,se]=x.useState(null),[he,be]=x.useState(null),[pe,Ae]=x.useState({name:"",code:"",description:"",locationType:"WAREHOUSE",address:"",address2:"",city:"",state:"",country:"",postalCode:"",latitude:"",longitude:"",contactName:"",contactPhone:"",contactEmail:"",managerName:"",managerEmail:"",managerPhone:"",isActive:!0,isDefault:!1,capacity:"",timezone:"",operatingHours:"",specialInstructions:"",warehouseZone:"",temperatureControlled:!1,securityLevel:"STANDARD",notes:""}),[Ee,$e]=x.useState({productId:"",movementType:"INBOUND",quantity:0,movementDate:new Date().toISOString().split("T")[0],movementTime:new Date().toTimeString().slice(0,5),reference:"",reason:"",unitCost:0,totalCost:0,locationId:"",fromLocationId:"",toLocationId:"",batchNumber:"",expiryDate:"",serialNumber:"",supplierId:"",customerId:"",orderId:"",invoiceNumber:"",priority:"NORMAL",status:"PENDING",approvedBy:"",processedBy:"",department:"",project:"",costCenter:"",notes:"",attachments:[],isUrgent:!1,requiresApproval:!1,autoCalculateTotal:!0}),[O,te]=x.useState({name:"",sku:"",description:"",shortDescription:"",unitPrice:0,costPrice:0,stockQuantity:0,minStockLevel:0,maxStockLevel:0,reorderPoint:0,category:"",categoryId:"",status:"ACTIVE",type:"PRODUCT",weight:0,dimensions:{length:0,width:0,height:0},taxRate:0,taxInclusive:!1,taxCode:"",taxExempt:!1,barcode:"",tags:"",seoTitle:"",seoDescription:"",metaKeywords:"",isDigital:!1,isService:!1,isPhysical:!0,trackInventory:!0,allowBackorder:!1,allowPreorder:!1,preorderDate:"",warrantyPeriod:0,warrantyUnit:"MONTHS",returnPolicy:"",shippingClass:"",isFeatured:!1,isBestSeller:!1,isNewArrival:!1,customFields:{},images:[],variants:[],relatedProducts:[],upsellProducts:[],crossSellProducts:[],brand:"",model:"",visibility:"public",customField1:"",customField2:"",customField3:"",customField4:"",requiresLicense:!1,hasExpiryDate:!1,isBundle:!1,notes:""}),[re,le]=x.useState({name:"",description:"",color:"#2563eb",icon:"Package"}),[Z,K]=x.useState(!1),[X,ce]=x.useState({lowStockThreshold:5,overstockThreshold:100,criticalStockThreshold:1,emailNotifications:!0,smsNotifications:!1,dashboardAlerts:!0,autoAcknowledgeDays:7,dailyDigestTime:"09:00",weeklySummaryDay:"MONDAY",weeklySummaryTime:"08:00",immediateAlerts:!0,immediateAlertsCriticalOnly:!0}),[Y,ue]=x.useState(!1),[ve,Le]=x.useState(!1),[Me,tt]=x.useState(null),[fe,ct]=x.useState({productId:"",fromLocationId:"",toLocationId:"",quantity:0,transferDate:new Date().toISOString().split("T")[0],transferTime:new Date().toTimeString().slice(0,5),expectedDeliveryDate:"",reference:"",transferType:"INTER_LOCATION",priority:"NORMAL",status:"PENDING",notes:"",requestedBy:"",approvedBy:"",processedBy:"",carrierName:"",trackingNumber:"",shippingCost:0,packingMethod:"",specialInstructions:"",requiresApproval:!1,isUrgent:!1,insuranceValue:0,fragile:!1,temperatureControlled:!1,batchNumber:"",serialNumbers:"",reasonCode:"",departmentFrom:"",departmentTo:"",projectCode:"",costCenter:"",internalNotes:""}),{toast:dt}=za(),pt=hi(),{ready:qe}=gu("inventory"),mt=()=>typeof window<"u"&&(localStorage.getItem("company_id")||localStorage.getItem("companyId"))||"",Rt=()=>typeof window<"u"&&localStorage.getItem("tenant_id")||"tenant_demo",[_e,Xe]=x.useState(mt());x.useEffect(()=>{const $=()=>{const ds=mt();ds&&ds!==_e&&(console.log(" Inventory page - Company changed from",_e,"to",ds),Xe(ds))};window.addEventListener("storage",$);const Xt=ds=>{const Us=ds.detail.companyId;Us&&Us!==_e&&(console.log(" Inventory page - Company changed via custom event from",_e,"to",Us),Xe(Us))};return window.addEventListener("companyChanged",Xt),()=>{window.removeEventListener("storage",$),window.removeEventListener("companyChanged",Xt)}},[_e]);const At=ys({queryKey:["products",s,r,a,o,_e],queryFn:async()=>await Ra.getProducts({companyId:_e,q:s||void 0,category:r||void 0,status:o||void 0,locationId:a||void 0,page:1,pageSize:50}),enabled:!0}),st=ys({queryKey:["locations",_e],queryFn:async()=>{const $=await Ra.getLocations(_e);return console.log("Fetched locations:",$),$},enabled:!0}),$t=ys({queryKey:["categories",_e],queryFn:async()=>await f4.getCategories(_e),enabled:!0}),fs=ys({queryKey:["movements",_e],queryFn:async()=>await Ra.getMovements({companyId:_e,page:1,pageSize:20}),enabled:!0}),zt=ys({queryKey:["alerts",_e],queryFn:async()=>await Ra.getAlerts({companyId:_e}),enabled:!0});ys({queryKey:["alertSettings"],queryFn:async()=>{const $=await Ra.getAlertSettings();return ce($),$},enabled:!0});const St=ys({queryKey:["transfers",_e],queryFn:async()=>await Ra.getTransfers({companyId:_e}),enabled:!0}),js=Array.isArray(St.data)?St.data:((Vn=St.data)==null?void 0:Vn.items)||[],et=ys({queryKey:["analytics",_e,c],queryFn:async()=>await Ra.getAnalytics({companyId:_e,period:c}),enabled:!0}),lt=ys({queryKey:["kpis",_e,c],queryFn:async()=>await Ra.getKPIs({companyId:_e,period:c}),enabled:!0}),Fe=ys({queryKey:["forecasts",_e,c,d],queryFn:async()=>await Ra.getForecasts({companyId:_e,period:c,horizon:d}),enabled:!0}),ft=ys({queryKey:["insights",_e,c],queryFn:async()=>await Ra.getForecastInsights({companyId:_e,period:c}),enabled:!0}),He=ys({queryKey:["recommendations",_e,c],queryFn:async()=>await Ra.getAIRecommendations({companyId:_e,period:c}),enabled:!0});if(!qe)return e.jsx(Kr,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(kr,{size:"lg",color:"teal"}),e.jsx("p",{className:"text-muted-foreground mt-4",children:"Loading inventory..."})]})})});const Je=((De=At.data)==null?void 0:De.items)||[],It=st.data||[],Gt=$t.data||[],qt=((ut=fs.data)==null?void 0:ut.items)||[],As=zt.data||[],Ht=et.data,xs=lt.data,Ct=Fe.data||[],ke=ft.data,gt=He.data;console.log("Analytics API Response:",Ht),console.log("Analytics Query Status:",{isLoading:et.isLoading,error:et.error,data:et.data});const us=Je.filter($=>{var Ce;const Xt=!s||$.name.toLowerCase().includes(s.toLowerCase())||$.sku.toLowerCase().includes(s.toLowerCase()),ds=r==="all"||$.categoryId===r,Us=a==="all"||((Ce=$.locations)==null?void 0:Ce.some(Ge=>Ge.locationId===a)),H=o==="all"||$.status===o;return Xt&&ds&&Us&&H}),We=$=>{const Xt=Number($.stockQuantity);return Xt<=0?e.jsx(Oe,{variant:"destructive",children:"Out of Stock"}):Xt<=10?e.jsx(Oe,{variant:"secondary",children:"Low Stock"}):Xt>=100?e.jsx(Oe,{variant:"outline",children:"Overstock"}):e.jsx(Oe,{variant:"default",children:"In Stock"})},Et=$=>{q($),g(!0)},Pt=$=>{q($),te({name:$.name||"",sku:$.sku||"",description:$.description||"",shortDescription:$.shortDescription||"",type:$.type||"PRODUCT",unitPrice:Number($.unitPrice)||0,costPrice:Number($.costPrice)||0,stockQuantity:Number($.stockQuantity)||0,minStockLevel:Number($.minStockLevel)||0,maxStockLevel:Number($.maxStockLevel)||0,reorderPoint:Number($.reorderPoint)||0,category:$.category||"",categoryId:$.categoryId||"",tags:$.tags||"",weight:Number($.weight)||0,dimensions:$.dimensions||{length:0,width:0,height:0},taxRate:Number($.taxRate)||0,taxInclusive:$.taxInclusive||!1,taxCode:$.taxCode||"",taxExempt:$.taxExempt||!1,barcode:$.barcode||"",isDigital:$.isDigital||!1,isService:$.isService||!1,isPhysical:$.isPhysical!==!1,trackInventory:$.trackInventory!==!1,allowBackorder:$.allowBackorder||!1,allowPreorder:$.allowPreorder||!1,preorderDate:$.preorderDate||"",isFeatured:$.isFeatured||!1,isBestSeller:$.isBestSeller||!1,isNewArrival:$.isNewArrival||!1,warrantyPeriod:Number($.warrantyPeriod)||0,warrantyUnit:$.warrantyUnit||"MONTHS",returnPolicy:$.returnPolicy||"",shippingClass:$.shippingClass||"",seoTitle:$.seoTitle||"",seoDescription:$.seoDescription||"",metaKeywords:$.metaKeywords||"",status:($.status||"ACTIVE").toUpperCase(),customFields:typeof $.customFields=="string"?JSON.parse($.customFields||"{}"):$.customFields||{},images:typeof $.images=="string"?JSON.parse($.images||"[]"):$.images||[],variants:typeof $.variants=="string"?JSON.parse($.variants||"[]"):$.variants||[],relatedProducts:typeof $.relatedProducts=="string"?JSON.parse($.relatedProducts||"[]"):$.relatedProducts||[],upsellProducts:typeof $.upsellProducts=="string"?JSON.parse($.upsellProducts||"[]"):$.upsellProducts||[],crossSellProducts:typeof $.crossSellProducts=="string"?JSON.parse($.crossSellProducts||"[]"):$.crossSellProducts||[],brand:$.brand||"",model:$.model||"",visibility:$.visibility||"public",customField1:$.customField1||"",customField2:$.customField2||"",customField3:$.customField3||"",customField4:$.customField4||"",requiresLicense:$.requiresLicense||!1,hasExpiryDate:$.hasExpiryDate||!1,isBundle:$.isBundle||!1,notes:$.notes||""}),m(!0)},rs=async $=>{try{const Xt={type:"product",id:$.id,sku:$.sku,name:$.name,url:`${window.location.origin}/products/${$.id}`},ds=JSON.stringify(Xt),Us=await hx.toDataURL(ds,{width:256,margin:2,color:{dark:"#000000",light:"#FFFFFF"}});V(Us)}catch{dt({title:"Error",description:"Failed to generate QR code",variant:"destructive"})}},ms=async $=>{q($),A(!0),await rs($)},Bs=$=>{console.log("Viewing location data:",$),se($),N(!0)},Vs=$=>{se($),Ae({name:$.name||"",code:$.code||"",description:$.description||"",locationType:$.locationType||"WAREHOUSE",address:$.address||"",address2:$.address2||"",city:$.city||"",state:$.state||"",country:$.country||"",postalCode:$.postalCode||"",latitude:$.latitude||"",longitude:$.longitude||"",contactName:$.contactName||"",contactPhone:$.contactPhone||"",contactEmail:$.contactEmail||"",managerName:$.managerName||"",managerEmail:$.managerEmail||"",managerPhone:$.managerPhone||"",isActive:$.isActive!==void 0?$.isActive:!0,isDefault:$.isDefault!==void 0?$.isDefault:!1,capacity:$.capacity||"",timezone:$.timezone||"",operatingHours:$.operatingHours||"",specialInstructions:$.specialInstructions||"",warehouseZone:$.warehouseZone||"",temperatureControlled:$.temperatureControlled!==void 0?$.temperatureControlled:!1,securityLevel:$.securityLevel||"STANDARD",notes:$.notes||""}),b(!0)},Ws=$=>{be($),k(!0)},Ns=async()=>{var $;try{if(!Ee.productId||!Ee.quantity){dt({title:"Validation Error",description:"Product and quantity are required",variant:"destructive"});return}const Xt=Je.find(ds=>ds.id===Ee.productId);if(["OUTBOUND","TRANSFER_OUT","ADJUSTMENT_OUT","RETURN_OUT","DAMAGE","THEFT"].includes(Ee.movementType)){const ds=Number((Xt==null?void 0:Xt.stockQuantity)||0),Us=Math.abs(Ee.quantity);if(Us>ds){dt({title:"Insufficient Stock",description:`Available: ${ds}, Requested: ${Us}`,variant:"destructive"});return}}if(["INBOUND","OUTBOUND"].includes(Ee.movementType)&&(!Ee.unitCost||Ee.unitCost<=0)){dt({title:"Unit Cost Required",description:"Unit cost must be greater than 0 for INBOUND and OUTBOUND movements",variant:"destructive"});return}if(await Ra.createMovement({...Ee,movementDate:new Date(Ee.movementDate).toISOString()}),Ee.locationId)try{await Ra.createProductLocation({productId:Ee.productId,locationId:Ee.locationId,quantity:Ee.quantity})}catch{}dt({title:"Success",description:"Movement created successfully"}),$e({productId:"",movementType:"INBOUND",quantity:0,movementDate:new Date().toISOString().split("T")[0],reference:"",reason:"",unitCost:0,locationId:""}),S(!1),pt.invalidateQueries({queryKey:["movements"]}),pt.invalidateQueries({queryKey:["products"]}),pt.invalidateQueries({queryKey:["locations"]}),pt.invalidateQueries({queryKey:["analytics"]}),pt.invalidateQueries({queryKey:["kpis"]})}catch(Xt){console.error("Movement creation error:",Xt);let ds="Failed to create movement. Please try again.",Us="Error";if(($=Xt.response)!=null&&$.data){const H=Xt.response.data;H.error==="insufficient_stock"?(Us="Insufficient Stock",ds=H.message||"Not enough stock available for this movement."):H.error==="unit_cost_required"?(Us="Unit Cost Required",ds="Please enter a valid unit cost for this movement."):H.error==="invalid_quantity"?(Us="Invalid Quantity",ds="Movement quantity must be greater than 0."):H.error==="product_not_found"?(Us="Product Not Found",ds="The selected product was not found."):H.message&&(ds=H.message)}else Xt.message&&!Xt.message.includes("HTTP")&&(ds=Xt.message);dt({title:Us,description:ds,variant:"destructive"})}},er=()=>{pt.invalidateQueries({queryKey:["products"]}),pt.invalidateQueries({queryKey:["locations"]}),pt.invalidateQueries({queryKey:["movements"]}),pt.invalidateQueries({queryKey:["alerts"]}),pt.invalidateQueries({queryKey:["analytics"]}),pt.invalidateQueries({queryKey:["kpis"]}),pt.invalidateQueries({queryKey:["forecasts"]}),pt.invalidateQueries({queryKey:["insights"]}),pt.invalidateQueries({queryKey:["recommendations"]}),dt({title:"Refreshed",description:"All data has been refreshed"})},Ir=async()=>{try{const $=await Ra.generateAlerts(_e);dt({title:"Success",description:$.message}),pt.invalidateQueries({queryKey:["alerts"]})}catch($){dt({title:"Error",description:$.message||"Failed to generate alerts",variant:"destructive"})}},jn=async $=>{try{await Ra.acknowledgeAlert($),dt({title:"Success",description:"Alert acknowledged"}),pt.invalidateQueries({queryKey:["alerts"]})}catch(Xt){dt({title:"Error",description:Xt.message||"Failed to acknowledge alert",variant:"destructive"})}},Hs=async $=>{try{await Ra.dismissAlert($),dt({title:"Success",description:"Alert dismissed"}),pt.invalidateQueries({queryKey:["alerts"]})}catch(Xt){dt({title:"Error",description:Xt.message||"Failed to dismiss alert",variant:"destructive"})}},qr=async()=>{try{await Ra.updateAlertSettings(X),dt({title:"Success",description:"Alert settings saved successfully"}),K(!1),pt.invalidateQueries({queryKey:["alertSettings"]})}catch($){dt({title:"Error",description:$.message||"Failed to save alert settings",variant:"destructive"})}},qn=async()=>{var $;try{if(!fe.productId||!fe.toLocationId||!fe.quantity){dt({title:"Validation Error",description:"Product, destination location, and quantity are required",variant:"destructive"});return}await Ra.createTransfer({...fe,transferDate:new Date(fe.transferDate).toISOString(),status:fe.status}).catch(Xt=>{var ds;throw console.log("=== RAW API ERROR CAUGHT ====="),console.log("Error object:",Xt),console.log("Error message:",Xt.message),console.log("Error response:",Xt.response),console.log("Error response data:",(ds=Xt.response)==null?void 0:ds.data),console.log("Error details:",Xt.details),console.log("Error status:",Xt.status),console.log("================================"),Xt}),dt({title:"Success",description:"Transfer created successfully"}),ct({productId:"",fromLocationId:"",toLocationId:"",quantity:0,transferDate:new Date().toISOString().split("T")[0],reference:"",notes:"",requestedBy:""}),ue(!1),pt.invalidateQueries({queryKey:["transfers"]}),pt.invalidateQueries({queryKey:["products"]}),pt.invalidateQueries({queryKey:["locations"]})}catch(Xt){console.error("Transfer creation error:",Xt);let ds="Failed to create transfer",Us="Error";if(($=Xt.response)!=null&&$.data){const H=Xt.response.data;H.error==="insufficient_stock"?(Us="Insufficient Stock",ds=H.message||"Not enough stock available for this transfer."):H.error==="same_location_transfer"?(Us="Invalid Transfer",ds="Cannot transfer to the same location. Please select different locations."):H.error==="invalid_quantity"?(Us="Invalid Quantity",ds="Transfer quantity must be greater than 0."):H.error==="missing_required_fields"?(Us="Missing Information",ds="Please fill in all required fields."):H.message&&(ds=H.message)}else Xt.message&&!Xt.message.includes("HTTP")&&(ds=Xt.message);dt({title:Us,description:ds,variant:"destructive"})}},In=async($,Xt)=>{var ds;try{await Ra.updateTransferStatus($,Xt),dt({title:"Success",description:`Transfer ${Xt.toLowerCase()} successfully`}),pt.invalidateQueries({queryKey:["transfers"]}),pt.invalidateQueries({queryKey:["products"]}),pt.invalidateQueries({queryKey:["locations"]})}catch(Us){console.error("Transfer status update error:",Us);let H="Failed to update transfer status",Ce="Error";if((ds=Us.response)!=null&&ds.data){const Ge=Us.response.data;H=Ge.message||Ge.error||H,Ge.error==="insufficient_stock"?Ce="Insufficient Stock":Ge.error==="transfer_not_found"&&(Ce="Transfer Not Found")}else Us.message&&!Us.message.includes("HTTP")&&(H=Us.message);dt({title:Ce,description:H,variant:"destructive"})}},Yr=$=>{tt($),Le(!0)},$r=$=>{switch($){case"LOW_STOCK":return e.jsx(Is,{className:"w-4 h-4 text-amber-600"});case"OUT_OF_STOCK":return e.jsx(Is,{className:"w-4 h-4 text-red-600"});case"OVERSTOCK":return e.jsx($s,{className:"w-4 h-4 text-blue-600"});case"EXPIRING_SOON":return e.jsx(Xn,{className:"w-4 h-4 text-orange-600"});case"EXPIRED":return e.jsx(Xn,{className:"w-4 h-4 text-red-600"});default:return e.jsx(Hu,{className:"w-4 h-4 text-gray-600"})}},Vr=$=>{switch($){case"PENDING":return e.jsx(Oe,{variant:"secondary",children:"Pending"});case"IN_TRANSIT":return e.jsx(Oe,{variant:"default",children:"In Transit"});case"COMPLETED":return e.jsx(Oe,{variant:"default",className:"bg-green-100 text-green-800",children:"Completed"});case"CANCELLED":return e.jsx(Oe,{variant:"destructive",children:"Cancelled"});default:return e.jsx(Oe,{variant:"outline",children:$})}},wn=$=>{switch($){case"INBOUND":return e.jsx($s,{className:"w-4 h-4 text-green-600"});case"OUTBOUND":return e.jsx($s,{className:"w-4 h-4 text-red-600 rotate-180"});case"TRANSFER_IN":return e.jsx(Wd,{className:"w-4 h-4 text-blue-600"});case"TRANSFER_OUT":return e.jsx(Wd,{className:"w-4 h-4 text-blue-600 rotate-180"});case"ADJUSTMENT_IN":return e.jsx(Ss,{className:"w-4 h-4 text-green-600"});case"ADJUSTMENT_OUT":return e.jsx(Ss,{className:"w-4 h-4 text-red-600 rotate-45"});default:return e.jsx(Hr,{className:"w-4 h-4 text-gray-600"})}};return e.jsx(Kr,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-balance",children:" Inventory Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Advanced inventory tracking with multi-location support, serial numbers, and AI insights"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Ume,{onScan:$=>{t($),dt({title:"Barcode Scanned",description:`Searching for: ${$}`})},onProductFound:$=>{dt({title:"Product Found",description:`${$.name} (${$.sku})`})}}),e.jsx(J8e,{onImport:$=>{dt({title:"Import Successful",description:`Imported ${$.length} items`}),pt.invalidateQueries({queryKey:["products"]})},onExport:$=>{dt({title:"Export Started",description:`Exporting data in ${$.toUpperCase()} format`})}}),e.jsxs(I,{variant:"outline",onClick:er,children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Refresh"]}),e.jsxs(I,{onClick:()=>h(!0),children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Add Product"]})]})]}),et.isLoading?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[1,2,3,4].map($=>e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(kr,{size:"sm",color:"gray"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading..."}),e.jsx("p",{className:"text-xl font-bold",children:"-"})]})]})})},$))}):et.error?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx(Is,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Error loading analytics"}),e.jsx("p",{className:"text-xl font-bold",children:"-"})]})]})})})}):Ht?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Hr,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Products"}),e.jsx("p",{className:"text-xl font-bold",children:(Ht==null?void 0:Ht.totalProducts)||0})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(Mr,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Inventory Value"}),e.jsxs("p",{className:"text-xl font-bold",children:["$",((Ht==null?void 0:Ht.totalValue)||0).toLocaleString()]})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-lg flex items-center justify-center",children:e.jsx(Is,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Low Stock Items"}),e.jsx("p",{className:"text-xl font-bold",children:(Ht==null?void 0:Ht.lowStockItems)||0})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-red-600 font-semibold",children:"0"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Out of Stock"}),e.jsx("p",{className:"text-xl font-bold",children:(Ht==null?void 0:Ht.outOfStockItems)||0})]})]})})})]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(Hr,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Products"}),e.jsx("p",{className:"text-xl font-bold",children:(Je==null?void 0:Je.length)||0})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(Pa,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Locations"}),e.jsx("p",{className:"text-xl font-bold",children:(It==null?void 0:It.length)||0})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(Wd,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Movements"}),e.jsx("p",{className:"text-xl font-bold",children:(qt==null?void 0:qt.length)||0})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(Hu,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Alerts"}),e.jsx("p",{className:"text-xl font-bold",children:(As==null?void 0:As.length)||0})]})]})})})]}),lt.isLoading?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[1,2,3,4,5,6].map($=>e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(kr,{size:"sm",color:"gray"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading..."}),e.jsx("p",{className:"text-xl font-bold",children:"-"})]})]})})},$))}):lt.error?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx(Is,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Error loading KPIs"}),e.jsx("p",{className:"text-xl font-bold",children:"-"})]})]})})})}):xs?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(or,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Turnover Rate"}),e.jsxs("p",{className:"text-xl font-bold",children:[((Pe=xs==null?void 0:xs.inventoryTurnover)==null?void 0:Pe.toFixed(1))||"0.0","x"]})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(Xn,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Days in Stock"}),e.jsx("p",{className:"text-xl font-bold",children:((_t=xs==null?void 0:xs.averageDaysInStock)==null?void 0:_t.toFixed(0))||"0"})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx(Is,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Stockout Rate"}),e.jsxs("p",{className:"text-xl font-bold",children:[(((xs==null?void 0:xs.stockoutRate)||0)*100).toFixed(1),"%"]})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-lg flex items-center justify-center",children:e.jsx(Hr,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Overstock Rate"}),e.jsxs("p",{className:"text-xl font-bold",children:[(((xs==null?void 0:xs.overstockRate)||0)*100).toFixed(1),"%"]})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(lr,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Accuracy Rate"}),e.jsxs("p",{className:"text-xl font-bold",children:[(((xs==null?void 0:xs.accuracyRate)||0)*100).toFixed(1),"%"]})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4 ",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-cyan-100 rounded-lg flex items-center justify-center",children:e.jsx(Mr,{className:"w-5 h-5 text-cyan-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Carrying Cost"}),e.jsxs("p",{className:"text-md font-bold",children:["$",((bt=xs==null?void 0:xs.carryingCost)==null?void 0:bt.toFixed(0))||"0"]})]})]})})})]}):null,e.jsxs(an,{defaultValue:"products",className:"space-y-4",children:[e.jsxs(on,{className:"grid w-full grid-cols-9",children:[e.jsx(vt,{value:"products",children:"Products"}),e.jsx(vt,{value:"locations",children:"Locations"}),e.jsx(vt,{value:"movements",children:"Movements"}),e.jsx(vt,{value:"alerts",children:"Alerts"}),e.jsx(vt,{value:"transfers",children:"Transfers"}),e.jsx(vt,{value:"analytics",children:"Analytics"}),e.jsx(vt,{value:"advanced-analytics",children:"Advanced Analytics"}),e.jsx(vt,{value:"optimization",children:"Optimization"}),e.jsx(vt,{value:"ai-forecasting",children:"AI Forecasting"})]}),e.jsx(yt,{value:"products",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{children:"Product Inventory"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Rn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(ge,{placeholder:"Search products...",className:"pl-10 w-64",value:s,onChange:$=>t($.target.value)})]}),e.jsxs(rt,{value:r,onValueChange:n,children:[e.jsx(nt,{className:"w-40",children:e.jsx(it,{placeholder:"Category"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Categories"}),Gt.map($=>e.jsx(W,{value:$.id,children:$.name},$.id))]})]}),e.jsxs(rt,{value:a,onValueChange:i,children:[e.jsx(nt,{className:"w-40",children:e.jsx(it,{placeholder:"Location"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Locations"}),It.map($=>e.jsx(W,{value:$.id,children:$.name},$.id))]})]}),e.jsxs(rt,{value:o,onValueChange:l,children:[e.jsx(nt,{className:"w-40",children:e.jsx(it,{placeholder:"Status"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Status"}),e.jsx(W,{value:"ACTIVE",children:"Active"}),e.jsx(W,{value:"INACTIVE",children:"Inactive"}),e.jsx(W,{value:"DISCONTINUED",children:"Discontinued"})]})]}),e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(Ic,{className:"w-4 h-4 mr-2"}),"Filter"]})]})]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:At.isLoading?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(kr,{size:"md",color:"teal"}),e.jsx("span",{className:"text-sm text-gray-500 ml-3",children:"Loading products..."})]}):At.error?e.jsxs("div",{className:"flex items-center justify-center py-8 text-red-600",children:[e.jsx(Is,{className:"h-6 w-6 mr-2"}),e.jsxs("span",{className:"text-sm",children:["Error loading products: ",((ps=At.error)==null?void 0:ps.message)||((Pr=At.error)==null?void 0:Pr.toString())||"Unknown error"]})]}):(us==null?void 0:us.length)===0?e.jsxs("div",{className:"flex items-center justify-center py-8 text-gray-500",children:[e.jsx(Hr,{className:"h-8 w-8 mr-2"}),e.jsx("span",{className:"text-sm",children:"No products found"})]}):us.map($=>{var Xt;return e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(Hr,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:$.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[$.sku,"  ",((Xt=Gt.find(ds=>ds.id===$.categoryId))==null?void 0:Xt.name)||"Uncategorized"]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(Oe,{variant:"outline",className:"text-xs",children:($.type||"PRODUCT")==="PRODUCT"?"Inventory":"Non-Inventory"}),e.jsx(Oe,{variant:"outline",className:"text-xs",children:$.status})]})]})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-medium",children:$.stockQuantity}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Stock"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-medium",children:Number($.stockQuantity)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Available"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"font-medium",children:["$",Number($.unitPrice).toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Unit Price"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"font-medium",children:["$",(Number($.stockQuantity)*Number($.costPrice)).toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Value"})]}),We($),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>Et($),children:e.jsx(ir,{className:"w-4 h-4"})}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>Pt($),children:e.jsx(ln,{className:"w-4 h-4"})}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>ms($),children:e.jsx(dl,{className:"w-4 h-4"})})]})]})]},$.id)})})})]})}),e.jsx(yt,{value:"locations",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{children:"Warehouse Locations"}),e.jsxs(I,{onClick:()=>y(!0),children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Add Location"]})]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:It.map($=>{var Xt;return e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-cyan-100 rounded-lg flex items-center justify-center",children:e.jsx(Pa,{className:"w-5 h-5 text-cyan-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:$.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[$.code,"  ",$.type,"  ",$.address]}),$.isDefault&&e.jsx(Oe,{variant:"default",className:"text-xs mt-1",children:"Default"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-medium",children:((Xt=$._count)==null?void 0:Xt.products)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Products"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-medium",children:Je.filter(ds=>{var Us;return(Us=ds.locations)==null?void 0:Us.some(H=>H.locationId===$.id)}).reduce((ds,Us)=>{var Ce;const H=(Ce=Us.locations)==null?void 0:Ce.find(Ge=>Ge.locationId===$.id);return ds+Number((H==null?void 0:H.stockQuantity)||0)},0)}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Stock"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"font-medium",children:["$",Je.filter(ds=>{var Us;return(Us=ds.locations)==null?void 0:Us.some(H=>H.locationId===$.id)}).reduce((ds,Us)=>{var Ge;const H=(Ge=Us.locations)==null?void 0:Ge.find(ht=>ht.locationId===$.id),Ce=Number((H==null?void 0:H.stockQuantity)||0);return ds+Ce*Number(Us.costPrice||0)},0).toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Stock Value"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-medium",children:$._count.movements}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Movements"})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>Bs($),children:e.jsx(ir,{className:"w-4 h-4"})}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>Vs($),children:e.jsx(ln,{className:"w-4 h-4"})})]})]})]},$.id)})})})]})}),e.jsx(yt,{value:"movements",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{children:"Inventory Movements"}),e.jsxs(I,{onClick:()=>S(!0),children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"New Movement"]})]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:qt.map($=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:wn($.movementType)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:$.product.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[$.product.sku,"  ",$.movementType.replace("_"," ")]}),$.reason&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:$.reason})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:`font-medium ${$.quantity>0?"text-green-600":"text-red-600"}`,children:[$.quantity>0?"+":"",$.quantity]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Quantity"})]}),$.unitCost&&e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"font-medium",children:["$",Number($.unitCost||0).toFixed(2)]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Unit Cost"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-medium",children:new Date($.movementDate).toLocaleDateString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Date"})]}),$.location&&e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-medium",children:$.location.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Location"})]}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>Ws($),children:e.jsx(ir,{className:"w-4 h-4"})})]})]},$.id))})})]})}),e.jsx(yt,{value:"alerts",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{children:"Inventory Alerts"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{variant:"outline",onClick:Ir,disabled:zt.isLoading,children:zt.isLoading?e.jsxs(e.Fragment,{children:[e.jsx(kr,{size:"sm",className:"mr-2",color:"teal"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Generate Alerts"]})}),e.jsxs(I,{variant:"outline",onClick:()=>K(!0),children:[e.jsx(en,{className:"w-4 h-4 mr-2"}),"Alert Settings"]})]})]})}),e.jsx(ie,{children:zt.isLoading?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(kr,{size:"sm",color:"teal"}),e.jsx("span",{className:"text-sm text-muted-foreground ml-3",children:"Loading alerts..."})]}):(As==null?void 0:As.length)===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Hu,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium",children:"No alerts found"}),e.jsx("p",{className:"text-sm",children:"Generate alerts to see inventory warnings and recommendations"}),e.jsx(I,{className:"mt-4",onClick:Ir,disabled:zt.isLoading,children:zt.isLoading?e.jsxs(e.Fragment,{children:[e.jsx(kr,{size:"sm",className:"mr-2",color:"teal"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Generate Alerts"]})})]}):e.jsx("div",{className:"space-y-4",children:As.map($=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:$r($.alertType)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:$.product.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[$.product.sku,"  ",$.alertType.replace("_"," ")]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Current: ",$.product.stockQuantity,"  Threshold: ",$.threshold]}),$.message&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1 italic",children:$.message})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Oe,{variant:$.status==="PENDING"?"destructive":$.status==="ACKNOWLEDGED"?"secondary":"default",children:$.status}),$.location&&e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-medium",children:$.location.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Location"})]}),e.jsxs("div",{className:"flex gap-1",children:[$.status==="PENDING"&&e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>jn($.id),children:e.jsx(Ro,{className:"w-4 h-4"})}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>Hs($.id),children:e.jsx(ma,{className:"w-4 h-4"})})]})]})]},$.id))})})]})}),e.jsx(yt,{value:"transfers",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{children:"Inventory Transfers"}),e.jsxs(I,{onClick:()=>ue(!0),children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"New Transfer"]})]})}),e.jsx(ie,{children:St.isLoading?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(kr,{size:"sm",color:"teal"}),e.jsx("span",{className:"text-sm text-muted-foreground ml-3",children:"Loading transfers..."})]}):(js==null?void 0:js.length)===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Wd,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium",children:"No transfers found"}),e.jsx("p",{className:"text-sm",children:"Create your first inventory transfer between locations"}),e.jsxs(I,{className:"mt-4",onClick:()=>ue(!0),children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"New Transfer"]})]}):e.jsx("div",{className:"space-y-4",children:js.map($=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Wd,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:$.product.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[$.product.sku,"  ",$.quantity," units"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:$.fromLocation?`${$.fromLocation.name}  ${$.toLocation.name}`:` ${$.toLocation.name}`}),$.reference&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Ref: ",$.reference]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[Vr($.status),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-medium",children:new Date($.transferDate).toLocaleDateString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:$.requestedBy&&`by ${$.requestedBy}`})]}),e.jsxs("div",{className:"flex gap-1",children:[$.status==="PENDING"&&e.jsxs(e.Fragment,{children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>In($.id,"IN_TRANSIT"),children:e.jsx(Lj,{className:"w-4 h-4"})}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>In($.id,"CANCELLED"),children:e.jsx(ma,{className:"w-4 h-4"})})]}),$.status==="IN_TRANSIT"&&e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>In($.id,"COMPLETED"),children:e.jsx(Ro,{className:"w-4 h-4"})}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>Yr($),children:e.jsx(ir,{className:"w-4 h-4"})})]})]})]},$.id))})})]})}),e.jsx(yt,{value:"analytics",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx($s,{className:"w-5 h-5"}),"Top Products by Value"]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-3",children:((Ht==null?void 0:Ht.topProducts)||[]).slice(0,5).map(($,Xt)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-blue-600",children:Xt+1})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:$.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:$.sku})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium",children:["$",(Number($.stockQuantity)*Number($.costPrice)).toFixed(2)]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[Number($.stockQuantity)," units"]})]})]},$.id))})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Eo,{className:"w-5 h-5"}),"Category Breakdown"]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-3",children:((Ht==null?void 0:Ht.categoryBreakdown)||[]).length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No category data available"}):((Ht==null?void 0:Ht.categoryBreakdown)||[]).map(($,Xt)=>{var ds,Us;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:$.category||"Uncategorized"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[((ds=$._count)==null?void 0:ds.categoryId)||0," products"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium",children:((Us=$._sum)==null?void 0:Us.stockQuantity)||0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"units"})]})]},$.categoryId||`uncategorized-${Xt}`)})})})]})]})}),e.jsx(yt,{value:"advanced-analytics",className:"space-y-4",children:e.jsx(Y8e,{products:Je,movements:qt,locations:It,categories:Gt,alerts:As,analytics:Ht,kpis:xs,onRefresh:()=>{pt.invalidateQueries({queryKey:["products"]}),pt.invalidateQueries({queryKey:["movements"]}),pt.invalidateQueries({queryKey:["analytics"]}),pt.invalidateQueries({queryKey:["categories"]})}})}),e.jsx(yt,{value:"optimization",className:"space-y-4",children:e.jsx(X8e,{products:Je,movements:qt,locations:It,alerts:As,analytics:Ht,kpis:xs,onApplyRecommendation:$=>{dt({title:"Recommendation Applied",description:$.title})},onRefresh:()=>{pt.invalidateQueries({queryKey:["products"]}),pt.invalidateQueries({queryKey:["analytics"]}),pt.invalidateQueries({queryKey:["kpis"]})}})}),e.jsx(yt,{value:"ai-forecasting",className:"space-y-4",children:e.jsx(Q8e,{forecasts:Ct||[],insights:ke||{},recommendations:Array.isArray(gt)?gt:[],products:Je,movements:qt,alerts:As,onRefresh:()=>{pt.invalidateQueries({queryKey:["forecasts"]}),pt.invalidateQueries({queryKey:["insights"]}),pt.invalidateQueries({queryKey:["recommendations"]}),pt.invalidateQueries({queryKey:["alerts"]})}})})]}),e.jsx(ts,{open:u,onOpenChange:h,children:e.jsxs(ss,{className:"!max-w-7xl max-h-[95vh] overflow-y-auto w-[95vw] md:max-h-[90vh] md:w-[90vw] bg-gradient-to-br from-slate-50 to-slate-100/50",children:[e.jsxs(as,{className:"pb-6 border-b border-slate-200",children:[e.jsxs(is,{className:"flex items-center gap-3 text-2xl font-bold text-slate-800",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl text-white shadow-lg",children:e.jsx(Hr,{className:"w-6 h-6"})}),"Add New Product"]}),e.jsx(Ks,{className:"text-slate-600 text-base mt-2",children:"Create a comprehensive product profile with all essential details for your inventory and sales"}),e.jsxs("div",{className:"flex items-center justify-between mt-4 px-4 py-3 bg-white/50 rounded-lg border border-slate-200",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:"Step 1 of 6"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-slate-500",children:"Required fields marked with"}),e.jsx("span",{className:"text-red-500 font-bold",children:"*"})]})]})]}),e.jsxs(an,{defaultValue:"basic",className:"w-full mt-6",children:[e.jsxs(on,{className:"grid w-full grid-cols-6 bg-white shadow-sm border border-slate-200 rounded-xl p-1",children:[e.jsx(vt,{value:"basic",className:"data-[state=active]:bg-blue-500 data-[state=active]:text-white data-[state=active]:shadow-md transition-all duration-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Hr,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:block",children:"Basic Info"})]})}),e.jsx(vt,{value:"pricing",className:"data-[state=active]:bg-green-500 data-[state=active]:text-white data-[state=active]:shadow-md transition-all duration-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Mr,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:block",children:"Pricing"})]})}),e.jsx(vt,{value:"inventory",className:"data-[state=active]:bg-purple-500 data-[state=active]:text-white data-[state=active]:shadow-md transition-all duration-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(lr,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:block",children:"Inventory"})]})}),e.jsx(vt,{value:"shipping",className:"data-[state=active]:bg-orange-500 data-[state=active]:text-white data-[state=active]:shadow-md transition-all duration-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pa,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:block",children:"Shipping"})]})}),e.jsx(vt,{value:"seo",className:"data-[state=active]:bg-pink-500 data-[state=active]:text-white data-[state=active]:shadow-md transition-all duration-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($s,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:block",children:"Marketing"})]})}),e.jsx(vt,{value:"advanced",className:"data-[state=active]:bg-slate-600 data-[state=active]:text-white data-[state=active]:shadow-md transition-all duration-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(en,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:block",children:"Advanced"})]})})]}),e.jsxs(yt,{value:"basic",className:"space-y-8 mt-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Hr,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Essential Information"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Core product details required for identification"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(B,{htmlFor:"name",className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:["Product Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{id:"name",value:O.name,onChange:$=>te({...O,name:$.target.value}),placeholder:"e.g., MacBook Pro 14-inch",className:`pl-4 pr-4 py-3 text-base transition-all duration-200 ${(Wr=O.name)!=null&&Wr.trim()?"border-green-300 bg-green-50/30":"border-slate-300 focus:border-blue-400"}`}),((Zs=O.name)==null?void 0:Zs.trim())&&e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx(Ro,{className:"w-4 h-4 text-green-500"})})]}),e.jsx("p",{className:"text-xs text-slate-500",children:"This will be displayed to customers"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(B,{htmlFor:"sku",className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:["SKU (Stock Keeping Unit) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{id:"sku",value:O.sku,onChange:$=>te({...O,sku:$.target.value.toUpperCase()}),placeholder:"e.g., MBP-14-256-SLV",className:`pl-4 pr-12 py-3 text-base font-mono transition-all duration-200 ${(wr=O.sku)!=null&&wr.trim()?"border-green-300 bg-green-50/30":"border-slate-300 focus:border-blue-400"}`}),e.jsx(I,{type:"button",variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 -translate-y-1/2 h-8 w-8 p-0",onClick:()=>{const $=`PRD-${Date.now().toString().slice(-6)}`;te({...O,sku:$})},children:e.jsx(Ts,{className:"w-3 h-3"})})]}),e.jsx("p",{className:"text-xs text-slate-500",children:"Unique identifier for inventory tracking"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(Ic,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Product Classification"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Categorize and define your product type"})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"category",className:"text-sm font-medium text-slate-700",children:"Category"}),e.jsxs(rt,{value:O.categoryId||"",onValueChange:$=>{$==="create-new"?G(!0):te({...O,categoryId:$})},children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200",children:e.jsx(it,{placeholder:"Select a category"})}),e.jsxs(at,{children:[Gt.map($=>e.jsx(W,{value:$.id,className:"py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),$.name]})},$.id)),e.jsx(W,{value:"create-new",className:"py-3 border-t border-slate-200 mt-2",children:e.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[e.jsx(Ss,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Create New Category"})]})})]})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"type",className:"text-sm font-medium text-slate-700",children:"Product Type"}),e.jsxs(rt,{value:O.type,onValueChange:$=>te({...O,type:$}),children:[e.jsx(nt,{className:"py-4 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200 h-auto min-h-[60px]",children:e.jsx(it,{placeholder:"Select product type"})}),e.jsxs(at,{className:"w-full",children:[e.jsx(W,{value:"PRODUCT",className:"py-4 cursor-pointer hover:bg-blue-50",children:e.jsxs("div",{className:"flex items-center gap-4 w-full",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Hr,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-base text-slate-900",children:"Physical Product"}),e.jsx("div",{className:"text-sm text-slate-600 mt-1",children:"Tangible items that require shipping and inventory tracking"})]})]})}),e.jsx(W,{value:"SERVICE",className:"py-4 cursor-pointer hover:bg-purple-50",children:e.jsxs("div",{className:"flex items-center gap-4 w-full",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(en,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-base text-slate-900",children:"Service"}),e.jsx("div",{className:"text-sm text-slate-600 mt-1",children:"Time-based services, consultations, or labor"})]})]})}),e.jsx(W,{value:"DIGITAL",className:"py-4 cursor-pointer hover:bg-green-50",children:e.jsxs("div",{className:"flex items-center gap-4 w-full",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(or,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-base text-slate-900",children:"Digital Product"}),e.jsx("div",{className:"text-sm text-slate-600 mt-1",children:"Downloads, software, licenses, or digital content"})]})]})})]})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Choose the type that best describes your product for proper handling and display"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(ln,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Product Descriptions"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Help customers understand your product"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(B,{htmlFor:"shortDescription",className:"text-sm font-medium text-slate-700",children:["Short Description",e.jsx("span",{className:"ml-2 text-xs text-slate-500",children:"(appears in product listings)"})]}),e.jsx(ge,{id:"shortDescription",value:O.shortDescription,onChange:$=>te({...O,shortDescription:$.target.value}),placeholder:"Brief, compelling product summary...",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200",maxLength:160}),e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsx("span",{className:"text-slate-500",children:"Keep it concise and engaging"}),e.jsxs("span",{className:`${((xa=O.shortDescription)==null?void 0:xa.length)>140?"text-orange-500":"text-slate-400"}`,children:[((cr=O.shortDescription)==null?void 0:cr.length)||0,"/160"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(B,{htmlFor:"description",className:"text-sm font-medium text-slate-700",children:["Full Description",e.jsx("span",{className:"ml-2 text-xs text-slate-500",children:"(detailed product information)"})]}),e.jsx(Xs,{id:"description",value:O.description,onChange:$=>te({...O,description:$.target.value}),placeholder:"Detailed product description, features, benefits, specifications...",rows:4,className:"text-base resize-none border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Include features, benefits, and specifications customers need to know"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:e.jsx(dl,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Additional Details"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Tags, barcodes, and other identifiers"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(B,{htmlFor:"tags",className:"text-sm font-medium text-slate-700",children:["Tags",e.jsx("span",{className:"ml-2 text-xs text-slate-500",children:"(for search and filtering)"})]}),e.jsx(ge,{id:"tags",value:O.tags,onChange:$=>te({...O,tags:$.target.value}),placeholder:"laptop, electronics, apple, premium",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Separate tags with commas - helps customers find your product"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(B,{htmlFor:"barcode",className:"text-sm font-medium text-slate-700",children:["Barcode/UPC",e.jsx("span",{className:"ml-2 text-xs text-slate-500",children:"(optional)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ge,{id:"barcode",value:O.barcode,onChange:$=>te({...O,barcode:$.target.value}),placeholder:"Enter or scan barcode",className:"py-3 text-base font-mono border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"}),e.jsx(I,{type:"button",variant:"outline",size:"sm",className:"px-4 py-3",children:e.jsx(dl,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-xs text-slate-500",children:"For inventory scanning and POS systems"})]})]})]})]}),e.jsxs(yt,{value:"pricing",className:"space-y-8 mt-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Mr,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Pricing Information"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Set your selling price and cost structure"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(B,{htmlFor:"unitPrice",className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:["Selling Price ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 font-medium",children:"$"}),e.jsx(ge,{id:"unitPrice",type:"number",step:"0.01",min:"0",value:O.unitPrice||"",onChange:$=>te({...O,unitPrice:parseFloat($.target.value)||0}),placeholder:"0.00",className:`pl-8 pr-4 py-3 text-base font-semibold transition-all duration-200 ${O.unitPrice>0?"border-green-300 bg-green-50/30":"border-slate-300 focus:border-green-400"}`})]}),e.jsx("p",{className:"text-xs text-slate-500",children:"The price customers will pay"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(B,{htmlFor:"costPrice",className:"text-sm font-medium text-slate-700",children:["Cost Price",e.jsx("span",{className:"ml-2 text-xs text-slate-500",children:"(your cost)"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 font-medium",children:"$"}),e.jsx(ge,{id:"costPrice",type:"number",step:"0.01",min:"0",value:O.costPrice||"",onChange:$=>te({...O,costPrice:parseFloat($.target.value)||0}),placeholder:"0.00",className:"pl-8 pr-4 py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsx("p",{className:"text-xs text-slate-500",children:"What you pay for this product"})]})]}),O.unitPrice>0&&O.costPrice>0&&e.jsx("div",{className:"mt-6 p-4 bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-800",children:"Profit Analysis"}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"text-slate-600",children:"Profit: "}),e.jsxs("span",{className:"font-semibold text-green-600",children:["$",(O.unitPrice-O.costPrice).toFixed(2)]})]}),e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"text-slate-600",children:"Margin: "}),e.jsxs("span",{className:"font-semibold text-blue-600",children:[((O.unitPrice-O.costPrice)/O.unitPrice*100).toFixed(1),"%"]})]})]})]}),e.jsx(Eo,{className:"w-6 h-6 text-blue-600"})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(yn,{className:"w-5 h-5 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Tax Configuration"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Set up tax rates and preferences"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"taxRate",className:"text-sm font-medium text-slate-700",children:"Tax Rate"}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{id:"taxRate",type:"number",step:"0.01",min:"0",max:"100",value:O.taxRate||"",onChange:$=>te({...O,taxRate:parseFloat($.target.value)||0}),placeholder:"0.00",className:"pr-8 py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 font-medium",children:"%"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"taxCode",className:"text-sm font-medium text-slate-700",children:"Tax Code"}),e.jsxs(rt,{value:O.taxCode||"",onValueChange:$=>te({...O,taxCode:$}),children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200",children:e.jsx(it,{placeholder:"Select tax code"})}),e.jsxs(at,{children:[e.jsx(W,{value:"STANDARD",children:"Standard Tax"}),e.jsx(W,{value:"GST",children:"GST (Goods & Services Tax)"}),e.jsx(W,{value:"VAT",children:"VAT (Value Added Tax)"}),e.jsx(W,{value:"SALES_TAX",children:"Sales Tax"}),e.jsx(W,{value:"EXCISE",children:"Excise Tax"}),e.jsx(W,{value:"IMPORT_DUTY",children:"Import Duty"}),e.jsx(W,{value:"LUXURY_TAX",children:"Luxury Tax"}),e.jsx(W,{value:"ZERO_RATED",children:"Zero-Rated"}),e.jsx(W,{value:"EXEMPT",children:"Tax Exempt"})]})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Classification for tax reporting and compliance"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Tax Configuration"}),e.jsxs("div",{className:"flex items-center gap-3 p-3 border border-slate-200 rounded-lg",children:[e.jsx("input",{type:"checkbox",id:"taxInclusive",checked:O.taxInclusive,onChange:$=>te({...O,taxInclusive:$.target.checked}),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"taxInclusive",className:"text-sm font-medium cursor-pointer",children:"Price includes tax"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Tax is already included in the selling price"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Tax Exemption"}),e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"taxExempt",checked:O.taxExempt,onChange:$=>te({...O,taxExempt:$.target.checked}),className:"w-5 h-5 text-blue-600 bg-white border-2 border-slate-300 rounded focus:ring-blue-500 focus:ring-2 cursor-pointer"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(B,{htmlFor:"taxExempt",className:"text-sm font-medium cursor-pointer text-slate-800",children:"Tax exempt product"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"This product is exempt from all taxes"})]})]})]})]}),O.unitPrice>0&&e.jsxs("div",{className:"mt-6 p-4 bg-gradient-to-br from-yellow-50 to-amber-50 rounded-lg border border-yellow-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(yn,{className:"w-4 h-4 text-yellow-600"}),e.jsx("h4",{className:"text-sm font-semibold text-slate-800",children:"Tax Calculation Preview"}),O.taxCode&&e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded-full",children:O.taxCode})]}),O.taxExempt?e.jsxs("div",{className:"text-center py-3",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-2 bg-green-100 text-green-800 rounded-lg",children:[e.jsx(kn,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Tax Exempt Product"})]}),e.jsx("p",{className:"text-sm text-slate-600 mt-2",children:"No tax will be applied to this product"})]}):O.taxRate>0?e.jsx("div",{className:"grid grid-cols-2 gap-4 text-sm",children:O.taxInclusive?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600",children:"Price (tax inclusive): "}),e.jsxs("span",{className:"font-semibold",children:["$",Number(O.unitPrice).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-slate-600",children:["Tax amount (",O.taxRate,"%): "]}),e.jsxs("span",{className:"font-semibold text-yellow-600",children:["$",(Number(O.unitPrice)*Number(O.taxRate)/(100+Number(O.taxRate))).toFixed(2)]})]}),e.jsxs("div",{className:"col-span-2 pt-2 border-t border-yellow-200",children:[e.jsx("span",{className:"text-slate-600",children:"Net price (excluding tax): "}),e.jsxs("span",{className:"font-bold text-slate-800",children:["$",(Number(O.unitPrice)-Number(O.unitPrice)*Number(O.taxRate)/(100+Number(O.taxRate))).toFixed(2)]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600",children:"Base price: "}),e.jsxs("span",{className:"font-semibold",children:["$",Number(O.unitPrice).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-slate-600",children:["Tax amount (",O.taxRate,"%): "]}),e.jsxs("span",{className:"font-semibold text-yellow-600",children:["$",(Number(O.unitPrice)*(Number(O.taxRate)/100)).toFixed(2)]})]}),e.jsxs("div",{className:"col-span-2 pt-2 border-t border-yellow-200",children:[e.jsx("span",{className:"text-slate-600",children:"Total price (including tax): "}),e.jsxs("span",{className:"font-bold text-slate-800",children:["$",(Number(O.unitPrice)*(1+Number(O.taxRate)/100)).toFixed(2)]})]})]})}):e.jsxs("div",{className:"text-center py-3",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-2 bg-slate-100 text-slate-600 rounded-lg",children:[e.jsx(Ln,{className:"w-4 h-4"}),e.jsx("span",{children:"No tax rate specified"})]}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Enter a tax rate to see calculations"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-pink-100 rounded-lg",children:e.jsx($s,{className:"w-5 h-5 text-pink-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Marketing & Promotion"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Set special product badges and promotion flags"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"isFeatured",checked:O.isFeatured,onChange:$=>te({...O,isFeatured:$.target.checked}),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("div",{children:[e.jsxs(B,{htmlFor:"isFeatured",className:"text-sm font-medium cursor-pointer flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"Featured Product"]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Highlight in featured sections"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"isBestSeller",checked:O.isBestSeller,onChange:$=>te({...O,isBestSeller:$.target.checked}),className:"w-4 h-4 text-green-600 bg-gray-100 border-gray-300 rounded focus:ring-green-500"}),e.jsxs("div",{children:[e.jsxs(B,{htmlFor:"isBestSeller",className:"text-sm font-medium cursor-pointer flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),"Best Seller"]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Popular choice badge"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"isNewArrival",checked:O.isNewArrival,onChange:$=>te({...O,isNewArrival:$.target.checked}),className:"w-4 h-4 text-purple-600 bg-gray-100 border-gray-300 rounded focus:ring-purple-500"}),e.jsxs("div",{children:[e.jsxs(B,{htmlFor:"isNewArrival",className:"text-sm font-medium cursor-pointer flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),"New Arrival"]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Recently added product"})]})]})]})]})]}),e.jsxs(yt,{value:"inventory",className:"space-y-8 mt-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(lr,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Stock Management"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Set initial stock and inventory thresholds"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"stockQuantity",className:"text-sm font-medium text-slate-700",children:"Initial Stock Quantity"}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{id:"stockQuantity",type:"number",min:"0",step:"1",value:O.stockQuantity||"",onChange:$=>te({...O,stockQuantity:parseFloat($.target.value)||0}),placeholder:"0",className:"pr-12 py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 text-sm",children:"units"})]}),e.jsx("p",{className:"text-xs text-slate-500",children:"How many units you currently have in stock"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(B,{htmlFor:"reorderPoint",className:"text-sm font-medium text-slate-700",children:["Reorder Point",e.jsx("span",{className:"ml-2 text-xs text-slate-500",children:"(alert threshold)"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{id:"reorderPoint",type:"number",min:"0",step:"1",value:O.reorderPoint||"",onChange:$=>te({...O,reorderPoint:parseFloat($.target.value)||0}),placeholder:"0",className:"pr-12 py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 text-sm",children:"units"})]}),e.jsx("p",{className:"text-xs text-slate-500",children:"Get notified when stock reaches this level"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"minStockLevel",className:"text-sm font-medium text-slate-700",children:"Minimum Stock Level"}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{id:"minStockLevel",type:"number",min:"0",step:"1",value:O.minStockLevel||"",onChange:$=>te({...O,minStockLevel:parseFloat($.target.value)||0}),placeholder:"0",className:"pr-12 py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 text-sm",children:"units"})]}),e.jsx("p",{className:"text-xs text-slate-500",children:"Never let stock go below this amount"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(B,{htmlFor:"maxStockLevel",className:"text-sm font-medium text-slate-700",children:["Maximum Stock Level",e.jsx("span",{className:"ml-2 text-xs text-slate-500",children:"(storage capacity)"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{id:"maxStockLevel",type:"number",min:"0",step:"1",value:O.maxStockLevel||"",onChange:$=>te({...O,maxStockLevel:parseFloat($.target.value)||0}),placeholder:"0",className:"pr-12 py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 text-sm",children:"units"})]}),e.jsx("p",{className:"text-xs text-slate-500",children:"Maximum units you can store"})]})]}),O.stockQuantity>0&&O.reorderPoint>0&&e.jsxs("div",{className:"mt-6 p-4 bg-gradient-to-br from-slate-50 to-slate-100 rounded-lg border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-800",children:"Stock Status"}),e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${O.stockQuantity<=O.reorderPoint?"bg-red-100 text-red-700":O.stockQuantity<=O.reorderPoint*2?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:O.stockQuantity<=O.reorderPoint?"Low Stock":O.stockQuantity<=O.reorderPoint*2?"Normal":"Well Stocked"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-slate-600",children:"Current:"}),e.jsxs("span",{className:"font-semibold",children:[O.stockQuantity," units"]}),e.jsx("span",{className:"text-slate-400",children:""}),e.jsx("span",{className:"text-slate-600",children:"Reorder at:"}),e.jsxs("span",{className:"font-semibold",children:[O.reorderPoint," units"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(en,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Inventory Settings"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Configure how this product behaves in inventory"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"trackInventory",checked:O.trackInventory,onChange:$=>te({...O,trackInventory:$.target.checked}),className:"w-5 h-5 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs(B,{htmlFor:"trackInventory",className:"text-sm font-medium cursor-pointer flex items-center gap-2",children:[e.jsx(or,{className:"w-4 h-4 text-blue-600"}),"Track Inventory"]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Monitor stock levels and movements for this product"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"allowBackorder",checked:O.allowBackorder,onChange:$=>te({...O,allowBackorder:$.target.checked}),className:"w-5 h-5 text-orange-600 bg-gray-100 border-gray-300 rounded focus:ring-orange-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs(B,{htmlFor:"allowBackorder",className:"text-sm font-medium cursor-pointer flex items-center gap-2",children:[e.jsx(Wd,{className:"w-4 h-4 text-orange-600"}),"Allow Backorder"]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Customers can order even when out of stock"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"allowPreorder",checked:O.allowPreorder,onChange:$=>te({...O,allowPreorder:$.target.checked}),className:"w-5 h-5 text-purple-600 bg-gray-100 border-gray-300 rounded focus:ring-purple-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs(B,{htmlFor:"allowPreorder",className:"text-sm font-medium cursor-pointer flex items-center gap-2",children:[e.jsx(Xn,{className:"w-4 h-4 text-purple-600"}),"Allow Preorder"]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Accept orders before product becomes available"})]})]})]})]}),O.allowPreorder&&e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(Xn,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Preorder Configuration"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Set when this product will become available"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"preorderDate",className:"text-sm font-medium text-slate-700",children:"Available From Date"}),e.jsx(ge,{id:"preorderDate",type:"date",value:O.preorderDate,onChange:$=>te({...O,preorderDate:$.target.value}),min:new Date().toISOString().split("T")[0],className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Customers will be notified when the product becomes available"})]}),O.preorderDate&&e.jsx("div",{className:"mt-4 p-3 bg-purple-50 rounded-lg border border-purple-200",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Hu,{className:"w-4 h-4 text-purple-600"}),e.jsxs("span",{className:"text-purple-800 font-medium",children:["Product will be available on ",new Date(O.preorderDate).toLocaleDateString()]})]})})]})]}),e.jsxs(yt,{value:"shipping",className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"weight",children:"Weight (kg)"}),e.jsx(ge,{id:"weight",type:"number",step:"0.01",value:O.weight,onChange:$=>te({...O,weight:parseFloat($.target.value)||0}),placeholder:"0.00",className:"border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Dimensions (cm)"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"length",children:"Length"}),e.jsx(ge,{id:"length",type:"number",step:"0.01",value:((Zn=O.dimensions)==null?void 0:Zn.length)||0,onChange:$=>{var Xt,ds;return te({...O,dimensions:{...O.dimensions,length:parseFloat($.target.value)||0,width:((Xt=O.dimensions)==null?void 0:Xt.width)||0,height:((ds=O.dimensions)==null?void 0:ds.height)||0}})},placeholder:"0.00",className:"border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"width",children:"Width"}),e.jsx(ge,{id:"width",type:"number",step:"0.01",value:((Hi=O.dimensions)==null?void 0:Hi.width)||0,onChange:$=>{var Xt,ds;return te({...O,dimensions:{...O.dimensions,width:parseFloat($.target.value)||0,length:((Xt=O.dimensions)==null?void 0:Xt.length)||0,height:((ds=O.dimensions)==null?void 0:ds.height)||0}})},placeholder:"0.00",className:"border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"height",children:"Height"}),e.jsx(ge,{id:"height",type:"number",step:"0.01",value:((Gi=O.dimensions)==null?void 0:Gi.height)||0,onChange:$=>{var Xt,ds;return te({...O,dimensions:{...O.dimensions,width:((Xt=O.dimensions)==null?void 0:Xt.width)||0,length:((ds=O.dimensions)==null?void 0:ds.length)||0,height:parseFloat($.target.value)||0}})},placeholder:"0.00",className:"border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"shippingClass",children:"Shipping Class"}),e.jsxs(rt,{value:O.shippingClass,onValueChange:$=>te({...O,shippingClass:$}),children:[e.jsx(nt,{className:"border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200",children:e.jsx(it,{placeholder:"Select shipping class"})}),e.jsxs(at,{children:[e.jsx(W,{value:"standard",children:"Standard"}),e.jsx(W,{value:"express",children:"Express"}),e.jsx(W,{value:"overnight",children:"Overnight"}),e.jsx(W,{value:"fragile",children:"Fragile"}),e.jsx(W,{value:"hazardous",children:"Hazardous"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Product Type Flags"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"isPhysical",checked:O.isPhysical,onChange:$=>te({...O,isPhysical:$.target.checked}),className:"rounded"}),e.jsx(B,{htmlFor:"isPhysical",className:"text-sm",children:"Physical Product"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"isDigital",checked:O.isDigital,onChange:$=>te({...O,isDigital:$.target.checked}),className:"rounded"}),e.jsx(B,{htmlFor:"isDigital",className:"text-sm",children:"Digital Product"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"isService",checked:O.isService,onChange:$=>te({...O,isService:$.target.checked}),className:"rounded"}),e.jsx(B,{htmlFor:"isService",className:"text-sm",children:"Service"})]})]})]})]}),e.jsxs(yt,{value:"seo",className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"seoTitle",children:"SEO Title"}),e.jsx(ge,{id:"seoTitle",value:O.seoTitle,onChange:$=>te({...O,seoTitle:$.target.value}),placeholder:"SEO optimized title",className:"border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"seoDescription",children:"SEO Description"}),e.jsx(Xs,{id:"seoDescription",value:O.seoDescription,onChange:$=>te({...O,seoDescription:$.target.value}),placeholder:"SEO meta description",rows:3,className:"border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"metaKeywords",children:"Meta Keywords"}),e.jsx(ge,{id:"metaKeywords",value:O.metaKeywords,onChange:$=>te({...O,metaKeywords:$.target.value}),placeholder:"Keywords separated by commas",className:"border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]})]}),e.jsxs(yt,{value:"advanced",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"warrantyPeriod",children:"Warranty Period"}),e.jsx(ge,{id:"warrantyPeriod",type:"number",value:O.warrantyPeriod,onChange:$=>te({...O,warrantyPeriod:parseFloat($.target.value)||0}),placeholder:"0",className:"border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"warrantyUnit",children:"Warranty Unit"}),e.jsxs(rt,{value:O.warrantyUnit,onValueChange:$=>te({...O,warrantyUnit:$}),children:[e.jsx(nt,{className:"border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"DAYS",children:"Days"}),e.jsx(W,{value:"WEEKS",children:"Weeks"}),e.jsx(W,{value:"MONTHS",children:"Months"}),e.jsx(W,{value:"YEARS",children:"Years"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"returnPolicy",children:"Return Policy"}),e.jsx(Xs,{id:"returnPolicy",value:O.returnPolicy,onChange:$=>te({...O,returnPolicy:$.target.value}),placeholder:"Return policy details",rows:3,className:"border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"status",children:"Status"}),e.jsxs(rt,{value:O.status,onValueChange:$=>te({...O,status:$}),children:[e.jsx(nt,{className:"border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"ACTIVE",children:"Active"}),e.jsx(W,{value:"INACTIVE",children:"Inactive"}),e.jsx(W,{value:"DISCONTINUED",children:"Discontinued"}),e.jsx(W,{value:"DRAFT",children:"Draft"})]})]})]})]})]}),e.jsxs("div",{className:"sticky bottom-0 bg-white border-t border-slate-200 px-6 py-4 mt-8",children:[e.jsxs("div",{className:"mb-4",children:[(!((Ti=O.name)!=null&&Ti.trim())||!((Ea=O.sku)!=null&&Ea.trim())||O.unitPrice<=0)&&e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-red-50 border border-red-200 rounded-lg mb-4",children:[e.jsx(Is,{className:"w-4 h-4 text-red-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium text-red-800 mb-1",children:"Please complete required fields:"}),e.jsxs("ul",{className:"text-red-700 space-y-1",children:[!((Ki=O.name)!=null&&Ki.trim())&&e.jsx("li",{children:" Product name is required"}),!((mi=O.sku)!=null&&mi.trim())&&e.jsx("li",{children:" SKU is required"}),O.unitPrice<=0&&e.jsx("li",{children:" Selling price must be greater than 0"})]})]})]}),((Da=O.name)==null?void 0:Da.trim())&&((fi=O.sku)==null?void 0:fi.trim())&&O.unitPrice>0&&e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-50 border border-green-200 rounded-lg mb-4",children:[e.jsx(Ro,{className:"w-4 h-4 text-green-500"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium text-green-800",children:"Ready to create product"}),e.jsx("div",{className:"text-green-700",children:"All required information has been provided"})]})]})]}),e.jsxs(Xr,{className:"gap-3",children:[e.jsxs(I,{variant:"outline",onClick:()=>h(!1),className:"px-6 py-2.5 text-base font-medium",children:[e.jsx(ma,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(I,{disabled:!((qa=O.name)!=null&&qa.trim())||!((Ne=O.sku)!=null&&Ne.trim())||O.unitPrice<=0||O.costPrice<0||O.stockQuantity<0||!((Dt=O.status)!=null&&Dt.trim()),className:"px-6 py-2.5 text-base font-medium bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",onClick:async()=>{var $,Xt,ds,Us,H,Ce,Ge,ht,wt,Qt,vs,Js;try{if(!(($=O.name)!=null&&$.trim())){dt({title:"Validation Error",description:"Product name is required",variant:"destructive"});return}if(!((Xt=O.sku)!=null&&Xt.trim())){dt({title:"Validation Error",description:"SKU is required",variant:"destructive"});return}if(O.unitPrice<=0){dt({title:"Validation Error",description:"Unit price must be greater than 0",variant:"destructive"});return}if(O.costPrice<0){dt({title:"Validation Error",description:"Cost price cannot be negative",variant:"destructive"});return}if(O.stockQuantity<0){dt({title:"Validation Error",description:"Stock quantity cannot be negative",variant:"destructive"});return}if(!((ds=O.status)!=null&&ds.trim())){dt({title:"Validation Error",description:"Product status is required",variant:"destructive"});return}(!O.categoryId||O.categoryId==="")&&dt({title:"Validation Warning",description:"No category selected. Product will be marked as uncategorized.",variant:"default"}),await Ra.createProduct({...O,companyId:_e,type:"PRODUCT",unitPrice:O.unitPrice,costPrice:O.costPrice,stockQuantity:O.stockQuantity,availableQuantity:O.stockQuantity,reservedQuantity:0,trackSerialNumbers:!1,trackBatches:!1,costingMethod:"WEIGHTED_AVERAGE",taxInclusive:O.taxInclusive,taxExempt:O.taxExempt,warrantyUnit:O.warrantyUnit,status:O.status.toUpperCase(),images:JSON.stringify(O.images||[]),variants:JSON.stringify(O.variants||[]),relatedProducts:JSON.stringify(O.relatedProducts||[]),upsellProducts:JSON.stringify(O.upsellProducts||[]),crossSellProducts:JSON.stringify(O.crossSellProducts||[]),customFields:JSON.stringify(O.customFields||{}),dimensionsLength:((Us=O.dimensions)==null?void 0:Us.length)||0,dimensionsWidth:((H=O.dimensions)==null?void 0:H.width)||0,dimensionsHeight:((Ce=O.dimensions)==null?void 0:Ce.height)||0,dimensions:void 0}),dt({title:"Success",description:"Product created successfully"}),te({name:"",sku:"",description:"",shortDescription:"",unitPrice:0,costPrice:0,stockQuantity:0,minStockLevel:0,maxStockLevel:0,reorderPoint:0,category:"",categoryId:"",status:"ACTIVE",type:"PRODUCT",weight:0,dimensions:{length:0,width:0,height:0},taxRate:0,taxInclusive:!1,taxCode:"",taxExempt:!1,barcode:"",tags:"",seoTitle:"",seoDescription:"",metaKeywords:"",isDigital:!1,isService:!1,isPhysical:!0,trackInventory:!0,allowBackorder:!1,allowPreorder:!1,preorderDate:"",warrantyPeriod:0,warrantyUnit:"MONTHS",returnPolicy:"",shippingClass:"",isFeatured:!1,isBestSeller:!1,isNewArrival:!1,customFields:{},images:[],variants:[],relatedProducts:[],upsellProducts:[],crossSellProducts:[],brand:"",model:"",visibility:"public",customField1:"",customField2:"",customField3:"",customField4:"",requiresLicense:!1,hasExpiryDate:!1,isBundle:!1,notes:""}),h(!1),pt.invalidateQueries({queryKey:["products"]}),pt.invalidateQueries({queryKey:["categories"]}),pt.invalidateQueries({queryKey:["analytics"]}),pt.invalidateQueries({queryKey:["kpis"]})}catch(je){console.error("Error creating product:",je);let Ot="Failed to create product. Please try again.";console.log("Full error object:",{status:(Ge=je==null?void 0:je.response)==null?void 0:Ge.status,data:(ht=je==null?void 0:je.response)==null?void 0:ht.data,message:je==null?void 0:je.message,stack:je==null?void 0:je.stack}),((wt=je==null?void 0:je.response)==null?void 0:wt.status)===409||(Qt=je==null?void 0:je.message)!=null&&Qt.includes("409")?Ot=`A product with SKU "${O.sku}" already exists. Please use a different SKU.`:((vs=je==null?void 0:je.response)==null?void 0:vs.status)===400||(Js=je==null?void 0:je.message)!=null&&Js.includes("400")?Ot="Invalid product data. Please check your inputs and try again.":je!=null&&je.message&&(Ot=je.message),dt({title:"Error Creating Product",description:Ot,variant:"destructive"})}},children:[e.jsx(Hr,{className:"w-4 h-4 mr-2"}),"Create Product"]})]})]})]})}),e.jsx(ts,{open:p,onOpenChange:g,children:e.jsxs(ss,{className:"!max-w-7xl max-h-[95vh] overflow-y-auto w-[95vw] md:max-h-[90vh] md:w-[90vw] bg-gradient-to-br from-slate-50 to-slate-100/50",children:[e.jsxs(as,{className:"pb-6 border-b border-slate-200",children:[e.jsxs(is,{className:"flex items-center gap-3 text-2xl font-bold text-slate-800",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-green-500 to-green-600 rounded-xl text-white shadow-lg",children:e.jsx(ir,{className:"w-6 h-6"})}),"Product Details"]}),e.jsx(Ks,{className:"text-slate-600 text-base mt-2",children:"Comprehensive view of product information and analytics"})]}),P&&e.jsxs("div",{className:"space-y-8 mt-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Hr,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Essential Information"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Core product details and identification"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Product Name"}),e.jsx("div",{className:"p-3 bg-slate-50 border border-slate-200 rounded-lg",children:e.jsx("p",{className:"text-base font-semibold text-slate-900",children:P.name})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"SKU (Stock Keeping Unit)"}),e.jsx("div",{className:"p-3 bg-slate-50 border border-slate-200 rounded-lg",children:e.jsx("p",{className:"text-base font-mono text-slate-900",children:P.sku})})]})]}),P.description&&e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Description"}),e.jsx("div",{className:"p-4 bg-slate-50 border border-slate-200 rounded-lg",children:e.jsx("p",{className:"text-base text-slate-900 leading-relaxed",children:P.description})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Mr,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Pricing & Financial Information"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Costs, pricing, and profit analysis"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Selling Price"}),e.jsx("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("p",{className:"text-xl font-bold text-green-700",children:["$",Number(P.unitPrice).toFixed(2)]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Cost Price"}),e.jsx("div",{className:"p-3 bg-slate-50 border border-slate-200 rounded-lg",children:e.jsxs("p",{className:"text-xl font-semibold text-slate-700",children:["$",Number(P.costPrice).toFixed(2)]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Profit per Unit"}),e.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("p",{className:"text-xl font-bold text-blue-700",children:["$",(Number(P.unitPrice)-Number(P.costPrice)).toFixed(2)]}),e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[((Number(P.unitPrice)-Number(P.costPrice))/Number(P.unitPrice)*100).toFixed(1),"% margin"]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(lr,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Inventory & Stock Information"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Current stock levels and inventory value"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Current Stock Quantity"}),e.jsx("div",{className:"p-4 bg-purple-50 border border-purple-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-2xl font-bold text-purple-700",children:Number(P.stockQuantity)}),e.jsx("span",{className:"text-sm text-purple-600 font-medium",children:"units"})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Total Inventory Value"}),e.jsx("div",{className:"p-4 bg-indigo-50 border border-indigo-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-2xl font-bold text-indigo-700",children:["$",(Number(P.stockQuantity)*Number(P.costPrice)).toFixed(2)]}),e.jsx("span",{className:"text-sm text-indigo-600 font-medium",children:"total value"})]})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:e.jsx(Ic,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Classification & Status"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Category, type, and current status"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Category"}),e.jsx("div",{className:"p-3 bg-orange-50 border border-orange-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-500"}),e.jsx("p",{className:"text-base font-medium text-orange-800",children:((ye=Gt.find($=>$.id===P.categoryId))==null?void 0:ye.name)||"Uncategorized"})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Product Type"}),e.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[P.type==="PRODUCT"&&e.jsx(Hr,{className:"w-4 h-4 text-blue-600"}),P.type==="SERVICE"&&e.jsx(en,{className:"w-4 h-4 text-purple-600"}),P.type==="DIGITAL"&&e.jsx(or,{className:"w-4 h-4 text-green-600"}),e.jsx("p",{className:"text-base font-medium text-slate-800",children:P.type==="PRODUCT"?"Physical Product":P.type==="SERVICE"?"Service":"Digital Product"})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Status"}),e.jsx("div",{className:"p-3 bg-slate-50 border border-slate-200 rounded-lg",children:e.jsx("div",{className:`inline-flex px-2 py-1 rounded-full text-sm font-medium ${P.status==="ACTIVE"?"bg-green-100 text-green-800":P.status==="INACTIVE"?"bg-red-100 text-red-800":P.status==="DRAFT"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:P.status})})]})]}),(P.brand||P.model||P.tags)&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6",children:[P.brand&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Brand"}),e.jsx("div",{className:"p-3 bg-slate-50 border border-slate-200 rounded-lg",children:e.jsx("p",{className:"text-base font-medium text-slate-800",children:P.brand})})]}),P.model&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Model"}),e.jsx("div",{className:"p-3 bg-slate-50 border border-slate-200 rounded-lg",children:e.jsx("p",{className:"text-base font-medium text-slate-800",children:P.model})})]}),P.tags&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Tags"}),e.jsx("div",{className:"p-3 bg-slate-50 border border-slate-200 rounded-lg",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:P.tags.split(",").map(($,Xt)=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:$.trim()},Xt))})})]})]})]}),(P.taxRate||P.taxCode||P.taxExempt)&&e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(yn,{className:"w-5 h-5 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Tax Management"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Tax rates, codes, and exemption status"})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:P.taxExempt?e.jsx("div",{className:"col-span-full",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx(kn,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"text-lg font-semibold text-green-800",children:"Tax Exempt Product"})]})}):e.jsxs(e.Fragment,{children:[P.taxRate&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Tax Rate"}),e.jsx("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-xl font-bold text-yellow-700",children:[P.taxRate,"%"]})})]}),P.taxCode&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Tax Code"}),e.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsx("p",{className:"text-base font-medium text-blue-800",children:P.taxCode})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Tax Configuration"}),e.jsxs("div",{className:"p-3 bg-slate-50 border border-slate-200 rounded-lg space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Tax Type:"}),e.jsx("span",{className:`text-sm font-medium ${P.taxInclusive?"text-green-600":"text-blue-600"}`,children:P.taxInclusive?"Tax Inclusive":"Tax Exclusive"})]}),P.taxRate>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Tax Rate:"}),e.jsxs("span",{className:"text-sm font-semibold text-slate-800",children:[P.taxRate,"%"]})]}),e.jsx("div",{className:"pt-2 border-t border-slate-300",children:e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600",children:"Unit Price:"}),e.jsxs("p",{className:"font-semibold text-slate-800",children:["$",Number(P.unitPrice).toFixed(2)]})]}),P.taxInclusive?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600",children:"Tax Amount:"}),e.jsxs("p",{className:"font-semibold text-yellow-600",children:["$",(Number(P.unitPrice)*Number(P.taxRate)/(100+Number(P.taxRate))).toFixed(2)]})]}),e.jsxs("div",{className:"col-span-2 pt-1 border-t border-slate-200",children:[e.jsx("span",{className:"text-slate-600",children:"Net Price (excl. tax):"}),e.jsxs("p",{className:"font-bold text-slate-800",children:["$",(Number(P.unitPrice)-Number(P.unitPrice)*Number(P.taxRate)/(100+Number(P.taxRate))).toFixed(2)]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600",children:"Tax Amount:"}),e.jsxs("p",{className:"font-semibold text-yellow-600",children:["$",(Number(P.unitPrice)*Number(P.taxRate)/100).toFixed(2)]})]}),e.jsxs("div",{className:"col-span-2 pt-1 border-t border-slate-200",children:[e.jsx("span",{className:"text-slate-600",children:"Total Price (incl. tax):"}),e.jsxs("p",{className:"font-bold text-slate-800",children:["$",(Number(P.unitPrice)+Number(P.unitPrice)*Number(P.taxRate)/100).toFixed(2)]})]})]})]})})]}):e.jsx("div",{className:"text-center py-2",children:e.jsx("span",{className:"text-sm text-slate-500",children:"No tax applied"})}),P.taxCode&&e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-slate-300",children:[e.jsx("span",{className:"text-sm text-slate-600",children:"Tax Code:"}),e.jsx("span",{className:"text-sm font-medium text-slate-800",children:P.taxCode})]}),P.taxExempt&&e.jsx("div",{className:"flex items-center justify-center pt-2 border-t border-slate-300",children:e.jsx("span",{className:"text-sm font-medium text-green-600 bg-green-50 px-2 py-1 rounded",children:"Tax Exempt Product"})})]})]})]})})]}),(P.weight||P.dimensions||P.barcode||P.shippingClass)&&e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-teal-100 rounded-lg",children:e.jsx(Hr,{className:"w-5 h-5 text-teal-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Physical Properties & Shipping"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Dimensions, weight, and shipping information"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[P.weight&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Weight"}),e.jsx("div",{className:"p-3 bg-teal-50 border border-teal-200 rounded-lg",children:e.jsxs("p",{className:"text-base font-medium text-teal-800",children:[P.weight," kg"]})})]}),P.dimensions&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Dimensions (LWH)"}),e.jsx("div",{className:"p-3 bg-teal-50 border border-teal-200 rounded-lg",children:e.jsx("p",{className:"text-base font-medium text-teal-800",children:typeof P.dimensions=="string"?P.dimensions:`${((Be=P.dimensions)==null?void 0:Be.length)||0}  ${((Ft=P.dimensions)==null?void 0:Ft.width)||0}  ${((Kt=P.dimensions)==null?void 0:Kt.height)||0} cm`})})]}),P.barcode&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Barcode"}),e.jsx("div",{className:"p-3 bg-slate-50 border border-slate-200 rounded-lg",children:e.jsx("p",{className:"text-base font-mono text-slate-800",children:P.barcode})})]}),P.shippingClass&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Shipping Class"}),e.jsx("div",{className:"p-3 bg-slate-50 border border-slate-200 rounded-lg",children:e.jsx("p",{className:"text-base font-medium text-slate-800",children:P.shippingClass})})]})]})]}),(P.isFeatured||P.isBestSeller||P.isNewArrival||P.seoTitle||P.seoDescription)&&e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-pink-100 rounded-lg",children:e.jsx($s,{className:"w-5 h-5 text-pink-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Marketing & SEO"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Promotional flags and SEO optimization"})]})]}),(P.isFeatured||P.isBestSeller||P.isNewArrival)&&e.jsxs("div",{className:"mb-6",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700 mb-3 block",children:"Promotional Badges"}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[P.isFeatured&&e.jsxs("div",{className:"px-3 py-2 bg-purple-100 text-purple-800 rounded-lg flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("span",{className:"font-medium",children:"Featured Product"})]}),P.isBestSeller&&e.jsxs("div",{className:"px-3 py-2 bg-orange-100 text-orange-800 rounded-lg flex items-center gap-2",children:[e.jsx($s,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Best Seller"})]}),P.isNewArrival&&e.jsxs("div",{className:"px-3 py-2 bg-green-100 text-green-800 rounded-lg flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"font-medium",children:"New Arrival"})]})]})]}),(P.seoTitle||P.seoDescription||P.metaKeywords)&&e.jsxs("div",{className:"space-y-4",children:[P.seoTitle&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"SEO Title"}),e.jsx("div",{className:"p-3 bg-slate-50 border border-slate-200 rounded-lg",children:e.jsx("p",{className:"text-base text-slate-800",children:P.seoTitle})})]}),P.seoDescription&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"SEO Description"}),e.jsx("div",{className:"p-3 bg-slate-50 border border-slate-200 rounded-lg",children:e.jsx("p",{className:"text-base text-slate-800",children:P.seoDescription})})]}),P.metaKeywords&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Meta Keywords"}),e.jsx("div",{className:"p-3 bg-slate-50 border border-slate-200 rounded-lg",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:P.metaKeywords.split(",").map(($,Xt)=>e.jsx("span",{className:"px-2 py-1 bg-indigo-100 text-indigo-800 text-xs rounded-full",children:$.trim()},Xt))})})]})]})]}),(P.minStockLevel||P.maxStockLevel||P.reorderPoint||P.allowBackorder||P.allowPreorder)&&e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg",children:e.jsx(lr,{className:"w-5 h-5 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Advanced Stock Management"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Stock levels, reorder points, and ordering policies"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[P.minStockLevel&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Minimum Stock Level"}),e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-xl font-bold text-red-700",children:P.minStockLevel})})]}),P.maxStockLevel&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Maximum Stock Level"}),e.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsx("p",{className:"text-xl font-bold text-blue-700",children:P.maxStockLevel})})]}),P.reorderPoint&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Reorder Point"}),e.jsx("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsx("p",{className:"text-xl font-bold text-yellow-700",children:P.reorderPoint})})]})]}),(P.allowBackorder||P.allowPreorder)&&e.jsxs("div",{className:"mt-6",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700 mb-3 block",children:"Ordering Policies"}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[P.allowBackorder&&e.jsxs("div",{className:"px-3 py-2 bg-amber-100 text-amber-800 rounded-lg flex items-center gap-2",children:[e.jsx(Ro,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Backorders Allowed"})]}),P.allowPreorder&&e.jsxs("div",{className:"px-3 py-2 bg-cyan-100 text-cyan-800 rounded-lg flex items-center gap-2",children:[e.jsx(Xn,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Pre-orders Allowed"}),P.preorderDate&&e.jsxs("span",{className:"text-xs",children:["(",new Date(P.preorderDate).toLocaleDateString(),")"]})]})]})]})]}),(P.warrantyPeriod||P.returnPolicy)&&e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg",children:e.jsx(kn,{className:"w-5 h-5 text-emerald-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Warranty & Service"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Warranty coverage and return policies"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[P.warrantyPeriod&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Warranty Period"}),e.jsx("div",{className:"p-3 bg-emerald-50 border border-emerald-200 rounded-lg",children:e.jsxs("p",{className:"text-xl font-bold text-emerald-700",children:[P.warrantyPeriod," ",((Jt=P.warrantyUnit)==null?void 0:Jt.toLowerCase())||"months"]})})]}),P.returnPolicy&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Return Policy"}),e.jsx("div",{className:"p-3 bg-slate-50 border border-slate-200 rounded-lg",children:e.jsx("p",{className:"text-base text-slate-800",children:P.returnPolicy})})]})]})]})]}),e.jsx("div",{className:"sticky bottom-0 bg-white border-t border-slate-200 px-6 py-4 mt-8",children:e.jsxs(Xr,{className:"gap-3",children:[e.jsxs(I,{variant:"outline",onClick:()=>g(!1),className:"px-6 py-2.5 text-base font-medium",children:[e.jsx(ma,{className:"w-4 h-4 mr-2"}),"Close"]}),e.jsxs(I,{onClick:()=>{g(!1),Pt(P)},className:"px-6 py-2.5 text-base font-medium bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 shadow-lg",children:[e.jsx(ln,{className:"w-4 h-4 mr-2"}),"Edit Product"]})]})})]})}),e.jsx(ts,{open:f,onOpenChange:m,children:e.jsxs(ss,{className:"!max-w-7xl max-h-[95vh] overflow-y-auto w-[95vw] md:max-h-[90vh] md:w-[90vw] bg-gradient-to-br from-slate-50 to-slate-100/50",children:[e.jsxs(as,{className:"pb-6 border-b border-slate-200",children:[e.jsxs(is,{className:"flex items-center gap-3 text-2xl font-bold text-slate-800",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl text-white shadow-lg",children:e.jsx(ln,{className:"w-6 h-6"})}),"Edit Product"]}),e.jsx(Ks,{className:"text-slate-600 text-base mt-2",children:"Update product information with comprehensive details and settings"})]}),e.jsx("div",{className:"space-y-8 mt-6",children:e.jsxs(an,{defaultValue:"basic",className:"w-full",children:[e.jsxs(on,{className:"grid w-full grid-cols-6 bg-white p-1 rounded-xl shadow-sm border border-slate-200",children:[e.jsxs(vt,{value:"basic",className:"flex items-center gap-2 data-[state=active]:bg-blue-500 data-[state=active]:text-white",children:[e.jsx(Hr,{className:"w-4 h-4"}),"Basic"]}),e.jsxs(vt,{value:"pricing",className:"flex items-center gap-2 data-[state=active]:bg-green-500 data-[state=active]:text-white",children:[e.jsx(Mr,{className:"w-4 h-4"}),"Pricing"]}),e.jsxs(vt,{value:"inventory",className:"flex items-center gap-2 data-[state=active]:bg-purple-500 data-[state=active]:text-white",children:[e.jsx(lr,{className:"w-4 h-4"}),"Inventory"]}),e.jsxs(vt,{value:"shipping",className:"flex items-center gap-2 data-[state=active]:bg-orange-500 data-[state=active]:text-white",children:[e.jsx(Hr,{className:"w-4 h-4"}),"Shipping"]}),e.jsxs(vt,{value:"marketing",className:"flex items-center gap-2 data-[state=active]:bg-pink-500 data-[state=active]:text-white",children:[e.jsx($s,{className:"w-4 h-4"}),"Marketing"]}),e.jsxs(vt,{value:"advanced",className:"flex items-center gap-2 data-[state=active]:bg-slate-500 data-[state=active]:text-white",children:[e.jsx(en,{className:"w-4 h-4"}),"Advanced"]})]}),e.jsx(yt,{value:"basic",className:"mt-8",children:e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Hr,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Basic Product Information"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Essential product details and identification"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-name",className:"text-sm font-medium text-slate-700",children:"Product Name *"}),e.jsx(ge,{id:"edit-name",value:O.name,onChange:$=>te({...O,name:$.target.value}),placeholder:"Enter product name",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-sku",className:"text-sm font-medium text-slate-700",children:"SKU *"}),e.jsx(ge,{id:"edit-sku",value:O.sku,onChange:$=>te({...O,sku:$.target.value}),placeholder:"Enter SKU",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-category",className:"text-sm font-medium text-slate-700",children:"Category"}),e.jsxs(rt,{value:O.categoryId||"",onValueChange:$=>{$==="create-new"?G(!0):te({...O,categoryId:$})},children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200",children:e.jsx(it,{placeholder:"Select a category"})}),e.jsxs(at,{children:[Gt.map($=>e.jsx(W,{value:$.id,children:$.name},$.id)),e.jsx(W,{value:"create-new",className:"border-t border-slate-200 mt-2",children:e.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[e.jsx(Ss,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Create New Category"})]})})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-type",className:"text-sm font-medium text-slate-700",children:"Product Type"}),e.jsxs(rt,{value:O.type,onValueChange:$=>te({...O,type:$}),children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200",children:e.jsx(it,{placeholder:"Select product type"})}),e.jsxs(at,{children:[e.jsx(W,{value:"PRODUCT",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Hr,{className:"w-4 h-4 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Physical Product"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Tangible items with inventory tracking"})]})]})}),e.jsx(W,{value:"SERVICE",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(en,{className:"w-4 h-4 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Service"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Intangible services without stock"})]})]})}),e.jsx(W,{value:"DIGITAL",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(or,{className:"w-4 h-4 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Digital Product"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Digital downloads and subscriptions"})]})]})})]})]})]})]}),e.jsxs("div",{className:"space-y-3 mt-6",children:[e.jsx(B,{htmlFor:"edit-shortDescription",className:"text-sm font-medium text-slate-700",children:"Short Description"}),e.jsx(Xs,{id:"edit-shortDescription",value:O.shortDescription,onChange:$=>te({...O,shortDescription:$.target.value}),placeholder:"Brief product summary for listings...",rows:2,className:"resize-none border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3 mt-6",children:[e.jsx(B,{htmlFor:"edit-description",className:"text-sm font-medium text-slate-700",children:"Full Description"}),e.jsx(Xs,{id:"edit-description",value:O.description,onChange:$=>te({...O,description:$.target.value}),placeholder:"Detailed product description...",rows:4,className:"resize-none border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-brand",className:"text-sm font-medium text-slate-700",children:"Brand"}),e.jsx(ge,{id:"edit-brand",value:O.brand,onChange:$=>te({...O,brand:$.target.value}),placeholder:"Product brand",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-model",className:"text-sm font-medium text-slate-700",children:"Model"}),e.jsx(ge,{id:"edit-model",value:O.model,onChange:$=>te({...O,model:$.target.value}),placeholder:"Product model",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-status",className:"text-sm font-medium text-slate-700",children:"Status"}),e.jsxs(rt,{value:O.status,onValueChange:$=>te({...O,status:$}),children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"ACTIVE",children:"Active"}),e.jsx(W,{value:"INACTIVE",children:"Inactive"}),e.jsx(W,{value:"DRAFT",children:"Draft"}),e.jsx(W,{value:"DISCONTINUED",children:"Discontinued"})]})]})]})]})]})}),e.jsx(yt,{value:"pricing",children:e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Mr,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Pricing & Tax Management"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Set prices, costs, and tax configuration"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-unitPrice",className:"text-sm font-medium text-slate-700",children:"Selling Price *"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 font-medium",children:"$"}),e.jsx(ge,{id:"edit-unitPrice",type:"number",step:"0.01",min:"0",value:O.unitPrice||"",onChange:$=>te({...O,unitPrice:parseFloat($.target.value)||0}),placeholder:"0.00",className:"pl-8 py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),O.unitPrice>0&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-green-600",children:[e.jsx(Ro,{className:"w-3 h-3"}),"Valid selling price"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-costPrice",className:"text-sm font-medium text-slate-700",children:"Cost Price *"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500 font-medium",children:"$"}),e.jsx(ge,{id:"edit-costPrice",type:"number",step:"0.01",min:"0",value:O.costPrice||"",onChange:$=>te({...O,costPrice:parseFloat($.target.value)||0}),placeholder:"0.00",className:"pl-8 py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]})]})]}),O.unitPrice>0&&O.costPrice>0&&e.jsxs("div",{className:"mt-6 p-4 bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-800 mb-3",children:"Profit Analysis"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600",children:"Profit per unit: "}),e.jsxs("span",{className:`font-bold ${O.unitPrice-O.costPrice>=0?"text-green-600":"text-red-600"}`,children:["$",(O.unitPrice-O.costPrice).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600",children:"Profit margin: "}),e.jsxs("span",{className:`font-bold ${(O.unitPrice-O.costPrice)/O.unitPrice*100>=0?"text-green-600":"text-red-600"}`,children:[((O.unitPrice-O.costPrice)/O.unitPrice*100).toFixed(1),"%"]})]})]})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-slate-200",children:[e.jsx("h4",{className:"text-base font-semibold text-slate-800 mb-4",children:"Tax Configuration"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-taxRate",className:"text-sm font-medium text-slate-700",children:"Tax Rate"}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{id:"edit-taxRate",type:"number",step:"0.01",min:"0",max:"100",value:O.taxRate||"",onChange:$=>te({...O,taxRate:parseFloat($.target.value)||0}),placeholder:"0.00",className:"pr-8 py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-500 font-medium",children:"%"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-taxCode",className:"text-sm font-medium text-slate-700",children:"Tax Code"}),e.jsxs(rt,{value:O.taxCode||"",onValueChange:$=>te({...O,taxCode:$}),children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200",children:e.jsx(it,{placeholder:"Select tax code"})}),e.jsxs(at,{children:[e.jsx(W,{value:"STANDARD",children:"Standard Tax"}),e.jsx(W,{value:"GST",children:"GST (Goods & Services Tax)"}),e.jsx(W,{value:"VAT",children:"VAT (Value Added Tax)"}),e.jsx(W,{value:"SALES_TAX",children:"Sales Tax"}),e.jsx(W,{value:"EXCISE",children:"Excise Tax"}),e.jsx(W,{value:"IMPORT_DUTY",children:"Import Duty"}),e.jsx(W,{value:"LUXURY_TAX",children:"Luxury Tax"}),e.jsx(W,{value:"ZERO_RATED",children:"Zero-Rated"}),e.jsx(W,{value:"EXEMPT",children:"Tax Exempt"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Tax Configuration"}),e.jsxs("div",{className:"flex items-center gap-3 p-3 border border-slate-200 rounded-lg",children:[e.jsx("input",{type:"checkbox",id:"edit-taxInclusive",checked:O.taxInclusive,onChange:$=>te({...O,taxInclusive:$.target.checked}),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-taxInclusive",className:"text-sm font-medium cursor-pointer",children:"Price includes tax"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Tax is already included in the selling price"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{className:"text-sm font-medium text-slate-700",children:"Tax Exemption"}),e.jsxs("div",{className:"flex items-center gap-3 p-3 border border-slate-200 rounded-lg",children:[e.jsx("input",{type:"checkbox",id:"edit-taxExempt",checked:O.taxExempt,onChange:$=>te({...O,taxExempt:$.target.checked}),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-taxExempt",className:"text-sm font-medium cursor-pointer",children:"Tax exempt product"}),e.jsx("p",{className:"text-xs text-slate-500",children:"This product is exempt from all taxes"})]})]})]})]}),O.unitPrice>0&&e.jsxs("div",{className:"mt-6 p-4 bg-gradient-to-br from-yellow-50 to-amber-50 rounded-lg border border-yellow-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(yn,{className:"w-4 h-4 text-yellow-600"}),e.jsx("h4",{className:"text-sm font-semibold text-slate-800",children:"Tax Calculation Preview"}),O.taxCode&&e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs font-medium rounded-full",children:O.taxCode})]}),O.taxExempt?e.jsxs("div",{className:"text-center py-3",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-2 bg-green-100 text-green-800 rounded-lg",children:[e.jsx(kn,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Tax Exempt Product"})]}),e.jsx("p",{className:"text-sm text-slate-600 mt-2",children:"No tax will be applied to this product"})]}):O.taxRate>0?e.jsx("div",{className:"grid grid-cols-2 gap-4 text-sm",children:O.taxInclusive?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600",children:"Price (tax inclusive): "}),e.jsxs("span",{className:"font-semibold",children:["$",Number(O.unitPrice).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-slate-600",children:["Tax amount (",O.taxRate,"%): "]}),e.jsxs("span",{className:"font-semibold text-yellow-600",children:["$",(Number(O.unitPrice)*Number(O.taxRate)/(100+Number(O.taxRate))).toFixed(2)]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600",children:"Base price: "}),e.jsxs("span",{className:"font-semibold",children:["$",Number(O.unitPrice).toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600",children:"Total price (including tax): "}),e.jsxs("span",{className:"font-semibold text-yellow-600",children:["$",(Number(O.unitPrice)*(1+Number(O.taxRate)/100)).toFixed(2)]})]})]})}):e.jsxs("div",{className:"text-center py-3",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-2 bg-slate-100 text-slate-600 rounded-lg",children:[e.jsx(Ln,{className:"w-4 h-4"}),e.jsx("span",{children:"No tax rate specified"})]}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"Enter a tax rate to see calculations"})]})]})]})]})}),e.jsx(yt,{value:"inventory",children:e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(lr,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Inventory Management"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Stock levels, reorder points, and inventory tracking"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-stockQuantity",className:"text-sm font-medium text-slate-700",children:"Current Stock Quantity"}),e.jsx(ge,{id:"edit-stockQuantity",type:"number",min:"0",step:"1",value:O.stockQuantity||"",onChange:$=>te({...O,stockQuantity:parseFloat($.target.value)||0}),placeholder:"0",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-reorderPoint",className:"text-sm font-medium text-slate-700",children:"Reorder Point"}),e.jsx(ge,{id:"edit-reorderPoint",type:"number",min:"0",step:"1",value:O.reorderPoint||"",onChange:$=>te({...O,reorderPoint:parseFloat($.target.value)||0}),placeholder:"0",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Trigger reorder when stock falls below this level"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-minStockLevel",className:"text-sm font-medium text-slate-700",children:"Minimum Stock Level"}),e.jsx(ge,{id:"edit-minStockLevel",type:"number",min:"0",step:"1",value:O.minStockLevel||"",onChange:$=>te({...O,minStockLevel:parseFloat($.target.value)||0}),placeholder:"0",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Absolute minimum stock to maintain"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-maxStockLevel",className:"text-sm font-medium text-slate-700",children:"Maximum Stock Level"}),e.jsx(ge,{id:"edit-maxStockLevel",type:"number",min:"0",step:"1",value:O.maxStockLevel||"",onChange:$=>te({...O,maxStockLevel:parseFloat($.target.value)||0}),placeholder:"0",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Maximum stock capacity or target level"})]})]}),O.stockQuantity>0&&O.reorderPoint>0&&e.jsxs("div",{className:"mt-6 p-4 bg-gradient-to-br from-purple-50 to-indigo-50 rounded-lg border border-purple-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-800 mb-3",children:"Stock Level Analysis"}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:`flex items-center gap-2 text-sm ${O.stockQuantity<=O.reorderPoint?"text-red-600":O.stockQuantity<=O.reorderPoint*2?"text-yellow-600":"text-green-600"}`,children:[O.stockQuantity<=O.reorderPoint?e.jsx(Is,{className:"w-4 h-4"}):O.stockQuantity<=O.reorderPoint*2?e.jsx(Is,{className:"w-4 h-4"}):e.jsx(Ro,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:O.stockQuantity<=O.reorderPoint?"Critical Stock Level - Immediate Reorder Required":O.stockQuantity<=O.reorderPoint*2?"Low Stock Level - Consider Reordering Soon":"Stock Level is Healthy"})]})})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-slate-200",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-4",children:"Product Type Flags"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 border border-slate-200 rounded-lg",children:[e.jsx("input",{type:"checkbox",id:"edit-trackInventory",checked:O.trackInventory,onChange:$=>te({...O,trackInventory:$.target.checked}),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-trackInventory",className:"text-sm font-medium cursor-pointer",children:"Track inventory"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Monitor stock levels for this product"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 border border-slate-200 rounded-lg",children:[e.jsx("input",{type:"checkbox",id:"edit-allowBackorder",checked:O.allowBackorder,onChange:$=>te({...O,allowBackorder:$.target.checked}),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-allowBackorder",className:"text-sm font-medium cursor-pointer",children:"Allow backorders"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Accept orders when out of stock"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 border border-slate-200 rounded-lg",children:[e.jsx("input",{type:"checkbox",id:"edit-allowPreorder",checked:O.allowPreorder,onChange:$=>te({...O,allowPreorder:$.target.checked}),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-allowPreorder",className:"text-sm font-medium cursor-pointer",children:"Allow pre-orders"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Accept orders before product availability"})]})]}),O.allowPreorder&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-preorderDate",className:"text-sm font-medium text-slate-700",children:"Pre-order Available Date"}),e.jsx(ge,{id:"edit-preorderDate",type:"date",value:O.preorderDate,onChange:$=>te({...O,preorderDate:$.target.value}),className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]})]})]})]})}),e.jsx(yt,{value:"shipping",children:e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:e.jsx(Hr,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Physical Properties & Shipping"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Dimensions, weight, and shipping configuration"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-weight",className:"text-sm font-medium text-slate-700",children:"Weight (kg)"}),e.jsx(ge,{id:"edit-weight",type:"number",step:"0.01",min:"0",value:O.weight||"",onChange:$=>te({...O,weight:parseFloat($.target.value)||0}),placeholder:"0.00",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-barcode",className:"text-sm font-medium text-slate-700",children:"Barcode"}),e.jsx(ge,{id:"edit-barcode",value:O.barcode,onChange:$=>te({...O,barcode:$.target.value}),placeholder:"Enter or scan barcode",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]})]}),e.jsxs("div",{className:"space-y-4 mt-6",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800",children:"Dimensions (cm)"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"edit-length",children:"Length"}),e.jsx(ge,{id:"edit-length",type:"number",step:"0.01",value:((kt=O.dimensions)==null?void 0:kt.length)||0,onChange:$=>{var Xt,ds;return te({...O,dimensions:{...O.dimensions,length:parseFloat($.target.value)||0,width:((Xt=O.dimensions)==null?void 0:Xt.width)||0,height:((ds=O.dimensions)==null?void 0:ds.height)||0}})},placeholder:"0.00",className:"border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"edit-width",children:"Width"}),e.jsx(ge,{id:"edit-width",type:"number",step:"0.01",value:((gs=O.dimensions)==null?void 0:gs.width)||0,onChange:$=>{var Xt,ds;return te({...O,dimensions:{...O.dimensions,width:parseFloat($.target.value)||0,length:((Xt=O.dimensions)==null?void 0:Xt.length)||0,height:((ds=O.dimensions)==null?void 0:ds.height)||0}})},placeholder:"0.00",className:"border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"edit-height",children:"Height"}),e.jsx(ge,{id:"edit-height",type:"number",step:"0.01",value:((fn=O.dimensions)==null?void 0:fn.height)||0,onChange:$=>{var Xt,ds;return te({...O,dimensions:{...O.dimensions,width:((Xt=O.dimensions)==null?void 0:Xt.width)||0,length:((ds=O.dimensions)==null?void 0:ds.length)||0,height:parseFloat($.target.value)||0}})},placeholder:"0.00",className:"border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]})]})]}),e.jsxs("div",{className:"space-y-2 mt-6",children:[e.jsx(B,{htmlFor:"edit-shippingClass",children:"Shipping Class"}),e.jsxs(rt,{value:O.shippingClass,onValueChange:$=>te({...O,shippingClass:$}),children:[e.jsx(nt,{className:"border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200",children:e.jsx(it,{placeholder:"Select shipping class"})}),e.jsxs(at,{children:[e.jsx(W,{value:"STANDARD",children:"Standard Shipping"}),e.jsx(W,{value:"EXPEDITED",children:"Expedited Shipping"}),e.jsx(W,{value:"OVERNIGHT",children:"Overnight Shipping"}),e.jsx(W,{value:"FREIGHT",children:"Freight Shipping"}),e.jsx(W,{value:"DIGITAL",children:"Digital Delivery"}),e.jsx(W,{value:"PICKUP",children:"Pickup Only"}),e.jsx(W,{value:"FREE",children:"Free Shipping"})]})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Choose appropriate shipping method for this product"})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-slate-200",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-4",children:"Warranty & Returns"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-warrantyPeriod",className:"text-sm font-medium text-slate-700",children:"Warranty Period"}),e.jsx(ge,{id:"edit-warrantyPeriod",type:"number",min:"0",step:"1",value:O.warrantyPeriod,onChange:$=>te({...O,warrantyPeriod:parseFloat($.target.value)||0}),placeholder:"0",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-warrantyUnit",className:"text-sm font-medium text-slate-700",children:"Warranty Unit"}),e.jsxs(rt,{value:O.warrantyUnit,onValueChange:$=>te({...O,warrantyUnit:$}),children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200",children:e.jsx(it,{placeholder:"Select unit"})}),e.jsxs(at,{children:[e.jsx(W,{value:"DAYS",children:"Days"}),e.jsx(W,{value:"WEEKS",children:"Weeks"}),e.jsx(W,{value:"MONTHS",children:"Months"}),e.jsx(W,{value:"YEARS",children:"Years"})]})]})]})]}),e.jsxs("div",{className:"space-y-3 mt-6",children:[e.jsx(B,{htmlFor:"edit-returnPolicy",className:"text-sm font-medium text-slate-700",children:"Return Policy"}),e.jsx(Xs,{id:"edit-returnPolicy",value:O.returnPolicy,onChange:$=>te({...O,returnPolicy:$.target.value}),placeholder:"Describe the return policy for this product...",rows:3,className:"resize-none border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]})]})]})}),e.jsx(yt,{value:"marketing",children:e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-pink-100 rounded-lg",children:e.jsx($s,{className:"w-5 h-5 text-pink-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Marketing & SEO"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Promotional features, SEO optimization, and marketing flags"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-4",children:"Product Promotion Flags"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"edit-isFeatured",checked:O.isFeatured,onChange:$=>te({...O,isFeatured:$.target.checked}),className:"w-4 h-4 text-purple-600 bg-gray-100 border-gray-300 rounded focus:ring-purple-500"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-isFeatured",className:"text-sm font-medium cursor-pointer",children:"Featured Product"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Highlight in featured sections"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"edit-isBestSeller",checked:O.isBestSeller,onChange:$=>te({...O,isBestSeller:$.target.checked}),className:"w-4 h-4 text-orange-600 bg-gray-100 border-gray-300 rounded focus:ring-orange-500"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($s,{className:"w-4 h-4 text-orange-600"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-isBestSeller",className:"text-sm font-medium cursor-pointer",children:"Best Seller"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Mark as top-selling product"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"edit-isNewArrival",checked:O.isNewArrival,onChange:$=>te({...O,isNewArrival:$.target.checked}),className:"w-4 h-4 text-green-600 bg-gray-100 border-gray-300 rounded focus:ring-green-500"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-isNewArrival",className:"text-sm font-medium cursor-pointer",children:"New Arrival"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Show as recently added"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-3 mb-8",children:[e.jsx(B,{htmlFor:"edit-tags",className:"text-sm font-medium text-slate-700",children:"Product Tags"}),e.jsx(Xs,{id:"edit-tags",value:O.tags,onChange:$=>te({...O,tags:$.target.value}),placeholder:"e.g., organic, premium, limited-edition (comma separated)",rows:2,className:"resize-none border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Separate multiple tags with commas for better searchability"})]}),e.jsxs("div",{className:"pt-6 border-t border-slate-200",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-4",children:"SEO Optimization"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-seoTitle",className:"text-sm font-medium text-slate-700",children:"SEO Title"}),e.jsx(ge,{id:"edit-seoTitle",value:O.seoTitle,onChange:$=>te({...O,seoTitle:$.target.value}),placeholder:"Optimized title for search engines (50-60 characters)",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Recommended: 50-60 characters for optimal display"}),e.jsxs("span",{className:`text-xs ${((xi=O.seoTitle)==null?void 0:xi.length)>60?"text-orange-500":"text-slate-400"}`,children:[(($n=O.seoTitle)==null?void 0:$n.length)||0,"/60"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-seoDescription",className:"text-sm font-medium text-slate-700",children:"SEO Description"}),e.jsx(Xs,{id:"edit-seoDescription",value:O.seoDescription,onChange:$=>te({...O,seoDescription:$.target.value}),placeholder:"Compelling description for search results (150-160 characters)",rows:3,className:"resize-none border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-xs text-slate-500",children:"Recommended: 150-160 characters for search snippets"}),e.jsxs("span",{className:`text-xs ${((Ur=O.seoDescription)==null?void 0:Ur.length)>160?"text-orange-500":"text-slate-400"}`,children:[((Yi=O.seoDescription)==null?void 0:Yi.length)||0,"/160"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-metaKeywords",className:"text-sm font-medium text-slate-700",children:"Meta Keywords"}),e.jsx(Xs,{id:"edit-metaKeywords",value:O.metaKeywords,onChange:$=>te({...O,metaKeywords:$.target.value}),placeholder:"relevant, keywords, for, search, engines (comma separated)",rows:2,className:"resize-none border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Comma-separated keywords relevant to your product"})]})]})]}),(O.seoTitle||O.seoDescription)&&e.jsxs("div",{className:"mt-8 p-4 bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-800 mb-3",children:"Search Result Preview"}),e.jsxs("div",{className:"bg-white p-4 rounded border",children:[e.jsx("div",{className:"text-blue-600 text-lg hover:underline cursor-pointer",children:O.seoTitle||O.name||"Product Title"}),e.jsxs("div",{className:"text-green-600 text-sm",children:["yourstore.com/products/",((Ji=O.sku)==null?void 0:Ji.toLowerCase())||"product-sku"]}),e.jsx("div",{className:"text-gray-600 text-sm mt-1",children:O.seoDescription||O.shortDescription||O.description||"Product description will appear here..."})]})]})]})}),e.jsx(yt,{value:"advanced",children:e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(en,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Advanced Configuration"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Product variants, custom fields, and advanced settings"})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-4",children:"Product Status & Visibility"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-status",className:"text-sm font-medium text-slate-700",children:"Product Status"}),e.jsxs("select",{id:"edit-status",value:O.status||"active",onChange:$=>te({...O,status:$.target.value}),className:"w-full px-3 py-3 bg-white border border-slate-300 rounded-lg text-base focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"discontinued",children:"Discontinued"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-visibility",className:"text-sm font-medium text-slate-700",children:"Visibility"}),e.jsxs("select",{id:"edit-visibility",value:O.visibility||"public",onChange:$=>te({...O,visibility:$.target.value}),className:"w-full px-3 py-3 bg-white border border-slate-300 rounded-lg text-base focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200",children:[e.jsx("option",{value:"public",children:"Public"}),e.jsx("option",{value:"private",children:"Private"}),e.jsx("option",{value:"members-only",children:"Members Only"})]})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-4",children:"Custom Information Fields"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-customField1",className:"text-sm font-medium text-slate-700",children:"Custom Field 1"}),e.jsx(ge,{id:"edit-customField1",value:O.customField1,onChange:$=>te({...O,customField1:$.target.value}),placeholder:"e.g., Material composition",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-customField2",className:"text-sm font-medium text-slate-700",children:"Custom Field 2"}),e.jsx(ge,{id:"edit-customField2",value:O.customField2,onChange:$=>te({...O,customField2:$.target.value}),placeholder:"e.g., Care instructions",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-customField3",className:"text-sm font-medium text-slate-700",children:"Custom Field 3"}),e.jsx(ge,{id:"edit-customField3",value:O.customField3,onChange:$=>te({...O,customField3:$.target.value}),placeholder:"e.g., Certifications",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-customField4",className:"text-sm font-medium text-slate-700",children:"Custom Field 4"}),e.jsx(ge,{id:"edit-customField4",value:O.customField4,onChange:$=>te({...O,customField4:$.target.value}),placeholder:"e.g., Origin country",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-4",children:"Product Variants & Options"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-variants",className:"text-sm font-medium text-slate-700",children:"Available Variants"}),e.jsx(Xs,{id:"edit-variants",value:Array.isArray(O.variants)?O.variants.join(", "):"",onChange:$=>te({...O,variants:$.target.value.split(",").map(Xt=>Xt.trim()).filter(Boolean)}),placeholder:"e.g., Size: S,M,L,XL | Color: Red,Blue,Green",rows:3,className:"resize-none border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Define variants using format: Attribute: Option1,Option2"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-relatedProducts",className:"text-sm font-medium text-slate-700",children:"Related Products"}),e.jsx(Xs,{id:"edit-relatedProducts",value:Array.isArray(O.relatedProducts)?O.relatedProducts.join(", "):"",onChange:$=>te({...O,relatedProducts:$.target.value.split(",").map(Xt=>Xt.trim()).filter(Boolean)}),placeholder:"e.g., SKU001, SKU002, SKU003",rows:3,className:"resize-none border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Comma-separated list of related product SKUs"})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-4",children:"Additional Product Flags"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"edit-isDigital",checked:O.isDigital,onChange:$=>te({...O,isDigital:$.target.checked}),className:"w-4 h-4 text-indigo-600 bg-gray-100 border-gray-300 rounded focus:ring-indigo-500"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-indigo-500 rounded-full"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-isDigital",className:"text-sm font-medium cursor-pointer",children:"Digital Product"}),e.jsx("p",{className:"text-xs text-slate-500",children:"No physical shipping required"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"edit-requiresLicense",checked:O.requiresLicense,onChange:$=>te({...O,requiresLicense:$.target.checked}),className:"w-4 h-4 text-red-600 bg-gray-100 border-gray-300 rounded focus:ring-red-500"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(kn,{className:"w-4 h-4 text-red-600"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-requiresLicense",className:"text-sm font-medium cursor-pointer",children:"License Required"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Regulatory compliance needed"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"edit-hasExpiryDate",checked:O.hasExpiryDate,onChange:$=>te({...O,hasExpiryDate:$.target.checked}),className:"w-4 h-4 text-orange-600 bg-gray-100 border-gray-300 rounded focus:ring-orange-500"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xn,{className:"w-4 h-4 text-orange-600"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-hasExpiryDate",className:"text-sm font-medium cursor-pointer",children:"Has Expiry Date"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Track product expiration"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"edit-isBundle",checked:O.isBundle,onChange:$=>te({...O,isBundle:$.target.checked}),className:"w-4 h-4 text-green-600 bg-gray-100 border-gray-300 rounded focus:ring-green-500"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Hr,{className:"w-4 h-4 text-green-600"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-isBundle",className:"text-sm font-medium cursor-pointer",children:"Bundle Product"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Contains multiple items"})]})]})]})]})]}),e.jsx("div",{className:"pt-6 border-t border-slate-200",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-notes",className:"text-sm font-medium text-slate-700",children:"Internal Notes"}),e.jsx(Xs,{id:"edit-notes",value:O.notes,onChange:$=>te({...O,notes:$.target.value}),placeholder:"Internal notes for staff use only (not visible to customers)",rows:4,className:"resize-none border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"}),e.jsx("p",{className:"text-xs text-slate-500",children:"These notes are for internal use and won't be displayed to customers"})]})}),e.jsxs("div",{className:"mt-8 p-4 bg-gradient-to-br from-purple-50 to-indigo-50 rounded-lg border border-purple-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-800 mb-3",children:"Configuration Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${O.status==="active"?"bg-green-500":"bg-orange-500"}`}),e.jsxs("span",{className:"text-slate-600",children:["Status: ",O.status||"Active"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${O.isDigital?"bg-blue-500":"bg-gray-400"}`}),e.jsxs("span",{className:"text-slate-600",children:[O.isDigital?"Digital":"Physical"," Product"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${O.isBundle?"bg-green-500":"bg-gray-400"}`}),e.jsxs("span",{className:"text-slate-600",children:[O.isBundle?"Bundle":"Single"," Item"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${O.hasExpiryDate?"bg-orange-500":"bg-gray-400"}`}),e.jsx("span",{className:"text-slate-600",children:O.hasExpiryDate?"Expires":"No Expiry"})]})]})]})]})})]})}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsx(I,{disabled:!((rn=O.name)!=null&&rn.trim())||!((Ll=O.sku)!=null&&Ll.trim())||O.unitPrice<=0||O.costPrice<0||O.stockQuantity<0||!((zo=O.status)!=null&&zo.trim()),onClick:async()=>{var $,Xt,ds,Us,H,Ce,Ge,ht,wt,Qt,vs,Js,je,Ot,Ds,ar,cn,Va,Wn,ri,Wa,vi,pl,Bl;try{if(!(($=O.name)!=null&&$.trim())){dt({title:"Validation Error",description:"Product name is required",variant:"destructive"});return}if(!((Xt=O.sku)!=null&&Xt.trim())){dt({title:"Validation Error",description:"SKU is required",variant:"destructive"});return}if(O.unitPrice<=0){dt({title:"Validation Error",description:"Unit price must be greater than 0",variant:"destructive"});return}if(O.costPrice<0){dt({title:"Validation Error",description:"Cost price cannot be negative",variant:"destructive"});return}if(O.stockQuantity<0){dt({title:"Validation Error",description:"Stock quantity cannot be negative",variant:"destructive"});return}if(!((ds=O.status)!=null&&ds.trim())){dt({title:"Validation Error",description:"Product status is required",variant:"destructive"});return}const _r=["ACTIVE","INACTIVE","DISCONTINUED","DRAFT"];if(!_r.includes(O.status)){dt({title:"Validation Error",description:`Invalid status: ${O.status}. Must be one of: ${_r.join(", ")}`,variant:"destructive"});return}console.log(" Product Update Debug:",{originalStatus:O.status,statusType:typeof O.status,statusTrimmed:(Us=O.status)==null?void 0:Us.trim(),isValidStatus:["ACTIVE","INACTIVE","DISCONTINUED","DRAFT"].includes(O.status)});const Ha={...O,unitPrice:O.unitPrice,costPrice:O.costPrice,stockQuantity:O.stockQuantity,status:O.status.toUpperCase(),type:O.type,warrantyUnit:O.warrantyUnit,images:JSON.stringify(O.images||[]),variants:JSON.stringify(O.variants||[]),relatedProducts:JSON.stringify(O.relatedProducts||[]),upsellProducts:JSON.stringify(O.upsellProducts||[]),crossSellProducts:JSON.stringify(O.crossSellProducts||[]),customFields:JSON.stringify(O.customFields||{}),dimensionsLength:((H=O.dimensions)==null?void 0:H.length)||0,dimensionsWidth:((Ce=O.dimensions)==null?void 0:Ce.width)||0,dimensionsHeight:((Ge=O.dimensions)==null?void 0:Ge.height)||0,dimensions:void 0};console.log("Updating product with data:",Ha),console.log("Product ID:",P.id),console.log(" Status Debug:",{status:Ha.status,statusType:typeof Ha.status,statusLength:(ht=Ha.status)==null?void 0:ht.length,isValidStatus:["ACTIVE","INACTIVE","DISCONTINUED","DRAFT"].includes(Ha.status),fullUpdateDataKeys:Object.keys(Ha),statusFieldInData:Ha.status}),await Ra.updateProduct(P.id,Ha),dt({title:"Success",description:"Product updated successfully"}),m(!1),pt.invalidateQueries({queryKey:["products"]}),pt.invalidateQueries({queryKey:["categories"]}),pt.invalidateQueries({queryKey:["analytics"]}),pt.invalidateQueries({queryKey:["kpis"]})}catch(_r){console.error("Product update error:",_r),console.error("Error response:",_r==null?void 0:_r.response),console.error("Error data:",(wt=_r==null?void 0:_r.response)==null?void 0:wt.data);let Ha="Failed to update product. Please try again.";if(((Qt=_r==null?void 0:_r.response)==null?void 0:Qt.status)===409)Ha=`SKU "${O.sku}" already exists for this company. Please use a different SKU.`;else if(((vs=_r==null?void 0:_r.response)==null?void 0:vs.status)===400){const io=((je=(Js=_r==null?void 0:_r.response)==null?void 0:Js.data)==null?void 0:je.errors)||[];io.length>0?Ha=`Validation errors: ${io.join(", ")}`:Ha=((Ds=(Ot=_r==null?void 0:_r.response)==null?void 0:Ot.data)==null?void 0:Ds.message)||"Invalid product data. Please check your inputs."}else if(((ar=_r==null?void 0:_r.response)==null?void 0:ar.status)===401)Ha="Authentication error. Please refresh the page and try again.";else if(((cn=_r==null?void 0:_r.response)==null?void 0:cn.status)===403)Ha="Permission denied. You don't have access to update this product.";else if(((Va=_r==null?void 0:_r.response)==null?void 0:Va.status)===404)Ha="Product not found. It may have been deleted.";else if(((Wn=_r==null?void 0:_r.response)==null?void 0:Wn.status)===500)Ha="Server error. Please try again later.";else{const io=((Wa=(ri=_r==null?void 0:_r.response)==null?void 0:ri.data)==null?void 0:Wa.error)||((pl=(vi=_r==null?void 0:_r.response)==null?void 0:vi.data)==null?void 0:pl.message)||((Bl=_r==null?void 0:_r.response)==null?void 0:Bl.statusText)||(_r==null?void 0:_r.message);io&&io!=="Conflict"&&io!=="Bad Request"&&io.length>10&&(Ha=io)}dt({title:"Error Updating Product",description:Ha,variant:"destructive"})}},children:"Update Product"})]})]})}),e.jsx(ts,{open:v,onOpenChange:y,children:e.jsxs(ss,{className:"!max-w-7xl max-h-[95vh] overflow-y-auto w-[95vw] md:max-h-[90vh] md:w-[90vw] bg-gradient-to-br from-slate-50 to-blue-50",children:[e.jsx(as,{className:"bg-white rounded-xl shadow-sm p-6 border border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl shadow-lg",children:e.jsx(Pa,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx(is,{className:"text-2xl font-bold text-slate-800",children:"Add New Location"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Create a new warehouse, store, or distribution center"})]})]})}),e.jsx("div",{className:"flex-1",children:e.jsxs(an,{defaultValue:"basic",className:"h-full flex flex-col",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-2 mb-4",children:e.jsxs(on,{className:"grid w-full grid-cols-4 gap-1",children:[e.jsxs(vt,{value:"basic",className:"flex items-center gap-2 py-3 px-4 data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-indigo-600 data-[state=active]:text-white transition-all duration-300",children:[e.jsx(Zl,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Basic Info"})]}),e.jsxs(vt,{value:"address",className:"flex items-center gap-2 py-3 px-4 data-[state=active]:bg-gradient-to-r data-[state=active]:from-green-500 data-[state=active]:to-emerald-600 data-[state=active]:text-white transition-all duration-300",children:[e.jsx(Pa,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Address"})]}),e.jsxs(vt,{value:"contact",className:"flex items-center gap-2 py-3 px-4 data-[state=active]:bg-gradient-to-r data-[state=active]:from-purple-500 data-[state=active]:to-pink-600 data-[state=active]:text-white transition-all duration-300",children:[e.jsx(bo,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Contact"})]}),e.jsxs(vt,{value:"settings",className:"flex items-center gap-2 py-3 px-4 data-[state=active]:bg-gradient-to-r data-[state=active]:from-orange-500 data-[state=active]:to-red-600 data-[state=active]:text-white transition-all duration-300",children:[e.jsx(en,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Settings"})]})]})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(yt,{value:"basic",children:e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Zl,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Basic Information"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Essential location details and identification"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"location-name",className:"text-sm font-medium text-slate-700",children:"Location Name *"}),e.jsx(ge,{id:"location-name",value:pe.name,onChange:$=>Ae({...pe,name:$.target.value}),placeholder:"e.g., Main Warehouse, Downtown Store",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"location-code",className:"text-sm font-medium text-slate-700",children:"Location Code"}),e.jsx(ge,{id:"location-code",value:pe.code,onChange:$=>Ae({...pe,code:$.target.value}),placeholder:"e.g., WH-001, STORE-NYC",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"location-description",className:"text-sm font-medium text-slate-700",children:"Description"}),e.jsx(Xs,{id:"location-description",value:pe.description,onChange:$=>Ae({...pe,description:$.target.value}),placeholder:"Brief description of the location, its purpose, and key features",rows:3,className:"resize-none border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"location-type",className:"text-sm font-medium text-slate-700",children:"Location Type"}),e.jsxs("select",{id:"location-type",value:pe.locationType,onChange:$=>Ae({...pe,locationType:$.target.value}),className:"w-full px-3 py-3 bg-white border border-slate-300 rounded-lg text-base focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200",children:[e.jsx("option",{value:"WAREHOUSE",children:"Warehouse"}),e.jsx("option",{value:"STORE",children:"Retail Store"}),e.jsx("option",{value:"DISTRIBUTION_CENTER",children:"Distribution Center"}),e.jsx("option",{value:"MANUFACTURING",children:"Manufacturing Plant"}),e.jsx("option",{value:"OFFICE",children:"Office"}),e.jsx("option",{value:"COLD_STORAGE",children:"Cold Storage"}),e.jsx("option",{value:"FULFILLMENT",children:"Fulfillment Center"}),e.jsx("option",{value:"OTHER",children:"Other"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"location-capacity",className:"text-sm font-medium text-slate-700",children:"Storage Capacity"}),e.jsx(ge,{id:"location-capacity",value:pe.capacity,onChange:$=>Ae({...pe,capacity:$.target.value}),placeholder:"e.g., 10,000 sq ft, 500 pallets",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]})]}),e.jsxs("div",{className:"pt-6 border-t border-slate-200",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-4",children:"Location Status"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"location-active",checked:pe.isActive,onChange:$=>Ae({...pe,isActive:$.target.checked}),className:"w-4 h-4 text-green-600 bg-gray-100 border-gray-300 rounded focus:ring-green-500"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"location-active",className:"text-sm font-medium cursor-pointer",children:"Active Location"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Location is operational and accepting inventory"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"location-default",checked:pe.isDefault,onChange:$=>Ae({...pe,isDefault:$.target.checked}),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(go,{className:"w-4 h-4 text-blue-600"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"location-default",className:"text-sm font-medium cursor-pointer",children:"Default Location"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Set as default for new inventory"})]})]})]})]})]})]})]})}),e.jsx(yt,{value:"address",children:e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Pa,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Address Information"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Physical location and geographic coordinates"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"location-address",className:"text-sm font-medium text-slate-700",children:"Street Address"}),e.jsx(ge,{id:"location-address",value:pe.address,onChange:$=>Ae({...pe,address:$.target.value}),placeholder:"e.g., 123 Business Park Drive",className:"py-3 text-base border-slate-300 focus:border-green-400 focus:ring-1 focus:ring-green-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"location-address2",className:"text-sm font-medium text-slate-700",children:"Address Line 2 (Optional)"}),e.jsx(ge,{id:"location-address2",value:pe.address2,onChange:$=>Ae({...pe,address2:$.target.value}),placeholder:"e.g., Suite 100, Building A",className:"py-3 text-base border-slate-300 focus:border-green-400 focus:ring-1 focus:ring-green-100 transition-all duration-200"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"location-city",className:"text-sm font-medium text-slate-700",children:"City"}),e.jsx(ge,{id:"location-city",value:pe.city,onChange:$=>Ae({...pe,city:$.target.value}),placeholder:"e.g., New York",className:"py-3 text-base border-slate-300 focus:border-green-400 focus:ring-1 focus:ring-green-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"location-state",className:"text-sm font-medium text-slate-700",children:"State/Province"}),e.jsx(ge,{id:"location-state",value:pe.state,onChange:$=>Ae({...pe,state:$.target.value}),placeholder:"e.g., NY",className:"py-3 text-base border-slate-300 focus:border-green-400 focus:ring-1 focus:ring-green-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"location-postal",className:"text-sm font-medium text-slate-700",children:"Postal Code"}),e.jsx(ge,{id:"location-postal",value:pe.postalCode,onChange:$=>Ae({...pe,postalCode:$.target.value}),placeholder:"e.g., 10001",className:"py-3 text-base border-slate-300 focus:border-green-400 focus:ring-1 focus:ring-green-100 transition-all duration-200"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"location-country",className:"text-sm font-medium text-slate-700",children:"Country"}),e.jsx(ge,{id:"location-country",value:pe.country,onChange:$=>Ae({...pe,country:$.target.value}),placeholder:"e.g., United States",className:"py-3 text-base border-slate-300 focus:border-green-400 focus:ring-1 focus:ring-green-100 transition-all duration-200"})]}),e.jsxs("div",{className:"pt-6 border-t border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800",children:"Geographic Coordinates (Optional)"}),e.jsxs(I,{type:"button",variant:"outline",size:"sm",onClick:async()=>{if(!navigator.geolocation){dt({title:"Geolocation Not Supported",description:"Your browser doesn't support geolocation. Please enter coordinates manually.",variant:"destructive"});return}dt({title:"Getting Location...",description:"Please allow location access to automatically fill coordinates."}),navigator.geolocation.getCurrentPosition($=>{const{latitude:Xt,longitude:ds}=$.coords;Ae({...pe,latitude:Xt.toString(),longitude:ds.toString()}),dt({title:"Location Retrieved",description:`Coordinates set: ${Xt.toFixed(6)}, ${ds.toFixed(6)}`})},$=>{let Xt="Unable to retrieve location.";switch($.code){case $.PERMISSION_DENIED:Xt="Location access denied. Please enable location permissions.";break;case $.POSITION_UNAVAILABLE:Xt="Location information unavailable.";break;case $.TIMEOUT:Xt="Location request timed out.";break}dt({title:"Location Error",description:Xt,variant:"destructive"})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})},className:"flex items-center gap-2",children:[e.jsx(Pa,{className:"w-4 h-4"}),"Get Current Location"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(B,{htmlFor:"location-latitude",className:"text-sm font-medium text-slate-700 flex items-center gap-2",children:["Latitude",pe.latitude&&e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(Ro,{className:"w-3 h-3"}),e.jsx("span",{className:"text-xs",children:"Auto-filled"})]})]}),e.jsx(ge,{id:"location-latitude",value:pe.latitude,onChange:$=>Ae({...pe,latitude:$.target.value}),placeholder:"e.g., 40.7128",className:`py-3 text-base transition-all duration-200 ${pe.latitude?"border-green-300 bg-green-50/30 focus:border-green-400 focus:ring-1 focus:ring-green-100":"border-slate-300 focus:border-green-400 focus:ring-1 focus:ring-green-100"}`})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(B,{htmlFor:"location-longitude",className:"text-sm font-medium text-slate-700 flex items-center gap-2",children:["Longitude",pe.longitude&&e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(Ro,{className:"w-3 h-3"}),e.jsx("span",{className:"text-xs",children:"Auto-filled"})]})]}),e.jsx(ge,{id:"location-longitude",value:pe.longitude,onChange:$=>Ae({...pe,longitude:$.target.value}),placeholder:"e.g., -74.0060",className:`py-3 text-base transition-all duration-200 ${pe.longitude?"border-green-300 bg-green-50/30 focus:border-green-400 focus:ring-1 focus:ring-green-100":"border-slate-300 focus:border-green-400 focus:ring-1 focus:ring-green-100"}`})]})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Coordinates help with routing and mapping integrations"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"location-timezone",className:"text-sm font-medium text-slate-700",children:"Timezone"}),e.jsxs("select",{id:"location-timezone",value:pe.timezone,onChange:$=>Ae({...pe,timezone:$.target.value}),className:"w-full px-3 py-3 bg-white border border-slate-300 rounded-lg text-base focus:border-green-400 focus:ring-1 focus:ring-green-100 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Select timezone"}),e.jsx("option",{value:"America/New_York",children:"Eastern Time (EST/EDT)"}),e.jsx("option",{value:"America/Chicago",children:"Central Time (CST/CDT)"}),e.jsx("option",{value:"America/Denver",children:"Mountain Time (MST/MDT)"}),e.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time (PST/PDT)"}),e.jsx("option",{value:"Europe/London",children:"Greenwich Mean Time (GMT)"}),e.jsx("option",{value:"Europe/Paris",children:"Central European Time (CET)"}),e.jsx("option",{value:"Asia/Tokyo",children:"Japan Standard Time (JST)"}),e.jsx("option",{value:"Asia/Shanghai",children:"China Standard Time (CST)"})]})]})]})]})}),e.jsx(yt,{value:"contact",children:e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(bo,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Contact Information"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Primary contacts and management details"})]})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-4",children:"Primary Contact"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"location-contact-name",className:"text-sm font-medium text-slate-700",children:"Contact Name"}),e.jsx(ge,{id:"location-contact-name",value:pe.contactName,onChange:$=>Ae({...pe,contactName:$.target.value}),placeholder:"e.g., John Smith",className:"py-3 text-base border-slate-300 focus:border-purple-400 focus:ring-1 focus:ring-purple-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"location-contact-phone",className:"text-sm font-medium text-slate-700",children:"Phone Number"}),e.jsx(ge,{id:"location-contact-phone",value:pe.contactPhone,onChange:$=>Ae({...pe,contactPhone:$.target.value}),placeholder:"e.g., +1 (555) 123-4567",className:"py-3 text-base border-slate-300 focus:border-purple-400 focus:ring-1 focus:ring-purple-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"location-contact-email",className:"text-sm font-medium text-slate-700",children:"Email Address"}),e.jsx(ge,{id:"location-contact-email",type:"email",value:pe.contactEmail,onChange:$=>Ae({...pe,contactEmail:$.target.value}),placeholder:"e.g., contact@location.com",className:"py-3 text-base border-slate-300 focus:border-purple-400 focus:ring-1 focus:ring-purple-100 transition-all duration-200"})]})]})]}),e.jsxs("div",{className:"pt-6 border-t border-slate-200",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-4",children:"Location Manager"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"location-manager-name",className:"text-sm font-medium text-slate-700",children:"Manager Name"}),e.jsx(ge,{id:"location-manager-name",value:pe.managerName,onChange:$=>Ae({...pe,managerName:$.target.value}),placeholder:"e.g., Sarah Johnson",className:"py-3 text-base border-slate-300 focus:border-purple-400 focus:ring-1 focus:ring-purple-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"location-manager-phone",className:"text-sm font-medium text-slate-700",children:"Manager Phone"}),e.jsx(ge,{id:"location-manager-phone",value:pe.managerPhone,onChange:$=>Ae({...pe,managerPhone:$.target.value}),placeholder:"e.g., +1 (555) 987-6543",className:"py-3 text-base border-slate-300 focus:border-purple-400 focus:ring-1 focus:ring-purple-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"location-manager-email",className:"text-sm font-medium text-slate-700",children:"Manager Email"}),e.jsx(ge,{id:"location-manager-email",type:"email",value:pe.managerEmail,onChange:$=>Ae({...pe,managerEmail:$.target.value}),placeholder:"e.g., manager@location.com",className:"py-3 text-base border-slate-300 focus:border-purple-400 focus:ring-1 focus:ring-purple-100 transition-all duration-200"})]})]})]}),e.jsx("div",{className:"pt-6 border-t border-slate-200",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"location-hours",className:"text-sm font-medium text-slate-700",children:"Operating Hours"}),e.jsx(Xs,{id:"location-hours",value:pe.operatingHours,onChange:$=>Ae({...pe,operatingHours:$.target.value}),placeholder:"e.g., Mon-Fri: 8:00 AM - 6:00 PM, Sat: 9:00 AM - 4:00 PM, Sun: Closed",rows:3,className:"resize-none border-slate-300 focus:border-purple-400 focus:ring-1 focus:ring-purple-100 transition-all duration-200"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Specify the operational hours for this location"})]})}),e.jsxs("div",{className:"mt-8 p-4 bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg border border-purple-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-800 mb-3",children:"Contact Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(r1,{className:"w-4 h-4 text-purple-600"}),e.jsxs("span",{className:"text-slate-600",children:["Primary: ",pe.contactPhone||"Not provided"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Dd,{className:"w-4 h-4 text-purple-600"}),e.jsxs("span",{className:"text-slate-600",children:["Email: ",pe.contactEmail||"Not provided"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D5,{className:"w-4 h-4 text-purple-600"}),e.jsxs("span",{className:"text-slate-600",children:["Manager: ",pe.managerName||"Not assigned"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Cr,{className:"w-4 h-4 text-purple-600"}),e.jsxs("span",{className:"text-slate-600",children:["Hours: ",pe.operatingHours?"Configured":"Not set"]})]})]})]})]})]})}),e.jsx(yt,{value:"settings",children:e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:e.jsx(en,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Advanced Settings"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Specialized configurations and operational parameters"})]})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-4",children:"Warehouse Configuration"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"location-zone",className:"text-sm font-medium text-slate-700",children:"Warehouse Zone"}),e.jsx(ge,{id:"location-zone",value:pe.warehouseZone,onChange:$=>Ae({...pe,warehouseZone:$.target.value}),placeholder:"e.g., Zone A, Sector 1, North Wing",className:"py-3 text-base border-slate-300 focus:border-orange-400 focus:ring-1 focus:ring-orange-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"location-security",className:"text-sm font-medium text-slate-700",children:"Security Level"}),e.jsxs("select",{id:"location-security",value:pe.securityLevel,onChange:$=>Ae({...pe,securityLevel:$.target.value}),className:"w-full px-3 py-3 bg-white border border-slate-300 rounded-lg text-base focus:border-orange-400 focus:ring-1 focus:ring-orange-100 transition-all duration-200",children:[e.jsx("option",{value:"STANDARD",children:"Standard Security"}),e.jsx("option",{value:"HIGH",children:"High Security"}),e.jsx("option",{value:"MAXIMUM",children:"Maximum Security"}),e.jsx("option",{value:"RESTRICTED",children:"Restricted Access"})]})]})]})]}),e.jsxs("div",{className:"pt-6 border-t border-slate-200",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-4",children:"Special Features"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-4",children:e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"location-temperature",checked:pe.temperatureControlled,onChange:$=>Ae({...pe,temperatureControlled:$.target.checked}),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v6,{className:"w-4 h-4 text-blue-600"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"location-temperature",className:"text-sm font-medium cursor-pointer",children:"Temperature Controlled"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Climate-controlled environment for sensitive products"})]})]})]})})]}),e.jsx("div",{className:"pt-6 border-t border-slate-200",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"location-instructions",className:"text-sm font-medium text-slate-700",children:"Special Instructions"}),e.jsx(Xs,{id:"location-instructions",value:pe.specialInstructions,onChange:$=>Ae({...pe,specialInstructions:$.target.value}),placeholder:"Any special handling requirements, access procedures, or operational notes",rows:4,className:"resize-none border-slate-300 focus:border-orange-400 focus:ring-1 focus:ring-orange-100 transition-all duration-200"})]})}),e.jsx("div",{className:"pt-6 border-t border-slate-200",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"location-notes",className:"text-sm font-medium text-slate-700",children:"Internal Notes"}),e.jsx(Xs,{id:"location-notes",value:pe.notes,onChange:$=>Ae({...pe,notes:$.target.value}),placeholder:"Internal notes for staff use only (not visible to customers)",rows:4,className:"resize-none border-slate-300 focus:border-orange-400 focus:ring-1 focus:ring-orange-100 transition-all duration-200"}),e.jsx("p",{className:"text-xs text-slate-500",children:"These notes are for internal use and won't be displayed to external users"})]})}),e.jsxs("div",{className:"mt-8 p-4 bg-gradient-to-br from-orange-50 to-red-50 rounded-lg border border-orange-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-800 mb-3",children:"Configuration Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${pe.isActive?"bg-green-500":"bg-orange-500"}`}),e.jsx("span",{className:"text-slate-600",children:pe.isActive?"Active":"Inactive"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${pe.isDefault?"bg-blue-500":"bg-gray-400"}`}),e.jsx("span",{className:"text-slate-600",children:pe.isDefault?"Default":"Standard"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${pe.temperatureControlled?"bg-blue-500":"bg-gray-400"}`}),e.jsx("span",{className:"text-slate-600",children:pe.temperatureControlled?"Climate Controlled":"Standard Storage"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(kn,{className:"w-3 h-3 text-orange-600"}),e.jsxs("span",{className:"text-slate-600",children:[pe.securityLevel||"Standard"," Security"]})]})]})]})]})]})})]})]})}),e.jsx(Xr,{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"text-sm text-slate-600",children:[e.jsx("span",{className:"font-medium",children:pe.name||"New Location"}),pe.locationType&&e.jsx("span",{className:"ml-2 px-2 py-1 bg-slate-100 text-slate-600 rounded text-xs",children:pe.locationType.replace("_"," ")})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(I,{variant:"outline",onClick:()=>y(!1),className:"px-6",children:"Cancel"}),e.jsx(I,{onClick:async()=>{var $,Xt,ds,Us;try{if(!pe.name){dt({title:"Validation Error",description:"Location name is required",variant:"destructive"});return}const H={...pe,companyId:_e,tenantId:Rt()};(!H.code||H.code.trim()==="")&&(H.code=`LOC-${Date.now()}-${Math.random().toString(36).substr(2,4)}`),console.log("Creating location with data:",H);const Ce=await Ra.createLocation(H);console.log("Created location response:",Ce),dt({title:"Success",description:"Location created successfully"}),Ae({name:"",code:"",description:"",locationType:"WAREHOUSE",address:"",address2:"",city:"",state:"",country:"",postalCode:"",latitude:"",longitude:"",contactName:"",contactPhone:"",contactEmail:"",managerName:"",managerEmail:"",managerPhone:"",isActive:!0,isDefault:!1,capacity:"",timezone:"",operatingHours:"",specialInstructions:"",warehouseZone:"",temperatureControlled:!1,securityLevel:"STANDARD",notes:""}),y(!1),pt.invalidateQueries({queryKey:["locations"]})}catch(H){console.error("Location creation error:",H);let Ce="Failed to create location. Please try again.";((Xt=($=H==null?void 0:H.response)==null?void 0:$.data)==null?void 0:Xt.error)==="Location code already exists"?Ce=H.response.data.message||"A location with this code already exists. Please choose a different code.":(Us=(ds=H==null?void 0:H.response)==null?void 0:ds.data)!=null&&Us.message?Ce=H.response.data.message:H!=null&&H.message&&(Ce=H.message),dt({title:"Error",description:Ce,variant:"destructive"})}},className:"px-8 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700",children:"Create Location"})]})]})})]})}),e.jsx(ts,{open:w,onOpenChange:N,children:e.jsxs(ss,{className:"!max-w-6xl max-h-[95vh] overflow-y-auto w-[95vw] md:max-h-[90vh] md:w-[90vw] bg-gradient-to-br from-slate-50 to-blue-50",children:[e.jsx(as,{className:"bg-white rounded-xl shadow-sm p-6 border border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl shadow-lg",children:e.jsx(Pa,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx(is,{className:"text-2xl font-bold text-slate-800",children:"Location Details"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Complete location information and statistics"})]})]})}),D&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Zl,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Basic Information"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Essential location details and identification"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Location Name"}),e.jsx("p",{className:"text-lg font-semibold text-slate-800",children:D.name})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Location Code"}),e.jsx("p",{className:"text-sm text-slate-700",children:D.code||"Not specified"})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Location Type"}),e.jsx(Oe,{variant:"outline",className:"mt-1",children:D.locationType||D.type||"WAREHOUSE"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Status"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(Oe,{variant:D.isActive?"default":"secondary",children:D.isActive?"Active":"Inactive"}),D.isDefault&&e.jsx(Oe,{variant:"outline",children:"Default Location"})]})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Description"}),e.jsx("p",{className:"text-sm text-slate-700 mt-1",children:D.description||"No description provided"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Pa,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Address Information"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Physical location and geographic coordinates"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Street Address"}),e.jsx("p",{className:"text-sm text-slate-700",children:D.address||"No address provided"})]}),D.address2&&e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Address Line 2"}),e.jsx("p",{className:"text-sm text-slate-700",children:D.address2})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"City"}),e.jsx("p",{className:"text-sm text-slate-700",children:D.city||"Not specified"})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"State"}),e.jsx("p",{className:"text-sm text-slate-700",children:D.state||"Not specified"})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Postal Code"}),e.jsx("p",{className:"text-sm text-slate-700",children:D.postalCode||"Not specified"})]})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Country"}),e.jsx("p",{className:"text-sm text-slate-700",children:D.country||"Not specified"})]})]}),e.jsxs("div",{className:"space-y-4",children:[(D.latitude||D.longitude)&&e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Geographic Coordinates"}),e.jsxs("div",{className:"flex gap-4 mt-1",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Latitude:"}),e.jsx("p",{className:"text-sm font-mono text-slate-700",children:D.latitude||"Not set"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Longitude:"}),e.jsx("p",{className:"text-sm font-mono text-slate-700",children:D.longitude||"Not set"})]})]})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Timezone"}),e.jsx("p",{className:"text-sm text-slate-700",children:D.timezone||"Not specified"})]})]})]})]}),(D.contactName||D.managerName)&&e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(bo,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Contact Information"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Primary contacts and management details"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[D.contactName&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-3",children:"Primary Contact"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-xs text-gray-500",children:"Contact Name"}),e.jsx("p",{className:"text-sm text-slate-700",children:D.contactName})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-xs text-gray-500",children:"Phone"}),e.jsx("p",{className:"text-sm text-slate-700",children:D.contactPhone||"Not provided"})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-xs text-gray-500",children:"Email"}),e.jsx("p",{className:"text-sm text-slate-700 break-words",children:D.contactEmail||"Not provided"})]})]})]}),D.managerName&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-3",children:"Manager Information"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-xs text-gray-500",children:"Manager Name"}),e.jsx("p",{className:"text-sm text-slate-700",children:D.managerName})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-xs text-gray-500",children:"Manager Phone"}),e.jsx("p",{className:"text-sm text-slate-700",children:D.managerPhone||"Not provided"})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-xs text-gray-500",children:"Manager Email"}),e.jsx("p",{className:"text-sm text-slate-700 break-words",children:D.managerEmail||"Not provided"})]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:e.jsx(en,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Settings & Operations"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Operational settings and special configurations"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Storage Capacity"}),e.jsx("p",{className:"text-sm text-slate-700",children:D.capacity||"Not specified"})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Operating Hours"}),e.jsx("p",{className:"text-sm text-slate-700",children:D.operatingHours||"Not specified"})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Security Level"}),e.jsx(Oe,{variant:"outline",className:"mt-1",children:D.securityLevel||"STANDARD"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Special Features"}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-1",children:[D.temperatureControlled&&e.jsx(Oe,{variant:"secondary",children:"Temperature Controlled"}),D.isDefault&&e.jsx(Oe,{variant:"outline",children:"Default Location"})]})]}),D.notes&&e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Notes"}),e.jsx("p",{className:"text-sm text-slate-700 mt-1",children:D.notes})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg",children:e.jsx(lr,{className:"w-5 h-5 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Location Statistics"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Inventory and activity metrics"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:((Qo=D._count)==null?void 0:Qo.products)||0}),e.jsx("p",{className:"text-sm text-gray-500",children:"Products"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:((Xi=D._count)==null?void 0:Xi.movements)||0}),e.jsx("p",{className:"text-sm text-gray-500",children:"Movements"})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:((_o=D._count)==null?void 0:_o.transfers)||0}),e.jsx("p",{className:"text-sm text-gray-500",children:"Transfers"})]}),e.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:((qo=D._count)==null?void 0:qo.alerts)||0}),e.jsx("p",{className:"text-sm text-gray-500",children:"Alerts"})]})]})]})]}),e.jsxs(Xr,{className:"bg-white rounded-xl shadow-sm p-6 border border-slate-200",children:[e.jsx(I,{variant:"outline",onClick:()=>N(!1),children:"Close"}),e.jsx(I,{onClick:()=>{N(!1),Vs(D)},className:"bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700",children:"Edit Location"})]})]})}),e.jsx(ts,{open:j,onOpenChange:b,children:e.jsxs(ss,{className:"!max-w-7xl max-h-[95vh] overflow-y-auto w-[95vw] md:max-h-[90vh] md:w-[90vw] bg-gradient-to-br from-slate-50 to-blue-50",children:[e.jsx(as,{className:"bg-white rounded-xl shadow-sm p-6 border border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl shadow-lg",children:e.jsx(Pa,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx(is,{className:"text-2xl font-bold text-slate-800",children:"Edit Location"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Update location information and settings"})]})]})}),e.jsx("div",{className:"flex-1",children:e.jsxs(an,{defaultValue:"basic",className:"h-full flex flex-col",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-2 mb-4",children:e.jsxs(on,{className:"grid w-full grid-cols-4 gap-1",children:[e.jsxs(vt,{value:"basic",className:"flex items-center gap-2 py-3 px-4 data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-indigo-600 data-[state=active]:text-white transition-all duration-300",children:[e.jsx(Zl,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Basic Info"})]}),e.jsxs(vt,{value:"address",className:"flex items-center gap-2 py-3 px-4 data-[state=active]:bg-gradient-to-r data-[state=active]:from-green-500 data-[state=active]:to-emerald-600 data-[state=active]:text-white transition-all duration-300",children:[e.jsx(Pa,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Address"})]}),e.jsxs(vt,{value:"contact",className:"flex items-center gap-2 py-3 px-4 data-[state=active]:bg-gradient-to-r data-[state=active]:from-purple-500 data-[state=active]:to-pink-600 data-[state=active]:text-white transition-all duration-300",children:[e.jsx(bo,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Contact"})]}),e.jsxs(vt,{value:"settings",className:"flex items-center gap-2 py-3 px-4 data-[state=active]:bg-gradient-to-r data-[state=active]:from-orange-500 data-[state=active]:to-red-600 data-[state=active]:text-white transition-all duration-300",children:[e.jsx(en,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Settings"})]})]})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(yt,{value:"basic",children:e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Zl,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Basic Information"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Essential location details and identification"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-location-name",className:"text-sm font-medium text-slate-700",children:"Location Name *"}),e.jsx(ge,{id:"edit-location-name",value:pe.name,onChange:$=>Ae({...pe,name:$.target.value}),placeholder:"e.g., Main Warehouse, Downtown Store",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-location-code",className:"text-sm font-medium text-slate-700",children:"Location Code"}),e.jsx(ge,{id:"edit-location-code",value:pe.code,onChange:$=>Ae({...pe,code:$.target.value}),placeholder:"e.g., WH-001, STORE-NYC",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-location-description",className:"text-sm font-medium text-slate-700",children:"Description"}),e.jsx(Xs,{id:"edit-location-description",value:pe.description,onChange:$=>Ae({...pe,description:$.target.value}),placeholder:"Brief description of the location, its purpose, and key features",rows:3,className:"resize-none border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-location-type",className:"text-sm font-medium text-slate-700",children:"Location Type"}),e.jsxs(rt,{value:pe.locationType,onValueChange:$=>Ae({...pe,locationType:$}),children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200",children:e.jsx(it,{placeholder:"Select location type"})}),e.jsxs(at,{children:[e.jsx(W,{value:"WAREHOUSE",children:"Warehouse"}),e.jsx(W,{value:"STORE",children:"Store"}),e.jsx(W,{value:"OFFICE",children:"Office"}),e.jsx(W,{value:"DISTRIBUTION_CENTER",children:"Distribution Center"}),e.jsx(W,{value:"FACTORY",children:"Factory"}),e.jsx(W,{value:"SHOWROOM",children:"Showroom"}),e.jsx(W,{value:"OTHER",children:"Other"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"edit-location-active",checked:pe.isActive,onChange:$=>Ae({...pe,isActive:$.target.checked}),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-location-active",className:"text-sm font-medium cursor-pointer",children:"Active Location"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Location is operational and available"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"edit-location-default",checked:pe.isDefault,onChange:$=>Ae({...pe,isDefault:$.target.checked}),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(go,{className:"w-4 h-4 text-blue-600"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-location-default",className:"text-sm font-medium cursor-pointer",children:"Default Location"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Set as default for new inventory"})]})]})]})]})]})]})}),e.jsx(yt,{value:"address",children:e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Pa,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Address Information"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Physical location and geographic coordinates"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-location-address",className:"text-sm font-medium text-slate-700",children:"Street Address"}),e.jsx(ge,{id:"edit-location-address",value:pe.address,onChange:$=>Ae({...pe,address:$.target.value}),placeholder:"e.g., 123 Business Park Drive",className:"py-3 text-base border-slate-300 focus:border-green-400 focus:ring-1 focus:ring-green-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-location-address2",className:"text-sm font-medium text-slate-700",children:"Address Line 2 (Optional)"}),e.jsx(ge,{id:"edit-location-address2",value:pe.address2,onChange:$=>Ae({...pe,address2:$.target.value}),placeholder:"e.g., Suite 100, Building A",className:"py-3 text-base border-slate-300 focus:border-green-400 focus:ring-1 focus:ring-green-100 transition-all duration-200"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-location-city",className:"text-sm font-medium text-slate-700",children:"City"}),e.jsx(ge,{id:"edit-location-city",value:pe.city,onChange:$=>Ae({...pe,city:$.target.value}),placeholder:"e.g., New York",className:"py-3 text-base border-slate-300 focus:border-green-400 focus:ring-1 focus:ring-green-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-location-state",className:"text-sm font-medium text-slate-700",children:"State/Province"}),e.jsx(ge,{id:"edit-location-state",value:pe.state,onChange:$=>Ae({...pe,state:$.target.value}),placeholder:"e.g., NY",className:"py-3 text-base border-slate-300 focus:border-green-400 focus:ring-1 focus:ring-green-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-location-postal",className:"text-sm font-medium text-slate-700",children:"Postal Code"}),e.jsx(ge,{id:"edit-location-postal",value:pe.postalCode,onChange:$=>Ae({...pe,postalCode:$.target.value}),placeholder:"e.g., 10001",className:"py-3 text-base border-slate-300 focus:border-green-400 focus:ring-1 focus:ring-green-100 transition-all duration-200"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-location-country",className:"text-sm font-medium text-slate-700",children:"Country"}),e.jsx(ge,{id:"edit-location-country",value:pe.country,onChange:$=>Ae({...pe,country:$.target.value}),placeholder:"e.g., United States",className:"py-3 text-base border-slate-300 focus:border-green-400 focus:ring-1 focus:ring-green-100 transition-all duration-200"})]}),e.jsxs("div",{className:"pt-6 border-t border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800",children:"Geographic Coordinates (Optional)"}),e.jsxs(I,{type:"button",variant:"outline",size:"sm",onClick:async()=>{if(!navigator.geolocation){dt({title:"Geolocation Not Supported",description:"Your browser doesn't support geolocation. Please enter coordinates manually.",variant:"destructive"});return}dt({title:"Getting Location...",description:"Please allow location access to automatically fill coordinates."}),navigator.geolocation.getCurrentPosition($=>{const{latitude:Xt,longitude:ds}=$.coords;Ae({...pe,latitude:Xt.toString(),longitude:ds.toString()}),dt({title:"Location Retrieved",description:`Coordinates set: ${Xt.toFixed(6)}, ${ds.toFixed(6)}`})},$=>{let Xt="Unable to retrieve location.";switch($.code){case $.PERMISSION_DENIED:Xt="Location access denied. Please enable location permissions.";break;case $.POSITION_UNAVAILABLE:Xt="Location information unavailable.";break;case $.TIMEOUT:Xt="Location request timed out.";break}dt({title:"Location Error",description:Xt,variant:"destructive"})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})},className:"flex items-center gap-2",children:[e.jsx(Pa,{className:"w-4 h-4"}),"Get Current Location"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(B,{htmlFor:"edit-location-latitude",className:"text-sm font-medium text-slate-700 flex items-center gap-2",children:["Latitude",pe.latitude&&e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(Ro,{className:"w-3 h-3"}),e.jsx("span",{className:"text-xs",children:"Auto-filled"})]})]}),e.jsx(ge,{id:"edit-location-latitude",value:pe.latitude,onChange:$=>Ae({...pe,latitude:$.target.value}),placeholder:"e.g., 40.7128",className:`py-3 text-base transition-all duration-200 ${pe.latitude?"border-green-300 bg-green-50/30 focus:border-green-400 focus:ring-1 focus:ring-green-100":"border-slate-300 focus:border-green-400 focus:ring-1 focus:ring-green-100"}`})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(B,{htmlFor:"edit-location-longitude",className:"text-sm font-medium text-slate-700 flex items-center gap-2",children:["Longitude",pe.longitude&&e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(Ro,{className:"w-3 h-3"}),e.jsx("span",{className:"text-xs",children:"Auto-filled"})]})]}),e.jsx(ge,{id:"edit-location-longitude",value:pe.longitude,onChange:$=>Ae({...pe,longitude:$.target.value}),placeholder:"e.g., -74.0060",className:`py-3 text-base transition-all duration-200 ${pe.longitude?"border-green-300 bg-green-50/30 focus:border-green-400 focus:ring-1 focus:ring-green-100":"border-slate-300 focus:border-green-400 focus:ring-1 focus:ring-green-100"}`})]})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Coordinates help with routing and mapping integrations"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-location-timezone",className:"text-sm font-medium text-slate-700",children:"Timezone"}),e.jsxs("select",{id:"edit-location-timezone",value:pe.timezone,onChange:$=>Ae({...pe,timezone:$.target.value}),className:"w-full px-3 py-3 bg-white border border-slate-300 rounded-lg text-base focus:border-green-400 focus:ring-1 focus:ring-green-100 transition-all duration-200",children:[e.jsx("option",{value:"",children:"Select timezone"}),e.jsx("option",{value:"America/New_York",children:"Eastern Time (EST/EDT)"}),e.jsx("option",{value:"America/Chicago",children:"Central Time (CST/CDT)"}),e.jsx("option",{value:"America/Denver",children:"Mountain Time (MST/MDT)"}),e.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time (PST/PDT)"}),e.jsx("option",{value:"Europe/London",children:"Greenwich Mean Time (GMT)"}),e.jsx("option",{value:"Europe/Paris",children:"Central European Time (CET)"}),e.jsx("option",{value:"Asia/Tokyo",children:"Japan Standard Time (JST)"}),e.jsx("option",{value:"Asia/Shanghai",children:"China Standard Time (CST)"})]})]})]})]})}),e.jsx(yt,{value:"contact",children:e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(bo,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Contact Information"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Primary contacts and management details"})]})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-4",children:"Primary Contact"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-location-contact-name",className:"text-sm font-medium text-slate-700",children:"Contact Name"}),e.jsx(ge,{id:"edit-location-contact-name",value:pe.contactName,onChange:$=>Ae({...pe,contactName:$.target.value}),placeholder:"e.g., John Smith",className:"py-3 text-base border-slate-300 focus:border-purple-400 focus:ring-1 focus:ring-purple-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-location-contact-phone",className:"text-sm font-medium text-slate-700",children:"Phone Number"}),e.jsx(ge,{id:"edit-location-contact-phone",value:pe.contactPhone,onChange:$=>Ae({...pe,contactPhone:$.target.value}),placeholder:"e.g., +1 (555) 123-4567",className:"py-3 text-base border-slate-300 focus:border-purple-400 focus:ring-1 focus:ring-purple-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-location-contact-email",className:"text-sm font-medium text-slate-700",children:"Email Address"}),e.jsx(ge,{id:"edit-location-contact-email",type:"email",value:pe.contactEmail,onChange:$=>Ae({...pe,contactEmail:$.target.value}),placeholder:"e.g., contact@location.com",className:"py-3 text-base border-slate-300 focus:border-purple-400 focus:ring-1 focus:ring-purple-100 transition-all duration-200"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-4",children:"Manager Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-location-manager-name",className:"text-sm font-medium text-slate-700",children:"Manager Name"}),e.jsx(ge,{id:"edit-location-manager-name",value:pe.managerName,onChange:$=>Ae({...pe,managerName:$.target.value}),placeholder:"e.g., Jane Doe",className:"py-3 text-base border-slate-300 focus:border-purple-400 focus:ring-1 focus:ring-purple-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-location-manager-phone",className:"text-sm font-medium text-slate-700",children:"Manager Phone"}),e.jsx(ge,{id:"edit-location-manager-phone",value:pe.managerPhone,onChange:$=>Ae({...pe,managerPhone:$.target.value}),placeholder:"e.g., +1 (555) 987-6543",className:"py-3 text-base border-slate-300 focus:border-purple-400 focus:ring-1 focus:ring-purple-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-location-manager-email",className:"text-sm font-medium text-slate-700",children:"Manager Email"}),e.jsx(ge,{id:"edit-location-manager-email",type:"email",value:pe.managerEmail,onChange:$=>Ae({...pe,managerEmail:$.target.value}),placeholder:"e.g., manager@location.com",className:"py-3 text-base border-slate-300 focus:border-purple-400 focus:ring-1 focus:ring-purple-100 transition-all duration-200"})]})]})]})]})]})}),e.jsx(yt,{value:"settings",children:e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:e.jsx(en,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Location Settings"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Operational settings and special configurations"})]})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-4",children:"Capacity & Operations"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-location-capacity",className:"text-sm font-medium text-slate-700",children:"Storage Capacity"}),e.jsx(ge,{id:"edit-location-capacity",value:pe.capacity,onChange:$=>Ae({...pe,capacity:$.target.value}),placeholder:"e.g., 1000 sq ft, 500 pallets",className:"py-3 text-base border-slate-300 focus:border-orange-400 focus:ring-1 focus:ring-orange-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-location-operating-hours",className:"text-sm font-medium text-slate-700",children:"Operating Hours"}),e.jsx(ge,{id:"edit-location-operating-hours",value:pe.operatingHours,onChange:$=>Ae({...pe,operatingHours:$.target.value}),placeholder:"e.g., Mon-Fri 8AM-6PM",className:"py-3 text-base border-slate-300 focus:border-orange-400 focus:ring-1 focus:ring-orange-100 transition-all duration-200"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-4",children:"Special Features"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"edit-location-temperature",checked:pe.temperatureControlled,onChange:$=>Ae({...pe,temperatureControlled:$.target.checked}),className:"w-4 h-4 text-orange-600 bg-gray-100 border-gray-300 rounded focus:ring-orange-500"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-location-temperature",className:"text-sm font-medium cursor-pointer",children:"Temperature Controlled"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Location has climate control systems"})]})]})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-4",children:"Security & Notes"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-location-security",className:"text-sm font-medium text-slate-700",children:"Security Level"}),e.jsxs(rt,{value:pe.securityLevel,onValueChange:$=>Ae({...pe,securityLevel:$}),children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-orange-400 focus:ring-1 focus:ring-orange-100 transition-all duration-200",children:e.jsx(it,{placeholder:"Select security level"})}),e.jsxs(at,{children:[e.jsx(W,{value:"STANDARD",children:"Standard"}),e.jsx(W,{value:"HIGH",children:"High Security"}),e.jsx(W,{value:"MAXIMUM",children:"Maximum Security"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"edit-location-notes",className:"text-sm font-medium text-slate-700",children:"Special Instructions & Notes"}),e.jsx(Xs,{id:"edit-location-notes",value:pe.notes,onChange:$=>Ae({...pe,notes:$.target.value}),placeholder:"Any special instructions, access requirements, or important notes about this location",rows:4,className:"resize-none border-slate-300 focus:border-orange-400 focus:ring-1 focus:ring-orange-100 transition-all duration-200"})]})]})]})]})]})})]})]})}),e.jsxs(Xr,{className:"bg-white rounded-xl shadow-sm p-6 border border-slate-200",children:[e.jsx(I,{variant:"outline",onClick:()=>b(!1),children:"Cancel"}),e.jsx(I,{onClick:async()=>{try{if(!pe.name){dt({title:"Validation Error",description:"Location name is required",variant:"destructive"});return}await Ra.updateLocation(D.id,{...pe,companyId:_e,tenantId:Rt()}),dt({title:"Success",description:"Location updated successfully"}),b(!1),pt.invalidateQueries({queryKey:["locations"]})}catch{dt({title:"Error",description:"Failed to update location. Please try again.",variant:"destructive"})}},children:"Update Location"})]})]})}),e.jsx(ts,{open:C,onOpenChange:S,children:e.jsxs(ss,{className:"!max-w-7xl max-h-[95vh] overflow-y-auto w-[95vw] md:max-h-[90vh] md:w-[90vw] bg-gradient-to-br from-slate-50 to-indigo-50",children:[e.jsx(as,{className:"bg-white rounded-xl shadow-sm p-6 border border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl shadow-lg",children:e.jsx(Wd,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx(is,{className:"text-2xl font-bold text-slate-800",children:"Create New Movement"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Record inventory transactions and stock adjustments"})]})]})}),e.jsx("div",{className:"flex-1",children:e.jsxs(an,{defaultValue:"basic",className:"h-full flex flex-col",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-2 mb-4",children:e.jsxs(on,{className:"grid w-full grid-cols-4 gap-1",children:[e.jsxs(vt,{value:"basic",className:"flex items-center gap-2 py-3 px-4 data-[state=active]:bg-gradient-to-r data-[state=active]:from-indigo-500 data-[state=active]:to-purple-600 data-[state=active]:text-white transition-all duration-300",children:[e.jsx(Hr,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Basic Info"})]}),e.jsxs(vt,{value:"details",className:"flex items-center gap-2 py-3 px-4 data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-cyan-600 data-[state=active]:text-white transition-all duration-300",children:[e.jsx(yn,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Details"})]}),e.jsxs(vt,{value:"tracking",className:"flex items-center gap-2 py-3 px-4 data-[state=active]:bg-gradient-to-r data-[state=active]:from-green-500 data-[state=active]:to-teal-600 data-[state=active]:text-white transition-all duration-300",children:[e.jsx(dl,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Tracking"})]}),e.jsxs(vt,{value:"workflow",className:"flex items-center gap-2 py-3 px-4 data-[state=active]:bg-gradient-to-r data-[state=active]:from-orange-500 data-[state=active]:to-red-600 data-[state=active]:text-white transition-all duration-300",children:[e.jsx(en,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Workflow"})]})]})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(yt,{value:"basic",children:e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-indigo-100 rounded-lg",children:e.jsx(Hr,{className:"w-5 h-5 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Movement Information"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Essential movement details and product selection"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"movement-product",className:"text-sm font-medium text-slate-700",children:"Product *"}),e.jsxs(rt,{value:Ee.productId,onValueChange:$=>{const Xt=Je.find(H=>H.id===$),ds=Xt?Number(Xt.costPrice):0,Us=Ee.autoCalculateTotal?ds*Ee.quantity:Ee.totalCost;$e({...Ee,productId:$,unitCost:ds,totalCost:Us})},children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-indigo-400 focus:ring-1 focus:ring-indigo-100",children:e.jsx(it,{placeholder:"Select a product to move"})}),e.jsx(at,{children:Je.map($=>e.jsx(W,{value:$.id,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-100 to-indigo-100 rounded-lg flex items-center justify-center",children:e.jsx(Hr,{className:"w-4 h-4 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:$.name}),e.jsxs("div",{className:"text-sm text-slate-500",children:["SKU: ",$.sku]})]})]})},$.id))})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"movement-type",className:"text-sm font-medium text-slate-700",children:"Movement Type *"}),e.jsxs(rt,{value:Ee.movementType,onValueChange:$=>$e({...Ee,movementType:$}),children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-indigo-400 focus:ring-1 focus:ring-indigo-100",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"INBOUND",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{children:"Inbound (Stock In)"})]})}),e.jsx(W,{value:"OUTBOUND",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),e.jsx("span",{children:"Outbound (Stock Out)"})]})}),e.jsx(W,{value:"TRANSFER_IN",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{children:"Transfer In"})]})}),e.jsx(W,{value:"TRANSFER_OUT",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),e.jsx("span",{children:"Transfer Out"})]})}),e.jsx(W,{value:"ADJUSTMENT_IN",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("span",{children:"Adjustment In"})]})}),e.jsx(W,{value:"ADJUSTMENT_OUT",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),e.jsx("span",{children:"Adjustment Out"})]})}),e.jsx(W,{value:"RETURN_IN",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-teal-500 rounded-full"}),e.jsx("span",{children:"Return In"})]})}),e.jsx(W,{value:"RETURN_OUT",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-pink-500 rounded-full"}),e.jsx("span",{children:"Return Out"})]})})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"movement-quantity",className:"text-sm font-medium text-slate-700",children:"Quantity *"}),e.jsx(ge,{id:"movement-quantity",type:"number",min:"0",step:"1",value:Ee.quantity,onChange:$=>{const Xt=parseFloat($.target.value)||0,ds=Ee.autoCalculateTotal?Ee.unitCost*Xt:Ee.totalCost;$e({...Ee,quantity:Xt,totalCost:ds})},placeholder:"Enter quantity",className:"py-3 text-base border-slate-300 focus:border-indigo-400 focus:ring-1 focus:ring-indigo-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"movement-date",className:"text-sm font-medium text-slate-700",children:"Movement Date *"}),e.jsx(ge,{id:"movement-date",type:"date",value:Ee.movementDate,onChange:$=>$e({...Ee,movementDate:$.target.value}),className:"py-3 text-base border-slate-300 focus:border-indigo-400 focus:ring-1 focus:ring-indigo-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"movement-time",className:"text-sm font-medium text-slate-700",children:"Movement Time"}),e.jsx(ge,{id:"movement-time",type:"time",value:Ee.movementTime,onChange:$=>$e({...Ee,movementTime:$.target.value}),className:"py-3 text-base border-slate-300 focus:border-indigo-400 focus:ring-1 focus:ring-indigo-100 transition-all duration-200"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"movement-location",className:"text-sm font-medium text-slate-700",children:"Primary Location"}),e.jsxs(rt,{value:Ee.locationId,onValueChange:$=>$e({...Ee,locationId:$}),children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-indigo-400 focus:ring-1 focus:ring-indigo-100",children:e.jsx(it,{placeholder:"Select a location"})}),e.jsx(at,{children:It.map($=>e.jsx(W,{value:$.id,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Pa,{className:"w-4 h-4 text-indigo-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:$.name}),e.jsx("div",{className:"text-sm text-slate-500",children:$.code})]})]})},$.id))})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"movement-reason",className:"text-sm font-medium text-slate-700",children:"Reason/Notes"}),e.jsx(Xs,{id:"movement-reason",value:Ee.reason,onChange:$=>$e({...Ee,reason:$.target.value}),placeholder:"Enter reason or notes for this movement",rows:3,className:"resize-none border-slate-300 focus:border-indigo-400 focus:ring-1 focus:ring-indigo-100 transition-all duration-200"})]}),Ee.productId&&e.jsxs("div",{className:"mt-8 p-4 bg-gradient-to-br from-indigo-50 to-purple-50 rounded-lg border border-indigo-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-800 mb-3",children:"Movement Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Hr,{className:"w-4 h-4 text-indigo-600"}),e.jsxs("span",{className:"text-slate-600",children:["Product: ",(($l=Je.find($=>$.id===Ee.productId))==null?void 0:$l.name)||"Selected"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Wd,{className:"w-4 h-4 text-indigo-600"}),e.jsxs("span",{className:"text-slate-600",children:["Type: ",Ee.movementType.replace("_"," ")]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-indigo-500 rounded-full"}),e.jsxs("span",{className:"text-slate-600",children:["Qty: ",Ee.quantity]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xn,{className:"w-4 h-4 text-indigo-600"}),e.jsxs("span",{className:"text-slate-600",children:["Date: ",new Date(Ee.movementDate).toLocaleDateString()]})]})]})]})]})]})}),e.jsx(yt,{value:"details",children:e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(yn,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Financial Details"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Cost tracking and financial information"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"movement-unit-cost",className:"text-sm font-medium text-slate-700",children:"Unit Cost"}),e.jsxs("div",{className:"relative",children:[e.jsx(Mr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx(ge,{id:"movement-unit-cost",type:"number",min:"0",step:"0.01",value:Ee.unitCost,onChange:$=>{const Xt=parseFloat($.target.value)||0,ds=Ee.autoCalculateTotal?Xt*Ee.quantity:Ee.totalCost;$e({...Ee,unitCost:Xt,totalCost:ds})},placeholder:"0.00",className:"pl-10 py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"movement-total-cost",className:"text-sm font-medium text-slate-700",children:"Total Cost"}),e.jsxs("div",{className:"relative",children:[e.jsx(Mr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx(ge,{id:"movement-total-cost",type:"number",min:"0",step:"0.01",value:Ee.totalCost,onChange:$=>$e({...Ee,totalCost:parseFloat($.target.value)||0}),placeholder:"0.00",disabled:Ee.autoCalculateTotal,className:`pl-10 py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200 ${Ee.autoCalculateTotal?"bg-slate-50 cursor-not-allowed":""}`})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors w-full",children:[e.jsx("input",{type:"checkbox",id:"auto-calculate-total",checked:Ee.autoCalculateTotal,onChange:$=>{const Xt=$.target.checked,ds=Xt?Ee.unitCost*Ee.quantity:Ee.totalCost;$e({...Ee,autoCalculateTotal:Xt,totalCost:ds})},className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"auto-calculate-total",className:"text-sm font-medium cursor-pointer",children:"Auto Calculate"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Calculate total automatically"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"movement-reference",className:"text-sm font-medium text-slate-700",children:"Reference Number"}),e.jsx(ge,{id:"movement-reference",value:Ee.reference,onChange:$=>$e({...Ee,reference:$.target.value}),placeholder:"e.g., PO-001, INV-123, REF-456",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"movement-invoice",className:"text-sm font-medium text-slate-700",children:"Invoice Number"}),e.jsx(ge,{id:"movement-invoice",value:Ee.invoiceNumber,onChange:$=>$e({...Ee,invoiceNumber:$.target.value}),placeholder:"e.g., INV-2024-001",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"movement-department",className:"text-sm font-medium text-slate-700",children:"Department"}),e.jsx(ge,{id:"movement-department",value:Ee.department,onChange:$=>$e({...Ee,department:$.target.value}),placeholder:"e.g., Warehouse, Sales",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"movement-project",className:"text-sm font-medium text-slate-700",children:"Project"}),e.jsx(ge,{id:"movement-project",value:Ee.project,onChange:$=>$e({...Ee,project:$.target.value}),placeholder:"e.g., Project Alpha",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"movement-cost-center",className:"text-sm font-medium text-slate-700",children:"Cost Center"}),e.jsx(ge,{id:"movement-cost-center",value:Ee.costCenter,onChange:$=>$e({...Ee,costCenter:$.target.value}),placeholder:"e.g., CC-001",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]})]}),Ee.quantity>0&&Ee.unitCost>0&&e.jsxs("div",{className:"mt-8 p-4 bg-gradient-to-br from-blue-50 to-cyan-50 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-800 mb-3",children:"Cost Breakdown"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-white rounded-lg border",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:["$",Ee.unitCost.toFixed(2)]}),e.jsx("div",{className:"text-sm text-slate-600",children:"Unit Cost"})]}),e.jsxs("div",{className:"text-center p-3 bg-white rounded-lg border",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:Ee.quantity}),e.jsx("div",{className:"text-sm text-slate-600",children:"Quantity"})]}),e.jsxs("div",{className:"text-center p-3 bg-white rounded-lg border",children:[e.jsxs("div",{className:"text-2xl font-bold text-indigo-600",children:["$",Ee.totalCost.toFixed(2)]}),e.jsx("div",{className:"text-sm text-slate-600",children:"Total Cost"})]})]})]})]})]})}),e.jsx(yt,{value:"tracking",children:e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(dl,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Tracking Information"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Batch numbers, serial codes, and location transfers"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"movement-batch",className:"text-sm font-medium text-slate-700",children:"Batch Number"}),e.jsx(ge,{id:"movement-batch",value:Ee.batchNumber,onChange:$=>$e({...Ee,batchNumber:$.target.value}),placeholder:"e.g., BATCH-2024-001",className:"py-3 text-base border-slate-300 focus:border-green-400 focus:ring-1 focus:ring-green-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"movement-serial",className:"text-sm font-medium text-slate-700",children:"Serial Number"}),e.jsx(ge,{id:"movement-serial",value:Ee.serialNumber,onChange:$=>$e({...Ee,serialNumber:$.target.value}),placeholder:"e.g., SN123456789",className:"py-3 text-base border-slate-300 focus:border-green-400 focus:ring-1 focus:ring-green-100 transition-all duration-200"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"movement-expiry",className:"text-sm font-medium text-slate-700",children:"Expiry Date"}),e.jsx(ge,{id:"movement-expiry",type:"date",value:Ee.expiryDate,onChange:$=>$e({...Ee,expiryDate:$.target.value}),className:"py-3 text-base border-slate-300 focus:border-green-400 focus:ring-1 focus:ring-green-100 transition-all duration-200"})]}),(Ee.movementType==="TRANSFER_IN"||Ee.movementType==="TRANSFER_OUT")&&e.jsxs("div",{className:"pt-6 border-t border-slate-200",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-4",children:"Transfer Locations"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"movement-from-location",className:"text-sm font-medium text-slate-700",children:"From Location"}),e.jsxs(rt,{value:Ee.fromLocationId,onValueChange:$=>$e({...Ee,fromLocationId:$}),children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-green-400 focus:ring-1 focus:ring-green-100",children:e.jsx(it,{placeholder:"Select source location"})}),e.jsx(at,{children:It.map($=>e.jsx(W,{value:$.id,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Pa,{className:"w-4 h-4 text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:$.name}),e.jsx("div",{className:"text-sm text-slate-500",children:$.code})]})]})},$.id))})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"movement-to-location",className:"text-sm font-medium text-slate-700",children:"To Location"}),e.jsxs(rt,{value:Ee.toLocationId,onValueChange:$=>$e({...Ee,toLocationId:$}),children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-green-400 focus:ring-1 focus:ring-green-100",children:e.jsx(it,{placeholder:"Select destination location"})}),e.jsx(at,{children:It.map($=>e.jsx(W,{value:$.id,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Pa,{className:"w-4 h-4 text-green-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:$.name}),e.jsx("div",{className:"text-sm text-slate-500",children:$.code})]})]})},$.id))})]})]})]})]}),e.jsxs("div",{className:"mt-8 p-4 bg-gradient-to-br from-green-50 to-teal-50 rounded-lg border border-green-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-800 mb-3",children:"Tracking Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dl,{className:"w-4 h-4 text-green-600"}),e.jsxs("span",{className:"text-slate-600",children:["Batch: ",Ee.batchNumber||"Not set"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("span",{className:"text-slate-600",children:["Serial: ",Ee.serialNumber||"Not set"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xn,{className:"w-4 h-4 text-green-600"}),e.jsxs("span",{className:"text-slate-600",children:["Expiry: ",Ee.expiryDate?new Date(Ee.expiryDate).toLocaleDateString():"No expiry"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pa,{className:"w-4 h-4 text-green-600"}),e.jsxs("span",{className:"text-slate-600",children:["Transfer: ",Ee.fromLocationId||Ee.toLocationId?"Yes":"No"]})]})]})]})]})]})}),e.jsx(yt,{value:"workflow",children:e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:e.jsx(en,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Workflow Settings"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Approval process, priority, and status management"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"movement-priority",className:"text-sm font-medium text-slate-700",children:"Priority Level"}),e.jsxs(rt,{value:Ee.priority,onValueChange:$=>$e({...Ee,priority:$}),children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-orange-400 focus:ring-1 focus:ring-orange-100",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"LOW",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{children:"Low Priority"})]})}),e.jsx(W,{value:"NORMAL",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{children:"Normal Priority"})]})}),e.jsx(W,{value:"HIGH",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),e.jsx("span",{children:"High Priority"})]})}),e.jsx(W,{value:"URGENT",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),e.jsx("span",{children:"Urgent"})]})})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"movement-status",className:"text-sm font-medium text-slate-700",children:"Status"}),e.jsxs(rt,{value:Ee.status,onValueChange:$=>$e({...Ee,status:$}),children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-orange-400 focus:ring-1 focus:ring-orange-100",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"PENDING",children:"Pending"}),e.jsx(W,{value:"APPROVED",children:"Approved"}),e.jsx(W,{value:"PROCESSING",children:"Processing"}),e.jsx(W,{value:"COMPLETED",children:"Completed"}),e.jsx(W,{value:"CANCELLED",children:"Cancelled"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"movement-processed-by",className:"text-sm font-medium text-slate-700",children:"Processed By"}),e.jsx(ge,{id:"movement-processed-by",value:Ee.processedBy,onChange:$=>$e({...Ee,processedBy:$.target.value}),placeholder:"Staff member name",className:"py-3 text-base border-slate-300 focus:border-orange-400 focus:ring-1 focus:ring-orange-100 transition-all duration-200"})]})]}),e.jsxs("div",{className:"pt-6 border-t border-slate-200",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-4",children:"Workflow Options"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"movement-urgent",checked:Ee.isUrgent,onChange:$=>$e({...Ee,isUrgent:$.target.checked}),className:"w-4 h-4 text-red-600 bg-gray-100 border-gray-300 rounded focus:ring-red-500"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Is,{className:"w-4 h-4 text-red-600"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"movement-urgent",className:"text-sm font-medium cursor-pointer",children:"Urgent Movement"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Mark as urgent for priority processing"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"movement-approval",checked:Ee.requiresApproval,onChange:$=>$e({...Ee,requiresApproval:$.target.checked}),className:"w-4 h-4 text-orange-600 bg-gray-100 border-gray-300 rounded focus:ring-orange-500"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(kn,{className:"w-4 h-4 text-orange-600"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"movement-approval",className:"text-sm font-medium cursor-pointer",children:"Requires Approval"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Movement needs manager approval"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"movement-notes",className:"text-sm font-medium text-slate-700",children:"Internal Notes"}),e.jsx(Xs,{id:"movement-notes",value:Ee.notes,onChange:$=>$e({...Ee,notes:$.target.value}),placeholder:"Internal notes for staff use only (not visible to external users)",rows:4,className:"resize-none border-slate-300 focus:border-orange-400 focus:ring-1 focus:ring-orange-100 transition-all duration-200"}),e.jsx("p",{className:"text-xs text-slate-500",children:"These notes are for internal use and won't be displayed to external users"})]}),e.jsxs("div",{className:"mt-8 p-4 bg-gradient-to-br from-orange-50 to-red-50 rounded-lg border border-orange-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-800 mb-3",children:"Workflow Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${Ee.priority==="URGENT"?"bg-red-500":Ee.priority==="HIGH"?"bg-orange-500":"bg-blue-500"}`}),e.jsxs("span",{className:"text-slate-600",children:["Priority: ",Ee.priority]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),e.jsxs("span",{className:"text-slate-600",children:["Status: ",Ee.status]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Is,{className:"w-3 h-3 text-orange-600"}),e.jsx("span",{className:"text-slate-600",children:Ee.isUrgent?"Urgent":"Standard"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(kn,{className:"w-3 h-3 text-orange-600"}),e.jsx("span",{className:"text-slate-600",children:Ee.requiresApproval?"Needs Approval":"Auto Process"})]})]})]})]})]})})]})]})}),e.jsx(Xr,{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"text-sm text-slate-600",children:[e.jsx("span",{className:"font-medium",children:((Zo=Je.find($=>$.id===Ee.productId))==null?void 0:Zo.name)||"No Product Selected"}),Ee.movementType&&e.jsx("span",{className:"ml-2 px-2 py-1 bg-slate-100 text-slate-600 rounded text-xs",children:Ee.movementType.replace("_"," ")})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(I,{variant:"outline",onClick:()=>S(!1),className:"px-6",children:"Cancel"}),e.jsx(I,{onClick:Ns,className:"px-8 bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700",children:"Create Movement"})]})]})})]})}),e.jsx(ts,{open:_,onOpenChange:k,children:e.jsxs(ss,{className:"max-w-2xl",children:[e.jsx(as,{children:e.jsx(is,{children:"Movement Details"})}),he&&e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Product"}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center",children:wn(he.movementType)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:((el=he.product)==null?void 0:el.name)||"Unknown Product"}),e.jsx("p",{className:"text-sm text-gray-500",children:((ot=he.product)==null?void 0:ot.sku)||"No SKU"})]})]})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Movement Type"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(Oe,{variant:"outline",className:"capitalize",children:(qs=he.movementType)==null?void 0:qs.replace("_"," ").toLowerCase()}),e.jsx("div",{className:`w-3 h-3 rounded-full ${he.quantity>0?"bg-green-500":"bg-red-500"}`})]})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Quantity"}),e.jsxs("p",{className:`text-2xl font-bold mt-1 ${he.quantity>0?"text-green-600":"text-red-600"}`,children:[he.quantity>0?"+":"",he.quantity]})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Movement Date"}),e.jsx("p",{className:"text-sm mt-1",children:new Date(he.movementDate).toLocaleDateString()})]})]}),e.jsxs("div",{className:"space-y-4",children:[he.unitCost&&e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Unit Cost"}),e.jsxs("p",{className:"text-lg font-semibold mt-1",children:["$",Number(he.unitCost||0).toFixed(2)]})]}),he.totalCost&&e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Total Cost"}),e.jsxs("p",{className:"text-lg font-semibold mt-1",children:["$",Number(he.totalCost||0).toFixed(2)]})]}),he.reference&&e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Reference"}),e.jsx("p",{className:"text-sm mt-1 font-mono bg-gray-100 px-2 py-1 rounded",children:he.reference})]}),he.location&&e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-gray-500",children:"Location"}),e.jsxs("p",{className:"text-sm mt-1",children:[he.location.name," (",he.location.code,")"]})]})]})]}),(he.reason||he.notes)&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx(B,{className:"text-sm font-medium text-gray-500 mb-3 block",children:"Additional Information"}),e.jsxs("div",{className:"space-y-3",children:[he.reason&&e.jsxs("div",{children:[e.jsx(B,{className:"text-xs text-gray-500",children:"Reason"}),e.jsx("p",{className:"text-sm mt-1",children:he.reason})]}),he.notes&&e.jsxs("div",{children:[e.jsx(B,{className:"text-xs text-gray-500",children:"Notes"}),e.jsx("p",{className:"text-sm mt-1",children:he.notes})]})]})]}),(he.serialNumbers||he.batchNumber)&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx(B,{className:"text-sm font-medium text-gray-500 mb-3 block",children:"Tracking Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[he.serialNumbers&&e.jsxs("div",{children:[e.jsx(B,{className:"text-xs text-gray-500",children:"Serial Numbers"}),e.jsx("p",{className:"text-sm mt-1 font-mono bg-gray-100 px-2 py-1 rounded",children:he.serialNumbers})]}),he.batchNumber&&e.jsxs("div",{children:[e.jsx(B,{className:"text-xs text-gray-500",children:"Batch Number"}),e.jsx("p",{className:"text-sm mt-1 font-mono bg-gray-100 px-2 py-1 rounded",children:he.batchNumber})]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx(B,{className:"text-sm font-medium text-gray-500 mb-3 block",children:"System Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-xs text-gray-500",children:"Created At"}),e.jsx("p",{className:"mt-1",children:new Date(he.createdAt).toLocaleString()})]}),he.performedBy&&e.jsxs("div",{children:[e.jsx(B,{className:"text-xs text-gray-500",children:"Performed By"}),e.jsx("p",{className:"mt-1",children:he.performedBy})]})]})]})]}),e.jsx(Xr,{children:e.jsx(I,{variant:"outline",onClick:()=>k(!1),children:"Close"})})]})}),e.jsx(ts,{open:F,onOpenChange:A,children:e.jsxs(ss,{className:"max-w-md",children:[e.jsx(as,{children:e.jsx(is,{children:"Product QR Code"})}),P&&e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"w-64 h-64 mx-auto bg-white rounded-lg flex items-center justify-center border-2 border-gray-200 shadow-sm",children:T?e.jsx("img",{src:T,alt:"Product QR Code",className:"w-60 h-60 rounded"}):e.jsxs("div",{className:"text-center",children:[e.jsx(kr,{size:"md",color:"teal"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Generating QR Code..."})]})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{className:"text-sm font-medium",children:"Product Information"}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg space-y-1",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Name:"})," ",P.name]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"SKU:"})," ",P.sku]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"ID:"})," ",P.id]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{className:"text-sm font-medium",children:"Actions"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>rs(P),children:[e.jsx(Ts,{className:"w-4 h-4 mr-1"}),"Regenerate"]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{const $={type:"product",id:P.id,sku:P.sku,name:P.name,url:`${window.location.origin}/products/${P.id}`};navigator.clipboard.writeText(JSON.stringify($)),dt({title:"Copied to Clipboard",description:"QR code data has been copied to your clipboard"})},children:"Copy Data"}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{const $={type:"product",id:P.id,sku:P.sku,name:P.name,url:`${window.location.origin}/products/${P.id}`},Xt=new Blob([JSON.stringify($,null,2)],{type:"application/json"}),ds=URL.createObjectURL(Xt),Us=document.createElement("a");Us.href=ds,Us.download=`${P.sku}-qr-data.json`,document.body.appendChild(Us),Us.click(),document.body.removeChild(Us),URL.revokeObjectURL(ds),dt({title:"Downloaded",description:"QR code data has been downloaded as JSON file"})},children:"Download JSON"}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{if(T){const $=document.createElement("a");$.href=T,$.download=`${P.sku}-qr-code.png`,document.body.appendChild($),$.click(),document.body.removeChild($),dt({title:"Downloaded",description:"QR code image has been downloaded as PNG file"})}},children:"Download QR"})]})]})]}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:()=>A(!1),children:"Close"}),e.jsx(I,{onClick:()=>{A(!1),Et(P)},children:"View Product"})]})]})}),e.jsx(ts,{open:Z,onOpenChange:K,children:e.jsxs(ss,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(as,{children:e.jsx(is,{children:"Alert Settings"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Stock Thresholds"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"lowStockThreshold",children:"Low Stock Threshold"}),e.jsx(ge,{id:"lowStockThreshold",type:"number",value:X.lowStockThreshold,onChange:$=>ce({...X,lowStockThreshold:Number($.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Alert when stock  this amount"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"overstockThreshold",children:"Overstock Threshold"}),e.jsx(ge,{id:"overstockThreshold",type:"number",value:X.overstockThreshold,onChange:$=>ce({...X,overstockThreshold:Number($.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Alert when stock  this amount"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"criticalStockThreshold",children:"Critical Stock Threshold"}),e.jsx(ge,{id:"criticalStockThreshold",type:"number",value:X.criticalStockThreshold,onChange:$=>ce({...X,criticalStockThreshold:Number($.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Critical alert when stock  this amount"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Notification Preferences"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"emailNotifications",children:"Email Notifications"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive alerts via email"})]}),e.jsx("input",{id:"emailNotifications",type:"checkbox",checked:X.emailNotifications,onChange:$=>ce({...X,emailNotifications:$.target.checked}),className:"h-4 w-4"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"smsNotifications",children:"SMS Notifications"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Receive alerts via SMS"})]}),e.jsx("input",{id:"smsNotifications",type:"checkbox",checked:X.smsNotifications,onChange:$=>ce({...X,smsNotifications:$.target.checked}),className:"h-4 w-4"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"dashboardAlerts",children:"Dashboard Alerts"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Show alerts on dashboard"})]}),e.jsx("input",{id:"dashboardAlerts",type:"checkbox",checked:X.dashboardAlerts,onChange:$=>ce({...X,dashboardAlerts:$.target.checked}),className:"h-4 w-4"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Alert Management"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"autoAcknowledgeDays",children:"Auto-acknowledge after (days)"}),e.jsx(ge,{id:"autoAcknowledgeDays",type:"number",value:X.autoAcknowledgeDays,onChange:$=>ce({...X,autoAcknowledgeDays:Number($.target.value)})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically acknowledge alerts after this many days"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"immediateAlerts",children:"Immediate Alerts"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Send alerts immediately when generated"})]}),e.jsx("input",{id:"immediateAlerts",type:"checkbox",checked:X.immediateAlerts,onChange:$=>ce({...X,immediateAlerts:$.target.checked}),className:"h-4 w-4"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"immediateAlertsCriticalOnly",children:"Critical Alerts Only"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Send immediate alerts only for critical issues"})]}),e.jsx("input",{id:"immediateAlertsCriticalOnly",type:"checkbox",checked:X.immediateAlertsCriticalOnly,onChange:$=>ce({...X,immediateAlertsCriticalOnly:$.target.checked}),className:"h-4 w-4"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Schedule Settings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"dailyDigestTime",children:"Daily Digest Time"}),e.jsx(ge,{id:"dailyDigestTime",type:"time",value:X.dailyDigestTime,onChange:$=>ce({...X,dailyDigestTime:$.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"weeklySummaryDay",children:"Weekly Summary Day"}),e.jsxs(rt,{value:X.weeklySummaryDay,onValueChange:$=>ce({...X,weeklySummaryDay:$}),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"MONDAY",children:"Monday"}),e.jsx(W,{value:"TUESDAY",children:"Tuesday"}),e.jsx(W,{value:"WEDNESDAY",children:"Wednesday"}),e.jsx(W,{value:"THURSDAY",children:"Thursday"}),e.jsx(W,{value:"FRIDAY",children:"Friday"}),e.jsx(W,{value:"SATURDAY",children:"Saturday"}),e.jsx(W,{value:"SUNDAY",children:"Sunday"})]})]})]})]})]})]}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:()=>K(!1),children:"Cancel"}),e.jsx(I,{onClick:qr,children:"Save Settings"})]})]})}),e.jsx(ts,{open:Y,onOpenChange:ue,children:e.jsxs(ss,{className:"!max-w-7xl max-h-[95vh] overflow-y-auto w-[95vw] md:max-h-[90vh] md:w-[90vw] bg-gradient-to-br from-slate-50 to-emerald-50",children:[e.jsx(as,{className:"bg-white rounded-xl shadow-sm p-6 border border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-xl shadow-lg",children:e.jsx(Wd,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx(is,{className:"text-2xl font-bold text-slate-800",children:"Create New Transfer"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Move inventory between locations with complete tracking"})]})]})}),e.jsx("div",{className:"flex-1",children:e.jsxs(an,{defaultValue:"basic",className:"h-full flex flex-col",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-2 mb-4",children:e.jsxs(on,{className:"grid w-full grid-cols-4 gap-1",children:[e.jsxs(vt,{value:"basic",className:"flex items-center gap-2 py-3 px-4 data-[state=active]:bg-gradient-to-r data-[state=active]:from-emerald-500 data-[state=active]:to-teal-600 data-[state=active]:text-white transition-all duration-300",children:[e.jsx(Hr,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Transfer"})]}),e.jsxs(vt,{value:"logistics",className:"flex items-center gap-2 py-3 px-4 data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-cyan-600 data-[state=active]:text-white transition-all duration-300",children:[e.jsx(Pa,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Logistics"})]}),e.jsxs(vt,{value:"tracking",className:"flex items-center gap-2 py-3 px-4 data-[state=active]:bg-gradient-to-r data-[state=active]:from-purple-500 data-[state=active]:to-pink-600 data-[state=active]:text-white transition-all duration-300",children:[e.jsx(dl,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Tracking"})]}),e.jsxs(vt,{value:"workflow",className:"flex items-center gap-2 py-3 px-4 data-[state=active]:bg-gradient-to-r data-[state=active]:from-orange-500 data-[state=active]:to-red-600 data-[state=active]:text-white transition-all duration-300",children:[e.jsx(en,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Workflow"})]})]})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(yt,{value:"basic",children:e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg",children:e.jsx(Hr,{className:"w-5 h-5 text-emerald-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Transfer Information"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Essential transfer details and location selection"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-product",className:"text-sm font-medium text-slate-700",children:"Product *"}),e.jsxs(rt,{value:fe.productId,onValueChange:$=>ct({...fe,productId:$}),children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-emerald-400 focus:ring-1 focus:ring-emerald-100",children:e.jsx(it,{placeholder:"Select product to transfer"})}),e.jsx(at,{children:Je.map($=>e.jsx(W,{value:$.id,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-emerald-100 to-teal-100 rounded-lg flex items-center justify-center",children:e.jsx(Hr,{className:"w-4 h-4 text-emerald-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:$.name}),e.jsxs("div",{className:"text-sm text-slate-500",children:["SKU: ",$.sku]})]})]})},$.id))})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-quantity",className:"text-sm font-medium text-slate-700",children:"Quantity *"}),e.jsx(ge,{id:"transfer-quantity",type:"number",min:"0",step:"1",value:fe.quantity,onChange:$=>ct({...fe,quantity:Number($.target.value)}),placeholder:"Enter quantity to transfer",className:"py-3 text-base border-slate-300 focus:border-emerald-400 focus:ring-1 focus:ring-emerald-100 transition-all duration-200"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-from",className:"text-sm font-medium text-slate-700",children:"From Location"}),e.jsxs(rt,{value:fe.fromLocationId||"none",onValueChange:$=>ct({...fe,fromLocationId:$==="none"?"":$}),children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-emerald-400 focus:ring-1 focus:ring-emerald-100",children:e.jsx(it,{placeholder:"Select source location"})}),e.jsxs(at,{children:[e.jsx(W,{value:"none",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"}),e.jsx("span",{children:"External Source"})]})}),It.map($=>e.jsx(W,{value:$.id,disabled:fe.toLocationId===$.id,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Pa,{className:"w-4 h-4 text-emerald-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:$.name}),e.jsx("div",{className:"text-sm text-slate-500",children:$.code})]}),fe.toLocationId===$.id&&e.jsx("span",{className:"text-xs text-orange-500 ml-2",children:"(Same as destination)"})]})},$.id))]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-to",className:"text-sm font-medium text-slate-700",children:"To Location *"}),e.jsxs(rt,{value:fe.toLocationId,onValueChange:$=>ct({...fe,toLocationId:$}),children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-emerald-400 focus:ring-1 focus:ring-emerald-100",children:e.jsx(it,{placeholder:"Select destination location"})}),e.jsx(at,{children:It.map($=>e.jsx(W,{value:$.id,disabled:fe.fromLocationId===$.id,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Pa,{className:"w-4 h-4 text-emerald-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:$.name}),e.jsx("div",{className:"text-sm text-slate-500",children:$.code})]}),fe.fromLocationId===$.id&&e.jsx("span",{className:"text-xs text-orange-500 ml-2",children:"(Same as source)"})]})},$.id))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-date",className:"text-sm font-medium text-slate-700",children:"Transfer Date *"}),e.jsx(ge,{id:"transfer-date",type:"date",value:fe.transferDate,onChange:$=>ct({...fe,transferDate:$.target.value}),className:"py-3 text-base border-slate-300 focus:border-emerald-400 focus:ring-1 focus:ring-emerald-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-time",className:"text-sm font-medium text-slate-700",children:"Transfer Time"}),e.jsx(ge,{id:"transfer-time",type:"time",value:fe.transferTime,onChange:$=>ct({...fe,transferTime:$.target.value}),className:"py-3 text-base border-slate-300 focus:border-emerald-400 focus:ring-1 focus:ring-emerald-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-delivery-date",className:"text-sm font-medium text-slate-700",children:"Expected Delivery"}),e.jsx(ge,{id:"transfer-delivery-date",type:"date",value:fe.expectedDeliveryDate,onChange:$=>ct({...fe,expectedDeliveryDate:$.target.value}),className:"py-3 text-base border-slate-300 focus:border-emerald-400 focus:ring-1 focus:ring-emerald-100 transition-all duration-200"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-type",className:"text-sm font-medium text-slate-700",children:"Transfer Type"}),e.jsxs(rt,{value:fe.transferType,onValueChange:$=>ct({...fe,transferType:$}),children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-emerald-400 focus:ring-1 focus:ring-emerald-100",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"INTER_LOCATION",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full"}),e.jsx("span",{children:"Inter-Location"})]})}),e.jsx(W,{value:"INTER_WAREHOUSE",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{children:"Inter-Warehouse"})]})}),e.jsx(W,{value:"CUSTOMER_SHIPMENT",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("span",{children:"Customer Shipment"})]})}),e.jsx(W,{value:"SUPPLIER_RETURN",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),e.jsx("span",{children:"Supplier Return"})]})})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-reference",className:"text-sm font-medium text-slate-700",children:"Reference Number"}),e.jsx(ge,{id:"transfer-reference",value:fe.reference,onChange:$=>ct({...fe,reference:$.target.value}),placeholder:"e.g., TRN-2024-001",className:"py-3 text-base border-slate-300 focus:border-emerald-400 focus:ring-1 focus:ring-emerald-100 transition-all duration-200"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-notes",className:"text-sm font-medium text-slate-700",children:"Transfer Notes"}),e.jsx(Xs,{id:"transfer-notes",value:fe.notes,onChange:$=>ct({...fe,notes:$.target.value}),placeholder:"Enter transfer notes and instructions",rows:3,className:"resize-none border-slate-300 focus:border-emerald-400 focus:ring-1 focus:ring-emerald-100 transition-all duration-200"})]}),fe.productId&&fe.toLocationId&&e.jsxs("div",{className:"mt-8 p-4 bg-gradient-to-br from-emerald-50 to-teal-50 rounded-lg border border-emerald-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-800 mb-3",children:"Transfer Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Hr,{className:"w-4 h-4 text-emerald-600"}),e.jsxs("span",{className:"text-slate-600",children:["Product: ",((Sn=Je.find($=>$.id===fe.productId))==null?void 0:Sn.name)||"Selected"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Wd,{className:"w-4 h-4 text-emerald-600"}),e.jsxs("span",{className:"text-slate-600",children:["Qty: ",fe.quantity]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pa,{className:"w-4 h-4 text-emerald-600"}),e.jsxs("span",{className:"text-slate-600",children:["From: ",fe.fromLocationId?((hr=It.find($=>$.id===fe.fromLocationId))==null?void 0:hr.name)||"Unknown":"External"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xn,{className:"w-4 h-4 text-emerald-600"}),e.jsxs("span",{className:"text-slate-600",children:["To: ",((Fn=It.find($=>$.id===fe.toLocationId))==null?void 0:Fn.name)||"Select destination"]})]})]})]})]})]})}),e.jsx(yt,{value:"logistics",children:e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Pa,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Logistics & Shipping"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Carrier information, shipping details, and costs"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-carrier",className:"text-sm font-medium text-slate-700",children:"Carrier Name"}),e.jsx(ge,{id:"transfer-carrier",value:fe.carrierName,onChange:$=>ct({...fe,carrierName:$.target.value}),placeholder:"e.g., FedEx, UPS, Internal Transport",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-tracking",className:"text-sm font-medium text-slate-700",children:"Tracking Number"}),e.jsx(ge,{id:"transfer-tracking",value:fe.trackingNumber,onChange:$=>ct({...fe,trackingNumber:$.target.value}),placeholder:"e.g., 1Z999AA123456789",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-shipping-cost",className:"text-sm font-medium text-slate-700",children:"Shipping Cost"}),e.jsxs("div",{className:"relative",children:[e.jsx(Mr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx(ge,{id:"transfer-shipping-cost",type:"number",min:"0",step:"0.01",value:fe.shippingCost,onChange:$=>ct({...fe,shippingCost:parseFloat($.target.value)||0}),placeholder:"0.00",className:"pl-10 py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-insurance",className:"text-sm font-medium text-slate-700",children:"Insurance Value"}),e.jsxs("div",{className:"relative",children:[e.jsx(Mr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400"}),e.jsx(ge,{id:"transfer-insurance",type:"number",min:"0",step:"0.01",value:fe.insuranceValue,onChange:$=>ct({...fe,insuranceValue:parseFloat($.target.value)||0}),placeholder:"0.00",className:"pl-10 py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-packing",className:"text-sm font-medium text-slate-700",children:"Packing Method"}),e.jsxs(rt,{value:fe.packingMethod,onValueChange:$=>ct({...fe,packingMethod:$}),children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100",children:e.jsx(it,{placeholder:"Select packing method"})}),e.jsxs(at,{children:[e.jsx(W,{value:"STANDARD_BOX",children:"Standard Box"}),e.jsx(W,{value:"PADDED_ENVELOPE",children:"Padded Envelope"}),e.jsx(W,{value:"PALLET",children:"Pallet"}),e.jsx(W,{value:"CUSTOM_CRATE",children:"Custom Crate"}),e.jsx(W,{value:"BULK",children:"Bulk"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-dept-from",className:"text-sm font-medium text-slate-700",children:"Department From"}),e.jsx(ge,{id:"transfer-dept-from",value:fe.departmentFrom,onChange:$=>ct({...fe,departmentFrom:$.target.value}),placeholder:"e.g., Warehouse Operations",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-dept-to",className:"text-sm font-medium text-slate-700",children:"Department To"}),e.jsx(ge,{id:"transfer-dept-to",value:fe.departmentTo,onChange:$=>ct({...fe,departmentTo:$.target.value}),placeholder:"e.g., Retail Operations",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-project",className:"text-sm font-medium text-slate-700",children:"Project Code"}),e.jsx(ge,{id:"transfer-project",value:fe.projectCode,onChange:$=>ct({...fe,projectCode:$.target.value}),placeholder:"e.g., PROJ-2024-01",className:"py-3 text-base border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-special-instructions",className:"text-sm font-medium text-slate-700",children:"Special Instructions"}),e.jsx(Xs,{id:"transfer-special-instructions",value:fe.specialInstructions,onChange:$=>ct({...fe,specialInstructions:$.target.value}),placeholder:"Special handling requirements, delivery instructions, etc.",rows:3,className:"resize-none border-slate-300 focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all duration-200"})]}),e.jsxs("div",{className:"pt-6 border-t border-slate-200",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-4",children:"Shipping Options"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"transfer-fragile",checked:fe.fragile,onChange:$=>ct({...fe,fragile:$.target.checked}),className:"w-4 h-4 text-orange-600 bg-gray-100 border-gray-300 rounded focus:ring-orange-500"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Is,{className:"w-4 h-4 text-orange-600"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"transfer-fragile",className:"text-sm font-medium cursor-pointer",children:"Fragile Items"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Requires special handling"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"transfer-temperature",checked:fe.temperatureControlled,onChange:$=>ct({...fe,temperatureControlled:$.target.checked}),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v6,{className:"w-4 h-4 text-blue-600"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"transfer-temperature",className:"text-sm font-medium cursor-pointer",children:"Temperature Controlled"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Maintain cold chain"})]})]})]})]})]}),(fe.shippingCost>0||fe.insuranceValue>0)&&e.jsxs("div",{className:"mt-8 p-4 bg-gradient-to-br from-blue-50 to-cyan-50 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-800 mb-3",children:"Cost Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-white rounded-lg border",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:["$",fe.shippingCost.toFixed(2)]}),e.jsx("div",{className:"text-sm text-slate-600",children:"Shipping Cost"})]}),e.jsxs("div",{className:"text-center p-3 bg-white rounded-lg border",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["$",fe.insuranceValue.toFixed(2)]}),e.jsx("div",{className:"text-sm text-slate-600",children:"Insurance Value"})]}),e.jsxs("div",{className:"text-center p-3 bg-white rounded-lg border",children:[e.jsxs("div",{className:"text-2xl font-bold text-indigo-600",children:["$",(fe.shippingCost+fe.insuranceValue).toFixed(2)]}),e.jsx("div",{className:"text-sm text-slate-600",children:"Total Cost"})]})]})]})]})]})}),e.jsx(yt,{value:"tracking",children:e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(dl,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Tracking & Identification"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Batch numbers, serial codes, and tracking information"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-batch",className:"text-sm font-medium text-slate-700",children:"Batch Number"}),e.jsx(ge,{id:"transfer-batch",value:fe.batchNumber,onChange:$=>ct({...fe,batchNumber:$.target.value}),placeholder:"e.g., BATCH-2024-001",className:"py-3 text-base border-slate-300 focus:border-purple-400 focus:ring-1 focus:ring-purple-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-serials",className:"text-sm font-medium text-slate-700",children:"Serial Numbers"}),e.jsx(Xs,{id:"transfer-serials",value:fe.serialNumbers,onChange:$=>ct({...fe,serialNumbers:$.target.value}),placeholder:"e.g., SN001, SN002, SN003 (comma separated)",rows:2,className:"resize-none border-slate-300 focus:border-purple-400 focus:ring-1 focus:ring-purple-100 transition-all duration-200"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-reason",className:"text-sm font-medium text-slate-700",children:"Reason Code"}),e.jsxs(rt,{value:fe.reasonCode,onValueChange:$=>ct({...fe,reasonCode:$}),children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-purple-400 focus:ring-1 focus:ring-purple-100",children:e.jsx(it,{placeholder:"Select reason for transfer"})}),e.jsxs(at,{children:[e.jsx(W,{value:"RESTOCK",children:"Restock"}),e.jsx(W,{value:"CUSTOMER_ORDER",children:"Customer Order"}),e.jsx(W,{value:"QUALITY_CONTROL",children:"Quality Control"}),e.jsx(W,{value:"DAMAGE_REPLACEMENT",children:"Damage Replacement"}),e.jsx(W,{value:"SEASONAL_ADJUSTMENT",children:"Seasonal Adjustment"}),e.jsx(W,{value:"EXCESS_INVENTORY",children:"Excess Inventory"}),e.jsx(W,{value:"OTHER",children:"Other"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-cost-center",className:"text-sm font-medium text-slate-700",children:"Cost Center"}),e.jsx(ge,{id:"transfer-cost-center",value:fe.costCenter,onChange:$=>ct({...fe,costCenter:$.target.value}),placeholder:"e.g., CC-001",className:"py-3 text-base border-slate-300 focus:border-purple-400 focus:ring-1 focus:ring-purple-100 transition-all duration-200"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-requested-by",className:"text-sm font-medium text-slate-700",children:"Requested By"}),e.jsx(ge,{id:"transfer-requested-by",value:fe.requestedBy,onChange:$=>ct({...fe,requestedBy:$.target.value}),placeholder:"Staff member name",className:"py-3 text-base border-slate-300 focus:border-purple-400 focus:ring-1 focus:ring-purple-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-approved-by",className:"text-sm font-medium text-slate-700",children:"Approved By"}),e.jsx(ge,{id:"transfer-approved-by",value:fe.approvedBy,onChange:$=>ct({...fe,approvedBy:$.target.value}),placeholder:"Manager name",className:"py-3 text-base border-slate-300 focus:border-purple-400 focus:ring-1 focus:ring-purple-100 transition-all duration-200"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-processed-by",className:"text-sm font-medium text-slate-700",children:"Processed By"}),e.jsx(ge,{id:"transfer-processed-by",value:fe.processedBy,onChange:$=>ct({...fe,processedBy:$.target.value}),placeholder:"Handler name",className:"py-3 text-base border-slate-300 focus:border-purple-400 focus:ring-1 focus:ring-purple-100 transition-all duration-200"})]})]}),e.jsxs("div",{className:"mt-8 p-4 bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg border border-purple-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-800 mb-3",children:"Tracking Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(dl,{className:"w-4 h-4 text-purple-600"}),e.jsxs("span",{className:"text-slate-600",children:["Batch: ",fe.batchNumber||"Not set"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsxs("span",{className:"text-slate-600",children:["Serials: ",fe.serialNumbers?"Set":"Not set"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(bo,{className:"w-4 h-4 text-purple-600"}),e.jsxs("span",{className:"text-slate-600",children:["Requested: ",fe.requestedBy||"Not set"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(en,{className:"w-4 h-4 text-purple-600"}),e.jsxs("span",{className:"text-slate-600",children:["Reason: ",fe.reasonCode||"Not specified"]})]})]})]})]})]})}),e.jsx(yt,{value:"workflow",children:e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:e.jsx(en,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Workflow & Approval"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Priority settings, approval process, and status management"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-priority",className:"text-sm font-medium text-slate-700",children:"Priority Level"}),e.jsxs(rt,{value:fe.priority,onValueChange:$=>ct({...fe,priority:$}),children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-orange-400 focus:ring-1 focus:ring-orange-100",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"LOW",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{children:"Low Priority"})]})}),e.jsx(W,{value:"NORMAL",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{children:"Normal Priority"})]})}),e.jsx(W,{value:"HIGH",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),e.jsx("span",{children:"High Priority"})]})}),e.jsx(W,{value:"URGENT",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),e.jsx("span",{children:"Urgent"})]})})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-status",className:"text-sm font-medium text-slate-700",children:"Transfer Status"}),e.jsxs(rt,{value:fe.status,onValueChange:$=>ct({...fe,status:$}),children:[e.jsx(nt,{className:"py-3 text-base border-slate-300 focus:border-orange-400 focus:ring-1 focus:ring-orange-100",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"PENDING",children:"Pending"}),e.jsx(W,{value:"APPROVED",children:"Approved"}),e.jsx(W,{value:"IN_TRANSIT",children:"In Transit"}),e.jsx(W,{value:"DELIVERED",children:"Delivered"}),e.jsx(W,{value:"COMPLETED",children:"Completed"}),e.jsx(W,{value:"CANCELLED",children:"Cancelled"})]})]})]})]}),e.jsxs("div",{className:"pt-6 border-t border-slate-200",children:[e.jsx("h4",{className:"text-sm font-medium text-slate-800 mb-4",children:"Workflow Options"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"transfer-urgent",checked:fe.isUrgent,onChange:$=>ct({...fe,isUrgent:$.target.checked}),className:"w-4 h-4 text-red-600 bg-gray-100 border-gray-300 rounded focus:ring-red-500"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Is,{className:"w-4 h-4 text-red-600"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"transfer-urgent",className:"text-sm font-medium cursor-pointer",children:"Urgent Transfer"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Mark as urgent for priority processing"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 border border-slate-200 rounded-lg hover:bg-slate-50 transition-colors",children:[e.jsx("input",{type:"checkbox",id:"transfer-approval",checked:fe.requiresApproval,onChange:$=>ct({...fe,requiresApproval:$.target.checked}),className:"w-4 h-4 text-orange-600 bg-gray-100 border-gray-300 rounded focus:ring-orange-500"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(kn,{className:"w-4 h-4 text-orange-600"}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"transfer-approval",className:"text-sm font-medium cursor-pointer",children:"Requires Approval"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Transfer needs manager approval"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{htmlFor:"transfer-internal-notes",className:"text-sm font-medium text-slate-700",children:"Internal Notes"}),e.jsx(Xs,{id:"transfer-internal-notes",value:fe.internalNotes,onChange:$=>ct({...fe,internalNotes:$.target.value}),placeholder:"Internal notes for staff use only (not visible to external users)",rows:4,className:"resize-none border-slate-300 focus:border-orange-400 focus:ring-1 focus:ring-orange-100 transition-all duration-200"}),e.jsx("p",{className:"text-xs text-slate-500",children:"These notes are for internal use and won't be displayed to external users"})]}),e.jsxs("div",{className:"mt-8 p-4 bg-gradient-to-br from-orange-50 to-red-50 rounded-lg border border-orange-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-800 mb-3",children:"Workflow Summary"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${fe.priority==="URGENT"?"bg-red-500":fe.priority==="HIGH"?"bg-orange-500":"bg-blue-500"}`}),e.jsxs("span",{className:"text-slate-600",children:["Priority: ",fe.priority]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),e.jsxs("span",{className:"text-slate-600",children:["Status: ",fe.status]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Is,{className:"w-3 h-3 text-orange-600"}),e.jsx("span",{className:"text-slate-600",children:fe.isUrgent?"Urgent":"Standard"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(kn,{className:"w-3 h-3 text-orange-600"}),e.jsx("span",{className:"text-slate-600",children:fe.requiresApproval?"Needs Approval":"Auto Process"})]})]})]})]})]})})]})]})}),e.jsx(Xr,{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"text-sm text-slate-600",children:[e.jsx("span",{className:"font-medium",children:((Rr=Je.find($=>$.id===fe.productId))==null?void 0:Rr.name)||"No Product Selected"}),fe.transferType&&e.jsx("span",{className:"ml-2 px-2 py-1 bg-slate-100 text-slate-600 rounded text-xs",children:fe.transferType.replace("_"," ")})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(I,{variant:"outline",onClick:()=>ue(!1),className:"px-6",children:"Cancel"}),e.jsx(I,{onClick:qn,className:"px-8 bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700",children:"Create Transfer"})]})]})})]})}),e.jsx(ts,{open:ve,onOpenChange:Le,children:e.jsxs(ss,{className:"max-w-2xl",children:[e.jsx(as,{children:e.jsx(is,{children:"Transfer Details"})}),Me&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium",children:"Product"}),e.jsx("p",{className:"text-lg font-semibold",children:Me.product.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:Me.product.sku})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium",children:"Quantity"}),e.jsxs("p",{className:"text-lg font-semibold",children:[Me.quantity," units"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium",children:"From Location"}),e.jsx("p",{className:"text-lg font-semibold",children:Me.fromLocation?Me.fromLocation.name:"External"}),Me.fromLocation&&e.jsx("p",{className:"text-sm text-muted-foreground",children:Me.fromLocation.code})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium",children:"To Location"}),e.jsx("p",{className:"text-lg font-semibold",children:Me.toLocation.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:Me.toLocation.code})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium",children:"Transfer Date"}),e.jsx("p",{className:"text-lg font-semibold",children:new Date(Me.transferDate).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium",children:"Status"}),e.jsx("div",{className:"mt-1",children:Vr(Me.status)})]})]}),Me.reference&&e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium",children:"Reference"}),e.jsx("p",{className:"text-lg font-semibold",children:Me.reference})]}),Me.notes&&e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium",children:"Notes"}),e.jsx("p",{className:"text-sm",children:Me.notes})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium",children:"Requested By"}),e.jsx("p",{className:"text-sm",children:Me.requestedBy||"N/A"})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium",children:"Completed By"}),e.jsx("p",{className:"text-sm",children:Me.completedBy||"N/A"})]})]}),Me.completedAt&&e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium",children:"Completed At"}),e.jsx("p",{className:"text-sm",children:new Date(Me.completedAt).toLocaleString()})]})]}),e.jsx(Xr,{children:e.jsx(I,{variant:"outline",onClick:()=>Le(!1),children:"Close"})})]})}),e.jsx(ts,{open:M,onOpenChange:G,children:e.jsxs(ss,{className:"max-w-lg",children:[e.jsx(as,{children:e.jsx(is,{children:"Create New Category"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"category-name",children:"Category Name *"}),e.jsx(ge,{id:"category-name",value:re.name,onChange:$=>le({...re,name:$.target.value}),placeholder:"Enter category name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"category-description",children:"Description"}),e.jsx(Xs,{id:"category-description",value:re.description,onChange:$=>le({...re,description:$.target.value}),placeholder:"Enter category description (optional)",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"category-color",children:"Color"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{id:"category-color",type:"color",value:re.color,onChange:$=>le({...re,color:$.target.value}),className:"w-12 h-10 p-1"}),e.jsx(ge,{value:re.color,onChange:$=>le({...re,color:$.target.value}),placeholder:"#2563eb"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"category-icon",children:"Icon"}),e.jsxs(rt,{value:re.icon,onValueChange:$=>le({...re,icon:$}),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select an icon"})}),e.jsxs(at,{children:[e.jsx(W,{value:"Package",children:" Package"}),e.jsx(W,{value:"Zap",children:" Electronics"}),e.jsx(W,{value:"Building",children:" Office"}),e.jsx(W,{value:"Wrench",children:" Tools"}),e.jsx(W,{value:"Heart",children:" Health"}),e.jsx(W,{value:"Car",children:" Automotive"})]})]})]})]})]}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:()=>G(!1),children:"Cancel"}),e.jsx(I,{onClick:async()=>{try{if(!re.name){dt({title:"Validation Error",description:"Category name is required",variant:"destructive"});return}const $=await f4.createCategory({...re,companyId:_e});dt({title:"Success",description:"Category created successfully"}),te({...O,categoryId:$.id}),le({name:"",description:"",color:"#2563eb",icon:"Package"}),G(!1),pt.invalidateQueries({queryKey:["categories"]})}catch{dt({title:"Error",description:"Failed to create category. Please try again.",variant:"destructive"})}},children:"Create Category"})]})]})}),e.jsx(ts,{open:z,onOpenChange:U,children:e.jsxs(ss,{className:"max-w-4xl",children:[e.jsx(as,{children:e.jsx(is,{children:"Manage Categories"})}),e.jsxs("div",{className:"py-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:[(Gt==null?void 0:Gt.length)||0," categories found"]}),e.jsxs(I,{onClick:()=>G(!0),children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Add Category"]})]}),e.jsx("div",{className:"grid gap-3 max-h-96 overflow-y-auto",children:Gt.map($=>{var Xt;return e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:$.color}}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:$.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[((Xt=$._count)==null?void 0:Xt.products)||0," products"]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{Q($),le({name:$.name,description:$.description||"",color:$.color||"#2563eb",icon:$.icon||"Package"}),J(!0)},children:e.jsx(ln,{className:"w-4 h-4"})})})]},$.id)})})]}),e.jsx(Xr,{children:e.jsx(I,{variant:"outline",onClick:()=>U(!1),children:"Close"})})]})})]})})}function eRe({templates:s,onCreateTemplate:t,onUseTemplate:r,onViewTemplate:n}){const[a,i]=x.useState("all"),o=u=>{switch(u){case"balance_sheet":return e.jsx(lr,{className:"h-4 w-4"});case"income_statement":return e.jsx($s,{className:"h-4 w-4"});case"cash_flow":return e.jsx(or,{className:"h-4 w-4"});case"equity":return e.jsx(Eo,{className:"h-4 w-4"});default:return e.jsx(Zt,{className:"h-4 w-4"})}},l=u=>{switch(u){case"balance_sheet":return"Balance Sheet";case"income_statement":return"Income Statement";case"cash_flow":return"Cash Flow";case"equity":return"Equity";default:return"Custom"}},c=a==="all"?s:s.filter(u=>u.category===a),d=["all",...new Set(s.map(u=>u.category))];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Report Templates"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pre-built templates to quickly create reports"})]}),e.jsxs(I,{onClick:t,children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Create Template"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:d.map(u=>e.jsx(I,{variant:a===u?"default":"outline",size:"sm",onClick:()=>i(u),children:u==="all"?"All Categories":u},u))}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:c.map(u=>e.jsxs(ne,{className:"hover:shadow-md transition-shadow",children:[e.jsxs(we,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[o(u.type),e.jsx(Se,{className:"text-lg",children:u.name})]}),e.jsx(Oe,{variant:u.isPublic?"default":"secondary",children:u.category})]}),e.jsx(Vt,{children:u.description||`${l(u.type)} template`})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Type:"}),e.jsx("span",{className:"font-medium",children:l(u.type)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Created by:"}),e.jsx("span",{className:"font-medium",children:u.createdByUser.name})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Visibility:"}),e.jsx("span",{className:"font-medium",children:u.isPublic?"Public":"Private"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-4",children:[e.jsxs(I,{size:"sm",className:"flex-1",onClick:()=>r(u.id),children:[e.jsx(t1,{className:"h-4 w-4 mr-2"}),"Use Template"]}),e.jsx(I,{size:"sm",variant:"outline",onClick:()=>n(u.id),children:e.jsx(ir,{className:"h-4 w-4"})})]})]})]},u.id))}),c.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Zt,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No templates found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:a==="all"?"Create your first template to get started":`No templates found in the ${a} category`}),e.jsxs(I,{onClick:t,children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Create Template"]})]})]})}function tRe({onCreateReport:s,onSaveAsDraft:t}){const[r,n]=x.useState(""),[a,i]=x.useState(""),[o,l]=x.useState(""),[c,d]=x.useState([]),[u,h]=x.useState(""),f=[{value:"balance_sheet",label:"Balance Sheet",icon:lr},{value:"income_statement",label:"Income Statement",icon:$s},{value:"cash_flow",label:"Cash Flow",icon:or},{value:"equity",label:"Equity",icon:Eo},{value:"custom",label:"Custom Report",icon:Zt}],m=[{value:"account",label:"Account",icon:Zt},{value:"calculation",label:"Calculation",icon:yn},{value:"section",label:"Section Header",icon:lr},{value:"text",label:"Text/Description",icon:Zt}],p=()=>{if(!u)return;const N={id:`item-${Date.now()}`,type:u,name:`New ${u}`,order:c.length};d([...c,N]),h("")},g=N=>{d(c.filter(C=>C.id!==N))},v=(N,C)=>{const S=c.findIndex(F=>F.id===N);if(S===-1)return;const _=[...c],k=C==="up"?S-1:S+1;k>=0&&k<_.length&&([_[S],_[k]]=[_[k],_[S]],d(_))},y=()=>{if(!r||!a){alert("Please fill in report name and type");return}const N={name:r,type:a,description:o,items:c,createdAt:new Date().toISOString()};s(N)},j=()=>{const N={name:r||"Untitled Report",type:a||"custom",description:o,items:c,status:"draft",createdAt:new Date().toISOString()};t(N)},b=N=>{const C=f.find(S=>S.value===N);return C?e.jsx(C.icon,{className:"h-4 w-4"}):e.jsx(Zt,{className:"h-4 w-4"})},w=N=>{const C=m.find(S=>S.value===N);return C?e.jsx(C.icon,{className:"h-4 w-4"}):e.jsx(Zt,{className:"h-4 w-4"})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Report Builder"}),e.jsx(Vt,{children:"Create custom financial reports with drag-and-drop interface"})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold",children:"Report Configuration"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Report Name"}),e.jsx(ge,{placeholder:"Enter report name",value:r,onChange:N=>n(N.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Report Type"}),e.jsxs(rt,{value:a,onValueChange:i,children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select report type"})}),e.jsx(at,{children:f.map(N=>e.jsx(W,{value:N.value,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(N.icon,{className:"h-4 w-4"}),e.jsx("span",{children:N.label})]})},N.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx(ge,{placeholder:"Enter description",value:o,onChange:N=>l(N.target.value)})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold",children:"Report Items"}),e.jsx("div",{className:"border rounded-lg p-4 min-h-[200px] max-h-[400px] overflow-y-auto",children:c.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Drag and drop items here to build your report"}):e.jsx("div",{className:"space-y-2",children:c.map((N,C)=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded bg-gray-50",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(fY,{className:"h-4 w-4 text-gray-400 cursor-move"}),w(N.type),e.jsx("span",{className:"text-sm font-medium",children:N.name}),e.jsx(Oe,{variant:"outline",className:"text-xs",children:N.type})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>v(N.id,"up"),disabled:C===0,children:""}),e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>v(N.id,"down"),disabled:C===c.length-1,children:""}),e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>g(N.id),children:e.jsx(hn,{className:"h-3 w-3"})})]})]},N.id))})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(rt,{value:u,onValueChange:h,children:[e.jsx(nt,{className:"flex-1",children:e.jsx(it,{placeholder:"Select item type"})}),e.jsx(at,{children:m.map(N=>e.jsx(W,{value:N.value,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(N.icon,{className:"h-4 w-4"}),e.jsx("span",{children:N.label})]})},N.value))})]}),e.jsxs(I,{onClick:p,disabled:!u,children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Add Item"]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 pt-4 border-t",children:[e.jsxs(I,{variant:"outline",onClick:j,children:[e.jsx(Od,{className:"h-4 w-4 mr-2"}),"Save as Draft"]}),e.jsxs(I,{onClick:y,children:[e.jsx(ir,{className:"h-4 w-4 mr-2"}),"Create Report"]})]})]})]}),c.length>0&&e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center space-x-2",children:[b(a),e.jsx("span",{children:"Report Preview"})]}),e.jsx(Vt,{children:"Preview of your report structure"})]}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-2",children:c.map((N,C)=>e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[C+1,"."]}),w(N.type),e.jsx("span",{children:N.name}),e.jsx(Oe,{variant:"outline",className:"text-xs",children:N.type})]},N.id))})})]})]})}function sRe({onSaveTemplate:s,onCancel:t}){const[r,n]=x.useState(""),[a,i]=x.useState(""),[o,l]=x.useState(""),[c,d]=x.useState(""),[u,h]=x.useState(!1),[f,m]=x.useState([]),[p,g]=x.useState(""),v=[{value:"balance_sheet",label:"Balance Sheet",icon:lr},{value:"income_statement",label:"Income Statement",icon:$s},{value:"cash_flow",label:"Cash Flow",icon:or},{value:"equity",label:"Equity",icon:Eo},{value:"custom",label:"Custom Template",icon:Zt}],y=["Standard","Custom","Industry Specific","Management","Compliance","Tax"],j=[{value:"account",label:"Account",icon:Zt},{value:"calculation",label:"Calculation",icon:lr},{value:"section",label:"Section Header",icon:lr},{value:"text",label:"Text/Description",icon:Zt}],b=()=>{if(!p)return;const _={id:`item-${Date.now()}`,type:p,name:`New ${p}`};m([...f,_]),g("")},w=_=>{m(f.filter(k=>k.id!==_))},N=()=>{if(!r||!a||!o){alert("Please fill in template name, type, and category");return}const _={name:r,type:a,category:o,description:c,isPublic:u,items:f,createdAt:new Date().toISOString()};s(_)},C=_=>{const k=v.find(F=>F.value===_);return k?e.jsx(k.icon,{className:"h-4 w-4"}):e.jsx(Zt,{className:"h-4 w-4"})},S=_=>{const k=j.find(F=>F.value===_);return k?e.jsx(k.icon,{className:"h-4 w-4"}):e.jsx(Zt,{className:"h-4 w-4"})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Se,{children:"Create Template"}),e.jsx(Vt,{children:"Create a reusable report template"})]}),e.jsx(I,{variant:"outline",onClick:t,children:e.jsx(ma,{className:"h-4 w-4"})})]})}),e.jsxs(ie,{children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold",children:"Template Configuration"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Template Name"}),e.jsx(ge,{placeholder:"Enter template name",value:r,onChange:_=>n(_.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Template Type"}),e.jsxs(rt,{value:a,onValueChange:i,children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select template type"})}),e.jsx(at,{children:v.map(_=>e.jsx(W,{value:_.value,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_.icon,{className:"h-4 w-4"}),e.jsx("span",{children:_.label})]})},_.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Category"}),e.jsxs(rt,{value:o,onValueChange:l,children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select category"})}),e.jsx(at,{children:y.map(_=>e.jsx(W,{value:_,children:_},_))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Description"}),e.jsx(ge,{placeholder:"Enter description",value:c,onChange:_=>d(_.target.value)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"isPublic",checked:u,onChange:_=>h(_.target.checked)}),e.jsx("label",{htmlFor:"isPublic",className:"text-sm font-medium",children:"Make this template public"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold",children:"Template Items"}),e.jsx("div",{className:"border rounded-lg p-4 min-h-[200px] max-h-[400px] overflow-y-auto",children:f.length===0?e.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Add items to build your template"}):e.jsx("div",{className:"space-y-2",children:f.map((_,k)=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded bg-gray-50",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[k+1,"."]}),S(_.type),e.jsx("span",{className:"text-sm font-medium",children:_.name}),e.jsx(Oe,{variant:"outline",className:"text-xs",children:_.type})]}),e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>w(_.id),children:e.jsx(hn,{className:"h-3 w-3"})})]},_.id))})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(rt,{value:p,onValueChange:g,children:[e.jsx(nt,{className:"flex-1",children:e.jsx(it,{placeholder:"Select item type"})}),e.jsx(at,{children:j.map(_=>e.jsx(W,{value:_.value,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_.icon,{className:"h-4 w-4"}),e.jsx("span",{children:_.label})]})},_.value))})]}),e.jsxs(I,{onClick:b,disabled:!p,children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Add Item"]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 pt-4 border-t",children:[e.jsx(I,{variant:"outline",onClick:t,children:"Cancel"}),e.jsxs(I,{onClick:N,children:[e.jsx(Od,{className:"h-4 w-4 mr-2"}),"Save Template"]})]})]})]}),f.length>0&&e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center space-x-2",children:[C(a),e.jsx("span",{children:"Template Preview"})]}),e.jsx(Vt,{children:"Preview of your template structure"})]}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-2",children:f.map((_,k)=>e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[k+1,"."]}),S(_.type),e.jsx("span",{children:_.name}),e.jsx(Oe,{variant:"outline",className:"text-xs",children:_.type})]},_.id))})})]})]})}const sR=[{value:"balance_sheet",label:"Balance Sheet",icon:lr,description:"Assets, liabilities, and equity"},{value:"income_statement",label:"Income Statement",icon:$s,description:"Revenue, expenses, and net income"},{value:"cash_flow",label:"Cash Flow",icon:or,description:"Operating, investing, and financing activities"},{value:"equity",label:"Equity",icon:Eo,description:"Changes in equity over time"},{value:"custom",label:"Custom Report",icon:Zt,description:"User-defined custom report"}];function rRe({isOpen:s,onClose:t,onCreateReport:r,templateData:n}){const[a,i]=x.useState({name:(n==null?void 0:n.name)||"",type:(n==null?void 0:n.type)||"",description:(n==null?void 0:n.description)||"",companyId:"seed-company-1",isTemplate:!1,isPublic:!1,metadata:n!=null&&n.configuration?JSON.stringify(n.configuration):void 0}),[o,l]=x.useState({});x.useEffect(()=>{i(n?{name:n.name||"",type:n.type||"",description:n.description||"",companyId:"seed-company-1",isTemplate:n.isTemplate||!1,isPublic:n.isPublic||!1,metadata:n.configuration?JSON.stringify(n.configuration):void 0}:{name:"",type:"",description:"",companyId:"seed-company-1",isTemplate:!1,isPublic:!1,metadata:void 0}),l({})},[n]);const c=(m,p)=>{i(g=>({...g,[m]:p})),o[m]&&l(g=>({...g,[m]:void 0}))},d=()=>{const m={};return a.name.trim()||(m.name="Report name is required"),a.type||(m.type="Report type is required"),a.companyId.trim()||(m.companyId="Company ID is required"),l(m),Object.keys(m).length===0},u=m=>{m.preventDefault(),d()&&(r(a),t())},h=()=>{i({name:"",type:"",description:"",companyId:"seed-company-1",isTemplate:!1,isPublic:!1,metadata:void 0}),l({}),t()},f=sR.find(m=>m.value===a.type);return e.jsx(ts,{open:s,onOpenChange:t,children:e.jsxs(ss,{className:"sm:max-w-[600px]",children:[e.jsxs(as,{children:[e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(Ss,{className:"h-5 w-5"}),n!=null&&n.id?"Edit Report":"Create New Report"]}),e.jsx(Ks,{children:n!=null&&n.id?`Edit the details of: ${n.name}`:n?`Create a report from template: ${n.name}`:"Fill in the details to create a new financial report"})]}),e.jsxs("form",{onSubmit:u,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"name",children:"Report Name *"}),e.jsx(ge,{id:"name",placeholder:"Enter report name",value:a.name,onChange:m=>c("name",m.target.value),className:o.name?"border-red-500":""}),o.name&&e.jsx("p",{className:"text-sm text-red-500",children:o.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"type",children:"Report Type *"}),e.jsxs(rt,{value:a.type,onValueChange:m=>c("type",m),children:[e.jsx(nt,{className:o.type?"border-red-500":"",children:e.jsx(it,{placeholder:"Select report type"})}),e.jsx(at,{children:sR.map(m=>e.jsx(W,{value:m.value,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(m.icon,{className:"h-4 w-4"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:m.label}),e.jsx("div",{className:"text-sm text-muted-foreground",children:m.description})]})]})},m.value))})]}),o.type&&e.jsx("p",{className:"text-sm text-red-500",children:o.type})]}),f&&e.jsxs("div",{className:"p-3 bg-muted rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(f.icon,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:f.label})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:f.description})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"description",children:"Description"}),e.jsx(Xs,{id:"description",placeholder:"Enter report description (optional)",value:a.description,onChange:m=>c("description",m.target.value),rows:3})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"companyId",children:"Company ID *"}),e.jsx(ge,{id:"companyId",placeholder:"Enter company ID",value:a.companyId,onChange:m=>c("companyId",m.target.value),className:o.companyId?"border-red-500":""}),o.companyId&&e.jsx("p",{className:"text-sm text-red-500",children:o.companyId})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ka,{id:"isTemplate",checked:a.isTemplate,onCheckedChange:m=>c("isTemplate",m)}),e.jsx(B,{htmlFor:"isTemplate",className:"text-sm",children:"Save as template for future use"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ka,{id:"isPublic",checked:a.isPublic,onCheckedChange:m=>c("isPublic",m)}),e.jsx(B,{htmlFor:"isPublic",className:"text-sm",children:"Make this report public (visible to all users)"})]})]}),e.jsxs(Xr,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:h,children:"Cancel"}),e.jsxs(I,{type:"submit",children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),n!=null&&n.id?"Update Report":"Create Report"]})]})]})]})})}function nRe({isOpen:s,onClose:t,onConfirm:r,title:n,description:a,confirmText:i="Confirm",cancelText:o="Cancel",variant:l="default",icon:c="warning",isLoading:d=!1}){const u=()=>{switch(c){case"delete":return e.jsx(hn,{className:"h-6 w-6 text-red-600"});case"execute":return e.jsx(po,{className:"h-6 w-6 text-blue-600"});case"warning":default:return e.jsx(Is,{className:"h-6 w-6 text-yellow-600"})}},h=()=>{switch(l){case"danger":return"destructive";case"warning":return"default";default:return"default"}};return e.jsx(ts,{open:s,onOpenChange:t,children:e.jsxs(ss,{className:"sm:max-w-[425px]",children:[e.jsxs(as,{children:[e.jsxs(is,{className:"flex items-center gap-3",children:[u(),n]}),e.jsx(Ks,{className:"text-base",children:a})]}),e.jsxs(Xr,{className:"gap-2",children:[e.jsxs(I,{type:"button",variant:"outline",onClick:t,disabled:d,children:[e.jsx(ma,{className:"h-4 w-4 mr-2"}),o]}),e.jsx(I,{type:"button",variant:h(),onClick:r,disabled:d,children:d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[c==="delete"&&e.jsx(hn,{className:"h-4 w-4 mr-2"}),c==="execute"&&e.jsx(po,{className:"h-4 w-4 mr-2"}),i]})})]})]})})}function aRe({isOpen:s,onClose:t,template:r}){if(!r)return null;const n=i=>{switch(i){case"balance_sheet":return e.jsx(lr,{className:"h-5 w-5 text-blue-600"});case"income_statement":return e.jsx($s,{className:"h-5 w-5 text-green-600"});case"cash_flow":return e.jsx(or,{className:"h-5 w-5 text-purple-600"});case"equity":return e.jsx(Eo,{className:"h-5 w-5 text-orange-600"});case"custom":return e.jsx(Zt,{className:"h-5 w-5 text-gray-600"});default:return e.jsx(Zt,{className:"h-5 w-5 text-gray-600"})}},a=i=>{switch(i){case"balance_sheet":return"Balance Sheet";case"income_statement":return"Income Statement";case"cash_flow":return"Cash Flow";case"equity":return"Equity Report";case"custom":return"Custom Report";default:return i.replace("_"," ").replace(/\b\w/g,o=>o.toUpperCase())}};return e.jsx(ts,{open:s,onOpenChange:t,children:e.jsxs(ss,{className:"sm:max-w-[600px] max-h-[90vh] flex flex-col",children:[e.jsxs(as,{className:"flex-shrink-0",children:[e.jsxs(is,{className:"flex items-center gap-3",children:[n(r.type),e.jsx("span",{children:r.name})]}),e.jsx(Ks,{children:"Template details and configuration"})]}),e.jsxs("div",{className:"relative flex-1 overflow-y-auto space-y-6 pr-2 scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-gray-100 hover:scrollbar-thumb-gray-400",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{className:"text-lg",children:"Template Overview"})}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Type"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n(r.type),e.jsx("span",{className:"font-medium",children:a(r.type)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Category"}),e.jsx("div",{className:"mt-1",children:e.jsx(Oe,{variant:"outline",children:r.category})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Description"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:r.description||"No description provided"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Visibility:"}),r.isPublic?e.jsxs(Oe,{variant:"secondary",className:"flex items-center gap-1",children:[e.jsx(T5,{className:"h-3 w-3"}),"Public"]}):e.jsxs(Oe,{variant:"outline",className:"flex items-center gap-1",children:[e.jsx(wm,{className:"h-3 w-3"}),"Private"]})]})]})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{className:"text-lg",children:"Creator Information"})}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center",children:e.jsx(bo,{className:"h-5 w-5 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:r.createdByUser.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r.createdByUser.email})]})]}),r.createdAt&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Xn,{className:"h-4 w-4"}),e.jsxs("span",{children:["Created: ",new Date(r.createdAt).toLocaleDateString()]})]}),r.updatedAt&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Xn,{className:"h-4 w-4"}),e.jsxs("span",{children:["Updated: ",new Date(r.updatedAt).toLocaleDateString()]})]})]})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{className:"text-lg",children:"Template Configuration"})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Template ID:"}),e.jsx("span",{className:"text-sm font-mono",children:r.id})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Report Type:"}),e.jsx("span",{className:"text-sm",children:a(r.type)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Category:"}),e.jsx("span",{className:"text-sm",children:r.category})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Visibility:"}),e.jsx("span",{className:"text-sm",children:r.isPublic?"Public":"Private"})]})]})})]})]}),e.jsx("div",{className:"flex justify-end gap-2 pt-4 border-t flex-shrink-0",children:e.jsxs(I,{variant:"outline",onClick:t,children:[e.jsx(ma,{className:"h-4 w-4 mr-2"}),"Close"]})})]})})}function rR(){var ft;const{toast:s}=za(),t=pu(),[r,n]=x.useState(zs()),[a,i]=x.useState([]),[o,l]=x.useState([]),[c,d]=x.useState([]),[u,h]=x.useState(""),[f,m]=x.useState("all"),[p,g]=x.useState("all"),[v,y]=x.useState(!1),[j,b]=x.useState(null);x.useEffect(()=>{const He=()=>{const It=zs();It&&It!==r&&(console.log(" Reports page - Company changed from",r,"to",It),n(It))};window.addEventListener("storage",He);const Je=It=>{const Gt=It.detail.companyId;Gt&&Gt!==r&&(console.log(" Reports page - Company changed via custom event from",r,"to",Gt),n(Gt))};return window.addEventListener("companyChanged",Je),()=>{window.removeEventListener("storage",He),window.removeEventListener("companyChanged",Je)}},[r]);const w=()=>t.pathname==="/dashboard/custom-report-builder"?"builder":"overview",[N,C]=x.useState(null),[S,_]=x.useState(null),[k,F]=x.useState(null),[A,T]=x.useState(!0),[V,M]=x.useState(!1),[G,L]=x.useState(!1),[J,z]=x.useState(null),[U,oe]=x.useState(null),[Q,P]=x.useState(!1),[q,D]=x.useState(!1),[se,he]=x.useState(null),[be,pe]=x.useState(!1),[Ae,Ee]=x.useState(!1),[$e,O]=x.useState(null);x.useEffect(()=>{de.tenantId||(de.tenantId="tenant_demo"),(async()=>{try{const Je=await X("cmfuyxjgo009pii03jql5wugu")}catch{}})(),ce(),Y(),Le(),te()},[]),x.useEffect(()=>{const He=setInterval(()=>{Le()},3e4);return()=>clearInterval(He)},[]);const te=async()=>{try{T(!0);const He=zs(),Je=await de.post("/api/enhanced-financial-reports/generate",{reportType:"balance-sheet",companyId:He,asOfDate:new Date().toISOString().split("T")[0]});C(Je);const It=new Date().getFullYear(),Gt=await de.post("/api/enhanced-financial-reports/generate",{reportType:"profit-loss",companyId:He,startDate:`${It}-01-01`,endDate:new Date().toISOString().split("T")[0]});_(Gt);const qt=await de.post("/api/enhanced-financial-reports/generate",{reportType:"cash-flow",companyId:He,startDate:`${It}-01-01`,endDate:new Date().toISOString().split("T")[0]});F(qt)}catch{}finally{T(!1)}},re=He=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(He),le=()=>{var qt,As,Ht,xs,Ct,ke,gt,us,We,Et,Pt,rs,ms,Bs,Vs,Ws;if(!N)return{totalAssets:0,totalLiabilities:0,totalEquity:0};const He=(((As=(qt=N.assets)==null?void 0:qt.currentAssets)==null?void 0:As.reduce((Ns,er)=>Ns+(er.balance||0),0))||0)+(((xs=(Ht=N.assets)==null?void 0:Ht.fixedAssets)==null?void 0:xs.reduce((Ns,er)=>Ns+(er.balance||0),0))||0)+(((ke=(Ct=N.assets)==null?void 0:Ct.otherAssets)==null?void 0:ke.reduce((Ns,er)=>Ns+(er.balance||0),0))||0),Je=(((us=(gt=N.liabilities)==null?void 0:gt.currentLiabilities)==null?void 0:us.reduce((Ns,er)=>Ns+(er.balance||0),0))||0)+(((Et=(We=N.liabilities)==null?void 0:We.longTermLiabilities)==null?void 0:Et.reduce((Ns,er)=>Ns+(er.balance||0),0))||0),It=(((rs=(Pt=N.equity)==null?void 0:Pt.contributedCapital)==null?void 0:rs.reduce((Ns,er)=>Ns+(er.balance||0),0))||0)+(((Bs=(ms=N.equity)==null?void 0:ms.retainedEarnings)==null?void 0:Bs.reduce((Ns,er)=>Ns+(er.balance||0),0))||0)+(((Ws=(Vs=N.equity)==null?void 0:Vs.otherEquity)==null?void 0:Ws.reduce((Ns,er)=>Ns+(er.balance||0),0))||0);return{totalAssets:He,totalLiabilities:Je,totalEquity:It}},Z=()=>{var ke,gt,us,We,Et,Pt,rs,ms,Bs;if(!S)return{totalRevenue:0,totalExpenses:0,netIncome:0};const He=((gt=(ke=S.revenue)==null?void 0:ke.salesRevenue)==null?void 0:gt.reduce((Vs,Ws)=>Vs+(Ws.balance||0),0))||0,Je=((We=(us=S.revenue)==null?void 0:us.serviceRevenue)==null?void 0:We.reduce((Vs,Ws)=>Vs+(Ws.balance||0),0))||0,It=((Pt=(Et=S.revenue)==null?void 0:Et.otherRevenue)==null?void 0:Pt.reduce((Vs,Ws)=>Vs+(Ws.balance||0),0))||0,Gt=He+Je+It,qt=((rs=S.costOfGoodsSold)==null?void 0:rs.totalCOGS)||0,As=((ms=S.operatingExpenses)==null?void 0:ms.totalOperatingExpenses)||0,Ht=((Bs=S.otherExpenses)==null?void 0:Bs.totalOtherExpenses)||0,xs=qt+As+Ht;return{totalRevenue:Gt,totalExpenses:xs,netIncome:S.netIncome||0}},K=()=>{var Je,It;return k?{operatingCash:((Je=k.operatingActivities)==null?void 0:Je.netCashFlow)||0,investingCash:((It=k.investingActivities)==null?void 0:It.netCashFlow)||0,netCashFlow:k.netCashFlow||0}:{operatingCash:0,investingCash:0,netCashFlow:0}},X=async He=>{try{const Je=zs();if(!Je)throw new Error("Company ID is required");return await de.get(`/api/enhanced-financial-reports/balance-sheet?companyId=${Je}`)}catch(Je){throw console.error("Error fetching report by ID:",Je),Je}},ce=async()=>{try{if(!zs())throw new Error("Company ID is required");const Je=await de.get("/api/enhanced-financial-reports/templates");let It=[];Je.success&&Je.data&&Array.isArray(Je.data)?It=Je.data:Array.isArray(Je)?It=Je:It=[],i(It),Je.reports?It=Je.reports:It=[],i(It)}catch(He){console.error("Error fetching reports:",He),i([{id:"1",name:"Monthly Balance Sheet",type:"balance_sheet",description:"Monthly balance sheet report",isTemplate:!1,isPublic:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),createdByUser:{id:"1",name:"System",email:"system@urutiq.com"},_count:{reportItems:15,reportSchedules:1}},{id:"2",name:"Quarterly Income Statement",type:"income_statement",description:"Quarterly income statement report",isTemplate:!1,isPublic:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),createdByUser:{id:"1",name:"System",email:"system@urutiq.com"},_count:{reportItems:12,reportSchedules:1}}])}},Y=async()=>{try{if(!zs()){l([]);return}const Je=await de.get("/api/enhanced-financial-reports/templates");let It=[];Je&&Je.success&&Je.data?It=Je.data:Array.isArray(Je)?It=Je:Je&&Array.isArray(Je.templates)?It=Je.templates:It=[],l(It)}catch(He){l([]),s({title:"Error Loading Templates",description:`Failed to load templates: ${(He==null?void 0:He.message)||"Unknown error"}`,variant:"destructive"})}},ue=()=>p==="all"?c:c.filter(He=>He.status===p),ve=async()=>{await Le()},Le=async()=>{try{const He=[{id:"exec-1",status:"completed",executedAt:new Date().toISOString(),executedByUser:{id:"1",name:"Current User",email:"user@urutiq.com"},report:{id:"report-1",name:"Balance Sheet Report"}},{id:"exec-2",status:"completed",executedAt:new Date(Date.now()-864e5).toISOString(),executedByUser:{id:"1",name:"Current User",email:"user@urutiq.com"},report:{id:"report-2",name:"Profit & Loss Report"}}];d(He)}catch{d([])}},Me=He=>{switch(He){case"balance_sheet":return e.jsx(lr,{className:"h-4 w-4"});case"income_statement":return e.jsx($s,{className:"h-4 w-4"});case"cash_flow":return e.jsx(or,{className:"h-4 w-4"});case"equity":return e.jsx(Eo,{className:"h-4 w-4"});default:return e.jsx(Zt,{className:"h-4 w-4"})}},tt=He=>{switch(He){case"balance_sheet":return"Balance Sheet";case"income_statement":return"Income Statement";case"cash_flow":return"Cash Flow";case"equity":return"Equity";default:return"Custom"}},fe=He=>{switch(He){case"success":return e.jsxs(Oe,{variant:"default",className:"bg-green-100 text-green-800",children:[e.jsx(bs,{className:"h-3 w-3 mr-1"}),"Success"]});case"error":return e.jsxs(Oe,{variant:"destructive",children:[e.jsx(Ln,{className:"h-3 w-3 mr-1"}),"Error"]});case"processing":return e.jsxs(Oe,{variant:"secondary",children:[e.jsx(Cr,{className:"h-3 w-3 mr-1"}),"Processing"]});default:return e.jsx(Oe,{variant:"outline",children:He})}},ct=a.filter(He=>{var Gt;const Je=(((Gt=He.name)==null?void 0:Gt.toLowerCase())||"").includes(u.toLowerCase())||He.description&&He.description.toLowerCase().includes(u.toLowerCase()),It=f==="all"||He.type===f;return Je&&It}),dt=async He=>{try{const Je=qi.demo.companyId,It=new Date().toISOString().split("T")[0];let Gt="";switch(He){case"balance-sheet":Gt=`/api/enhanced-financial-reports/balance-sheet?companyId=${Je}&asOfDate=${It}`;break;case"profit-loss":const Ht=new Date;Ht.setMonth(Ht.getMonth()-1),Gt=`/api/enhanced-financial-reports/profit-loss?companyId=${Je}&startDate=${Ht.toISOString().split("T")[0]}&endDate=${It}`;break;case"cash-flow":const xs=new Date;xs.setMonth(xs.getMonth()-1),Gt=`/api/enhanced-financial-reports/cash-flow?companyId=${Je}&startDate=${xs.toISOString().split("T")[0]}&endDate=${It}`;break;default:throw new Error(`Unsupported report type: ${He}`)}const qt=await de.get(Gt),As=(qt==null?void 0:qt.data)||qt;if(As)oe(As),P(!0),s({title:"Report Generated",description:`${He.replace("-"," ").replace(/\b\w/g,Ht=>Ht.toUpperCase())} report generated successfully.`});else throw new Error("No data received from report generation")}catch(Je){console.error("Error generating inline report:",Je),s({title:"Error",description:`Failed to generate ${He.replace("-"," ").replace(/\b\w/g,It=>It.toUpperCase())} report: ${Je instanceof Error?Je.message:"Unknown error"}`,variant:"destructive"})}},pt=async He=>{try{if(He==="balance-sheet-1"||He==="income-statement-1"||He==="cash-flow-1"){let qt="balance-sheet";He==="income-statement-1"&&(qt="profit-loss"),He==="cash-flow-1"&&(qt="cash-flow"),await dt(qt);return}let Je;try{const qt=await X(He),As={"Balance Sheet":"balance_sheet","P&L":"income_statement","Cash Flow":"cash_flow","AR/AP Aging":"custom","Tax Summary":"equity"};let Ht={};try{Ht=JSON.parse(qt.parameters||"{}")}catch{Ht={}}Je={id:qt.id,name:Ht.name||`${qt.reportType} Report`,type:As[qt.reportType]||"custom",description:Ht.description||`${qt.reportType} report`,isTemplate:Ht.isTemplate||!1,isPublic:Ht.isPublic||!1,createdAt:qt.generatedAt,updatedAt:qt.generatedAt,createdByUser:{id:"1",name:"Current User",email:"user@urutiq.com"},_count:{reportItems:5,reportSchedules:1},fileUrl:qt.fileUrl}}catch{Je=a.find(As=>As.id===He)}if(!Je){s({title:"Error",description:"Report not found.",variant:"destructive"});return}if(Je.fileUrl){const qt=Je.fileUrl.replace("/reports/",""),As=`${qi.api.baseUrlWithoutApi}/api/pdf/${qt}?tenantId=${qi.demo.tenantId}`;window.open(As,"_blank"),s({title:"Opening Report",description:`Opening ${Je.name} in a new tab...`});return}let It="";switch(Je.type){case"balance_sheet":It="balance-sheet";break;case"income_statement":It="profit-loss";break;case"cash_flow":It="cash-flow";break;default:It="balance-sheet"}s({title:"Generating Report",description:`Generating ${Je.name}...`});const Gt=await de.post("/api/enhanced-financial-reports/generate",{reportType:It,companyId:"seed-company-1",asOfDate:new Date().toISOString().split("T")[0],startDate:new Date(new Date().getFullYear(),0,1).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0]});b({[It]:Gt.data}),y(!0),s({title:"Report Generated",description:`${Je.name} has been generated successfully.`})}catch(Je){console.error("Error viewing report:",Je),s({title:"Error",description:"Failed to view report. Please try again.",variant:"destructive"})}},qe=async He=>{try{const Je=await Rt(He);s({title:"Execution History",description:`Found ${Je.length} executions for this report. Check console for details.`})}catch(Je){console.error("Error viewing executions:",Je),s({title:"Error",description:"Failed to fetch execution history.",variant:"destructive"})}},mt=He=>{const Je=a.find(Gt=>Gt.id===He),It=(Je==null?void 0:Je.name)||"Unknown Report";he({title:"Execute Report",description:`Are you sure you want to execute "${It}"? This will generate a new report instance.`,confirmText:"Execute Report",variant:"default",icon:"execute",onConfirm:()=>_e()}),D(!0)},Rt=async He=>{try{return[]}catch(Je){return console.error("Error fetching executions:",Je),[]}},_e=async He=>{try{pe(!0);const Je=zs();if(!Je)throw new Error("No company ID found. Please select a company first.");const It=await de.post("/api/enhanced-financial-reports/generate",{reportType:"balance-sheet",companyId:Je,asOfDate:new Date().toISOString().split("T")[0]});s({title:"Report Executed Successfully",description:`Report has been executed. Execution ID: ${It.executionId}`}),await Le(),It.data,await ce()}catch(Je){console.error("Error executing report:",Je),s({title:"Execution Failed",description:"Failed to execute report. Please check the logs and try again.",variant:"destructive"})}finally{pe(!1),D(!1)}},Xe=async He=>{try{let Je;try{const It=await X(He),Gt={"Balance Sheet":"balance_sheet","P&L":"income_statement","Cash Flow":"cash_flow","AR/AP Aging":"custom","Tax Summary":"equity"};let qt={};try{qt=JSON.parse(It.parameters||"{}")}catch{qt={}}Je={id:It.id,name:qt.name||`${It.reportType} Report`,type:Gt[It.reportType]||"custom",description:qt.description||`${It.reportType} report`,isTemplate:qt.isTemplate||!1,isPublic:qt.isPublic||!1,createdAt:It.generatedAt,updatedAt:It.generatedAt,createdByUser:{id:"1",name:"Current User",email:"user@urutiq.com"},_count:{reportItems:5,reportSchedules:1},fileUrl:It.fileUrl}}catch{Je=a.find(Gt=>Gt.id===He)}if(!Je){s({title:"Error",description:"Report not found.",variant:"destructive"});return}z(Je),L(!0),s({title:"Editing Report",description:`Editing ${Je.name}...`})}catch(Je){console.error("Error preparing report for edit:",Je),s({title:"Error",description:"Failed to prepare report for editing.",variant:"destructive"})}},At=He=>{const Je=a.find(Gt=>Gt.id===He),It=(Je==null?void 0:Je.name)||"Unknown Report";he({title:"Delete Report",description:`Are you sure you want to delete "${It}"? This action cannot be undone.`,confirmText:"Delete Report",variant:"danger",icon:"delete",onConfirm:()=>st(He)}),D(!0)},st=async He=>{try{if(pe(!0),!zs())throw new Error("Company ID is required");i(It=>It.filter(Gt=>Gt.id!==He)),s({title:"Report Deleted",description:"Report has been deleted successfully."})}catch(Je){console.error("Error deleting report:",Je),s({title:"Error",description:"Failed to delete report. Please try again.",variant:"destructive"})}finally{pe(!1),D(!1)}},$t=He=>{z(He),L(!0)},fs=async He=>{try{const Je=J==null?void 0:J.id,It={balance_sheet:"Balance Sheet",income_statement:"P&L",cash_flow:"Cash Flow",equity:"Tax Summary",custom:"Balance Sheet"},Gt={name:He.name,type:He.type,description:He.description,isTemplate:He.isTemplate||!1,isPublic:He.isPublic||!1,metadata:JSON.stringify({startDate:"2025-01-01",endDate:"2025-01-31"})};let qt;if(Je){if(!zs())throw new Error("Company ID is required");qt={id:J.id,...Gt}}else{if(!zs())throw new Error("Company ID is required");qt={id:`report-${Date.now()}`,...Gt}}const As=xs=>{switch(xs){case"balance_sheet":return{reportItems:12,reportSchedules:1};case"income_statement":return{reportItems:8,reportSchedules:1};case"cash_flow":return{reportItems:6,reportSchedules:1};case"equity":return{reportItems:4,reportSchedules:1};case"custom":return{reportItems:3,reportSchedules:0};default:return{reportItems:5,reportSchedules:1}}},Ht={id:qt.id||(J==null?void 0:J.id)||`report-${Date.now()}`,name:He.name,type:He.type,description:He.description,isTemplate:He.isTemplate,isPublic:He.isPublic,createdAt:qt.generatedAt||(J==null?void 0:J.createdAt)||new Date().toISOString(),updatedAt:qt.generatedAt||new Date().toISOString(),createdByUser:{id:"1",name:"Current User",email:"user@urutiq.com"},_count:As(He.type),fileUrl:qt.fileUrl||(J==null?void 0:J.fileUrl)};Je?(i(xs=>xs.map(Ct=>Ct.id===J.id?Ht:Ct)),s({title:"Report Updated",description:"Your report has been updated successfully."})):(i(xs=>[Ht,...xs]),s({title:"Report Created",description:"Your report has been created successfully."})),await ce()}catch(Je){console.error("Error saving report:",Je),s({title:"Error",description:`Failed to ${J!=null&&J.id?"update":"create"} report. Please try again.`,variant:"destructive"})}},zt=He=>{var It;const Je={id:`draft-${Date.now()}`,name:He.name,type:He.type,description:He.description,isTemplate:!1,isPublic:!1,createdAt:He.createdAt,updatedAt:He.createdAt,createdByUser:{id:"1",name:"Current User",email:"user@urutiq.com"},_count:{reportItems:((It=He.items)==null?void 0:It.length)||0,reportSchedules:0}};i([...a,Je]),s({title:"Draft Saved",description:`Draft "${He.name}" has been saved successfully!`})},St=()=>{M(!0)},js=async He=>{try{const Je={name:He.name,type:He.type,category:(He.category||"custom").toLowerCase(),description:He.description||"",isPublic:He.isPublic||!1,configuration:JSON.stringify(He.configuration||{})},Gt={id:{id:`template-${Date.now()}`,...Je}.id||`template-${Date.now()}`,name:He.name,type:He.type,category:He.category||"Custom",description:He.description,isPublic:He.isPublic||!1,createdByUser:{id:"1",name:"Current User",email:"user@urutiq.com"}};l(qt=>[...qt,Gt]),M(!1),s({title:"Template Created",description:`Template "${He.name}" has been created successfully!`})}catch(Je){console.error("Error saving template:",Je),s({title:"Error",description:"Failed to create template. Please try again.",variant:"destructive"})}},et=He=>{const Je=o.find(It=>It.id===He);if(Je){const It={name:`${Je.name} - Report`,type:Je.type,description:Je.description||`Report created from template: ${Je.name}`,companyId:"seed-company-1",isTemplate:!1,isPublic:!1};z(It),L(!0),s({title:"Using Template",description:`Creating report from template: ${Je.name}`})}},lt=He=>{const Je=o.find(It=>It.id===He);Je&&(O(Je),Ee(!0),s({title:"Template Details",description:`Viewing template: ${Je.name}`}))},Fe=()=>{};return e.jsx(sh,{children:e.jsxs(Kr,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:t.pathname==="/dashboard/custom-report-builder"?"Custom Report Builder":"Financial Reports"}),e.jsx("p",{className:"text-muted-foreground",children:t.pathname==="/dashboard/custom-report-builder"?"Build custom financial reports with drag-and-drop interface and advanced analytics":"Create, manage, and execute comprehensive financial reports and analytics"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(I,{variant:"outline",onClick:Fe,children:[e.jsx(Zt,{className:"h-4 w-4 mr-2"}),"Templates"]}),e.jsxs(I,{variant:"outline",onClick:te,disabled:A,children:[e.jsx(Ts,{className:`h-4 w-4 mr-2 ${A?"animate-spin":""}`}),"Refresh Data"]}),e.jsxs(I,{variant:"outline",onClick:St,children:[e.jsx(Zt,{className:"h-4 w-4 mr-2"}),"Create Template"]}),e.jsxs(I,{onClick:$t,children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"New Report"]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 -mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Company"}),e.jsx("input",{className:"h-8 w-48 border rounded px-2 text-sm",placeholder:"seed-company-1"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Period"}),e.jsxs("div",{className:"inline-flex rounded-md border overflow-hidden",children:[e.jsx("button",{className:"px-2 py-1 text-xs hover:bg-muted",children:"MTD"}),e.jsx("button",{className:"px-2 py-1 text-xs hover:bg-muted",children:"QTD"}),e.jsx("button",{className:"px-2 py-1 text-xs hover:bg-muted",children:"YTD"})]}),e.jsx("input",{className:"h-8 w-40 border rounded px-2 text-sm",placeholder:"YYYY-MM-DD"})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Total Reports"}),e.jsx(Zt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:a.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"+12% from last month"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Templates"}),e.jsx(Zt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:o.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"+5 new templates"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Executions"}),e.jsx(Za,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:c.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"+8% from last week"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Scheduled"}),e.jsx(Xn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:"24"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active schedules"})]})]})]}),e.jsxs(an,{defaultValue:w(),className:"space-y-4",children:[e.jsxs(on,{children:[e.jsx(vt,{value:"overview",children:"Overview"}),e.jsx(vt,{value:"reports",children:"Reports"}),e.jsx(vt,{value:"templates",children:"Templates"}),e.jsx(vt,{value:"executions",children:"Executions"}),e.jsx(vt,{value:"builder",children:"Report Builder"}),e.jsx(vt,{value:"analytics",children:"Analytics"})]}),e.jsxs(yt,{value:"overview",className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center",children:[e.jsx(lr,{className:"h-5 w-5 mr-2"}),"Balance Sheet"]}),e.jsx(Vt,{children:"Current financial position"})]}),e.jsxs(ie,{children:[A?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Assets"}),e.jsx("div",{className:"h-4 w-20 bg-gray-200 rounded animate-pulse"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Liabilities"}),e.jsx("div",{className:"h-4 w-20 bg-gray-200 rounded animate-pulse"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Equity"}),e.jsx("div",{className:"h-4 w-20 bg-gray-200 rounded animate-pulse"})]})]}):e.jsx("div",{className:"space-y-2",children:(()=>{const{totalAssets:He,totalLiabilities:Je,totalEquity:It}=le();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Assets"}),e.jsx("span",{className:"font-semibold",children:re(He)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Liabilities"}),e.jsx("span",{className:"font-semibold",children:re(Je)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Equity"}),e.jsx("span",{className:"font-semibold text-green-600",children:re(It)})]})]})})()}),e.jsxs(I,{className:"w-full mt-4",size:"sm",onClick:()=>pt("balance-sheet-1"),disabled:A,children:[e.jsx(ir,{className:"h-4 w-4 mr-2"}),"View Report"]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center",children:[e.jsx($s,{className:"h-5 w-5 mr-2"}),"Income Statement"]}),e.jsx(Vt,{children:"Revenue and expenses"})]}),e.jsxs(ie,{children:[A?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Revenue"}),e.jsx("div",{className:"h-4 w-20 bg-gray-200 rounded animate-pulse"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Expenses"}),e.jsx("div",{className:"h-4 w-20 bg-gray-200 rounded animate-pulse"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Net Income"}),e.jsx("div",{className:"h-4 w-20 bg-gray-200 rounded animate-pulse"})]})]}):e.jsx("div",{className:"space-y-2",children:(()=>{const{totalRevenue:He,totalExpenses:Je,netIncome:It}=Z();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Revenue"}),e.jsx("span",{className:"font-semibold text-green-600",children:re(He)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Expenses"}),e.jsx("span",{className:"font-semibold text-red-600",children:re(Je)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Net Income"}),e.jsx("span",{className:`font-semibold ${It>=0?"text-green-600":"text-red-600"}`,children:re(It)})]})]})})()}),e.jsxs(I,{className:"w-full mt-4",size:"sm",onClick:()=>pt("income-statement-1"),disabled:A,children:[e.jsx(ir,{className:"h-4 w-4 mr-2"}),"View Report"]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center",children:[e.jsx(or,{className:"h-5 w-5 mr-2"}),"Cash Flow"]}),e.jsx(Vt,{children:"Cash movement analysis"})]}),e.jsxs(ie,{children:[A?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Operating Cash"}),e.jsx("div",{className:"h-4 w-20 bg-gray-200 rounded animate-pulse"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Investing Cash"}),e.jsx("div",{className:"h-4 w-20 bg-gray-200 rounded animate-pulse"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Net Cash Flow"}),e.jsx("div",{className:"h-4 w-20 bg-gray-200 rounded animate-pulse"})]})]}):e.jsx("div",{className:"space-y-2",children:(()=>{const{operatingCash:He,investingCash:Je,netCashFlow:It}=K();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Operating Cash"}),e.jsx("span",{className:`font-semibold ${He>=0?"text-green-600":"text-red-600"}`,children:re(He)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Investing Cash"}),e.jsx("span",{className:`font-semibold ${Je>=0?"text-green-600":"text-red-600"}`,children:re(Je)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Net Cash Flow"}),e.jsx("span",{className:`font-semibold ${It>=0?"text-green-600":"text-red-600"}`,children:re(It)})]})]})})()}),e.jsxs(I,{className:"w-full mt-4",size:"sm",onClick:()=>pt("cash-flow-1"),disabled:A,children:[e.jsx(ir,{className:"h-4 w-4 mr-2"}),"View Report"]})]})]})]}),v&&j&&e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Financial Report Details"}),e.jsx(Vt,{children:"Detailed financial analysis with export capabilities"}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>y(!1),className:"absolute top-4 right-4",children:"Close"})]}),e.jsx(ie,{children:e.jsx(l1,{initialData:j})})]}),Q&&U&&e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center justify-between",children:[e.jsxs("span",{children:[e.jsx(Zt,{className:"h-5 w-5 mr-2 inline"}),((ft=U.reportType)==null?void 0:ft.replace("_"," ").toUpperCase())||"Financial Report"]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{P(!1),oe(null)},children:"Close"})]}),e.jsxs(Vt,{children:["Generated on ",new Date().toLocaleDateString()," at ",new Date().toLocaleTimeString()]})]}),e.jsx(ie,{children:e.jsx(l1,{initialData:U})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Recent Report Executions"}),e.jsx(Vt,{children:"Latest report runs and their status"})]}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:c.slice(0,5).map(He=>{var Je;return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${He.status==="success"?"bg-green-500":He.status==="error"?"bg-red-500":"bg-blue-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:((Je=He.report)==null?void 0:Je.name)||"Report Execution"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Executed by ",He.executedByUser.name]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[fe(He.status),e.jsx("span",{className:"text-sm text-muted-foreground",children:new Date(He.executedAt).toLocaleDateString()})]})]},He.id)})})})]})]}),e.jsxs(yt,{value:"reports",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Rn,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(ge,{placeholder:"Search reports...",value:u,onChange:He=>h(He.target.value),className:"pl-8 w-64"})]}),e.jsxs(rt,{value:f,onValueChange:m,children:[e.jsx(nt,{className:"w-48",children:e.jsx(it,{placeholder:"Filter by type"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Types"}),e.jsx(W,{value:"balance_sheet",children:"Balance Sheet"}),e.jsx(W,{value:"income_statement",children:"Income Statement"}),e.jsx(W,{value:"cash_flow",children:"Cash Flow"}),e.jsx(W,{value:"equity",children:"Equity"}),e.jsx(W,{value:"custom",children:"Custom"})]})]})]}),e.jsxs(I,{onClick:$t,children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Create Report"]})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:ct.map(He=>e.jsxs(ne,{className:"hover:shadow-md transition-shadow",children:[e.jsxs(we,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[Me(He.type),e.jsx(Se,{className:"text-lg",children:He.name})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[He.isTemplate&&e.jsxs(Oe,{variant:"secondary",className:"text-xs",children:[e.jsx(Zt,{className:"h-3 w-3 mr-1"}),"Template"]}),He.isPublic&&e.jsxs(Oe,{variant:"outline",className:"text-xs",children:[e.jsx(T5,{className:"h-3 w-3 mr-1"}),"Public"]})]})]}),e.jsx(Vt,{children:He.description||tt(He.type)})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Items:"}),e.jsx("span",{className:"font-medium",children:He._count.reportItems})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Schedules:"}),e.jsx("span",{className:"font-medium",children:He._count.reportSchedules})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Created by:"}),e.jsx("span",{className:"font-medium",children:He.createdByUser.name})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Updated:"}),e.jsx("span",{className:"font-medium",children:new Date(He.updatedAt).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-4",children:[e.jsxs(I,{size:"sm",className:"flex-1",onClick:()=>mt(He.id),children:[e.jsx(po,{className:"h-4 w-4 mr-2"}),"Execute"]}),e.jsx(I,{size:"sm",variant:"outline",onClick:()=>qe(He.id),title:"View Executions",children:e.jsx(Cr,{className:"h-4 w-4"})}),e.jsx(I,{size:"sm",variant:"outline",onClick:()=>pt(He.id),title:"View Report",children:e.jsx(ir,{className:"h-4 w-4"})}),e.jsx(I,{size:"sm",variant:"outline",onClick:()=>Xe(He.id),title:"Edit Report",children:e.jsx(ln,{className:"h-4 w-4"})}),e.jsx(I,{size:"sm",variant:"outline",onClick:()=>At(He.id),title:"Delete Report",className:"text-red-600 hover:text-red-700",children:e.jsx(hn,{className:"h-4 w-4"})})]})]})]},He.id))})]}),e.jsx(yt,{value:"templates",className:"space-y-4",children:V?e.jsx(sRe,{onSaveTemplate:js,onCancel:()=>M(!1)}):e.jsx(eRe,{templates:o,onCreateTemplate:St,onUseTemplate:et,onViewTemplate:lt})}),e.jsxs(yt,{value:"executions",className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Report Executions"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:ve,title:"Refresh Executions",children:[e.jsx(Ts,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsxs(rt,{value:p,onValueChange:g,children:[e.jsx(nt,{className:"w-48",children:e.jsx(it,{placeholder:"Filter by status"})}),e.jsxs(at,{children:[e.jsxs(W,{value:"all",children:["All Status (",c.length,")"]}),e.jsxs(W,{value:"success",children:["Success (",c.filter(He=>He.status==="success").length,")"]}),e.jsxs(W,{value:"error",children:["Error (",c.filter(He=>He.status==="error").length,")"]}),e.jsxs(W,{value:"processing",children:["Processing (",c.filter(He=>He.status==="processing").length,")"]})]})]})]})]}),e.jsx(ne,{children:e.jsx(ie,{className:"p-0",children:e.jsx("div",{className:"space-y-0",children:ue().map(He=>{var Je;return e.jsxs("div",{className:"flex items-center justify-between p-4 border-b last:border-b-0",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${He.status==="success"?"bg-green-500":He.status==="error"?"bg-red-500":"bg-blue-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:((Je=He.report)==null?void 0:Je.name)||"Report Execution"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Executed by ",He.executedByUser.name]})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[fe(He.status),e.jsx("span",{className:"text-sm text-muted-foreground",children:new Date(He.executedAt).toLocaleString()}),e.jsx(I,{size:"sm",variant:"outline",children:e.jsx(An,{className:"h-4 w-4"})})]})]},He.id)})})})})]}),e.jsx(yt,{value:"builder",className:"space-y-4",children:e.jsx(tRe,{onCreateReport:$t,onSaveAsDraft:zt})}),e.jsx(yt,{value:"analytics",className:"space-y-4",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center",children:[e.jsx(oY,{className:"h-5 w-5 mr-2"}),"Report Usage"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Most Used"}),e.jsx("span",{className:"font-semibold",children:"Balance Sheet"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Executions"}),e.jsx("span",{className:"font-semibold",children:"156"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Avg. Runtime"}),e.jsx("span",{className:"font-semibold",children:"2.3s"})]})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center",children:[e.jsx(eN,{className:"h-5 w-5 mr-2"}),"Performance"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Success Rate"}),e.jsx("span",{className:"font-semibold text-green-600",children:"98.5%"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Error Rate"}),e.jsx("span",{className:"font-semibold text-red-600",children:"1.5%"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Avg. Response"}),e.jsx("span",{className:"font-semibold",children:"1.8s"})]})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center",children:[e.jsx(Eo,{className:"h-5 w-5 mr-2"}),"Report Types"]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Balance Sheets"}),e.jsx("span",{className:"font-semibold",children:"45%"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Income Statements"}),e.jsx("span",{className:"font-semibold",children:"30%"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Cash Flow"}),e.jsx("span",{className:"font-semibold",children:"15%"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Custom"}),e.jsx("span",{className:"font-semibold",children:"10%"})]})]})})]})]})})]})]}),e.jsx(rRe,{isOpen:G,onClose:()=>{L(!1),z(null)},onCreateReport:fs,templateData:J}),se&&e.jsx(nRe,{isOpen:q,onClose:()=>{D(!1),he(null)},onConfirm:se.onConfirm,title:se.title,description:se.description,confirmText:se.confirmText,variant:se.variant,icon:se.icon,isLoading:be}),e.jsx(aRe,{isOpen:Ae,onClose:()=>{Ee(!1),O(null)},template:$e})]})})}function iRe(s,t){const r=x.createContext(t),n=i=>{const{children:o,...l}=i,c=x.useMemo(()=>l,Object.values(l));return e.jsx(r.Provider,{value:c,children:o})};n.displayName=s+"Provider";function a(i){const o=x.useContext(r);if(o)return o;if(t!==void 0)return t;throw new Error(`\`${i}\` must be used within \`${s}\``)}return[n,a]}function Vq(s,t=[]){let r=[];function n(i,o){const l=x.createContext(o),c=r.length;r=[...r,o];const d=h=>{var y;const{scope:f,children:m,...p}=h,g=((y=f==null?void 0:f[s])==null?void 0:y[c])||l,v=x.useMemo(()=>p,Object.values(p));return e.jsx(g.Provider,{value:v,children:m})};d.displayName=i+"Provider";function u(h,f){var g;const m=((g=f==null?void 0:f[s])==null?void 0:g[c])||l,p=x.useContext(m);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[d,u]}const a=()=>{const i=r.map(o=>x.createContext(o));return function(l){const c=(l==null?void 0:l[s])||i;return x.useMemo(()=>({[`__scope${s}`]:{...l,[s]:c}}),[l,c])}};return a.scopeName=s,[n,oRe(a,...t)]}function oRe(...s){const t=s[0];if(s.length===1)return t;const r=()=>{const n=s.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=n.reduce((l,{useScope:c,scopeName:d})=>{const h=c(i)[`__scope${d}`];return{...l,...h}},{});return x.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}function nR(s,t){if(typeof s=="function")return s(t);s!=null&&(s.current=t)}function Wq(...s){return t=>{let r=!1;const n=s.map(a=>{const i=nR(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():nR(s[a],null)}}}}function Nh(...s){return x.useCallback(Wq(...s),s)}function ah(s,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(s==null||s(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}var Mb=globalThis!=null&&globalThis.document?x.useLayoutEffect:()=>{},lRe=Zv.useId||(()=>{}),cRe=0;function OS(s){const[t,r]=x.useState(lRe());return Mb(()=>{r(n=>n??String(cRe++))},[s]),s||(t?`radix-${t}`:"")}function dx(s){const t=x.useRef(s);return x.useEffect(()=>{t.current=s}),x.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function dRe({prop:s,defaultProp:t,onChange:r=()=>{}}){const[n,a]=uRe({defaultProp:t,onChange:r}),i=s!==void 0,o=i?s:n,l=dx(r),c=x.useCallback(d=>{if(i){const h=typeof d=="function"?d(s):d;h!==s&&l(h)}else a(d)},[i,s,a,l]);return[o,c]}function uRe({defaultProp:s,onChange:t}){const r=x.useState(s),[n]=r,a=x.useRef(n),i=dx(t);return x.useEffect(()=>{a.current!==n&&(i(n),a.current=n)},[n,a,i]),r}var OE=x.forwardRef((s,t)=>{const{children:r,...n}=s,a=x.Children.toArray(r),i=a.find(hRe);if(i){const o=i.props.children,l=a.map(c=>c===i?x.Children.count(o)>1?x.Children.only(null):x.isValidElement(o)?o.props.children:null:c);return e.jsx(s5,{...n,ref:t,children:x.isValidElement(o)?x.cloneElement(o,void 0,l):null})}return e.jsx(s5,{...n,ref:t,children:r})});OE.displayName="Slot";var s5=x.forwardRef((s,t)=>{const{children:r,...n}=s;if(x.isValidElement(r)){const a=fRe(r);return x.cloneElement(r,{...mRe(n,r.props),ref:t?Wq(t,a):a})}return x.Children.count(r)>1?x.Children.only(null):null});s5.displayName="SlotClone";var Hq=({children:s})=>e.jsx(e.Fragment,{children:s});function hRe(s){return x.isValidElement(s)&&s.type===Hq}function mRe(s,t){const r={...t};for(const n in t){const a=s[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...l)=>{i(...l),a(...l)}:a&&(r[n]=a):n==="style"?r[n]={...a,...i}:n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return{...s,...r}}function fRe(s){var n,a;let t=(n=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}var xRe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],wh=xRe.reduce((s,t)=>{const r=x.forwardRef((n,a)=>{const{asChild:i,...o}=n,l=i?OE:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(l,{...o,ref:a})});return r.displayName=`Primitive.${t}`,{...s,[t]:r}},{});function pRe(s,t){s&&$m.flushSync(()=>s.dispatchEvent(t))}function gRe(s,t=globalThis==null?void 0:globalThis.document){const r=dx(s);x.useEffect(()=>{const n=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var vRe="DismissableLayer",r5="dismissableLayer.update",yRe="dismissableLayer.pointerDownOutside",jRe="dismissableLayer.focusOutside",aR,Gq=x.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Kq=x.forwardRef((s,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:o,onDismiss:l,...c}=s,d=x.useContext(Gq),[u,h]=x.useState(null),f=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=x.useState({}),p=Nh(t,S=>h(S)),g=Array.from(d.layers),[v]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),y=g.indexOf(v),j=u?g.indexOf(u):-1,b=d.layersWithOutsidePointerEventsDisabled.size>0,w=j>=y,N=wRe(S=>{const _=S.target,k=[...d.branches].some(F=>F.contains(_));!w||k||(a==null||a(S),o==null||o(S),S.defaultPrevented||l==null||l())},f),C=SRe(S=>{const _=S.target;[...d.branches].some(F=>F.contains(_))||(i==null||i(S),o==null||o(S),S.defaultPrevented||l==null||l())},f);return gRe(S=>{j===d.layers.size-1&&(n==null||n(S),!S.defaultPrevented&&l&&(S.preventDefault(),l()))},f),x.useEffect(()=>{if(u)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(aR=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(u)),d.layers.add(u),iR(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=aR)}},[u,f,r,d]),x.useEffect(()=>()=>{u&&(d.layers.delete(u),d.layersWithOutsidePointerEventsDisabled.delete(u),iR())},[u,d]),x.useEffect(()=>{const S=()=>m({});return document.addEventListener(r5,S),()=>document.removeEventListener(r5,S)},[]),e.jsx(wh.div,{...c,ref:p,style:{pointerEvents:b?w?"auto":"none":void 0,...s.style},onFocusCapture:ah(s.onFocusCapture,C.onFocusCapture),onBlurCapture:ah(s.onBlurCapture,C.onBlurCapture),onPointerDownCapture:ah(s.onPointerDownCapture,N.onPointerDownCapture)})});Kq.displayName=vRe;var bRe="DismissableLayerBranch",NRe=x.forwardRef((s,t)=>{const r=x.useContext(Gq),n=x.useRef(null),a=Nh(t,n);return x.useEffect(()=>{const i=n.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),e.jsx(wh.div,{...s,ref:a})});NRe.displayName=bRe;function wRe(s,t=globalThis==null?void 0:globalThis.document){const r=dx(s),n=x.useRef(!1),a=x.useRef(()=>{});return x.useEffect(()=>{const i=l=>{if(l.target&&!n.current){let c=function(){Yq(yRe,r,d,{discrete:!0})};const d={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=c,t.addEventListener("click",a.current,{once:!0})):c()}else t.removeEventListener("click",a.current);n.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",i),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function SRe(s,t=globalThis==null?void 0:globalThis.document){const r=dx(s),n=x.useRef(!1);return x.useEffect(()=>{const a=i=>{i.target&&!n.current&&Yq(jRe,r,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function iR(){const s=new CustomEvent(r5);document.dispatchEvent(s)}function Yq(s,t,r,{discrete:n}){const a=r.originalEvent.target,i=new CustomEvent(s,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(s,t,{once:!0}),n?pRe(a,i):a.dispatchEvent(i)}var RS="focusScope.autoFocusOnMount",FS="focusScope.autoFocusOnUnmount",oR={bubbles:!1,cancelable:!0},CRe="FocusScope",Jq=x.forwardRef((s,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:i,...o}=s,[l,c]=x.useState(null),d=dx(a),u=dx(i),h=x.useRef(null),f=Nh(t,g=>c(g)),m=x.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;x.useEffect(()=>{if(n){let g=function(b){if(m.paused||!l)return;const w=b.target;l.contains(w)?h.current=w:Hh(h.current,{select:!0})},v=function(b){if(m.paused||!l)return;const w=b.relatedTarget;w!==null&&(l.contains(w)||Hh(h.current,{select:!0}))},y=function(b){if(document.activeElement===document.body)for(const N of b)N.removedNodes.length>0&&Hh(l)};document.addEventListener("focusin",g),document.addEventListener("focusout",v);const j=new MutationObserver(y);return l&&j.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",v),j.disconnect()}}},[n,l,m.paused]),x.useEffect(()=>{if(l){cR.add(m);const g=document.activeElement;if(!l.contains(g)){const y=new CustomEvent(RS,oR);l.addEventListener(RS,d),l.dispatchEvent(y),y.defaultPrevented||(ARe(kRe(Xq(l)),{select:!0}),document.activeElement===g&&Hh(l))}return()=>{l.removeEventListener(RS,d),setTimeout(()=>{const y=new CustomEvent(FS,oR);l.addEventListener(FS,u),l.dispatchEvent(y),y.defaultPrevented||Hh(g??document.body,{select:!0}),l.removeEventListener(FS,u),cR.remove(m)},0)}}},[l,d,u,m]);const p=x.useCallback(g=>{if(!r&&!n||m.paused)return;const v=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,y=document.activeElement;if(v&&y){const j=g.currentTarget,[b,w]=ERe(j);b&&w?!g.shiftKey&&y===w?(g.preventDefault(),r&&Hh(b,{select:!0})):g.shiftKey&&y===b&&(g.preventDefault(),r&&Hh(w,{select:!0})):y===j&&g.preventDefault()}},[r,n,m.paused]);return e.jsx(wh.div,{tabIndex:-1,...o,ref:f,onKeyDown:p})});Jq.displayName=CRe;function ARe(s,{select:t=!1}={}){const r=document.activeElement;for(const n of s)if(Hh(n,{select:t}),document.activeElement!==r)return}function ERe(s){const t=Xq(s),r=lR(t,s),n=lR(t.reverse(),s);return[r,n]}function Xq(s){const t=[],r=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function lR(s,t){for(const r of s)if(!IRe(r,{upTo:t}))return r}function IRe(s,{upTo:t}){if(getComputedStyle(s).visibility==="hidden")return!0;for(;s;){if(t!==void 0&&s===t)return!1;if(getComputedStyle(s).display==="none")return!0;s=s.parentElement}return!1}function PRe(s){return s instanceof HTMLInputElement&&"select"in s}function Hh(s,{select:t=!1}={}){if(s&&s.focus){const r=document.activeElement;s.focus({preventScroll:!0}),s!==r&&PRe(s)&&t&&s.select()}}var cR=_Re();function _Re(){let s=[];return{add(t){const r=s[0];t!==r&&(r==null||r.pause()),s=dR(s,t),s.unshift(t)},remove(t){var r;s=dR(s,t),(r=s[0])==null||r.resume()}}}function dR(s,t){const r=[...s],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function kRe(s){return s.filter(t=>t.tagName!=="A")}var TRe="Portal",Qq=x.forwardRef((s,t)=>{var l;const{container:r,...n}=s,[a,i]=x.useState(!1);Mb(()=>i(!0),[]);const o=r||a&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?ey.createPortal(e.jsx(wh.div,{...n,ref:t}),o):null});Qq.displayName=TRe;function DRe(s,t){return x.useReducer((r,n)=>t[r][n]??r,s)}var gw=s=>{const{present:t,children:r}=s,n=ORe(t),a=typeof r=="function"?r({present:n.isPresent}):x.Children.only(r),i=Nh(n.ref,RRe(a));return typeof r=="function"||n.isPresent?x.cloneElement(a,{ref:i}):null};gw.displayName="Presence";function ORe(s){const[t,r]=x.useState(),n=x.useRef({}),a=x.useRef(s),i=x.useRef("none"),o=s?"mounted":"unmounted",[l,c]=DRe(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return x.useEffect(()=>{const d=kj(n.current);i.current=l==="mounted"?d:"none"},[l]),Mb(()=>{const d=n.current,u=a.current;if(u!==s){const f=i.current,m=kj(d);s?c("MOUNT"):m==="none"||(d==null?void 0:d.display)==="none"?c("UNMOUNT"):c(u&&f!==m?"ANIMATION_OUT":"UNMOUNT"),a.current=s}},[s,c]),Mb(()=>{if(t){let d;const u=t.ownerDocument.defaultView??window,h=m=>{const g=kj(n.current).includes(m.animationName);if(m.target===t&&g&&(c("ANIMATION_END"),!a.current)){const v=t.style.animationFillMode;t.style.animationFillMode="forwards",d=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=v)})}},f=m=>{m.target===t&&(i.current=kj(n.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",h),t.addEventListener("animationend",h),()=>{u.clearTimeout(d),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",h),t.removeEventListener("animationend",h)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:x.useCallback(d=>{d&&(n.current=getComputedStyle(d)),r(d)},[])}}function kj(s){return(s==null?void 0:s.animationName)||"none"}function RRe(s){var n,a;let t=(n=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}var MS=0;function FRe(){x.useEffect(()=>{const s=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",s[0]??uR()),document.body.insertAdjacentElement("beforeend",s[1]??uR()),MS++,()=>{MS===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),MS--}},[])}function uR(){const s=document.createElement("span");return s.setAttribute("data-radix-focus-guard",""),s.tabIndex=0,s.style.outline="none",s.style.opacity="0",s.style.position="fixed",s.style.pointerEvents="none",s}var RE="Dialog",[Zq,eV]=Vq(RE),[MRe,$d]=Zq(RE),tV=s=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:a,onOpenChange:i,modal:o=!0}=s,l=x.useRef(null),c=x.useRef(null),[d=!1,u]=dRe({prop:n,defaultProp:a,onChange:i});return e.jsx(MRe,{scope:t,triggerRef:l,contentRef:c,contentId:OS(),titleId:OS(),descriptionId:OS(),open:d,onOpenChange:u,onOpenToggle:x.useCallback(()=>u(h=>!h),[u]),modal:o,children:r})};tV.displayName=RE;var sV="DialogTrigger",rV=x.forwardRef((s,t)=>{const{__scopeDialog:r,...n}=s,a=$d(sV,r),i=Nh(t,a.triggerRef);return e.jsx(wh.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":LE(a.open),...n,ref:i,onClick:ah(s.onClick,a.onOpenToggle)})});rV.displayName=sV;var FE="DialogPortal",[LRe,nV]=Zq(FE,{forceMount:void 0}),aV=s=>{const{__scopeDialog:t,forceMount:r,children:n,container:a}=s,i=$d(FE,t);return e.jsx(LRe,{scope:t,forceMount:r,children:x.Children.map(n,o=>e.jsx(gw,{present:r||i.open,children:e.jsx(Qq,{asChild:!0,container:a,children:o})}))})};aV.displayName=FE;var Lb="DialogOverlay",iV=x.forwardRef((s,t)=>{const r=nV(Lb,s.__scopeDialog),{forceMount:n=r.forceMount,...a}=s,i=$d(Lb,s.__scopeDialog);return i.modal?e.jsx(gw,{present:n||i.open,children:e.jsx($Re,{...a,ref:t})}):null});iV.displayName=Lb;var $Re=x.forwardRef((s,t)=>{const{__scopeDialog:r,...n}=s,a=$d(Lb,r);return e.jsx(f5,{as:OE,allowPinchZoom:!0,shards:[a.contentRef],children:e.jsx(wh.div,{"data-state":LE(a.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),ux="DialogContent",oV=x.forwardRef((s,t)=>{const r=nV(ux,s.__scopeDialog),{forceMount:n=r.forceMount,...a}=s,i=$d(ux,s.__scopeDialog);return e.jsx(gw,{present:n||i.open,children:i.modal?e.jsx(BRe,{...a,ref:t}):e.jsx(URe,{...a,ref:t})})});oV.displayName=ux;var BRe=x.forwardRef((s,t)=>{const r=$d(ux,s.__scopeDialog),n=x.useRef(null),a=Nh(t,r.contentRef,n);return x.useEffect(()=>{const i=n.current;if(i)return m5(i)},[]),e.jsx(lV,{...s,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ah(s.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=r.triggerRef.current)==null||o.focus()}),onPointerDownOutside:ah(s.onPointerDownOutside,i=>{const o=i.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0;(o.button===2||l)&&i.preventDefault()}),onFocusOutside:ah(s.onFocusOutside,i=>i.preventDefault())})}),URe=x.forwardRef((s,t)=>{const r=$d(ux,s.__scopeDialog),n=x.useRef(!1),a=x.useRef(!1);return e.jsx(lV,{...s,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=s.onCloseAutoFocus)==null||o.call(s,i),i.defaultPrevented||(n.current||(l=r.triggerRef.current)==null||l.focus(),i.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:i=>{var c,d;(c=s.onInteractOutside)==null||c.call(s,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;((d=r.triggerRef.current)==null?void 0:d.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),lV=x.forwardRef((s,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:i,...o}=s,l=$d(ux,r),c=x.useRef(null),d=Nh(t,c);return FRe(),e.jsxs(e.Fragment,{children:[e.jsx(Jq,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:i,children:e.jsx(Kq,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":LE(l.open),...o,ref:d,onDismiss:()=>l.onOpenChange(!1)})}),e.jsxs(e.Fragment,{children:[e.jsx(qRe,{titleId:l.titleId}),e.jsx(WRe,{contentRef:c,descriptionId:l.descriptionId})]})]})}),ME="DialogTitle",cV=x.forwardRef((s,t)=>{const{__scopeDialog:r,...n}=s,a=$d(ME,r);return e.jsx(wh.h2,{id:a.titleId,...n,ref:t})});cV.displayName=ME;var dV="DialogDescription",uV=x.forwardRef((s,t)=>{const{__scopeDialog:r,...n}=s,a=$d(dV,r);return e.jsx(wh.p,{id:a.descriptionId,...n,ref:t})});uV.displayName=dV;var hV="DialogClose",mV=x.forwardRef((s,t)=>{const{__scopeDialog:r,...n}=s,a=$d(hV,r);return e.jsx(wh.button,{type:"button",...n,ref:t,onClick:ah(s.onClick,()=>a.onOpenChange(!1))})});mV.displayName=hV;function LE(s){return s?"open":"closed"}var fV="DialogTitleWarning",[zRe,xV]=iRe(fV,{contentName:ux,titleName:ME,docsSlug:"dialog"}),qRe=({titleId:s})=>{const t=xV(fV),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return x.useEffect(()=>{s&&(document.getElementById(s)||console.error(r))},[r,s]),null},VRe="DialogDescriptionWarning",WRe=({contentRef:s,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${xV(VRe).contentName}}.`;return x.useEffect(()=>{var i;const a=(i=s.current)==null?void 0:i.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(n))},[n,s,t]),null},HRe=tV,GRe=rV,KRe=aV,YRe=iV,JRe=oV,XRe=cV,QRe=uV,pV=mV,gV="AlertDialog",[ZRe]=Vq(gV,[eV]),Sh=eV(),vV=s=>{const{__scopeAlertDialog:t,...r}=s,n=Sh(t);return e.jsx(HRe,{...n,...r,modal:!0})};vV.displayName=gV;var eFe="AlertDialogTrigger",yV=x.forwardRef((s,t)=>{const{__scopeAlertDialog:r,...n}=s,a=Sh(r);return e.jsx(GRe,{...a,...n,ref:t})});yV.displayName=eFe;var tFe="AlertDialogPortal",jV=s=>{const{__scopeAlertDialog:t,...r}=s,n=Sh(t);return e.jsx(KRe,{...n,...r})};jV.displayName=tFe;var sFe="AlertDialogOverlay",bV=x.forwardRef((s,t)=>{const{__scopeAlertDialog:r,...n}=s,a=Sh(r);return e.jsx(YRe,{...a,...n,ref:t})});bV.displayName=sFe;var ip="AlertDialogContent",[rFe,nFe]=ZRe(ip),NV=x.forwardRef((s,t)=>{const{__scopeAlertDialog:r,children:n,...a}=s,i=Sh(r),o=x.useRef(null),l=Nh(t,o),c=x.useRef(null);return e.jsx(zRe,{contentName:ip,titleName:wV,docsSlug:"alert-dialog",children:e.jsx(rFe,{scope:r,cancelRef:c,children:e.jsxs(JRe,{role:"alertdialog",...i,...a,ref:l,onOpenAutoFocus:ah(a.onOpenAutoFocus,d=>{var u;d.preventDefault(),(u=c.current)==null||u.focus({preventScroll:!0})}),onPointerDownOutside:d=>d.preventDefault(),onInteractOutside:d=>d.preventDefault(),children:[e.jsx(Hq,{children:n}),e.jsx(iFe,{contentRef:o})]})})})});NV.displayName=ip;var wV="AlertDialogTitle",SV=x.forwardRef((s,t)=>{const{__scopeAlertDialog:r,...n}=s,a=Sh(r);return e.jsx(XRe,{...a,...n,ref:t})});SV.displayName=wV;var CV="AlertDialogDescription",AV=x.forwardRef((s,t)=>{const{__scopeAlertDialog:r,...n}=s,a=Sh(r);return e.jsx(QRe,{...a,...n,ref:t})});AV.displayName=CV;var aFe="AlertDialogAction",EV=x.forwardRef((s,t)=>{const{__scopeAlertDialog:r,...n}=s,a=Sh(r);return e.jsx(pV,{...a,...n,ref:t})});EV.displayName=aFe;var IV="AlertDialogCancel",PV=x.forwardRef((s,t)=>{const{__scopeAlertDialog:r,...n}=s,{cancelRef:a}=nFe(IV,r),i=Sh(r),o=Nh(t,a);return e.jsx(pV,{...i,...n,ref:o})});PV.displayName=IV;var iFe=({contentRef:s})=>{const t=`\`${ip}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${ip}\` by passing a \`${CV}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${ip}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return x.useEffect(()=>{var n;document.getElementById((n=s.current)==null?void 0:n.getAttribute("aria-describedby"))||console.warn(t)},[t,s]),null},oFe=vV,lFe=yV,cFe=jV,dFe=bV,uFe=NV,hFe=EV,mFe=PV,fFe=SV,xFe=AV;function $b({...s}){return e.jsx(oFe,{"data-slot":"alert-dialog",...s})}function hR({...s}){return e.jsx(lFe,{"data-slot":"alert-dialog-trigger",...s})}function pFe({...s}){return e.jsx(cFe,{"data-slot":"alert-dialog-portal",...s})}function gFe({className:s,...t}){return e.jsx(dFe,{"data-slot":"alert-dialog-overlay",className:ns("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...t})}function Bb({className:s,...t}){return e.jsxs(pFe,{children:[e.jsx(gFe,{}),e.jsx(uFe,{"data-slot":"alert-dialog-content",className:ns("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...t})]})}function Ub({className:s,...t}){return e.jsx("div",{"data-slot":"alert-dialog-header",className:ns("flex flex-col gap-2 text-center sm:text-left",s),...t})}function zb({className:s,...t}){return e.jsx("div",{"data-slot":"alert-dialog-footer",className:ns("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",s),...t})}function qb({className:s,...t}){return e.jsx(fFe,{"data-slot":"alert-dialog-title",className:ns("text-lg font-semibold",s),...t})}function Vb({className:s,...t}){return e.jsx(xFe,{"data-slot":"alert-dialog-description",className:ns("text-muted-foreground text-sm",s),...t})}function Wb({className:s,...t}){return e.jsx(hFe,{className:ns(rv(),s),...t})}function Hb({className:s,...t}){return e.jsx(mFe,{className:ns(rv({variant:"outline"}),s),...t})}class vFe{async getOverview(){return await de.get("/api/security/overview")}async getAccessControl(){return await de.get("/api/security/access-control")}async getAuditLogs(t=1,r=50){return await de.get(`/api/security/audit-logs?page=${t}&limit=${r}`)}async getCompliance(){return await de.get("/api/security/compliance")}async getEncryption(){return await de.get("/api/security/encryption")}async getMonitoring(){return await de.get("/api/security/monitoring")}async updateSettings(t,r){await de.post("/api/security/settings",{setting:t,value:r})}async triggerAudit(){return(await de.post("/api/security/audit")).data}async getMFAStatus(){return await de.get("/api/security/mfa/status")}async startMFASetup(){try{console.log("Calling MFA setup API...");const t=await de.post("/api/security/mfa/setup/start");return console.log("MFA setup API response:",t),t}catch(t){throw console.error("MFA setup API error:",t),t}}async verifyMFASetup(t){return await de.post("/api/security/mfa/setup/verify",{token:t})}async disableMFA(t){return await de.post("/api/security/mfa/disable",t)}async regenerateBackupCodes(){return await de.post("/api/security/mfa/backup/regenerate")}async getSessions(){return await de.get("/api/security/sessions")}async revokeSession(t){return await de.delete(`/api/security/sessions/${t}`)}async getIPWhitelist(){return await de.get("/api/security/ip-whitelist")}async addIPToWhitelist(t,r){return await de.post("/api/security/ip-whitelist",{ipAddress:t,description:r})}async removeIPFromWhitelist(t){return await de.delete(`/api/security/ip-whitelist/${t}`)}async getAPIKeys(){return await de.get("/api/security/api-keys")}async createAPIKey(t,r,n){return await de.post("/api/security/api-keys",{name:t,permissions:r,expiresAt:n})}async revokeAPIKey(t){return await de.delete(`/api/security/api-keys/${t}`)}}const Fa=new vFe;function yFe(){var le,Z,K,X,ce,Y,ue,ve,Le,Me,tt;const{user:s}=Ua(),t=hi(),[r,n]=xe.useState(!1),[a,i]=xe.useState(!1),[o,l]=xe.useState(!1),[c,d]=xe.useState(!1),[u,h]=xe.useState(!1),[f,m]=xe.useState(!1),[p,g]=xe.useState(!1),[v,y]=xe.useState(null),[j,b]=xe.useState(null),[w,N]=xe.useState({name:"",email:"",role:"employee",password:""}),[C,S]=xe.useState({name:"",industry:"",country:"",currency:"USD",taxId:"",fiscalYearStart:"01-01"}),{data:_,isLoading:k}=ys({queryKey:["users"],queryFn:()=>de.getUsers(),enabled:!!s}),{data:F,isLoading:A}=ys({queryKey:["companies"],queryFn:()=>de.getCompanies(),enabled:!!s}),{data:T,isLoading:V}=ys({queryKey:["audit-logs"],queryFn:()=>Fa.getAuditLogs(1,10),enabled:!!s}),M=Rs({mutationFn:async fe=>await de.createUser(fe),onSuccess:()=>{ze.success("User added successfully"),n(!1),N({name:"",email:"",role:"employee",password:""}),t.invalidateQueries({queryKey:["users"]})},onError:fe=>{const ct=(fe==null?void 0:fe.message)||"Failed to add user";ze.error(ct)}}),G=Rs({mutationFn:async({userId:fe,userData:ct})=>await de.updateUser(fe,ct),onSuccess:()=>{ze.success("User updated successfully"),i(!1),y(null),t.invalidateQueries({queryKey:["users"]})},onError:fe=>{const ct=(fe==null?void 0:fe.message)||"Failed to update user";ze.error(ct)}}),L=Rs({mutationFn:async fe=>await de.deleteUser(fe),onSuccess:()=>{ze.success("User deleted successfully"),l(!1),y(null),t.invalidateQueries({queryKey:["users"]})},onError:fe=>{const ct=(fe==null?void 0:fe.message)||"Failed to delete user";ze.error(ct)}}),J=Rs({mutationFn:async fe=>await de.createCompany(fe),onSuccess:()=>{ze.success("Organization added successfully"),d(!1),S({name:"",industry:"",country:"",currency:"USD",taxId:"",fiscalYearStart:"01-01"}),t.invalidateQueries({queryKey:["companies"]})},onError:fe=>{const ct=(fe==null?void 0:fe.message)||"Failed to add organization";ze.error(ct)}}),z=Rs({mutationFn:async({orgId:fe,orgData:ct})=>await de.updateCompany(fe,ct),onSuccess:()=>{ze.success("Organization updated successfully"),h(!1),b(null),t.invalidateQueries({queryKey:["companies"]})},onError:fe=>{const ct=(fe==null?void 0:fe.message)||"Failed to update organization";ze.error(ct)}}),U=Rs({mutationFn:async fe=>await de.deleteCompany(fe),onSuccess:()=>{ze.success("Organization deleted successfully"),t.invalidateQueries({queryKey:["companies"]})},onError:fe=>{const ct=(fe==null?void 0:fe.message)||"Failed to delete organization";ze.error(ct)}}),oe=(_==null?void 0:_.totalCount)||0,Q=((le=_==null?void 0:_.users)==null?void 0:le.filter(fe=>fe.lastActiveAt&&new Date(fe.lastActiveAt)>new Date(Date.now()-7*24*60*60*1e3)).length)||0,P=((Z=F==null?void 0:F.data)==null?void 0:Z.length)||0,q=((K=_==null?void 0:_.users)==null?void 0:K.filter(fe=>fe.role==="admin"||fe.role==="owner").length)||0,D=()=>{N({name:"",email:"",role:"employee",password:""}),n(!0)},se=fe=>{y(fe),N({name:fe.name||"",email:fe.email||"",role:fe.role||"employee",password:""}),i(!0)},he=fe=>{y(fe),l(!0)},be=()=>{S({name:"",industry:"",country:"",currency:"USD",taxId:"",fiscalYearStart:"01-01"}),d(!0)},pe=fe=>{b(fe),S({name:fe.name||"",industry:fe.industry||"",country:fe.country||"",currency:fe.currency||"USD",taxId:fe.taxId||"",fiscalYearStart:fe.fiscalYearStart||"01-01"}),h(!0)},Ae=()=>{g(!0)},Ee=()=>{r?M.mutate(w):a&&v&&G.mutate({userId:v.id,userData:w})},$e=()=>{c?J.mutate(C):u&&j&&z.mutate({orgId:j.id,orgData:C})},O=()=>{v&&L.mutate(v.id)},te=fe=>{b(fe),m(!0)},re=()=>{j&&(U.mutate(j.id),m(!1),b(null))};return e.jsxs(Kr,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-balance",children:"User & Organization Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage users, roles, and organization settings"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{variant:"outline",children:[e.jsx(en,{className:"w-4 h-4 mr-2"}),"System Settings"]}),e.jsxs(I,{onClick:D,children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Invite User"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Sa,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Users"}),e.jsx("p",{className:"text-xl font-bold",children:k?"...":oe})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(D5,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Users"}),e.jsx("p",{className:"text-xl font-bold",children:k?"...":Q}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Last 7 days"})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(vn,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Organizations"}),e.jsx("p",{className:"text-xl font-bold",children:A?"...":P})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-lg flex items-center justify-center",children:e.jsx(kn,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Admin Users"}),e.jsx("p",{className:"text-xl font-bold",children:k?"...":q})]})]})})})]}),e.jsxs(an,{defaultValue:"users",className:"space-y-4",children:[e.jsxs(on,{children:[e.jsx(vt,{value:"users",children:"Users"}),e.jsx(vt,{value:"organizations",children:"Organizations"}),e.jsx(vt,{value:"roles",children:"Roles & Permissions"}),e.jsx(vt,{value:"security",children:"Security"}),e.jsx(vt,{value:"company",children:"Company Settings"})]}),e.jsx(yt,{value:"users",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{children:"Team Members"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(rt,{defaultValue:"all",children:[e.jsx(nt,{className:"w-32",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Users"}),e.jsx(W,{value:"active",children:"Active"}),e.jsx(W,{value:"inactive",children:"Inactive"})]})]}),e.jsxs(I,{onClick:D,children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Add User"]})]})]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:k?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(or,{className:"w-8 h-8 animate-spin mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading users..."})]})}):((X=_==null?void 0:_.users)==null?void 0:X.length)===0?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Sa,{className:"w-8 h-8 mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"No users found"})]})}):(ce=_==null?void 0:_.users)==null?void 0:ce.map((fe,ct)=>{var qe,mt;const dt=fe.lastActiveAt&&new Date(fe.lastActiveAt)>new Date(Date.now()-6048e5),pt=fe.lastActiveAt?new Date(fe.lastActiveAt).toLocaleDateString()===new Date().toLocaleDateString()?"Today":new Date(fe.lastActiveAt).toLocaleDateString()===new Date(Date.now()-24*60*60*1e3).toLocaleDateString()?"Yesterday":`${Math.floor((Date.now()-new Date(fe.lastActiveAt).getTime())/(24*60*60*1e3))} days ago`:"Never";return e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(Kc,{className:"w-10 h-10",children:[e.jsx(P0,{src:fe.avatar||"/placeholder.svg",alt:fe.name||fe.email}),e.jsx(Yc,{children:(fe.name||fe.email).split(" ").map(Rt=>Rt[0]).join("").toUpperCase()})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-medium",children:fe.name||fe.email}),(fe.role==="owner"||fe.role==="Owner")&&e.jsx(f6,{className:"w-4 h-4 text-amber-500"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:fe.email}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[fe.mfaEnabled?" MFA Enabled":" MFA Disabled","  Created ",new Date(fe.createdAt).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx(Oe,{variant:fe.role==="owner"||fe.role==="Owner"?"default":fe.role==="admin"||fe.role==="Admin"?"secondary":"outline",children:((qe=fe.role)==null?void 0:qe.charAt(0).toUpperCase())+((mt=fe.role)==null?void 0:mt.slice(1))||"User"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Last active: ",pt]})]}),e.jsx(Oe,{variant:dt?"default":"secondary",children:dt?"Active":"Inactive"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>se(fe),children:e.jsx(ln,{className:"w-4 h-4"})}),fe.role!=="owner"&&fe.role!=="Owner"&&e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>he(fe),children:e.jsx(hn,{className:"w-4 h-4"})})]})]})]},fe.id||ct)})})})]})}),e.jsx(yt,{value:"company",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx(Se,{children:"Company Settings"})})}),e.jsx(ie,{children:e.jsx(jFe,{})})]})}),e.jsx(yt,{value:"organizations",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{children:"Organizations"}),e.jsxs(I,{onClick:be,children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Add Organization"]})]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:A?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(or,{className:"w-8 h-8 animate-spin mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading organizations..."})]})}):((Y=F==null?void 0:F.data)==null?void 0:Y.length)===0?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(vn,{className:"w-8 h-8 mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"No organizations found"})]})}):(ue=F==null?void 0:F.data)==null?void 0:ue.map((fe,ct)=>{var dt,pt,qe;return e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-cyan-100 rounded-lg flex items-center justify-center",children:e.jsx(vn,{className:"w-6 h-6 text-cyan-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:fe.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[fe.industry||"Business"," ",fe.country||"Unknown Country","  Created ",new Date(fe.createdAt).toLocaleDateString()]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[((dt=fe._count)==null?void 0:dt.transactions)||0," transactions ",((pt=fe._count)==null?void 0:pt.customers)||0," customers ",((qe=fe._count)==null?void 0:qe.vendors)||0," vendors"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Oe,{variant:"default",children:fe.currency||"USD"}),e.jsx(Oe,{variant:"secondary",children:fe.taxId?"Tax Registered":"No Tax ID"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>pe(fe),children:e.jsx(ln,{className:"w-4 h-4"})}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>te(fe),children:e.jsx(hn,{className:"w-4 h-4"})}),e.jsx(I,{variant:"ghost",size:"sm",children:e.jsx(en,{className:"w-4 h-4"})})]})]})]},fe.id||ct)})})})]})}),e.jsx(yt,{value:"roles",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{children:"User Roles"}),e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Custom Role"]})]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:k?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(or,{className:"w-8 h-8 animate-spin mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading roles..."})]})}):(()=>{var dt;const fe=((dt=_==null?void 0:_.users)==null?void 0:dt.reduce((pt,qe)=>{const mt=qe.role||"employee";return pt[mt]||(pt[mt]={count:0,users:[]}),pt[mt].count++,pt[mt].users.push(qe),pt},{}))||{},ct={owner:{name:"Owner",description:"Full system access and control",permissions:["All Permissions","System Administration","User Management"]},admin:{name:"Admin",description:"Administrative access to most features",permissions:["User Management","Financial Data","Reports","Settings"]},employee:{name:"Employee",description:"Standard user access",permissions:["View Data","Basic Reports","Profile Management"]}};return Object.entries(fe).map(([pt,qe])=>{const mt=ct[pt]||{name:pt.charAt(0).toUpperCase()+pt.slice(1),description:"Custom role with specific permissions",permissions:["Custom Permissions"]};return e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium",children:mt.name}),pt==="owner"&&e.jsx(f6,{className:"w-4 h-4 text-amber-500"})]}),e.jsxs(Oe,{variant:"outline",children:[qe.count," users"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:mt.description}),e.jsx("div",{className:"flex flex-wrap gap-1",children:mt.permissions.map((Rt,_e)=>e.jsx(Oe,{variant:"secondary",className:"text-xs",children:Rt},_e))})]},pt)})})()})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Permission Settings"})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium",children:"Financial Data Access"}),[{name:"View Financial Reports",enabled:!0},{name:"Edit Transactions",enabled:!0},{name:"Delete Transactions",enabled:!1},{name:"Export Data",enabled:!0}].map((fe,ct)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:fe.name}),e.jsx(ro,{checked:fe.enabled})]},ct))]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium",children:"User Management"}),[{name:"Invite Users",enabled:!0},{name:"Edit User Roles",enabled:!1},{name:"Delete Users",enabled:!1}].map((fe,ct)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:fe.name}),e.jsx(ro,{checked:fe.enabled})]},ct))]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium",children:"System Settings"}),[{name:"Modify Organization Settings",enabled:!1},{name:"Manage Integrations",enabled:!0},{name:"Access AI Settings",enabled:!0}].map((fe,ct)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:fe.name}),e.jsx(ro,{checked:fe.enabled})]},ct))]})]})})]})]})}),e.jsx(yt,{value:"security",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Security Settings"})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium",children:"Authentication"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Two-Factor Authentication"}),e.jsx(ro,{checked:!0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Single Sign-On (SSO)"}),e.jsx(ro,{checked:!1})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Password Requirements"}),e.jsx(ro,{checked:!0})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-medium",children:"Session Management"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Auto-logout after inactivity"}),e.jsxs(rt,{defaultValue:"30",children:[e.jsx(nt,{className:"w-24",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"15",children:"15 min"}),e.jsx(W,{value:"30",children:"30 min"}),e.jsx(W,{value:"60",children:"1 hour"}),e.jsx(W,{value:"120",children:"2 hours"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Concurrent Sessions"}),e.jsxs(rt,{defaultValue:"3",children:[e.jsx(nt,{className:"w-16",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"1",children:"1"}),e.jsx(W,{value:"3",children:"3"}),e.jsx(W,{value:"5",children:"5"}),e.jsx(W,{value:"unlimited",children:""})]})]})]})]})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Recent Security Events"})}),e.jsxs(ie,{children:[e.jsx("div",{className:"space-y-3",children:V?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(or,{className:"w-6 h-6 animate-spin mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading security events..."})]})}):((ve=T==null?void 0:T.data)==null?void 0:ve.length)===0?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx(kn,{className:"w-6 h-6 mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"No security events found"})]})}):(Le=T==null?void 0:T.data)==null?void 0:Le.map((fe,ct)=>{var Xe,At;const dt=st=>{switch(st){case"LOGIN_SUCCESS":return"User login";case"LOGIN_FAILED":return"Failed login attempt";case"PASSWORD_CHANGED":return"Password changed";case"MFA_ENABLED":return"2FA enabled";case"MFA_DISABLED":return"2FA disabled";case"TOKEN_REFRESH":return"Session refreshed";case"USER_CREATED":return"User created";case"USER_UPDATED":return"User updated";case"SECURITY_ALERT":return"Security alert";default:return st.replace(/_/g," ").toLowerCase().replace(/\b\w/g,$t=>$t.toUpperCase())}},pt=st=>{switch(st){case"LOGIN_SUCCESS":case"PASSWORD_CHANGED":case"MFA_ENABLED":case"TOKEN_REFRESH":case"USER_CREATED":case"USER_UPDATED":return"success";case"LOGIN_FAILED":case"SECURITY_ALERT":return"failed";default:return"info"}},qe=st=>{const $t=new Date,fs=new Date(st),zt=$t.getTime()-fs.getTime(),St=Math.floor(zt/(1e3*60*60)),js=Math.floor(St/24);return St<1?"Just now":St<24?`${St} hours ago`:js<7?`${js} days ago`:fs.toLocaleDateString()},mt=pt(fe.action),Rt=dt(fe.action),_e=qe(fe.timestamp);return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:Rt}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[((Xe=fe.user)==null?void 0:Xe.name)||((At=fe.user)==null?void 0:At.email)||"System",fe.ipAddress&&`  ${fe.ipAddress}`]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(Oe,{variant:mt==="success"?"default":mt==="failed"?"destructive":"secondary",children:mt}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:_e})]})]},fe.id||ct)})}),e.jsx(I,{variant:"outline",className:"w-full mt-4 bg-transparent",onClick:Ae,children:"View Full Audit Log"})]})]})]})})]})]}),e.jsx(ts,{open:r,onOpenChange:n,children:e.jsxs(ss,{children:[e.jsxs(as,{children:[e.jsx(is,{children:"Add New User"}),e.jsx(Ks,{children:"Create a new user account for your organization."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"name",children:"Full Name"}),e.jsx(ge,{id:"name",value:w.name,onChange:fe=>N({...w,name:fe.target.value}),placeholder:"Enter full name"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"email",children:"Email"}),e.jsx(ge,{id:"email",type:"email",value:w.email,onChange:fe=>N({...w,email:fe.target.value}),placeholder:"Enter email address"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"role",children:"Role"}),e.jsxs(rt,{value:w.role,onValueChange:fe=>N({...w,role:fe}),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"employee",children:"Employee"}),e.jsx(W,{value:"admin",children:"Admin"}),e.jsx(W,{value:"owner",children:"Owner"})]})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"password",children:"Password"}),e.jsx(ge,{id:"password",type:"password",value:w.password,onChange:fe=>N({...w,password:fe.target.value}),placeholder:"Enter password"})]})]}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsx(I,{onClick:Ee,disabled:M.isPending,children:M.isPending?"Adding...":"Add User"})]})]})}),e.jsx(ts,{open:a,onOpenChange:i,children:e.jsxs(ss,{children:[e.jsxs(as,{children:[e.jsx(is,{children:"Edit User"}),e.jsx(Ks,{children:"Update user information and permissions."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-name",children:"Full Name"}),e.jsx(ge,{id:"edit-name",value:w.name,onChange:fe=>N({...w,name:fe.target.value}),placeholder:"Enter full name"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-email",children:"Email"}),e.jsx(ge,{id:"edit-email",type:"email",value:w.email,onChange:fe=>N({...w,email:fe.target.value}),placeholder:"Enter email address"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-role",children:"Role"}),e.jsxs(rt,{value:w.role,onValueChange:fe=>N({...w,role:fe}),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"employee",children:"Employee"}),e.jsx(W,{value:"admin",children:"Admin"}),e.jsx(W,{value:"owner",children:"Owner"})]})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-password",children:"New Password (optional)"}),e.jsx(ge,{id:"edit-password",type:"password",value:w.password,onChange:fe=>N({...w,password:fe.target.value}),placeholder:"Enter new password"})]})]}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:()=>i(!1),children:"Cancel"}),e.jsx(I,{onClick:Ee,disabled:G.isPending,children:G.isPending?"Updating...":"Update User"})]})]})}),e.jsx($b,{open:o,onOpenChange:l,children:e.jsxs(Bb,{children:[e.jsxs(Ub,{children:[e.jsx(qb,{children:"Delete User"}),e.jsxs(Vb,{children:["Are you sure you want to delete ",e.jsx("strong",{children:(v==null?void 0:v.name)||(v==null?void 0:v.email)}),"? This action cannot be undone and will remove all access to the system."]})]}),e.jsxs(zb,{children:[e.jsx(Hb,{children:"Cancel"}),e.jsx(Wb,{onClick:O,disabled:L.isPending,children:L.isPending?"Deleting...":"Delete User"})]})]})}),e.jsx($b,{open:f,onOpenChange:m,children:e.jsxs(Bb,{children:[e.jsxs(Ub,{children:[e.jsx(qb,{children:"Delete Organization"}),e.jsxs(Vb,{children:["Are you sure you want to delete ",e.jsx("strong",{children:j==null?void 0:j.name}),"? This action cannot be undone and will remove all organization data."]})]}),e.jsxs(zb,{children:[e.jsx(Hb,{children:"Cancel"}),e.jsx(Wb,{onClick:re,disabled:U.isPending,children:U.isPending?"Deleting...":"Delete Organization"})]})]})}),e.jsx(ts,{open:c,onOpenChange:d,children:e.jsxs(ss,{children:[e.jsxs(as,{children:[e.jsx(is,{children:"Add New Organization"}),e.jsx(Ks,{children:"Create a new organization for your business."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"org-name",children:"Organization Name"}),e.jsx(ge,{id:"org-name",value:C.name,onChange:fe=>S({...C,name:fe.target.value}),placeholder:"Enter organization name"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"org-industry",children:"Industry"}),e.jsx(ge,{id:"org-industry",value:C.industry,onChange:fe=>S({...C,industry:fe.target.value}),placeholder:"Enter industry"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"org-country",children:"Country"}),e.jsx(ge,{id:"org-country",value:C.country,onChange:fe=>S({...C,country:fe.target.value}),placeholder:"Enter country"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"org-currency",children:"Currency"}),e.jsxs(rt,{value:C.currency,onValueChange:fe=>S({...C,currency:fe}),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"USD",children:"USD"}),e.jsx(W,{value:"EUR",children:"EUR"}),e.jsx(W,{value:"GBP",children:"GBP"}),e.jsx(W,{value:"CAD",children:"CAD"})]})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"org-taxid",children:"Tax ID"}),e.jsx(ge,{id:"org-taxid",value:C.taxId,onChange:fe=>S({...C,taxId:fe.target.value}),placeholder:"Enter tax ID"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"org-fiscal-year",children:"Fiscal Year Start"}),e.jsx(ge,{id:"org-fiscal-year",value:C.fiscalYearStart,onChange:fe=>S({...C,fiscalYearStart:fe.target.value}),placeholder:"MM-DD (e.g., 01-01)"})]})]}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),e.jsx(I,{onClick:$e,disabled:J.isPending,children:J.isPending?"Adding...":"Add Organization"})]})]})}),e.jsx(ts,{open:u,onOpenChange:h,children:e.jsxs(ss,{children:[e.jsxs(as,{children:[e.jsx(is,{children:"Edit Organization"}),e.jsx(Ks,{children:"Update organization information and settings."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-org-name",children:"Organization Name"}),e.jsx(ge,{id:"edit-org-name",value:C.name,onChange:fe=>S({...C,name:fe.target.value}),placeholder:"Enter organization name"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-org-industry",children:"Industry"}),e.jsx(ge,{id:"edit-org-industry",value:C.industry,onChange:fe=>S({...C,industry:fe.target.value}),placeholder:"Enter industry"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-org-country",children:"Country"}),e.jsx(ge,{id:"edit-org-country",value:C.country,onChange:fe=>S({...C,country:fe.target.value}),placeholder:"Enter country"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-org-currency",children:"Currency"}),e.jsxs(rt,{value:C.currency,onValueChange:fe=>S({...C,currency:fe}),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"USD",children:"USD"}),e.jsx(W,{value:"EUR",children:"EUR"}),e.jsx(W,{value:"GBP",children:"GBP"}),e.jsx(W,{value:"CAD",children:"CAD"})]})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-org-taxid",children:"Tax ID"}),e.jsx(ge,{id:"edit-org-taxid",value:C.taxId,onChange:fe=>S({...C,taxId:fe.target.value}),placeholder:"Enter tax ID"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"edit-org-fiscal-year",children:"Fiscal Year Start"}),e.jsx(ge,{id:"edit-org-fiscal-year",value:C.fiscalYearStart,onChange:fe=>S({...C,fiscalYearStart:fe.target.value}),placeholder:"MM-DD (e.g., 01-01)"})]})]}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:()=>h(!1),children:"Cancel"}),e.jsx(I,{onClick:$e,disabled:z.isPending,children:z.isPending?"Updating...":"Update Organization"})]})]})}),e.jsx(ts,{open:p,onOpenChange:g,children:e.jsxs(ss,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Full Audit Log"}),e.jsx(Ks,{children:"Complete security event history for your organization."})]}),e.jsx("div",{className:"space-y-3",children:V?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(or,{className:"w-8 h-8 animate-spin mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading audit logs..."})]})}):((Me=T==null?void 0:T.data)==null?void 0:Me.length)===0?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(kn,{className:"w-8 h-8 mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"No audit logs found"})]})}):(tt=T==null?void 0:T.data)==null?void 0:tt.map((fe,ct)=>{var Rt,_e;const dt=Xe=>{switch(Xe){case"LOGIN_SUCCESS":return"User login";case"LOGIN_FAILED":return"Failed login attempt";case"PASSWORD_CHANGED":return"Password changed";case"MFA_ENABLED":return"2FA enabled";case"MFA_DISABLED":return"2FA disabled";case"TOKEN_REFRESH":return"Session refreshed";case"USER_CREATED":return"User created";case"USER_UPDATED":return"User updated";case"SECURITY_ALERT":return"Security alert";default:return Xe.replace(/_/g," ").toLowerCase().replace(/\b\w/g,At=>At.toUpperCase())}},qe=(Xe=>{switch(Xe){case"LOGIN_SUCCESS":case"PASSWORD_CHANGED":case"MFA_ENABLED":case"TOKEN_REFRESH":case"USER_CREATED":case"USER_UPDATED":return"success";case"LOGIN_FAILED":case"SECURITY_ALERT":return"failed";default:return"info"}})(fe.action),mt=dt(fe.action);return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:mt}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[((Rt=fe.user)==null?void 0:Rt.name)||((_e=fe.user)==null?void 0:_e.email)||"System",fe.ipAddress&&`  ${fe.ipAddress}`]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(fe.timestamp).toLocaleString()})]}),e.jsx("div",{className:"text-right",children:e.jsx(Oe,{variant:qe==="success"?"default":qe==="failed"?"destructive":"secondary",children:qe})})]},fe.id||ct)})}),e.jsx(Xr,{children:e.jsx(I,{variant:"outline",onClick:()=>g(!1),children:"Close"})})]})})]})}function jFe(){const{ready:s}=gu("settings-page"),{data:t}=ys({queryKey:["companies"],queryFn:async()=>(await de.getCompanies()).data,enabled:s}),[r,n]=xe.useState(""),[a,i]=xe.useState("2"),[o,l]=xe.useState("5"),[c,d]=xe.useState("2"),[u,h]=xe.useState("5"),{data:f}=ys({queryKey:["company-settings",r],queryFn:async()=>{if(!r)return null;const p=await fetch(`/api/internal/company-settings?companyId=${r}`);if(!p.ok)throw new Error("Failed to load settings");return p.json()},enabled:!!r});xe.useEffect(()=>{var p,g,v,y;if(f!=null&&f.items){const j=(p=f.items.find(C=>C.key==="three_way_tolerance_pct_local"))==null?void 0:p.value,b=(g=f.items.find(C=>C.key==="three_way_tolerance_abs_local"))==null?void 0:g.value,w=(v=f.items.find(C=>C.key==="three_way_tolerance_pct_import"))==null?void 0:v.value,N=(y=f.items.find(C=>C.key==="three_way_tolerance_abs_import"))==null?void 0:y.value;j!==void 0&&i(String(j)),b!==void 0&&l(String(b)),w!==void 0&&d(String(w)),N!==void 0&&h(String(N))}},[f]);const m=Rs({mutationFn:async()=>{if(!r)return;const p={"Content-Type":"application/json"};await fetch("/api/internal/company-settings",{method:"POST",headers:p,body:JSON.stringify({companyId:r,key:"three_way_tolerance_pct_local",value:a})}),await fetch("/api/internal/company-settings",{method:"POST",headers:p,body:JSON.stringify({companyId:r,key:"three_way_tolerance_abs_local",value:o})}),await fetch("/api/internal/company-settings",{method:"POST",headers:p,body:JSON.stringify({companyId:r,key:"three_way_tolerance_pct_import",value:c})}),await fetch("/api/internal/company-settings",{method:"POST",headers:p,body:JSON.stringify({companyId:r,key:"three_way_tolerance_abs_import",value:u})})},onSuccess:()=>{ze.success("Company settings saved successfully")},onError:p=>{ze.error("Failed to save company settings"),console.error("Save error:",p)}});return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"col-span-1",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Company"}),e.jsxs(rt,{value:r,onValueChange:n,children:[e.jsx(nt,{className:"w-full",children:e.jsx(it,{placeholder:"Select company"})}),e.jsx(at,{children:(Array.isArray(t)?t:(t==null?void 0:t.data)||[]).map(p=>e.jsx(W,{value:p.id,children:p.name},p.id))})]})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Local % tolerance"}),e.jsx(ge,{type:"number",step:"0.1",value:a,onChange:p=>i(p.target.value)})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Local $ tolerance"}),e.jsx(ge,{type:"number",step:"0.01",value:o,onChange:p=>l(p.target.value)})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Import % tolerance"}),e.jsx(ge,{type:"number",step:"0.1",value:c,onChange:p=>d(p.target.value)})]}),e.jsxs("div",{className:"col-span-1 col-start-2",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Import $ tolerance"}),e.jsx(ge,{type:"number",step:"0.01",value:u,onChange:p=>h(p.target.value)})]})]}),e.jsx("div",{className:"flex justify-end gap-2",children:e.jsx(I,{variant:"outline",disabled:!r||m.isPending,onClick:()=>m.mutate(),children:m.isPending?"Saving...":"Save"})}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Tax Settings"})}),e.jsx(ie,{className:"space-y-4",children:e.jsx(bFe,{companyId:r})})]})]})}function bFe({companyId:s}){const[t,r]=xe.useState(!1),[n,a]=xe.useState("round"),[i,o]=xe.useState(""),[l,c]=xe.useState([]),d=ys({queryKey:["tax-jurisdictions",s],queryFn:async()=>{if(!s)return[];const p=await fetch("/api/tax/jurisdictions");if(!p.ok)throw new Error("Failed to load jurisdictions");return p.json()},enabled:!!s}),u=ys({queryKey:["tax-config",s],queryFn:async()=>{if(!s)return null;const p=await fetch(`/api/tax/config?companyId=${s}`);if(!p.ok)throw new Error("Failed to load tax config");return p.json()},enabled:!!s}),h=ys({queryKey:["tax-nexus",s],queryFn:async()=>{if(!s)return[];const p=await fetch(`/api/tax/nexus?companyId=${s}`);if(!p.ok)throw new Error("Failed to load tax nexus");return p.json()},enabled:!!s});xe.useEffect(()=>{const p=u.data;p&&(typeof p.taxInclusive=="boolean"&&r(p.taxInclusive),p.roundingMethod&&a(p.roundingMethod),p.defaultJurisdictionId&&o(p.defaultJurisdictionId))},[u.data]),xe.useEffect(()=>{const p=h.data;Array.isArray(p)&&c(p.map(g=>g.jurisdictionId||g))},[h.data]);const f=Rs({mutationFn:async()=>{if(!s)return;const p={"Content-Type":"application/json"};await fetch(`/api/tax/config?companyId=${s}`,{method:"POST",headers:p,body:JSON.stringify({taxInclusive:t,roundingMethod:n,defaultJurisdictionId:i})}),await fetch(`/api/tax/nexus?companyId=${s}`,{method:"POST",headers:p,body:JSON.stringify({jurisdictions:l})})},onSuccess:()=>{ze.success("Tax settings saved successfully")},onError:p=>{ze.error("Failed to save tax settings"),console.error("Tax save error:",p)}}),m=d.data||[];return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"col-span-1 flex items-center justify-between border rounded-lg p-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium",children:"Prices include tax"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Inclusive vs exclusive taxation"})]}),e.jsx(ro,{checked:t,onCheckedChange:r,disabled:!s})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Rounding Method"}),e.jsxs(rt,{value:n,onValueChange:p=>a(p),disabled:!s,children:[e.jsx(nt,{className:"w-full",children:e.jsx(it,{placeholder:"Select method"})}),e.jsxs(at,{children:[e.jsx(W,{value:"round",children:"Round (nearest)"}),e.jsx(W,{value:"floor",children:"Floor"}),e.jsx(W,{value:"ceil",children:"Ceil"})]})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("div",{className:"text-sm font-medium mb-1",children:"Default Jurisdiction"}),e.jsxs(rt,{value:i,onValueChange:o,disabled:!s||d.isLoading,children:[e.jsx(nt,{className:"w-full",children:e.jsx(it,{placeholder:d.isLoading?"Loading...":"Select jurisdiction"})}),e.jsx(at,{children:m.map(p=>e.jsxs(W,{value:p.id,children:[p.name," (",p.code,")"]},p.id))})]})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"Nexus Jurisdictions"}),d.isLoading?e.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading jurisdictions..."}):d.isError?e.jsx("div",{className:"text-sm text-red-500",children:"Failed to load jurisdictions"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 max-h-48 overflow-auto p-2 border rounded-lg",children:m.map(p=>{const g=l.includes(p.id);return e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4",checked:g,disabled:!s,onChange:v=>{const y=v.target.checked;c(j=>y?Array.from(new Set([...j,p.id])):j.filter(b=>b!==p.id))}}),e.jsxs("span",{children:[p.name," (",p.code,")"]})]},p.id)})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(I,{variant:"outline",disabled:!s||f.isPending,onClick:()=>f.mutate(),children:f.isPending?"Saving...":"Save Tax Settings"})})]})}function NFe(){const[s,t]=x.useState(null),[r,n]=x.useState(!0),[a,i]=x.useState(null),o=async()=>{const c=zs();if(!c){i("Company ID is required"),n(!1);return}try{n(!0),i(null);const d=localStorage.getItem("auth_token")||localStorage.getItem("token");if(!d)throw new Error("No authentication token found");const u=await fetch(un(`api/ai-insights/dashboard?companyId=${c}`),{headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json","x-tenant-id":Ii(),"x-company-id":c}});if(!u.ok){const f=await u.json();throw new Error(f.message||`HTTP error! status: ${u.status}`)}const h=await u.json();t(h)}catch(d){i(d instanceof Error?d.message:"Failed to fetch AI insights data")}finally{n(!1)}},l=async c=>{const d=zs();if(!d)throw new Error("Company ID is required");const u=localStorage.getItem("auth_token")||localStorage.getItem("token");if(!u)throw new Error("No authentication token found");const h=await fetch(un("api/ai/insights/generate"),{method:"POST",headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json","x-tenant-id":Ii(),"x-company-id":d},body:JSON.stringify({companyId:d,insightType:c})});if(!h.ok){const f=await h.json();throw new Error(f.message||`HTTP error! status: ${h.status}`)}return await h.json()};return x.useEffect(()=>{o()},[]),{data:s,loading:r,error:a,refetch:o,generateInsights:l}}function wFe(){var g,v,y,j,b,w,N,C,S,_;const{data:s,loading:t,error:r,refetch:n,generateInsights:a}=NFe(),{insights:i,loading:o,error:l,refetch:c}=RL(),[d,u]=x.useState(!1),h=zs(),f=ys({queryKey:["alerts",h],queryFn:async()=>await Ra.getAlerts({companyId:h}),enabled:!!h}),m=f.data||[],p=async()=>{try{u(!0),await a("financial_anomaly"),await n()}catch(k){console.error("Error generating insights:",k)}finally{u(!1)}};return t?e.jsx(sh,{children:e.jsx(Kr,{children:e.jsx("div",{className:"flex-1 space-y-6 p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ts,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{children:"Loading AI Insights..."})]})})})})}):r?e.jsx(sh,{children:e.jsx(Kr,{children:e.jsx("div",{className:"flex-1 space-y-6 p-6",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Is,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Error Loading AI Insights"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:(r==null?void 0:r.message)||(r==null?void 0:r.toString())||"Unknown error"}),e.jsxs(I,{onClick:n,children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Try Again"]})]})})})})}):e.jsx(sh,{children:e.jsx(Kr,{children:e.jsxs("div",{className:"flex-1 space-y-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-balance",children:"AI Insights & Predictions"}),e.jsx("p",{className:"text-muted-foreground",children:"Leverage AI to optimize your financial performance and predict trends"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{variant:"outline",children:[e.jsx(en,{className:"w-4 h-4 mr-2"}),"AI Settings"]}),e.jsxs(I,{onClick:p,disabled:d,children:[d?e.jsx(Ts,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(sa,{className:"w-4 h-4 mr-2"}),d?"Generating...":"Generate Insights"]})]})]}),e.jsx(ne,{className:"bg-gradient-to-r from-cyan-50 to-blue-50 border-cyan-200",children:e.jsxs(ie,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-cyan-100 rounded-full flex items-center justify-center",children:e.jsx(sa,{className:"w-8 h-8 text-cyan-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Financial Health Score"}),e.jsx("p",{className:"text-muted-foreground",children:"AI-powered assessment of your business performance"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-4xl font-bold text-cyan-600",children:((g=s==null?void 0:s.healthScore)==null?void 0:g.score)||0}),e.jsx("div",{className:"text-sm text-muted-foreground",children:(((v=s==null?void 0:s.healthScore)==null?void 0:v.score)||0)>=80?"Excellent":(((y=s==null?void 0:s.healthScore)==null?void 0:y.score)||0)>=60?"Good":(((j=s==null?void 0:s.healthScore)==null?void 0:j.score)||0)>=40?"Fair":"Needs Improvement"}),e.jsxs(Oe,{variant:"default",className:"mt-1",children:[(((b=s==null?void 0:s.healthScore)==null?void 0:b.revenueGrowth)||0)>0?"+":"",(((w=s==null?void 0:s.healthScore)==null?void 0:w.revenueGrowth)||0).toFixed(1),"% growth"]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(No,{value:(s==null?void 0:s.healthScore.score)||0,className:"h-3"})}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Payment Rate:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[((N=s==null?void 0:s.healthScore)==null?void 0:N.paymentRate)||0,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Profit Margin:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[((C=s==null?void 0:s.healthScore)==null?void 0:C.profitMargin)||0,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Revenue Growth:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[((S=s==null?void 0:s.healthScore)==null?void 0:S.revenueGrowth)||0,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Overdue:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[((_=s==null?void 0:s.healthScore)==null?void 0:_.overduePercentage)||0,"%"]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx($s,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Prediction Accuracy"}),e.jsxs("p",{className:"text-xl font-bold",children:[s==null?void 0:s.aiMetrics.predictionAccuracy,"%"]})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-100 rounded-lg flex items-center justify-center",children:e.jsx(Is,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Anomalies Detected"}),e.jsx("p",{className:"text-xl font-bold",children:s==null?void 0:s.aiMetrics.anomaliesDetected})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(ic,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Recommendations"}),e.jsx("p",{className:"text-xl font-bold",children:s==null?void 0:s.aiMetrics.activeRecommendations})]})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx(wa,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Goals on Track"}),e.jsx("p",{className:"text-xl font-bold",children:s==null?void 0:s.aiMetrics.goalsOnTrack})]})]})})})]}),e.jsxs(an,{defaultValue:"predictions",className:"space-y-4",children:[e.jsxs(on,{children:[e.jsx(vt,{value:"predictions",children:"Predictions"}),e.jsx(vt,{value:"anomalies",children:"Anomaly Detection"}),e.jsx(vt,{value:"recommendations",children:"Recommendations"}),e.jsx(vt,{value:"tax-optimization",children:"Tax Optimization"}),e.jsx(vt,{value:"insights",children:"Smart Insights"})]}),e.jsxs(yt,{value:"predictions",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx($s,{className:"w-5 h-5 text-green-600"}),"Revenue Forecast"]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:t?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(Ts,{className:"h-4 w-4 animate-spin mr-2"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Loading predictions..."})]}):r?e.jsxs("div",{className:"flex items-center justify-center py-8 text-red-600",children:[e.jsx(Is,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"text-sm",children:"Error loading predictions"})]}):s!=null&&s.revenuePredictions?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-green-800",children:"AI Revenue Predictions"}),e.jsx("p",{className:"text-sm text-green-700",children:"Based on your financial data and AI analysis"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Next Month"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Confidence: ",s.revenuePredictions.nextMonth.confidence,"%"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-lg font-bold text-green-600",children:["$",s.revenuePredictions.nextMonth.amount.toLocaleString()]}),s.revenuePredictions.nextMonth.change&&e.jsxs("p",{className:"text-sm text-green-600",children:["+",s.revenuePredictions.nextMonth.change,"%"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Next Quarter"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Confidence: ",s.revenuePredictions.nextQuarter.confidence,"%"]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-lg font-bold text-blue-600",children:["$",s.revenuePredictions.nextQuarter.amount.toLocaleString()]})})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Next Year"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Confidence: ",s.revenuePredictions.nextYear.confidence,"%"]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-lg font-bold text-purple-600",children:["$",s.revenuePredictions.nextYear.amount.toLocaleString()]})})]})]})]}):e.jsxs("div",{className:"text-center py-4 text-muted-foreground",children:[e.jsx($s,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No revenue predictions available"}),e.jsx("p",{className:"text-xs",children:"AI is analyzing your revenue patterns"})]})})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Za,{className:"w-5 h-5 text-blue-600"}),"Cash Flow Forecast"]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:t?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(Ts,{className:"h-4 w-4 animate-spin mr-2"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Loading cash flow insights..."})]}):r?e.jsxs("div",{className:"flex items-center justify-center py-8 text-red-600",children:[e.jsx(Is,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"text-sm",children:"Error loading cash flow insights"})]}):s!=null&&s.cashFlowPredictions?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-blue-800",children:"AI Cash Flow Analysis"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Based on your transaction patterns and AI analysis"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"font-medium",children:"Current Position"}),e.jsxs("p",{className:`text-lg font-bold ${s.cashFlowPredictions.currentPosition>=0?"text-green-600":"text-red-600"}`,children:["$",s.cashFlowPredictions.currentPosition.toLocaleString()]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Expected Inflows:"}),e.jsxs("span",{className:"ml-2 font-medium text-green-600",children:["$",s.cashFlowPredictions.expectedInflows.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Expected Outflows:"}),e.jsxs("span",{className:"ml-2 font-medium text-red-600",children:["$",s.cashFlowPredictions.expectedOutflows.toLocaleString()]})]})]})]}),e.jsx("div",{className:"p-3 border rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Net Cash Flow"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Status: ",s.cashFlowPredictions.status]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:`text-lg font-bold ${s.cashFlowPredictions.netCashFlow>=0?"text-green-600":"text-red-600"}`,children:["$",s.cashFlowPredictions.netCashFlow.toLocaleString()]})})]})})]})]}):e.jsxs("div",{className:"text-center py-4 text-muted-foreground",children:[e.jsx(Za,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No cash flow predictions available"}),e.jsx("p",{className:"text-xs",children:"AI is analyzing your cash flow patterns"})]})})})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"AI Insights Summary"}),e.jsx(Vt,{children:"Overview of all AI-generated insights and patterns"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-medium mb-2",children:"High Priority Insights"}),e.jsx("p",{className:"text-lg font-bold text-red-600",children:i.filter(k=>k.priority==="high").length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Urgent recommendations requiring attention"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Revenue Insights"}),e.jsx("p",{className:"text-lg font-bold text-green-600",children:s!=null&&s.revenuePredictions?3:0}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"AI revenue predictions available"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Risk Alerts"}),e.jsx("p",{className:"text-lg font-bold text-amber-600",children:m.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active inventory alerts"})]})]})})]})]}),e.jsx(yt,{value:"anomalies",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Is,{className:"w-5 h-5 text-amber-600"}),"AI-Detected Anomalies"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Oe,{variant:"secondary",children:[i.filter(k=>k.priority==="high"||k.impact==="high").length," Critical"]}),e.jsx(I,{variant:"ghost",size:"sm",onClick:c,children:e.jsx(Ts,{className:"h-4 w-4"})})]})]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:o?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(Ts,{className:"h-4 w-4 animate-spin mr-2"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Loading anomalies..."})]}):l?e.jsxs("div",{className:"flex items-center justify-center py-8 text-red-600",children:[e.jsx(Is,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"text-sm",children:"Error loading anomalies"})]}):i.length>0?i.filter(k=>k.priority==="high"||k.impact==="high").map(k=>{var F;return e.jsx("div",{className:`p-4 border rounded-lg ${k.priority==="high"?"border-red-200 bg-red-50":k.priority==="medium"?"border-amber-200 bg-amber-50":"border-blue-200 bg-blue-50"}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-medium",children:k.type.replace("_"," ").toUpperCase()}),e.jsx(Oe,{variant:k.priority==="high"?"destructive":k.priority==="medium"?"secondary":"outline",children:k.priority.toUpperCase()}),e.jsxs(Oe,{variant:"outline",className:"text-xs",children:[Math.round(k.confidence*100),"% confidence"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:k.description}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"font-medium text-cyan-600",children:["Impact: ",((F=k.impact)==null?void 0:F.toUpperCase())||"MEDIUM"]}),e.jsx("span",{className:"text-muted-foreground",children:new Date(k.generatedAt).toLocaleDateString()})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(I,{variant:"ghost",size:"sm",children:e.jsx(ir,{className:"w-4 h-4"})})})]})},k.id)}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Is,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No critical anomalies detected"}),e.jsx("p",{className:"text-xs",children:"Your financial data looks healthy!"})]})})})]})}),e.jsx(yt,{value:"recommendations",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(ic,{className:"w-5 h-5 text-blue-600"}),"AI Recommendations"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Oe,{variant:"secondary",children:[i.length," Active"]}),e.jsx(I,{variant:"ghost",size:"sm",onClick:c,children:e.jsx(Ts,{className:"h-4 w-4"})})]})]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:o?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(Ts,{className:"h-4 w-4 animate-spin mr-2"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Loading recommendations..."})]}):l?e.jsxs("div",{className:"flex items-center justify-center py-8 text-red-600",children:[e.jsx(Is,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"text-sm",children:"Error loading recommendations"})]}):i.length>0?i.map(k=>{var F;return e.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Oe,{variant:"outline",children:k.category.replace("_"," ").toUpperCase()}),e.jsxs(Oe,{variant:k.priority==="high"?"default":k.priority==="medium"?"secondary":"outline",children:[k.priority.toUpperCase()," PRIORITY"]}),k.confidence&&e.jsxs(Oe,{variant:"outline",className:"text-xs",children:[Math.round(k.confidence*100),"% confidence"]})]}),e.jsx("h3",{className:"font-medium mb-1",children:k.type.replace("_"," ").toUpperCase()}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:k.description}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{children:["Impact: ",((F=k.impact)==null?void 0:F.toUpperCase())||"MEDIUM"]}),e.jsx("span",{className:"text-muted-foreground",children:new Date(k.generatedAt).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{variant:"outline",size:"sm",children:"Dismiss"}),e.jsx(I,{size:"sm",children:"Apply"})]})]})},k.id)}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(ic,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No recommendations available"}),e.jsx("p",{className:"text-xs",children:"AI is analyzing your data to provide personalized recommendations"})]})})})]})}),e.jsxs(yt,{value:"tax-optimization",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(yn,{className:"w-5 h-5 text-green-600"}),"AI Tax Optimization Insights"]}),e.jsx(Vt,{children:"AI-powered tax optimization recommendations based on your data"})]}),e.jsx(ie,{className:"space-y-4",children:o?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(Ts,{className:"h-4 w-4 animate-spin mr-2"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Loading tax insights..."})]}):l?e.jsxs("div",{className:"flex items-center justify-center py-8 text-red-600",children:[e.jsx(Is,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"text-sm",children:"Error loading tax insights"})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg border border-green-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-800",children:"AI Tax Insights"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:i.filter(k=>k.category==="financial"||k.description.toLowerCase().includes("tax")).length})]}),e.jsx(Oe,{variant:"default",className:"bg-green-100 text-green-800",children:"Active"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-800",children:"High Priority"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:i.filter(k=>k.priority==="high"&&(k.category==="financial"||k.description.toLowerCase().includes("tax"))).length})]}),e.jsx(Oe,{variant:"secondary",className:"bg-blue-100 text-blue-800",children:"Critical"})]})]})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"AI Tax Strategies"}),e.jsx(Vt,{children:"AI-generated tax optimization recommendations"})]}),e.jsx(ie,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[i.filter(k=>k.category==="financial"||k.type==="tax"||k.description.toLowerCase().includes("tax")).slice(0,5).map(k=>{var F;return e.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Oe,{variant:"outline",children:k.category.replace("_"," ").toUpperCase()}),e.jsxs(Oe,{variant:k.priority==="high"?"default":k.priority==="medium"?"secondary":"outline",children:[k.priority.toUpperCase()," PRIORITY"]}),e.jsxs(Oe,{variant:"outline",className:"text-xs",children:[Math.round(k.confidence*100),"% confidence"]})]}),e.jsx("h3",{className:"font-medium mb-1",children:k.type.replace("_"," ").toUpperCase()}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:k.description}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("span",{className:"font-medium text-green-600",children:["Impact: ",((F=k.impact)==null?void 0:F.toUpperCase())||"MEDIUM"]}),e.jsx("span",{className:"text-muted-foreground",children:new Date(k.generatedAt).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{variant:"outline",size:"sm",children:"Learn More"}),e.jsx(I,{size:"sm",children:"Apply"})]})]})},k.id)}),i.filter(k=>k.category==="financial"||k.type==="tax"||k.description.toLowerCase().includes("tax")).length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(yn,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"No tax optimization insights available"}),e.jsx("p",{className:"text-xs",children:"AI is analyzing your financial data to provide tax strategies"})]})]})})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Tax Calendar & Deadlines"}),e.jsx(Vt,{children:"Important tax-related dates and deadlines"})]}),e.jsx(ie,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[{date:"Dec 31, 2024",event:"Year-End Equipment Purchases",type:"deadline",description:"Last day to purchase equipment for current year depreciation"},{date:"Jan 15, 2025",event:"Q4 Estimated Tax Payment",type:"payment",description:"Final estimated tax payment for 2024"},{date:"Mar 15, 2025",event:"S-Corp Tax Return",type:"filing",description:"S-Corporation tax return deadline"}].map((k,F)=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Oe,{variant:k.type==="deadline"?"destructive":k.type==="payment"?"default":"secondary",children:k.type}),e.jsx("span",{className:"font-medium",children:k.date})]}),e.jsx("h3",{className:"font-medium mb-1",children:k.event}),e.jsx("p",{className:"text-sm text-muted-foreground",children:k.description})]},F))})})]})]}),e.jsxs(yt,{value:"insights",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"AI Performance Insights"}),e.jsx(Vt,{children:"AI-generated performance analysis based on your data"})]}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:o?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(Ts,{className:"h-4 w-4 animate-spin mr-2"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Loading performance insights..."})]}):l?e.jsxs("div",{className:"flex items-center justify-center py-8 text-red-600",children:[e.jsx(Is,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"text-sm",children:"Error loading performance insights"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-cyan-50 border border-cyan-200 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-cyan-800 mb-2",children:"AI Analysis Summary"}),e.jsxs("p",{className:"text-sm text-cyan-700",children:["AI has analyzed ",i.length," insights across your financial data, identifying key patterns and opportunities."]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsx("span",{className:"text-sm",children:"High Priority Insights"}),e.jsx("span",{className:"font-medium text-red-600",children:i.filter(k=>k.priority==="high").length})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsx("span",{className:"text-sm",children:"Revenue Insights"}),e.jsx("span",{className:"font-medium text-green-600",children:s!=null&&s.revenuePredictions?3:0})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsx("span",{className:"text-sm",children:"Risk Alerts"}),e.jsx("span",{className:"font-medium text-amber-600",children:m.length})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsx("span",{className:"text-sm",children:"Cash Flow Insights"}),e.jsx("span",{className:"font-medium text-blue-600",children:s!=null&&s.cashFlowPredictions?1:0})]})]})]})})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Is,{className:"w-5 h-5 text-amber-600"}),"Real Inventory Alerts"]})}),e.jsx(ie,{children:f.isLoading?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(Ts,{className:"h-4 w-4 animate-spin mr-2"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Loading alerts..."})]}):m.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Is,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium",children:"No active alerts"}),e.jsx("p",{className:"text-sm",children:"All inventory levels are within normal parameters"})]}):e.jsxs("div",{className:"space-y-3",children:[m.slice(0,5).map(k=>{var F,A,T;return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-amber-100 rounded-lg flex items-center justify-center",children:e.jsx(Is,{className:"w-4 h-4 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:((F=k.product)==null?void 0:F.name)||"Unknown Product"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[(A=k.alertType)==null?void 0:A.replace("_"," ").toLowerCase(),"  Current: ",((T=k.product)==null?void 0:T.stockQuantity)||0,"  Threshold: ",k.threshold]})]})]}),e.jsx(Oe,{variant:"outline",className:"text-amber-600 border-amber-200",children:k.status})]},k.id)}),m.length>5&&e.jsx("div",{className:"text-center py-2",children:e.jsxs(I,{variant:"ghost",size:"sm",children:["View ",m.length-5," more alerts"]})})]})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"AI Market Intelligence"}),e.jsx(Vt,{children:"AI-powered market analysis and competitive insights"})]}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:o?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(Ts,{className:"h-4 w-4 animate-spin mr-2"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Loading market insights..."})]}):l?e.jsxs("div",{className:"flex items-center justify-center py-8 text-red-600",children:[e.jsx(Is,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"text-sm",children:"Error loading market insights"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-blue-800 mb-2",children:"AI Market Analysis"}),e.jsxs("p",{className:"text-sm text-blue-700",children:["AI has identified ",i.filter(k=>k.category==="financial"||k.type==="financial").length," market-related insights from your financial patterns."]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsx("p",{className:"font-medium text-sm",children:"Total AI Insights"}),e.jsx("p",{className:"text-lg font-bold text-blue-600",children:i.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Generated from your data"})]}),e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsx("p",{className:"font-medium text-sm",children:"Confidence Level"}),e.jsxs("p",{className:"text-lg font-bold text-green-600",children:[i.length>0?Math.round(i.reduce((k,F)=>k+F.confidence,0)/i.length*100):0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Average AI confidence"})]}),e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsx("p",{className:"font-medium text-sm",children:"Recent Insights"}),e.jsx("p",{className:"text-lg font-bold text-purple-600",children:i.filter(k=>{const F=new Date(k.generatedAt),A=new Date;return A.setDate(A.getDate()-7),F>A}).length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Generated this week"})]})]})]})})})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"AI Learning Progress"}),e.jsx(Vt,{children:"AI model performance and learning status"})]}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:o?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(Ts,{className:"h-4 w-4 animate-spin mr-2"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Loading AI metrics..."})]}):l?e.jsxs("div",{className:"flex items-center justify-center py-8 text-red-600",children:[e.jsx(Is,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"text-sm",children:"Error loading AI metrics"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:i.length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Insights Generated"})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[i.length>0?Math.round(i.reduce((k,F)=>k+F.confidence,0)/i.length*100):0,"%"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Average Confidence"})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:i.filter(k=>k.priority==="high").length}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"High Priority Alerts"})]})]}),e.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("p",{className:"text-green-800 font-medium",children:["AI Model Status: ",i.length>10?"Fully Trained":"Learning"]}),e.jsx("p",{className:"text-sm text-green-700",children:i.length>10?`Your AI model has generated ${i.length} insights and is providing highly accurate recommendations.`:`Your AI model is learning from your data. Generated ${i.length} insights so far. More data will improve accuracy.`})]})]})})})]})]})]})]})})})}const Gl={processReceipt:async(s,t)=>(await fetch(un("api/enhanced-transaction-processing/receipts/process"),{method:"POST",headers:{"Content-Type":"application/json","x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({imageUrl:s,companyId:t})})).json(),getReceipts:async(s,t,r)=>{const n=new URLSearchParams;return t&&n.append("startDate",t),r&&n.append("endDate",r),(await fetch(un(`api/enhanced-transaction-processing/receipts/${s}?${n}`),{headers:{"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo",Authorization:`Bearer ${localStorage.getItem("auth_token")}`}})).json()},batchProcessReceipts:async(s,t)=>(await fetch(un("api/enhanced-transaction-processing/receipts/batch-process"),{method:"POST",headers:{"Content-Type":"application/json","x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({imageUrls:s,companyId:t})})).json(),generateInvoice:async(s,t,r,n)=>(await fetch(un(`api/enhanced-transaction-processing/invoices/generate?companyId=${r}`),{method:"POST",headers:{"Content-Type":"application/json","x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({customerId:s,items:t,templateId:n})})).json(),getInvoices:async(s,t=10)=>(await fetch(un(`api/enhanced-transaction-processing/invoices/${s}?limit=${t}`),{headers:{"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo",Authorization:`Bearer ${localStorage.getItem("auth_token")}`}})).json(),getCustomers:async(s,t)=>{const r=new URLSearchParams;return t&&r.append("search",t),(await fetch(un(`api/enhanced-transaction-processing/customers/${s}?${r}`),{headers:{"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo",Authorization:`Bearer ${localStorage.getItem("auth_token")}`}})).json()},createAIInvoice:async(s,t,r)=>(await fetch(un("api/enhanced-transaction-processing/invoices/ai-create"),{method:"POST",headers:{"Content-Type":"application/json","x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({description:s,companyId:t,context:r})})).json(),getInvoiceTemplates:async s=>(await fetch(un(`api/enhanced-transaction-processing/invoices/templates/${s}`),{headers:{"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo",Authorization:`Bearer ${localStorage.getItem("auth_token")}`}})).json(),findVendorMatch:async(s,t,r)=>(await fetch(un("api/enhanced-transaction-processing/vendors/match"),{method:"POST",headers:{"Content-Type":"application/json","x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({vendorName:s,companyId:t,context:r})})).json(),findCustomerMatch:async(s,t,r)=>(await fetch(un("api/enhanced-transaction-processing/customers/match"),{method:"POST",headers:{"Content-Type":"application/json","x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({customerName:s,companyId:t,context:r})})).json(),getVendorsWithInsights:async(s,t,r)=>{const n=new URLSearchParams;return t&&n.append("search",t),r&&n.append("limit",r.toString()),(await fetch(un(`api/enhanced-transaction-processing/vendors/${s}?${n}`),{headers:{"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo",Authorization:`Bearer ${localStorage.getItem("auth_token")}`}})).json()},createVendor:async(s,t)=>(await fetch(un("api/enhanced-transaction-processing/vendors"),{method:"POST",headers:{"Content-Type":"application/json","x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({...s,companyId:t})})).json(),updateVendor:async(s,t,r)=>(await fetch(un(`api/enhanced-transaction-processing/vendors/${s}`),{method:"PUT",headers:{"Content-Type":"application/json","x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({...t,companyId:r})})).json(),deleteVendor:async(s,t)=>(await fetch(un(`api/enhanced-transaction-processing/vendors/${s}`),{method:"DELETE",headers:{"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo",Authorization:`Bearer ${localStorage.getItem("auth_token")}`}})).json(),getVendor:async(s,t)=>(await fetch(un(`api/enhanced-transaction-processing/vendors/${s}/details?companyId=${t}`),{headers:{"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo",Authorization:`Bearer ${localStorage.getItem("auth_token")}`}})).json(),getCustomersWithInsights:async(s,t,r)=>{const n=new URLSearchParams;return t&&n.append("search",t),r&&n.append("limit",r.toString()),(await fetch(un(`api/enhanced-transaction-processing/customers/${s}?${n}`),{headers:{"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo",Authorization:`Bearer ${localStorage.getItem("auth_token")}`}})).json()},getTransactionPatterns:async(s,t)=>{const r=new URLSearchParams;return t&&r.append("periodDays",t.toString()),(await fetch(un(`api/enhanced-transaction-processing/intelligence/patterns/${s}?${r}`),{headers:{"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo",Authorization:`Bearer ${localStorage.getItem("auth_token")}`}})).json()},getTransactionStats:async(s,t)=>{const r=new URLSearchParams;return t&&r.append("periodDays",t.toString()),(await fetch(un(`api/enhanced-transaction-processing/intelligence/stats/${s}?${r}`),{headers:{"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo",Authorization:`Bearer ${localStorage.getItem("auth_token")}`}})).json()},getRecommendations:async(s,t)=>{const r=new URLSearchParams;return t&&r.append("type",t),(await fetch(un(`api/enhanced-transaction-processing/recommendations/${s}?${r}`),{headers:{"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo",Authorization:`Bearer ${localStorage.getItem("auth_token")}`}})).json()}},SFe=({companyId:s})=>{var ce,Y,ue,ve,Le,Me,tt,fe,ct,dt,pt,qe,mt,Rt;const[t,r]=x.useState("invoices"),[n,a]=x.useState([]),[i,o]=x.useState(!1),[l,c]=x.useState(""),[d,u]=x.useState(30),[h,f]=x.useState(!1),[m,p]=x.useState(!1),[g,v]=x.useState(""),[y,j]=x.useState(null),[b,w]=x.useState(null),[N,C]=x.useState({customerId:"",items:[{description:"",quantity:1,unitPrice:0}],templateId:""}),[S,_]=x.useState(!1),[k,F]=x.useState(null),[A,T]=x.useState(!1),[V,M]=x.useState({name:"",email:"",phone:"",address:"",taxId:"",paymentTerms:"",city:"",state:"",zipCode:"",country:"",notes:""}),G=hi(),L=Rs({mutationFn:_e=>Gl.generateInvoice(_e.customerId,_e.items,_e.companyId,_e.templateId),onSuccess:_e=>{var Xe,At,st;G.invalidateQueries({queryKey:["recentInvoices"]}),f(!1),p(!1),C({customerId:"",items:[{description:"",quantity:1,unitPrice:0}],templateId:""}),v(""),j(null),w(null),alert(` Invoice created successfully!

Invoice Number: ${((Xe=_e.data)==null?void 0:Xe.invoiceNumber)||"N/A"}
Total Amount: $${((At=_e.data)==null?void 0:At.totalAmount)||"0.00"}
Status: ${((st=_e.data)==null?void 0:st.status)||"draft"}`)},onError:_e=>{console.error("Invoice creation error:",_e),alert(` Failed to create invoice: ${(_e==null?void 0:_e.message)||"Unknown error"}`)}}),J=Rs({mutationFn:_e=>Gl.createAIInvoice(_e,s),onSuccess:_e=>{j(_e.data),console.log("AI invoice data generated:",_e.data)},onError:_e=>{console.error("AI invoice generation error:",_e),alert(` Failed to generate AI invoice: ${(_e==null?void 0:_e.message)||"Unknown error"}`)}}),z=Rs({mutationFn:_e=>Gl.createVendor(_e,s),onSuccess:_e=>{var Xe;G.invalidateQueries({queryKey:["vendors",s]}),_(!1),M({name:"",email:"",phone:"",address:"",taxId:"",paymentTerms:"",city:"",state:"",zipCode:"",country:"",notes:""}),alert(` Vendor "${(Xe=_e.data)==null?void 0:Xe.name}" created successfully!`)},onError:_e=>{console.error("Vendor creation error:",_e),alert(` Failed to create vendor: ${(_e==null?void 0:_e.message)||"Unknown error"}`)}}),U=Rs({mutationFn:({vendorId:_e,vendorData:Xe})=>Gl.updateVendor(_e,Xe,s),onSuccess:_e=>{var Xe;G.invalidateQueries({queryKey:["vendors",s]}),_(!1),F(null),M({name:"",email:"",phone:"",address:"",taxId:"",paymentTerms:"",city:"",state:"",zipCode:"",country:"",notes:""}),alert(` Vendor "${(Xe=_e.data)==null?void 0:Xe.name}" updated successfully!`)},onError:_e=>{console.error("Vendor update error:",_e),alert(` Failed to update vendor: ${(_e==null?void 0:_e.message)||"Unknown error"}`)}}),oe=Rs({mutationFn:_e=>Gl.deleteVendor(_e,s),onSuccess:()=>{G.invalidateQueries({queryKey:["vendors",s]}),alert(" Vendor deleted successfully!")},onError:_e=>{console.error("Vendor deletion error:",_e),alert(` Failed to delete vendor: ${(_e==null?void 0:_e.message)||"Unknown error"}`)}}),Q=()=>{F(null),M({name:"",email:"",phone:"",address:"",taxId:"",paymentTerms:"",city:"",state:"",zipCode:"",country:"",notes:""}),_(!0)},P=_e=>{F(_e),M({name:_e.name||"",email:_e.email||"",phone:_e.phone||"",address:_e.address||"",taxId:_e.taxNumber||"",paymentTerms:_e.paymentTerms||"",city:_e.city||"",state:_e.state||"",zipCode:_e.zipCode||"",country:_e.country||"",notes:_e.notes||""}),T(!1),_(!0)},q=_e=>{window.confirm(`Are you sure you want to delete vendor "${_e.name}"? This action cannot be undone.`)&&oe.mutate(_e.id)},D=()=>{if(!V.name.trim()){alert("Please enter a vendor name");return}k?U.mutate({vendorId:k.id,vendorData:V}):z.mutate(V)},{data:se}=ys({queryKey:["invoiceTemplates",s],queryFn:()=>Gl.getInvoiceTemplates(s),enabled:t==="invoices"}),{data:he,isLoading:be}=ys({queryKey:["recentInvoices",s],queryFn:()=>Gl.getInvoices(s,5),enabled:t==="invoices"}),{data:pe,isLoading:Ae}=ys({queryKey:["vendors",s,l],queryFn:()=>Gl.getVendorsWithInsights(s,l),enabled:t==="vendors"}),{data:Ee,isLoading:$e}=ys({queryKey:["customersWithInsights",s,l],queryFn:()=>Gl.getCustomersWithInsights(s,l),enabled:t==="customers"}),{data:O}=ys({queryKey:["transactionStats",s],queryFn:()=>Gl.getTransactionStats(s),enabled:t==="intelligence"}),{data:te}=ys({queryKey:["transactionPatterns",s],queryFn:()=>Gl.getTransactionPatterns(s),enabled:t==="intelligence"}),{data:re}=ys({queryKey:["recommendations",s],queryFn:()=>Gl.getRecommendations(s),enabled:t==="intelligence"}),{data:le,isLoading:Z}=ys({queryKey:["receipts",s],queryFn:()=>Gl.getReceipts(s),enabled:t==="receipts"}),{data:K}=ys({queryKey:["customers",s],queryFn:()=>Gl.getCustomersWithInsights(s,""),enabled:t==="customers"}),X=[{id:"invoices",label:"Smart Invoices",icon:Yf},{id:"ai-create",label:"AI Create",icon:La},{id:"vendors",label:"Vendor Management",icon:vn},{id:"customers",label:"Customer Management",icon:Sa},{id:"intelligence",label:"Transaction Intelligence",icon:$s}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-4",children:e.jsx("div",{className:"flex space-x-8",children:X.map(_e=>{const Xe=_e.icon;return e.jsxs("button",{onClick:()=>r(_e.id),className:`flex items-center space-x-2 py-2 px-1 border-b-2 font-medium text-sm ${t===_e.id?"border-teal-500 text-teal-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(Xe,{className:"w-4 h-4"}),e.jsx("span",{children:_e.label})]},_e.id)})})}),e.jsxs("div",{className:"space-y-6",children:[!1,t==="ai-create"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Create Invoice with Natural Language"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Company context is taken from your selection"})]}),e.jsx(U$,{onInvoiceCreated:()=>{r("invoices"),G.invalidateQueries({queryKey:["recentInvoices",s]})}})]})}),t==="invoices"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"AI-Powered Invoice Creation"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>r("receipts"),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:[e.jsx(Zt,{className:"w-4 h-4 inline mr-2"}),"From Receipt"]}),e.jsxs("button",{onClick:()=>f(!0),className:"bg-teal-600 text-white px-4 py-2 rounded-md hover:bg-teal-700",children:[e.jsx(Ss,{className:"w-4 h-4 inline mr-2"}),"Create New"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{onClick:()=>p(!0),className:"border border-gray-200 rounded-lg p-6 hover:border-teal-300 cursor-pointer transition-colors",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg mr-3",children:e.jsx(La,{className:"h-5 w-5 text-blue-600"})}),e.jsx("h3",{className:"font-semibold text-gray-900",children:"Natural Language"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Describe your invoice in plain English and let AI create it for you"}),e.jsx("div",{className:"text-xs text-gray-500",children:'Example: "Create an invoice for web development services to a client"'})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-6 hover:border-teal-300 cursor-pointer transition-colors",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg mr-3",children:e.jsx(jp,{className:"h-5 w-5 text-green-600"})}),e.jsx("h3",{className:"font-semibold text-gray-900",children:"AI Chat Assistant"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Have a conversation with AI to build your invoice step by step"}),e.jsx("div",{className:"text-xs text-gray-500",children:"Interactive chat interface for complex invoices"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-md font-semibold text-gray-900 mb-4",children:"Invoice Templates"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:(ce=se==null?void 0:se.data)==null?void 0:ce.map(_e=>e.jsxs("div",{className:"border rounded-lg p-4 hover:border-teal-300 cursor-pointer",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:_e.name}),e.jsx("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded",children:"Active"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:_e.description})]},_e.id))})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"text-md font-semibold text-gray-900 mb-4",children:"Recent Invoices"}),be?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Loading invoices..."})]}):((Y=he==null?void 0:he.data)==null?void 0:Y.length)>0?e.jsx("div",{className:"space-y-3",children:he.data.map(_e=>{var Xe,At,st;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:_e.invoiceNumber}),e.jsxs("div",{className:"text-sm text-gray-600",children:[((Xe=_e.customer)==null?void 0:Xe.name)||"Unknown Customer"," - $",Number(_e.totalAmount).toFixed(2)]}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(_e.issueDate).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`text-xs px-2 py-1 rounded ${_e.status==="paid"?"bg-green-100 text-green-800":_e.status==="sent"?"bg-blue-100 text-blue-800":_e.status==="draft"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:((At=_e.status)==null?void 0:At.charAt(0).toUpperCase())+((st=_e.status)==null?void 0:st.slice(1))}),e.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:e.jsx(ir,{className:"h-4 w-4"})})]})]},_e.id)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Yf,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"No invoices created yet"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Create your first invoice using the AI-powered tools above"})]})]})]})}),t==="vendors"&&e.jsxs("div",{className:"space-y-6",children:[(pe==null?void 0:pe.data)&&pe.data.length>0&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(vn,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Vendors"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:pe.data.length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Mr,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Spent"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",pe.data.reduce((_e,Xe)=>{var At;return _e+(((At=Xe.insights)==null?void 0:At.totalAmount)||0)},0).toFixed(2)]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(wa,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Active Vendors"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:pe.data.filter(_e=>{var Xe;return(((Xe=_e.insights)==null?void 0:Xe.transactionCount)||0)>0}).length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:e.jsx(lh,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Transactions"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:pe.data.reduce((_e,Xe)=>{var At;return _e+(((At=Xe.insights)==null?void 0:At.transactionCount)||0)},0)})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Vendor Management"}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Rn,{className:"w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search vendors...",value:l,onChange:_e=>c(_e.target.value),className:"border border-gray-300 rounded-md px-3 py-1 text-sm"}),e.jsxs("button",{onClick:Q,className:"bg-teal-600 text-white px-4 py-2 rounded-md hover:bg-teal-700 flex items-center space-x-2 text-sm whitespace-nowrap",children:[e.jsx(Ss,{className:"w-4 h-4"}),e.jsx("span",{children:"Add Vendor"})]})]})]}),Ae?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Loading vendors..."})]}):((ue=pe==null?void 0:pe.data)==null?void 0:ue.length)>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:pe.data.map(_e=>{var Xe,At,st,$t,fs,zt,St,js,et,lt;return e.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:_e.name}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${((Xe=_e.insights)==null?void 0:Xe.frequency)==="frequent"?"bg-green-100 text-green-800":((At=_e.insights)==null?void 0:At.frequency)==="occasional"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:(st=_e.insights)==null?void 0:st.frequency})]}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Receipts:"}),e.jsx("span",{className:"ml-1 font-medium",children:(($t=_e.insights)==null?void 0:$t.receiptCount)||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Invoices:"}),e.jsx("span",{className:"ml-1 font-medium",children:((fs=_e.insights)==null?void 0:fs.invoiceCount)||0})]})]}),e.jsxs("div",{className:"border-t pt-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Total:"}),e.jsxs("span",{className:"font-medium",children:["$",((St=(zt=_e.insights)==null?void 0:zt.totalAmount)==null?void 0:St.toFixed(2))||"0.00"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Avg:"}),e.jsxs("span",{className:"font-medium",children:["$",((et=(js=_e.insights)==null?void 0:js.averageAmount)==null?void 0:et.toFixed(2))||"0.00"]})]})]}),((lt=_e.insights)==null?void 0:lt.lastActivity)&&e.jsxs("div",{className:"text-xs text-gray-500 pt-1 border-t",children:["Last activity: ",new Date(_e.insights.lastActivity).toLocaleDateString()]})]}),e.jsxs("div",{className:"mt-3 pt-2 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-500",children:"Contact:"}),e.jsx("span",{className:"text-gray-700",children:_e.email||"No email"})]}),_e.phone&&e.jsxs("div",{className:"flex items-center justify-between text-xs mt-1",children:[e.jsx("span",{className:"text-gray-500",children:"Phone:"}),e.jsx("span",{className:"text-gray-700",children:_e.phone})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t flex space-x-2",children:[e.jsxs("button",{onClick:()=>P(_e),className:"flex-1 text-xs text-teal-600 hover:text-teal-800 py-1.5 px-2 border border-teal-200 rounded hover:bg-teal-50 flex items-center justify-center space-x-1",title:"Edit vendor",children:[e.jsx(ln,{className:"w-3 h-3"}),e.jsx("span",{children:"Edit"})]}),e.jsxs("button",{onClick:()=>q(_e),className:"flex-1 text-xs text-red-600 hover:text-red-800 py-1.5 px-2 border border-red-200 rounded hover:bg-red-50 flex items-center justify-center space-x-1",title:"Delete vendor",children:[e.jsx(hn,{className:"w-3 h-3"}),e.jsx("span",{children:"Delete"})]})]})]},_e.id)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(vn,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"No vendors found"})]})]}),S&&e.jsx("div",{className:"fixed inset-0 bg-black/50 bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:k?"Edit Vendor":"Create New Vendor"}),e.jsx("button",{onClick:()=>_(!1),className:"text-gray-400 hover:text-gray-600 p-1",children:e.jsx(ma,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"px-6 py-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 border-b pb-2",children:"Basic Information"}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Vendor Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:V.name,onChange:_e=>M({...V,name:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-teal-500",placeholder:"Enter vendor name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:V.email,onChange:_e=>M({...V,email:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-teal-500",placeholder:"vendor@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",value:V.phone,onChange:_e=>M({...V,phone:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-teal-500",placeholder:"+1 (555) 123-4567"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tax ID"}),e.jsx("input",{type:"text",value:V.taxId,onChange:_e=>M({...V,taxId:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-teal-500",placeholder:"Tax ID"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Terms"}),e.jsx("input",{type:"text",value:V.paymentTerms,onChange:_e=>M({...V,paymentTerms:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-teal-500",placeholder:"Net 30"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 border-b pb-2",children:"Address"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Street"}),e.jsx("input",{type:"text",value:V.address,onChange:_e=>M({...V,address:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-teal-500",placeholder:"Street"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),e.jsx("input",{type:"text",value:V.city,onChange:_e=>M({...V,city:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-teal-500",placeholder:"City"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"State"}),e.jsx("input",{type:"text",value:V.state,onChange:_e=>M({...V,state:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-teal-500",placeholder:"State"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ZIP"}),e.jsx("input",{type:"text",value:V.zipCode,onChange:_e=>M({...V,zipCode:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-teal-500",placeholder:"ZIP"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),e.jsx("input",{type:"text",value:V.country,onChange:_e=>M({...V,country:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-teal-500",placeholder:"Country"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:V.notes,onChange:_e=>M({...V,notes:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-teal-500",rows:3,placeholder:"Notes..."})]})]})]})}),e.jsxs("div",{className:"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>_(!1),className:"px-5 py-2 text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:D,disabled:z.isPending||U.isPending,className:"px-6 py-2 bg-teal-600 text-white rounded-md hover:bg-teal-700 disabled:opacity-50 flex items-center space-x-2",children:z.isPending||U.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Saving..."})]}):e.jsx("span",{children:k?"Update Vendor":"Create Vendor"})})]})]})}),S&&e.jsx("div",{className:"fixed inset-0 bg-black/50 bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:k?"Edit Vendor":"Create New Vendor"}),e.jsx("button",{onClick:()=>_(!1),className:"text-gray-400 hover:text-gray-600 p-1",children:e.jsx(ma,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"px-6 py-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 border-b pb-2",children:"Basic Information"}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Vendor Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:V.name,onChange:_e=>M({...V,name:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-teal-500",placeholder:"Enter vendor name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"email",value:V.email,onChange:_e=>M({...V,email:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-teal-500",placeholder:"vendor@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",value:V.phone,onChange:_e=>M({...V,phone:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-teal-500",placeholder:"+1 (555) 123-4567"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tax ID"}),e.jsx("input",{type:"text",value:V.taxId,onChange:_e=>M({...V,taxId:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-teal-500",placeholder:"Tax ID"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Terms"}),e.jsx("input",{type:"text",value:V.paymentTerms,onChange:_e=>M({...V,paymentTerms:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-teal-500",placeholder:"Net 30"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 border-b pb-2",children:"Address"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Street"}),e.jsx("input",{type:"text",value:V.address,onChange:_e=>M({...V,address:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-teal-500",placeholder:"Street"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City"}),e.jsx("input",{type:"text",value:V.city,onChange:_e=>M({...V,city:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-teal-500",placeholder:"City"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"State"}),e.jsx("input",{type:"text",value:V.state,onChange:_e=>M({...V,state:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-teal-500",placeholder:"State"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ZIP"}),e.jsx("input",{type:"text",value:V.zipCode,onChange:_e=>M({...V,zipCode:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-teal-500",placeholder:"ZIP"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),e.jsx("input",{type:"text",value:V.country,onChange:_e=>M({...V,country:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-teal-500",placeholder:"Country"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:V.notes,onChange:_e=>M({...V,notes:_e.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-teal-500",rows:3,placeholder:"Notes..."})]})]})]})}),e.jsxs("div",{className:"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>_(!1),className:"px-5 py-2 text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:D,disabled:z.isPending||U.isPending,className:"px-6 py-2 bg-teal-600 text-white rounded-md hover:bg-teal-700 disabled:opacity-50 flex items-center space-x-2",children:z.isPending||U.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Saving..."})]}):e.jsx("span",{children:k?"Update Vendor":"Create Vendor"})})]})]})})]}),t==="customers"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Customer Management"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rn,{className:"w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search customers...",value:l,onChange:_e=>c(_e.target.value),className:"border border-gray-300 rounded-md px-3 py-1 text-sm"})]})]}),$e?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Loading customers..."})]}):((ve=Ee==null?void 0:Ee.data)==null?void 0:ve.length)>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Ee.data.map(_e=>{var Xe,At,st,$t,fs,zt,St,js;return e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:_e.name}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${((Xe=_e.insights)==null?void 0:Xe.status)==="good"?"bg-green-100 text-green-800":((At=_e.insights)==null?void 0:At.status)==="fair"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:(st=_e.insights)==null?void 0:st.status})]}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("div",{children:["Invoices: ",($t=_e.insights)==null?void 0:$t.invoiceCount]}),e.jsxs("div",{children:["Total: $",(zt=(fs=_e.insights)==null?void 0:fs.totalAmount)==null?void 0:zt.toFixed(2)]}),e.jsxs("div",{children:["Payment Rate: ",(js=(St=_e.insights)==null?void 0:St.paymentRate)==null?void 0:js.toFixed(1),"%"]})]})]},_e.id)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Sa,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"No customers found"})]})]})}),t==="intelligence"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(lr,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Transactions"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((Le=O==null?void 0:O.data)==null?void 0:Le.totalTransactions)||0})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Mr,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Amount"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",((tt=(Me=O==null?void 0:O.data)==null?void 0:Me.totalAmount)==null?void 0:tt.toFixed(2))||"0.00"]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(wa,{className:"w-6 h-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Average Amount"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",((ct=(fe=O==null?void 0:O.data)==null?void 0:fe.averageAmount)==null?void 0:ct.toFixed(2))||"0.00"]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:e.jsx(Xn,{className:"w-6 h-6 text-orange-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Period"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[d," days"]})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"AI Recommendations"}),e.jsxs("select",{value:d,onChange:_e=>u(Number(_e.target.value)),className:"border border-gray-300 rounded-md px-3 py-1 text-sm",children:[e.jsx("option",{value:30,children:"Last 30 days"}),e.jsx("option",{value:90,children:"Last 90 days"}),e.jsx("option",{value:180,children:"Last 6 months"}),e.jsx("option",{value:365,children:"Last year"})]})]})}),e.jsx("div",{className:"p-6",children:((dt=re==null?void 0:re.data)==null?void 0:dt.length)>0?e.jsx("div",{className:"space-y-4",children:re.data.map((_e,Xe)=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:_e.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:_e.description})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:[Math.round(_e.confidence*100),"% confidence"]}),e.jsxs("span",{className:`text-xs px-2 py-1 rounded ${_e.riskScore>.5?"bg-red-100 text-red-800":_e.riskScore>.2?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:["Risk: ",Math.round(_e.riskScore*100),"%"]})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Recommendations:"}),e.jsx("ul",{className:"space-y-1",children:_e.recommendations.map((At,st)=>e.jsxs("li",{className:"text-sm text-gray-600 flex items-start",children:[e.jsx(ic,{className:"w-4 h-4 text-yellow-500 mr-2 mt-0.5 flex-shrink-0"}),At]},st))})]})]},Xe))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx($s,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"No recommendations available"})]})})]})]})]}),m&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"AI-Powered Invoice Creation"}),e.jsx("button",{onClick:()=>{p(!1),v(""),j(null),w(null)},className:"text-gray-400 hover:text-gray-600",children:e.jsx(ma,{className:"h-5 w-5"})})]}),y?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"AI Generated Invoice"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Customer from Database"}),e.jsxs("select",{value:(b==null?void 0:b.id)||"",onChange:_e=>{var At;const Xe=_e.target.value;if(Xe){const st=(At=K==null?void 0:K.data)==null?void 0:At.find($t=>$t.id===Xe);st&&w({id:st.id,name:st.name,email:st.email||"No email"})}else w(null)},className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select a customer..."}),(pt=K==null?void 0:K.data)==null?void 0:pt.map(_e=>e.jsxs("option",{value:_e.id,children:[_e.name," ",_e.email?`(${_e.email})`:""]},_e.id))]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Invoice Items"}),e.jsx("div",{className:"space-y-2",children:(qe=y.items)==null?void 0:qe.map((_e,Xe)=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-white rounded border",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:_e.description}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Qty: ",_e.quantity,"  $",_e.unitPrice," = $",(_e.quantity*_e.unitPrice).toFixed(2)]})]}),e.jsxs("div",{className:"text-sm font-medium",children:["$",(_e.quantity*_e.unitPrice).toFixed(2)]})]},Xe))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Tax Rate:"})," ",(y.taxRate*100).toFixed(1),"%"]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Payment Terms:"})," ",y.paymentTerms]})]}),y.notes&&e.jsxs("div",{className:"mt-4",children:[e.jsx("span",{className:"text-gray-600 text-sm",children:"Notes:"}),e.jsx("p",{className:"text-sm text-gray-800",children:y.notes})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>{v(""),j(null),w(null)},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",children:"Start Over"}),e.jsx("button",{onClick:()=>{b&&y.items&&L.mutate({customerId:b.id,items:y.items.map(_e=>({..._e,totalPrice:_e.quantity*_e.unitPrice})),companyId:s})},disabled:!b||L.isPending,className:"px-4 py-2 bg-teal-600 text-white rounded-md hover:bg-teal-700 disabled:opacity-50",children:L.isPending?"Creating...":"Create Invoice"})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Describe your invoice"}),e.jsx("textarea",{value:g,onChange:_e=>v(_e.target.value),placeholder:"Example: Create an invoice for $500 web development services to ABC Company, including 10 hours of frontend development and 5 hours of backend integration",className:"w-full border border-gray-300 rounded-md px-3 py-2 h-24"})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>p(!1),className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:()=>{g.trim()&&J.mutate(g)},disabled:J.isPending||!g.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:J.isPending?"Generating...":"Generate Invoice"})]})]})]})}),h&&e.jsx("div",{className:"fixed inset-0 bg-transparent flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Create New Invoice"}),e.jsx("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(ma,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Customer"}),e.jsxs("select",{value:N.customerId,onChange:_e=>C(Xe=>({...Xe,customerId:_e.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select a customer..."}),(mt=K==null?void 0:K.data)==null?void 0:mt.map(_e=>e.jsxs("option",{value:_e.id,children:[_e.name," ",_e.email?`(${_e.email})`:""]},_e.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Items"}),N.items.map((_e,Xe)=>e.jsxs("div",{className:"flex space-x-2 mb-2",children:[e.jsx("input",{type:"text",placeholder:"Description",value:_e.description,onChange:At=>{const st=[...N.items];st[Xe].description=At.target.value,C($t=>({...$t,items:st}))},className:"flex-1 border border-gray-300 rounded-md px-3 py-2"}),e.jsx("input",{type:"number",placeholder:"Qty",value:_e.quantity,onChange:At=>{const st=[...N.items];st[Xe].quantity=parseInt(At.target.value)||0,C($t=>({...$t,items:st}))},className:"w-20 border border-gray-300 rounded-md px-3 py-2"}),e.jsx("input",{type:"number",placeholder:"Price",value:_e.unitPrice,onChange:At=>{const st=[...N.items];st[Xe].unitPrice=parseFloat(At.target.value)||0,C($t=>({...$t,items:st}))},className:"w-24 border border-gray-300 rounded-md px-3 py-2"}),e.jsx("button",{onClick:()=>{const At=N.items.filter((st,$t)=>$t!==Xe);C(st=>({...st,items:At}))},className:"text-red-600 hover:text-red-800",children:e.jsx(hn,{className:"h-4 w-4"})})]},Xe)),e.jsx("button",{onClick:()=>{C(_e=>({..._e,items:[..._e.items,{description:"",quantity:1,unitPrice:0}]}))},className:"text-teal-600 hover:text-teal-800 text-sm",children:"+ Add Item"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Template"}),e.jsxs("select",{value:N.templateId,onChange:_e=>C(Xe=>({...Xe,templateId:_e.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2",children:[e.jsx("option",{value:"",children:"Select template (optional)"}),(Rt=se==null?void 0:se.data)==null?void 0:Rt.map(_e=>e.jsx("option",{value:_e.id,children:_e.name},_e.id))]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:()=>{N.customerId&&N.items.length>0&&L.mutate({customerId:N.customerId,items:N.items.filter(_e=>_e.description.trim()!=="").map(_e=>({..._e,totalPrice:_e.quantity*_e.unitPrice})),companyId:s,templateId:N.templateId||void 0})},disabled:L.isPending||!N.customerId||N.items.length===0,className:"px-4 py-2 bg-teal-600 text-white rounded-md hover:bg-teal-700 disabled:opacity-50",children:L.isPending?"Creating...":"Create Invoice"})]})]})]})})]})};function CFe(){const s=zs();return e.jsx(sh,{requiredRole:"admin",children:e.jsx(Kr,{title:"AI-Powered Transaction Processing",description:"Smart invoice generation and transaction analysis with advanced AI capabilities",showBreadcrumbs:!0,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Za,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900",children:"AI-Powered Processing"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Intelligent transaction analysis and automation"})]})]})}),e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Zt,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-green-900",children:"Smart Invoice Generation"}),e.jsx("p",{className:"text-sm text-green-700",children:"Template-based automated invoice creation"})]})]})}),e.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-violet-50 border border-purple-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(sa,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-purple-900",children:"Transaction Intelligence"}),e.jsx("p",{className:"text-sm text-purple-700",children:"Pattern analysis and AI recommendations"})]})]})})]}),e.jsx(SFe,{companyId:s})]})})})}function mR(s,t){if(typeof s=="function")return s(t);s!=null&&(s.current=t)}function _V(...s){return t=>{let r=!1;const n=s.map(a=>{const i=mR(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<n.length;a++){const i=n[a];typeof i=="function"?i():mR(s[a],null)}}}}function jx(...s){return x.useCallback(_V(...s),s)}var kV=x.forwardRef((s,t)=>{const{children:r,...n}=s,a=x.Children.toArray(r),i=a.find(EFe);if(i){const o=i.props.children,l=a.map(c=>c===i?x.Children.count(o)>1?x.Children.only(null):x.isValidElement(o)?o.props.children:null:c);return e.jsx(n5,{...n,ref:t,children:x.isValidElement(o)?x.cloneElement(o,void 0,l):null})}return e.jsx(n5,{...n,ref:t,children:r})});kV.displayName="Slot";var n5=x.forwardRef((s,t)=>{const{children:r,...n}=s;if(x.isValidElement(r)){const a=PFe(r);return x.cloneElement(r,{...IFe(n,r.props),ref:t?_V(t,a):a})}return x.Children.count(r)>1?x.Children.only(null):null});n5.displayName="SlotClone";var AFe=({children:s})=>e.jsx(e.Fragment,{children:s});function EFe(s){return x.isValidElement(s)&&s.type===AFe}function IFe(s,t){const r={...t};for(const n in t){const a=s[n],i=t[n];/^on[A-Z]/.test(n)?a&&i?r[n]=(...l)=>{i(...l),a(...l)}:a&&(r[n]=a):n==="style"?r[n]={...a,...i}:n==="className"&&(r[n]=[a,i].filter(Boolean).join(" "))}return{...s,...r}}function PFe(s){var n,a;let t=(n=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}var _Fe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],wy=_Fe.reduce((s,t)=>{const r=x.forwardRef((n,a)=>{const{asChild:i,...o}=n,l=i?kV:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(l,{...o,ref:a})});return r.displayName=`Primitive.${t}`,{...s,[t]:r}},{}),a5=globalThis!=null&&globalThis.document?x.useLayoutEffect:()=>{};function kFe(s,t){return x.useReducer((r,n)=>t[r][n]??r,s)}var Sy=s=>{const{present:t,children:r}=s,n=TFe(t),a=typeof r=="function"?r({present:n.isPresent}):x.Children.only(r),i=jx(n.ref,DFe(a));return typeof r=="function"||n.isPresent?x.cloneElement(a,{ref:i}):null};Sy.displayName="Presence";function TFe(s){const[t,r]=x.useState(),n=x.useRef({}),a=x.useRef(s),i=x.useRef("none"),o=s?"mounted":"unmounted",[l,c]=kFe(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return x.useEffect(()=>{const d=Tj(n.current);i.current=l==="mounted"?d:"none"},[l]),a5(()=>{const d=n.current,u=a.current;if(u!==s){const f=i.current,m=Tj(d);s?c("MOUNT"):m==="none"||(d==null?void 0:d.display)==="none"?c("UNMOUNT"):c(u&&f!==m?"ANIMATION_OUT":"UNMOUNT"),a.current=s}},[s,c]),a5(()=>{if(t){let d;const u=t.ownerDocument.defaultView??window,h=m=>{const g=Tj(n.current).includes(m.animationName);if(m.target===t&&g&&(c("ANIMATION_END"),!a.current)){const v=t.style.animationFillMode;t.style.animationFillMode="forwards",d=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=v)})}},f=m=>{m.target===t&&(i.current=Tj(n.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",h),t.addEventListener("animationend",h),()=>{u.clearTimeout(d),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",h),t.removeEventListener("animationend",h)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:x.useCallback(d=>{d&&(n.current=getComputedStyle(d)),r(d)},[])}}function Tj(s){return(s==null?void 0:s.animationName)||"none"}function DFe(s){var n,a;let t=(n=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?s.ref:(t=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?s.props.ref:s.props.ref||s.ref)}function OFe(s,t=[]){let r=[];function n(i,o){const l=x.createContext(o),c=r.length;r=[...r,o];const d=h=>{var y;const{scope:f,children:m,...p}=h,g=((y=f==null?void 0:f[s])==null?void 0:y[c])||l,v=x.useMemo(()=>p,Object.values(p));return e.jsx(g.Provider,{value:v,children:m})};d.displayName=i+"Provider";function u(h,f){var g;const m=((g=f==null?void 0:f[s])==null?void 0:g[c])||l,p=x.useContext(m);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[d,u]}const a=()=>{const i=r.map(o=>x.createContext(o));return function(l){const c=(l==null?void 0:l[s])||i;return x.useMemo(()=>({[`__scope${s}`]:{...l,[s]:c}}),[l,c])}};return a.scopeName=s,[n,RFe(a,...t)]}function RFe(...s){const t=s[0];if(s.length===1)return t;const r=()=>{const n=s.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=n.reduce((l,{useScope:c,scopeName:d})=>{const h=c(i)[`__scope${d}`];return{...l,...h}},{});return x.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}function vf(s){const t=x.useRef(s);return x.useEffect(()=>{t.current=s}),x.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function Hf(s,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(s==null||s(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function FFe(s,t){return x.useReducer((r,n)=>t[r][n]??r,s)}var $E="ScrollArea",[TV]=OFe($E),[MFe,dd]=TV($E),DV=x.forwardRef((s,t)=>{const{__scopeScrollArea:r,type:n="hover",dir:a,scrollHideDelay:i=600,...o}=s,[l,c]=x.useState(null),[d,u]=x.useState(null),[h,f]=x.useState(null),[m,p]=x.useState(null),[g,v]=x.useState(null),[y,j]=x.useState(0),[b,w]=x.useState(0),[N,C]=x.useState(!1),[S,_]=x.useState(!1),k=jx(t,A=>c(A)),F=x5(a);return e.jsx(MFe,{scope:r,type:n,dir:F,scrollHideDelay:i,scrollArea:l,viewport:d,onViewportChange:u,content:h,onContentChange:f,scrollbarX:m,onScrollbarXChange:p,scrollbarXEnabled:N,onScrollbarXEnabledChange:C,scrollbarY:g,onScrollbarYChange:v,scrollbarYEnabled:S,onScrollbarYEnabledChange:_,onCornerWidthChange:j,onCornerHeightChange:w,children:e.jsx(wy.div,{dir:F,...o,ref:k,style:{position:"relative","--radix-scroll-area-corner-width":y+"px","--radix-scroll-area-corner-height":b+"px",...s.style}})})});DV.displayName=$E;var OV="ScrollAreaViewport",RV=x.forwardRef((s,t)=>{const{__scopeScrollArea:r,children:n,nonce:a,...i}=s,o=dd(OV,r),l=x.useRef(null),c=jx(t,l,o.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),e.jsx(wy.div,{"data-radix-scroll-area-viewport":"",...i,ref:c,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...s.style},children:e.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});RV.displayName=OV;var Nu="ScrollAreaScrollbar",FV=x.forwardRef((s,t)=>{const{forceMount:r,...n}=s,a=dd(Nu,s.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=a,l=s.orientation==="horizontal";return x.useEffect(()=>(l?i(!0):o(!0),()=>{l?i(!1):o(!1)}),[l,i,o]),a.type==="hover"?e.jsx(LFe,{...n,ref:t,forceMount:r}):a.type==="scroll"?e.jsx($Fe,{...n,ref:t,forceMount:r}):a.type==="auto"?e.jsx(MV,{...n,ref:t,forceMount:r}):a.type==="always"?e.jsx(BE,{...n,ref:t}):null});FV.displayName=Nu;var LFe=x.forwardRef((s,t)=>{const{forceMount:r,...n}=s,a=dd(Nu,s.__scopeScrollArea),[i,o]=x.useState(!1);return x.useEffect(()=>{const l=a.scrollArea;let c=0;if(l){const d=()=>{window.clearTimeout(c),o(!0)},u=()=>{c=window.setTimeout(()=>o(!1),a.scrollHideDelay)};return l.addEventListener("pointerenter",d),l.addEventListener("pointerleave",u),()=>{window.clearTimeout(c),l.removeEventListener("pointerenter",d),l.removeEventListener("pointerleave",u)}}},[a.scrollArea,a.scrollHideDelay]),e.jsx(Sy,{present:r||i,children:e.jsx(MV,{"data-state":i?"visible":"hidden",...n,ref:t})})}),$Fe=x.forwardRef((s,t)=>{const{forceMount:r,...n}=s,a=dd(Nu,s.__scopeScrollArea),i=s.orientation==="horizontal",o=yw(()=>c("SCROLL_END"),100),[l,c]=FFe("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return x.useEffect(()=>{if(l==="idle"){const d=window.setTimeout(()=>c("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(d)}},[l,a.scrollHideDelay,c]),x.useEffect(()=>{const d=a.viewport,u=i?"scrollLeft":"scrollTop";if(d){let h=d[u];const f=()=>{const m=d[u];h!==m&&(c("SCROLL"),o()),h=m};return d.addEventListener("scroll",f),()=>d.removeEventListener("scroll",f)}},[a.viewport,i,c,o]),e.jsx(Sy,{present:r||l!=="hidden",children:e.jsx(BE,{"data-state":l==="hidden"?"hidden":"visible",...n,ref:t,onPointerEnter:Hf(s.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:Hf(s.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),MV=x.forwardRef((s,t)=>{const r=dd(Nu,s.__scopeScrollArea),{forceMount:n,...a}=s,[i,o]=x.useState(!1),l=s.orientation==="horizontal",c=yw(()=>{if(r.viewport){const d=r.viewport.offsetWidth<r.viewport.scrollWidth,u=r.viewport.offsetHeight<r.viewport.scrollHeight;o(l?d:u)}},10);return mg(r.viewport,c),mg(r.content,c),e.jsx(Sy,{present:n||i,children:e.jsx(BE,{"data-state":i?"visible":"hidden",...a,ref:t})})}),BE=x.forwardRef((s,t)=>{const{orientation:r="vertical",...n}=s,a=dd(Nu,s.__scopeScrollArea),i=x.useRef(null),o=x.useRef(0),[l,c]=x.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),d=zV(l.viewport,l.content),u={...n,sizes:l,onSizesChange:c,hasThumb:d>0&&d<1,onThumbChange:f=>i.current=f,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:f=>o.current=f};function h(f,m){return WFe(f,o.current,l,m)}return r==="horizontal"?e.jsx(BFe,{...u,ref:t,onThumbPositionChange:()=>{if(a.viewport&&i.current){const f=a.viewport.scrollLeft,m=fR(f,l,a.dir);i.current.style.transform=`translate3d(${m}px, 0, 0)`}},onWheelScroll:f=>{a.viewport&&(a.viewport.scrollLeft=f)},onDragScroll:f=>{a.viewport&&(a.viewport.scrollLeft=h(f,a.dir))}}):r==="vertical"?e.jsx(UFe,{...u,ref:t,onThumbPositionChange:()=>{if(a.viewport&&i.current){const f=a.viewport.scrollTop,m=fR(f,l);i.current.style.transform=`translate3d(0, ${m}px, 0)`}},onWheelScroll:f=>{a.viewport&&(a.viewport.scrollTop=f)},onDragScroll:f=>{a.viewport&&(a.viewport.scrollTop=h(f))}}):null}),BFe=x.forwardRef((s,t)=>{const{sizes:r,onSizesChange:n,...a}=s,i=dd(Nu,s.__scopeScrollArea),[o,l]=x.useState(),c=x.useRef(null),d=jx(t,c,i.onScrollbarXChange);return x.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),e.jsx($V,{"data-orientation":"horizontal",...a,ref:d,sizes:r,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":vw(r)+"px",...s.style},onThumbPointerDown:u=>s.onThumbPointerDown(u.x),onDragScroll:u=>s.onDragScroll(u.x),onWheelScroll:(u,h)=>{if(i.viewport){const f=i.viewport.scrollLeft+u.deltaX;s.onWheelScroll(f),VV(f,h)&&u.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&n({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:Kb(o.paddingLeft),paddingEnd:Kb(o.paddingRight)}})}})}),UFe=x.forwardRef((s,t)=>{const{sizes:r,onSizesChange:n,...a}=s,i=dd(Nu,s.__scopeScrollArea),[o,l]=x.useState(),c=x.useRef(null),d=jx(t,c,i.onScrollbarYChange);return x.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),e.jsx($V,{"data-orientation":"vertical",...a,ref:d,sizes:r,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":vw(r)+"px",...s.style},onThumbPointerDown:u=>s.onThumbPointerDown(u.y),onDragScroll:u=>s.onDragScroll(u.y),onWheelScroll:(u,h)=>{if(i.viewport){const f=i.viewport.scrollTop+u.deltaY;s.onWheelScroll(f),VV(f,h)&&u.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&n({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:Kb(o.paddingTop),paddingEnd:Kb(o.paddingBottom)}})}})}),[zFe,LV]=TV(Nu),$V=x.forwardRef((s,t)=>{const{__scopeScrollArea:r,sizes:n,hasThumb:a,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:l,onThumbPositionChange:c,onDragScroll:d,onWheelScroll:u,onResize:h,...f}=s,m=dd(Nu,r),[p,g]=x.useState(null),v=jx(t,k=>g(k)),y=x.useRef(null),j=x.useRef(""),b=m.viewport,w=n.content-n.viewport,N=vf(u),C=vf(c),S=yw(h,10);function _(k){if(y.current){const F=k.clientX-y.current.left,A=k.clientY-y.current.top;d({x:F,y:A})}}return x.useEffect(()=>{const k=F=>{const A=F.target;(p==null?void 0:p.contains(A))&&N(F,w)};return document.addEventListener("wheel",k,{passive:!1}),()=>document.removeEventListener("wheel",k,{passive:!1})},[b,p,w,N]),x.useEffect(C,[n,C]),mg(p,S),mg(m.content,S),e.jsx(zFe,{scope:r,scrollbar:p,hasThumb:a,onThumbChange:vf(i),onThumbPointerUp:vf(o),onThumbPositionChange:C,onThumbPointerDown:vf(l),children:e.jsx(wy.div,{...f,ref:v,style:{position:"absolute",...f.style},onPointerDown:Hf(s.onPointerDown,k=>{k.button===0&&(k.target.setPointerCapture(k.pointerId),y.current=p.getBoundingClientRect(),j.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",m.viewport&&(m.viewport.style.scrollBehavior="auto"),_(k))}),onPointerMove:Hf(s.onPointerMove,_),onPointerUp:Hf(s.onPointerUp,k=>{const F=k.target;F.hasPointerCapture(k.pointerId)&&F.releasePointerCapture(k.pointerId),document.body.style.webkitUserSelect=j.current,m.viewport&&(m.viewport.style.scrollBehavior=""),y.current=null})})})}),Gb="ScrollAreaThumb",BV=x.forwardRef((s,t)=>{const{forceMount:r,...n}=s,a=LV(Gb,s.__scopeScrollArea);return e.jsx(Sy,{present:r||a.hasThumb,children:e.jsx(qFe,{ref:t,...n})})}),qFe=x.forwardRef((s,t)=>{const{__scopeScrollArea:r,style:n,...a}=s,i=dd(Gb,r),o=LV(Gb,r),{onThumbPositionChange:l}=o,c=jx(t,h=>o.onThumbChange(h)),d=x.useRef(void 0),u=yw(()=>{d.current&&(d.current(),d.current=void 0)},100);return x.useEffect(()=>{const h=i.viewport;if(h){const f=()=>{if(u(),!d.current){const m=HFe(h,l);d.current=m,l()}};return l(),h.addEventListener("scroll",f),()=>h.removeEventListener("scroll",f)}},[i.viewport,u,l]),e.jsx(wy.div,{"data-state":o.hasThumb?"visible":"hidden",...a,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:Hf(s.onPointerDownCapture,h=>{const m=h.target.getBoundingClientRect(),p=h.clientX-m.left,g=h.clientY-m.top;o.onThumbPointerDown({x:p,y:g})}),onPointerUp:Hf(s.onPointerUp,o.onThumbPointerUp)})});BV.displayName=Gb;var UE="ScrollAreaCorner",UV=x.forwardRef((s,t)=>{const r=dd(UE,s.__scopeScrollArea),n=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&n?e.jsx(VFe,{...s,ref:t}):null});UV.displayName=UE;var VFe=x.forwardRef((s,t)=>{const{__scopeScrollArea:r,...n}=s,a=dd(UE,r),[i,o]=x.useState(0),[l,c]=x.useState(0),d=!!(i&&l);return mg(a.scrollbarX,()=>{var h;const u=((h=a.scrollbarX)==null?void 0:h.offsetHeight)||0;a.onCornerHeightChange(u),c(u)}),mg(a.scrollbarY,()=>{var h;const u=((h=a.scrollbarY)==null?void 0:h.offsetWidth)||0;a.onCornerWidthChange(u),o(u)}),d?e.jsx(wy.div,{...n,ref:t,style:{width:i,height:l,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...s.style}}):null});function Kb(s){return s?parseInt(s,10):0}function zV(s,t){const r=s/t;return isNaN(r)?0:r}function vw(s){const t=zV(s.viewport,s.content),r=s.scrollbar.paddingStart+s.scrollbar.paddingEnd,n=(s.scrollbar.size-r)*t;return Math.max(n,18)}function WFe(s,t,r,n="ltr"){const a=vw(r),i=a/2,o=t||i,l=a-o,c=r.scrollbar.paddingStart+o,d=r.scrollbar.size-r.scrollbar.paddingEnd-l,u=r.content-r.viewport,h=n==="ltr"?[0,u]:[u*-1,0];return qV([c,d],h)(s)}function fR(s,t,r="ltr"){const n=vw(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-a,o=t.content-t.viewport,l=i-n,c=r==="ltr"?[0,o]:[o*-1,0],d=PC(s,c);return qV([0,o],[0,l])(d)}function qV(s,t){return r=>{if(s[0]===s[1]||t[0]===t[1])return t[0];const n=(t[1]-t[0])/(s[1]-s[0]);return t[0]+n*(r-s[0])}}function VV(s,t){return s>0&&s<t}var HFe=(s,t=()=>{})=>{let r={left:s.scrollLeft,top:s.scrollTop},n=0;return function a(){const i={left:s.scrollLeft,top:s.scrollTop},o=r.left!==i.left,l=r.top!==i.top;(o||l)&&t(),r=i,n=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(n)};function yw(s,t){const r=vf(s),n=x.useRef(0);return x.useEffect(()=>()=>window.clearTimeout(n.current),[]),x.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(r,t)},[r,t])}function mg(s,t){const r=vf(t);a5(()=>{let n=0;if(s){const a=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(r)});return a.observe(s),()=>{window.cancelAnimationFrame(n),a.unobserve(s)}}},[s,r])}var GFe=DV,KFe=RV,YFe=UV;function LS({className:s,children:t,...r}){return e.jsxs(GFe,{"data-slot":"scroll-area",className:ns("relative",s),...r,children:[e.jsx(KFe,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),e.jsx(JFe,{}),e.jsx(YFe,{})]})}function JFe({className:s,orientation:t="vertical",...r}){return e.jsx(FV,{"data-slot":"scroll-area-scrollbar",orientation:t,className:ns("flex touch-none p-px transition-colors select-none",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",s),...r,children:e.jsx(BV,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}function XFe({companyId:s,onNavigate:t,showQuickActions:r=!0,showRecentEntries:n=!0,showSummary:a=!0}){var j,b,w,N;const{isAuthenticated:i}=Ua(),o=s||zs(),[l,c]=x.useState("overview"),{data:d,isLoading:u}=ys({queryKey:["journal-hub-summary",o],queryFn:()=>de.getJournalSummary({companyId:o}),enabled:!!o&&i}),{data:h,isLoading:f}=ys({queryKey:["journal-recent-entries",o],queryFn:()=>de.getJournalEntries({pageSize:5,sortBy:"createdAt",sortOrder:"desc"}),enabled:!!o&&i&&n}),{data:m,isLoading:p}=ys({queryKey:["journal-pending-approvals",o],queryFn:()=>de.getPendingApprovals(),enabled:!!o&&i}),g=C=>{t?t(C):window.location.href=C},v=C=>{switch(C){case"POSTED":return e.jsx(bs,{className:"w-4 h-4 text-green-500"});case"DRAFT":return e.jsx(ln,{className:"w-4 h-4 text-blue-500"});case"PENDING_APPROVAL":return e.jsx(Cr,{className:"w-4 h-4 text-yellow-500"});case"REVERSED":return e.jsx(Ln,{className:"w-4 h-4 text-red-500"});default:return e.jsx(Zt,{className:"w-4 h-4 text-gray-500"})}},y=C=>{switch(C){case"POSTED":return"bg-green-100 text-green-800";case"DRAFT":return"bg-blue-100 text-blue-800";case"PENDING_APPROVAL":return"bg-yellow-100 text-yellow-800";case"REVERSED":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return i?e.jsxs("div",{className:"space-y-6",children:[a&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Entries"}),e.jsx("p",{className:"text-2xl font-bold",children:u?"...":(d==null?void 0:d.totalEntries)||0})]}),e.jsx(ml,{className:"w-8 h-8 text-blue-500"})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending Approval"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:p?"...":((j=m==null?void 0:m.pendingApprovals)==null?void 0:j.length)||0})]}),e.jsx(Cr,{className:"w-8 h-8 text-yellow-500"})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Draft Entries"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:u?"...":(d==null?void 0:d.draftEntries)||0})]}),e.jsx(ln,{className:"w-8 h-8 text-blue-500"})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Posted Today"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:u?"...":(d==null?void 0:d.postedToday)||0})]}),e.jsx(bs,{className:"w-8 h-8 text-green-500"})]})})})]}),e.jsxs(an,{value:l,onValueChange:c,className:"w-full",children:[e.jsxs(on,{className:"grid w-full grid-cols-3",children:[e.jsx(vt,{value:"overview",children:"Overview"}),e.jsx(vt,{value:"recent",children:"Recent Entries"}),e.jsx(vt,{value:"approvals",children:"Approvals"})]}),e.jsx(yt,{value:"overview",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r&&e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Za,{className:"w-5 h-5"}),"Quick Actions"]})}),e.jsxs(ie,{className:"space-y-3",children:[e.jsxs(I,{onClick:()=>g("/dashboard/journal-hub"),className:"w-full justify-start",variant:"outline",children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Create New Entry"]}),e.jsxs(I,{onClick:()=>g("/dashboard/journal-hub?tab=templates"),className:"w-full justify-start",variant:"outline",children:[e.jsx(Zt,{className:"w-4 h-4 mr-2"}),"Use Template"]}),e.jsxs(I,{onClick:()=>g("/dashboard/enhanced-journal-management"),className:"w-full justify-start",variant:"outline",children:[e.jsx(ml,{className:"w-4 h-4 mr-2"}),"Smart Journal Management"]}),e.jsxs(I,{onClick:()=>g("/dashboard/journal-hub?tab=reports"),className:"w-full justify-start",variant:"outline",children:[e.jsx(lr,{className:"w-4 h-4 mr-2"}),"View Reports"]})]})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx($s,{className:"w-5 h-5"}),"Entry Types"]})}),e.jsx(ie,{children:u?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx(Ts,{className:"w-4 h-4 animate-spin"})}):e.jsx("div",{className:"space-y-2",children:((b=d==null?void 0:d.entryTypes)==null?void 0:b.map(C=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:C.name}),e.jsx(Oe,{variant:"secondary",children:C.count})]},C.id)))||e.jsx("p",{className:"text-sm text-gray-500",children:"No entry types found"})})})]})]})}),e.jsx(yt,{value:"recent",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Cr,{className:"w-5 h-5"}),"Recent Journal Entries"]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>g("/dashboard/journal-hub"),children:["View All",e.jsx(Nm,{className:"w-4 h-4 ml-1"})]})]})}),e.jsx(ie,{children:f?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx(Ts,{className:"w-4 h-4 animate-spin"})}):e.jsx("div",{className:"space-y-3",children:((w=h==null?void 0:h.entries)==null?void 0:w.map(C=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[v(C.status),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:C.reference}),e.jsx("p",{className:"text-xs text-gray-500",children:C.memo}),e.jsxs("p",{className:"text-xs text-gray-400",children:[new Date(C.date).toLocaleDateString(),C.entryType&&`  ${C.entryType.name}`]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:y(C.status),children:C.status.replace("_"," ")}),e.jsxs("span",{className:"text-sm font-medium",children:["$",C.totalAmount.toFixed(2)]})]})]},C.id)))||e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No recent entries found"})})})]})}),e.jsx(yt,{value:"approvals",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Cr,{className:"w-5 h-5"}),"Pending Approvals"]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>g("/dashboard/journal-hub?tab=approvals"),children:["View All",e.jsx(Nm,{className:"w-4 h-4 ml-1"})]})]})}),e.jsx(ie,{children:p?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx(Ts,{className:"w-4 h-4 animate-spin"})}):e.jsx("div",{className:"space-y-3",children:((N=(m==null?void 0:m.pendingApprovals)||[])==null?void 0:N.map(C=>{var S,_,k;return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Cr,{className:"w-4 h-4 text-yellow-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:(S=C.entry)==null?void 0:S.reference}),e.jsx("p",{className:"text-xs text-gray-500",children:(_=C.entry)==null?void 0:_.memo}),e.jsxs("p",{className:"text-xs text-gray-400",children:["Requested by ",(k=C.requestedBy)==null?void 0:k.name]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"bg-yellow-100 text-yellow-800",children:"Pending"}),e.jsx(I,{size:"sm",variant:"outline",children:e.jsx(ir,{className:"w-4 h-4"})})]})]},C.id)}))||e.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No pending approvals"})})})]})})]})]}):null}const Gd=s=>{const t=typeof s=="string"?parseFloat(s):s;return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t||0)},Ru=s=>{const t=[/\$\s*([0-9,]+\.?[0-9]*)/g,/([0-9,]+\.?[0-9]*)\s*dollars?/gi,/([0-9,]+\.?[0-9]*)\s*usd/gi,/amount[:\s]+\$?([0-9,]+\.?[0-9]*)/gi,/paid\s+\$?([0-9,]+\.?[0-9]*)/gi,/received\s+\$?([0-9,]+\.?[0-9]*)/gi];for(const r of t){const n=Array.from(s.matchAll(r));if(n.length>0){const a=n[0][1].replace(/,/g,""),i=parseFloat(a);if(!isNaN(i)&&i>0)return i}}return null},xR=s=>{const t=s.toLowerCase();return/\b(paid|payment|pay|expense|spent|cost|bill|invoice)\b/.test(t)?/\b(rent|utilities|salary|wage|office|supplies|equipment|maintenance|insurance|legal|consulting|advertising|travel|fuel|repair)\b/.test(t)?"expense":"payment":/\b(received|receipt|income|revenue|earned|collect|deposit|refund)\b/.test(t)?(/\b(customer|client|service|consulting|sales|commission|interest|dividend)\b/.test(t),"receipt"):/\b(purchase|bought|buy|acquired|order|procurement)\b/.test(t)?"purchase":/\b(sale|sold|sell|revenue|invoice|billing)\b/.test(t)?"sale":/\b(from|received|income|revenue)\b/.test(t)?"receipt":(/\b(to|paid|expense|cost)\b/.test(t),"expense")},QFe=s=>{if(!s||s.trim().length<3)return!1;const t=[/^[a-z]+$/i,/^[0-9]+$/,/^(.)\1{2,}$/,/^(test|abc|nnn|zzz|xxx)$/i];for(const a of t)if(a.test(s.trim()))return!1;const r=["paid","received","purchase","sale","rent","salary","expense","income","revenue","cost","fee","service","product","invoice","bill","payment","cash","check","transfer","deposit","withdrawal","refund","discount"],n=s.toLowerCase();return r.some(a=>n.includes(a))};function ZFe(){var $e,O;const[s,t]=x.useState(()=>typeof window<"u"&&(localStorage.getItem("company_id")||localStorage.getItem("companyId")||localStorage.getItem("company"))||""),[r,n]=x.useState("integration"),[a,i]=x.useState([]),[o,l]=x.useState([]),[c,d]=x.useState([]),[u,h]=x.useState([]),[f,m]=x.useState(!1),[p,g]=x.useState(null),[v,y]=x.useState({description:"",amount:"",category:"",vendor:"",customer:"",transactionType:""}),[j,b]=x.useState({date:new Date().toISOString().split("T")[0],reference:"",description:"",entries:[{accountId:"",debit:0,credit:0,description:""}]}),[w,N]=x.useState([]),[C,S]=x.useState(!1);x.useEffect(()=>{k()},[s]);const _=async()=>{try{const te=[{code:"ASSET",name:"Asset"},{code:"LIABILITY",name:"Liability"},{code:"REVENUE",name:"Revenue"},{code:"EXPENSE",name:"Expense"},{code:"EQUITY",name:"Equity"}],re={};for(const Z of te)try{const X=(await de.get(`/api/account-types?companyId=${s}`)).find(ce=>ce.code===Z.code);if(X)re[Z.code]=X.id;else{const ce=await de.post("/api/account-types",{...Z,companyId:s});re[Z.code]=ce.id}}catch(K){console.log(`Account type ${Z.name} creation handled:`,K)}const le=[{name:"Cash",code:"1110",typeCode:"ASSET"},{name:"Accounts Receivable",code:"1120",typeCode:"ASSET"},{name:"Equipment",code:"1300",typeCode:"ASSET"},{name:"Accounts Payable",code:"2100",typeCode:"LIABILITY"},{name:"Bank Loan",code:"2101",typeCode:"LIABILITY"},{name:"Credit Card Payable",code:"2102",typeCode:"LIABILITY"},{name:"Accrued Expenses",code:"2103",typeCode:"LIABILITY"},{name:"Owner Equity",code:"3000",typeCode:"EQUITY"},{name:"Sales Revenue",code:"4000",typeCode:"REVENUE"},{name:"Office Expenses",code:"5000",typeCode:"EXPENSE"},{name:"Rent Expense",code:"5001",typeCode:"EXPENSE"}];for(const Z of le)try{const K=await de.get(`/api/accounts?companyId=${s}`);let X=[];K!=null&&K.flat?X=K.flat:K!=null&&K.data?X=K.data:Array.isArray(K)&&(X=K),!X.find(Y=>Y.code===Z.code)&&re[Z.typeCode]&&(await de.post("/api/accounts",{name:Z.name,code:Z.code,typeId:re[Z.typeCode],companyId:s}),console.log(`Created account: ${Z.name}`))}catch(K){console.log(`Account ${Z.name} creation handled:`,K)}}catch(te){console.log("Basic accounts creation handled:",te)}},k=async()=>{m(!0),console.log(" Loading data for company:",s);try{await _();const[te,re,le,Z,K]=await Promise.all([de.get(`/api/enhanced-journal-management/entries/${s}`),de.get(`/api/accounts?companyId=${s}`),de.get(`/api/enhanced-journal-management/ledger-balances/${s}`),de.get(`/api/enhanced-journal-management/anomalies/${s}`),de.get(`/api/enhanced-journal-management/stats/${s}`)]),ce=(Array.isArray(te)?te:(te==null?void 0:te.data)||[]).map(ve=>{var dt,pt;const Le=ve.memo||ve.description||"",Me=ve.lines||ve.entries||[],tt=((dt=ve.lines)==null?void 0:dt.reduce((qe,mt)=>qe+(parseFloat(String(mt.debit))||0),0))||0,fe=((pt=ve.lines)==null?void 0:pt.reduce((qe,mt)=>qe+(parseFloat(String(mt.credit))||0),0))||0,ct=Math.abs(tt-fe)<.01;return{...ve,description:Le,entries:Me,totalDebit:tt,totalCredit:fe,isBalanced:ct}});i(ce);let Y=[];re!=null&&re.flat?Y=re.flat:re!=null&&re.data?Y=re.data:Array.isArray(re)&&(Y=re),l(Y||[]);let ue=[];le!=null&&le.data?ue=le.data:Array.isArray(le)&&(ue=le),d(ue||[]),h(Z.data||[]),g(K.data)}catch(te){console.error("Error loading data:",te)}finally{m(!1)}},F=async()=>{var le,Z,K,X,ce,Y,ue;if(!v.description){ze.error("Please enter a transaction description");return}let te=v.amount;if(!te||te===""||te==="0"){const ve=Ru(v.description);if(ve)te=ve.toString(),y(Le=>({...Le,amount:te})),ze.success(`Amount detected: $${ve.toLocaleString()}`,{duration:2e3});else{ze.error('Please specify the transaction amount (e.g., "Paid $500" or enter amount manually)');return}}if(!QFe(v.description)){ze.error('Please provide a meaningful transaction description (e.g., "Paid rent", "Received payment")');return}const re=parseFloat(te.toString());if(isNaN(re)||re<=0){ze.error("Please enter a valid positive amount");return}if(re>1e6){ze.error("Amount seems unusually high. Please verify.");return}m(!0),ze.loading("Creating journal entry...",{id:"ai-processing"});try{const ve=await de.post("/api/enhanced-journal-management/create",{description:v.description,amount:re,companyId:s,context:{category:v.category,vendor:v.vendor,customer:v.customer,transactionType:v.transactionType,autoExtractedAmount:Ru(v.description)!==null,descriptionLength:v.description.length,processingLevel:"senior",validationPassed:!0}});ze.dismiss("ai-processing");const Le=ve==null?void 0:ve.data,Me=(Le==null?void 0:Le.reference)||(Le==null?void 0:Le.id)||`Entry-${Date.now()}`,tt=((le=Le==null?void 0:Le.lines)==null?void 0:le.length)||((Z=Le==null?void 0:Le.entries)==null?void 0:Z.length)||2;if(ze.success("Journal Entry Created Successfully!",{duration:3e3}),((K=Le==null?void 0:Le.lines)==null?void 0:K.length)>0){const fe=Le.lines.reduce((dt,pt)=>dt+(parseFloat(String(pt.debit))||0),0),ct=Le.lines.map(dt=>{var Rt;const pt=((Rt=dt.account)==null?void 0:Rt.name)||dt.accountName||"Account",qe=parseFloat(String(dt.debit))||0,mt=parseFloat(String(dt.credit))||0;return qe>0?`${pt} (Debit: $${qe.toLocaleString()})`:mt>0?`${pt} (Credit: $${mt.toLocaleString()})`:pt}).join("  ");ze.success(`Entry #${Me.split("-").pop()}  ${ct}`,{duration:5e3})}y({description:"",amount:"",category:"",vendor:"",customer:"",transactionType:""}),M(!1),L(!1),N([]),S(!1),z([]),await k()}catch(ve){ze.dismiss("ai-processing");const Le=((ce=(X=ve==null?void 0:ve.response)==null?void 0:X.data)==null?void 0:ce.error)||((ue=(Y=ve==null?void 0:ve.response)==null?void 0:Y.data)==null?void 0:ue.message)||(ve==null?void 0:ve.message)||"Unknown error occurred";Le.includes("Account")&&Le.includes("does not exist")?ze.error("Could not find suitable accounts. Please check your chart of accounts."):Le.includes("validation failed")?ze.error("Transaction validation failed. Please review your entry."):Le.includes("timeout")||Le.includes("unavailable")?ze.error("Service temporarily unavailable. Please try again."):Le.includes("meaningless")||Le.includes("invalid")?ze.error("Please provide a more detailed transaction description."):Le.includes("Network Error")||Le.includes("fetch")?ze.error("Connection error. Please check your internet and try again."):ze.error(`Failed to create entry: ${Le}`)}finally{m(!1)}},[A,T]=x.useState(!1),[V,M]=x.useState(!1),[G,L]=x.useState(!1),[J,z]=x.useState([]),U=te=>{z(re=>re.includes(te)?re.filter(le=>le!==te):[...re,te])},oe=async()=>{var re,le,Z;if(J.length===0){ze.error("Please select at least one account suggestion");return}const te=w.filter(K=>J.includes(K.accountCode));m(!0),ze.loading("Creating entry with your selected accounts...",{id:"selected-processing"});try{const K=await de.post("/api/enhanced-journal-management/create",{description:v.description,amount:parseFloat(v.amount.toString()),companyId:s,context:{category:v.category,vendor:v.vendor,customer:v.customer,transactionType:v.transactionType,processingLevel:"user-guided",selectedAccountSuggestions:te,useSelectedSuggestions:!0}});ze.dismiss("selected-processing");const X=K==null?void 0:K.data,ce=(X==null?void 0:X.reference)||(X==null?void 0:X.id)||`Entry-${Date.now()}`;if(ze.success(" Entry Created with Your Selected Accounts!",{duration:3e3}),((re=X==null?void 0:X.lines)==null?void 0:re.length)>0){const Y=X.lines.map(ve=>{var fe;const Le=((fe=ve.account)==null?void 0:fe.name)||ve.accountName||"Account",Me=parseFloat(String(ve.debit))||0,tt=parseFloat(String(ve.credit))||0;return Me>0?`${Le} (Debit: $${Me.toLocaleString()})`:tt>0?`${Le} (Credit: $${tt.toLocaleString()})`:Le}).join("  ");ze.success(` Saved: ${Y}`,{duration:6e3});const ue=te.map(ve=>ve.accountName).join(", ");ze.info(` You selected: ${ue}`,{duration:4e3})}y({description:"",amount:"",category:"",vendor:"",customer:"",transactionType:""}),M(!1),L(!1),z([]),S(!1),N([]),await k()}catch(K){ze.dismiss("selected-processing");const X=((Z=(le=K==null?void 0:K.response)==null?void 0:le.data)==null?void 0:Z.error)||(K==null?void 0:K.message)||"Failed to create journal entry";ze.error(`Failed to create entry: ${X}`)}finally{m(!1)}},Q=async()=>{if(!v.description||!v.amount){ze.error("Please enter description and amount first");return}T(!0);try{const te=await de.post("/api/enhanced-journal-management/account-suggestions",{description:v.description,amount:parseFloat(v.amount),companyId:s,context:{category:v.category,vendor:v.vendor,customer:v.customer,transactionType:v.transactionType}}),re=Array.isArray(te)?te:(te==null?void 0:te.data)||[];N(re),S(!0),re.length>0?ze.success(`Found ${re.length} account suggestions!`):ze.error("No account suggestions found for this transaction")}catch{ze.error("Failed to get account suggestions. Please try again.")}finally{T(!1)}},P=async()=>{var le,Z;if(!j.date||!j.reference||!j.description){ze.error("Validation Error: Date, reference, and description are required");return}const te=j.entries.reduce((K,X)=>K+(X.debit||0),0),re=j.entries.reduce((K,X)=>K+(X.credit||0),0);if(Math.abs(te-re)>.01){ze.error(`Validation Error: Journal entries must be balanced. Debit: $${te.toFixed(2)}, Credit: $${re.toFixed(2)}`);return}m(!0);try{const K=await de.post("/api/enhanced-journal-management/manual",{date:j.date,reference:j.reference,description:j.description,companyId:s,entries:j.entries});ze.success(` Manual journal entry created: ${j.reference}`),b({date:new Date().toISOString().split("T")[0],reference:"",description:"",entries:[{accountId:"",debit:0,credit:0,description:""}]}),k()}catch(K){console.error("Error creating manual journal entry:",K),ze.error(` Manual Entry Failed: ${((Z=(le=K==null?void 0:K.response)==null?void 0:le.data)==null?void 0:Z.error)||(K==null?void 0:K.message)||"Failed to create manual journal entry"}`)}finally{m(!1)}},q=()=>{b(te=>({...te,entries:[...te.entries,{accountId:"",debit:0,credit:0,description:""}]}))},D=te=>{j.entries.length>1&&b(re=>({...re,entries:re.entries.filter((le,Z)=>Z!==te)}))},se=te=>{const re=c.find(le=>le.accountId===te);return(re==null?void 0:re.currentBalance)||0},he=()=>{if(!j.date||!j.reference||!j.description||j.entries.filter(Z=>Z.accountId&&Z.accountId.trim()!==""&&(Z.debit&&Z.debit>0||Z.credit&&Z.credit>0)).length<2)return!1;const re=j.entries.reduce((Z,K)=>Z+(K.debit||0),0),le=j.entries.reduce((Z,K)=>Z+(K.credit||0),0);return Math.abs(re-le)<.01},be=(te,re,le)=>{b(Z=>({...Z,entries:Z.entries.map((K,X)=>X===te?{...K,[re]:le}:K)}))},pe=async te=>{try{await de.post(`/api/enhanced-journal-management/post/${te}`,{postedBy:"demo-user-id"}),k()}catch(re){console.error("Error posting journal entry:",re)}},Ae=async te=>{const re=prompt("Please provide a reason for voiding this entry:");if(re)try{await de.post(`/api/enhanced-journal-management/void/${te}`,{voidedBy:"demo-user-id",reason:re}),k()}catch(le){console.error("Error voiding journal entry:",le)}},Ee=te=>{switch(te){case"draft":return e.jsx(Oe,{variant:"secondary",children:"Draft"});case"POSTED":return e.jsx(Oe,{variant:"default",children:"Posted"});case"VOIDED":return e.jsx(Oe,{variant:"destructive",children:"Voided"});default:return e.jsx(Oe,{variant:"outline",children:te})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight bg-gradient-to-r from-gray-900 to-gray-600 bg-clip-text text-transparent",children:"Enhanced Journal Management"}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"AI-powered journal entry creation and advanced ledger management"}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{children:"AI Assistant Active"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsx("span",{children:"Real-time Sync"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs(rt,{value:s,onValueChange:t,children:[e.jsx(nt,{className:"w-48 bg-white shadow-sm",children:e.jsx(it,{placeholder:"Select Company"})}),e.jsxs(at,{children:[e.jsx(W,{value:"seed-company-1",children:"Uruti Hub Limited"}),e.jsx(W,{value:"seed-company-2",children:"Acme Trading Co"})]})]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:k,disabled:f,children:[e.jsx(Ts,{className:`w-4 h-4 mr-2 ${f?"animate-spin":""}`}),"Refresh"]})]})]}),p&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(ne,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200 hover:shadow-lg transition-all duration-200",children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium text-blue-700",children:"Total Entries"}),e.jsx(Xn,{className:"h-5 w-5 text-blue-600"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-3xl font-bold text-blue-900",children:p.entries.total}),e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[p.entries.draft," draft, ",p.entries.posted," posted"]})]})]}),e.jsxs(ne,{className:"bg-gradient-to-br from-green-50 to-green-100 border-green-200 hover:shadow-lg transition-all duration-200",children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium text-green-700",children:"Total Debits"}),e.jsx(bs,{className:"h-5 w-5 text-green-600"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-3xl font-bold text-green-900",children:Gd(p.amounts.totalDebit)}),e.jsx("p",{className:"text-xs text-green-600 mt-1",children:"All debit transactions"})]})]}),e.jsxs(ne,{className:"bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200 hover:shadow-lg transition-all duration-200",children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium text-purple-700",children:"Total Credits"}),e.jsx(nc,{className:"h-5 w-5 text-purple-600"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-3xl font-bold text-purple-900",children:Gd(p.amounts.totalCredit)}),e.jsx("p",{className:"text-xs text-purple-600 mt-1",children:"All credit transactions"})]})]}),e.jsxs(ne,{className:"bg-gradient-to-br from-amber-50 to-amber-100 border-amber-200 hover:shadow-lg transition-all duration-200",children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium text-amber-700",children:"Anomalies"}),e.jsx(Is,{className:"h-5 w-5 text-amber-600"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-3xl font-bold text-amber-900",children:u.length}),e.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:[u.filter(te=>te.severity==="critical").length," critical"]})]})]})]}),e.jsxs(an,{value:r,onValueChange:n,className:"space-y-6",children:[e.jsxs(on,{className:"grid w-full grid-cols-2 lg:grid-cols-5 bg-gray-100 p-1 rounded-lg",children:[e.jsxs(vt,{value:"integration",className:"data-[state=active]:bg-white data-[state=active]:shadow-sm flex items-center justify-center gap-2",children:[e.jsx(ml,{className:"w-4 h-4"}),e.jsx("span",{children:"Journal Hub"})]}),e.jsxs(vt,{value:"ai-create",className:"data-[state=active]:bg-white data-[state=active]:shadow-sm flex items-center justify-center gap-2",children:[e.jsx(sa,{className:"w-4 h-4"}),e.jsx("span",{children:"AI Creation"})]}),e.jsxs(vt,{value:"manual",className:"data-[state=active]:bg-white data-[state=active]:shadow-sm flex items-center justify-center gap-2",children:[e.jsx(ln,{className:"w-4 h-4"}),e.jsx("span",{children:"Manual Entry"})]}),e.jsxs(vt,{value:"entries",className:"data-[state=active]:bg-white data-[state=active]:shadow-sm flex items-center justify-center gap-2",children:[e.jsx(Zt,{className:"w-4 h-4"}),e.jsx("span",{children:"Journal Entries"})]}),e.jsxs(vt,{value:"ledger",className:"data-[state=active]:bg-white data-[state=active]:shadow-sm flex items-center justify-center gap-2",children:[e.jsx(lr,{className:"w-4 h-4"}),e.jsx("span",{children:"Ledger"})]})]}),e.jsx(yt,{value:"integration",className:"space-y-6",children:e.jsx(XFe,{companyId:s,showQuickActions:!0,showRecentEntries:!0,showSummary:!0})}),e.jsx(yt,{value:"ai-create",className:"space-y-8",children:e.jsxs(ne,{className:"relative overflow-hidden border-2 border-blue-200 bg-gradient-to-br from-blue-50 via-white to-purple-50",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-bl from-blue-100 to-transparent rounded-full -translate-y-16 translate-x-16"}),e.jsxs(we,{className:"pb-6 relative",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl shadow-md",children:e.jsx(sa,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx(Se,{className:"text-2xl bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"AI-Powered Journal Creation"}),e.jsx("p",{className:"text-muted-foreground text-base",children:"Describe your transaction in plain English and let AI handle the accounting"})]})]})}),e.jsxs(Oe,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200 px-3 py-1",children:[e.jsx(Za,{className:"w-3 h-3 mr-1"}),"Smart Mode"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-4",children:[e.jsx("div",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-medium",children:" Auto-detect amounts"}),e.jsx("div",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium",children:" Smart account suggestions"}),e.jsx("div",{className:"px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-medium",children:" Auto-balance entries"})]})]}),e.jsx(ie,{className:"space-y-8 relative",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-blue-100 rounded-md",children:e.jsx(Zt,{className:"w-4 h-4 text-blue-600"})}),e.jsx(B,{htmlFor:"description",className:"text-sm font-semibold text-gray-800",children:"Transaction Description"})]}),e.jsx("div",{className:"relative",children:e.jsx(Xs,{id:"description",placeholder:" Try: 'Paid $500 rent to ABC Properties', 'Received $2000 from customer XYZ', 'Bought office supplies for $150'",value:v.description,onChange:te=>{const re=te.target.value;y(X=>({...X,description:re})),C&&Math.abs(re.length-v.description.length)>5&&(N([]),S(!1),z([]),ze.info("Suggestions cleared - transaction changed",{duration:2e3}));const le=Ru(re),Z=Ru(v.description);if(le){const X=parseFloat(v.amount||"0");(!v.amount||v.amount==="0"||v.amount===""||Z&&Z===X||V)&&le.toString()!==v.amount&&(y(Y=>({...Y,amount:le.toString()})),M(!0))}else Z&&!le&&V&&(y(X=>({...X,amount:""})),M(!1));const K=xR(re);K&&(G||!v.transactionType)&&K!==v.transactionType&&(y(X=>({...X,transactionType:K})),L(!0))},className:"min-h-[100px] resize-none border-gray-300 focus:border-blue-500 focus:ring-blue-500"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(B,{htmlFor:"amount",className:"text-sm font-medium text-gray-700",children:["Amount ",e.jsx("span",{className:"text-xs text-gray-400",children:"(optional if included in description)"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),e.jsx(ge,{id:"amount",type:"number",step:"0.01",placeholder:"0.00",value:v.amount,onChange:te=>{const re=te.target.value;y(X=>({...X,amount:re}));const le=Ru(v.description);le&&parseFloat(re)!==le&&M(!1);const Z=parseFloat(v.amount||"0"),K=parseFloat(re||"0");C&&Z>0&&Math.abs(K-Z)>Z*.1&&(N([]),S(!1),z([]),ze.info("Suggestions cleared - amount changed",{duration:2e3}))},className:`pl-10 pr-20 py-3 border-gray-200 focus:border-emerald-400 focus:ring-emerald-400/20 rounded-xl bg-white/80 backdrop-blur-sm shadow-sm hover:shadow-md transition-all duration-200 text-gray-800 font-medium ${V&&v.amount&&Ru(v.description)&&(($e=Ru(v.description))==null?void 0:$e.toString())===v.amount?"bg-green-50/80 border-green-300 ring-green-200/50":""}`}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 flex items-center gap-2",children:V&&v.amount&&Ru(v.description)&&((O=Ru(v.description))==null?void 0:O.toString())===v.amount?e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"px-2 py-1 bg-green-100 rounded-md flex items-center gap-1",children:[e.jsx(Np,{className:"w-3 h-3 text-green-600"}),e.jsx("span",{className:"text-xs font-medium text-green-700",children:"Auto"})]})}):e.jsx("div",{className:"px-2 py-1 bg-emerald-50 rounded-md",children:e.jsx("span",{className:"text-xs font-medium text-emerald-700",children:"USD"})})})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full"}),e.jsx("span",{className:"text-xs text-gray-600",children:"Leave empty for AI auto-detection from description"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1 bg-orange-100 rounded-md",children:e.jsx(EY,{className:"w-3 h-3 text-orange-600"})}),e.jsx(B,{htmlFor:"category",className:"text-sm font-medium text-gray-700",children:"Category"})]}),e.jsx(ge,{id:"category",placeholder:"e.g., Office Supplies",value:v.category,onChange:te=>y(re=>({...re,category:te.target.value})),className:"border-gray-200 focus:border-orange-400 focus:ring-orange-400/20 rounded-lg"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1 bg-purple-100 rounded-md",children:e.jsx(vn,{className:"w-3 h-3 text-purple-600"})}),e.jsx(B,{htmlFor:"vendor",className:"text-sm font-medium text-gray-700",children:"Vendor/Payee"})]}),e.jsx(ge,{id:"vendor",placeholder:"e.g., ABC Company",value:v.vendor,onChange:te=>y(re=>({...re,vendor:te.target.value})),className:"border-gray-200 focus:border-purple-400 focus:ring-purple-400/20 rounded-lg"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1 bg-indigo-100 rounded-md",children:e.jsx(YF,{className:"w-3 h-3 text-indigo-600"})}),e.jsx(B,{htmlFor:"transactionType",className:"text-sm font-medium text-gray-700",children:"Transaction Type"}),G&&e.jsxs("div",{className:"px-2 py-1 bg-green-100 rounded-md flex items-center gap-1",children:[e.jsx(Np,{className:"w-3 h-3 text-green-600"}),e.jsx("span",{className:"text-xs font-medium text-green-700",children:"Auto"})]})]}),e.jsxs(rt,{value:v.transactionType,onValueChange:te=>{y(re=>({...re,transactionType:te})),te!==xR(v.description)&&L(!1)},children:[e.jsx(nt,{className:`border-gray-200 focus:border-indigo-400 focus:ring-indigo-400/20 rounded-lg ${G?"bg-green-50/50 border-green-300 ring-green-200/50":""}`,children:e.jsx(it,{placeholder:"Select type"})}),e.jsxs(at,{children:[e.jsx(W,{value:"expense",children:" Expense (Company spends money)"}),e.jsx(W,{value:"receipt",children:" Receipt (Company receives money)"}),e.jsx(W,{value:"purchase",children:" Purchase (Buy assets/inventory)"}),e.jsx(W,{value:"payment",children:" Payment (Pay bills/vendors)"}),e.jsx(W,{value:"sale",children:" Sale (Revenue from customers)"})]})]})]})]}),C&&w.length>0&&e.jsxs(ne,{className:"border-green-200 bg-gradient-to-br from-green-50 to-white mt-4",children:[e.jsxs(we,{className:"pb-4",children:[e.jsxs(Se,{className:"flex items-center gap-2 text-lg",children:[e.jsx(sa,{className:"w-5 h-5 text-green-600"})," Smart Account Suggestions - Choose Your Accounts"]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[e.jsxs("div",{className:"text-sm text-green-600",children:["Selected: ",J.length," of ",w.length," suggestions"]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>z(w.map(te=>te.accountCode)),className:"text-xs",children:"Select All"}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>z([]),className:"text-xs",children:"Clear All"})]})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"space-y-4",children:w.map((te,re)=>{const le=J.includes(te.accountCode);return e.jsxs("div",{className:`flex items-start justify-between p-4 border rounded-lg cursor-pointer transition-all ${le?"border-blue-300 bg-blue-50 shadow-md":"border-green-200 bg-white hover:shadow-md"}`,onClick:()=>U(te.accountCode),children:[e.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[e.jsx("input",{type:"checkbox",checked:le,onChange:()=>U(te.accountCode),className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-medium text-gray-900 mb-1 flex items-center",children:[te.accountName,le&&e.jsx("span",{className:"ml-2 text-blue-600",children:" Selected"})]}),e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:["Code: ",e.jsx("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:te.accountCode})," | Confidence: ",e.jsxs("span",{className:"font-semibold text-green-600",children:[(te.confidence*100).toFixed(1),"%"]})]}),e.jsx("div",{className:"text-sm text-gray-700 bg-gray-50 p-2 rounded border-l-4 border-green-400",children:te.reasoning})]})]}),e.jsx(Oe,{variant:"outline",className:"ml-4 bg-green-50 text-green-700 border-green-200",children:te.suggestedCategory})]},re)})}),e.jsx("div",{className:"mt-6 pt-4 border-t border-green-200",children:e.jsxs("div",{className:"flex gap-3 flex-wrap",children:[e.jsx(I,{onClick:oe,disabled:J.length===0||f,className:"bg-green-600 hover:bg-green-700 text-white",children:f?e.jsxs(e.Fragment,{children:[e.jsx(Ts,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating with Selected Accounts..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ro,{className:"w-4 h-4 mr-2"}),"Create Entry with Selected Accounts (",J.length,")"]})}),e.jsxs(I,{onClick:F,disabled:f,variant:"outline",className:"border-blue-300 text-blue-700 hover:bg-blue-50",children:[e.jsx(sa,{className:"w-4 h-4 mr-2"}),"Let System Choose All Accounts"]}),e.jsxs(I,{onClick:()=>{N([]),S(!1),z([]),ze.success("Suggestions cleared",{duration:2e3})},variant:"outline",size:"sm",className:"border-gray-300 text-gray-600 hover:bg-gray-50",children:[e.jsx(nc,{className:"w-4 h-4 mr-2"}),"Clear Suggestions"]})]})})]})]}),e.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-md",children:e.jsx("p",{className:"text-xs text-blue-700 mt-1",children:C&&w.length>0?"Choose specific accounts from suggestions OR let the system select automatically":"Get smart account suggestions first to review options, or create entry directly for automatic selection"})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4 border-t border-gray-200",children:[e.jsx(I,{onClick:Q,disabled:A,variant:"outline",className:"flex-1 sm:flex-none bg-white hover:bg-gray-50 border-gray-300 text-gray-700 hover:text-gray-900",children:A?e.jsxs(e.Fragment,{children:[e.jsx(Ts,{className:"w-4 h-4 mr-2 animate-spin"}),"Getting Suggestions..."]}):e.jsxs(e.Fragment,{children:[e.jsx(sa,{className:"w-4 h-4 mr-2"}),"Get Smart Suggestions"]})}),e.jsx(I,{onClick:F,disabled:f,className:"flex-1 sm:flex-none bg-blue-600 hover:bg-blue-700",children:f?e.jsxs(e.Fragment,{children:[e.jsx(Ts,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Create Journal Entry"]})})]})]})})]})}),e.jsx(yt,{value:"manual",className:"space-y-8",children:e.jsxs(ne,{className:"relative overflow-hidden border-2 border-indigo-200 bg-gradient-to-br from-indigo-50 via-white to-blue-50",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gradient-to-bl from-indigo-100 to-transparent rounded-full -translate-y-16 translate-x-16"}),e.jsxs(we,{className:"pb-6 relative",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-indigo-500 to-blue-600 rounded-xl shadow-md",children:e.jsx(bY,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx(Se,{className:"text-2xl bg-gradient-to-r from-indigo-600 to-blue-600 bg-clip-text text-transparent",children:"Manual Journal Entry"}),e.jsx("p",{className:"text-muted-foreground text-base",children:"Create precise double-entry bookkeeping transactions with full control"})]})]})}),e.jsx("div",{className:"flex items-center gap-2",children:f?e.jsxs(Oe,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200 px-3 py-1",children:[e.jsx(Ts,{className:"w-3 h-3 mr-1 animate-spin"}),"Loading accounts"]}):o.length>0?e.jsxs(Oe,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200 px-3 py-1",children:[e.jsx(bs,{className:"w-3 h-3 mr-1"}),o.length," accounts ready"]}):e.jsxs(Oe,{variant:"outline",className:"bg-red-50 text-red-700 border-red-200 px-3 py-1",children:[e.jsx(Ln,{className:"w-3 h-3 mr-1"}),"No accounts found"]})})]}),!f&&o.length===0&&e.jsx("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Is,{className:"w-4 h-4 text-yellow-600"}),e.jsx("span",{className:"text-sm text-yellow-700",children:"No chart of accounts found. Please reload or contact support."})]}),e.jsxs(I,{onClick:k,size:"sm",variant:"outline",className:"text-yellow-700 border-yellow-300 hover:bg-yellow-100",children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Reload Accounts"]})]})})]}),e.jsxs(ie,{className:"space-y-8 relative",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1 bg-blue-100 rounded-md",children:e.jsx(Xn,{className:"w-3 h-3 text-blue-600"})}),e.jsx(B,{htmlFor:"manual-date",className:"text-sm font-medium text-gray-700",children:"Transaction Date"})]}),e.jsx(ge,{id:"manual-date",type:"date",value:j.date,onChange:te=>b(re=>({...re,date:te.target.value})),className:"border-gray-200 focus:border-blue-400 focus:ring-blue-400/20 rounded-lg"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1 bg-purple-100 rounded-md",children:e.jsx(xY,{className:"w-3 h-3 text-purple-600"})}),e.jsx(B,{htmlFor:"manual-reference",className:"text-sm font-medium text-gray-700",children:"Reference Number"})]}),e.jsx(ge,{id:"manual-reference",placeholder:"e.g., JE-001, INV-2024-001",value:j.reference,onChange:te=>b(re=>({...re,reference:te.target.value})),className:"border-gray-200 focus:border-purple-400 focus:ring-purple-400/20 rounded-lg"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1 bg-green-100 rounded-md",children:e.jsx(Zt,{className:"w-3 h-3 text-green-600"})}),e.jsx(B,{htmlFor:"manual-description",className:"text-sm font-medium text-gray-700",children:"Entry Description"})]}),e.jsx(ge,{id:"manual-description",placeholder:"e.g., Office equipment purchase, Monthly rent payment",value:j.description,onChange:te=>b(re=>({...re,description:te.target.value})),className:"border-gray-200 focus:border-green-400 focus:ring-green-400/20 rounded-lg"})]})]}),e.jsx("div",{className:"w-full h-px bg-gradient-to-r from-transparent via-gray-200 to-transparent my-8"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(B,{children:"Journal Lines"}),e.jsxs(I,{onClick:q,size:"sm",children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Add Line"]})]}),j.entries.map((te,re)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 items-end",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Account"}),e.jsxs(rt,{value:te.accountId,onValueChange:le=>be(re,"accountId",le),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select account"})}),e.jsx(at,{children:f?e.jsx(W,{value:"loading",disabled:!0,children:"Loading accounts..."}):o.length===0?e.jsx(W,{value:"no-accounts",disabled:!0,children:"No accounts available"}):o.map(le=>e.jsxs(W,{value:le.id,children:[le.code," - ",le.name]},le.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Debit"}),e.jsx(ge,{type:"number",step:"0.01",value:te.debit,onChange:le=>be(re,"debit",parseFloat(le.target.value)||0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Credit"}),e.jsx(ge,{type:"number",step:"0.01",value:te.credit,onChange:le=>be(re,"credit",parseFloat(le.target.value)||0)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Description"}),e.jsx(ge,{value:te.description,onChange:le=>be(re,"description",le.target.value)})]}),e.jsx(I,{onClick:()=>D(re),variant:"outline",size:"sm",disabled:j.entries.length===1,children:e.jsx(IY,{className:"h-4 w-4"})})]},re)),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[!he()&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Is,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{children:!j.date||!j.reference||!j.description?"Fill in required fields":j.entries.filter(te=>te.accountId&&(te.debit&&te.debit>0||te.credit&&te.credit>0)).length<2?"Add at least 2 valid entries":"Balance your entries"})]}),he()&&e.jsxs("div",{className:"flex items-center gap-2 text-green-600",children:[e.jsx(bs,{className:"w-4 h-4"}),e.jsx("span",{children:"Ready to create entry"})]})]}),e.jsx(I,{onClick:P,disabled:f||!he(),className:!he()&&!f?"opacity-50 cursor-not-allowed":"",children:f?"Creating...":"Create Manual Entry"})]})]})]})]})}),e.jsx(yt,{value:"entries",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Journal Entries"})}),e.jsx(ie,{children:e.jsx(LS,{className:"h-96",children:e.jsx("div",{className:"space-y-4",children:f?e.jsxs("div",{className:"flex items-center justify-center p-8",children:[e.jsx(Ts,{className:"w-6 h-6 animate-spin mr-2"}),e.jsx("span",{children:"Loading journal entries..."})]}):a.length===0?e.jsxs("div",{className:"text-center p-8 text-muted-foreground",children:[e.jsx(Zt,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No journal entries found"}),e.jsx("p",{className:"text-sm",children:"Create your first entry using the AI Creation or Manual Entry tabs"})]}):a.map(te=>{var re,le;return e.jsx(ne,{children:e.jsxs(ie,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[Ee(te.status),e.jsx("span",{className:"font-medium",children:te.reference})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:["Status: ",te.status]}),((re=te.status)==null?void 0:re.toLowerCase())==="draft"&&e.jsx(I,{onClick:()=>pe(te.id),size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Post"}),((le=te.status)==null?void 0:le.toLowerCase())==="posted"&&e.jsx(I,{onClick:()=>Ae(te.id),size:"sm",variant:"outline",children:"Void"})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:te.description}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:[e.jsxs("div",{children:["Debit: ",Gd(te.totalDebit)]}),e.jsxs("div",{children:["Credit: ",Gd(te.totalCredit)]}),e.jsxs("div",{children:["Balance: ",te.isBalanced?"":""]})]}),te.entries&&te.entries.length>0&&e.jsxs("div",{className:"mt-3 bg-gray-50 p-3 rounded-md",children:[e.jsx("div",{className:"text-sm font-medium mb-2 text-gray-700",children:" Accounts Used:"}),e.jsx("div",{className:"space-y-2",children:te.entries.map((Z,K)=>{var ue;const X=((ue=Z.account)==null?void 0:ue.name)||Z.accountName||`Account ${Z.accountId}`,ce=parseFloat(String(Z.debit))||0,Y=parseFloat(String(Z.credit))||0;return e.jsxs("div",{className:"text-sm flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[ce>0&&e.jsx("span",{className:"text-red-600 font-medium",children:"Dr."}),Y>0&&e.jsx("span",{className:"text-green-600 font-medium",children:"Cr."}),e.jsx("span",{className:"font-medium",children:X})]}),e.jsxs("div",{className:"text-right",children:[ce>0&&e.jsx("span",{className:"text-red-600 font-medium",children:Gd(ce)}),Y>0&&e.jsx("span",{className:"text-green-600 font-medium",children:Gd(Y)})]})]},K)})}),e.jsx("div",{className:"mt-2 pt-2 border-t border-gray-200 text-xs text-gray-500",children:" Dr. = Debit (money going out/assets increasing) | Cr. = Credit (money coming in/liabilities increasing)"})]})]})},te.id)})})})})]})}),e.jsxs(yt,{value:"ledger",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center justify-between",children:["Chart of Accounts",e.jsxs(Oe,{variant:"outline",className:"text-xs",children:[o.length," accounts"]})]})}),e.jsx(ie,{children:e.jsx(LS,{className:"h-96",children:e.jsx("div",{className:"space-y-2",children:o.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("div",{className:"text-sm",children:"No accounts found"}),e.jsx("div",{className:"text-xs mt-1",children:"Accounts will be created automatically when needed"})]}):o.map(te=>{var re;return e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:te.name}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Code: ",te.code," | Type: ",typeof te.type=="string"?te.type:((re=te.type)==null?void 0:re.name)||"Unknown"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-medium",children:Gd(se(te.id))}),e.jsx(Oe,{variant:te.isActive?"default":"secondary",children:te.isActive?"Active":"Inactive"})]})]},te.id)})})})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center justify-between",children:["Ledger Balances",e.jsxs(Oe,{variant:"outline",className:"text-xs",children:[c.length," balances"]})]})}),e.jsx(ie,{children:e.jsx(LS,{className:"h-96",children:e.jsx("div",{className:"space-y-2",children:c.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("div",{className:"text-sm",children:"No ledger balances found"}),e.jsx("div",{className:"text-xs mt-1",children:"Balances will be calculated from journal entries"})]}):c.map(te=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:te.accountName||"Unknown Account"}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Code: ",te.accountCode||"N/A"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-medium",children:Gd(te.currentBalance||0)}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["D: ",Gd(te.periodDebit||0)," C: ",Gd(te.periodCredit||0)]})]})]},te.accountId))})})})]})]}),u.length>0&&e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Detected Anomalies"})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-2",children:u.map((te,re)=>e.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:te.description}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Type: ",te.type]})]}),e.jsx(Oe,{variant:te.severity==="critical"?"destructive":"secondary",children:te.severity})]},re))})})]})]})]})]})}function eMe(){return e.jsx(sh,{children:e.jsx(Kr,{children:e.jsx(ZFe,{})})})}class tMe{getHeaders(){return{Authorization:`Bearer ${localStorage.getItem("auth_token")||""}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","Content-Type":"application/json"}}async getCreditNotes(t){const r=new URLSearchParams;t.search&&r.set("q",t.search),t.status&&r.set("status",t.status),t.customerId&&r.set("customerId",t.customerId),t.dateFrom&&r.set("dateFrom",t.dateFrom),t.dateTo&&r.set("dateTo",t.dateTo),t.page&&r.set("page",t.page.toString()),t.pageSize&&r.set("pageSize",t.pageSize.toString());const n=await fetch(`${qi.api.baseUrl}/api/credit-notes/${t.companyId}?${r.toString()}`,{method:"GET",headers:this.getHeaders()});if(!n.ok)throw new Error(`Failed to fetch credit notes: ${n.statusText}`);return n.json()}async getCreditNote(t,r){const n=await fetch(`${qi.api.baseUrl}/api/credit-notes/${t}/${r}`,{method:"GET",headers:this.getHeaders()});if(!n.ok)throw new Error(`Failed to fetch credit note: ${n.statusText}`);return n.json()}async createCreditNote(t,r){const n=await fetch(`${qi.api.baseUrl}/api/credit-notes/${t}`,{method:"POST",headers:this.getHeaders(),body:JSON.stringify(r)});if(!n.ok)throw new Error(`Failed to create credit note: ${n.statusText}`);return n.json()}async updateCreditNote(t,r,n){const a=await fetch(`${qi.api.baseUrl}/api/credit-notes/${t}/${r}`,{method:"PUT",headers:this.getHeaders(),body:JSON.stringify(n)});if(!a.ok)throw new Error(`Failed to update credit note: ${a.statusText}`);return a.json()}async deleteCreditNote(t,r){const n=await fetch(`${qi.api.baseUrl}/api/credit-notes/${t}/${r}`,{method:"DELETE",headers:this.getHeaders()});if(!n.ok)throw new Error(`Failed to delete credit note: ${n.statusText}`);return n.json()}async approveCreditNote(t,r){return this.updateCreditNote(t,r,{reason:"Approved"})}async rejectCreditNote(t,r,n){return this.updateCreditNote(t,r,{reason:`Rejected: ${n}`})}async applyCreditNote(t,r,n){return this.updateCreditNote(t,r,{reason:`Applied to invoice ${n}`})}}const $S=new tMe;function sMe(){var Q,P,q;const{ready:s}=gu("credit-notes-page"),t=hi(),[r,n]=x.useState("all"),[a,i]=x.useState(""),[o,l]=x.useState("all"),[c,d]=x.useState(!1),[u,h]=x.useState(!1),[f,m]=x.useState(null),[p,g]=x.useState({reason:"",notes:"",terms:"",customerId:void 0,lines:[{description:"",quantity:1,unitPrice:0}]}),[v,y]=x.useState(""),{data:j}=ys({queryKey:["companies"],queryFn:async()=>{const D=await de.getCompanies();return Array.isArray(D)?D:(D==null?void 0:D.data)||[]},enabled:s}),b=r!=="all"?r:Array.isArray(j)&&j.length>0?(Q=j[0])==null?void 0:Q.id:"",{data:w,isLoading:N,error:C}=ys({queryKey:["invoices",b],queryFn:async()=>{if(!b)return[];const D=await de.getInvoices({companyId:b,pageSize:100});return D.items||D.data||[]},enabled:s&&!!b}),{data:S}=ys({queryKey:["customers",b],queryFn:async()=>b?(await de.getCustomers({companyId:b,pageSize:100})).items||[]:[],enabled:s&&!!b}),{data:_,isLoading:k}=ys({queryKey:["credit-notes",b,a,o],queryFn:async()=>b?await $S.getCreditNotes({companyId:b,search:a||void 0,status:o!=="all"?o:void 0}):{data:[]},enabled:s&&!!b}),F=x.useMemo(()=>(_==null?void 0:_.data)||[],[_]),A=Rs({mutationFn:async D=>{if(!b)throw new Error("No company selected");return await $S.createCreditNote(b,{...D,invoiceId:v&&v!=="none"?v:void 0})},onSuccess:()=>{t.invalidateQueries({queryKey:["credit-notes"]}),d(!1),g({reason:"",notes:"",terms:"",customerId:void 0,lines:[{description:"",quantity:1,unitPrice:0}]}),y("none")},onError:D=>{console.error("Error creating credit note:",D)}}),T=Rs({mutationFn:async D=>{if(!b)throw new Error("No company selected");return await $S.deleteCreditNote(b,D)},onSuccess:()=>{t.invalidateQueries({queryKey:["credit-notes"]})}}),V=D=>{const se={draft:{color:"bg-gray-100 text-gray-800",icon:Zt},sent:{color:"bg-blue-100 text-blue-800",icon:Cr},viewed:{color:"bg-yellow-100 text-yellow-800",icon:ir},approved:{color:"bg-green-100 text-green-800",icon:bs},rejected:{color:"bg-red-100 text-red-800",icon:nc},applied:{color:"bg-purple-100 text-purple-800",icon:bs},cancelled:{color:"bg-gray-100 text-gray-800",icon:nc}},he=se[D]||se.draft,be=he.icon;return e.jsxs(Oe,{className:he.color,children:[e.jsx(be,{className:"w-3 h-3 mr-1"}),D.charAt(0).toUpperCase()+D.slice(1)]})},M=()=>{p.reason&&p.lines.length>0&&A.mutate(p)},G=D=>{m(D),h(!0)},L=D=>{confirm("Are you sure you want to delete this credit note?")&&T.mutate(D)},J=()=>{g(D=>({...D,lines:[...D.lines,{description:"",quantity:1,unitPrice:0}]}))},z=D=>{g(se=>({...se,lines:se.lines.filter((he,be)=>be!==D)}))},U=(D,se,he)=>{g(be=>({...be,lines:be.lines.map((pe,Ae)=>Ae===D?{...pe,[se]:he}:pe)}))},oe=D=>{if(D==="none"){y(""),g(se=>({...se,lines:[{description:"",quantity:1,unitPrice:0}]}));return}if(y(D),D&&w){const se=w.find(he=>he.id===D);if(se&&(g(he=>({...he,customerId:se.customerId})),se.lines)){const he=se.lines.map(be=>{var pe;return{description:be.description||"Credit for: "+(((pe=be.product)==null?void 0:pe.name)||"Item"),quantity:be.quantity,unitPrice:be.unitPrice,taxRate:be.taxRate||0,discountRate:be.discountRate||0,productId:be.productId}});g(be=>({...be,lines:he.length>0?he:[{description:"",quantity:1,unitPrice:0}]}))}}};return e.jsx(Kr,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Credit Notes"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage customer credit notes and returns"})]}),e.jsxs(I,{onClick:()=>d(!0),className:"flex items-center gap-2",children:[e.jsx(Ss,{className:"w-4 h-4"}),"New Credit Note"]})]}),e.jsx(ne,{children:e.jsx(ie,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"relative flex-1 min-w-64",children:[e.jsx(Rn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(ge,{placeholder:"Search credit notes...",value:a,onChange:D=>i(D.target.value),className:"pl-10"})]}),e.jsxs(rt,{value:r,onValueChange:n,children:[e.jsx(nt,{className:"w-52",children:e.jsx(it,{placeholder:"All Companies"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Companies"}),Array.isArray(j)?j.map(D=>e.jsx(W,{value:D.id,children:D.name},D.id)):null]})]}),e.jsxs(rt,{value:o,onValueChange:l,children:[e.jsx(nt,{className:"w-40",children:e.jsx(it,{placeholder:"All Status"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Status"}),e.jsx(W,{value:"draft",children:"Draft"}),e.jsx(W,{value:"sent",children:"Sent"}),e.jsx(W,{value:"viewed",children:"Viewed"}),e.jsx(W,{value:"approved",children:"Approved"}),e.jsx(W,{value:"rejected",children:"Rejected"}),e.jsx(W,{value:"applied",children:"Applied"}),e.jsx(W,{value:"cancelled",children:"Cancelled"})]})]})]})})}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Credit Notes"}),e.jsxs("span",{className:"text-sm font-normal text-gray-500",children:[F.length," credit note",F.length!==1?"s":""]})]})}),e.jsx(ie,{children:k?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):F.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Zt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No credit notes found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Get started by creating your first credit note."}),e.jsxs(I,{onClick:()=>d(!0),children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Create Credit Note"]})]}):e.jsxs(Ol,{children:[e.jsx(Rl,{children:e.jsxs(Dn,{children:[e.jsx(_s,{children:"Credit Note #"}),e.jsx(_s,{children:"Status"}),e.jsx(_s,{children:"Invoice"}),e.jsx(_s,{children:"Customer"}),e.jsx(_s,{children:"Date"}),e.jsx(_s,{children:"Reason"}),e.jsx(_s,{children:"Amount"}),e.jsx(_s,{children:"Actions"})]})}),e.jsx(Fl,{children:F.map(D=>e.jsxs(Dn,{className:"hover:bg-gray-50",children:[e.jsx(Cs,{className:"font-medium",children:D.creditNoteNumber}),e.jsx(Cs,{children:V(D.status)}),e.jsx(Cs,{children:D.invoice?e.jsx("span",{className:"text-blue-600 hover:underline cursor-pointer",children:D.invoice.invoiceNumber}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx(Cs,{children:D.customer?e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:D.customer.name}),D.customer.email&&e.jsx("div",{className:"text-sm text-gray-500",children:D.customer.email})]}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx(Cs,{children:Kn(new Date(D.issueDate),"MMM dd, yyyy")}),e.jsx(Cs,{className:"truncate max-w-xs",title:D.reason,children:D.reason||"-"}),e.jsx(Cs,{className:"font-medium",children:new Intl.NumberFormat("en-US",{style:"currency",currency:D.currency||"USD"}).format(D.totalAmount||0)}),e.jsx(Cs,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>G(D),className:"h-8 w-8 p-0",children:e.jsx(ir,{className:"w-4 h-4"})}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>L(D.id),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",disabled:T.isPending,children:e.jsx(hn,{className:"w-4 h-4"})})]})})]},D.id))})]})})]}),e.jsx(ts,{open:c,onOpenChange:d,children:e.jsxs(ss,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(as,{children:e.jsx(is,{children:"Create New Credit Note"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Reason *"}),e.jsx(ge,{value:p.reason,onChange:D=>g(se=>({...se,reason:D.target.value})),placeholder:"Reason for credit note"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Customer"}),e.jsxs(rt,{value:p.customerId||"none",onValueChange:D=>g(se=>({...se,customerId:D==="none"?void 0:D})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select customer..."})}),e.jsxs(at,{children:[e.jsx(W,{value:"none",children:"No customer selected"}),S&&S.length>0?S.map(D=>e.jsx(W,{value:D.id,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:D.name}),D.email&&e.jsx("span",{className:"text-sm text-gray-500",children:D.email})]})},D.id)):e.jsx("div",{className:"px-2 py-1 text-sm text-gray-500",children:"No customers available"})]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Select Invoice (Optional)"}),e.jsxs(rt,{value:v,onValueChange:oe,children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Choose an invoice..."})}),e.jsxs(at,{children:[e.jsx(W,{value:"none",children:"No invoice selected"}),w&&w.length>0?w.map(D=>{var se;return e.jsx(W,{value:D.id,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:D.invoiceNumber}),e.jsxs("span",{className:"text-sm text-gray-500",children:[((se=D.customer)==null?void 0:se.name)||"Unknown Customer"," ",new Intl.NumberFormat("en-US",{style:"currency",currency:D.currency||"USD"}).format(D.totalAmount||0)," ",Kn(new Date(D.issueDate),"MMM dd, yyyy")]})]})},D.id)}):e.jsx("div",{className:"px-2 py-1 text-sm text-gray-500",children:N?"Loading invoices...":C?`Error loading invoices: ${C.message}`:"No invoices available for this company"})]})]}),v&&v!=="none"&&e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsx("p",{className:"text-xs text-green-600",children:" Invoice selected - Credit note lines will be auto-populated"}),e.jsx(I,{type:"button",variant:"ghost",size:"sm",onClick:()=>{y("none"),g(D=>({...D,lines:[{description:"",quantity:1,unitPrice:0}]}))},className:"h-6 px-2 text-xs text-gray-500 hover:text-gray-700",children:"Clear"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Notes"}),e.jsx(Xs,{value:p.notes||"",onChange:D=>g(se=>({...se,notes:D.target.value})),placeholder:"Additional notes",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-1 block",children:"Terms"}),e.jsx(Xs,{value:p.terms||"",onChange:D=>g(se=>({...se,terms:D.target.value})),placeholder:"Payment terms",rows:3})]})]}),v&&v!=="none"&&w&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Selected Invoice Details"}),(()=>{var se,he;const D=w.find(be=>be.id===v);return D?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Invoice #:"}),e.jsx("span",{className:"ml-2",children:D.invoiceNumber})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Customer:"}),e.jsx("span",{className:"ml-2",children:((se=D.customer)==null?void 0:se.name)||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Total Amount:"}),e.jsx("span",{className:"ml-2",children:new Intl.NumberFormat("en-US",{style:"currency",currency:D.currency||"USD"}).format(D.totalAmount||0)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Issue Date:"}),e.jsx("span",{className:"ml-2",children:Kn(new Date(D.issueDate),"MMM dd, yyyy")})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Status:"}),e.jsx("span",{className:"ml-2 capitalize",children:D.status})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-blue-700 font-medium",children:"Lines:"}),e.jsxs("span",{className:"ml-2",children:[((he=D.lines)==null?void 0:he.length)||0," items"]})]})]}):null})()]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Credit Note Lines *"}),e.jsxs(I,{type:"button",variant:"outline",size:"sm",onClick:J,className:"flex items-center gap-2",children:[e.jsx(Ss,{className:"w-4 h-4"}),"Add Line"]})]}),e.jsx("div",{className:"space-y-3",children:p.lines.map((D,se)=>e.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end p-3 border rounded-lg",children:[e.jsxs("div",{className:"col-span-5",children:[e.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"Description"}),e.jsx(ge,{value:D.description,onChange:he=>U(se,"description",he.target.value),placeholder:"Item description"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"Quantity"}),e.jsx(ge,{type:"number",value:D.quantity,onChange:he=>U(se,"quantity",parseFloat(he.target.value)||0),placeholder:"1"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"Unit Price"}),e.jsx(ge,{type:"number",step:"0.01",value:D.unitPrice,onChange:he=>U(se,"unitPrice",parseFloat(he.target.value)||0),placeholder:"0.00"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"text-xs text-gray-600 mb-1 block",children:"Total"}),e.jsx(ge,{value:(D.quantity*D.unitPrice).toFixed(2),disabled:!0,className:"bg-gray-50"})]}),e.jsx("div",{className:"col-span-1",children:e.jsx(I,{type:"button",variant:"ghost",size:"sm",onClick:()=>z(se),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",disabled:p.lines.length===1,children:e.jsx(hn,{className:"w-4 h-4"})})})]},se))})]}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-medium",children:"Total Amount:"}),e.jsx("span",{className:"text-lg font-bold",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(p.lines.reduce((D,se)=>D+se.quantity*se.unitPrice,0))})]})}),(!p.reason||p.lines.length===0)&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[!p.reason&&"Please provide a reason for the credit note. ",p.lines.length===0&&"Please add at least one line item."]})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(I,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),e.jsx(I,{onClick:M,disabled:!p.reason||p.lines.length===0||A.isPending,className:"min-w-[140px]",children:A.isPending?e.jsxs(e.Fragment,{children:[e.jsx(On,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Create Credit Note"]})})]})]})]})}),e.jsx(ts,{open:u,onOpenChange:h,children:e.jsxs(ss,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(as,{children:e.jsx(is,{children:"Credit Note Details"})}),f&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Credit Note Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Credit Note #:"}),e.jsx("span",{className:"font-medium",children:f.creditNoteNumber})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Status:"}),V(f.status)]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Issue Date:"}),e.jsx("span",{children:Kn(new Date(f.issueDate),"MMM dd, yyyy")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total Amount:"}),e.jsx("span",{className:"font-bold",children:new Intl.NumberFormat("en-US",{style:"currency",currency:f.currency||"USD"}).format(f.totalAmount)})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Related Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Customer:"}),e.jsx("span",{children:((P=f.customer)==null?void 0:P.name)||"-"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Invoice:"}),e.jsx("span",{children:((q=f.invoice)==null?void 0:q.invoiceNumber)||"-"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Reason:"}),e.jsx("span",{className:"text-right max-w-48",children:f.reason||"-"})]})]})]})]}),f.lines&&f.lines.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Credit Note Lines"}),e.jsxs(Ol,{children:[e.jsx(Rl,{children:e.jsxs(Dn,{children:[e.jsx(_s,{children:"Description"}),e.jsx(_s,{children:"Quantity"}),e.jsx(_s,{children:"Unit Price"}),e.jsx(_s,{children:"Total"})]})}),e.jsx(Fl,{children:f.lines.map((D,se)=>e.jsxs(Dn,{children:[e.jsx(Cs,{children:D.description}),e.jsx(Cs,{children:D.quantity}),e.jsx(Cs,{children:new Intl.NumberFormat("en-US",{style:"currency",currency:f.currency||"USD"}).format(D.unitPrice)}),e.jsx(Cs,{className:"font-medium",children:new Intl.NumberFormat("en-US",{style:"currency",currency:f.currency||"USD"}).format(D.totalAmount)})]},se))})]})]}),(f.notes||f.terms)&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.notes&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Notes"}),e.jsx("p",{className:"text-gray-600 text-sm",children:f.notes})]}),f.terms&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Terms"}),e.jsx("p",{className:"text-gray-600 text-sm",children:f.terms})]})]}),e.jsx("div",{className:"flex justify-end gap-3 pt-4 border-t",children:e.jsx(I,{variant:"outline",onClick:()=>h(!1),children:"Close"})})]})]})})]})})}function rMe(){var Q,P;const[s,t]=x.useState(()=>zs()),[r,n]=x.useState([]),[a,i]=x.useState(""),[o,l]=x.useState([]),[c,d]=x.useState(!1),[u,h]=x.useState(null),[f,m]=x.useState(null),[p,g]=x.useState(null),[v,y]=x.useState(""),[j,b]=x.useState(""),[w,N]=x.useState(""),[C,S]=x.useState([]),[_,k]=x.useState([]);x.useEffect(()=>{const q=()=>{const se=zs();se&&se!==s&&(console.log(" Period Close page - Company changed from",s,"to",se),t(se))};window.addEventListener("storage",q);const D=se=>{const he=se.detail.companyId;he&&he!==s&&(console.log(" Period Close page - Company changed via custom event from",s,"to",he),t(he))};return window.addEventListener("companyChanged",D),()=>{window.removeEventListener("storage",q),window.removeEventListener("companyChanged",D)}},[s]),x.useEffect(()=>{s&&F()},[s]),x.useEffect(()=>{a&&M()},[a]);async function F(){try{await de.getDemoToken("demo_user",["admin","accountant"]),A()}catch(q){console.error("Failed to get demo token:",q),A()}}async function A(){var q,D;console.log(`Loading periods for company: ${s}`),d(!0),h(null);try{const se=await _u.listPeriods(s);console.log("Periods API response:",se);let he=[];se!=null&&se.data&&Array.isArray(se.data)?he=se.data:Array.isArray(se)&&(he=se),console.log("Processed periods data:",he),n(he),he.length>0&&((q=he[0])!=null&&q.period)?(console.log(`Auto-selecting first period: ${he[0].period}`),i(he[0].period),T(he[0].period)):console.log("No periods available for auto-selection")}catch(se){if(console.error("Error loading periods:",se),(D=se==null?void 0:se.message)!=null&&D.includes("<!DOCTYPE")){h("API endpoint not found. Please check if the backend is running.");const he=[{period:"2024-01",status:"open"},{period:"2024-02",status:"locked"},{period:"2024-03",status:"closed"}];n(he),i(he[0].period),T(he[0].period)}else h((se==null?void 0:se.message)||"Failed to load periods")}finally{d(!1)}}async function T(q){try{const D=await _u.getChecklist(s,q);let se=[];D!=null&&D.data&&Array.isArray(D.data)?se=D.data:Array.isArray(D)&&(se=D),l(se)}catch(D){console.error("Failed to load checklist:",D),l([{id:"1",title:"Bank reconciliations complete",completed:!1,order:1},{id:"2",title:"Accruals and deferrals posted",completed:!0,order:2},{id:"3",title:"Intercompany reconciled",completed:!1,order:3},{id:"4",title:"Revenue recognition posted",completed:!0,order:4}])}}async function V(q,D){try{await _u.updateChecklist(s,a,q,{completed:D}),T(a)}catch(se){console.error("Failed to update checklist item:",se),h((se==null?void 0:se.message)||"Failed to update checklist item")}}async function M(){try{const q=await _u.getRuns(s,a);console.log("Runs API response:",q);let D=[];q!=null&&q.data&&Array.isArray(q.data)?D=q.data:Array.isArray(q)&&(D=q);const se=D.map(he=>{const be=he.type||"unknown",pe=he.payload||{},Ae={recurring:"Recurring Journals",allocations:"Allocations","fx-reval":"FX Revaluation"};let Ee="success";pe.error||pe.status==="error"?Ee="error":pe.status==="pending"&&(Ee="pending");let $e="";return be==="recurring"?$e=`Posted ${pe.posted||0} recurring entries`:be==="allocations"?$e=`Processed ${pe.allocationsPosted||0} allocations`:be==="fx-reval"?$e=`Posted ${pe.entriesPosted||0} FX revaluation entries`:$e="Period close process executed",{id:he.id,name:Ae[be]||be,description:$e,status:Ee,duration:"1.2s",type:be,at:he.at}});console.log("Transformed runs:",se),k(se)}catch(q){console.error("Failed to load runs:",q),k([{id:"1",name:"Recurring Journals",description:"Monthly recurring entries",status:"success",duration:"2.3s"},{id:"2",name:"Allocations",description:"Overhead allocations",status:"success",duration:"1.8s"},{id:"3",name:"FX Revaluation",description:"Foreign exchange revaluation",status:"error",duration:"0.5s"}])}}async function G(){if(!a){console.log("No period selected for start close");return}console.log(`Starting close for period: ${a}, company: ${s}`),d(!0),h(null);try{const q=await _u.startClose(s,a);console.log("Start close result:",q),await A(),await T(a),await M(),console.log("Period close started successfully")}catch(q){console.error("Start close error:",q),h((q==null?void 0:q.message)||"Failed to start period close")}finally{d(!1)}}async function L(){if(!a){console.log("No period selected for complete close");return}console.log(`Completing close for period: ${a}, company: ${s}`),d(!0),h(null);try{const q=await _u.completeClose(s,a);console.log("Complete close result:",q),await A(),await T(a),await M(),console.log("Period close completed successfully")}catch(q){console.error("Complete close error:",q),h((q==null?void 0:q.message)||"Failed to complete period close")}finally{d(!1)}}async function J(){if(a){d(!0);try{const q=await _u.runRecurring(s,a);console.log("Recurring journals result:",q),await M(),console.log("Recurring journals executed successfully")}catch(q){h((q==null?void 0:q.message)||"Failed to run recurring journals")}finally{d(!1)}}}async function z(){if(a){d(!0);try{const q=await _u.runAllocations(s,a);console.log("Allocations result:",q),await M(),console.log("Allocations executed successfully")}catch(q){h((q==null?void 0:q.message)||"Failed to run allocations")}finally{d(!1)}}}async function U(){if(a){d(!0);try{const q=await _u.runFxReval(s,a,"USD");console.log("FX revaluation result:",q),await M(),console.log("FX revaluation executed successfully")}catch(q){h((q==null?void 0:q.message)||"Failed to run FX revaluation")}finally{d(!1)}}}const oe=q=>{switch(q){case"open":return e.jsx(Oe,{variant:"default",children:"Open"});case"locked":return e.jsx(Oe,{variant:"secondary",children:"Locked"});case"closing":return e.jsx(Oe,{variant:"destructive",children:"Closing"});case"closed":return e.jsx(Oe,{variant:"outline",children:"Closed"});default:return e.jsx(Oe,{variant:"outline",children:q})}};return e.jsx(Kr,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Period Close"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage accounting period closures and financial reporting"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(rt,{value:s,onValueChange:t,children:[e.jsx(nt,{className:"w-48",children:e.jsx(it,{placeholder:"Select Company"})}),e.jsxs(at,{children:[e.jsx(W,{value:"seed-company-1",children:"Uruti Hub Limited"}),e.jsx(W,{value:"seed-company-2",children:"Acme Trading Co"})]})]})})]}),u&&e.jsx(ne,{className:"border-red-200 bg-red-50",children:e.jsx(ie,{className:"pt-6",children:e.jsx("p",{className:"text-red-600",children:(u==null?void 0:u.message)||(u==null?void 0:u.toString())||"Unknown error"})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx(ne,{children:e.jsx(ie,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Open Periods"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:r.filter(q=>q.status==="open").length})]}),e.jsx("div",{className:"text-green-600",children:e.jsx($s,{className:"w-6 h-6"})})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Locked Periods"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:r.filter(q=>q.status==="locked").length})]}),e.jsx("div",{className:"text-blue-600",children:e.jsx(wm,{className:"w-6 h-6"})})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Closed Periods"}),e.jsx("p",{className:"text-2xl font-bold text-gray-600",children:r.filter(q=>q.status==="closed").length})]}),e.jsx("div",{className:"text-gray-600",children:e.jsx(bs,{className:"w-6 h-6"})})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{children:"Accounting Periods"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Oe,{variant:"outline",children:[r.length," periods"]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{console.log("Manual refresh triggered"),A()},disabled:c,children:e.jsx(Ts,{className:`w-4 h-4 ${c?"animate-spin":""}`})})]})]})}),e.jsx(ie,{children:c?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(rt,{value:a,onValueChange:q=>{console.log(`Period selected from dropdown: ${q}`),i(q),T(q)},children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select Period"})}),e.jsx(at,{children:r.map(q=>e.jsxs(W,{value:q.period,children:[q.period," - ",oe(q.status)]},q.period))})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2 p-2 bg-gray-100 rounded",children:[e.jsxs("div",{children:['Debug: selectedPeriod = "',a,'"']}),e.jsxs("div",{children:["Periods count = ",r.length]}),e.jsxs("div",{children:["Periods: ",r.map(q=>`${q.period}(${q.status})`).join(", ")]}),e.jsxs("div",{children:["Loading: ",c?"Yes":"No"]})]}),e.jsx("div",{className:"space-y-3",children:r.map(q=>e.jsx("div",{className:`p-4 border rounded-lg cursor-pointer transition-all hover:shadow-md ${a===q.period?"ring-2 ring-blue-500 bg-blue-50":"hover:bg-gray-50"}`,onClick:()=>{console.log(`Period clicked: ${q.period}`),i(q.period),T(q.period),M()},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"font-medium text-lg",children:q.period}),oe(q.status)]}),e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[q.status==="open"&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-green-700",children:[e.jsx($s,{className:"w-4 h-4"})," Active period - transactions allowed"]}),q.status==="locked"&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-blue-700",children:[e.jsx(wm,{className:"w-4 h-4"})," Review period - no new transactions"]}),q.status==="closed"&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-gray-700",children:[e.jsx(bs,{className:"w-4 h-4"})," Finalized - period complete"]})]}),a===q.period&&e.jsx("div",{className:"text-xs text-blue-600 mt-2 font-medium",children:"Currently selected period"})]}),e.jsxs("div",{className:"flex flex-col items-end text-sm text-gray-500",children:[e.jsx("div",{children:"Transactions: --"}),e.jsx("div",{children:"Balance: --"})]})]})},q.period))})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Close Actions"})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-medium",children:"Period Close Checklist"}),e.jsxs("div",{className:"text-sm text-gray-500",children:[o.filter(q=>q.completed).length," of ",o.length," completed"]})]}),o.length>0?e.jsxs("div",{className:"space-y-3",children:[o.map((q,D)=>e.jsxs("div",{className:"flex items-start gap-3 p-2 rounded hover:bg-gray-50",children:[e.jsx("input",{type:"checkbox",checked:q.completed,onChange:se=>V(q.id,se.target.checked),className:"mt-1 h-4 w-4 text-blue-600 rounded border-gray-300 cursor-pointer"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:`block ${q.completed?"line-through text-gray-500":"text-gray-900"}`,children:q.title||q.description}),q.completed&&e.jsx("span",{className:"text-xs text-green-600 mt-1 block",children:" Completed"})]})]},q.id||D)),e.jsxs("div",{className:"mt-4 pt-3 border-t",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${o.filter(q=>q.completed).length/o.length*100}%`}})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Progress: ",Math.round(o.filter(q=>q.completed).length/o.length*100),"% complete"]})]})]}):e.jsxs("div",{className:"text-center py-4 text-gray-500",children:[e.jsx("div",{className:"text-2xl mb-2",children:""}),e.jsx("p",{children:"Select a period to view checklist"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx(I,{onClick:G,disabled:c||!a||((Q=r.find(q=>q.period===a))==null?void 0:Q.status)!=="open",className:"flex-1",children:c?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:"Processing..."})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(wm,{className:"w-4 h-4"}),e.jsx("span",{children:"Start Close"})]})}),e.jsx(I,{onClick:L,disabled:c||!a||((P=r.find(q=>q.period===a))==null?void 0:P.status)!=="locked",variant:"outline",className:"flex-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"w-4 h-4"}),e.jsx("span",{children:"Complete Close"})]})})]}),a&&e.jsx("div",{className:"text-xs text-gray-500 p-2 bg-gray-50 rounded",children:(()=>{const q=r.find(D=>D.period===a);if(!q)return"Select a period to view available actions";switch(q.status){case"open":return" You can start the close process for this open period";case"locked":return" This period is locked and ready to be completed";case"closed":return" This period is already closed and finalized";default:return"Period status unknown"}})()}),e.jsxs("div",{className:"mt-4 pt-4 border-t",children:[e.jsx("h4",{className:"font-medium text-sm text-gray-700 mb-3",children:"Automated Processes"}),e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsx(I,{onClick:J,disabled:c||!a,variant:"outline",size:"sm",className:"justify-start",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ts,{className:"w-4 h-4"}),e.jsx("span",{children:"Run Recurring Journals"})]})}),e.jsx(I,{onClick:z,disabled:c||!a,variant:"outline",size:"sm",className:"justify-start",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($s,{className:"w-4 h-4"}),e.jsx("span",{children:"Run Allocations"})]})}),e.jsx(I,{onClick:U,disabled:c||!a,variant:"outline",size:"sm",className:"justify-start",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(lY,{className:"w-4 h-4"}),e.jsx("span",{children:"Run FX Revaluation"})]})})]})]})]})]})})]})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{children:"Period Close Runs"}),e.jsx(Oe,{variant:"outline",children:a||"Select period"})]})}),e.jsx(ie,{children:_.length>0?e.jsxs("div",{className:"space-y-3",children:[_.map((q,D)=>e.jsx("div",{className:"p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"font-medium",children:q.name}),e.jsxs(Oe,{variant:q.status==="success"?"default":q.status==="error"?"destructive":"secondary",children:[q.status==="success"&&" ",q.status==="error"&&" ",q.status==="pending"&&" ",q.status]})]}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:q.description}),q.status==="success"&&e.jsxs("div",{className:"text-xs text-green-600 mt-1",children:["Completed successfully in ",q.duration]}),q.status==="error"&&e.jsxs("div",{className:"text-xs text-red-600 mt-1",children:["Failed after ",q.duration," - Click to retry"]})]}),e.jsxs("div",{className:"text-right text-sm text-gray-500",children:[e.jsx("div",{children:q.duration}),q.timestamp&&e.jsx("div",{className:"text-xs",children:q.timestamp})]})]})},D)),e.jsxs("div",{className:"mt-6 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Overall Progress"}),e.jsxs("span",{className:"text-gray-600",children:[_.filter(q=>q.status==="success").length," of ",_.length," completed"]})]}),e.jsx("div",{className:"mt-2 w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${_.filter(q=>q.status==="success").length/_.length*100}%`}})})]})]}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("div",{className:"text-3xl mb-3",children:""}),e.jsx("p",{className:"font-medium",children:"No close runs yet"}),e.jsx("p",{className:"text-sm mt-1",children:a?"Start the close process to see runs here":"Select a period and start closing to track progress"})]})})]})]})})}function nMe(){const[s,t]=x.useState([]),[r,n]=x.useState([]),[a,i]=x.useState(!0),[o,l]=x.useState(!1),[c,d]=x.useState(null),u=zs();x.useEffect(()=>{h()},[]);async function h(){try{await de.getDemoToken("demo_user",["admin","accountant"]),f()}catch(y){console.error("Failed to get demo token:",y),f()}}async function f(){var y;i(!0),d(null);try{const[j,b]=await Promise.all([$C.getSchedules(u),$C.getContracts(u)]);n(j),t(b)}catch(j){console.error("Error loading revenue recognition data:",j),(y=j==null?void 0:j.message)!=null&&y.includes("<!DOCTYPE")?d("API endpoint not found. Please check if the backend is running."):d((j==null?void 0:j.message)||"Failed to load data")}finally{i(!1)}}async function m(){l(!0);try{const y=[{id:"contract-1",name:"Software License - Annual",customer:"Acme Corp",totalValue:12e4,currency:"USD",startDate:new Date().toISOString().split("T")[0],endDate:new Date(Date.now()+31536e6).toISOString().split("T")[0],status:"active",recognitionMethod:"straight_line"},{id:"contract-2",name:"Consulting Services",customer:"Beta Inc",totalValue:5e4,currency:"USD",startDate:new Date().toISOString().split("T")[0],endDate:new Date(Date.now()+15552e6).toISOString().split("T")[0],status:"active",recognitionMethod:"milestone"}],j=[{id:"schedule-1",contractId:"contract-1",period:"2024-01",recognizedAmount:1e4,currency:"USD",status:"recognized"},{id:"schedule-2",contractId:"contract-1",period:"2024-02",recognizedAmount:1e4,currency:"USD",status:"recognized"}];t(y),n(j),console.log("Demo data seeded successfully")}catch(y){console.error("Error seeding demo data:",y),d("Failed to seed demo data")}finally{l(!1)}}async function p(){l(!0);try{const y=[{id:"contract-3",name:"Maintenance Contract",customer:"Gamma LLC",totalValue:25e3,currency:"USD",startDate:new Date().toISOString().split("T")[0],endDate:new Date(Date.now()+7776e6).toISOString().split("T")[0],status:"active",recognitionMethod:"straight_line"}];t(j=>[...j,...y]),console.log("Additional demo data seeded successfully")}catch(y){console.error("Error seeding additional demo data:",y),d("Failed to seed additional demo data")}finally{l(!1)}}const g=(y,j="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:j}).format(y),v=y=>new Date(y).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return e.jsx(Kr,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Revenue Recognition"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage revenue contracts and recognition schedules"})]})}),c&&e.jsx(ne,{className:"border-red-200 bg-red-50",children:e.jsx(ie,{className:"pt-6",children:e.jsx("p",{className:"text-red-600",children:(c==null?void 0:c.message)||(c==null?void 0:c.toString())||"Unknown error"})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(ne,{children:e.jsx(ie,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Contracts"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:s.length})]}),e.jsx("div",{className:"text-blue-600",children:e.jsx(Zt,{className:"w-6 h-6"})})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Schedules"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:r.length})]}),e.jsx("div",{className:"text-green-600",children:e.jsx(Qj,{className:"w-6 h-6"})})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Revenue"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:g(r.reduce((y,j)=>y+(j.amount||0),0))})]}),e.jsx("div",{className:"text-purple-600",children:e.jsx(Mr,{className:"w-6 h-6"})})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{children:"Revenue Contracts"}),e.jsxs(Oe,{variant:"outline",children:[s.length," contracts"]})]})}),e.jsx(ie,{children:a?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):s.length>0?e.jsx("div",{className:"space-y-3",children:s.map((y,j)=>e.jsx("div",{className:"p-3 border rounded-lg hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:y.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",y.id]})]}),e.jsx(Oe,{variant:"default",children:"Active"})]})},y.id||j))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Zt,{className:"w-10 h-10 mx-auto mb-3 text-gray-400"}),e.jsx("p",{className:"font-medium",children:"No contracts found"}),e.jsx("p",{className:"text-sm mt-1",children:"This data comes from the backend API - currently empty"}),e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[e.jsx(I,{onClick:m,disabled:o,children:o?"Seeding":"Seed Demo Data"}),e.jsx(I,{onClick:p,variant:"outline",disabled:o,children:o?"Seeding":"Seed More"})]})})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{children:"Recognition Schedules"}),e.jsxs(Oe,{variant:"outline",children:[r.length," schedules"]})]})}),e.jsx(ie,{children:a?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):r.length>0?e.jsx("div",{className:"space-y-3",children:r.map((y,j)=>{var b;return e.jsx("div",{className:"p-3 border rounded-lg hover:bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:y.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:[v(y.startDate)," - ",v(y.endDate)]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Method: ",(b=y.method)==null?void 0:b.replace("_"," ")]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-medium",children:g(y.amount,y.currency)}),e.jsx(Oe,{variant:"secondary",children:y.method})]})]})},y.id||j)})}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Qj,{className:"w-10 h-10 mx-auto mb-3 text-gray-400"}),e.jsx("p",{className:"font-medium",children:"No schedules found"}),e.jsx("p",{className:"text-sm mt-1",children:"This data comes from the backend API - currently empty"}),e.jsx("div",{className:"mt-4",children:e.jsxs("div",{className:"flex items-center gap-2 justify-center",children:[e.jsx(I,{onClick:m,disabled:o,children:o?"Seeding":"Seed Demo Data"}),e.jsx(I,{onClick:p,variant:"outline",disabled:o,children:o?"Seeding":"Seed More"})]})})]})})]})]})]})})}const Pi=()=>un(""),aMe=async s=>(await(await fetch(`${Pi()}/api/fixed-assets/categories?companyId=${s}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":s}})).json()).categories||[],iMe=async(s,t={})=>{const r=new URLSearchParams({companyId:s,...t}),n=`${Pi()}/api/fixed-assets?${r}`;return(await(await fetch(n,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":s}})).json()).assets||[]},oMe=async s=>await(await fetch(`${Pi()}/api/fixed-assets/reports/summary?companyId=${s}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":s}})).json(),lMe=async s=>{const t=await fetch(`${Pi()}/api/fixed-assets`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":s.companyId},body:JSON.stringify(s)}),r=await t.json();if(!t.ok)throw new Error(r.error||"Failed to create asset");return r.asset},cMe=async(s,t)=>{const r=await fetch(`${Pi()}/api/fixed-assets/${s}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":t.companyId},body:JSON.stringify(t)}),n=await r.json();if(!r.ok)throw new Error(n.error||"Failed to update asset");return n.asset},dMe=async(s,t)=>{const r=await fetch(`${Pi()}/api/fixed-assets/${s}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":t}});if(!r.ok){const n=await r.json();throw new Error(n.error||"Failed to delete asset")}},uMe=async(s,t,r)=>{const n=await fetch(`${Pi()}/api/fixed-assets/calculate-depreciation`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":s},body:JSON.stringify({companyId:s,year:t,month:r})}),a=await n.json();if(!n.ok)throw new Error(a.error||"Failed to calculate depreciation");return a},hMe=async(s,t)=>{const r=t?`${Pi()}/api/fixed-assets/reports/depreciation-schedule?companyId=${s}&year=${t}`:`${Pi()}/api/fixed-assets/reports/depreciation-schedule?companyId=${s}`,n=await fetch(r,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":s}}),a=await n.json();if(!n.ok)throw new Error(a.error||"Failed to fetch depreciation schedule");return a.depreciationSchedule||[]},mMe=async(s,t)=>{const r=await fetch(`${Pi()}/api/fixed-assets/categories`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":s},body:JSON.stringify({...t,companyId:s})});if(!r.ok){const n=await r.json();throw new Error(n.error||"Failed to create category")}return r.json()},fMe=async(s,t,r)=>{const n=await fetch(`${Pi()}/api/fixed-assets/categories/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":s},body:JSON.stringify({...r,companyId:s})});if(!n.ok){const a=await n.json();throw new Error(a.error||"Failed to update category")}return n.json()},xMe=async(s,t)=>{const r=await fetch(`${Pi()}/api/fixed-assets/categories/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":s}});if(!r.ok){const n=await r.json();throw new Error(n.error||"Failed to delete category")}};function pMe({category:s,onSave:t,onCancel:r,isLoading:n}){const[a,i]=x.useState({name:(s==null?void 0:s.name)||"",usefulLifeMonths:(s==null?void 0:s.usefulLifeMonths)||60,method:(s==null?void 0:s.method)||"straight_line",salvageRate:(s==null?void 0:s.salvageRate)||0,assetAccountId:(s==null?void 0:s.assetAccountId)||void 0,depreciationExpenseId:(s==null?void 0:s.depreciationExpenseId)||void 0,accumulatedDepreciationId:(s==null?void 0:s.accumulatedDepreciationId)||void 0,disposalGainId:(s==null?void 0:s.disposalGainId)||void 0,disposalLossId:(s==null?void 0:s.disposalLossId)||void 0}),[o,l]=x.useState({}),{data:c,isLoading:d}=ys({queryKey:["chart-of-accounts"],queryFn:async()=>{const f=localStorage.getItem("company_id")||localStorage.getItem("companyId")||"seed-company-1",m=await fetch(`${Pi()}/api/accounts?companyId=${f}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":f}});if(!m.ok)throw new Error("Failed to fetch accounts");const p=await m.json();return Array.isArray(p)?p:p.accounts||[]},enabled:!0}),u=c||[],h=f=>{f.preventDefault();const m={};if(a.name.trim()||(m.name="Category name is required"),a.usefulLifeMonths<=0&&(m.usefulLifeMonths="Useful life must be greater than 0"),(a.salvageRate<0||a.salvageRate>100)&&(m.salvageRate="Salvage rate must be between 0 and 100"),Object.keys(m).length>0){l(m);return}const p={...a,assetAccountId:a.assetAccountId||void 0,depreciationExpenseId:a.depreciationExpenseId||void 0,accumulatedDepreciationId:a.accumulatedDepreciationId||void 0,disposalGainId:a.disposalGainId||void 0,disposalLossId:a.disposalLossId||void 0};t(p)};return e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"name",children:"Category Name *"}),e.jsx(ge,{id:"name",value:a.name,onChange:f=>i({...a,name:f.target.value}),placeholder:"e.g., Office Equipment",className:o.name?"border-red-500":""}),o.name&&e.jsx("p",{className:"text-sm text-red-500",children:o.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"usefulLifeMonths",children:"Useful Life (Months) *"}),e.jsx(ge,{id:"usefulLifeMonths",type:"number",value:a.usefulLifeMonths,onChange:f=>i({...a,usefulLifeMonths:parseInt(f.target.value)||0}),min:"1",className:o.usefulLifeMonths?"border-red-500":""}),o.usefulLifeMonths&&e.jsx("p",{className:"text-sm text-red-500",children:o.usefulLifeMonths})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"method",children:"Depreciation Method *"}),e.jsxs(rt,{value:a.method,onValueChange:f=>i({...a,method:f}),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select method"})}),e.jsxs(at,{children:[e.jsx(W,{value:"straight_line",children:"Straight Line"}),e.jsx(W,{value:"declining_balance",children:"Declining Balance"}),e.jsx(W,{value:"sum_of_years_digits",children:"Sum of Years Digits"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"salvageRate",children:"Salvage Rate (%)"}),e.jsx(ge,{id:"salvageRate",type:"number",value:a.salvageRate,onChange:f=>i({...a,salvageRate:parseFloat(f.target.value)||0}),min:"0",max:"100",step:"0.1",className:o.salvageRate?"border-red-500":""}),o.salvageRate&&e.jsx("p",{className:"text-sm text-red-500",children:o.salvageRate})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Accounting Accounts (Optional)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"assetAccountId",children:"Asset Account"}),e.jsxs(rt,{value:a.assetAccountId||void 0,onValueChange:f=>i({...a,assetAccountId:f}),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select asset account (optional)"})}),e.jsx(at,{children:u.filter(f=>{var m;return(m=f.accountType)==null?void 0:m.toLowerCase().includes("asset")}).map(f=>e.jsxs(W,{value:f.id,children:[f.code," - ",f.name]},f.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"depreciationExpenseId",children:"Depreciation Expense Account"}),e.jsxs(rt,{value:a.depreciationExpenseId||void 0,onValueChange:f=>i({...a,depreciationExpenseId:f}),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select expense account (optional)"})}),e.jsx(at,{children:u.filter(f=>{var m;return(m=f.accountType)==null?void 0:m.toLowerCase().includes("expense")}).map(f=>e.jsxs(W,{value:f.id,children:[f.code," - ",f.name]},f.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"accumulatedDepreciationId",children:"Accumulated Depreciation Account"}),e.jsxs(rt,{value:a.accumulatedDepreciationId||void 0,onValueChange:f=>i({...a,accumulatedDepreciationId:f}),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select accumulated depreciation account (optional)"})}),e.jsx(at,{children:u.filter(f=>f.name.toLowerCase().includes("accumulated")||f.name.toLowerCase().includes("depreciation")).map(f=>e.jsxs(W,{value:f.id,children:[f.code," - ",f.name]},f.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"disposalGainId",children:"Disposal Gain Account"}),e.jsxs(rt,{value:a.disposalGainId||void 0,onValueChange:f=>i({...a,disposalGainId:f}),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select disposal gain account (optional)"})}),e.jsx(at,{children:u.filter(f=>{var m;return((m=f.accountType)==null?void 0:m.toLowerCase().includes("income"))||f.name.toLowerCase().includes("gain")||f.name.toLowerCase().includes("income")}).map(f=>e.jsxs(W,{value:f.id,children:[f.code," - ",f.name]},f.id))})]})]})]})]}),e.jsxs(Xr,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:r,children:"Cancel"}),e.jsx(I,{type:"submit",disabled:n,children:n?e.jsxs(e.Fragment,{children:[e.jsx(kr,{size:"sm",color:"gray",className:"mr-2"}),s?"Updating Category...":"Creating Category..."]}):s?"Update Category":"Create Category"})]})]})}function gMe(){var Vn,De,ut;const[s,t]=x.useState(""),[r,n]=x.useState("all"),[a,i]=x.useState("all"),[o,l]=x.useState("overview"),[c,d]=x.useState(null),[u,h]=x.useState(!1),[f,m]=x.useState(!1),[p,g]=x.useState(!1),[v,y]=x.useState(!1),[j,b]=x.useState({assetId:"",maintenanceDate:new Date().toISOString().split("T")[0],maintenanceType:"PREVENTIVE",description:"",performedBy:"",cost:0,extendsUsefulLife:!1,lifeExtensionMonths:0,invoiceNumber:"",warrantyInfo:"",status:"SCHEDULED"}),[w,N]=x.useState({}),[C,S]=x.useState(null),[_,k]=x.useState(!1),[F,A]=x.useState(!1),[T,V]=x.useState(null),[M,G]=x.useState(!1),[L,J]=x.useState(null),[z,U]=x.useState(null),[oe,Q]=x.useState(!1),[P,q]=x.useState(null),[D,se]=x.useState(!1),[he,be]=x.useState(null),[pe,Ae]=x.useState({}),[Ee,$e]=x.useState(new Date().getFullYear()),[O,te]=x.useState(new Date().getMonth()+1),[re,le]=x.useState("all"),Z=hi(),{isAuthenticated:K,isLoading:X,user:ce}=Ua(),Y=!X,{data:ue,isLoading:ve,error:Le}=ys({queryKey:["companies"],queryFn:async()=>{const Pe=await de.getCompanies();return Array.isArray(Pe)?Pe:Pe!=null&&Pe.data&&Array.isArray(Pe.data)?Pe.data:Pe!=null&&Pe.items&&Array.isArray(Pe.items)?Pe.items:[]},enabled:Y}),Me=xe.useMemo(()=>{var Pe;try{return zs()}catch{return ue&&ue.length>0?(Pe=ue[0])==null?void 0:Pe.id:null}},[ue]),{data:tt=[],isLoading:fe}=ys({queryKey:["fixed-asset-categories",Me],queryFn:()=>aMe(Me),enabled:Y&&!!Me&&!ve}),{data:ct=[],isLoading:dt,refetch:pt}=ys({queryKey:["fixed-assets",Me,r,a,s],queryFn:()=>iMe(Me,{status:r!=="all"?r:void 0,categoryId:a!=="all"?a:void 0,search:s||void 0}),enabled:Y&&!!Me&&!ve}),{data:qe,isLoading:mt}=ys({queryKey:["fixed-assets-summary",Me],queryFn:()=>oMe(Me),enabled:Y&&!!Me&&!ve}),Rt=Y&&!!Me&&!ve,{data:_e=[],isLoading:Xe,refetch:At}=ys({queryKey:["depreciation-schedule",Me,Ee],queryFn:()=>hMe(Me,Ee),enabled:Rt}),st=async(Pe,_t)=>{const bt=new URLSearchParams({companyId:Pe}),ps=`${Pi()}/api/fixed-assets/maintenance?${bt}`;return(await(await fetch(ps,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":Pe}})).json()).maintenanceRecords||[]},$t=async Pe=>await(await fetch(`${Pi()}/api/fixed-assets/maintenance/summary?companyId=${Pe}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":Pe}})).json(),fs=async Pe=>{const _t=await fetch(`${Pi()}/api/fixed-assets/reports/asset-summary?companyId=${Pe}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":Pe}});if(!_t.ok)throw new Error("Failed to generate asset summary report");return _t.blob()},zt=async(Pe,_t)=>{const bt=_t?`${Pi()}/api/fixed-assets/reports/depreciation-schedule?companyId=${Pe}&year=${_t}`:`${Pi()}/api/fixed-assets/reports/depreciation-schedule?companyId=${Pe}`,ps=await fetch(bt,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":Pe}});if(!ps.ok)throw new Error("Failed to generate depreciation schedule report");return ps.blob()},St=async Pe=>{const _t=await fetch(`${Pi()}/api/fixed-assets/reports/asset-register?companyId=${Pe}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":Pe}});if(!_t.ok)throw new Error("Failed to generate asset register report");return _t.blob()},js=async Pe=>{const _t=await fetch(`${Pi()}/api/fixed-assets/reports/category-summary?companyId=${Pe}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":Pe}});if(!_t.ok)throw new Error("Failed to generate category summary report");return _t.blob()},et=async Pe=>{const _t=await fetch(`${Pi()}/api/fixed-assets/reports/aging?companyId=${Pe}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":Pe}});if(!_t.ok)throw new Error("Failed to generate aging report");return _t.blob()},lt=async(Pe,_t,bt)=>{const ps=await fetch(`${Pi()}/api/accounts?companyId=${Pe}`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":Pe}});if(!ps.ok)throw new Error("Failed to fetch accounts");const Pr=await ps.json();return(Array.isArray(Pr)?Pr:Pr.accounts||[]).some(Zs=>{var wr;return Zs.name===_t&&(Zs.accountType===bt||((wr=Zs.type)==null?void 0:wr.code)===bt)})},{data:Fe=[],isLoading:ft,refetch:He}=ys({queryKey:["maintenance-records",Me],queryFn:()=>st(Me),enabled:Y&&!!Me&&!ve}),{data:Je,isLoading:It}=ys({queryKey:["maintenance-summary",Me],queryFn:()=>$t(Me),enabled:Y&&!!Me&&!ve}),Gt=xe.useMemo(()=>re==="all"?_e:_e.filter(Pe=>Pe.assetId===re),[_e,re]),qt=xe.useMemo(()=>{const Pe={};return Gt.forEach(_t=>{Pe[_t.assetId]||(Pe[_t.assetId]=[]),Pe[_t.assetId].push(_t)}),Pe},[Gt]),As=Rs({mutationFn:lMe,onSuccess:()=>{Z.invalidateQueries({queryKey:["fixed-assets"]}),Z.invalidateQueries({queryKey:["fixed-assets-summary"]}),h(!1),ze.success("Asset created successfully")},onError:Pe=>{ze.error(Pe.message||"Failed to create asset")}}),Ht=Rs({mutationFn:({id:Pe,data:_t})=>cMe(Pe,_t),onSuccess:()=>{Z.invalidateQueries({queryKey:["fixed-assets"]}),Z.invalidateQueries({queryKey:["fixed-assets-summary"]}),h(!1),ze.success("Asset updated successfully")},onError:Pe=>{ze.error(Pe.message||"Failed to update asset")}}),xs=Rs({mutationFn:Pe=>dMe(Pe,Me),onSuccess:()=>{Z.invalidateQueries({queryKey:["fixed-assets"]}),Z.invalidateQueries({queryKey:["fixed-assets-summary"]}),ze.success("Asset deleted successfully")},onError:Pe=>{ze.error(Pe.message||"Failed to delete asset")}}),Ct=Rs({mutationFn:({year:Pe,month:_t})=>uMe(Me,Pe,_t),onSuccess:Pe=>{Z.invalidateQueries({queryKey:["fixed-assets"]}),Z.invalidateQueries({queryKey:["fixed-assets-summary"]}),ze.success(`Calculated depreciation for ${Pe.depreciationRecords.length} assets`)},onError:Pe=>{ze.error(Pe.message||"Failed to calculate depreciation")}}),ke=Rs({mutationFn:Pe=>mMe(Me,Pe),onSuccess:()=>{Z.invalidateQueries({queryKey:["fixed-asset-categories"]}),Z.invalidateQueries({queryKey:["fixed-assets"]}),m(!1),q(null),ze.success("Category created successfully")},onError:Pe=>{ze.error(Pe.message||"Failed to create category")}}),gt=Rs({mutationFn:({id:Pe,data:_t})=>fMe(Me,Pe,_t),onSuccess:()=>{Z.invalidateQueries({queryKey:["fixed-asset-categories"]}),Z.invalidateQueries({queryKey:["fixed-assets"]}),m(!1),q(null),ze.success("Category updated successfully")},onError:Pe=>{ze.error(Pe.message||"Failed to update category")}}),us=Rs({mutationFn:Pe=>xMe(Me,Pe),onSuccess:()=>{Z.invalidateQueries({queryKey:["fixed-asset-categories"]}),Z.invalidateQueries({queryKey:["fixed-assets"]}),se(!1),be(null),ze.success("Category deleted successfully")},onError:Pe=>{ze.error(Pe.message||"Failed to delete category")}}),We=Rs({mutationFn:Pe=>{try{const _t=zs(),bt={...Pe,companyId:_t};return fetch(`${un()}/api/fixed-assets/maintenance`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":Ii(),"x-company-id":zs()},body:JSON.stringify(bt)}).then(async ps=>{var Wr;const Pr=await ps.json();if(!ps.ok)throw new Error(((Wr=Pr.error)==null?void 0:Wr.message)||`HTTP ${ps.status}: ${ps.statusText}`);return Pr})}catch{throw new Error("Company ID is required")}},onSuccess:()=>{Z.invalidateQueries({queryKey:["maintenance-records",Me]}),Z.invalidateQueries({queryKey:["maintenance-summary",Me]}),y(!1),S(null),b({assetId:"",maintenanceDate:new Date().toISOString().split("T")[0],maintenanceType:"PREVENTIVE",description:"",performedBy:"",cost:0,extendsUsefulLife:!1,lifeExtensionMonths:0,invoiceNumber:"",warrantyInfo:"",status:"SCHEDULED"}),ze.success("Maintenance record created successfully")},onError:Pe=>{ze.error(Pe.message||"Failed to create maintenance record")}}),Et=Rs({mutationFn:({id:Pe,data:_t})=>fetch(`${un()}/api/fixed-assets/maintenance/${Pe}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":Ii(),"x-company-id":zs()},body:JSON.stringify(_t)}).then(bt=>bt.json()),onSuccess:()=>{Z.invalidateQueries({queryKey:["maintenance-records",Me]}),Z.invalidateQueries({queryKey:["maintenance-summary",Me]}),y(!1),S(null),b({assetId:"",maintenanceDate:new Date().toISOString().split("T")[0],maintenanceType:"PREVENTIVE",description:"",performedBy:"",cost:0,extendsUsefulLife:!1,lifeExtensionMonths:0,invoiceNumber:"",warrantyInfo:"",status:"SCHEDULED"}),ze.success("Maintenance record updated successfully")},onError:Pe=>{ze.error(Pe.message||"Failed to update maintenance record")}}),Pt=Rs({mutationFn:Pe=>fetch(`${un()}/api/fixed-assets/maintenance/${Pe}`,{method:"DELETE",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":Ii(),"x-company-id":zs()}}),onSuccess:()=>{Z.invalidateQueries({queryKey:["maintenance-records",Me]}),Z.invalidateQueries({queryKey:["maintenance-summary",Me]}),ze.success("Maintenance record deleted successfully")},onError:Pe=>{ze.error(Pe.message||"Failed to delete maintenance record")}}),rs=Rs({mutationFn:({reportType:Pe,year:_t})=>{switch(Pe){case"asset-summary":return fs(Me);case"depreciation-schedule":return zt(Me,_t);case"asset-register":return St(Me);case"category-summary":return js(Me);case"aging":return et(Me);case"compliance":return generateComplianceReport(Me);default:throw new Error("Unknown report type")}},onSuccess:(Pe,_t)=>{const bt=window.URL.createObjectURL(Pe),ps=document.createElement("a");ps.href=bt,ps.download=`fixed-assets-${_t.reportType}-${new Date().toISOString().split("T")[0]}.pdf`,document.body.appendChild(ps),ps.click(),document.body.removeChild(ps),window.URL.revokeObjectURL(bt),ze.success(`${_t.reportType.replace("-"," ")} report generated successfully`)},onError:Pe=>{ze.error(Pe.message||"Failed to generate report")}}),ms=(Pe,_t)=>{rs.mutate({reportType:Pe,year:_t})},Bs=Rs({mutationFn:Pe=>fetch(`${un()}/api/fixed-assets/${Pe}/post`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":Ii(),"x-company-id":zs()}}).then(async _t=>{const bt=await _t.json();if(!_t.ok)throw new Error(bt.error||`HTTP ${_t.status}: ${_t.statusText}`);return bt}),onSuccess:(Pe,_t)=>{Z.invalidateQueries({queryKey:["fixed-assets",Me]}),Z.invalidateQueries({queryKey:["fixed-assets-summary",Me]}),G(!1),J(null),ze.success(Pe.message||"Asset posted successfully")},onError:Pe=>{ze.error(Pe.message||"Failed to post asset")}}),Vs=async Pe=>{var _t,bt,ps;J(Pe),Q(!0),G(!0);try{const Pr=await er(Pe);U(Pr)}catch(Pr){console.error("Error checking accounts:",Pr),U({hasAssetAccount:!!((_t=Pe.category)!=null&&_t.assetAccountId),hasCashAccount:!0,canCreateEntries:!0,needsAutoCreation:!((bt=Pe.category)!=null&&bt.assetAccountId),assetAccountExists:!1,cashAccountExists:!1,expectedAssetAccountName:`${(ps=Pe.category)==null?void 0:ps.name} Assets`,expectedCashAccountName:"Cash and Cash Equivalents"})}finally{Q(!1)}},Ws=()=>{L&&Bs.mutate(L.id)},Ns=()=>{G(!1),J(null),U(null),Q(!1)},er=async Pe=>{var Zs,wr;const _t=(Zs=Pe.category)==null?void 0:Zs.assetAccountId,bt=`${(wr=Pe.category)==null?void 0:wr.name} Assets`,ps="Cash and Cash Equivalents",[Pr,Wr]=await Promise.all([_t?Promise.resolve(!0):lt(Me,bt,"ASSET"),lt(Me,ps,"ASSET")]);return{hasAssetAccount:!!_t,hasCashAccount:Wr,canCreateEntries:!0,needsAutoCreation:!_t||!Wr,assetAccountExists:Pr,cashAccountExists:Wr,expectedAssetAccountName:bt,expectedCashAccountName:ps}},Ir=Pe=>{V(Pe),A(!0)},jn=()=>{T&&(xs.mutate(T.id),A(!1),V(null))},Hs=()=>{A(!1),V(null)},qr=Pe=>{be(Pe),se(!0)},qn=()=>{he&&us.mutate(he.id)},In=()=>{se(!1),be(null)},Yr=Pe=>{Pe.preventDefault(),N({});const _t={};if(j.assetId||(_t.assetId="Asset is required"),j.maintenanceDate||(_t.maintenanceDate="Maintenance date is required"),j.maintenanceType||(_t.maintenanceType="Maintenance type is required"),j.description||(_t.description="Description is required"),j.cost<0&&(_t.cost="Cost cannot be negative"),j.extendsUsefulLife&&j.lifeExtensionMonths<=0&&(_t.lifeExtensionMonths="Life extension months must be greater than 0"),Object.keys(_t).length>0){N(_t);return}const bt={...j,lifeExtensionMonths:j.extendsUsefulLife?j.lifeExtensionMonths:void 0};C?Et.mutate({id:C,data:bt}):We.mutate(bt)},$r=(Pe,_t)=>{b(bt=>({...bt,[Pe]:_t})),w[Pe]&&N(bt=>({...bt,[Pe]:""}))},Vr=x.useMemo(()=>ct.filter(Pe=>{var ps;const _t=!s||Pe.name.toLowerCase().includes(s.toLowerCase())||((ps=Pe.notes)==null?void 0:ps.toLowerCase().includes(s.toLowerCase())),bt=a==="all"||Pe.categoryId===a;return _t&&bt}),[ct,s,a]),wn=({asset:Pe,onSave:_t,onCancel:bt})=>{const[ps,Pr]=x.useState({companyId:Me,name:(Pe==null?void 0:Pe.name)||"",categoryId:(Pe==null?void 0:Pe.categoryId)||"",cost:(Pe==null?void 0:Pe.cost)||"",currency:(Pe==null?void 0:Pe.currency)||"USD",acquisitionDate:(Pe==null?void 0:Pe.acquisitionDate)||"",startDepreciation:(Pe==null?void 0:Pe.startDepreciation)||"",salvageValue:(Pe==null?void 0:Pe.salvageValue)||"",notes:(Pe==null?void 0:Pe.notes)||""}),Wr=Zs=>{Zs.preventDefault(),Ae({});const wr={};if(ps.name||(wr.name="Asset name is required"),ps.categoryId||(wr.categoryId="Category is required"),ps.cost||(wr.cost="Cost is required"),ps.acquisitionDate||(wr.acquisitionDate="Acquisition date is required"),ps.startDepreciation||(wr.startDepreciation="Start depreciation date is required"),Object.keys(wr).length>0){Ae(wr);return}_t(ps)};return e.jsxs("form",{onSubmit:Wr,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Asset Name *"}),e.jsx(ge,{value:ps.name,onChange:Zs=>Pr({...ps,name:Zs.target.value}),placeholder:"e.g., Office Computer",className:pe.name?"border-red-500":""}),pe.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:pe.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Category *"}),e.jsxs(rt,{value:ps.categoryId,onValueChange:Zs=>Pr({...ps,categoryId:Zs}),children:[e.jsx(nt,{className:pe.categoryId?"border-red-500":"",children:e.jsx(it,{placeholder:"Select category"})}),e.jsx(at,{children:tt.map(Zs=>e.jsx(W,{value:Zs.id,children:Zs.name},Zs.id))})]}),pe.categoryId&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:pe.categoryId})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Cost *"}),e.jsx(ge,{type:"number",step:"0.01",value:ps.cost,onChange:Zs=>Pr({...ps,cost:Zs.target.value}),placeholder:"0.00",className:pe.cost?"border-red-500":""}),pe.cost&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:pe.cost})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Currency"}),e.jsxs(rt,{value:ps.currency,onValueChange:Zs=>Pr({...ps,currency:Zs}),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"USD",children:"USD"}),e.jsx(W,{value:"EUR",children:"EUR"}),e.jsx(W,{value:"GBP",children:"GBP"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Acquisition Date *"}),e.jsx(ge,{type:"date",value:ps.acquisitionDate,onChange:Zs=>Pr({...ps,acquisitionDate:Zs.target.value}),className:pe.acquisitionDate?"border-red-500":""}),pe.acquisitionDate&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:pe.acquisitionDate})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Start Depreciation Date *"}),e.jsx(ge,{type:"date",value:ps.startDepreciation,onChange:Zs=>Pr({...ps,startDepreciation:Zs.target.value}),className:pe.startDepreciation?"border-red-500":""}),pe.startDepreciation&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:pe.startDepreciation})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Salvage Value"}),e.jsx(ge,{type:"number",step:"0.01",value:ps.salvageValue,onChange:Zs=>Pr({...ps,salvageValue:Zs.target.value}),placeholder:"0.00"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notes"}),e.jsx("textarea",{value:ps.notes,onChange:Zs=>Pr({...ps,notes:Zs.target.value}),placeholder:"Additional notes",className:"w-full p-2 border rounded-md",rows:3})]}),e.jsxs(Xr,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:bt,children:"Cancel"}),e.jsx(I,{type:"submit",disabled:As.isPending||Ht.isPending,children:As.isPending||Ht.isPending?e.jsxs(e.Fragment,{children:[e.jsx(kr,{size:"sm",color:"gray",className:"mr-2"}),As.isPending?"Creating Asset...":"Updating Asset..."]}):Pe?"Update Asset":"Create Asset"})]})]})};return K?e.jsx(Kr,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Fixed Assets Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your company's fixed assets, depreciation, and maintenance"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(I,{onClick:()=>h(!0),children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Add Asset"]})})]}),qe?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Total Assets"}),e.jsx(vn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:qe.summary.totalAssets}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Fixed assets registered"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Draft Assets"}),e.jsx(Zt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:ct.filter(Pe=>Pe.status==="DRAFT").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Pending posting"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Posted Assets"}),e.jsx(bs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:ct.filter(Pe=>Pe.status==="POSTED").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"In accounting system"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Total Cost"}),e.jsx(Mr,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",Number(qe.summary.totalCost).toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total asset value"})]})]})]}):mt?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(kr,{size:"md",color:"teal"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-3",children:"Loading summary data..."})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(vn,{className:"h-8 w-8 text-muted-foreground mx-auto mb-2"}),e.jsx("p",{className:"text-muted-foreground",children:"No summary data available"})]}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Rn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(ge,{placeholder:"Search assets...",value:s,onChange:Pe=>t(Pe.target.value),className:"pl-10"})]})}),e.jsxs(rt,{value:r,onValueChange:n,children:[e.jsx(nt,{className:"w-full sm:w-48",children:e.jsx(it,{placeholder:"Filter by status"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Status"}),e.jsx(W,{value:"DRAFT",children:"Draft"}),e.jsx(W,{value:"POSTED",children:"Posted"}),e.jsx(W,{value:"DISPOSED",children:"Disposed"})]})]}),e.jsxs(rt,{value:a,onValueChange:i,children:[e.jsx(nt,{className:"w-full sm:w-48",children:e.jsx(it,{placeholder:"Filter by category"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Categories"}),tt.map(Pe=>e.jsx(W,{value:Pe.id,children:Pe.name},Pe.id))]})]})]})})}),e.jsxs(an,{value:o,onValueChange:l,className:"space-y-4",children:[e.jsxs(on,{children:[e.jsx(vt,{value:"overview",children:"Assets Overview"}),e.jsx(vt,{value:"categories",children:"Categories"}),e.jsx(vt,{value:"depreciation",children:"Depreciation"}),e.jsx(vt,{value:"maintenance",children:"Maintenance"}),e.jsx(vt,{value:"reports",children:"Reports"})]}),e.jsx(yt,{value:"overview",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{children:["Fixed Assets (",Vr.length,")"]}),e.jsx(Vt,{children:"Manage your company's fixed assets"})]}),e.jsx(ie,{children:dt?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsxs("div",{className:"text-center",children:[e.jsx(kr,{size:"lg",color:"teal"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-3",children:"Loading fixed assets..."})]})}):Vr.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(vn,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Fixed Assets Found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:s||a!=="all"?"No assets match your current filters. Try adjusting your search criteria.":"Get started by adding your first fixed asset to track your company's investments."}),e.jsxs(I,{onClick:()=>h(!0),children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Add First Asset"]})]}):e.jsxs(Ol,{children:[e.jsx(Rl,{children:e.jsxs(Dn,{children:[e.jsx(_s,{children:"Name"}),e.jsx(_s,{children:"Category"}),e.jsx(_s,{children:"Status"}),e.jsx(_s,{children:"Cost"}),e.jsx(_s,{children:"Accumulated Depreciation"}),e.jsx(_s,{children:"Net Book Value"}),e.jsx(_s,{children:"Currency"}),e.jsx(_s,{children:"Acquisition Date"}),e.jsx(_s,{children:"Actions"})]})}),e.jsx(Fl,{children:Vr.map(Pe=>{var ps,Pr;const _t=((ps=Pe.depreciations)==null?void 0:ps.reduce((Wr,Zs)=>Wr+(Zs.amount||0),0))||0,bt=Number(Pe.cost)-_t;return e.jsxs(Dn,{children:[e.jsx(Cs,{className:"font-medium",children:Pe.name}),e.jsx(Cs,{children:(Pr=Pe.category)==null?void 0:Pr.name}),e.jsx(Cs,{children:e.jsx(Oe,{variant:Pe.status==="DRAFT"?"secondary":Pe.status==="POSTED"?"default":"destructive",className:Pe.status==="DRAFT"?"bg-yellow-100 text-yellow-800":Pe.status==="POSTED"?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:Pe.status})}),e.jsxs(Cs,{children:["$",Number(Pe.cost).toLocaleString()]}),e.jsxs(Cs,{children:["$",_t.toLocaleString()]}),e.jsxs(Cs,{className:bt<0?"text-red-600 font-semibold":"",children:["$",bt.toLocaleString()]}),e.jsx(Cs,{children:Pe.currency}),e.jsx(Cs,{children:Pe.acquisitionDate}),e.jsx(Cs,{children:e.jsxs("div",{className:"flex gap-2",children:[Pe.status==="DRAFT"&&e.jsx(I,{variant:"outline",size:"sm",onClick:()=>Vs(Pe),disabled:Bs.isPending,className:"bg-green-600 hover:bg-green-700 text-white border-green-600",children:Bs.isPending?e.jsx(kr,{size:"sm",color:"gray"}):"Post"}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{d(Pe),h(!0)},children:e.jsx(ln,{className:"h-4 w-4"})}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>Ir(Pe),children:e.jsx(hn,{className:"h-4 w-4"})})]})})]},Pe.id)})})]})})]})}),e.jsx(yt,{value:"categories",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(Se,{children:["Asset Categories (",tt.length,")"]}),e.jsx(Vt,{children:"Manage fixed asset categories and their depreciation settings"})]}),e.jsxs(I,{onClick:()=>m(!0),children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Add Category"]})]})}),e.jsx(ie,{children:fe?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsxs("div",{className:"text-center",children:[e.jsx(kr,{size:"lg",color:"teal"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-3",children:"Loading asset categories..."})]})}):tt.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(vn,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Categories Found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Create your first asset category to organize your fixed assets."}),e.jsxs(I,{onClick:()=>m(!0),children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Create First Category"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:tt.map(Pe=>{var _t;return e.jsxs(ne,{className:"relative",children:[e.jsx(we,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx(Se,{className:"text-lg",children:Pe.name}),e.jsxs(Vt,{children:[Pe.usefulLifeMonths," months useful life"]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{q(Pe),m(!0)},children:e.jsx(ln,{className:"h-4 w-4"})}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>qr(Pe),children:e.jsx(hn,{className:"h-4 w-4"})})]})]})}),e.jsx(ie,{className:"pt-0",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Depreciation Method:"}),e.jsx(Oe,{variant:"secondary",children:(_t=Pe.method)==null?void 0:_t.replace("_"," ").toUpperCase()})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Salvage Rate:"}),e.jsxs("span",{children:[Pe.salvageRate||0,"%"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Assets:"}),e.jsx("span",{children:ct.filter(bt=>bt.categoryId===Pe.id).length})]})]})})]},Pe.id)})})})]})}),e.jsxs(yt,{value:"depreciation",className:"space-y-4",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Depreciation Controls"}),e.jsx(Vt,{children:"Calculate and manage asset depreciation for specific periods"})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"depreciation-year",children:"Year"}),e.jsxs(rt,{value:Ee.toString(),onValueChange:Pe=>$e(parseInt(Pe)),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsx(at,{children:Array.from({length:10},(Pe,_t)=>{const bt=new Date().getFullYear()-5+_t;return e.jsx(W,{value:bt.toString(),children:bt},bt)})})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"depreciation-month",children:"Month"}),e.jsxs(rt,{value:O.toString(),onValueChange:Pe=>te(parseInt(Pe)),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsx(at,{children:Array.from({length:12},(Pe,_t)=>e.jsx(W,{value:(_t+1).toString(),children:new Date(0,_t).toLocaleString("default",{month:"long"})},_t+1))})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(I,{onClick:()=>{Ct.mutate({year:Ee,month:O})},disabled:Ct.isPending,className:"w-full",children:Ct.isPending?e.jsxs(e.Fragment,{children:[e.jsx(kr,{size:"sm",color:"gray",className:"mr-2"}),"Calculating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(yn,{className:"h-4 w-4 mr-2"}),"Calculate Depreciation"]})})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{variant:"outline",onClick:()=>{const Pe=new Date;$e(Pe.getFullYear()),te(Pe.getMonth()+1)},children:[e.jsx(Xn,{className:"h-4 w-4 mr-2"}),"Set to Current Month"]}),e.jsxs(I,{variant:"outline",onClick:()=>{for(let Pe=1;Pe<=12;Pe++)setTimeout(()=>{Ct.mutate({year:Ee,month:Pe})},Pe*1e3)},disabled:Ct.isPending,children:[e.jsx(Xn,{className:"h-4 w-4 mr-2"}),"Calculate Entire Year"]})]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Depreciation Summary"}),e.jsx(Vt,{children:"Overview of depreciation calculations and totals"})]}),e.jsx(ie,{children:mt?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsxs("div",{className:"text-center",children:[e.jsx(kr,{size:"lg",color:"teal"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-3",children:"Loading depreciation summary..."})]})}):qe?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Total Assets"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:qe.totalAssets||0})]}),e.jsx(vn,{className:"h-8 w-8 text-blue-500"})]})}),e.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-600",children:"Total Cost"}),e.jsxs("p",{className:"text-2xl font-bold text-green-900",children:["$",(qe.totalCost||0).toLocaleString()]})]}),e.jsx(Mr,{className:"h-8 w-8 text-green-500"})]})}),e.jsx("div",{className:"bg-orange-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-orange-600",children:"Accumulated Depreciation"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-900",children:["$",(qe.accumulatedDepreciation||0).toLocaleString()]})]}),e.jsx($o,{className:"h-8 w-8 text-orange-500"})]})}),e.jsx("div",{className:"bg-purple-50 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-purple-600",children:"Net Book Value"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-900",children:["$",(qe.netBookValue||0).toLocaleString()]})]}),e.jsx(yn,{className:"h-8 w-8 text-purple-500"})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(yn,{className:"h-8 w-8 text-muted-foreground mx-auto mb-2"}),e.jsx("p",{className:"text-muted-foreground",children:"No depreciation summary available"})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Se,{children:"Depreciation Schedule"}),e.jsx(Vt,{children:"Detailed view of all depreciation records by asset"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(rt,{value:re,onValueChange:le,children:[e.jsx(nt,{className:"w-40",children:e.jsx(it,{placeholder:"Filter by asset"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Assets"}),ct.map(Pe=>e.jsx(W,{value:Pe.id,children:Pe.name},Pe.id))]})]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>At(),children:e.jsx(Ts,{className:"h-4 w-4"})})]})]})}),e.jsx(ie,{children:Xe?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsxs("div",{className:"text-center",children:[e.jsx(kr,{size:"lg",color:"teal"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-3",children:"Loading depreciation schedule..."})]})}):Gt.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(yn,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Depreciation Records Found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Calculate depreciation for your assets to see the schedule here."}),e.jsxs(I,{onClick:()=>{const Pe=new Date;Ct.mutate({year:Pe.getFullYear(),month:Pe.getMonth()+1})},children:[e.jsx(yn,{className:"h-4 w-4 mr-2"}),"Calculate Depreciation"]})]}):e.jsx("div",{className:"space-y-4",children:Object.entries(qt).map(([Pe,_t])=>{var Wr;const bt=ct.find(Zs=>Zs.id===Pe);if(!bt)return null;const ps=_t.reduce((Zs,wr)=>Zs+(wr.amount||0),0),Pr=Number(bt.cost)-ps;return e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:bt.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Cost: $",Number(bt.cost).toLocaleString()," | Accumulated: $",ps.toLocaleString()," | Net Book Value: $",Pr.toLocaleString()]})]}),e.jsx(Oe,{variant:"secondary",children:(Wr=bt.category)==null?void 0:Wr.name})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ol,{children:[e.jsx(Rl,{children:e.jsxs(Dn,{children:[e.jsx(_s,{children:"Period"}),e.jsx(_s,{children:"Depreciation Amount"}),e.jsx(_s,{children:"Accumulated"}),e.jsx(_s,{children:"Method"}),e.jsx(_s,{children:"Date"})]})}),e.jsx(Fl,{children:_t.map((Zs,wr)=>{var xa;return e.jsxs(Dn,{children:[e.jsx(Cs,{className:"font-medium",children:Zs.period}),e.jsxs(Cs,{children:["$",(Zs.amount||0).toLocaleString()]}),e.jsxs(Cs,{children:["$",(Zs.accumulated||0).toLocaleString()]}),e.jsx(Cs,{children:e.jsx(Oe,{variant:"outline",children:((xa=Zs.method)==null?void 0:xa.replace("_"," ").toUpperCase())||"STRAIGHT LINE"})}),e.jsx(Cs,{children:Zs.createdAt?new Date(Zs.createdAt).toLocaleDateString():"-"})]},Zs.id||wr)})})]})})]},Pe)})})})]})]}),e.jsxs(yt,{value:"maintenance",className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg p-6 border border-green-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Asset Maintenance"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Track and manage asset maintenance schedules"})]}),e.jsxs(I,{className:"bg-green-600 hover:bg-green-700 text-white",onClick:()=>y(!0),children:[e.jsx(tf,{className:"h-4 w-4 mr-2"}),"Schedule Maintenance"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-white rounded-lg p-4 border border-green-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Upcoming Maintenance"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:It?"...":(Je==null?void 0:Je.upcomingMaintenance)||0})]}),e.jsx(Xn,{className:"h-8 w-8 text-green-500"})]})}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-green-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Overdue"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:It?"...":(Je==null?void 0:Je.overdueMaintenance)||0})]}),e.jsx(Is,{className:"h-8 w-8 text-red-500"})]})}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-green-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Cost This Year"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:It?"...":`$${((Je==null?void 0:Je.yearlyCost)||0).toLocaleString()}`})]}),e.jsx(Mr,{className:"h-8 w-8 text-green-500"})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Maintenance Records"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Recent maintenance activities and schedules"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(rt,{defaultValue:"all",children:[e.jsx(nt,{className:"w-40",children:e.jsx(it,{placeholder:"Filter by asset"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Assets"}),ct.map(Pe=>e.jsx(W,{value:Pe.id,children:Pe.name},Pe.id))]})]}),e.jsxs(I,{variant:"outline",size:"sm",className:"border-gray-300 text-gray-700 hover:bg-gray-50",onClick:()=>He(),children:[e.jsx(Ts,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]})}),e.jsx("div",{className:"p-6",children:ft?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsxs("div",{className:"text-center",children:[e.jsx(kr,{size:"lg",color:"green"}),e.jsx("p",{className:"text-sm text-gray-600 mt-3",children:"Loading maintenance records..."})]})}):Fe.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(tf,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Maintenance Records Found"}),e.jsx("p",{className:"text-gray-600 mb-6 max-w-md mx-auto",children:"Start tracking maintenance activities for your assets to keep them in optimal condition."}),e.jsxs(I,{className:"bg-green-600 hover:bg-green-700 text-white",children:[e.jsx(tf,{className:"h-4 w-4 mr-2"}),"Add Maintenance Record"]})]}):e.jsx("div",{className:"space-y-4",children:Fe.map(Pe=>{var Pr,Wr,Zs;const _t=wr=>{switch(wr){case"COMPLETED":return"border-green-300 text-green-700";case"IN_PROGRESS":return"border-orange-300 text-orange-700";case"SCHEDULED":return"border-blue-300 text-blue-700";case"CANCELLED":return"border-red-300 text-red-700";default:return"border-gray-300 text-gray-700"}},bt=wr=>{switch(wr){case"PREVENTIVE":return e.jsx(tf,{className:"h-5 w-5 text-blue-600"});case"EMERGENCY":return e.jsx(Is,{className:"h-5 w-5 text-orange-600"});case"INSPECTION":return e.jsx(Xn,{className:"h-5 w-5 text-green-600"});case"CORRECTIVE":return e.jsx(tf,{className:"h-5 w-5 text-red-600"});default:return e.jsx(tf,{className:"h-5 w-5 text-gray-600"})}},ps=wr=>{switch(wr){case"PREVENTIVE":return"bg-blue-100";case"EMERGENCY":return"bg-orange-100";case"INSPECTION":return"bg-green-100";case"CORRECTIVE":return"bg-red-100";default:return"bg-gray-100"}};return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-sm transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 ${ps(Pe.maintenanceType)} rounded-lg`,children:bt(Pe.maintenanceType)}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-gray-900",children:[(Pr=Pe.asset)==null?void 0:Pr.name," - ",Pe.maintenanceType.replace("_"," ")]}),e.jsx("p",{className:"text-sm text-gray-600",children:((Zs=(Wr=Pe.asset)==null?void 0:Wr.category)==null?void 0:Zs.name)||"Unknown Category"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(Oe,{variant:"outline",className:_t(Pe.status),children:Pe.status.replace("_"," ")}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:new Date(Pe.maintenanceDate).toLocaleDateString()})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Type:"}),e.jsx("span",{className:"ml-2 font-medium",children:Pe.maintenanceType.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Cost:"}),e.jsxs("span",{className:"ml-2 font-medium",children:["$",Pe.cost.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Technician:"}),e.jsx("span",{className:"ml-2 font-medium",children:Pe.performedBy||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Invoice:"}),e.jsx("span",{className:"ml-2 font-medium",children:Pe.invoiceNumber||"N/A"})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-3",children:Pe.description}),Pe.extendsUsefulLife&&Pe.lifeExtensionMonths&&e.jsx("div",{className:"mt-2 p-2 bg-green-50 border border-green-200 rounded",children:e.jsxs("p",{className:"text-sm text-green-700",children:[e.jsx("strong",{children:"Life Extension:"})," This maintenance extends the asset's useful life by ",Pe.lifeExtensionMonths," months."]})}),e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-3 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"text-sm text-gray-600",children:"Status:"}),e.jsxs(rt,{value:Pe.status,onValueChange:wr=>{Et.mutate({id:Pe.id,data:{status:wr}})},children:[e.jsx(nt,{className:"w-32 h-8",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"SCHEDULED",children:"Scheduled"}),e.jsx(W,{value:"IN_PROGRESS",children:"In Progress"}),e.jsx(W,{value:"COMPLETED",children:"Completed"}),e.jsx(W,{value:"CANCELLED",children:"Cancelled"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>{S(Pe.id),b({assetId:Pe.assetId,maintenanceDate:Pe.maintenanceDate.split("T")[0],maintenanceType:Pe.maintenanceType,description:Pe.description,performedBy:Pe.performedBy||"",cost:Pe.cost,extendsUsefulLife:Pe.extendsUsefulLife,lifeExtensionMonths:Pe.lifeExtensionMonths||0,invoiceNumber:Pe.invoiceNumber||"",warrantyInfo:Pe.warrantyInfo||"",status:Pe.status}),y(!0)},className:"text-blue-600 hover:text-blue-700",children:[e.jsx(ln,{className:"h-4 w-4 mr-1"}),"Edit"]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>{confirm("Are you sure you want to delete this maintenance record?")&&Pt.mutate(Pe.id)},disabled:Pt.isPending,className:"text-red-600 hover:text-red-700",children:[e.jsx(hn,{className:"h-4 w-4 mr-1"}),"Delete"]})]})]})]},Pe.id)})})})]})]}),e.jsxs(yt,{value:"reports",className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 rounded-lg p-6 border border-purple-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Fixed Asset Reports"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Generate comprehensive reports and analytics"})]}),e.jsx(I,{className:"bg-purple-600 hover:bg-purple-700 text-white",onClick:()=>ms("asset-summary"),disabled:rs.isPending,children:rs.isPending?e.jsxs(e.Fragment,{children:[e.jsx(kr,{size:"sm",color:"gray",className:"mr-2"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Zt,{className:"h-4 w-4 mr-2"}),"Generate Report"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white rounded-lg p-4 border border-purple-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Assets"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(qe==null?void 0:qe.totalAssets)||0})]}),e.jsx(vn,{className:"h-8 w-8 text-purple-500"})]})}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-purple-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Value"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",((qe==null?void 0:qe.totalCost)||0).toLocaleString()]})]}),e.jsx(Mr,{className:"h-8 w-8 text-purple-500"})]})}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-purple-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Depreciation"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",((qe==null?void 0:qe.accumulatedDepreciation)||0).toLocaleString()]})]}),e.jsx($o,{className:"h-8 w-8 text-purple-500"})]})}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-purple-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Net Book Value"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",((qe==null?void 0:qe.netBookValue)||0).toLocaleString()]})]}),e.jsx(yn,{className:"h-8 w-8 text-purple-500"})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(lr,{className:"h-6 w-6 text-blue-600"})}),e.jsx(Oe,{variant:"outline",className:"border-blue-300 text-blue-700",children:"Summary"})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Asset Summary Report"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Comprehensive overview of all fixed assets including cost, depreciation, and current values."}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Assets:"}),e.jsx("span",{className:"font-medium",children:(qe==null?void 0:qe.totalAssets)||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Cost:"}),e.jsxs("span",{className:"font-medium",children:["$",((qe==null?void 0:qe.totalCost)||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Net Book Value:"}),e.jsxs("span",{className:"font-medium",children:["$",((qe==null?void 0:qe.netBookValue)||0).toLocaleString()]})]})]}),e.jsx(I,{className:"w-full mt-4 bg-blue-600 hover:bg-blue-700 text-white",onClick:()=>ms("asset-summary"),disabled:rs.isPending,children:rs.isPending?e.jsxs(e.Fragment,{children:[e.jsx(kr,{size:"sm",color:"gray",className:"mr-2"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Zt,{className:"h-4 w-4 mr-2"}),"Generate Report"]})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx($o,{className:"h-6 w-6 text-green-600"})}),e.jsx(Oe,{variant:"outline",className:"border-green-300 text-green-700",children:"Depreciation"})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Depreciation Schedule"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Detailed monthly depreciation calculations and accumulated depreciation by asset."}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Current Year:"}),e.jsx("span",{className:"font-medium",children:new Date().getFullYear()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Depreciation:"}),e.jsxs("span",{className:"font-medium",children:["$",((qe==null?void 0:qe.accumulatedDepreciation)||0).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Records:"}),e.jsx("span",{className:"font-medium",children:_e.length})]})]}),e.jsx(I,{className:"w-full mt-4 bg-green-600 hover:bg-green-700 text-white",onClick:()=>ms("depreciation-schedule",new Date().getFullYear()),disabled:rs.isPending,children:rs.isPending?e.jsxs(e.Fragment,{children:[e.jsx(kr,{size:"sm",color:"gray",className:"mr-2"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx($o,{className:"h-4 w-4 mr-2"}),"Generate Report"]})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-3 bg-orange-100 rounded-lg",children:e.jsx(vn,{className:"h-6 w-6 text-orange-600"})}),e.jsx(Oe,{variant:"outline",className:"border-orange-300 text-orange-700",children:"Register"})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Asset Register"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Complete listing of all fixed assets with acquisition details and current status."}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Active Assets:"}),e.jsx("span",{className:"font-medium",children:ct.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Categories:"}),e.jsx("span",{className:"font-medium",children:tt.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Avg. Value:"}),e.jsxs("span",{className:"font-medium",children:["$",qe!=null&&qe.totalCost&&(qe!=null&&qe.totalAssets)?(qe.totalCost/qe.totalAssets).toLocaleString():"0"]})]})]}),e.jsx(I,{className:"w-full mt-4 bg-orange-600 hover:bg-orange-700 text-white",onClick:()=>ms("asset-register"),disabled:rs.isPending,children:rs.isPending?e.jsxs(e.Fragment,{children:[e.jsx(kr,{size:"sm",color:"gray",className:"mr-2"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(vn,{className:"h-4 w-4 mr-2"}),"Generate Report"]})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(Kh,{className:"h-6 w-6 text-purple-600"})}),e.jsx(Oe,{variant:"outline",className:"border-purple-300 text-purple-700",children:"Categories"})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Category Summary"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Asset distribution and values by category with depreciation method analysis."}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Categories:"}),e.jsx("span",{className:"font-medium",children:tt.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Most Used Method:"}),e.jsx("span",{className:"font-medium",children:"Straight Line"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Avg. Useful Life:"}),e.jsxs("span",{className:"font-medium",children:[tt.length>0?Math.round(tt.reduce((Pe,_t)=>Pe+(_t.usefulLifeMonths||0),0)/tt.length/12):0," years"]})]})]}),e.jsx(I,{className:"w-full mt-4 bg-purple-600 hover:bg-purple-700 text-white",onClick:()=>ms("category-summary"),disabled:rs.isPending,children:rs.isPending?e.jsxs(e.Fragment,{children:[e.jsx(kr,{size:"sm",color:"gray",className:"mr-2"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Kh,{className:"h-4 w-4 mr-2"}),"Generate Report"]})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:e.jsx(Cr,{className:"h-6 w-6 text-red-600"})}),e.jsx(Oe,{variant:"outline",className:"border-red-300 text-red-700",children:"Aging"})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Asset Aging Report"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Analysis of asset age distribution and remaining useful life by category."}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"New Assets (0-1yr):"}),e.jsx("span",{className:"font-medium",children:"2"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Mid-life (1-5yr):"}),e.jsx("span",{className:"font-medium",children:"3"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Mature (5+yr):"}),e.jsx("span",{className:"font-medium",children:"1"})]})]}),e.jsx(I,{className:"w-full mt-4 bg-red-600 hover:bg-red-700 text-white",onClick:()=>ms("aging"),disabled:rs.isPending,children:rs.isPending?e.jsxs(e.Fragment,{children:[e.jsx(kr,{size:"sm",color:"gray",className:"mr-2"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Cr,{className:"h-4 w-4 mr-2"}),"Generate Report"]})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"p-3 bg-indigo-100 rounded-lg",children:e.jsx(kn,{className:"h-6 w-6 text-indigo-600"})}),e.jsx(Oe,{variant:"outline",className:"border-indigo-300 text-indigo-700",children:"Compliance"})]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Compliance Report"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Audit trail and compliance status for regulatory requirements and internal policies."}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Compliant Assets:"}),e.jsx("span",{className:"font-medium text-green-600",children:ct.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Audit Trail:"}),e.jsx("span",{className:"font-medium",children:"Complete"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Last Audit:"}),e.jsx("span",{className:"font-medium",children:"Dec 2024"})]})]}),e.jsx(I,{className:"w-full mt-4 bg-indigo-600 hover:bg-indigo-700 text-white",onClick:()=>ms("compliance"),disabled:rs.isPending,children:rs.isPending?e.jsxs(e.Fragment,{children:[e.jsx(kr,{size:"sm",color:"gray",className:"mr-2"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(kn,{className:"h-4 w-4 mr-2"}),"Generate Report"]})})]})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Export Options"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(I,{variant:"outline",className:"h-12 border-gray-300 text-gray-700 hover:bg-gray-50",children:[e.jsx(Zt,{className:"h-5 w-5 mr-2"}),"Export to PDF"]}),e.jsxs(I,{variant:"outline",className:"h-12 border-gray-300 text-gray-700 hover:bg-gray-50",children:[e.jsx(Yf,{className:"h-5 w-5 mr-2"}),"Export to Excel"]}),e.jsxs(I,{variant:"outline",className:"h-12 border-gray-300 text-gray-700 hover:bg-gray-50",children:[e.jsx(Dd,{className:"h-5 w-5 mr-2"}),"Email Report"]})]})]})})]})]}),e.jsx(ts,{open:u,onOpenChange:h,children:e.jsxs(ss,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(as,{children:[e.jsx(is,{children:c?"Edit Asset":"Add New Asset"}),e.jsx(Ks,{children:c?"Update asset information":"Create a new fixed asset"})]}),e.jsx(wn,{asset:c,onSave:Pe=>{c?Ht.mutate({id:c.id,data:Pe}):As.mutate(Pe)},onCancel:()=>{h(!1),d(null),Ae({})}})]})}),e.jsx(ts,{open:F,onOpenChange:A,children:e.jsxs(ss,{children:[e.jsxs(as,{children:[e.jsx(is,{children:"Delete Fixed Asset"}),e.jsxs(Ks,{children:['Are you sure you want to delete "',T==null?void 0:T.name,'"? This action cannot be undone.']})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4 mb-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(Is,{className:"h-5 w-5 text-yellow-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Warning"}),e.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:e.jsx("p",{children:"If this asset has depreciation records, deletion will be prevented. Consider disposing the asset instead."})})]})]})}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:Hs,children:"Cancel"}),e.jsx(I,{variant:"destructive",onClick:jn,disabled:xs.isPending,children:xs.isPending?e.jsxs(e.Fragment,{children:[e.jsx(kr,{size:"sm",color:"gray",className:"mr-2"}),"Deleting Asset..."]}):"Delete Asset"})]})]})}),e.jsx(ts,{open:f,onOpenChange:m,children:e.jsxs(ss,{className:"max-w-2xl",children:[e.jsxs(as,{children:[e.jsx(is,{children:P?"Edit Category":"Add New Category"}),e.jsx(Ks,{children:P?"Update category information":"Create a new fixed asset category"})]}),e.jsx(pMe,{category:P,isLoading:ke.isPending||gt.isPending,onSave:Pe=>{P?gt.mutate({id:P.id,data:Pe}):ke.mutate(Pe)},onCancel:()=>{m(!1),q(null),Ae({})}})]})}),e.jsx(ts,{open:D,onOpenChange:se,children:e.jsxs(ss,{children:[e.jsxs(as,{children:[e.jsx(is,{children:"Delete Category"}),e.jsxs(Ks,{children:['Are you sure you want to delete "',he==null?void 0:he.name,'"? This action cannot be undone.']})]}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4 mb-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(Is,{className:"h-5 w-5 text-red-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Warning"}),e.jsx("div",{className:"mt-2 text-sm text-red-700",children:e.jsx("p",{children:"Deleting this category will affect all assets assigned to it. Make sure to reassign or delete those assets first."})})]})]})}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:In,children:"Cancel"}),e.jsx(I,{variant:"destructive",onClick:qn,disabled:us.isPending,children:us.isPending?e.jsxs(e.Fragment,{children:[e.jsx(kr,{size:"sm",color:"gray",className:"mr-2"}),"Deleting Category..."]}):"Delete Category"})]})]})}),e.jsx(ts,{open:v,onOpenChange:y,children:e.jsxs(ss,{className:"max-w-2xl",children:[e.jsxs(as,{children:[e.jsx(is,{children:C?"Edit Maintenance Record":"Schedule Maintenance Record"}),e.jsx(Ks,{children:C?"Update the maintenance record details below.":"Create a new maintenance record for an asset. You can schedule future maintenance or record completed work."})]}),e.jsxs("form",{onSubmit:Yr,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"assetId",children:"Asset *"}),e.jsxs(rt,{value:j.assetId,onValueChange:Pe=>$r("assetId",Pe),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select an asset"})}),e.jsx(at,{children:ct.map(Pe=>{var _t;return e.jsxs(W,{value:Pe.id,children:[Pe.name," - ",(_t=Pe.category)==null?void 0:_t.name]},Pe.id)})})]}),w.assetId&&e.jsx("p",{className:"text-sm text-red-600",children:w.assetId})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"maintenanceDate",children:"Maintenance Date *"}),e.jsx(ge,{id:"maintenanceDate",type:"date",value:j.maintenanceDate,onChange:Pe=>$r("maintenanceDate",Pe.target.value)}),w.maintenanceDate&&e.jsx("p",{className:"text-sm text-red-600",children:w.maintenanceDate})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"maintenanceType",children:"Maintenance Type *"}),e.jsxs(rt,{value:j.maintenanceType,onValueChange:Pe=>$r("maintenanceType",Pe),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select type"})}),e.jsxs(at,{children:[e.jsx(W,{value:"PREVENTIVE",children:"Preventive"}),e.jsx(W,{value:"CORRECTIVE",children:"Corrective"}),e.jsx(W,{value:"EMERGENCY",children:"Emergency"}),e.jsx(W,{value:"INSPECTION",children:"Inspection"})]})]}),w.maintenanceType&&e.jsx("p",{className:"text-sm text-red-600",children:w.maintenanceType})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"status",children:"Status"}),e.jsxs(rt,{value:j.status,onValueChange:Pe=>$r("status",Pe),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select status"})}),e.jsxs(at,{children:[e.jsx(W,{value:"SCHEDULED",children:"Scheduled"}),e.jsx(W,{value:"IN_PROGRESS",children:"In Progress"}),e.jsx(W,{value:"COMPLETED",children:"Completed"}),e.jsx(W,{value:"CANCELLED",children:"Cancelled"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"description",children:"Description *"}),e.jsx(Xs,{id:"description",placeholder:"Describe the maintenance work to be performed...",value:j.description,onChange:Pe=>$r("description",Pe.target.value),rows:3}),w.description&&e.jsx("p",{className:"text-sm text-red-600",children:w.description})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"performedBy",children:"Performed By"}),e.jsx(ge,{id:"performedBy",placeholder:"Technician or service provider",value:j.performedBy,onChange:Pe=>$r("performedBy",Pe.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"cost",children:"Cost ($)"}),e.jsx(ge,{id:"cost",type:"number",step:"0.01",min:"0",placeholder:"0.00",value:j.cost,onChange:Pe=>$r("cost",parseFloat(Pe.target.value)||0)}),w.cost&&e.jsx("p",{className:"text-sm text-red-600",children:w.cost})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"invoiceNumber",children:"Invoice Number"}),e.jsx(ge,{id:"invoiceNumber",placeholder:"Invoice or reference number",value:j.invoiceNumber,onChange:Pe=>$r("invoiceNumber",Pe.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"warrantyInfo",children:"Warranty Information"}),e.jsx(ge,{id:"warrantyInfo",placeholder:"Warranty details or coverage",value:j.warrantyInfo,onChange:Pe=>$r("warrantyInfo",Pe.target.value)})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ka,{id:"extendsUsefulLife",checked:j.extendsUsefulLife,onCheckedChange:Pe=>$r("extendsUsefulLife",Pe)}),e.jsx(B,{htmlFor:"extendsUsefulLife",className:"text-sm font-medium",children:"This maintenance extends the asset's useful life"})]}),j.extendsUsefulLife&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"lifeExtensionMonths",children:"Life Extension (Months)"}),e.jsx(ge,{id:"lifeExtensionMonths",type:"number",min:"1",placeholder:"Number of months",value:j.lifeExtensionMonths,onChange:Pe=>$r("lifeExtensionMonths",parseInt(Pe.target.value)||0)}),w.lifeExtensionMonths&&e.jsx("p",{className:"text-sm text-red-600",children:w.lifeExtensionMonths})]})]}),e.jsxs(Xr,{children:[e.jsx(I,{type:"button",variant:"outline",onClick:()=>{y(!1),S(null),b({assetId:"",maintenanceDate:new Date().toISOString().split("T")[0],maintenanceType:"PREVENTIVE",description:"",performedBy:"",cost:0,extendsUsefulLife:!1,lifeExtensionMonths:0,invoiceNumber:"",warrantyInfo:"",status:"SCHEDULED"})},children:"Cancel"}),e.jsx(I,{type:"submit",disabled:We.isPending||Et.isPending,className:"bg-green-600 hover:bg-green-700",children:We.isPending||Et.isPending?e.jsxs(e.Fragment,{children:[e.jsx(kr,{size:"sm",color:"gray",className:"mr-2"}),C?"Updating...":"Creating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(tf,{className:"h-4 w-4 mr-2"}),C?"Update Maintenance":"Schedule Maintenance"]})})]})]})]})}),e.jsx(ts,{open:M,onOpenChange:G,children:e.jsxs(ss,{children:[e.jsxs(as,{children:[e.jsx(is,{children:"Post Fixed Asset"}),e.jsxs(Ks,{children:['Are you sure you want to post "',L==null?void 0:L.name,'"?',z!=null&&z.needsAutoCreation?" This will automatically create the necessary accounting accounts and journal entries.":" This will create accounting entries and cannot be undone."]})]}),L&&e.jsx("div",{className:"space-y-4",children:oe?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(kr,{size:"lg",color:"teal"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-3",children:"Checking existing accounts..."})]})}):z?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Asset Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Name:"}),e.jsx("span",{className:"ml-2 font-medium",children:L.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Category:"}),e.jsx("span",{className:"ml-2 font-medium",children:(Vn=L.category)==null?void 0:Vn.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Cost:"}),e.jsxs("span",{className:"ml-2 font-medium",children:["$",Number(L.cost).toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Acquisition Date:"}),e.jsx("span",{className:"ml-2 font-medium",children:L.acquisitionDate})]})]})]}),z.needsAutoCreation?e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(Ln,{className:"h-5 w-5 text-blue-400 mt-0.5"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Automatic Account Creation"}),e.jsxs("div",{className:"mt-2 text-sm text-blue-700",children:[e.jsx("p",{className:"mb-2",children:"The following accounts will be automatically created:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[!z.assetAccountExists&&e.jsxs("li",{children:[e.jsx("strong",{children:"Fixed Asset Account:"}),' "',z.expectedAssetAccountName,'" (FA-',(ut=(De=L.category)==null?void 0:De.name)==null?void 0:ut.toUpperCase().replace(/[^A-Z0-9]/g,""),")"]}),!z.cashAccountExists&&e.jsxs("li",{children:[e.jsx("strong",{children:"Cash Account:"}),' "',z.expectedCashAccountName,'" (CASH-001)']}),z.assetAccountExists&&z.cashAccountExists&&e.jsx("li",{children:"All required accounts already exist - no new accounts will be created"})]}),e.jsxs("p",{className:"mt-2 font-medium",children:["Reference: FA-",L.id]})]})]})]})}):e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(Ln,{className:"h-5 w-5 text-blue-400 mt-0.5"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Accounting Impact"}),e.jsxs("div",{className:"mt-2 text-sm text-blue-700",children:[e.jsx("p",{className:"mb-2",children:"This will create the following journal entries:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Debit:"})," Fixed Asset Account - $",Number(L.cost).toLocaleString()]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Credit:"})," Cash Account - $",Number(L.cost).toLocaleString()]})]}),e.jsxs("p",{className:"mt-2 font-medium",children:["Reference: FA-",L.id]})]})]})]})}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(Is,{className:"h-5 w-5 text-yellow-400"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Important Notice"}),e.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:e.jsxs("p",{children:["Once posted, this asset will be included in your depreciation calculations. The status cannot be changed back to DRAFT.",z.needsAutoCreation&&e.jsx("span",{className:"block mt-1 font-medium",children:"The necessary accounting accounts will be automatically created and linked to this asset category for future use."})]})})]})]})})]}):e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Unable to check account configuration"})})}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:Ns,children:"Cancel"}),e.jsx(I,{onClick:Ws,disabled:Bs.isPending,className:"bg-green-600 hover:bg-green-700 text-white",children:Bs.isPending?e.jsxs(e.Fragment,{children:[e.jsx(kr,{size:"sm",color:"gray",className:"mr-2"}),"Posting Asset..."]}):e.jsxs(e.Fragment,{children:[e.jsx(bs,{className:"h-4 w-4 mr-2"}),z!=null&&z.needsAutoCreation?"Post Asset & Create Accounts":"Post Asset"]})})]})]})})]})}):e.jsx(Kr,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(kr,{size:"xl",color:"teal"}),e.jsx("h3",{className:"text-lg font-semibold mt-4 mb-2",children:"Loading Fixed Assets"}),e.jsx("p",{className:"text-muted-foreground",children:"Please wait while we initialize your asset management system..."})]})})})}const vMe=({companyId:s})=>{const t=un(""),[r,n]=x.useState("conversational"),[a,i]=x.useState(""),[o,l]=x.useState(null),[c,d]=x.useState(!1),[u,h]=x.useState(""),[f,m]=x.useState(""),[p,g]=x.useState(null),[v,y]=x.useState(null),[j,b]=x.useState(!1),[w,N]=x.useState(null),[C,S]=x.useState(null),[_,k]=x.useState(null),[F,A]=x.useState("fast"),[T,V]=x.useState(null),M=()=>{console.log("Document query triggered")},G=()=>{console.log("Compliance analysis triggered")},L=[{id:"documents",label:"Document Intelligence",icon:Zt},{id:"analytics",label:"Predictive Analytics",icon:$s},{id:"compliance",label:"Compliance & Audit",icon:kn}],J=async()=>{if(!a.trim())return;if(!s){k("Company ID is required"),l(null);return}const Q=Date.now();V(null);const P=localStorage.getItem("tenant_id");if(!P){k("Tenant ID is required");return}d(!0),k(null);try{const q=await fetch(`${t}/api/llama-ai/conversational/chat`,{method:"POST",headers:{"Content-Type":"application/json","x-tenant-id":P,"x-company-id":s,Authorization:`Bearer ${localStorage.getItem("auth_token")||""}`},body:JSON.stringify({message:a,companyId:s,sessionId:`session_${Date.now()}`,mode:F})});if(!q.ok){const he=await q.text();throw new Error(`Request failed (${q.status}): ${he||"Unknown error"}`)}const D=await q.json(),se=Date.now();if(V(se-Q),D.success)l(D.data);else throw new Error(D.error||"Failed to process query")}catch(q){k(q instanceof Error?q.message:"Unknown error"),l(null)}finally{d(!1)}},z=async Q=>{k(null),d(!0);try{const P=await new Promise((se,he)=>{const be=new FileReader;be.onload=()=>se(be.result),be.onerror=()=>he(new Error("Failed to read file")),be.readAsDataURL(Q)});g(P),y(P);const q=await fetch(`${t}/api/llama-ai/documents/process-upload`,{method:"POST",headers:{"Content-Type":"application/json","x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({imageBase64:P,companyId:s})});if(!q.ok){const se=await q.text();k(`Upload failed (${q.status}): ${se||"Unknown error"}`);return}const D=await q.json();D.success?l({message:"Upload processed successfully. Extracted data and insights shown below.",confidence:D.data.confidence??.8,intent:"document",entities:{extracted:D.data.extractedData,rawText:D.data.rawText},suggestions:D.data.suggestions??[],actions:[],insights:(D.data.insights||[]).map(se=>({type:se.type,description:se.description,confidence:se.confidence,impact:se.impact})),followUpQuestions:[]}):k(D.error||"Failed to process upload")}catch(P){k(P instanceof Error?P.message:"Unknown upload error")}finally{d(!1)}},U=async()=>{if(!v){k("Please upload a file first");return}k(null),d(!0);try{const Q=await fetch(`${t}/api/llama-ai/documents/process-upload`,{method:"POST",headers:{"Content-Type":"application/json","x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({imageBase64:v,companyId:s})});if(!Q.ok){const q=await Q.text();k(`Upload processing failed (${Q.status}): ${q||"Unknown error"}`);return}const P=await Q.json();P.success?l({message:"Upload processed successfully. Extracted data and insights shown below.",confidence:P.data.confidence??.8,intent:"document",entities:{extracted:P.data.extractedData,rawText:P.data.rawText},suggestions:P.data.suggestions??[],actions:[],insights:(P.data.insights||[]).map(q=>({type:q.type,description:q.description,confidence:q.confidence,impact:q.impact})),followUpQuestions:[]}):k(P.error||"Failed to process uploaded file")}catch(Q){k(Q instanceof Error?Q.message:"Unknown upload processing error")}finally{d(!1)}},oe=async()=>{d(!0);try{const Q=await fetch(`${t}/api/llama-ai/analytics/comprehensive-forecast`,{method:"POST",headers:{"Content-Type":"application/json","x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({companyId:s,months:12})});if(!Q.ok){const q=await Q.text();k(`Predictive analysis failed (${Q.status}): ${q||"Unknown error"}`);return}const P=await Q.json();P.success?(N(P.data),b(!1),k(null)):k(P.error||"Failed to generate forecast")}catch(Q){k(Q instanceof Error?Q.message:"Unknown error generating forecast"),N(null);return}if(!o.ok){const Q=await o.text();k(`Request failed (${o.status}): ${Q||"Unknown error"}`),S(null);return}try{const Q=await o.json();Q.success?(S(Q.data),k(null)):(k(Q.error||"Compliance analysis failed"),S(null))}catch(Q){k(Q instanceof Error?Q.message:"Error parsing compliance analysis response"),S(null)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 border border-purple-200 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(sa,{className:"h-8 w-8 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-purple-900",children:"Llama AI-Powered Intelligence"}),e.jsx("p",{className:"text-purple-700",children:"Advanced conversational AI, document processing, and predictive analytics"})]})]})}),e.jsx("div",{className:"mb-6",children:e.jsx(l3,{tabs:L.map(Q=>({id:Q.id,label:Q.label,icon:Q.icon})),value:r,onChange:Q=>n(Q)})}),r==="conversational"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center space-x-2",children:[e.jsx(La,{className:"h-5 w-5"}),e.jsx("span",{children:"Chat with Llama AI"})]}),e.jsx(Vt,{children:"Ask questions about your financial data, get insights, and receive intelligent recommendations"})]}),e.jsxs(ie,{className:"space-y-4",children:[_&&e.jsx("div",{className:"p-3 rounded-md border border-red-200 bg-red-50 text-red-800 text-sm",children:_}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Mode:"}),["fast","balanced","accurate"].map(Q=>e.jsx("button",{type:"button",onClick:()=>A(Q),className:`text-xs px-2 py-1 rounded-full border ${F===Q?"bg-purple-600 text-white border-purple-600":"bg-white text-gray-700 hover:bg-gray-50"}`,"aria-pressed":F===Q,children:Q.charAt(0).toUpperCase()+Q.slice(1)},Q)),T!=null&&e.jsxs("span",{className:"ml-auto text-xs text-gray-500",children:["Latency: ",T," ms"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["What are my top 3 expense categories this month?","Forecast my cash flow for the next quarter","Are there any unusual transactions this week?","How can I improve my gross margin?"].map(Q=>e.jsx("button",{type:"button",onClick:()=>i(Q),className:"text-xs px-2 py-1 rounded-full border bg-white hover:bg-gray-50 text-gray-700",children:Q},Q))}),e.jsx(Xs,{placeholder:"Ask me anything about your finances... e.g., 'What are my biggest expenses this month?' or 'How is my cash flow trending?'",value:a,onChange:Q=>i(Q.target.value),rows:4}),e.jsx(I,{onClick:J,disabled:c||!a.trim(),className:"w-full",children:c?e.jsxs(e.Fragment,{children:[e.jsx(On,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(wd,{className:"mr-2 h-4 w-4"}),"Send Message"]})})]})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center space-x-2",children:[e.jsx(sa,{className:"h-5 w-5"}),e.jsx("span",{children:"AI Response"}),o&&e.jsxs(Oe,{variant:"outline",className:"ml-auto",children:[Math.round(o.confidence*100),"% confidence"]})]})}),e.jsx(ie,{children:o?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-gray-900",children:o.message})}),o.insights&&o.insights.length>0?e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Insights"}),e.jsx("div",{className:"space-y-2",children:o.insights.map((Q,P)=>e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(ic,{className:"h-4 w-4 text-yellow-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-700",children:Q.description}),e.jsxs(Oe,{variant:"outline",className:"text-xs",children:[Q.impact," impact"]})]})]},P))})]}):null,o.suggestions&&o.suggestions.length>0?e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Suggestions"}),e.jsx("ul",{className:"space-y-1",children:o.suggestions.map((Q,P)=>e.jsxs("li",{className:"text-sm text-gray-600 flex items-start space-x-2",children:[e.jsx(bs,{className:"h-3 w-3 text-green-500 mt-1"}),e.jsx("span",{children:Q})]},P))})]}):null,o.followUpQuestions&&o.followUpQuestions.length>0?e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Follow-up Questions"}),e.jsx("div",{className:"space-y-1",children:o.followUpQuestions.map((Q,P)=>e.jsx("button",{onClick:()=>i(Q),className:"text-sm text-blue-600 hover:text-blue-800 text-left",children:Q},P))})]}):null]}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(La,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Send a message to start chatting with Llama AI"})]})})]})]}),r==="documents"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center space-x-2",children:[e.jsx(Zt,{className:"h-5 w-5"}),e.jsx("span",{children:"Document Analysis"})]}),e.jsx(Vt,{children:"Upload documents and ask intelligent questions about their content"})]}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload Receipt / Invoice Image"}),e.jsx("input",{type:"file",accept:"image/*,application/pdf",onChange:Q=>{var q;const P=(q=Q.target.files)==null?void 0:q[0];P&&z(P)},className:"block w-full text-sm text-gray-600 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-medium file:bg-purple-50 file:text-purple-700 hover:file:bg-purple-100"}),p&&e.jsx("div",{className:"mt-3",children:e.jsx("img",{src:p,alt:"Uploaded preview",className:"max-h-40 rounded border"})}),e.jsx("div",{className:"mt-3 flex gap-2",children:e.jsx(I,{onClick:U,disabled:c||!v,children:c?e.jsxs(e.Fragment,{children:[e.jsx(On,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing Upload..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Za,{className:"mr-2 h-4 w-4"}),"Process Uploaded File"]})})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Document Content"}),e.jsx(Xs,{placeholder:"Paste document content here (invoices, contracts, receipts, etc.)",value:u,onChange:Q=>h(Q.target.value),rows:6})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Your Question"}),e.jsx(ge,{placeholder:"e.g., 'What is the total amount?' or 'Who is the vendor?'",value:f,onChange:Q=>m(Q.target.value)})]}),e.jsx(I,{onClick:M,disabled:c||!u.trim()||!f.trim(),className:"w-full",children:c?e.jsxs(e.Fragment,{children:[e.jsx(On,{className:"mr-2 h-4 w-4 animate-spin"}),"Analyzing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Za,{className:"mr-2 h-4 w-4"}),"Analyze Document"]})})]})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center space-x-2",children:[e.jsx(sa,{className:"h-5 w-5"}),e.jsx("span",{children:"Analysis Results"})]})}),e.jsx(ie,{children:o?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 bg-gray-50 rounded-lg",children:e.jsx("p",{className:"text-gray-900",children:o.message})}),o.entities&&Object.keys(o.entities).length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Extracted Entities"}),e.jsx("div",{className:"space-y-2",children:Object.entries(o.entities).map(([Q,P])=>e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"font-medium text-gray-600 mb-1",children:[Q,":"]}),Array.isArray(P)?e.jsx("div",{className:"text-gray-900",children:P.map((q,D)=>e.jsxs("span",{className:"mr-1",children:[typeof q=="object"?JSON.stringify(q):String(q),D<P.length-1?",":""]},D))}):typeof P=="object"&&P!==null?e.jsx("pre",{className:"bg-gray-100 rounded-md p-2 text-xs text-gray-800 overflow-auto",children:JSON.stringify(P,null,2)}):e.jsx("span",{className:"text-gray-900",children:String(P)})]},Q))})]})]}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Zt,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Upload a document and ask a question to get started"})]})})]})]}),r==="analytics"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center space-x-2",children:[e.jsx($s,{className:"h-5 w-5"}),e.jsx("span",{children:"Predictive Analytics"})]}),e.jsx(Vt,{children:"Generate comprehensive business forecasts and insights using Llama AI"})]}),e.jsx(ie,{children:e.jsx(I,{onClick:oe,disabled:c,className:"w-full",children:c?e.jsxs(e.Fragment,{children:[e.jsx(On,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating Forecast..."]}):e.jsxs(e.Fragment,{children:[e.jsx(lr,{className:"mr-2 h-4 w-4"}),"Generate 12-Month Business Forecast"]})})})]}),w?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center space-x-2",children:[e.jsx($s,{className:"h-5 w-5"}),e.jsx("span",{children:"Forecasts"})]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-3",children:w.forecasts&&w.forecasts.length>0?e.jsxs(e.Fragment,{children:[(j?w.forecasts:w.forecasts.slice(0,4)).map((Q,P)=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"font-medium text-gray-900 capitalize",children:(Q.type||"unknown").replace("_"," ")}),e.jsx(Oe,{variant:"outline",children:Q.trend||"stable"})]}),e.jsxs("div",{className:"text-lg font-bold text-gray-900",children:["$",Q.predictedValue?Q.predictedValue.toLocaleString():"0"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[Q.period||"Unknown","  ",Math.round((Q.confidence||0)*100),"% confidence"]})]},P)),w.forecasts.length>4&&e.jsx("div",{className:"text-center pt-2",children:e.jsx(I,{variant:"outline",size:"sm",onClick:()=>b(!j),children:j?"Show Less":`Show All ${w.forecasts.length} Forecasts`})})]}):null})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center space-x-2",children:[e.jsx(ic,{className:"h-5 w-5"}),e.jsx("span",{children:"Insights"})]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-3",children:w.insights&&w.insights.length>0?w.insights.map((Q,P)=>e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:"font-medium text-blue-900",children:Q.title}),e.jsxs(Oe,{variant:"outline",className:"text-xs",children:[Q.impact," impact"]})]}),e.jsx("p",{className:"text-sm text-blue-700",children:Q.description}),e.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[Math.round(Q.confidence*100),"% confidence"]})]},P)):null})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center space-x-2",children:[e.jsx(bs,{className:"h-5 w-5"}),e.jsx("span",{children:"Recommendations"})]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-3",children:w.recommendations&&w.recommendations.length>0?w.recommendations.map((Q,P)=>e.jsxs("div",{className:"p-3 bg-green-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("span",{className:"font-medium text-green-900",children:Q.title}),e.jsxs(Oe,{variant:"outline",className:"text-xs",children:[Q.priority," priority"]})]}),e.jsx("p",{className:"text-sm text-green-700",children:Q.description}),e.jsxs("div",{className:"text-xs text-green-600 mt-1",children:["Expected impact: ",Math.round(Q.expectedImpact*100),"%"]})]},P)):null})})]})]})}):e.jsx("div",{className:"p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx($s,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:'Click "Generate 12-Month Business Forecast" to get started'})]})})]}),r==="compliance"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center space-x-2",children:[e.jsx(kn,{className:"h-5 w-5"}),e.jsx("span",{children:"Compliance & Audit Analysis"})]}),e.jsx(Vt,{children:"Run an automated compliance risk assessment, detect violations, and get remediation recommendations"})]}),e.jsxs(ie,{children:[_&&e.jsx("div",{className:"mb-4 p-3 rounded-md border border-red-200 bg-red-50 text-red-800 text-sm",children:_}),e.jsx(I,{onClick:G,disabled:c,className:"w-full",children:c?e.jsxs(e.Fragment,{children:[e.jsx(On,{className:"mr-2 h-4 w-4 animate-spin"}),"Analyzing Compliance..."]}):e.jsxs(e.Fragment,{children:[e.jsx(kn,{className:"mr-2 h-4 w-4"}),"Run Compliance Analysis"]})})]})]}),C&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center space-x-2",children:[e.jsx(kn,{className:"h-5 w-5"}),e.jsx("span",{children:"Compliance Overview"})]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Compliance Score"}),e.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[Math.round(C.complianceScore)," / 100"]})]}),C.riskAssessment&&e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Overall Risk"}),e.jsx("div",{className:"text-lg font-semibold capitalize",children:C.riskAssessment.overallRisk}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Next review: ",new Date(C.riskAssessment.nextReviewDate).toLocaleDateString()]})]})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center space-x-2",children:[e.jsx(Ln,{className:"h-5 w-5"}),e.jsx("span",{children:"Detected Violations"}),e.jsx(Oe,{variant:"outline",className:"ml-auto",children:(C.violations||[]).length})]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-3",children:[(C.violations||[]).slice(0,5).map((Q,P)=>e.jsxs("div",{className:"p-3 bg-red-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"font-medium text-red-900 capitalize",children:Q.type}),e.jsx(Oe,{variant:"outline",className:"text-xs capitalize",children:Q.severity})]}),e.jsx("div",{className:"text-sm text-red-800",children:Q.description}),Q.regulation&&e.jsxs("div",{className:"text-xs text-red-700 mt-1",children:["Regulation: ",Q.regulation]}),Q.remediation&&e.jsxs("div",{className:"text-xs text-red-700 mt-1",children:["Remediation: ",Q.remediation]})]},P)),(C.violations||[]).length===0&&e.jsx("div",{className:"text-sm text-gray-500",children:"No violations detected."})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center space-x-2",children:[e.jsx(bs,{className:"h-5 w-5"}),e.jsx("span",{children:"Recommendations"}),e.jsx(Oe,{variant:"outline",className:"ml-auto",children:(C.recommendations||[]).length})]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-3",children:[(C.recommendations||[]).slice(0,5).map((Q,P)=>e.jsxs("div",{className:"p-3 bg-green-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"font-medium text-green-900",children:Q.title}),e.jsxs(Oe,{variant:"outline",className:"text-xs capitalize",children:[Q.priority," priority"]})]}),e.jsx("div",{className:"text-sm text-green-800",children:Q.description}),typeof Q.expectedBenefit=="string"&&e.jsxs("div",{className:"text-xs text-green-700 mt-1",children:["Benefit: ",Q.expectedBenefit]})]},P)),(C.recommendations||[]).length===0&&e.jsx("div",{className:"text-sm text-gray-500",children:"No recommendations at this time."})]})})]})]})]})]})};function yMe(){const s=zs();return e.jsx(sh,{requiredRole:"admin",children:e.jsx(Kr,{title:"Llama AI-Powered Intelligence",description:"Advanced conversational AI, document processing, and predictive analytics powered by Meta's Llama models",showBreadcrumbs:!0,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-indigo-50 border border-purple-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(La,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-purple-900",children:"Conversational AI"}),e.jsx("p",{className:"text-sm text-purple-700",children:"Natural language queries with 10M token context"})]})]})}),e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Zt,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900",children:"Document Intelligence"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Multimodal processing of receipts, invoices, contracts"})]})]})}),e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx($s,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-green-900",children:"Predictive Analytics"}),e.jsx("p",{className:"text-sm text-green-700",children:"Advanced forecasting with scenario analysis"})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx(sa,{className:"h-6 w-6 text-purple-600"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Llama Models in Use"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Llama 3.1 8B"}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Efficient conversational AI for real-time interactions"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:"Fast"}),e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded",children:"Efficient"})]})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Llama 3.1 70B"}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Advanced analysis for complex financial scenarios"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded",children:"Advanced"}),e.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded",children:"Comprehensive"})]})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"LLaVA 7B"}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Vision model for document and image processing"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded",children:"Multimodal"}),e.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded",children:"OCR"})]})]})]})]}),e.jsx(vMe,{companyId:s})]})})})}function jMe(){var fe,ct,dt,pt;const[s,t]=x.useState([]),[r,n]=x.useState([]),[a,i]=x.useState([]),[o,l]=x.useState(!1),[c,d]=x.useState(!1),[u,h]=x.useState(!1),[f,m]=x.useState(!1),[p,g]=x.useState(!1),[v,y]=x.useState("cmg7trbsf00097kb7rrpy9in1"),[j,b]=x.useState(""),[w,N]=x.useState(.15),[C,S]=x.useState("all"),[_,k]=x.useState(""),[F,A]=x.useState(""),[T,V]=x.useState(""),[M,G]=x.useState(""),[L,J]=x.useState("VAT"),[z,U]=x.useState(""),[oe,Q]=x.useState(""),[P,q]=x.useState(""),[D,se]=x.useState(""),[he,be]=x.useState("INCOME"),[pe,Ae]=x.useState("Annual"),[Ee,$e]=x.useState(""),[O,te]=x.useState(""),[re,le]=x.useState([{description:"Sample item",type:"product",amount:100,taxExclusive:!0}]),[Z,K]=x.useState(null),X=async()=>{var qe;l(!0);try{console.log("Fetching tax rates for company:",v);const mt=await de.listTaxRates({companyId:v||void 0,limit:50});console.log("Tax rates response:",mt);let Rt=[];Array.isArray(mt)?Rt=mt:mt!=null&&mt.rates&&Array.isArray(mt.rates)?Rt=mt.rates:(qe=mt==null?void 0:mt.data)!=null&&qe.rates&&Array.isArray(mt.data.rates)?Rt=mt.data.rates:mt!=null&&mt.data&&Array.isArray(mt.data)&&(Rt=mt.data),console.log("Processed rates data:",Rt),t(Rt)}catch(mt){console.error("Error fetching tax rates:",mt)}finally{l(!1)}},ce=async()=>{try{console.log("Fetching tax forms for company:",v);const mt=await(await fetch("/api/tax/forms",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")||""}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":v||"cmg7trbsf00097kb7rrpy9in1"}})).json();console.log("Tax forms response:",mt),i((mt==null?void 0:mt.forms)||[])}catch(qe){console.error("Error fetching tax forms:",qe)}},Y=async()=>{if(!oe||!P||!D||!he){Uc({title:"Validation Error",description:"Form name, code, jurisdiction, and tax type are required",variant:"destructive"});return}g(!0);try{const qe=v||"company_demo";console.log("Creating tax form:",{companyId:qe,formName:oe,formCode:P,jurisdiction:D,taxType:he,period:pe,dueDate:Ee,description:O});const mt=await fetch("/api/tax/forms",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")||""}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":qe},body:JSON.stringify({companyId:qe,formName:oe,formCode:P,jurisdiction:D,taxType:he,period:pe,dueDate:Ee,description:O})});if(!mt.ok){const _e=await mt.json();throw new Error(_e.error||`HTTP ${mt.status}: ${mt.statusText}`)}const Rt=await mt.json();console.log("Tax form created successfully:",Rt),Uc({title:"Success!",description:`Tax form "${oe}" created successfully`,variant:"default"}),Q(""),q(""),se(""),be("INCOME"),Ae("Annual"),$e(""),te(""),await ce()}catch(qe){console.error("Error creating tax form:",qe);const mt=qe instanceof Error?qe.message:"Unknown error occurred";Uc({title:"Error",description:`Failed to create tax form: ${mt}`,variant:"destructive"})}finally{g(!1)}};x.useEffect(()=>{X(),ve(),ce()},[]);const ue=async()=>{if(!j){Uc({title:"Validation Error",description:"Tax rate name is required",variant:"destructive"});return}d(!0);try{const qe=v||"company_demo";console.log("Creating tax rate:",{companyId:qe,taxName:j,rate:w,appliesTo:C});const mt=await de.createTaxRate({companyId:qe,taxName:j,rate:w,appliesTo:C});console.log("Tax rate created successfully:",mt),Uc({title:"Success!",description:`Tax rate "${j}" created successfully`,variant:"default"}),b(""),N(.15),S("all"),await X()}catch(qe){console.error("Error creating tax rate:",qe),Uc({title:"Error",description:"Failed to create tax rate. Please try again.",variant:"destructive"})}finally{d(!1)}},ve=async()=>{try{console.log("Fetching jurisdictions for company:",v);const mt=await(await fetch("/api/tax/jurisdictions",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")||""}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":v||"cmg7trbsf00097kb7rrpy9in1"}})).json();console.log("Jurisdictions response:",mt),n((mt==null?void 0:mt.jurisdictions)||[])}catch(qe){console.error("Error fetching jurisdictions:",qe)}},Le=async()=>{if(!_||!F||!L){Uc({title:"Validation Error",description:"Name, country, and tax type are required",variant:"destructive"});return}m(!0);try{const qe=v||"company_demo";console.log("Creating jurisdiction:",{companyId:qe,name:_,country:F,state:T,city:M,taxType:L,description:z});const Rt=await(await fetch("/api/tax/jurisdictions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")||""}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":qe},body:JSON.stringify({companyId:qe,name:_,country:F,state:T||void 0,city:M||void 0,taxType:L,description:z})})).json();console.log("Jurisdiction created successfully:",Rt),Uc({title:"Success!",description:`Jurisdiction "${_}" created successfully`,variant:"default"}),k(""),A(""),V(""),G(""),J("VAT"),U(""),await ve()}catch(qe){console.error("Error creating jurisdiction:",qe),Uc({title:"Error",description:"Failed to create jurisdiction. Please try again.",variant:"destructive"})}finally{m(!1)}},Me=()=>{le(qe=>[...qe,{type:"product",amount:0,taxExclusive:!0}])},tt=async()=>{h(!0);try{const qe=v||"company_demo",mt=await de.calculateTax({companyId:qe,currency:"USD",lines:re});K((mt==null?void 0:mt.data)??mt),Uc({title:"Calculation Complete",description:"Tax calculation completed successfully",variant:"default"})}catch(qe){console.error("Error calculating tax:",qe),Uc({title:"Calculation Error",description:"Failed to calculate tax. Please try again.",variant:"destructive"})}finally{h(!1)}};return e.jsxs(Kr,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Tax"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage tax rates and calculate tax for transactions"})]})}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Context"}),e.jsx(Vt,{children:"Optionally provide a Company ID (blank uses demo)"})]}),e.jsxs(ie,{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Company ID"}),e.jsx(ge,{value:v,onChange:qe=>y(qe.target.value),placeholder:"company id"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(I,{variant:"outline",onClick:X,disabled:o,children:"Refresh Rates"})})]})]}),e.jsx(l3,{tabs:[{id:"rates",label:"Rates"},{id:"calculator",label:"Calculator"}],value:"rates",onChange:()=>{},className:"mb-4"}),e.jsxs(an,{defaultValue:"rates",className:"space-y-4",variant:"underline",children:[e.jsxs(on,{variant:"underline",children:[e.jsx(vt,{value:"rates",icon:e.jsx(Mr,{className:"w-4 h-4"}),badge:s.length,children:"Rates"}),e.jsx(vt,{value:"jurisdictions",icon:e.jsx(Pa,{className:"w-4 h-4"}),badge:r.length,children:"Jurisdictions"}),e.jsx(vt,{value:"forms",icon:e.jsx(Zt,{className:"w-4 h-4"}),badge:a.length,children:"Forms"}),e.jsx(vt,{value:"calculator",icon:e.jsx(yn,{className:"w-4 h-4"}),children:"Calculator"})]}),e.jsxs(yt,{value:"rates",className:"space-y-4",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Create Rate"})}),e.jsxs(ie,{className:"grid md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Name"}),e.jsx(ge,{value:j,onChange:qe=>b(qe.target.value),placeholder:"VAT 15%"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Rate (0-1)"}),e.jsx(ge,{type:"number",step:"0.01",value:w,onChange:qe=>N(parseFloat(qe.target.value||"0"))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Applies To"}),e.jsxs("select",{value:C,onChange:qe=>S(qe.target.value),className:"w-full border rounded h-10 px-3",children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"products",children:"Products"}),e.jsx("option",{value:"services",children:"Services"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(I,{onClick:ue,disabled:c,children:[c&&e.jsx(On,{className:"mr-2 h-4 w-4 animate-spin"}),c?"Creating...":"Create"]})})]})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Existing Rates"})}),e.jsxs(ie,{className:"space-y-2",children:[s.length===0&&e.jsx("div",{className:"text-sm text-muted-foreground",children:"No rates"}),s.map(qe=>e.jsxs("div",{className:"flex items-center justify-between border rounded p-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:qe.taxName}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[qe.appliesTo,"  ",(qe.rate*100).toFixed(2),"%"]})]}),e.jsx(Oe,{variant:qe.isActive?"default":"secondary",children:qe.isActive?"Active":"Inactive"})]},qe.id))]})]})]}),e.jsxs(yt,{value:"jurisdictions",className:"space-y-4",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Create Jurisdiction"}),e.jsx(Vt,{children:"Add a new tax jurisdiction for your business"})]}),e.jsxs(ie,{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Name *"}),e.jsx(ge,{value:_,onChange:qe=>k(qe.target.value),placeholder:"e.g., California State Tax"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Country *"}),e.jsx(ge,{value:F,onChange:qe=>A(qe.target.value),placeholder:"e.g., United States"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"State/Province"}),e.jsx(ge,{value:T,onChange:qe=>V(qe.target.value),placeholder:"e.g., California"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"City"}),e.jsx(ge,{value:M,onChange:qe=>G(qe.target.value),placeholder:"e.g., San Francisco"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Tax Type *"}),e.jsxs("select",{value:L,onChange:qe=>J(qe.target.value),className:"w-full border rounded h-10 px-3",children:[e.jsx("option",{value:"VAT",children:"VAT"}),e.jsx("option",{value:"GST",children:"GST"}),e.jsx("option",{value:"SALES",children:"Sales Tax"}),e.jsx("option",{value:"INCOME",children:"Income Tax"}),e.jsx("option",{value:"PAYROLL",children:"Payroll Tax"}),e.jsx("option",{value:"PROPERTY",children:"Property Tax"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs(I,{onClick:Le,disabled:f,children:[f&&e.jsx(On,{className:"mr-2 h-4 w-4 animate-spin"}),f?"Creating...":"Create"]})}),e.jsxs("div",{className:"md:col-span-3 space-y-2",children:[e.jsx(B,{children:"Description"}),e.jsx(ge,{value:z,onChange:qe=>U(qe.target.value),placeholder:"Optional description of this jurisdiction"})]})]})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Existing Jurisdictions"})}),e.jsxs(ie,{className:"space-y-2",children:[r.length===0&&e.jsx("div",{className:"text-sm text-muted-foreground",children:"No jurisdictions"}),r.map(qe=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:qe.name}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[qe.country,qe.state&&`, ${qe.state}`,qe.city&&`, ${qe.city}`]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Type: ",qe.taxType,qe.description&&`  ${qe.description}`]})]}),e.jsx(Oe,{variant:qe.isActive?"default":"secondary",children:qe.isActive?"Active":"Inactive"})]},qe.id))]})]})]}),e.jsxs(yt,{value:"forms",className:"space-y-4",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Create Tax Form"}),e.jsx(Vt,{children:"Add a new tax form template for your business"})]}),e.jsxs(ie,{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Form Name *"}),e.jsx(ge,{value:oe,onChange:qe=>Q(qe.target.value),placeholder:"e.g., Form 1120 - Corporation Tax Return"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Form Code *"}),e.jsx(ge,{value:P,onChange:qe=>q(qe.target.value),placeholder:"e.g., 1120"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Jurisdiction *"}),e.jsxs("select",{value:D,onChange:qe=>se(qe.target.value),className:"w-full border rounded h-10 px-3",children:[e.jsx("option",{value:"",children:"Select jurisdiction"}),r.map(qe=>e.jsxs("option",{value:qe.name,children:[qe.name," (",qe.country,")"]},qe.id))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Tax Type *"}),e.jsxs("select",{value:he,onChange:qe=>be(qe.target.value),className:"w-full border rounded h-10 px-3",children:[e.jsx("option",{value:"INCOME",children:"Income Tax"}),e.jsx("option",{value:"SALES",children:"Sales Tax"}),e.jsx("option",{value:"PAYROLL",children:"Payroll Tax"}),e.jsx("option",{value:"PROPERTY",children:"Property Tax"}),e.jsx("option",{value:"VAT",children:"VAT"}),e.jsx("option",{value:"GST",children:"GST"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Period"}),e.jsxs("select",{value:pe,onChange:qe=>Ae(qe.target.value),className:"w-full border rounded h-10 px-3",children:[e.jsx("option",{value:"Annual",children:"Annual"}),e.jsx("option",{value:"Quarterly",children:"Quarterly"}),e.jsx("option",{value:"Monthly",children:"Monthly"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Due Date"}),e.jsx(ge,{type:"date",value:Ee,onChange:qe=>$e(qe.target.value)})]}),e.jsxs("div",{className:"md:col-span-3 space-y-2",children:[e.jsx(B,{children:"Description"}),e.jsx(ge,{value:O,onChange:qe=>te(qe.target.value),placeholder:"Optional description of this tax form"})]}),e.jsx("div",{className:"md:col-span-3 flex justify-start",children:e.jsxs(I,{onClick:Y,disabled:p,children:[p&&e.jsx(On,{className:"mr-2 h-4 w-4 animate-spin"}),p?"Creating...":"Create Form"]})})]})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Existing Tax Forms"})}),e.jsxs(ie,{className:"space-y-2",children:[a.length===0&&e.jsx("div",{className:"text-sm text-muted-foreground",children:"No tax forms"}),a.map(qe=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:qe.formName}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Code: ",qe.formCode,"  ",qe.jurisdiction,"  ",qe.taxType]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Period: ",qe.period,qe.dueDate&&`  Due: ${qe.dueDate}`,qe.description&&`  ${qe.description}`]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{variant:qe.status==="READY"?"default":qe.status==="DRAFT"?"secondary":"outline",children:qe.status}),e.jsx(Oe,{variant:qe.isActive?"default":"secondary",children:qe.isActive?"Active":"Inactive"})]})]},qe.id))]})]})]}),e.jsxs(yt,{value:"calculator",className:"space-y-4",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Lines"})}),e.jsxs(ie,{className:"space-y-3",children:[re.map((qe,mt)=>e.jsxs("div",{className:"grid md:grid-cols-5 gap-2 items-end",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Description"}),e.jsx(ge,{value:qe.description||"",onChange:Rt=>{const _e=Rt.target.value;le(Xe=>Xe.map((At,st)=>st===mt?{...At,description:_e}:At))}})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Type"}),e.jsxs("select",{value:qe.type,onChange:Rt=>le(_e=>_e.map((Xe,At)=>At===mt?{...Xe,type:Rt.target.value}:Xe)),className:"w-full border rounded h-10 px-3",children:[e.jsx("option",{value:"product",children:"Product"}),e.jsx("option",{value:"service",children:"Service"})]})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Amount"}),e.jsx(ge,{type:"number",step:"0.01",value:qe.amount,onChange:Rt=>le(_e=>_e.map((Xe,At)=>At===mt?{...Xe,amount:parseFloat(Rt.target.value||"0")}:Xe))})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Tax Rate"}),e.jsxs("select",{value:qe.selectedRateId||"auto",onChange:Rt=>{const _e=Rt.target.value;if(_e==="auto")le(Xe=>Xe.map((At,st)=>st===mt?{...At,selectedRateId:void 0,manualRate:void 0}:At));else if(_e==="manual")le(Xe=>Xe.map((At,st)=>st===mt?{...At,selectedRateId:"manual",manualRate:.15}:At));else{const Xe=s.find(At=>At.id===_e);le(At=>At.map((st,$t)=>$t===mt?{...st,selectedRateId:_e,manualRate:Xe==null?void 0:Xe.rate}:st))}},className:"w-full border rounded h-10 px-3",children:[e.jsx("option",{value:"auto",children:"Auto (Match by Type)"}),s.map(Rt=>e.jsxs("option",{value:Rt.id,children:[Rt.taxName," (",(Rt.rate*100).toFixed(1),"%) - ",Rt.appliesTo]},Rt.id)),e.jsx("option",{value:"manual",children:"Manual Rate"})]}),qe.selectedRateId==="manual"&&e.jsx(ge,{type:"number",step:"0.01",value:qe.manualRate??"",onChange:Rt=>le(_e=>_e.map((Xe,At)=>At===mt?{...Xe,manualRate:Rt.target.value===""?void 0:parseFloat(Rt.target.value)}:Xe)),placeholder:"Enter rate (0.15 = 15%)",className:"mt-1"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:qe.taxExclusive,onChange:Rt=>le(_e=>_e.map((Xe,At)=>At===mt?{...Xe,taxExclusive:Rt.target.checked}:Xe))}),e.jsx(B,{children:"Tax Exclusive"})]})]},mt)),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{variant:"outline",onClick:Me,children:"Add Line"}),e.jsxs(I,{onClick:tt,disabled:u,children:[u&&e.jsx(On,{className:"mr-2 h-4 w-4 animate-spin"}),u?"Calculating...":"Calculate"]})]})]})]}),Z&&e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Calculation Result"})}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Currency: ",Z.currency]}),Z.lines&&Z.lines.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Line Items:"}),Z.lines.map((qe,mt)=>{var Rt,_e,Xe,At,st,$t;return e.jsx("div",{className:"border rounded p-3 bg-gray-50",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:qe.description}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Type: ",qe.type," | Rate: ",(qe.taxRate*100).toFixed(1),"%",qe.appliedRateName&&e.jsxs("span",{className:"ml-2 text-blue-600",children:["(",qe.appliedRateName,")"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{children:["Amount: $",((_e=(Rt=qe.amount)==null?void 0:Rt.toFixed)==null?void 0:_e.call(Rt,2))??qe.amount]}),e.jsxs("div",{className:"text-sm",children:["Tax: $",((At=(Xe=qe.taxAmount)==null?void 0:Xe.toFixed)==null?void 0:At.call(Xe,2))??qe.taxAmount]}),e.jsxs("div",{className:"font-medium",children:["Total: $",(($t=(st=qe.totalAmount)==null?void 0:st.toFixed)==null?void 0:$t.call(st,2))??qe.totalAmount]})]})]})},mt)})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex justify-between text-lg font-medium",children:[e.jsx("span",{children:"Total Tax:"}),e.jsxs("span",{children:["$",((ct=(fe=Z.totalTax)==null?void 0:fe.toFixed)==null?void 0:ct.call(fe,2))??Z.totalTax]})]}),e.jsxs("div",{className:"flex justify-between text-xl font-bold",children:[e.jsx("span",{children:"Total Amount:"}),e.jsxs("span",{children:["$",((pt=(dt=Z.totalAmount)==null?void 0:dt.toFixed)==null?void 0:pt.call(dt,2))??Z.totalAmount]})]})]})]})]})]})]})]}),e.jsx(gM,{})]})}function bMe(){var ce;const[s,t]=x.useState([]),[r,n]=x.useState(""),[a,i]=x.useState([]),[o,l]=x.useState([]),[c,d]=x.useState([]),[u,h]=x.useState(!1),[f,m]=x.useState("calculator"),[p,g]=x.useState("ALL"),[v,y]=x.useState(!1),[j,b]=x.useState(""),[w,N]=x.useState(""),[C,S]=x.useState(""),[_,k]=x.useState([]),[F,A]=x.useState(null),[T,V]=x.useState([]),[M,G]=x.useState([]),[L,J]=x.useState(""),[z,U]=x.useState(""),[oe,Q]=x.useState(null),[P]=x.useState({});x.useEffect(()=>{(async()=>{try{await de.getDemoToken("tax-calculation",["admin","accountant"]);const ue=qi.api.baseUrlWithoutApi||"",Me=(await(await fetch(`${ue}/api/companies`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")||""}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo"}})).json()).data||[];t(Me);const tt=localStorage.getItem("tax_company")||"";tt&&Me.find(fe=>fe.id===tt)?n(tt):Me.length>0&&n(Me[0].id)}catch(ue){console.error("Error loading companies:",ue),ze.error("Failed to load companies")}})()},[]);const q=x.useCallback(async()=>{if(r){try{console.log("Loading jurisdictions from tax management system...");const Y=await fetch("/api/tax/jurisdictions",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")||""}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":r}});if(Y.ok){const ue=await Y.json(),Le=((ue==null?void 0:ue.jurisdictions)||[]).map(Me=>{var tt;return{id:Me.id,name:Me.name,country:Me.country,state:Me.state,city:Me.city,taxType:Me.taxType==="VAT"?"SALES":Me.taxType,rate:.15,minimumThreshold:0,maximumThreshold:void 0,exemptions:[],effectiveDate:((tt=Me.createdAt)==null?void 0:tt.substring(0,10))||"2024-01-01",endDate:void 0}});console.log("Loaded jurisdictions:",Le),i(Le),Le.length>0?ze.success(`Loaded ${Le.length} jurisdictions from tax management`):ze.info("No custom jurisdictions found, using defaults")}else throw new Error("Failed to load jurisdictions")}catch(Y){console.error("Error loading jurisdictions:",Y),i([{id:"us-federal",name:"US Federal",country:"United States",taxType:"INCOME",rate:.21,minimumThreshold:0,exemptions:[],effectiveDate:"2024-01-01"},{id:"us-california",name:"California State",country:"United States",state:"CA",taxType:"INCOME",rate:.0884,minimumThreshold:0,exemptions:[],effectiveDate:"2024-01-01"},{id:"us-ny",name:"New York State",country:"United States",state:"NY",taxType:"INCOME",rate:.08,minimumThreshold:0,exemptions:[],effectiveDate:"2024-01-01"},{id:"uk-corporate",name:"UK Corporation Tax",country:"United Kingdom",taxType:"INCOME",rate:.25,minimumThreshold:0,exemptions:[],effectiveDate:"2024-01-01"},{id:"canada-federal",name:"Canada Federal",country:"Canada",taxType:"INCOME",rate:.15,minimumThreshold:0,exemptions:[],effectiveDate:"2024-01-01"}]),ze.info("Using demo jurisdictions (failed to load custom ones)")}setTimeout(()=>{const Y=localStorage.getItem("tax_jurisdiction")||"";Y&&N(Y);const ue=localStorage.getItem("tax_amount")||"";ue&&S(ue);const ve=localStorage.getItem("tax_exemptions");ve&&k(JSON.parse(ve));const Le=localStorage.getItem("tax_multi");Le&&V(JSON.parse(Le))},100)}},[r]);x.useEffect(()=>{r&&q(),r&&localStorage.setItem("tax_company",r)},[r,q]);const D=async()=>{if(r)try{h(!0);const Y=un();if(!(await fetch(`${Y}/api/tax-calculation/${r}/jurisdictions/seed`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")||""}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo"}})).ok)throw new Error("Seed endpoint unavailable");ze.success("Demo jurisdictions seeded"),await q()}catch{ze.error("Failed to seed jurisdictions")}finally{h(!1)}},se=async()=>{if(r)try{console.log("Loading tax forms from tax management system...");const Y=await fetch("/api/tax/forms",{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")||""}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":r}});if(Y.ok){const ue=await Y.json(),Le=((ue==null?void 0:ue.forms)||[]).map(Me=>{var tt;return{formId:Me.formCode||Me.id,formName:Me.formName,jurisdiction:Me.jurisdiction,taxType:Me.taxType,period:Me.period,dueDate:Me.dueDate,status:Me.status,fields:Me.fields||[],calculatedAmounts:Me.calculatedAmounts||{},generatedAt:((tt=Me.createdAt)==null?void 0:tt.substring(0,10))||"2024-01-01"}});console.log("Loaded tax forms:",Le),l(Le),Le.length>0?ze.success(`Loaded ${Le.length} tax forms from tax management`):ze.info("No custom tax forms found, using defaults")}else throw new Error("Failed to load tax forms")}catch(Y){console.error("Error loading tax forms:",Y),l([{formId:"form-1120",formName:"Form 1120 - US Corporation Tax Return",jurisdiction:"US Federal",taxType:"INCOME",period:"Annual",dueDate:"2025-03-15",status:"READY",fields:[],calculatedAmounts:{},generatedAt:"2024-01-01"},{formId:"form-941",formName:"Form 941 - Employer Quarterly Tax Return",jurisdiction:"US Federal",taxType:"PAYROLL",period:"Quarterly",dueDate:"2025-01-31",status:"READY",fields:[],calculatedAmounts:{},generatedAt:"2024-01-01"}]),ze.info("Using demo tax forms (failed to load custom ones)")}},he=async()=>{if(r)try{const Y=qi.api.baseUrlWithoutApi||"",ue=await fetch(`${Y}/api/tax-calculation/${r}/returns`,{headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")||""}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo"}});if(ue.ok){const ve=await ue.json();d(ve.data||[])}else d([{id:"return-2024-1",companyId:r,formId:"form-1120",period:"2024",status:"DRAFT",data:{},calculatedTax:15e3,paidAmount:0,balance:15e3,dueDate:"2025-03-15",filedAt:"",acceptedAt:"",createdAt:"2024-01-01",updatedAt:"2024-01-01"},{id:"return-2024-2",companyId:r,formId:"form-941",period:"Q4-2024",status:"FILED",data:{},calculatedTax:2500,paidAmount:2500,balance:0,dueDate:"2025-01-31",filedAt:"2025-01-15",acceptedAt:"",createdAt:"2024-01-01",updatedAt:"2025-01-15"},{id:"return-2023-1",companyId:r,formId:"form-1120",period:"2023",status:"FILED",data:{},calculatedTax:12e3,paidAmount:12e3,balance:0,dueDate:"2024-03-15",filedAt:"2024-03-10",acceptedAt:"2024-03-20",createdAt:"2023-01-01",updatedAt:"2024-03-20"}]),ze.info("Using demo tax returns")}catch(Y){console.error("Error loading tax returns:",Y),d([{id:"return-2024-1",companyId:r,formId:"form-1120",period:"2024",status:"DRAFT",data:{},calculatedTax:15e3,paidAmount:0,balance:15e3,dueDate:"2025-03-15",filedAt:"",acceptedAt:"",createdAt:"2024-01-01",updatedAt:"2024-01-01"},{id:"return-2024-2",companyId:r,formId:"form-941",period:"Q4-2024",status:"FILED",data:{},calculatedTax:2500,paidAmount:2500,balance:0,dueDate:"2025-01-31",filedAt:"2025-01-15",acceptedAt:"",createdAt:"2024-01-01",updatedAt:"2025-01-15"},{id:"return-2023-1",companyId:r,formId:"form-1120",period:"2023",status:"FILED",data:{},calculatedTax:12e3,paidAmount:12e3,balance:0,dueDate:"2024-03-15",filedAt:"2024-03-10",acceptedAt:"2024-03-20",createdAt:"2023-01-01",updatedAt:"2024-03-20"}]),ze.info("Using demo tax returns")}},be=async()=>{var Y,ue,ve,Le,Me;if(!(!r||!w||!C)){h(!0);try{const tt=await fetch("/api/tax/calculate",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")||""}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":r},body:JSON.stringify({companyId:r,currency:"USD",lines:[{description:`Tax calculation for ${((Y=a.find(qe=>qe.id===w))==null?void 0:Y.name)||"jurisdiction"}`,type:"service",amount:parseFloat(C),taxExclusive:!0,selectedRateId:"auto"}]})});if(!tt.ok)throw new Error("Failed to calculate tax");const fe=await tt.json(),ct=fe.data||fe,dt=a.find(qe=>qe.id===w),pt={jurisdiction:(dt==null?void 0:dt.name)||"Unknown",taxType:(dt==null?void 0:dt.taxType)||"INCOME",taxableAmount:parseFloat(C),taxRate:((ve=(ue=ct.lines)==null?void 0:ue[0])==null?void 0:ve.taxRate)||.15,calculatedTax:ct.totalTax||0,exemptions:0,netTax:ct.totalTax||0,effectiveRate:((Me=(Le=ct.lines)==null?void 0:Le[0])==null?void 0:Me.taxRate)||.15};A(pt),localStorage.setItem("tax_jurisdiction",w),localStorage.setItem("tax_amount",C),localStorage.setItem("tax_exemptions",JSON.stringify(_)),ze.success("Tax calculation completed")}catch(tt){console.error("Error calculating tax:",tt),ze.error("Failed to calculate tax")}finally{h(!1)}}},pe=async()=>{if(!(!r||T.length===0)){h(!0);try{const Y=qi.api.baseUrlWithoutApi||"",ue=await fetch(`${Y}/api/tax-calculation/${r}/calculate-multi`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")||""}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo"},body:JSON.stringify({calculations:T})});if(!ue.ok)throw new Error("Failed to calculate multi-jurisdiction tax");const ve=await ue.json();G(ve.data),localStorage.setItem("tax_multi",JSON.stringify(T)),ze.success("Multi-jurisdiction tax calculation completed")}catch(Y){console.error("Error calculating multi-jurisdiction tax:",Y),ze.error("Failed to calculate multi-jurisdiction tax")}finally{h(!1)}}},Ae=async()=>{if(!(!r||!L||!z)){h(!0);try{const Y=qi.api.baseUrlWithoutApi||"",ue=await fetch(`${Y}/api/tax-calculation/${r}/forms/generate`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")||""}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo"},body:JSON.stringify({formId:L,period:z,data:P})});if(!ue.ok)throw new Error("Failed to generate tax form");const ve=await ue.json();Q(ve.data),ze.success("Tax form generated successfully")}catch(Y){console.error("Error generating tax form:",Y),ze.error("Failed to generate tax form")}finally{h(!1)}}},Ee=()=>{V([...T,{jurisdictionId:"",taxableAmount:0,exemptions:[]}])},$e=(Y,ue,ve)=>{const Le=[...T];Le[Y]={...Le[Y],[ue]:ve},V(Le)},O=Y=>{V(T.filter((ue,ve)=>ve!==Y))},te=()=>{const ue=j.split(/\r?\n/).map(ve=>ve.trim()).filter(Boolean).map(ve=>{const[Le,Me,tt]=ve.split(",");return{jurisdictionId:Le||"",taxableAmount:parseFloat(Me)||0,exemptions:(tt||"").split("|").map(fe=>fe.trim()).filter(Boolean)}});V(ue),localStorage.setItem("tax_multi",JSON.stringify(ue)),y(!1),b("")},re=async Y=>{try{const ue=un();if(!(await fetch(`${ue}/api/tax-calculation/${r}/returns/${Y}/file`,{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")||""}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo"}})).ok)throw new Error("Failed");ze.success("Return marked as filed"),await he()}catch{ze.error("Failed to mark as filed")}},le=Y=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Y),Z=Y=>`${(Y*100).toFixed(2)}%`,K=Y=>{switch(Y){case"DRAFT":return"bg-yellow-100 text-yellow-800";case"READY":return"bg-blue-100 text-blue-800";case"FILED":return"bg-green-100 text-green-800";case"ACCEPTED":return"bg-green-100 text-green-800";case"REJECTED":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},X=Y=>{switch(Y){case"INCOME":return e.jsx($s,{className:"h-4 w-4"});case"SALES":return e.jsx(Mr,{className:"h-4 w-4"});case"PAYROLL":return e.jsx(Lf,{className:"h-4 w-4"});case"PROPERTY":return e.jsx(Pa,{className:"h-4 w-4"});default:return e.jsx(yn,{className:"h-4 w-4"})}};return e.jsx(Kr,{children:e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Tax Calculation Engine"}),e.jsx("p",{className:"text-muted-foreground",children:"Calculate taxes, generate forms, and manage compliance"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{variant:"outline",onClick:se,children:[e.jsx(Zt,{className:"h-4 w-4 mr-2"}),"Load Forms"]}),e.jsxs(I,{variant:"outline",onClick:he,children:[e.jsx(Cr,{className:"h-4 w-4 mr-2"}),"Load Returns"]})]})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Company Selection"})}),e.jsx(ie,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"company",children:"Company"}),e.jsxs(rt,{value:r,onValueChange:n,children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select company"})}),e.jsx(at,{children:s.map(Y=>e.jsx(W,{value:Y.id,children:Y.name},Y.id))})]})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsxs(I,{onClick:q,disabled:!r,children:[e.jsx(Ts,{className:"h-4 w-4 mr-2"}),"Load Jurisdictions"]}),e.jsxs(I,{variant:"outline",onClick:()=>window.open("/dashboard/tax","_blank"),title:"Open Tax Management page to create/manage jurisdictions (go to Jurisdictions tab)",children:[e.jsx(Pa,{className:"h-4 w-4 mr-2"}),"Manage Jurisdictions"]}),a.length===0&&e.jsx(I,{variant:"outline",onClick:D,disabled:u||!r,children:"Seed Demo Jurisdictions"})]})]})})]}),e.jsxs(an,{value:f,onValueChange:m,children:[e.jsxs(on,{className:"grid w-full grid-cols-4",children:[e.jsx(vt,{value:"calculator",children:"Tax Calculator"}),e.jsx(vt,{value:"multi-calculator",children:"Multi-Jurisdiction"}),e.jsx(vt,{value:"forms",children:"Tax Forms"}),e.jsx(vt,{value:"returns",children:"Tax Returns"})]}),e.jsx(yt,{value:"calculator",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Tax Calculator"}),e.jsx(Vt,{children:"Calculate tax for a single jurisdiction"})]}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"jurisdiction",children:"Jurisdiction"}),e.jsxs(rt,{value:w,onValueChange:N,children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select jurisdiction"})}),e.jsx(at,{children:a.map(Y=>e.jsx(W,{value:Y.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[X(Y.taxType),e.jsx("span",{children:Y.name}),e.jsx(Oe,{variant:"outline",children:Z(Y.rate)})]})},Y.id))})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"taxable-amount",children:"Taxable Amount"}),e.jsx(ge,{id:"taxable-amount",type:"number",value:C,onChange:Y=>S(Y.target.value),placeholder:"Enter taxable amount"})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Exemptions"}),e.jsx("div",{className:"space-y-2",children:w&&((ce=a.find(Y=>Y.id===w))==null?void 0:ce.exemptions.map(Y=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ka,{id:Y,checked:_.includes(Y),onCheckedChange:ue=>{k(ue?[..._,Y]:_.filter(ve=>ve!==Y))}}),e.jsx(B,{htmlFor:Y,className:"text-sm",children:Y.replace(/_/g," ").toUpperCase()})]},Y)))})]}),e.jsxs(I,{onClick:be,disabled:u||!w||!C,children:[u?e.jsx(Ts,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(yn,{className:"h-4 w-4 mr-2"}),"Calculate Tax"]})]})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Calculation Result"})}),e.jsx(ie,{children:F?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-sm text-muted-foreground",children:"Jurisdiction"}),e.jsx("p",{className:"font-medium",children:F.jurisdiction})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm text-muted-foreground",children:"Tax Type"}),e.jsx("p",{className:"font-medium",children:F.taxType})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-sm text-muted-foreground",children:"Taxable Amount"}),e.jsx("p",{className:"font-medium",children:le(F.taxableAmount)})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm text-muted-foreground",children:"Tax Rate"}),e.jsx("p",{className:"font-medium",children:Z(F.taxRate)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-sm text-muted-foreground",children:"Calculated Tax"}),e.jsx("p",{className:"font-medium",children:le(F.calculatedTax)})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm text-muted-foreground",children:"Exemptions"}),e.jsx("p",{className:"font-medium",children:le(F.exemptions)})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(B,{className:"text-lg font-semibold",children:"Net Tax"}),e.jsx("p",{className:"text-2xl font-bold text-primary",children:le(F.netTax)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(B,{className:"text-sm text-muted-foreground",children:"Effective Rate"}),e.jsx("p",{className:"text-sm font-medium",children:Z(F.effectiveRate)})]})]})]}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(yn,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No calculation result yet"})]})})]})]})}),e.jsx(yt,{value:"multi-calculator",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Multi-Jurisdiction Tax Calculator"}),e.jsx(Vt,{children:"Calculate taxes across multiple jurisdictions"})]}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Calculations"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{onClick:Ee,size:"sm",children:"Add Jurisdiction"}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>y(Y=>!Y),children:v?"Hide CSV":"CSV Paste"})]})]}),v&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"CSV lines: jurisdictionId,amount,exempt1|exempt2"}),e.jsx(Xs,{value:j,onChange:Y=>b(Y.target.value),placeholder:"JURIS-1,1000,small_business|startup\\nJURIS-2,2500,"}),e.jsx("div",{className:"flex justify-end",children:e.jsx(I,{size:"sm",onClick:te,children:"Import"})})]}),e.jsx("div",{className:"space-y-4",children:T.map((Y,ue)=>e.jsx(ne,{children:e.jsx(ie,{className:"pt-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Jurisdiction"}),e.jsxs(rt,{value:Y.jurisdictionId,onValueChange:ve=>$e(ue,"jurisdictionId",ve),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select jurisdiction"})}),e.jsx(at,{children:a.map(ve=>e.jsx(W,{value:ve.id,children:ve.name},ve.id))})]})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Taxable Amount"}),e.jsx(ge,{type:"number",value:Y.taxableAmount,onChange:ve=>$e(ue,"taxableAmount",parseFloat(ve.target.value)||0),placeholder:"Enter amount"})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Exemptions"}),e.jsx(ge,{placeholder:"Comma-separated",onChange:ve=>$e(ue,"exemptions",ve.target.value.split(",").map(Le=>Le.trim()))})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(I,{variant:"outline",size:"sm",onClick:()=>O(ue),children:"Remove"})})]})})},ue))}),T.length>0&&e.jsxs(I,{onClick:pe,disabled:u,className:"w-full",children:[u?e.jsx(Ts,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(yn,{className:"h-4 w-4 mr-2"}),"Calculate All Jurisdictions"]}),M.length>0&&e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Multi-Jurisdiction Results"})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[M.map((Y,ue)=>e.jsxs("div",{className:"flex justify-between items-center p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:Y.jurisdiction}),e.jsx("p",{className:"text-sm text-muted-foreground",children:Y.taxType})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold",children:le(Y.netTax)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:Z(Y.effectiveRate)})]})]},ue)),e.jsx("div",{className:"border-t pt-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-lg font-semibold",children:"Total Tax"}),e.jsx("p",{className:"text-2xl font-bold text-primary",children:le(M.reduce((Y,ue)=>Y+ue.netTax,0))})]})})]})})]})]})]})}),e.jsx(yt,{value:"forms",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Generate Tax Form"}),e.jsx(Vt,{children:"Generate and fill tax forms automatically"})]}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"form",children:"Tax Form"}),e.jsxs(rt,{value:L,onValueChange:J,children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select tax form"})}),e.jsx(at,{children:o.map(Y=>e.jsx(W,{value:Y.formId,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Zt,{className:"h-4 w-4"}),e.jsx("span",{children:Y.formName}),e.jsx(Oe,{variant:"outline",children:Y.jurisdiction})]})},Y.formId))})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"period",children:"Period"}),e.jsx(ge,{id:"period",type:"month",value:z,onChange:Y=>U(Y.target.value),placeholder:"Select period"})]}),e.jsxs(I,{onClick:Ae,disabled:u||!L||!z,children:[u?e.jsx(Ts,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Zt,{className:"h-4 w-4 mr-2"}),"Generate Form"]})]})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Generated Form"})}),e.jsx(ie,{children:oe?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-semibold",children:oe.formName}),e.jsx(Oe,{className:K(oe.status),children:oe.status})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Period: ",oe.period," | Due: ",new Date(oe.dueDate).toLocaleDateString()]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Form Fields"}),oe.fields.map(Y=>e.jsxs("div",{className:"flex justify-between items-center p-2 border rounded",children:[e.jsx("span",{className:"text-sm",children:Y.fieldName}),e.jsx("span",{className:"font-medium",children:Y.calculated&&oe.calculatedAmounts[Y.fieldId]!==void 0?le(oe.calculatedAmounts[Y.fieldId]):Y.value||"N/A"})]},Y.fieldId))]})]}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Zt,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No form generated yet"})]})})]})]})}),e.jsx(yt,{value:"returns",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Tax Returns"}),e.jsx(Vt,{children:"Manage and track tax returns"})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{children:"Status"}),e.jsxs(rt,{value:p,onValueChange:g,children:[e.jsx(nt,{className:"w-40",children:e.jsx(it,{placeholder:"All"})}),e.jsxs(at,{children:[e.jsx(W,{value:"ALL",children:"All"}),e.jsx(W,{value:"DRAFT",children:"Draft"}),e.jsx(W,{value:"READY",children:"Ready"}),e.jsx(W,{value:"FILED",children:"Filed"}),e.jsx(W,{value:"ACCEPTED",children:"Accepted"}),e.jsx(W,{value:"REJECTED",children:"Rejected"})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(I,{variant:"outline",onClick:he,children:[e.jsx(Ts,{className:"h-4 w-4 mr-2"}),"Refresh"]})})]}),c.filter(Y=>p==="ALL"||Y.status===p).length>0?e.jsx("div",{className:"space-y-4",children:c.filter(Y=>p==="ALL"||Y.status===p).map(Y=>e.jsxs("div",{className:"flex justify-between items-center p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:Y.formId}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Period: ",Y.period," | Due: ",new Date(Y.dueDate).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold",children:le(Y.calculatedTax)}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Balance: ",le(Y.balance)]})]}),e.jsx(Oe,{className:K(Y.status),children:Y.status}),Y.status!=="FILED"&&e.jsx(I,{size:"sm",onClick:()=>re(Y.id),children:"Mark Filed"})]})]},Y.id))}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(Cr,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No tax returns found"})]})]})]})})]})]})})}function NMe(){const[s,t]=x.useState({activeClients:0,unreadMessages:0,pendingApprovals:0,portalLogins:0}),[r,n]=x.useState([]),[a,i]=x.useState([]),[o,l]=x.useState([]),[c,d]=x.useState(!0),[u,h]=x.useState(""),[f,m]=x.useState(!1),[p,g]=x.useState({name:"",email:"",phone:"",businessName:"",contactPerson:"",industry:"",website:"",address:"",city:"",state:"",postalCode:"",country:"US",currency:"USD",paymentTerms:"",creditLimit:"",taxId:"",notes:"",source:""}),[v,y]=x.useState(!1),[j,b]=x.useState({recipientId:"",subject:"",messageText:"",priority:"normal"}),[w,N]=x.useState(!1),[C,S]=x.useState({clientId:"",documentId:"",message:"",expiresAt:""}),[_,k]=x.useState([]),[F,A]=x.useState(!1),[T,V]=x.useState([]),[M,G]=x.useState(!1),[L,J]=x.useState(null);x.useEffect(()=>{z()},[]);const z=async()=>{try{d(!0);const O=await de.get("/api/clients");let te=[];Array.isArray(O)?te=O:O.clients&&Array.isArray(O.clients)?te=O.clients:O.data&&Array.isArray(O.data)&&(te=O.data),n(te);const re=await de.get("/api/messages");i(re||[]);const le=te.length;t({activeClients:le,unreadMessages:0,pendingApprovals:0,portalLogins:0});const Z=await de.get("/api/client-access");l(Z||[]),await be();const K=await de.get("/api/messages/unread-count");t(X=>({...X,unreadMessages:K.unreadCount||0,pendingApprovals:0,portalLogins:(Z==null?void 0:Z.length)||0}))}catch(O){console.error("Error loading client data:",O),ze.error("Failed to load client data")}finally{d(!1)}},U=O=>{const te=new Date(O),le=Math.floor((new Date().getTime()-te.getTime())/(1e3*60*60));return le<1?"Just now":le<24?`${le} hour${le>1?"s":""} ago`:le<48?"1 day ago":`${Math.floor(le/24)} days ago`},oe=O=>O.split(" ").map(te=>te[0]).join("").toUpperCase(),Q=()=>{g({name:"",email:"",phone:"",businessName:"",contactPerson:"",industry:"",website:"",address:"",city:"",state:"",postalCode:"",country:"US",currency:"USD",paymentTerms:"",creditLimit:"",taxId:"",notes:"",source:""})},P=async()=>{var O,te,re,le,Z,K,X,ce,Y,ue,ve,Le,Me,tt,fe,ct,dt;try{if(!((O=p.name)!=null&&O.trim())){ze.error("Please enter a client name");return}if(!((te=p.email)!=null&&te.trim())){ze.error("Please enter a client email");return}const pt={name:p.name.trim(),email:p.email.trim(),phone:((re=p.phone)==null?void 0:re.trim())||void 0,businessName:((le=p.businessName)==null?void 0:le.trim())||void 0,contactPerson:((Z=p.contactPerson)==null?void 0:Z.trim())||void 0,industry:((K=p.industry)==null?void 0:K.trim())||void 0,website:((X=p.website)==null?void 0:X.trim())||void 0,address:((ce=p.address)==null?void 0:ce.trim())||void 0,city:((Y=p.city)==null?void 0:Y.trim())||void 0,state:((ue=p.state)==null?void 0:ue.trim())||void 0,postalCode:((ve=p.postalCode)==null?void 0:ve.trim())||void 0,country:p.country,currency:p.currency,paymentTerms:((Le=p.paymentTerms)==null?void 0:Le.trim())||void 0,creditLimit:p.creditLimit||void 0,taxNumber:((Me=p.taxId)==null?void 0:Me.trim())||void 0,notes:((tt=p.notes)==null?void 0:tt.trim())||void 0,source:((fe=p.source)==null?void 0:fe.trim())||void 0},qe=await de.post("/api/clients",pt);ze.success("Client created successfully!"),m(!1),Q(),setTimeout(async()=>{await z()},500)}catch(pt){console.error("Error creating client:",pt),(dt=(ct=pt.response)==null?void 0:ct.data)!=null&&dt.message?ze.error(pt.response.data.message):ze.error("Failed to create client")}},q=()=>{b({recipientId:"",subject:"",messageText:"",priority:"normal"})},D=O=>{q(),O&&b(te=>({...te,recipientId:O})),y(!0)},se=O=>{S({clientId:O||"",documentId:"",message:"",expiresAt:""}),N(!0),he()},he=async()=>{try{A(!0);const O=await de.get("/api/documents");k(O.documents||O.data||O||[])}catch(O){console.error("Error loading documents:",O),ze.error("Failed to load documents")}finally{A(!1)}},be=async()=>{try{G(!0);const O=[];for(const te of r)try{const re=await de.get(`/api/clients/${te.id}/documents`),Z=(re.documents||re.data||re||[]).map(K=>({...K,clientInfo:{id:te.id,name:te.name,email:te.email}}));O.push(...Z)}catch(re){console.error(`Error loading documents for client ${te.name}:`,re)}V(O)}catch(O){console.error("Error loading shared documents:",O),ze.error("Failed to load shared documents")}finally{G(!1)}},pe=async()=>{var O,te;try{if(!C.clientId){ze.error("Please select a client");return}if(!C.documentId){ze.error("Please select a document");return}const re={documentId:C.documentId,message:C.message.trim()||void 0,expiresAt:C.expiresAt||void 0};await de.post(`/api/clients/${C.clientId}/share-document`,re),ze.success("Document shared successfully!"),N(!1),S({clientId:"",documentId:"",message:"",expiresAt:""}),await be()}catch(re){console.error("Error sharing document:",re),(te=(O=re.response)==null?void 0:O.data)!=null&&te.error?ze.error(re.response.data.error):ze.error("Failed to share document")}},Ae=async()=>{var O,te;try{if(!j.recipientId){ze.error("Please select a recipient");return}if(!j.subject.trim()){ze.error("Please enter a subject");return}if(!j.messageText.trim()){ze.error("Please enter a message");return}const re=localStorage.getItem("auth_token");if(!re){ze.error("Please log in to send messages");return}let le=localStorage.getItem("user_id");if(!le)try{le=JSON.parse(atob(re.split(".")[1])).sub}catch{}const Z=r.find(X=>X.id===j.recipientId);if(!Z){ze.error("Selected client not found");return}const K={companyId:Z.companyId||"default",receiverId:Z.assignedTo||le,messageText:`Subject: ${j.subject.trim()}

Priority: ${j.priority.toUpperCase()}

${j.messageText.trim()}`};await de.post("/api/messages",K),ze.success("Message sent successfully!"),y(!1),q(),setTimeout(async()=>{await z()},500)}catch(re){console.error("Error sending message:",re),(te=(O=re.response)==null?void 0:O.data)!=null&&te.message?ze.error(re.response.data.message):ze.error("Failed to send message")}},Ee=[{code:"US",name:"United States"},{code:"CA",name:"Canada"},{code:"GB",name:"United Kingdom"},{code:"DE",name:"Germany"},{code:"FR",name:"France"},{code:"AU",name:"Australia"},{code:"JP",name:"Japan"},{code:"RW",name:"Rwanda"},{code:"KE",name:"Kenya"},{code:"UG",name:"Uganda"},{code:"TZ",name:"Tanzania"},{code:"ZA",name:"South Africa"}],$e=[{code:"USD",name:"US Dollar"},{code:"EUR",name:"Euro"},{code:"GBP",name:"British Pound"},{code:"CAD",name:"Canadian Dollar"},{code:"AUD",name:"Australian Dollar"},{code:"JPY",name:"Japanese Yen"},{code:"FRW",name:"Rwandan Franc"},{code:"KES",name:"Kenyan Shilling"},{code:"UGX",name:"Ugandan Shilling"},{code:"TZS",name:"Tanzanian Shilling"},{code:"ZAR",name:"South African Rand"}];return e.jsxs("div",{className:"flex-1 space-y-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Client Portal & Communication "}),e.jsx("p",{className:"text-muted-foreground",children:"Manage client relationships and secure communications"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(I,{variant:"outline",onClick:z,children:[e.jsx(La,{className:"mr-2 h-4 w-4"}),"Refresh Data"]}),e.jsxs(ts,{open:f,onOpenChange:m,children:[e.jsx(ki,{asChild:!0,children:e.jsxs(I,{onClick:()=>{Q(),m(!0)},children:[e.jsx(Sa,{className:"mr-2 h-4 w-4"}),"Add Client"]})}),e.jsxs(ss,{className:"max-w-2xl",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Add New Client"}),e.jsx(Ks,{children:"Create a new client company to manage their financial data and communications."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"client-name",children:"Company Name *"}),e.jsx(ge,{id:"client-name",placeholder:"Enter company name",value:p.name,onChange:O=>g(te=>({...te,name:O.target.value}))})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"client-email",children:"Email *"}),e.jsx(ge,{id:"client-email",type:"email",placeholder:"Enter email address",value:p.email,onChange:O=>g(te=>({...te,email:O.target.value}))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"client-phone",children:"Phone"}),e.jsx(ge,{id:"client-phone",placeholder:"Enter phone number",value:p.phone,onChange:O=>g(te=>({...te,phone:O.target.value}))})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"client-business-name",children:"Business Name"}),e.jsx(ge,{id:"client-business-name",placeholder:"Legal business name",value:p.businessName,onChange:O=>g(te=>({...te,businessName:O.target.value}))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"client-contact-person",children:"Contact Person"}),e.jsx(ge,{id:"client-contact-person",placeholder:"Primary contact name",value:p.contactPerson,onChange:O=>g(te=>({...te,contactPerson:O.target.value}))})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"client-industry",children:"Industry"}),e.jsx(ge,{id:"client-industry",placeholder:"e.g., Technology, Manufacturing",value:p.industry,onChange:O=>g(te=>({...te,industry:O.target.value}))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"client-country",children:"Country"}),e.jsxs(rt,{value:p.country,onValueChange:O=>g(te=>({...te,country:O})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select country"})}),e.jsx(at,{children:Ee.map(O=>e.jsx(W,{value:O.code,children:O.name},O.code))})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"client-currency",children:"Currency"}),e.jsxs(rt,{value:p.currency,onValueChange:O=>g(te=>({...te,currency:O})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select currency"})}),e.jsx(at,{children:$e.map(O=>e.jsxs(W,{value:O.code,children:[O.code," - ",O.name]},O.code))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"client-tax-id",children:"Tax ID"}),e.jsx(ge,{id:"client-tax-id",placeholder:"Enter tax identification number",value:p.taxId,onChange:O=>g(te=>({...te,taxId:O.target.value}))})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"client-fiscal-year",children:"Fiscal Year Start"}),e.jsxs(rt,{value:p.fiscalYearStart,onValueChange:O=>g(te=>({...te,fiscalYearStart:O})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select fiscal year start"})}),e.jsxs(at,{children:[e.jsx(W,{value:"01-01",children:"January 1st"}),e.jsx(W,{value:"04-01",children:"April 1st"}),e.jsx(W,{value:"07-01",children:"July 1st"}),e.jsx(W,{value:"10-01",children:"October 1st"})]})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(I,{variant:"outline",onClick:()=>{m(!1),Q()},children:"Cancel"}),e.jsx(I,{onClick:P,disabled:!p.name.trim(),children:"Create Client"})]})]})]})]})]})]}),e.jsxs(an,{defaultValue:"overview",className:"space-y-6",children:[e.jsxs(on,{className:"grid w-full grid-cols-5",children:[e.jsx(vt,{value:"overview",children:"Overview"}),e.jsx(vt,{value:"clients",children:"Clients"}),e.jsx(vt,{value:"communications",children:"Communications"}),e.jsx(vt,{value:"documents",children:"Shared Documents"}),e.jsx(vt,{value:"portal",children:"Portal Settings"})]}),e.jsxs(yt,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Active Clients"}),e.jsx(Sa,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:c?"...":s.activeClients}),e.jsx("p",{className:"text-xs text-muted-foreground",children:c?"Loading...":"Total companies"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Unread Messages"}),e.jsx(La,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:c?"...":s.unreadMessages}),e.jsx("p",{className:"text-xs text-muted-foreground",children:c?"Loading...":"Require response"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Pending Approvals"}),e.jsx(Cr,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:c?"...":s.pendingApprovals}),e.jsx("p",{className:"text-xs text-muted-foreground",children:c?"Loading...":"Documents awaiting approval"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Portal Access"}),e.jsx(ir,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:c?"...":o.filter(O=>O.isActive).length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:c?"Loading...":"Active portal users"})]})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Recent Communications"}),e.jsx(Vt,{children:"Latest messages and interactions with clients"})]}),e.jsx(ie,{className:"space-y-4",children:e.jsx("div",{className:"space-y-3",children:c?e.jsx("div",{className:"text-center py-4",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading messages..."})}):a.length===0?e.jsx("div",{className:"text-center py-4",children:e.jsx("div",{className:"text-muted-foreground",children:"No recent messages"})}):a.slice(0,4).map(O=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(Kc,{children:e.jsx(Yc,{children:oe(O.sender.name)})}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:O.company.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:['"',O.messageText.length>60?O.messageText.substring(0,60)+"...":O.messageText,'"']}),e.jsx("p",{className:"text-xs text-muted-foreground",children:U(O.createdAt)})]}),e.jsx(Oe,{variant:O.isRead?"default":"destructive",className:O.isRead?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:O.isRead?e.jsxs(e.Fragment,{children:[e.jsx(bs,{className:"mr-1 h-3 w-3"}),"Read"]}):"Unread"})]},O.id))})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Client Portal Activity"}),e.jsx(Vt,{children:"Recent client portal usage and document access"})]}),e.jsx(ie,{className:"space-y-4",children:e.jsx("div",{className:"space-y-3",children:c?e.jsx("div",{className:"text-center py-4",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading activity..."})}):o.length===0?e.jsx("div",{className:"text-center py-4",children:e.jsx("div",{className:"text-muted-foreground",children:"No portal activity"})}):o.slice(0,4).map(O=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`flex h-10 w-10 items-center justify-center rounded-full ${O.isActive?"bg-green-100":"bg-gray-100"}`,children:e.jsx(ir,{className:`h-5 w-5 ${O.isActive?"text-green-600":"text-gray-600"}`})}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:O.isActive?"Portal Access Active":"Portal Access Inactive"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[O.company.name," - ",O.user.name]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Role: ",O.user.role]})]}),e.jsx(Oe,{variant:O.isActive?"default":"secondary",className:O.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:O.isActive?"Active":"Inactive"})]},O.id))})})]})]})]}),e.jsxs(yt,{value:"clients",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Client Directory"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ge,{placeholder:"Search clients...",className:"w-64",value:u,onChange:O=>h(O.target.value)}),e.jsx(I,{onClick:()=>{Q(),m(!0)},children:"Add Client"})]})]}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:c?e.jsx("div",{className:"col-span-full text-center py-8",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading clients..."})}):r.length===0?e.jsxs("div",{className:"col-span-full text-center py-8",children:[e.jsx("div",{className:"text-muted-foreground",children:"No clients found"}),e.jsx(I,{className:"mt-2",onClick:()=>{Q(),m(!0)},children:"Add First Client"})]}):r.filter(O=>!u||O.name.toLowerCase().includes(u.toLowerCase())||O.industry&&O.industry.toLowerCase().includes(u.toLowerCase())).map(O=>{const te=o.some(re=>re.companyId===O.id&&re.isActive);return e.jsxs(ne,{children:[e.jsx(we,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Kc,{children:e.jsx(Yc,{children:oe(O.name)})}),e.jsxs("div",{children:[e.jsx(Se,{className:"text-lg",children:O.name}),e.jsx(Vt,{children:O.industry||"No industry specified"})]})]}),e.jsx(Oe,{variant:te?"default":"secondary",className:te?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800",children:te?"Active":"Setup Required"})]})}),e.jsxs(ie,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx(Dd,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:O.email||"No email provided"})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx(r1,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:O.phone||"No phone provided"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Created"}),e.jsx("span",{className:"font-medium",children:U(O.createdAt)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Portal Access"}),e.jsx(Oe,{variant:te?"default":"outline",className:te?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:te?"Enabled":"Setup Required"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Country"}),e.jsx("span",{className:"font-medium",children:O.country||"Not specified"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(I,{size:"sm",className:"flex-1",onClick:()=>D(O.id),children:[e.jsx(La,{className:"mr-2 h-4 w-4"}),"Message"]}),e.jsxs(I,{size:"sm",variant:"outline",className:"flex-1",onClick:()=>se(O.id),children:[e.jsx(Zt,{className:"mr-2 h-4 w-4"}),"Share Doc"]}),e.jsx(I,{size:"sm",variant:"outline",className:"flex-1",onClick:()=>J(O),children:"View Details"})]})]})]},O.id)})})]}),e.jsx(yt,{value:"communications",className:"space-y-6",children:e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Message Center"}),e.jsx(Vt,{children:"Secure communications with clients"})]}),e.jsxs(ie,{className:"space-y-6",children:[e.jsxs(ua,{children:[e.jsx(Hu,{className:"h-4 w-4"}),e.jsxs(ha,{children:["You have ",s.unreadMessages," unread messages from clients.",s.unreadMessages>0?" Some may require immediate attention.":" All messages have been read."]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Recent Messages"}),e.jsx("div",{className:"space-y-3",children:c?e.jsx("div",{className:"text-center py-4",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading messages..."})}):a.length===0?e.jsx("div",{className:"text-center py-4",children:e.jsx("div",{className:"text-muted-foreground",children:"No messages found"})}):a.slice(0,6).map(O=>e.jsxs("div",{className:"p-4 border rounded-lg hover:bg-muted/50 cursor-pointer",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Kc,{className:"h-8 w-8",children:e.jsx(Yc,{children:oe(O.sender.name)})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:O.company.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:O.sender.name})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(Oe,{variant:O.isRead?"default":"destructive",className:O.isRead?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:O.isRead?"Read":"Unread"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:U(O.createdAt)})]})]}),e.jsxs("p",{className:"text-sm",children:['"',O.messageText.length>100?O.messageText.substring(0,100)+"...":O.messageText,'"']})]},O.id))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Quick Actions"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(I,{className:"w-full justify-start bg-transparent",variant:"outline",onClick:()=>D(),children:[e.jsx(La,{className:"mr-2 h-4 w-4"}),"Compose New Message"]}),e.jsxs(I,{className:"w-full justify-start bg-transparent",variant:"outline",children:[e.jsx(Xn,{className:"mr-2 h-4 w-4"}),"Schedule Meeting"]}),e.jsxs(I,{className:"w-full justify-start bg-transparent",variant:"outline",children:[e.jsx(hm,{className:"mr-2 h-4 w-4"}),"Share Document"]}),e.jsxs(I,{className:"w-full justify-start bg-transparent",variant:"outline",children:[e.jsx(Hu,{className:"mr-2 h-4 w-4"}),"Send Notification"]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Message Templates"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{size:"sm",variant:"ghost",className:"w-full justify-start text-sm",children:"Document Review Request"}),e.jsx(I,{size:"sm",variant:"ghost",className:"w-full justify-start text-sm",children:"Meeting Confirmation"}),e.jsx(I,{size:"sm",variant:"ghost",className:"w-full justify-start text-sm",children:"Payment Reminder"}),e.jsx(I,{size:"sm",variant:"ghost",className:"w-full justify-start text-sm",children:"Project Update"})]})]})]})]})]})]})}),e.jsx(yt,{value:"documents",className:"space-y-6",children:e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Shared Documents"}),e.jsx(Vt,{children:"Documents shared with clients through the portal"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:M?"Loading...":`${T.length} documents are currently shared with clients`}),e.jsxs(I,{onClick:()=>se(),children:[e.jsx(hm,{className:"mr-2 h-4 w-4"}),"Share New Document"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-4 text-sm font-medium text-muted-foreground border-b pb-2",children:[e.jsx("div",{className:"col-span-4",children:"Document"}),e.jsx("div",{className:"col-span-2",children:"Client"}),e.jsx("div",{className:"col-span-2",children:"Shared Date"}),e.jsx("div",{className:"col-span-2",children:"Status"}),e.jsx("div",{className:"col-span-2",children:"Actions"})]}),e.jsxs("div",{className:"space-y-2",children:[M?e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading shared documents..."})}):T.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-muted-foreground",children:"No documents have been shared yet"}),e.jsx(I,{className:"mt-2",onClick:()=>se(),children:"Share Your First Document"})]}):T.map(O=>{var te,re,le,Z,K;return e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center p-3 hover:bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"col-span-4 flex items-center space-x-3",children:[e.jsx(Zt,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:((te=O.document)==null?void 0:te.displayName)||((re=O.document)==null?void 0:re.name)||"Unknown Document"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:(le=O.document)!=null&&le.sizeBytes?`${(O.document.sizeBytes/1024/1024).toFixed(1)} MB`:"Unknown size"})]})]}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Kc,{className:"h-6 w-6",children:e.jsx(Yc,{children:oe(((Z=O.clientInfo)==null?void 0:Z.name)||"Unknown")})}),e.jsx("span",{className:"text-sm",children:((K=O.clientInfo)==null?void 0:K.name)||"Unknown Client"})]})}),e.jsx("div",{className:"col-span-2 text-sm text-muted-foreground",children:U(O.sharedAt||O.createdAt)}),e.jsx("div",{className:"col-span-2",children:e.jsx(Oe,{variant:O.status==="active"?"default":"secondary",className:O.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:O.expiresAt&&new Date(O.expiresAt)<new Date?e.jsxs(e.Fragment,{children:[e.jsx(Is,{className:"mr-1 h-3 w-3"}),"Expired"]}):e.jsxs(e.Fragment,{children:[e.jsx(bs,{className:"mr-1 h-3 w-3"}),"Active"]})})}),e.jsxs("div",{className:"col-span-2 flex items-center space-x-1",children:[e.jsx(I,{size:"sm",variant:"ghost",title:"View Document",children:e.jsx(ir,{className:"h-4 w-4"})}),e.jsx(I,{size:"sm",variant:"ghost",title:"Message Client",onClick:()=>{var X;return D((X=O.clientInfo)==null?void 0:X.id)},children:e.jsx(La,{className:"h-4 w-4"})})]})]},O.id)}),e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center p-3 hover:bg-muted/50 rounded-lg",style:{display:"none"},children:[e.jsxs("div",{className:"col-span-4 flex items-center space-x-3",children:[e.jsx(Zt,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Q4 Financial Report.pdf"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"2.4 MB"})]})]}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(Kc,{className:"h-6 w-6",children:[e.jsx(P0,{src:"/professional-woman-diverse.png"}),e.jsx(Yc,{children:"AC"})]}),e.jsx("span",{className:"text-sm",children:"ABC Corp"})]})}),e.jsx("div",{className:"col-span-2 text-sm text-muted-foreground",children:"2 hours ago"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(Oe,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:[e.jsx(Cr,{className:"mr-1 h-3 w-3"}),"Pending Review"]})}),e.jsxs("div",{className:"col-span-2 flex items-center space-x-1",children:[e.jsx(I,{size:"sm",variant:"ghost",children:e.jsx(ir,{className:"h-4 w-4"})}),e.jsx(I,{size:"sm",variant:"ghost",children:e.jsx(La,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center p-3 hover:bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"col-span-4 flex items-center space-x-3",children:[e.jsx(Zt,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Tax Return 2024.pdf"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"1.8 MB"})]})]}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(Kc,{className:"h-6 w-6",children:[e.jsx(P0,{src:"/professional-man.png"}),e.jsx(Yc,{children:"XY"})]}),e.jsx("span",{className:"text-sm",children:"XYZ Ind"})]})}),e.jsx("div",{className:"col-span-2 text-sm text-muted-foreground",children:"1 day ago"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(Oe,{variant:"default",className:"bg-green-100 text-green-800",children:[e.jsx(bs,{className:"mr-1 h-3 w-3"}),"Approved"]})}),e.jsxs("div",{className:"col-span-2 flex items-center space-x-1",children:[e.jsx(I,{size:"sm",variant:"ghost",children:e.jsx(An,{className:"h-4 w-4"})}),e.jsx(I,{size:"sm",variant:"ghost",children:e.jsx(hm,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center p-3 hover:bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"col-span-4 flex items-center space-x-3",children:[e.jsx(Zt,{className:"h-5 w-5 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Contract Amendment.docx"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"456 KB"})]})]}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(Kc,{className:"h-6 w-6",children:[e.jsx(P0,{src:"/professional-woman-2.png"}),e.jsx(Yc,{children:"DE"})]}),e.jsx("span",{className:"text-sm",children:"DEF Ent"})]})}),e.jsx("div",{className:"col-span-2 text-sm text-muted-foreground",children:"3 days ago"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(Oe,{variant:"destructive",children:[e.jsx(Is,{className:"mr-1 h-3 w-3"}),"Rejected"]})}),e.jsxs("div",{className:"col-span-2 flex items-center space-x-1",children:[e.jsx(I,{size:"sm",variant:"ghost",children:e.jsx(ir,{className:"h-4 w-4"})}),e.jsx(I,{size:"sm",variant:"ghost",children:e.jsx(La,{className:"h-4 w-4"})})]})]})]})]})]})})]})}),e.jsx(yt,{value:"portal",className:"space-y-6",children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Portal Configuration"}),e.jsx(Vt,{children:"Customize client portal settings and branding"})]}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Custom Branding"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Add your logo and brand colors"})]}),e.jsx(Oe,{variant:"default",className:"bg-green-100 text-green-800",children:"Enabled"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Two-Factor Authentication"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enhanced security for client access"})]}),e.jsx(Oe,{variant:"default",className:"bg-green-100 text-green-800",children:"Required"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Document Watermarks"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Add watermarks to shared documents"})]}),e.jsx(Oe,{variant:"outline",children:"Optional"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Email Notifications"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Notify clients of new documents"})]}),e.jsx(Oe,{variant:"default",className:"bg-green-100 text-green-800",children:"Enabled"})]})]}),e.jsx(I,{className:"w-full",children:"Configure Portal Settings"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Access Management"}),e.jsx(Vt,{children:"Manage client permissions and access levels"})]}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"font-medium",children:"Document Access"}),e.jsx(Oe,{variant:"default",className:"bg-blue-100 text-blue-800",children:"Full Access"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Clients can view, download, and approve documents"})]}),e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"font-medium",children:"Communication"}),e.jsx(Oe,{variant:"default",className:"bg-green-100 text-green-800",children:"Enabled"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Secure messaging and meeting scheduling"})]}),e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"font-medium",children:"Financial Reports"}),e.jsx(Oe,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:"View Only"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Read-only access to financial statements"})]}),e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"font-medium",children:"Invoice Management"}),e.jsx(Oe,{variant:"default",className:"bg-green-100 text-green-800",children:"Full Access"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"View, approve, and pay invoices online"})]})]}),e.jsx(I,{className:"w-full bg-transparent",variant:"outline",children:"Manage Permissions"})]})]})]})})]}),e.jsx(ts,{open:v,onOpenChange:O=>{O||(y(!1),q())},children:e.jsxs(ss,{className:"max-w-2xl",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Compose New Message"}),e.jsx(Ks,{children:"Send a secure message to one of your clients"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"recipient",children:"Recipient Company *"}),e.jsxs(rt,{value:j.recipientId,onValueChange:O=>b(te=>({...te,recipientId:O})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select a client to message"})}),e.jsx(at,{children:r.map(O=>e.jsx(W,{value:O.id,children:O.name},O.id))})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"subject",children:"Subject *"}),e.jsx(ge,{id:"subject",placeholder:"Enter message subject",value:j.subject,onChange:O=>b(te=>({...te,subject:O.target.value}))})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"priority",children:"Priority"}),e.jsxs(rt,{value:j.priority,onValueChange:O=>b(te=>({...te,priority:O})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select priority"})}),e.jsxs(at,{children:[e.jsx(W,{value:"low",children:"Low"}),e.jsx(W,{value:"normal",children:"Normal"}),e.jsx(W,{value:"high",children:"High"})]})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"message",children:"Message *"}),e.jsx(Xs,{id:"message",placeholder:"Type your message here...",value:j.messageText,onChange:O=>b(te=>({...te,messageText:O.target.value})),rows:6,className:"resize-none"}),e.jsx("div",{className:"text-right mt-1",children:e.jsxs("span",{className:"text-xs text-muted-foreground",children:[j.messageText.length," characters"]})})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(I,{variant:"outline",onClick:()=>y(!1),children:"Cancel"}),e.jsxs(I,{onClick:Ae,disabled:!j.recipientId||!j.subject.trim()||!j.messageText.trim(),children:[e.jsx(La,{className:"w-4 h-4 mr-2"}),"Send Message"]})]})]})]})}),e.jsx(ts,{open:w,onOpenChange:N,children:e.jsxs(ss,{className:"max-w-md",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Share Document"}),e.jsx(Ks,{children:"Share a document with the selected client"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"document-select",children:"Select Document"}),e.jsxs(rt,{value:C.documentId,onValueChange:O=>S(te=>({...te,documentId:O})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Choose a document to share"})}),e.jsx(at,{children:F?e.jsx(W,{value:"loading",disabled:!0,children:"Loading documents..."}):_.length===0?e.jsx(W,{value:"none",disabled:!0,children:"No documents available"}):_.map(O=>e.jsx(W,{value:O.id,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Zt,{className:"h-4 w-4"}),e.jsx("span",{children:O.displayName||O.name})]})},O.id))})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"share-message",children:"Message (Optional)"}),e.jsx(Xs,{id:"share-message",placeholder:"Add a message for the client...",value:C.message,onChange:O=>S(te=>({...te,message:O.target.value})),rows:3,className:"resize-none"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"expires-at",children:"Expiration Date (Optional)"}),e.jsx(ge,{id:"expires-at",type:"datetime-local",value:C.expiresAt,onChange:O=>S(te=>({...te,expiresAt:O.target.value}))})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(I,{variant:"outline",onClick:()=>N(!1),children:"Cancel"}),e.jsxs(I,{onClick:pe,disabled:!C.documentId||!C.clientId,children:[e.jsx(hm,{className:"w-4 h-4 mr-2"}),"Share Document"]})]})]})]})}),e.jsx(ts,{open:!!L,onOpenChange:O=>{O||J(null)},children:e.jsxs(ss,{className:"max-w-2xl",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Client Details"}),e.jsx(Ks,{children:"View detailed information about this client"})]}),L&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Company Name"}),e.jsx("p",{className:"text-lg font-semibold",children:L.name})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Industry"}),e.jsx("p",{className:"text-sm",children:L.industry||"Not specified"})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Country"}),e.jsx("p",{className:"text-sm",children:L.country||"Not specified"})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Currency"}),e.jsx("p",{className:"text-sm",children:L.currency||"Not specified"})]}),L.taxId&&e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Tax ID"}),e.jsx("p",{className:"text-sm",children:L.taxId})]}),L.fiscalYearStart&&e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Fiscal Year Start"}),e.jsx("p",{className:"text-sm",children:L.fiscalYearStart})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Contact Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Dd,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:L.email||"No email provided"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(r1,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:L.phone||"No phone provided"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Account Status"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Client Since"}),e.jsx("p",{className:"text-sm",children:U(L.createdAt)})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Portal Access"}),e.jsx("div",{className:"mt-1",children:e.jsx(Oe,{variant:o.some(O=>O.companyId===L.id&&O.isActive)?"default":"outline",className:o.some(O=>O.companyId===L.id&&O.isActive)?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:o.some(O=>O.companyId===L.id&&O.isActive)?"Enabled":"Setup Required"})})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[e.jsx(I,{variant:"outline",onClick:()=>J(null),children:"Close"}),e.jsxs(I,{onClick:()=>{J(null),D(L.id)},children:[e.jsx(La,{className:"w-4 h-4 mr-2"}),"Send Message"]})]})]})]})})]})}function wMe(){var _e,Xe,At,st,$t,fs,zt,St,js,et,lt,Fe,ft,He,Je,It,Gt,qt,As,Ht,xs,Ct,ke,gt,us,We,Et,Pt,rs,ms,Bs,Vs,Ws,Ns,er,Ir,jn,Hs,qr,qn,In,Yr,$r,Vr,wn,Vn,De,ut,Pe,_t,bt,ps,Pr,Wr,Zs,wr,xa,cr,Zn,Hi,Gi,Ti,Ea,Ki,mi,Da,fi,qa,Ne,Dt,ye,Be,Ft,Kt,Jt,kt,gs,fn,xi,$n,Ur,Yi,Ji,rn,Ll,zo,Qo,Xi,_o,qo,$l,Zo,el;const{toast:s}=za(),{clearAllData:t}=Ua(),[r,n]=x.useState(!1),[a,i]=x.useState(null),[o,l]=x.useState(null),[c,d]=x.useState([]),[u,h]=x.useState(null),[f,m]=x.useState(null),[p,g]=x.useState(null),[v,y]=x.useState(null),[j,b]=x.useState(!1),[w,N]=x.useState(""),[C,S]=x.useState([]),[_,k]=x.useState(!1),[F,A]=x.useState([]),[T,V]=x.useState([]),[M,G]=x.useState(""),[L,J]=x.useState(""),[z,U]=x.useState([]),[oe,Q]=x.useState(""),[P,q]=x.useState(["read"]),[D,se]=x.useState(!1),[he,be]=x.useState(null),[pe,Ae]=x.useState(!1),[Ee,$e]=x.useState({totpCode:"",password:""}),[O,te]=x.useState("totp"),[re,le]=x.useState(!1),[Z,K]=x.useState(null),X=async()=>{n(!0);try{const[ot,qs,Sn,hr,Fn,Rr,$,Xt,ds,Us]=await Promise.all([Fa.getOverview(),Fa.getAccessControl(),Fa.getAuditLogs(1,20),Fa.getCompliance(),Fa.getEncryption(),Fa.getMonitoring(),Fa.getSessions(),Fa.getIPWhitelist(),Fa.getAPIKeys(),Fa.getMFAStatus()]);i(ot),l(qs),Array.isArray(Sn)?d(Sn):Sn!=null&&Sn.data&&Array.isArray(Sn.data)?d(Sn.data):d([]),h(hr),m(Fn),g(Rr),b(Us.mfaEnabled),$&&$.sessions?A($.sessions):A([]),Xt&&Xt.whitelistedIPs?V(Xt.whitelistedIPs):V([]),ds&&ds.apiKeys?U(ds.apiKeys):U([])}catch(ot){console.error("Error loading security data:",ot),d([]),s({title:"Error",description:"Failed to load security data. Please try again.",variant:"destructive"})}finally{n(!1)}},ce=ot=>{K(ot),le(!0)},Y=async()=>{try{const ot=await Fa.startMFASetup();ot&&ot.secret&&ot.qrCodeUrl?(y(ot),s({title:"MFA Setup Started",description:"Scan the QR code with your authenticator app."})):(console.error("MFA setup data is incomplete:",ot),s({title:"Error",description:"MFA setup data is incomplete. Please try again.",variant:"destructive"}))}catch(ot){console.error("MFA Setup Error:",ot),s({title:"Error",description:"Failed to start MFA setup. Please try again.",variant:"destructive"})}},ue=async()=>{if(!w){s({title:"Error",description:"Please enter the verification code.",variant:"destructive"});return}try{const ot=await Fa.verifyMFASetup(w);b(!0),S(ot.backupCodes),y(null),N(""),s({title:"MFA Enabled",description:"Two-factor authentication has been successfully enabled."})}catch{s({title:"Error",description:"Invalid verification code. Please try again.",variant:"destructive"})}},ve=()=>{Ae(!0),$e({totpCode:"",password:""}),te("totp")},Le=async()=>{try{const ot=O==="totp"?{totpCode:Ee.totpCode}:{password:Ee.password};await Fa.disableMFA(ot),b(!1),S([]),Ae(!1),$e({totpCode:"",password:""}),s({title:"MFA Disabled",description:"Two-factor authentication has been disabled."})}catch(ot){s({title:"Error",description:ot.message||"Failed to disable MFA. Please try again.",variant:"destructive"})}},Me=async()=>{try{const ot=await Fa.regenerateBackupCodes();S(ot.backupCodes),s({title:"Backup Codes Regenerated",description:"New backup codes have been generated. Please save them securely."})}catch{s({title:"Error",description:"Failed to regenerate backup codes.",variant:"destructive"})}},tt=async ot=>{try{await Fa.revokeSession(ot),A(F.filter(qs=>qs.id!==ot)),s({title:"Session Revoked",description:"The session has been successfully revoked."})}catch{s({title:"Error",description:"Failed to revoke session.",variant:"destructive"})}},fe=async()=>{if(!M){s({title:"Error",description:"Please enter an IP address.",variant:"destructive"});return}try{const ot=await Fa.addIPToWhitelist(M,L);V([...T,ot]),G(""),J(""),s({title:"IP Added",description:"IP address has been added to the whitelist."})}catch{s({title:"Error",description:"Failed to add IP to whitelist.",variant:"destructive"})}},ct=async ot=>{try{await Fa.removeIPFromWhitelist(ot),V(T.filter(qs=>qs.id!==ot)),s({title:"IP Removed",description:"IP address has been removed from the whitelist."})}catch{s({title:"Error",description:"Failed to remove IP from whitelist.",variant:"destructive"})}},dt=async()=>{if(!oe){s({title:"Error",description:"Please enter an API key name.",variant:"destructive"});return}if(P.length===0){s({title:"Error",description:"Please select at least one permission.",variant:"destructive"});return}try{const ot=await Fa.createAPIKey(oe,P);U([...z,ot]),Q(""),q(["read"]),be(ot),se(!0),s({title:"API Key Created",description:"New API key has been created successfully."})}catch{s({title:"Error",description:"Failed to create API key.",variant:"destructive"})}},pt=async ot=>{try{await Fa.revokeAPIKey(ot),U(z.filter(qs=>qs.id!==ot)),s({title:"API Key Revoked",description:"API key has been revoked successfully."})}catch{s({title:"Error",description:"Failed to revoke API key.",variant:"destructive"})}},qe=ot=>{q(qs=>qs.includes(ot)?qs.filter(Sn=>Sn!==ot):[...qs,ot])},mt=ot=>{navigator.clipboard.writeText(ot),s({title:"Copied",description:"Text copied to clipboard."})};x.useEffect(()=>{X()},[]);const Rt=async()=>{try{const ot=await Fa.triggerAudit();s({title:"Security Audit Started",description:`Audit ${ot.auditId} initiated successfully. Estimated completion: ${new Date(ot.estimatedCompletion).toLocaleTimeString()}`})}catch(ot){console.error("Error triggering security audit:",ot),s({title:"Error",description:"Failed to start security audit. Please try again.",variant:"destructive"})}};return e.jsxs(Kr,{children:[e.jsxs("div",{className:"flex-1 space-y-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Security & Compliance"}),e.jsx("p",{className:"text-muted-foreground",children:"Advanced security controls and regulatory compliance management"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(I,{variant:"outline",onClick:Rt,disabled:r,children:[e.jsx(or,{className:"mr-2 h-4 w-4"}),"Security Audit"]}),e.jsxs(I,{onClick:()=>X(),disabled:r,children:[r?e.jsx(Ts,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(kn,{className:"mr-2 h-4 w-4"}),r?"Loading...":"Refresh Data"]}),e.jsxs(I,{variant:"outline",onClick:()=>{t(),s({title:"Data Cleared",description:"All localStorage data has been cleared for debugging."})},disabled:r,children:[e.jsx(hn,{className:"mr-2 h-4 w-4"}),"Clear All Data (Debug)"]})]})]}),e.jsxs(an,{defaultValue:"overview",className:"space-y-6",children:[e.jsxs(on,{className:"grid w-full grid-cols-8",children:[e.jsx(vt,{value:"overview",children:"Overview"}),e.jsx(vt,{value:"mfa",children:"MFA"}),e.jsx(vt,{value:"sessions",children:"Sessions"}),e.jsx(vt,{value:"access",children:"Access Control"}),e.jsx(vt,{value:"audit",children:"Audit Logs"}),e.jsx(vt,{value:"compliance",children:"Compliance"}),e.jsx(vt,{value:"encryption",children:"Data Security"}),e.jsx(vt,{value:"monitoring",children:"Monitoring"})]}),e.jsxs(yt,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Security Score"}),e.jsx(kn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:`text-2xl font-bold ${a!=null&&a.securityScore&&a.securityScore>=90?"text-green-600":a!=null&&a.securityScore&&a.securityScore>=70?"text-yellow-600":"text-red-600"}`,children:[(a==null?void 0:a.securityScore)||0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:a!=null&&a.securityScore&&a.securityScore>=90?"Excellent security posture":a!=null&&a.securityScore&&a.securityScore>=70?"Good security posture":"Needs improvement"}),u&&f&&p&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Compliance: ",u.overallScore,"%"]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Active Sessions"}),e.jsx(Sa,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(a==null?void 0:a.activeSessions)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all users"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Failed Logins"}),e.jsx(Is,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:`text-2xl font-bold ${a!=null&&a.failedLogins&&a.failedLogins>10?"text-red-600":a!=null&&a.failedLogins&&a.failedLogins>5?"text-yellow-600":"text-green-600"}`,children:(a==null?void 0:a.failedLogins)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Last 24 hours"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Compliance Status"}),e.jsx(bs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[(a==null?void 0:a.complianceStatus)||0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"SOC 2 Type II compliant"})]})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Security Health Check"}),e.jsx(Vt,{children:"Current security status across all systems"})]}),e.jsx(ie,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Two-Factor Authentication"}),e.jsxs(Oe,{variant:"default",className:(a==null?void 0:a.mfaPercentage)===100?"bg-green-100 text-green-800":a!=null&&a.mfaPercentage&&a.mfaPercentage>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800",children:[e.jsx(bs,{className:"mr-1 h-3 w-3"}),(a==null?void 0:a.mfaPercentage)===100?"Enabled":a!=null&&a.mfaPercentage&&a.mfaPercentage>0?"Partial":"Disabled"]})]}),e.jsx(No,{value:(a==null?void 0:a.mfaPercentage)||0,className:"h-2"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(a==null?void 0:a.mfaEnabled)||0," of ",(a==null?void 0:a.totalUsers)||0," users have 2FA enabled (",(a==null?void 0:a.mfaPercentage)||0,"%)"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Data Encryption"}),e.jsxs(Oe,{variant:"default",className:"bg-green-100 text-green-800",children:[e.jsx(bs,{className:"mr-1 h-3 w-3"}),"Active"]})]}),e.jsx(No,{value:100,className:"h-2"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"AES-256 encryption at rest and in transit"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Access Controls"}),e.jsxs(Oe,{variant:"default",className:"bg-green-100 text-green-800",children:[e.jsx(bs,{className:"mr-1 h-3 w-3"}),"Configured"]})]}),e.jsx(No,{value:95,className:"h-2"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Role-based permissions active"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Backup & Recovery"}),e.jsxs(Oe,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:[e.jsx(Cr,{className:"mr-1 h-3 w-3"}),"In Progress"]})]}),e.jsx(No,{value:85,className:"h-2"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Daily backups with 99.9% success rate"})]})]})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Recent Security Events"}),e.jsx(Vt,{children:"Latest security activities and alerts"})]}),e.jsx(ie,{className:"space-y-4",children:e.jsx("div",{className:"space-y-3",children:c&&c.length>0?c.slice(0,5).map(ot=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`flex h-10 w-10 items-center justify-center rounded-full ${ot.status==="failed"?"bg-red-100":ot.action.includes("LOGIN")?"bg-green-100":ot.action.includes("SECURITY")?"bg-yellow-100":"bg-blue-100"}`,children:ot.status==="failed"?e.jsx(Is,{className:`h-5 w-5 ${ot.status==="failed"?"text-red-600":ot.action.includes("LOGIN")?"text-green-600":ot.action.includes("SECURITY")?"text-yellow-600":"text-blue-600"}`}):ot.action.includes("LOGIN")?e.jsx(bs,{className:"h-5 w-5 text-green-600"}):ot.action.includes("SECURITY")?e.jsx(kn,{className:"h-5 w-5 text-yellow-600"}):e.jsx(cf,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:ot.action.replace(/_/g," ").toLowerCase()}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["User: ",ot.user]}),ot.ipAddress&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["From: ",ot.ipAddress]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(ot.timestamp).toLocaleString()})]})]},ot.id)):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"No recent security events"})})})})]})]})]}),e.jsx(yt,{value:"mfa",className:"space-y-6",children:e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Multi-Factor Authentication"}),e.jsx(Vt,{children:"Secure your account with two-factor authentication"})]}),e.jsx(ie,{className:"space-y-6",children:!j&&!v?e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"flex h-20 w-20 items-center justify-center rounded-full bg-yellow-100 mx-auto",children:e.jsx(Sd,{className:"h-10 w-10 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Enable Two-Factor Authentication"}),e.jsx("p",{className:"text-muted-foreground",children:"Add an extra layer of security to your account with 2FA"})]}),e.jsxs(I,{onClick:Y,className:"mt-4",children:[e.jsx(dl,{className:"mr-2 h-4 w-4"}),"Set Up MFA"]})]}):v?e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ua,{children:[e.jsx(dl,{className:"h-4 w-4"}),e.jsx(ha,{children:"Scan this QR code with your authenticator app (Google Authenticator, Authy, etc.)"})]}),e.jsx("div",{className:"flex justify-center p-6 bg-white border rounded-lg",children:e.jsx("div",{className:"text-center space-y-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex h-32 w-32 items-center justify-center rounded-lg bg-gray-100 mx-auto",children:e.jsx(dl,{className:"h-16 w-16 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"QR Code Ready"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Click the button below to view and scan the QR code"})]}),e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsxs(I,{onClick:()=>k(!0),className:"w-full",children:[e.jsx(dl,{className:"mr-2 h-4 w-4"}),"View QR Code"]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>mt(v.secret),children:[e.jsx(ac,{className:"mr-2 h-4 w-4"}),"Copy Secret"]})]})]})})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Enter the 6-digit code from your authenticator app"}),e.jsx("input",{type:"text",placeholder:"123456",value:w,onChange:ot=>N(ot.target.value),className:"w-full mt-2 px-3 py-2 border rounded-md",maxLength:6})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(I,{onClick:ue,disabled:!w,children:"Verify & Enable MFA"}),e.jsx(I,{variant:"outline",onClick:()=>y(null),children:"Cancel"})]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ua,{children:[e.jsx(bs,{className:"h-4 w-4"}),e.jsx(ha,{children:"Two-factor authentication is enabled and protecting your account."})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(ne,{children:[e.jsx(we,{className:"pb-4",children:e.jsx(Se,{className:"text-lg",children:"MFA Status"})}),e.jsxs(ie,{children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-green-100",children:e.jsx(bs,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Enabled"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Account protected with 2FA"})]})]}),e.jsxs(I,{variant:"destructive",size:"sm",onClick:ve,className:"mt-4",children:[e.jsx(hn,{className:"mr-2 h-4 w-4"}),"Disable MFA"]})]})]}),e.jsxs(ne,{children:[e.jsx(we,{className:"pb-4",children:e.jsx(Se,{className:"text-lg",children:"Backup Codes"})}),e.jsxs(ie,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Use these codes if you lose access to your authenticator app"}),C.length>0?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"grid grid-cols-2 gap-2 text-xs font-mono",children:C.slice(0,6).map((ot,qs)=>e.jsx("div",{className:"bg-gray-100 p-2 rounded text-center",children:ot},qs))}),e.jsxs(I,{variant:"outline",size:"sm",onClick:Me,className:"mt-3",children:[e.jsx(Ts,{className:"mr-2 h-4 w-4"}),"Regenerate Codes"]})]}):e.jsx(I,{variant:"outline",size:"sm",onClick:Me,children:"Generate Backup Codes"})]})]})]})]})})]})}),e.jsx(yt,{value:"sessions",className:"space-y-6",children:e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Active Sessions"}),e.jsx(Vt,{children:"Manage your active login sessions across all devices"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[F.map(ot=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-blue-100",children:e.jsx(jf,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"font-medium",children:ot.deviceName}),ot.isCurrent&&e.jsx(Oe,{variant:"default",className:"bg-green-100 text-green-800",children:"Current"})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(qu,{className:"h-3 w-3"}),e.jsx("span",{children:ot.ipAddress})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Pa,{className:"h-3 w-3"}),e.jsx("span",{children:ot.location})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Xn,{className:"h-3 w-3"}),e.jsxs("span",{children:["Last active: ",new Date(ot.lastActivity).toLocaleString()]})]})]})]})]}),!ot.isCurrent&&e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>tt(ot.id),children:[e.jsx(hn,{className:"mr-2 h-4 w-4"}),"Revoke"]})]},ot.id)),F.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(jf,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"No active sessions found"})]})]})})]})}),e.jsxs(yt,{value:"access",className:"space-y-6",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Access Control Management"}),e.jsx(Vt,{children:"Role-based permissions and user access controls"})]}),e.jsxs(ie,{className:"space-y-6",children:[e.jsxs(ua,{children:[e.jsx(kn,{className:"h-4 w-4"}),e.jsxs(ha,{children:["All users have appropriate role-based access controls. ",(o==null?void 0:o.totalUsers)||0," total users, ",(o==null?void 0:o.activeUsers)||0," active users with granular permissions."]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"User Roles & Permissions"}),e.jsx("div",{className:"space-y-3",children:o!=null&&o.roleStats?Object.entries(o.roleStats).map(([ot,qs])=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`flex h-10 w-10 items-center justify-center rounded-full ${ot==="super_admin"?"bg-red-100":ot==="admin"?"bg-blue-100":ot==="accountant"?"bg-green-100":"bg-yellow-100"}`,children:ot==="super_admin"?e.jsx(kn,{className:"h-5 w-5 text-red-600"}):ot==="admin"?e.jsx(Sa,{className:"h-5 w-5 text-blue-600"}):ot==="accountant"?e.jsx(Zt,{className:"h-5 w-5 text-green-600"}):e.jsx(ir,{className:"h-5 w-5 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:ot.replace(/_/g," ").replace(/\b\w/g,Sn=>Sn.toUpperCase())}),e.jsx("p",{className:"text-sm text-muted-foreground",children:ot==="super_admin"?"Full system access":ot==="admin"?"User & system management":ot==="accountant"?"Financial data access":"Read-only access"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium",children:[qs.count," users"]}),e.jsx(Oe,{variant:ot==="super_admin"?"destructive":ot==="admin"?"secondary":ot==="accountant"?"default":"outline",className:ot==="super_admin"?"":ot==="admin"?"bg-blue-100 text-blue-800":ot==="accountant"?"bg-green-100 text-green-800":"",children:ot==="super_admin"?"Critical":ot==="admin"?"High":ot==="accountant"?"Standard":"Limited"})]})]},ot)):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"No role data available"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Access Control Features"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Sd,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Two-Factor Authentication"})]}),e.jsx(Oe,{variant:"default",className:(Xe=(_e=o==null?void 0:o.securityFeatures)==null?void 0:_e.twoFactorAuth)!=null&&Xe.required?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800",children:(st=(At=o==null?void 0:o.securityFeatures)==null?void 0:At.twoFactorAuth)!=null&&st.required?"Required":"Optional"})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[((fs=($t=o==null?void 0:o.securityFeatures)==null?void 0:$t.twoFactorAuth)==null?void 0:fs.enabledUsers)||0," of ",((St=(zt=o==null?void 0:o.securityFeatures)==null?void 0:zt.twoFactorAuth)==null?void 0:St.totalUsers)||0," users have 2FA enabled (",((et=(js=o==null?void 0:o.securityFeatures)==null?void 0:js.twoFactorAuth)==null?void 0:et.adoptionRate)||0,"%)"]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qu,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"IP Whitelisting"})]}),e.jsx(Oe,{variant:"default",className:(Fe=(lt=o==null?void 0:o.securityFeatures)==null?void 0:lt.ipWhitelisting)!=null&&Fe.active?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800",children:(He=(ft=o==null?void 0:o.securityFeatures)==null?void 0:ft.ipWhitelisting)!=null&&He.active?"Active":"Inactive"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:(It=(Je=o==null?void 0:o.securityFeatures)==null?void 0:Je.ipWhitelisting)!=null&&It.active?`${((qt=(Gt=o==null?void 0:o.securityFeatures)==null?void 0:Gt.ipWhitelisting)==null?void 0:qt.count)||0} IP addresses whitelisted`:"No IP restrictions configured"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Cr,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Session Management"})]}),e.jsx(Oe,{variant:"default",className:(Ht=(As=o==null?void 0:o.securityFeatures)==null?void 0:As.sessionManagement)!=null&&Ht.enforced?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800",children:(Ct=(xs=o==null?void 0:o.securityFeatures)==null?void 0:xs.sessionManagement)!=null&&Ct.enforced?"Configured":"Not Enforced"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:(gt=(ke=o==null?void 0:o.securityFeatures)==null?void 0:ke.sessionManagement)!=null&&gt.enforced?`Automatic session timeout after ${((We=(us=o==null?void 0:o.securityFeatures)==null?void 0:us.sessionManagement)==null?void 0:We.maxIdleTime)||30} minutes of inactivity`:"Session timeout not enforced"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(cf,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"API Key Management"})]}),e.jsx(Oe,{variant:"default",className:(Pt=(Et=o==null?void 0:o.securityFeatures)==null?void 0:Et.apiKeyRotation)!=null&&Pt.automatic?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800",children:(ms=(rs=o==null?void 0:o.securityFeatures)==null?void 0:rs.apiKeyRotation)!=null&&ms.automatic?"Automated":"Manual"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:(Vs=(Bs=o==null?void 0:o.securityFeatures)==null?void 0:Bs.apiKeyRotation)!=null&&Vs.automatic?`Automatic key rotation with audit logging. Next rotation: ${(Ns=(Ws=o==null?void 0:o.securityFeatures)==null?void 0:Ws.apiKeyRotation)!=null&&Ns.nextRotation?new Date(o.securityFeatures.apiKeyRotation.nextRotation).toLocaleDateString():"N/A"}`:"Manual key rotation required"})]})]})]})]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"IP Whitelist Management"}),e.jsx(Vt,{children:"Control which IP addresses can access your system"})]}),e.jsxs(ie,{className:"space-y-6",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("input",{type:"text",placeholder:"IP Address (e.g., 192.168.1.100)",value:M,onChange:ot=>G(ot.target.value),className:"flex-1 px-3 py-2 border rounded-md"}),e.jsx("input",{type:"text",placeholder:"Description (optional)",value:L,onChange:ot=>J(ot.target.value),className:"flex-1 px-3 py-2 border rounded-md"}),e.jsxs(I,{onClick:fe,children:[e.jsx(Ss,{className:"mr-2 h-4 w-4"}),"Add IP"]})]}),e.jsxs("div",{className:"space-y-3",children:[T.map(ot=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qu,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:ot.ipAddress}),ot.isActive&&e.jsx(Oe,{variant:"default",className:"bg-green-100 text-green-800",children:"Active"})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[ot.description,"  Added by ",ot.addedBy," on ",new Date(ot.addedAt).toLocaleDateString()]})]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>ct(ot.id),children:[e.jsx(hn,{className:"mr-2 h-4 w-4"}),"Remove"]})]},ot.id)),T.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(qu,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"No IP addresses in whitelist"})]})]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"API Key Management"}),e.jsx(Vt,{children:"Create and manage API keys for programmatic access"})]}),e.jsxs(ie,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("input",{type:"text",placeholder:"API Key Name",value:oe,onChange:ot=>Q(ot.target.value),className:"flex-1 px-3 py-2 border rounded-md"}),e.jsxs(I,{onClick:dt,children:[e.jsx(Ss,{className:"mr-2 h-4 w-4"}),"Create API Key"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Permissions:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["read","write","admin","reports","webhooks"].map(ot=>e.jsx("button",{type:"button",onClick:()=>qe(ot),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${P.includes(ot)?"bg-blue-100 text-blue-800 border border-blue-300":"bg-gray-100 text-gray-600 border border-gray-300 hover:bg-gray-200"}`,children:ot},ot))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Select the permissions this API key should have"})]})]}),D&&he&&e.jsxs(ua,{children:[e.jsx(cf,{className:"h-4 w-4"}),e.jsx(ha,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"font-medium",children:"Your new API key has been created:"}),e.jsxs("div",{className:"flex items-center space-x-2 bg-gray-100 p-3 rounded font-mono text-sm",children:[e.jsx("span",{className:"flex-1",children:he.apiKey}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>mt(he.apiKey||""),children:e.jsx(ac,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Permissions:"}),e.jsx("div",{className:"flex space-x-1",children:(er=he.permissions)==null?void 0:er.map(ot=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:ot},ot))})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Make sure to copy this key now. You won't be able to see it again!"}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{se(!1),be(null)},children:"I've saved this key"})]})})]}),e.jsxs("div",{className:"space-y-3",children:[z.map(ot=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(cf,{className:"h-4 w-4 text-purple-600"}),e.jsx("span",{className:"font-medium",children:ot.name}),ot.isActive&&e.jsx(Oe,{variant:"default",className:"bg-green-100 text-green-800",children:"Active"})]}),e.jsxs("div",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsxs("p",{children:["Key: ",ot.keyPrefix]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{children:["Created: ",new Date(ot.createdAt).toLocaleDateString()]}),e.jsxs("span",{children:["Expires: ",new Date(ot.expiresAt).toLocaleDateString()]}),ot.lastUsed&&e.jsxs("span",{children:["Last used: ",new Date(ot.lastUsed).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"Permissions:"}),ot.permissions.map(qs=>e.jsx(Oe,{variant:"outline",className:"text-xs",children:qs},qs))]})]})]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>pt(ot.id),children:[e.jsx(hn,{className:"mr-2 h-4 w-4"}),"Revoke"]})]},ot.id)),z.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(cf,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"No API keys created"})]})]})]})]})]}),e.jsx(yt,{value:"audit",className:"space-y-6",children:e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Audit Trail & Activity Logs"}),e.jsx(Vt,{children:"Comprehensive logging of all system activities"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing recent audit events  ",(c==null?void 0:c.length)||0," total events loaded"]}),e.jsx(I,{variant:"outline",size:"sm",children:"Export Logs"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-4 text-sm font-medium text-muted-foreground border-b pb-2",children:[e.jsx("div",{className:"col-span-2",children:"Timestamp"}),e.jsx("div",{className:"col-span-2",children:"User"}),e.jsx("div",{className:"col-span-3",children:"Action"}),e.jsx("div",{className:"col-span-2",children:"Resource"}),e.jsx("div",{className:"col-span-2",children:"IP Address"}),e.jsx("div",{className:"col-span-1",children:"Status"})]}),e.jsx("div",{className:"space-y-2",children:c&&c.length>0?c.map(ot=>{const qs=hr=>hr.includes("FAILED")||hr.includes("DENIED")?e.jsx(Oe,{variant:"destructive",children:"Failed"}):hr.includes("WARNING")||hr.includes("ALERT")?e.jsx(Oe,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:"Warning"}):hr.includes("INFO")||hr.includes("BACKUP")?e.jsx(Oe,{variant:"default",className:"bg-blue-100 text-blue-800",children:"Info"}):e.jsx(Oe,{variant:"default",className:"bg-green-100 text-green-800",children:"Success"}),Sn=hr=>hr==="System"?"SY":hr.split(" ").map(Rr=>Rr.charAt(0)).join("").toUpperCase().slice(0,2);return e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center p-3 hover:bg-muted/50 rounded-lg",children:[e.jsx("div",{className:"col-span-2 text-sm",children:new Date(ot.timestamp).toLocaleString()}),e.jsxs("div",{className:"col-span-2 flex items-center space-x-2",children:[e.jsx(Kc,{className:"h-6 w-6",children:e.jsx(Yc,{children:Sn(ot.user)})}),e.jsx("span",{className:"text-sm",children:ot.user})]}),e.jsx("div",{className:"col-span-3 text-sm",children:ot.action}),e.jsx("div",{className:"col-span-2 text-sm",children:ot.entityType||"N/A"}),e.jsx("div",{className:"col-span-2 text-sm",children:ot.ipAddress||"N/A"}),e.jsx("div",{className:"col-span-1",children:qs(ot.action)})]},ot.id)}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(or,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"No audit logs found"})]})})]})]})})]})}),e.jsx(yt,{value:"compliance",className:"space-y-6",children:e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Regulatory Compliance"}),e.jsx(Vt,{children:"Real-time compliance status based on system security metrics"})]}),e.jsxs(ie,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Overall Compliance Score"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Based on MFA adoption, security monitoring, and audit logging"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-3xl font-bold text-green-600",children:[(u==null?void 0:u.overallScore)||0,"%"]}),e.jsx(Oe,{variant:((u==null?void 0:u.overallScore)||0)>=80?"default":((u==null?void 0:u.overallScore)||0)>=60?"secondary":"destructive",children:((u==null?void 0:u.overallScore)||0)>=80?"Excellent":((u==null?void 0:u.overallScore)||0)>=60?"Good":"Needs Attention"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Compliance Standards"}),e.jsx("div",{className:"grid gap-4 md:grid-cols-1 lg:grid-cols-2",children:(Ir=u==null?void 0:u.standards)==null?void 0:Ir.map(ot=>{const qs=hr=>{switch(hr){case"certified":return"bg-green-100 text-green-800";case"compliant":return"bg-blue-100 text-blue-800";case"non-compliant":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},Sn=hr=>{switch(hr){case"certified":return e.jsx(bs,{className:"h-5 w-5 text-green-600"});case"compliant":return e.jsx(kn,{className:"h-5 w-5 text-blue-600"});case"non-compliant":return e.jsx(Is,{className:"h-5 w-5 text-red-600"});default:return e.jsx(Cr,{className:"h-5 w-5 text-gray-600"})}};return e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-muted",children:Sn(ot.status)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:ot.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:ot.description})]})]}),e.jsx(Oe,{className:qs(ot.status),children:ot.status.charAt(0).toUpperCase()+ot.status.slice(1).replace("-"," ")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Score:"}),e.jsxs("span",{className:"font-medium",children:[ot.score,"%"]})]}),e.jsx(No,{value:ot.score,className:"h-2"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Last audit: ",ot.lastAudit?new Date(ot.lastAudit).toLocaleDateString():"N/A"]}),e.jsxs("span",{children:["Next audit: ",ot.nextAudit?new Date(ot.nextAudit).toLocaleDateString():"N/A"]})]})]})]},ot.name)})})]}),(u==null?void 0:u.actions)&&u.actions.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Required Actions"}),e.jsx("div",{className:"space-y-3",children:u.actions.map(ot=>{const qs=Rr=>{switch(Rr){case"high":return"border-red-200 bg-red-50";case"medium":return"border-yellow-200 bg-yellow-50";case"low":return"border-blue-200 bg-blue-50";default:return"border-gray-200 bg-gray-50"}},Sn=Rr=>{switch(Rr){case"high":return e.jsx(Oe,{variant:"destructive",children:"High Priority"});case"medium":return e.jsx(Oe,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:"Medium Priority"});case"low":return e.jsx(Oe,{variant:"default",className:"bg-blue-100 text-blue-800",children:"Low Priority"});default:return e.jsx(Oe,{variant:"outline",children:"Normal"})}},hr=ot.dueDate?new Date(ot.dueDate)<new Date:!1,Fn=ot.dueDate?Math.ceil((new Date(ot.dueDate).getTime()-new Date().getTime())/(1e3*60*60*24)):0;return e.jsxs("div",{className:`p-4 border rounded-lg ${qs(ot.priority)}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium",children:ot.title}),e.jsxs("div",{className:"flex items-center space-x-2",children:[Sn(ot.priority),e.jsx(Oe,{variant:hr?"destructive":Fn<=3?"secondary":"outline",children:hr?"Overdue":`Due in ${Fn} days`})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:ot.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Due: ",ot.dueDate?new Date(ot.dueDate).toLocaleDateString():"N/A"]}),e.jsx(I,{size:"sm",variant:"outline",children:ot.status==="pending"||ot.status==="active"?"Start Action":"View Details"})]})]},ot.id)})})]}),(!(u!=null&&u.actions)||u.actions.length===0)&&e.jsxs(ua,{children:[e.jsx(bs,{className:"h-4 w-4"}),e.jsx(ha,{children:"All compliance requirements are currently met. No immediate actions required."})]})]})]})}),e.jsx(yt,{value:"encryption",className:"space-y-6",children:e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Data Security & Encryption"}),e.jsx(Vt,{children:"Real-time encryption status and security measures based on system metrics"})]}),e.jsxs(ie,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Overall Security Score"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Based on password security, MFA adoption, and security monitoring"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-3xl font-bold text-green-600",children:[(f==null?void 0:f.securityScore)||0,"%"]}),e.jsx(Oe,{variant:((f==null?void 0:f.securityScore)||0)>=90?"default":((f==null?void 0:f.securityScore)||0)>=70?"secondary":"destructive",children:((f==null?void 0:f.securityScore)||0)>=90?"Excellent":((f==null?void 0:f.securityScore)||0)>=70?"Good":"Needs Attention"})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Encryption Status"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(e1,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Data at Rest"})]}),e.jsx(Oe,{variant:(Hs=(jn=f==null?void 0:f.encryption)==null?void 0:jn.dataAtRest)!=null&&Hs.enabled?"default":"destructive",className:(qn=(qr=f==null?void 0:f.encryption)==null?void 0:qr.dataAtRest)!=null&&qn.enabled?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:((Yr=(In=f==null?void 0:f.encryption)==null?void 0:In.dataAtRest)==null?void 0:Yr.algorithm)||"Not Configured"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:(Vr=($r=f==null?void 0:f.encryption)==null?void 0:$r.dataAtRest)!=null&&Vr.enabled?"All passwords are securely hashed with salt":"Password security needs attention"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Status: ",((Vn=(wn=f==null?void 0:f.encryption)==null?void 0:wn.dataAtRest)==null?void 0:Vn.status)||"Unknown"]}),e.jsxs("span",{children:["Last rotation: ",(ut=(De=f==null?void 0:f.encryption)==null?void 0:De.dataAtRest)!=null&&ut.lastKeyRotation?new Date(f.encryption.dataAtRest.lastKeyRotation).toLocaleDateString():"N/A"]})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qu,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Data in Transit"})]}),e.jsx(Oe,{variant:(_t=(Pe=f==null?void 0:f.encryption)==null?void 0:Pe.dataInTransit)!=null&&_t.enabled?"default":"destructive",className:(ps=(bt=f==null?void 0:f.encryption)==null?void 0:bt.dataInTransit)!=null&&ps.enabled?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:((Wr=(Pr=f==null?void 0:f.encryption)==null?void 0:Pr.dataInTransit)==null?void 0:Wr.protocol)||"Not Configured"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:(wr=(Zs=f==null?void 0:f.encryption)==null?void 0:Zs.dataInTransit)!=null&&wr.enabled?"All network communications are encrypted":"Network encryption needs to be enabled"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Status: ",((cr=(xa=f==null?void 0:f.encryption)==null?void 0:xa.dataInTransit)==null?void 0:cr.status)||"Unknown"]}),e.jsxs("span",{children:["Cert expires: ",(Hi=(Zn=f==null?void 0:f.encryption)==null?void 0:Zn.dataInTransit)!=null&&Hi.certificateExpiry?new Date(f.encryption.dataInTransit.certificateExpiry).toLocaleDateString():"N/A"]})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(cf,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Key Management"})]}),e.jsx(Oe,{variant:((Ti=(Gi=f==null?void 0:f.encryption)==null?void 0:Gi.keyManagement)==null?void 0:Ti.status)==="operational"?"default":"secondary",className:((Ki=(Ea=f==null?void 0:f.encryption)==null?void 0:Ea.keyManagement)==null?void 0:Ki.status)==="operational"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800",children:((Da=(mi=f==null?void 0:f.encryption)==null?void 0:mi.keyManagement)==null?void 0:Da.type)||"Unknown"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:((qa=(fi=f==null?void 0:f.encryption)==null?void 0:fi.keyManagement)==null?void 0:qa.status)==="operational"?"Key management is operational":"Key management needs attention"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Keys rotated: ",((Dt=(Ne=f==null?void 0:f.encryption)==null?void 0:Ne.keyManagement)==null?void 0:Dt.keysRotated)||0]}),e.jsxs("span",{children:["Last rotation: ",(Be=(ye=f==null?void 0:f.encryption)==null?void 0:ye.keyManagement)!=null&&Be.lastRotation?new Date(f.encryption.keyManagement.lastRotation).toLocaleDateString():"N/A"]})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(kn,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Application Security"})]}),e.jsx(Oe,{variant:(Kt=(Ft=f==null?void 0:f.encryption)==null?void 0:Ft.applicationSecurity)!=null&&Kt.enabled?"default":"destructive",className:(kt=(Jt=f==null?void 0:f.encryption)==null?void 0:Jt.applicationSecurity)!=null&&kt.enabled?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:((fn=(gs=f==null?void 0:f.encryption)==null?void 0:gs.applicationSecurity)==null?void 0:fn.type)||"Not Configured"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:($n=(xi=f==null?void 0:f.encryption)==null?void 0:xi.applicationSecurity)!=null&&$n.enabled?"Application-level security is active":"Application security needs improvement"}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Status: ",((Yi=(Ur=f==null?void 0:f.encryption)==null?void 0:Ur.applicationSecurity)==null?void 0:Yi.status)||"Unknown"]}),e.jsxs("span",{children:["Fields encrypted: ",((Ll=(rn=(Ji=f==null?void 0:f.encryption)==null?void 0:Ji.applicationSecurity)==null?void 0:rn.fieldsEncrypted)==null?void 0:Ll.length)||0]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Security Measures"}),e.jsx("div",{className:"space-y-3",children:(zo=f==null?void 0:f.securityMeasures)==null?void 0:zo.map(ot=>{const qs=hr=>{switch(hr){case"active":return"bg-green-100 text-green-800";case"partial":return"bg-yellow-100 text-yellow-800";case"inactive":return"bg-red-100 text-red-800";case"alert":return"bg-red-100 text-red-800";case"monitoring":return"bg-blue-100 text-blue-800";case"needs_attention":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},Sn=hr=>{switch(hr){case"active":return e.jsx(bs,{className:"h-4 w-4 text-green-600"});case"partial":return e.jsx(Is,{className:"h-4 w-4 text-yellow-600"});case"inactive":return e.jsx(Is,{className:"h-4 w-4 text-red-600"});case"alert":return e.jsx(Is,{className:"h-4 w-4 text-red-600"});case"monitoring":return e.jsx(or,{className:"h-4 w-4 text-blue-600"});case"needs_attention":return e.jsx(Is,{className:"h-4 w-4 text-yellow-600"});default:return e.jsx(Cr,{className:"h-4 w-4 text-gray-600"})}};return e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[Sn(ot.status),e.jsx("span",{className:"font-medium",children:ot.name})]}),e.jsx(Oe,{className:qs(ot.status),children:ot.status.charAt(0).toUpperCase()+ot.status.slice(1).replace("_"," ")})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:ot.description}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Last check: ",ot.lastCheck?new Date(ot.lastCheck).toLocaleDateString():"N/A"]}),e.jsx(I,{size:"sm",variant:"outline",className:"h-6 text-xs",onClick:()=>ce(ot),children:"View Details"})]})]},ot.name)})})]})]}),e.jsxs(ua,{children:[e.jsx(bs,{className:"h-4 w-4"}),e.jsx(ha,{children:((f==null?void 0:f.securityScore)||0)>=90?"All security measures are operating optimally. System is well-protected.":((f==null?void 0:f.securityScore)||0)>=70?"Security measures are mostly in place. Consider reviewing areas marked as 'needs attention'.":"Security measures need immediate attention. Please review and address the issues above."})]})]})]})}),e.jsx(yt,{value:"monitoring",className:"space-y-6",children:e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Security Monitoring & Alerts"}),e.jsx(Vt,{children:"Real-time security monitoring and incident response based on system metrics"})]}),e.jsxs(ie,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsxs("div",{className:`text-2xl font-bold ${(((Qo=p==null?void 0:p.systemMetrics)==null?void 0:Qo.uptime)||0)>=95?"text-green-600":(((Xi=p==null?void 0:p.systemMetrics)==null?void 0:Xi.uptime)||0)>=80?"text-yellow-600":"text-red-600"}`,children:[((_o=p==null?void 0:p.systemMetrics)==null?void 0:_o.uptime)||0,"%"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"System Uptime"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Based on security events and failed logins"})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:((qo=p==null?void 0:p.systemMetrics)==null?void 0:qo.monitoring)||"24/7"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Security Monitoring"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Continuous monitoring active"})]}),e.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[e.jsx("div",{className:`text-2xl font-bold ${(($l=p==null?void 0:p.systemMetrics)==null?void 0:$l.incidentResponse)==="<5min"?"text-green-600":"text-yellow-600"}`,children:((Zo=p==null?void 0:p.systemMetrics)==null?void 0:Zo.incidentResponse)||"<5min"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Incident Response"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Average response time"})]})]}),(p==null?void 0:p.alertSummary)&&e.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Security Alert Summary"}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:p.alertSummary.total}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Alerts"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:p.alertSummary.critical}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Critical"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:p.alertSummary.warning}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Warning"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:p.alertSummary.info}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Info"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Active Monitoring Components"}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:(el=p==null?void 0:p.monitoringComponents)==null?void 0:el.map(ot=>{const qs=hr=>{switch(hr){case"active":return"bg-green-100 text-green-800";case"secure":return"bg-green-100 text-green-800";case"normal":return"bg-green-100 text-green-800";case"needs_attention":return"bg-yellow-100 text-yellow-800";case"alert":return"bg-red-100 text-red-800";case"inactive":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},Sn=(hr,Fn)=>Fn==="red"||hr==="alert"?e.jsx(Is,{className:"h-4 w-4 text-red-600"}):Fn==="yellow"||hr==="needs_attention"?e.jsx(Is,{className:"h-4 w-4 text-yellow-600"}):Fn==="green"||hr==="active"||hr==="secure"||hr==="normal"?e.jsx(bs,{className:"h-4 w-4 text-green-600"}):e.jsx(Cr,{className:"h-4 w-4 text-gray-600"});return e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"font-medium",children:ot.name}),e.jsx(Oe,{className:qs(ot.status),children:ot.status.charAt(0).toUpperCase()+ot.status.slice(1).replace("_"," ")})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:ot.description}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[Sn(ot.status,ot.alertLevel),e.jsx("span",{children:ot.lastScan?`Last scan: ${new Date(ot.lastScan).toLocaleTimeString()}`:ot.lastUpdate?`Updated: ${new Date(ot.lastUpdate).toLocaleTimeString()}`:ot.usersMonitored?`${ot.usersMonitored} users monitored`:ot.checksCompleted?`${ot.checksCompleted} checks completed`:ot.alertsCount?`${ot.alertsCount} alerts`:"Status unknown"})]})]},ot.name)})})]}),(p==null?void 0:p.recentAlerts)&&p.recentAlerts.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Recent Security Alerts"}),e.jsx("div",{className:"space-y-3",children:p.recentAlerts.map(ot=>{const qs=hr=>{switch(hr){case"critical":return"border-red-200 bg-red-50";case"high":return"border-red-200 bg-red-50";case"medium":return"border-yellow-200 bg-yellow-50";case"low":return"border-blue-200 bg-blue-50";default:return"border-gray-200 bg-gray-50"}},Sn=hr=>{switch(hr){case"critical":return e.jsx(Is,{className:"h-4 w-4 text-red-600"});case"high":return e.jsx(Is,{className:"h-4 w-4 text-red-600"});case"medium":return e.jsx(Is,{className:"h-4 w-4 text-yellow-600"});case"low":return e.jsx(or,{className:"h-4 w-4 text-blue-600"});default:return e.jsx(Cr,{className:"h-4 w-4 text-gray-600"})}};return e.jsx("div",{className:`p-4 border rounded-lg ${qs(ot.severity)}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[Sn(ot.severity),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:ot.type}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:ot.message}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:new Date(ot.timestamp).toLocaleString()})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Oe,{className:ot.severity==="critical"||ot.severity==="high"?"bg-red-100 text-red-800":ot.severity==="medium"?"bg-yellow-100 text-yellow-800":ot.severity==="low"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800",children:ot.severity.charAt(0).toUpperCase()+ot.severity.slice(1)}),!ot.resolved&&e.jsx(I,{size:"sm",variant:"outline",className:"h-6 text-xs",children:"Resolve"})]})]})},ot.id)})})]}),e.jsxs(ua,{children:[e.jsx(or,{className:"h-4 w-4"}),e.jsx(ha,{children:!(p!=null&&p.alertSummary)||p.alertSummary.total===0?"Security monitoring is active across all systems. No alerts detected in the last 24 hours.":(p.alertSummary.critical||0)>0?`Critical security alerts detected! ${p.alertSummary.critical} critical alerts require immediate attention.`:(p.alertSummary.warning||0)>0?`Security monitoring is active. ${p.alertSummary.warning} warning alerts require review.`:"Security monitoring is active across all systems. All systems operating normally."})]})]})]})})]}),e.jsx(ts,{open:_,onOpenChange:k,children:e.jsxs(ss,{className:"sm:max-w-md",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Scan QR Code"}),e.jsx(Ks,{children:"Scan this QR code with your authenticator app to set up two-factor authentication."})]}),e.jsx("div",{className:"flex flex-col items-center space-y-4 py-4",children:v!=null&&v.qrCodeUrl?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-center p-4 bg-white border rounded-lg",children:e.jsx("img",{src:v.qrCodeUrl,alt:"QR Code for MFA Setup",className:"border rounded",style:{width:"256px",height:"256px"}})}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Use your authenticator app to scan this QR code"}),e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>mt(v.secret),children:[e.jsx(ac,{className:"mr-2 h-4 w-4"}),"Copy Secret"]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>k(!1),children:"Close"})]})]})]}):e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"flex h-32 w-32 items-center justify-center rounded-lg bg-gray-100 mx-auto",children:e.jsx(dl,{className:"h-16 w-16 text-gray-400"})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"QR code not available"}),e.jsx(I,{onClick:()=>k(!1),children:"Close"})]})})]})})]}),e.jsx(ts,{open:pe,onOpenChange:Ae,children:e.jsxs(ss,{className:"sm:max-w-md",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Disable Two-Factor Authentication"}),e.jsx(Ks,{children:"For security reasons, please verify your identity before disabling MFA."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Verification Method"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs(I,{variant:O==="totp"?"default":"outline",size:"sm",onClick:()=>te("totp"),children:[e.jsx(Sd,{className:"mr-2 h-4 w-4"}),"Authenticator Code"]}),e.jsxs(I,{variant:O==="password"?"default":"outline",size:"sm",onClick:()=>te("password"),children:[e.jsx(kn,{className:"mr-2 h-4 w-4"}),"Password"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:O==="totp"?"Authenticator Code":"Password"}),O==="totp"?e.jsx("input",{type:"text",placeholder:"Enter 6-digit code from your authenticator app",value:Ee.totpCode,onChange:ot=>$e(qs=>({...qs,totpCode:ot.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",maxLength:6}):e.jsx("input",{type:"password",placeholder:"Enter your account password",value:Ee.password,onChange:ot=>$e(qs=>({...qs,password:ot.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(I,{variant:"outline",onClick:()=>Ae(!1),children:"Cancel"}),e.jsx(I,{variant:"destructive",onClick:Le,disabled:!Ee.totpCode&&!Ee.password,children:"Disable MFA"})]})]})]})}),e.jsx(ts,{open:re,onOpenChange:le,children:e.jsxs(ss,{className:"max-w-2xl",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Security Measure Details"}),e.jsxs(Ks,{children:["Detailed information about ",Z==null?void 0:Z.name]})]}),Z&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-muted",children:Z.status==="active"?e.jsx(bs,{className:"h-5 w-5 text-green-600"}):Z.status==="partial"?e.jsx(Is,{className:"h-5 w-5 text-yellow-600"}):e.jsx(Is,{className:"h-5 w-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:Z.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:Z.description})]})]}),e.jsx(Oe,{className:Z.status==="active"?"bg-green-100 text-green-800":Z.status==="partial"?"bg-yellow-100 text-yellow-800":Z.status==="inactive"||Z.status==="alert"?"bg-red-100 text-red-800":Z.status==="monitoring"?"bg-blue-100 text-blue-800":Z.status==="needs_attention"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800",children:Z.status.charAt(0).toUpperCase()+Z.status.slice(1).replace("_"," ")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Current Status"}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),e.jsx("p",{className:"text-lg font-semibold",children:Z.status.charAt(0).toUpperCase()+Z.status.slice(1).replace("_"," ")})]}),e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Last Check"}),e.jsx("p",{className:"text-lg font-semibold",children:Z.lastCheck?new Date(Z.lastCheck).toLocaleDateString():"N/A"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Recommendations"}),e.jsxs("div",{className:"space-y-3",children:[Z.status==="active"&&e.jsxs(ua,{children:[e.jsx(bs,{className:"h-4 w-4"}),e.jsx(ha,{children:"This security measure is operating optimally. Continue monitoring for any changes."})]}),Z.status==="partial"&&e.jsxs(ua,{children:[e.jsx(Is,{className:"h-4 w-4"}),e.jsx(ha,{children:"This security measure is partially implemented. Consider completing the setup for full protection."})]}),Z.status==="inactive"&&e.jsxs(ua,{children:[e.jsx(Is,{className:"h-4 w-4"}),e.jsx(ha,{children:"This security measure is not active. Immediate action is required to secure your system."})]}),Z.status==="alert"&&e.jsxs(ua,{children:[e.jsx(Is,{className:"h-4 w-4"}),e.jsx(ha,{children:"Security alerts detected. Review the issues and take corrective action immediately."})]}),Z.status==="monitoring"&&e.jsxs(ua,{children:[e.jsx(or,{className:"h-4 w-4"}),e.jsx(ha,{children:"This security measure is under active monitoring. Watch for any anomalies."})]}),Z.status==="needs_attention"&&e.jsxs(ua,{children:[e.jsx(Is,{className:"h-4 w-4"}),e.jsx(ha,{children:"This security measure needs attention. Review and address the identified issues."})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(I,{variant:"outline",onClick:()=>le(!1),children:"Close"}),Z.status!=="active"&&e.jsx(I,{onClick:()=>{s({title:"Action Required",description:`Please review and address the issues with ${Z.name}.`}),le(!1)},children:"Take Action"})]})]})]})})]})}function SMe(){var G,L,J,z,U,oe,Q,P,q;const{user:s}=Ua(),{toast:t}=za(),r=hi(),{data:n,isLoading:a,error:i}=ys({queryKey:["companies"],queryFn:async()=>{const D=await de.getCompanies({page:1,pageSize:50}),he=((D==null?void 0:D.companies)||(D==null?void 0:D.data)||D||[]).map(be=>{var pe,Ae,Ee,$e,O,te,re,le,Z,K,X;if(console.log(" Processing company:",be.name,"logoUrl:",be.logoUrl),be.companySettings&&Array.isArray(be.companySettings)){const ce=be.companySettings,Y={...be,status:((pe=ce.find(ue=>ue.key==="status"))==null?void 0:pe.value)||"active",description:((Ae=ce.find(ue=>ue.key==="description"))==null?void 0:Ae.value)||"",employees:parseInt(((Ee=ce.find(ue=>ue.key==="employees"))==null?void 0:Ee.value)||"0"),foundedYear:parseInt((($e=ce.find(ue=>ue.key==="foundedYear"))==null?void 0:$e.value)||new Date().getFullYear().toString()),businessType:((O=ce.find(ue=>ue.key==="businessType"))==null?void 0:O.value)||"",registrationNumber:((te=ce.find(ue=>ue.key==="registrationNumber"))==null?void 0:te.value)||"",timezone:((re=ce.find(ue=>ue.key==="timezone"))==null?void 0:re.value)||"America/New_York",settings:{allowMultipleCurrencies:((le=ce.find(ue=>ue.key==="allowMultipleCurrencies"))==null?void 0:le.value)==="true",enableTaxCalculation:((Z=ce.find(ue=>ue.key==="enableTaxCalculation"))==null?void 0:Z.value)==="true",enableInventoryTracking:((K=ce.find(ue=>ue.key==="enableInventoryTracking"))==null?void 0:K.value)==="true",autoBackup:((X=ce.find(ue=>ue.key==="autoBackup"))==null?void 0:X.value)==="true"}};return console.log(" Processed company:",Y.name,"logoUrl:",Y.logoUrl),Y}return console.log("Company without settings:",be.name,"logoUrl:",be.logoUrl),be});return console.log(" Companies loaded:",he.length),console.log(" First company sample:",he[0]),console.log(" Companies with logos:",he.filter(be=>be.logoUrl).map(be=>({name:be.name,logoUrl:be.logoUrl}))),he},enabled:!!s}),o=n||[],[l,c]=x.useState(null),[d,u]=x.useState(!1),[h,f]=x.useState(!1),[m,p]=x.useState(!1),[g,v]=x.useState(null),[y,j]=x.useState(null),[b,w]=x.useState(!1),[N,C]=x.useState({name:"",email:"",phone:"",website:"",address:{street:"",city:"",state:"",country:"",zipCode:""},businessType:"",industry:"",taxId:"",registrationNumber:"",fiscalYearStart:"January",currency:"USD",timezone:"America/New_York",description:"",employees:0,foundedYear:new Date().getFullYear(),status:"active",tenantId:s==null?void 0:s.tenantId,settings:{allowMultipleCurrencies:!1,enableTaxCalculation:!0,enableInventoryTracking:!1,autoBackup:!0}});Rs({mutationFn:async D=>{var he,be,pe,Ae,Ee;const se={...D};if(se.address&&typeof se.address=="object"){const $e=se.address;(he=$e.street)!=null&&he.trim()||delete $e.street,(be=$e.city)!=null&&be.trim()||delete $e.city,(pe=$e.state)!=null&&pe.trim()||delete $e.state,(Ae=$e.country)!=null&&Ae.trim()||delete $e.country,(Ee=$e.zipCode)!=null&&Ee.trim()||delete $e.zipCode,!$e.street&&!$e.city&&!$e.state&&!$e.country&&!$e.zipCode&&delete se.address}return Object.keys(se).forEach($e=>{(se[$e]===""||se[$e]===null)&&delete se[$e]}),await de.createCompany(se)},onSuccess:async(D,se)=>{if(g&&D.id)try{await de.uploadCompanyLogo(D.id,g),console.log("Logo uploaded for new company:",D.id)}catch(he){console.error("Error uploading logo for new company:",he)}await r.invalidateQueries({queryKey:["companies"]}),u(!1),A(),t({title:"Company Created",description:"Company has been created successfully."})},onError:D=>{console.error("Error creating company:",D),t({title:"Error",description:D.message||"Failed to create company",variant:"destructive"})}}),Rs({mutationFn:async({id:D,data:se})=>{var be,pe,Ae,Ee,$e;const he={...se};if(he.address&&typeof he.address=="object"){const O=he.address;(be=O.street)!=null&&be.trim()||delete O.street,(pe=O.city)!=null&&pe.trim()||delete O.city,(Ae=O.state)!=null&&Ae.trim()||delete O.state,(Ee=O.country)!=null&&Ee.trim()||delete O.country,($e=O.zipCode)!=null&&$e.trim()||delete O.zipCode,!O.street&&!O.city&&!O.state&&!O.country&&!O.zipCode&&delete he.address}return Object.keys(he).forEach(O=>{(he[O]===""||he[O]===null)&&delete he[O]}),await de.updateCompany(D,he)},onSuccess:async(D,se)=>{if(g)try{await de.uploadCompanyLogo(se.id,g),console.log("Logo uploaded for updated company:",se.id)}catch(he){console.error("Error uploading logo for updated company:",he)}await r.invalidateQueries({queryKey:["companies"]}),f(!1),c(null),A(),t({title:"Company Updated",description:"Company has been updated successfully."})},onError:D=>{console.error("Error updating company:",D),t({title:"Error",description:D.message||"Failed to update company",variant:"destructive"})}}),Rs({mutationFn:async D=>await de.deleteCompany(D),onSuccess:async()=>{await r.invalidateQueries({queryKey:["companies"]}),t({title:"Company Deleted",description:"Company has been deleted successfully."})},onError:D=>{console.error("Error deleting company:",D),t({title:"Error",description:D.message||"Failed to delete company",variant:"destructive"})}});const S=async()=>{try{const D={...N};if(D.address&&typeof D.address=="object"){const he=D.address;he.street||delete he.street,he.city||delete he.city,he.state||delete he.state,he.country||delete he.country,he.zipCode||delete he.zipCode,Object.keys(he).length===0&&delete D.address}Object.keys(D).forEach(he=>{const be=D[he];(be===""||be===null||be===void 0)&&delete D[he]});const se=await de.createCompany(D);if(console.log("Create company response:",se),g&&se.id)try{await de.uploadCompanyLogo(se.id,g),console.log("Logo uploaded for new company:",se.id)}catch(he){console.error("Error uploading logo for new company:",he)}u(!1),A(),t({title:"Company Created",description:"Company has been created successfully."})}catch(D){console.error("Error creating company:",D),t({title:"Error",description:D.message||"Failed to create company",variant:"destructive"})}finally{}},_=async()=>{if(l)try{const D={...N};if(D.address&&typeof D.address=="object"){const he=D.address;he.street||delete he.street,he.city||delete he.city,he.state||delete he.state,he.country||delete he.country,he.zipCode||delete he.zipCode,Object.keys(he).length===0&&delete D.address}Object.keys(D).forEach(he=>{const be=D[he];(be===""||be===null||be===void 0)&&delete D[he]});const se=await de.updateCompany(l.id,D);if(console.log("Update company response:",se),g)try{await de.uploadCompanyLogo(l.id,g),console.log("Logo uploaded for updated company:",l.id)}catch(he){console.error("Error uploading logo for updated company:",he)}f(!1),c(null),A(),t({title:"Company Updated",description:"Company has been updated successfully."})}catch(D){console.error("Error updating company:",D),t({title:"Error",description:D.message||"Failed to update company",variant:"destructive"})}finally{}},k=async D=>{try{await de.deleteCompany(D),t({title:"Company Deleted",description:"Company has been deleted successfully."})}catch(se){t({title:"Error",description:se.message||"Failed to delete company",variant:"destructive"})}},F=D=>{var he;const se=(he=D.target.files)==null?void 0:he[0];if(se){if(!["image/jpeg","image/png","image/gif","image/webp"].includes(se.type)){t({title:"Invalid File Type",description:"Please select a valid image file (JPEG, PNG, GIF, or WebP).",variant:"destructive"});return}const pe=5*1024*1024;if(se.size>pe){t({title:"File Too Large",description:"Please select an image smaller than 5MB.",variant:"destructive"});return}v(se);const Ae=URL.createObjectURL(se);j(Ae)}},A=()=>{C({name:"",email:"",phone:"",website:"",address:{street:"",city:"",state:"",country:"",zipCode:""},businessType:"",industry:"",taxId:"",registrationNumber:"",fiscalYearStart:"January",currency:"USD",timezone:"America/New_York",description:"",employees:0,foundedYear:new Date().getFullYear(),status:"active",settings:{allowMultipleCurrencies:!1,enableTaxCalculation:!0,enableInventoryTracking:!0,autoBackup:!0}}),v(null),j(null)},T=D=>{var te,re,le,Z,K,X,ce,Y,ue,ve,Le,Me,tt,fe,ct,dt,pt,qe,mt;c(D);let se={allowMultipleCurrencies:!1,enableTaxCalculation:!0,enableInventoryTracking:!1,autoBackup:!0};if(D.companySettings&&Array.isArray(D.companySettings)){const Rt=D.companySettings;se={allowMultipleCurrencies:((te=Rt.find(_e=>_e.key==="allowMultipleCurrencies"))==null?void 0:te.value)==="true",enableTaxCalculation:((re=Rt.find(_e=>_e.key==="enableTaxCalculation"))==null?void 0:re.value)==="true",enableInventoryTracking:((le=Rt.find(_e=>_e.key==="enableInventoryTracking"))==null?void 0:le.value)==="true",autoBackup:((Z=Rt.find(_e=>_e.key==="autoBackup"))==null?void 0:Z.value)==="true"}}const he=((X=(K=D.companySettings)==null?void 0:K.find(Rt=>Rt.key==="description"))==null?void 0:X.value)||"",be=parseInt(((Y=(ce=D.companySettings)==null?void 0:ce.find(Rt=>Rt.key==="employees"))==null?void 0:Y.value)||"0"),pe=parseInt(((ve=(ue=D.companySettings)==null?void 0:ue.find(Rt=>Rt.key==="foundedYear"))==null?void 0:ve.value)||new Date().getFullYear().toString()),Ae=((Me=(Le=D.companySettings)==null?void 0:Le.find(Rt=>Rt.key==="status"))==null?void 0:Me.value)||"active",Ee=((fe=(tt=D.companySettings)==null?void 0:tt.find(Rt=>Rt.key==="businessType"))==null?void 0:fe.value)||"",$e=((dt=(ct=D.companySettings)==null?void 0:ct.find(Rt=>Rt.key==="registrationNumber"))==null?void 0:dt.value)||"",O=((qe=(pt=D.companySettings)==null?void 0:pt.find(Rt=>Rt.key==="timezone"))==null?void 0:qe.value)||"America/New_York";C({name:D.name||"",email:D.email||"",phone:D.phone||"",website:D.website||"",address:{street:typeof D.address=="string"?D.address:((mt=D.address)==null?void 0:mt.street)||"",city:D.city||"",state:D.state||"",country:D.country||"",zipCode:D.postalCode||""},businessType:Ee,industry:D.industry||"",taxId:D.taxId||"",registrationNumber:$e,fiscalYearStart:D.fiscalYearStart||"January",currency:D.currency||"USD",timezone:O,description:he,employees:be,foundedYear:pe,status:Ae,settings:se}),f(!0)},V=D=>{c(D),p(!0)},M=()=>{var D,se,he,be,pe,Ae,Ee,$e,O;return e.jsx("div",{className:"space-y-6",children:e.jsxs(an,{defaultValue:"basic",className:"w-full",children:[e.jsxs(on,{className:"grid w-full grid-cols-4",children:[e.jsx(vt,{value:"basic",children:"Basic Info"}),e.jsx(vt,{value:"contact",children:"Contact"}),e.jsx(vt,{value:"business",children:"Business"}),e.jsx(vt,{value:"settings",children:"Settings"})]}),e.jsxs(yt,{value:"basic",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"name",children:"Company Name *"}),e.jsx(ge,{id:"name",value:N.name,onChange:te=>C({...N,name:te.target.value}),placeholder:"Enter company name",required:!0})]}),e.jsxs("div",{className:"col-span-2 space-y-4",children:[e.jsx(B,{children:"Company Logo"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-lg flex items-center justify-center overflow-hidden",children:y?e.jsx("img",{src:y,alt:"Logo preview",className:"w-full h-full object-cover",onError:te=>{console.error("Failed to load logo preview:",y),console.error("Preview error:",te)}}):l!=null&&l.logoUrl?e.jsx("img",{src:l.logoUrl,alt:"Current logo",className:"w-full h-full object-cover",onError:te=>{console.error("Failed to load current logo:",l.logoUrl),console.error("Current logo error:",te)},onLoad:()=>{console.log("Current logo loaded successfully:",l.logoUrl)}}):e.jsx(vn,{className:"w-8 h-8 text-gray-400"})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"file",id:"logo-upload",accept:"image/jpeg,image/png,image/gif,image/webp",onChange:F,className:"hidden"}),e.jsx(I,{type:"button",variant:"outline",size:"sm",onClick:()=>{var te;return(te=document.getElementById("logo-upload"))==null?void 0:te.click()},disabled:b,children:b?e.jsxs(e.Fragment,{children:[e.jsx(kr,{size:"sm",className:"mr-2",color:"teal"}),"Uploading..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Zj,{className:"w-4 h-4 mr-2"}),g?"Change Logo":"Upload Logo"]})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Select a company logo (JPEG, PNG, GIF, or WebP, max 5MB). Logo will be saved when you submit the form."})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"industry",children:"Industry"}),e.jsxs(rt,{value:N.industry,onValueChange:te=>C({...N,industry:te}),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select industry"})}),e.jsxs(at,{children:[e.jsx(W,{value:"technology",children:"Technology"}),e.jsx(W,{value:"finance",children:"Finance"}),e.jsx(W,{value:"healthcare",children:"Healthcare"}),e.jsx(W,{value:"retail",children:"Retail"}),e.jsx(W,{value:"manufacturing",children:"Manufacturing"}),e.jsx(W,{value:"consulting",children:"Consulting"}),e.jsx(W,{value:"other",children:"Other"})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"description",children:"Description"}),e.jsx(Xs,{id:"description",value:N.description,onChange:te=>C({...N,description:te.target.value}),placeholder:"Brief description of the company",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"employees",children:"Employees"}),e.jsx(ge,{id:"employees",type:"number",value:N.employees,onChange:te=>C({...N,employees:parseInt(te.target.value)||0}),placeholder:"Number of employees"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"foundedYear",children:"Founded Year"}),e.jsx(ge,{id:"foundedYear",type:"number",value:N.foundedYear,onChange:te=>C({...N,foundedYear:parseInt(te.target.value)||new Date().getFullYear()}),placeholder:"Year founded"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"status",children:"Status"}),e.jsxs(rt,{value:N.status,onValueChange:te=>C({...N,status:te}),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"active",children:"Active"}),e.jsx(W,{value:"inactive",children:"Inactive"}),e.jsx(W,{value:"suspended",children:"Suspended"})]})]})]})]})]}),e.jsxs(yt,{value:"contact",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"email",children:"Email"}),e.jsx(ge,{id:"email",type:"email",value:N.email,onChange:te=>C({...N,email:te.target.value}),placeholder:"company@example.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"phone",children:"Phone"}),e.jsx(ge,{id:"phone",value:N.phone,onChange:te=>C({...N,phone:te.target.value}),placeholder:"+1 (555) 123-4567"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"website",children:"Website"}),e.jsx(ge,{id:"website",value:N.website,onChange:te=>C({...N,website:te.target.value}),placeholder:"https://www.company.com"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(B,{children:"Address"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ge,{value:typeof N.address=="object"&&((D=N.address)==null?void 0:D.street)||"",onChange:te=>C({...N,address:{...typeof N.address=="object"?N.address:{},street:te.target.value}}),placeholder:"Street address"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(ge,{value:typeof N.address=="object"&&((se=N.address)==null?void 0:se.city)||"",onChange:te=>C({...N,address:{...typeof N.address=="object"?N.address:{},city:te.target.value}}),placeholder:"City"}),e.jsx(ge,{value:typeof N.address=="object"&&((he=N.address)==null?void 0:he.state)||"",onChange:te=>C({...N,address:{...typeof N.address=="object"?N.address:{},state:te.target.value}}),placeholder:"State/Province"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(ge,{value:typeof N.address=="object"&&((be=N.address)==null?void 0:be.country)||"",onChange:te=>C({...N,address:{...typeof N.address=="object"?N.address:{},country:te.target.value}}),placeholder:"Country"}),e.jsx(ge,{value:typeof N.address=="object"&&((pe=N.address)==null?void 0:pe.zipCode)||"",onChange:te=>C({...N,address:{...typeof N.address=="object"?N.address:{},zipCode:te.target.value}}),placeholder:"ZIP/Postal Code"})]})]})]})]}),e.jsxs(yt,{value:"business",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"businessType",children:"Business Type"}),e.jsxs(rt,{value:N.businessType,onValueChange:te=>C({...N,businessType:te}),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select business type"})}),e.jsxs(at,{children:[e.jsx(W,{value:"corporation",children:"Corporation"}),e.jsx(W,{value:"llc",children:"LLC"}),e.jsx(W,{value:"partnership",children:"Partnership"}),e.jsx(W,{value:"sole-proprietorship",children:"Sole Proprietorship"}),e.jsx(W,{value:"nonprofit",children:"Non-Profit"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"currency",children:"Currency"}),e.jsxs(rt,{value:N.currency,onValueChange:te=>C({...N,currency:te}),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"USD",children:"USD - US Dollar"}),e.jsx(W,{value:"EUR",children:"EUR - Euro"}),e.jsx(W,{value:"GBP",children:"GBP - British Pound"}),e.jsx(W,{value:"JPY",children:"JPY - Japanese Yen"}),e.jsx(W,{value:"CAD",children:"CAD - Canadian Dollar"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"taxId",children:"Tax ID"}),e.jsx(ge,{id:"taxId",value:N.taxId,onChange:te=>C({...N,taxId:te.target.value}),placeholder:"Enter tax identification number"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"registrationNumber",children:"Registration Number"}),e.jsx(ge,{id:"registrationNumber",value:N.registrationNumber,onChange:te=>C({...N,registrationNumber:te.target.value}),placeholder:"Enter registration number"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"fiscalYearStart",children:"Fiscal Year Start"}),e.jsxs(rt,{value:N.fiscalYearStart,onValueChange:te=>C({...N,fiscalYearStart:te}),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"January",children:"January"}),e.jsx(W,{value:"February",children:"February"}),e.jsx(W,{value:"March",children:"March"}),e.jsx(W,{value:"April",children:"April"}),e.jsx(W,{value:"May",children:"May"}),e.jsx(W,{value:"June",children:"June"}),e.jsx(W,{value:"July",children:"July"}),e.jsx(W,{value:"August",children:"August"}),e.jsx(W,{value:"September",children:"September"}),e.jsx(W,{value:"October",children:"October"}),e.jsx(W,{value:"November",children:"November"}),e.jsx(W,{value:"December",children:"December"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"timezone",children:"Timezone"}),e.jsxs(rt,{value:N.timezone,onValueChange:te=>C({...N,timezone:te}),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"America/New_York",children:"Eastern Time"}),e.jsx(W,{value:"America/Chicago",children:"Central Time"}),e.jsx(W,{value:"America/Denver",children:"Mountain Time"}),e.jsx(W,{value:"America/Los_Angeles",children:"Pacific Time"}),e.jsx(W,{value:"Europe/London",children:"GMT"}),e.jsx(W,{value:"Europe/Paris",children:"CET"}),e.jsx(W,{value:"Asia/Tokyo",children:"JST"})]})]})]})]})]}),e.jsx(yt,{value:"settings",className:"space-y-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(B,{children:"Multiple Currencies"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Allow transactions in multiple currencies"})]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{var te;return C({...N,settings:{...N.settings,allowMultipleCurrencies:!((te=N.settings)!=null&&te.allowMultipleCurrencies)}})},children:(Ae=N.settings)!=null&&Ae.allowMultipleCurrencies?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(B,{children:"Tax Calculation"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically calculate taxes on transactions"})]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{var te;return C({...N,settings:{...N.settings,enableTaxCalculation:!((te=N.settings)!=null&&te.enableTaxCalculation)}})},children:(Ee=N.settings)!=null&&Ee.enableTaxCalculation?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(B,{children:"Inventory Tracking"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Track inventory levels and movements"})]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{var te;return C({...N,settings:{...N.settings,enableInventoryTracking:!((te=N.settings)!=null&&te.enableInventoryTracking)}})},children:($e=N.settings)!=null&&$e.enableInventoryTracking?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(B,{children:"Auto Backup"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically backup company data"})]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{var te;return C({...N,settings:{...N.settings,autoBackup:!((te=N.settings)!=null&&te.autoBackup)}})},children:(O=N.settings)!=null&&O.autoBackup?"Enabled":"Disabled"})]})]})})]})})};return a?e.jsx(Kr,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(kr,{size:"lg",color:"teal"}),e.jsx("p",{className:"mt-2 text-muted-foreground",children:"Loading companies..."})]})})}):i?e.jsx(Kr,{children:e.jsxs(ua,{variant:"destructive",children:[e.jsx(Is,{className:"h-4 w-4"}),e.jsxs(ha,{children:[typeof i=="object"&&i!==null&&"message"in i?i.message:typeof i=="string"?i:"Unknown error",e.jsx(I,{onClick:()=>r.invalidateQueries({queryKey:["companies"]}),className:"ml-2",size:"sm",children:"Try Again"})]})]})}):e.jsx(Kr,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-cyan-50 via-blue-50 to-indigo-50 p-8 border-b border-cyan-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx(vn,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Company Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your companies and organizational settings"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(Oe,{variant:"secondary",className:"px-3 py-1",children:[e.jsx(bs,{className:"w-3 h-3 mr-1"}),o.length," ",o.length===1?"Company":"Companies"]}),e.jsxs(ts,{open:d,onOpenChange:u,children:[e.jsx(ki,{asChild:!0,children:e.jsxs(I,{className:"bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-700 hover:to-blue-700 text-white shadow-lg",children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Add Company"]})}),e.jsxs(ss,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(as,{children:[e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(Ss,{className:"h-5 w-5"}),"Create New Company"]}),e.jsx(Ks,{children:"Add a new company to your organization. Fill in the required information below."})]}),M(),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(I,{variant:"outline",onClick:()=>{u(!1),A()},children:"Cancel"}),e.jsxs(I,{onClick:S,disabled:!N.name,children:[e.jsx(Od,{className:"h-4 w-4 mr-2"}),"Create Company"]})]})]})]})]})]})}),o.length===0?e.jsx(ne,{className:"text-center py-16",children:e.jsxs(ie,{children:[e.jsx(vn,{className:"h-16 w-16 text-muted-foreground mx-auto mb-6"}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No companies found"}),e.jsx("p",{className:"text-muted-foreground mb-6 max-w-md mx-auto",children:"Get started by creating your first company. You can manage all your organizational settings and preferences from here."}),e.jsxs(I,{className:"bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-700 hover:to-blue-700 text-white",onClick:()=>u(!0),children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Create Your First Company"]})]})}):e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:o.map(D=>(console.log(" Rendering company:",D.name,"logoUrl:",D.logoUrl),e.jsxs(ne,{className:"hover:shadow-lg transition-all duration-200 border-0 shadow-md",children:[e.jsx(we,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg",children:D.logoUrl?e.jsx("img",{src:D.logoUrl,alt:D.name,className:"w-12 h-12 rounded-xl object-cover",onError:se=>{var he;console.error(" Failed to load company logo:",D.name,D.logoUrl),console.error(" Image error details:",se),console.error(" Image src:",(he=se.target)==null?void 0:he.src)},onLoad:()=>{console.log(" Company logo loaded successfully:",D.name,D.logoUrl)}}):e.jsx(vn,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx(Se,{className:"text-lg truncate",children:D.name}),e.jsxs(Vt,{className:"flex items-center gap-1",children:[e.jsx(Xn,{className:"w-3 h-3"}),"Created ",D.createdAt?new Date(D.createdAt).toLocaleDateString():"N/A"]})]})]}),e.jsx(Oe,{variant:D.status==="active"?"default":D.status==="inactive"?"secondary":"destructive",className:"capitalize",children:D.status})]})}),e.jsxs(ie,{className:"space-y-3",children:[D.industry&&e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(nY,{className:"w-4 h-4 mr-2"}),D.industry]}),D.email&&e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(Dd,{className:"w-4 h-4 mr-2"}),D.email]}),D.address&&e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx(Pa,{className:"w-4 h-4 mr-2"}),D.city||"",", ",D.country||""]}),e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>V(D),children:[e.jsx(ir,{className:"w-3 h-3 mr-1"}),"View"]}),e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>T(D),children:[e.jsx(ln,{className:"w-3 h-3 mr-1"}),"Edit"]})]}),e.jsx(I,{size:"sm",variant:"ghost",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>k(D.id),children:e.jsx(hn,{className:"w-3 h-3"})})]})]})]},D.id)))}),e.jsx(ts,{open:h,onOpenChange:f,children:e.jsxs(ss,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(as,{children:[e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(ln,{className:"h-5 w-5"}),"Edit Company"]}),e.jsx(Ks,{children:"Update company information and settings."})]}),M(),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(I,{variant:"outline",onClick:()=>{f(!1),c(null),A()},children:"Cancel"}),e.jsxs(I,{onClick:_,children:[e.jsx(Od,{className:"h-4 w-4 mr-2"}),"Save Changes"]})]})]})}),e.jsx(ts,{open:m,onOpenChange:p,children:e.jsxs(ss,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(as,{children:[e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(ir,{className:"h-5 w-5"}),"Company Details"]}),e.jsxs(Ks,{children:["View detailed information about ",l==null?void 0:l.name]})]}),l&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gradient-to-r from-cyan-50 to-blue-50 rounded-lg",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-xl flex items-center justify-center shadow-lg",children:l.logoUrl?e.jsx("img",{src:l.logoUrl,alt:l.name,className:"w-16 h-16 rounded-xl object-cover",onError:D=>{console.error("Failed to load logo in view modal:",l.logoUrl),console.error("View modal error:",D)},onLoad:()=>{console.log("View modal logo loaded successfully:",l.logoUrl)}}):e.jsx(vn,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold",children:l.name}),e.jsx("p",{className:"text-muted-foreground",children:l.industry}),e.jsx(Oe,{variant:l.status==="active"?"default":"secondary",className:"mt-1",children:l.status})]})]}),e.jsxs(an,{defaultValue:"overview",className:"w-full",children:[e.jsxs(on,{className:"grid w-full grid-cols-4",children:[e.jsx(vt,{value:"overview",children:"Overview"}),e.jsx(vt,{value:"contact",children:"Contact"}),e.jsx(vt,{value:"business",children:"Business"}),e.jsx(vt,{value:"settings",children:"Settings"})]}),e.jsxs(yt,{value:"overview",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Description"}),e.jsx("p",{children:l.description||"No description provided"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Employees"}),e.jsx("p",{children:l.employees||"Not specified"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Founded Year"}),e.jsx("p",{children:l.foundedYear||"Not specified"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Created"}),e.jsx("p",{children:l.createdAt?new Date(l.createdAt).toLocaleDateString():"N/A"})]})]})]}),e.jsxs(yt,{value:"contact",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Email"}),e.jsx("p",{children:l.email||"Not provided"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Phone"}),e.jsx("p",{children:l.phone||"Not provided"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Website"}),e.jsx("p",{children:l.website||"Not provided"})]}),l.address&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Address"}),e.jsxs("p",{children:[typeof l.address=="string"?l.address:(G=l.address)==null?void 0:G.street,e.jsx("br",{}),l.city,", ",l.state," ",l.postalCode,e.jsx("br",{}),l.country]})]})]}),e.jsxs(yt,{value:"business",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Business Type"}),e.jsx("p",{children:l.businessType||"Not specified"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Currency"}),e.jsx("p",{children:l.currency||"USD"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Tax ID"}),e.jsx("p",{children:l.taxId||"Not provided"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Registration Number"}),e.jsx("p",{children:l.registrationNumber||"Not provided"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Fiscal Year Start"}),e.jsx("p",{children:l.fiscalYearStart||"January"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Timezone"}),e.jsx("p",{children:l.timezone||"Not specified"})]})]})]}),e.jsx(yt,{value:"settings",className:"space-y-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx(B,{className:"font-medium",children:"Multiple Currencies"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Allow transactions in multiple currencies"})]}),e.jsx(Oe,{variant:(L=l.settings)!=null&&L.allowMultipleCurrencies?"default":"secondary",children:(J=l.settings)!=null&&J.allowMultipleCurrencies?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx(B,{className:"font-medium",children:"Tax Calculation"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically calculate taxes"})]}),e.jsx(Oe,{variant:(z=l.settings)!=null&&z.enableTaxCalculation?"default":"secondary",children:(U=l.settings)!=null&&U.enableTaxCalculation?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx(B,{className:"font-medium",children:"Inventory Tracking"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Track inventory levels"})]}),e.jsx(Oe,{variant:(oe=l.settings)!=null&&oe.enableInventoryTracking?"default":"secondary",children:(Q=l.settings)!=null&&Q.enableInventoryTracking?"Enabled":"Disabled"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx(B,{className:"font-medium",children:"Auto Backup"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically backup data"})]}),e.jsx(Oe,{variant:(P=l.settings)!=null&&P.autoBackup?"default":"secondary",children:(q=l.settings)!=null&&q.autoBackup?"Enabled":"Disabled"})]})]})})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs(I,{variant:"outline",onClick:()=>{p(!1),c(null)},children:[e.jsx(ma,{className:"h-4 w-4 mr-2"}),"Close"]})})]})})]})})}const Lx={"getting-started":{color:"blue",icon:ml,title:"Getting Started",description:"Essential guides for new users"},accounting:{color:"green",icon:Zt,title:"Accounting",description:"Financial management guides"},invoicing:{color:"purple",icon:Sa,title:"Invoicing",description:"Billing and invoice management"},troubleshooting:{color:"yellow",icon:_5,title:"Troubleshooting",description:"Common issues and solutions"},security:{color:"red",icon:Is,title:"Security",description:"Security and compliance"},expenses:{color:"orange",icon:Zt,title:"Expenses",description:"Expense management"},"ai-features":{color:"indigo",icon:go,title:"AI Features",description:"AI-powered insights"}},Dj={blue:"bg-blue-100 text-blue-600",green:"bg-green-100 text-green-600",purple:"bg-purple-100 text-purple-600",yellow:"bg-yellow-100 text-yellow-600",red:"bg-red-100 text-red-600",orange:"bg-orange-100 text-orange-600",indigo:"bg-indigo-100 text-indigo-600"};function pR(){var $r,Vr,wn,Vn;const{toast:s}=za(),[t,r]=x.useState(""),[n]=x.useState("all"),[a,i]=x.useState([]),[o,l]=x.useState([]),[c,d]=x.useState([]),[u,h]=x.useState({totalMembers:0,postsThisMonth:0,knowledgeBaseArticles:0}),[f,m]=x.useState([]),[p,g]=x.useState(!1),[v,y]=x.useState(null),[j,b]=x.useState({title:"",description:"",category:"general",difficulty:"beginner",duration:0,thumbnailUrl:"",tags:[],isPublished:!1}),[w,N]=x.useState(""),[C,S]=x.useState(null),[_,k]=x.useState("knowledge"),[F,A]=x.useState(!1),[T,V]=x.useState(!1),[M,G]=x.useState(!1),[L,J]=x.useState({title:"",description:"",category:"general",priority:"medium"}),[z,U]=x.useState(!1),[oe,Q]=x.useState(null),[P,q]=x.useState({title:"",content:"",category:"",tags:[],isPublished:!1}),[D,se]=x.useState(""),[he,be]=x.useState(!1),[pe,Ae]=x.useState(null),[Ee,$e]=x.useState(!1),[O,te]=x.useState(null),[re,le]=x.useState(!1),[Z,K]=x.useState(null),[X,ce]=x.useState(!1),[Y,ue]=x.useState(!1),[ve,Le]=x.useState(null),[Me,tt]=x.useState([]),[fe,ct]=x.useState(""),[dt,pt]=x.useState([]),[qe,mt]=x.useState({category:"",subject:"",priority:"medium"}),[Rt,_e]=x.useState(!1),[Xe,At]=x.useState({title:"",content:"",category:"general",tags:[]}),[st,$t]=x.useState("");x.useEffect(()=>{zt(),St(),js(),Ws(),xs()},[]);const fs=async()=>{var De;try{const ut=await de.get("/help/knowledge/articles");console.log("All articles API response:",ut);const Pe=((De=ut.data)==null?void 0:De.articles)||ut.articles||[];console.log("Extracted all articles:",Pe),i(Pe)}catch(ut){console.error("Error loading all articles:",ut)}},zt=async()=>{var De;try{V(!0);const ut=await de.get(`/help/knowledge/search?q=${encodeURIComponent(t)}&category=${n}`);console.log("Knowledge articles API response:",ut);const Pe=((De=ut.data)==null?void 0:De.articles)||ut.articles||[];console.log("Extracted articles:",Pe),i(Pe)}catch(ut){console.error("Error loading knowledge articles:",ut),s({title:"Error",description:"Failed to load knowledge articles",variant:"destructive"})}finally{V(!1)}},St=async()=>{try{const De=await de.get("/help/tickets");l(De.tickets||[])}catch(De){console.error("Error loading support tickets:",De),s({title:"Error",description:"Failed to load support tickets",variant:"destructive"})}},js=async()=>{try{const De=await de.get("/help/community/discussions");d(De.discussions||[]),De.stats&&h(De.stats)}catch(De){console.error("Error loading community discussions:",De),s({title:"Error",description:"Failed to load community discussions",variant:"destructive"})}},et=()=>{zt()},lt=async()=>{if(!L.title||!L.description){s({title:"Error",description:"Please fill in all required fields",variant:"destructive"});return}try{await de.post("/help/tickets",L),s({title:"Success",description:"Support ticket created successfully"}),G(!1),J({title:"",description:"",category:"general",priority:"medium"}),St()}catch(De){console.error("Error creating ticket:",De),s({title:"Error",description:"Failed to create support ticket",variant:"destructive"})}},Fe=async()=>{if(!P.title||!P.content||!P.category){s({title:"Error",description:"Please fill in all required fields",variant:"destructive"});return}try{await de.post("/help/knowledge/articles",P),s({title:"Success",description:"Knowledge article created successfully"}),U(!1),q({title:"",content:"",category:"",tags:[],isPublished:!1}),fs()}catch(De){console.error("Error creating article:",De),s({title:"Error",description:"Failed to create knowledge article",variant:"destructive"})}},ft=async()=>{if(!oe||!P.title||!P.content||!P.category){s({title:"Error",description:"Please fill in all required fields",variant:"destructive"});return}try{await de.put(`/help/knowledge/articles/${oe.id}`,P),s({title:"Success",description:"Knowledge article updated successfully"}),Q(null),q({title:"",content:"",category:"",tags:[],isPublished:!1}),fs()}catch(De){console.error("Error updating article:",De),s({title:"Error",description:"Failed to update knowledge article",variant:"destructive"})}},He=async De=>{try{await de.delete(`/help/knowledge/articles/${De}`),s({title:"Success",description:"Knowledge article deleted successfully"}),fs()}catch(ut){console.error("Error deleting article:",ut),s({title:"Error",description:"Failed to delete knowledge article",variant:"destructive"})}},Je=De=>{Q(De),q({title:De.title,content:De.content,category:De.category,tags:De.tags,isPublished:De.helpful}),U(!0)},It=()=>{D.trim()&&!P.tags.includes(D.trim())&&(q(De=>({...De,tags:[...De.tags,D.trim()]})),se(""))},Gt=De=>{q(ut=>({...ut,tags:ut.tags.filter(Pe=>Pe!==De)}))},qt=()=>{q({title:"",content:"",category:"",tags:[],isPublished:!1}),Q(null),$t("")},As=De=>{De.videoUrl?(Ae({url:De.videoUrl,title:De.title}),be(!0)):s({title:"No Video Available",description:"This tutorial doesn't have a video URL configured.",variant:"destructive"})},Ht=De=>{window.open(De,"_blank")},xs=async()=>{try{const De=await fetch(un("api/tutorial-videos"),{method:"GET",headers:{"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":localStorage.getItem("company_id")||"cmg0qxjh9003nao3ftbaz1oc1",Authorization:`Bearer ${localStorage.getItem("auth_token")}`}});if(!De.ok)throw new Error("Failed to fetch tutorial videos");const Pe=((await De.json()).data||[]).map(_t=>({..._t,tags:_t.tags?typeof _t.tags=="string"?JSON.parse(_t.tags):_t.tags:[]}));m(Pe)}catch(De){console.error("Error loading tutorial videos:",De),s({title:"Error",description:"Failed to load tutorial videos",variant:"destructive"})}},Ct=async De=>{try{const ut=new FormData;ut.append("video",De),console.log("Testing upload with FormData:",{hasFile:!!De,fileName:De.name,fileSize:De.size,fileType:De.type,formDataKeys:Array.from(ut.keys())});const _t=await(await fetch(un("test-upload"),{method:"POST",body:ut})).json();console.log("Test upload response:",_t),s({title:"Test Upload",description:`File received: ${_t.hasFile?"Yes":"No"}`,variant:_t.hasFile?"default":"destructive"})}catch(ut){console.error("Test upload error:",ut),s({title:"Test Upload Error",description:"Failed to test upload",variant:"destructive"})}},ke=async De=>{if(!j.title||!j.category||!j.difficulty){s({title:"Error",description:"Please fill in all required fields",variant:"destructive"});return}A(!0);try{const ut=new FormData;ut.append("video",De),ut.append("title",j.title),ut.append("description",j.description),ut.append("category",j.category),ut.append("difficulty",j.difficulty),ut.append("duration",j.duration.toString()),ut.append("thumbnailUrl",j.thumbnailUrl),ut.append("tags",JSON.stringify(j.tags)),ut.append("isPublished",j.isPublished.toString()),console.log("FormData created:",{hasFile:!!De,fileName:De.name,fileSize:De.size,fileType:De.type,formDataKeys:Array.from(ut.keys())});const Pe=localStorage.getItem("tenant_id")||"tenant_demo",_t=localStorage.getItem("company_id")||"cmg0qxjh9003nao3ftbaz1oc1",bt=localStorage.getItem("auth_token");console.log("LocalStorage values:",{tenantId:Pe,companyId:_t,token:bt?"Present":"Missing"});const ps=await fetch(un("api/tutorial-videos/upload"),{method:"POST",body:ut,headers:{"x-tenant-id":Pe,"x-company-id":_t,Authorization:`Bearer ${bt}`}});if(!ps.ok){const Wr=await ps.json();throw new Error(Wr.message||"Upload failed")}const Pr=await ps.json();s({title:"Success",description:"Tutorial video uploaded successfully"}),g(!1),rs(),xs()}catch(ut){console.error("Error uploading tutorial video:",ut),s({title:"Error",description:"Failed to upload tutorial video",variant:"destructive"})}finally{A(!1)}},gt=async De=>{try{await de.delete(`/tutorial-videos/${De}`),s({title:"Success",description:"Tutorial video deleted successfully"}),xs()}catch(ut){console.error("Error deleting tutorial video:",ut),s({title:"Error",description:"Failed to delete tutorial video",variant:"destructive"})}},us=De=>{S(De)},We=De=>{const ut=localStorage.getItem("tenant_id")||"tenant_demo",Pe=localStorage.getItem("company_id")||"cmg0qxjh9003nao3ftbaz1oc1",_t=localStorage.getItem("auth_token")||"";return un(`api/tutorial-videos/stream/${De}?tenantId=${ut}&companyId=${Pe}&token=${_t}`)},Et=()=>{w.trim()&&!j.tags.includes(w.trim())&&(b(De=>({...De,tags:[...De.tags,w.trim()]})),N(""))},Pt=De=>{b(ut=>({...ut,tags:ut.tags.filter(Pe=>Pe!==De)}))},rs=()=>{b({title:"",description:"",category:"general",difficulty:"beginner",duration:0,thumbnailUrl:"",tags:[],isPublished:!1}),N(""),y(null)},ms=De=>{const ut=Math.floor(De/3600),Pe=Math.floor(De%3600/60),_t=De%60;return ut>0?`${ut}:${Pe.toString().padStart(2,"0")}:${_t.toString().padStart(2,"0")}`:`${Pe}:${_t.toString().padStart(2,"0")}`},Bs=async De=>{var ut;te(De),$e(!0);try{console.log("Tracking view for article:",De.id);const Pe=await de.post(`/help/knowledge/articles/${De.id}/view`);console.log("View tracking response:",Pe),i(_t=>_t.map(bt=>bt.id===De.id?{...bt,views:bt.views+1}:bt)),console.log("Updated article views in local state")}catch(Pe){console.error("Error tracking article view:",Pe),console.error("Error details:",((ut=Pe.response)==null?void 0:ut.data)||Pe.message)}},Vs=async De=>{if(De)try{await de.post(`/help/knowledge/articles/${De}/helpful`),i(ut=>ut.map(Pe=>Pe.id===De?{...Pe,helpful:!0}:Pe)),te(ut=>ut&&{...ut,helpful:!0}),s({title:"Thank you!",description:"Your feedback helps us improve our knowledge base."})}catch(ut){console.error("Error marking article as helpful:",ut),s({title:"Error",description:"Failed to save your feedback",variant:"destructive"})}},Ws=async()=>{try{const De=await de.get("/help/chat/sessions");pt(De.sessions||[])}catch(De){console.error("Error loading chat sessions:",De)}},Ns=async De=>{try{const ut=await de.get(`/help/chat/sessions/${De}/messages`);tt(ut.messages||[])}catch(ut){console.error("Error loading chat messages:",ut)}},er=async()=>{var De;if(!qe.category||!qe.subject){s({title:"Error",description:"Please fill in all required fields",variant:"destructive"});return}try{const ut=await de.post("/help/chat/sessions",qe);s({title:"Success",description:"Chat session created successfully"}),ue(!1),mt({category:"",subject:"",priority:"medium"}),await Ws(),Ir(((De=ut.data)==null?void 0:De.sessionId)||ut.sessionId)}catch(ut){console.error("Error creating chat session:",ut),s({title:"Error",description:"Failed to create chat session",variant:"destructive"})}},Ir=async De=>{try{let ut=dt.find(Pe=>Pe.id===De);ut||(await Ws(),ut=dt.find(Pe=>Pe.id===De)),ut?(Le(ut),await Ns(De),ce(!0)):(Le({id:De,subject:qe.subject,category:qe.category,priority:qe.priority,status:"open"}),tt([]),ce(!0))}catch(ut){console.error("Error opening chat session:",ut)}},jn=async()=>{if(!(!fe.trim()||!ve))try{await de.post(`/help/chat/sessions/${ve.id}/messages`,{message:fe.trim(),messageType:"text"}),ct(""),await Ns(ve.id)}catch(De){console.error("Error sending message:",De),s({title:"Error",description:"Failed to send message",variant:"destructive"})}},Hs=async De=>{try{await de.put(`/help/chat/sessions/${De}/close`),s({title:"Success",description:"Chat session closed successfully"}),ce(!1),Le(null),tt([]),Ws()}catch(ut){console.error("Error closing chat session:",ut),s({title:"Error",description:"Failed to close chat session",variant:"destructive"})}},qr=async()=>{if(!Xe.title||!Xe.content){s({title:"Error",description:"Please fill in title and content",variant:"destructive"});return}try{await de.post("/help/community/discussions",{title:Xe.title,content:Xe.content,category:Xe.category,tags:Xe.tags}),s({title:"Success",description:"Discussion created successfully"}),_e(!1),At({title:"",content:"",category:"general",tags:[]}),$t(""),js()}catch(De){console.error("Error creating discussion:",De),s({title:"Error",description:"Failed to create discussion",variant:"destructive"})}},qn=()=>{st.trim()&&!Xe.tags.includes(st.trim())&&(At(De=>({...De,tags:[...De.tags,st.trim()]})),$t(""))},In=De=>{At(ut=>({...ut,tags:ut.tags.filter(Pe=>Pe!==De)}))},Yr=()=>{At({title:"",content:"",category:"general",tags:[]}),$t("")};return e.jsx(Kr,{children:e.jsxs("div",{className:"flex-1 space-y-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Help & Support"}),e.jsx("p",{className:"text-muted-foreground",children:"Get help, learn features, and access support resources"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(I,{variant:"outline",children:[e.jsx(La,{className:"mr-2 h-4 w-4"}),"Contact Support"]}),e.jsxs(I,{children:[e.jsx(Gw,{className:"mr-2 h-4 w-4"}),"Create Ticket"]})]})]}),e.jsxs(an,{value:_,onValueChange:k,className:"space-y-6",children:[e.jsxs(on,{className:"flex flex-wrap w-full gap-2 h-auto ml-0 pl-0",children:[e.jsx(vt,{value:"knowledge",className:"flex-shrink-0 px-4 py-2",children:"Knowledge Base"}),e.jsx(vt,{value:"tutorials",className:"flex-shrink-0 px-4 py-2",children:"Tutorials"}),e.jsx(vt,{value:"chat",className:"flex-shrink-0 px-4 py-2",children:"Live Chat"}),e.jsx(vt,{value:"tickets",className:"flex-shrink-0 px-4 py-2",children:"Support Tickets"}),e.jsx(vt,{value:"community",className:"flex-shrink-0 px-4 py-2",children:"Community"}),e.jsx(vt,{value:"articles",className:"flex-shrink-0 px-4 py-2",children:"Article Management"}),e.jsx(vt,{value:"video-mgmt",className:"flex-shrink-0 px-4 py-2",children:"Video Management"})]}),e.jsxs(yt,{value:"knowledge",className:"space-y-6",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Rn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(ge,{placeholder:"Search knowledge base...",value:t,onChange:De=>r(De.target.value),onKeyPress:De=>De.key==="Enter"&&et(),className:"pl-10"})]})}),e.jsx(I,{variant:"outline",onClick:et,disabled:T,children:T?e.jsxs(e.Fragment,{children:[e.jsx(On,{className:"h-4 w-4 mr-2 animate-spin"}),"Searching..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Rn,{className:"h-4 w-4 mr-2"}),"Search"]})})]}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:(()=>{const De=a.reduce((ut,Pe)=>{const _t=Pe.category;return ut[_t]||(ut[_t]=[]),ut[_t].push(Pe),ut},{});return Object.entries(De).map(([ut,Pe])=>{const _t=Lx[ut];if(!_t)return null;const bt=_t.icon;return e.jsxs(ne,{className:"hover:shadow-md transition-shadow cursor-pointer",children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`flex h-10 w-10 items-center justify-center rounded-lg ${Dj[_t.color]}`,children:e.jsx(bt,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx(Se,{className:"text-lg",children:_t.title}),e.jsx(Vt,{children:_t.description})]})]})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-2",children:[Pe.slice(0,3).map(ps=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg hover:bg-muted/50 cursor-pointer transition-colors",onClick:()=>Bs(ps),children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"text-sm font-medium truncate block",children:ps.title}),e.jsxs("span",{className:"text-xs text-muted-foreground truncate block",children:[ps.content.substring(0,50),"..."]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-2",children:[e.jsxs(Oe,{variant:"outline",className:"text-xs",children:[ps.views.toLocaleString()," views"]}),e.jsx(ir,{className:"h-3 w-3 text-muted-foreground"})]})]},ps.id)),Pe.length>3&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["+",Pe.length-3," more articles"]})]})})]},ut)}).filter(Boolean)})()}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Popular Articles"}),e.jsx(Vt,{children:"Most viewed help articles this month"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[a.map(De=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-blue-100",children:e.jsx(go,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:De.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[De.content.substring(0,60),"..."]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(Oe,{variant:"outline",children:[De.views.toLocaleString()," views"]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>Bs(De),children:[e.jsx(ir,{className:"h-4 w-4 mr-1"}),"View"]})]})]},De.id)),a.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No articles found. Try searching for something else."})]})})]})]}),e.jsx(yt,{value:"tutorials",className:"space-y-6",children:C?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs(I,{variant:"ghost",onClick:()=>S(null),className:"flex items-center space-x-2",children:[e.jsx(qw,{className:"h-4 w-4"}),e.jsx("span",{children:"Back to Videos"})]})}),e.jsxs("div",{className:"flex gap-6",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsx("div",{className:"relative w-full bg-black rounded-lg overflow-hidden",style:{aspectRatio:"16/9"},children:e.jsxs("video",{controls:!0,className:"w-full h-full",poster:C.thumbnailUrl,crossOrigin:"anonymous",onLoadStart:()=>{de.post(`/tutorial-videos/${C.id}/view`,{duration:C.duration}).catch(console.error)},children:[e.jsx("source",{src:We(C.id),type:"video/mp4"}),"Your browser does not support the video tag."]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-2xl font-bold leading-tight",children:C.title}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"font-medium",children:[C.viewCount||0," views"]}),e.jsx("span",{children:""}),e.jsx("span",{children:ms(C.duration||0)}),e.jsx("span",{children:""}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(go,{className:"h-4 w-4 text-yellow-500"}),e.jsx("span",{children:C.rating||0})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Oe,{variant:"outline",children:C.category}),e.jsx(Oe,{variant:"secondary",children:C.difficulty})]})]}),C.description&&e.jsx("div",{className:"bg-muted/30 rounded-lg p-4",children:e.jsx("p",{className:"text-sm leading-relaxed",children:C.description})}),C.tags&&C.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:C.tags.map((De,ut)=>e.jsx(Oe,{variant:"secondary",className:"text-xs",children:De},ut))})]})]}),e.jsxs("div",{className:"w-80 space-y-4",children:[e.jsx("h4",{className:"font-semibold",children:"More Tutorials"}),e.jsxs("div",{className:"space-y-3 max-h-[600px] overflow-y-auto",children:[f.filter(De=>De.id!==C.id).slice(0,10).map(De=>e.jsxs("div",{className:"flex space-x-3 cursor-pointer hover:bg-muted/50 rounded-lg p-3 transition-colors",onClick:()=>S(De),children:[e.jsxs("div",{className:"relative w-32 h-20 bg-black rounded overflow-hidden flex-shrink-0",children:[De.thumbnailUrl?e.jsx("img",{src:De.thumbnailUrl,alt:De.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center",children:e.jsx(po,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{className:"absolute bottom-1 right-1 bg-black/80 text-white text-xs px-1 rounded",children:[Math.floor(De.duration/60),":",(De.duration%60).toString().padStart(2,"0")]})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h5",{className:"font-medium text-sm line-clamp-2 mb-1",children:De.title}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:De.description}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:[De.viewCount||0," views"]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:""}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(go,{className:"h-3 w-3 text-yellow-500"}),e.jsx("span",{className:"text-xs",children:De.rating||0})]})]})]})]},De.id)),f.length<=1&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(po,{className:"h-8 w-8 mx-auto mb-2"}),e.jsx("p",{className:"text-sm",children:"No other videos available"})]})]})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Tutorial Videos"}),e.jsx("p",{className:"text-muted-foreground",children:"Watch and learn from our tutorial videos"})]}),e.jsxs(I,{variant:"outline",onClick:()=>xs(),children:[e.jsx(Ts,{className:"mr-2 h-4 w-4"}),"Refresh"]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:[f.map(De=>e.jsxs(ne,{className:"hover:shadow-md transition-shadow cursor-pointer",onClick:()=>us(De),children:[e.jsxs("div",{className:"relative",children:[De.thumbnailUrl?e.jsxs("div",{className:"aspect-video rounded-t-lg overflow-hidden",children:[e.jsx("img",{src:De.thumbnailUrl,alt:De.title,className:"w-full h-full object-cover",onError:ut=>{ut.currentTarget.style.display="none";const Pe=ut.currentTarget.nextElementSibling;Pe&&(Pe.style.display="flex")}}),e.jsx("div",{className:"aspect-video bg-gradient-to-br from-blue-500 to-purple-600 rounded-t-lg flex items-center justify-center hidden",children:e.jsx(po,{className:"h-12 w-12 text-white"})})]}):e.jsx("div",{className:"aspect-video bg-gradient-to-br from-blue-500 to-purple-600 rounded-t-lg flex items-center justify-center",children:e.jsx(po,{className:"h-12 w-12 text-white"})}),e.jsxs(Oe,{className:"absolute top-3 left-3 bg-black/50 text-white",children:[e.jsx(Cr,{className:"mr-1 h-3 w-3"}),Math.floor(De.duration/60),":",(De.duration%60).toString().padStart(2,"0")]}),De.downloadUrl&&e.jsx("div",{className:"absolute inset-0 bg-black/20 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity",children:e.jsx("div",{className:"bg-white/90 rounded-full p-3",children:e.jsx(po,{className:"h-8 w-8 text-blue-600"})})})]}),e.jsxs(we,{children:[e.jsx(Se,{className:"text-lg",children:De.title}),e.jsx(Vt,{children:De.description})]}),e.jsx(ie,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(go,{className:"h-4 w-4 text-yellow-500"}),e.jsxs("span",{className:"text-sm",children:[De.rating||0," (",De.viewCount||0," views)"]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>us(De),children:[e.jsx(po,{className:"mr-2 h-4 w-4"}),"Watch"]})})]})})]},De.id)),f.length===0&&e.jsxs("div",{className:"col-span-full text-center py-12",children:[e.jsx("div",{className:"mx-auto w-24 h-24 bg-muted rounded-full flex items-center justify-center mb-4",children:e.jsx(po,{className:"h-12 w-12 text-muted-foreground"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No tutorial videos yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Upload your first tutorial video to get started"}),e.jsxs(I,{onClick:()=>g(!0),children:[e.jsx(Ss,{className:"mr-2 h-4 w-4"}),"Upload Video"]})]})]})]})}),e.jsxs(yt,{value:"chat",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Live Chat Support"}),e.jsx("p",{className:"text-muted-foreground",children:"Get instant help from our support team"})]}),e.jsxs(I,{onClick:()=>ue(!0),children:[e.jsx(La,{className:"mr-2 h-4 w-4"}),"Start New Chat"]})]}),e.jsxs(ua,{children:[e.jsx(La,{className:"h-4 w-4"}),e.jsx(ha,{children:"Our support team is online and ready to help! Average response time: 2 minutes."})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Start a Conversation"}),e.jsx(Vt,{children:"Choose a category to begin your chat"})]}),e.jsxs(ie,{className:"space-y-3",children:[e.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/50 cursor-pointer",onClick:()=>{mt(De=>({...De,category:"technical"})),ue(!0)},children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-green-100",children:e.jsx(bs,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Technical Support"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Issues with features or bugs"})]})]})}),e.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/50 cursor-pointer",onClick:()=>{mt(De=>({...De,category:"account"})),ue(!0)},children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-blue-100",children:e.jsx(_5,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Account Questions"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Billing, plans, and account settings"})]})]})}),e.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/50 cursor-pointer",onClick:()=>{mt(De=>({...De,category:"training"})),ue(!0)},children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-purple-100",children:e.jsx(ml,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Training & Onboarding"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Learn how to use features"})]})]})})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Recent Conversations"}),e.jsx(Vt,{children:"Your recent chat sessions"})]}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-3",children:dt.length>0?dt.slice(0,5).map(De=>e.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/50 cursor-pointer",onClick:()=>Ir(De.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:De.subject}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[De.category,"  ",new Date(De.lastMessageAt).toLocaleString()]})]}),e.jsx(Oe,{variant:De.status==="open"?"default":"secondary",children:De.status})]})},De.id)):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No recent conversations. Start a new chat to get help!"})})})]})]})]}),e.jsxs(yt,{value:"tickets",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Support Tickets"}),e.jsxs(I,{onClick:()=>G(!0),children:[e.jsx(Gw,{className:"mr-2 h-4 w-4"}),"New Ticket"]})]}),M&&e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Create New Support Ticket"}),e.jsx(Vt,{children:"Describe your issue and we'll help you resolve it"})]}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Title *"}),e.jsx(ge,{placeholder:"Brief description of your issue",value:L.title,onChange:De=>J({...L,title:De.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Description *"}),e.jsx("textarea",{className:"w-full p-3 border rounded-md min-h-[100px]",placeholder:"Please provide detailed information about your issue...",value:L.description,onChange:De=>J({...L,description:De.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Category"}),e.jsxs("select",{className:"w-full p-2 border rounded-md",value:L.category,onChange:De=>J({...L,category:De.target.value}),children:[e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"technical",children:"Technical"}),e.jsx("option",{value:"billing",children:"Billing"}),e.jsx("option",{value:"feature",children:"Feature Request"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Priority"}),e.jsxs("select",{className:"w-full p-2 border rounded-md",value:L.priority,onChange:De=>J({...L,priority:De.target.value}),children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(I,{onClick:lt,children:"Create Ticket"}),e.jsx(I,{variant:"outline",onClick:()=>G(!1),children:"Cancel"})]})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Open Tickets"}),e.jsx(Gw,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:o.filter(De=>De.status==="open").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Require attention"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"In Progress"}),e.jsx(bs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:o.filter(De=>De.status==="in-progress").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Being worked on"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Resolved"}),e.jsx(go,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:o.filter(De=>De.status==="resolved").length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Successfully closed"})]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Recent Tickets"}),e.jsx(Vt,{children:"Your latest support requests"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[o.slice(0,5).map(De=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`flex h-10 w-10 items-center justify-center rounded-full ${De.status==="resolved"?"bg-green-100":De.status==="in-progress"?"bg-yellow-100":"bg-blue-100"}`,children:De.status==="resolved"?e.jsx(bs,{className:"h-5 w-5 text-green-600"}):De.status==="in-progress"?e.jsx(Is,{className:"h-5 w-5 text-yellow-600"}):e.jsx(Zl,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:De.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[De.ticketNumber,"  Created ",new Date(De.createdAt).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Oe,{variant:De.status==="resolved"?"default":De.status==="in-progress"?"secondary":"outline",className:De.status==="resolved"?"bg-green-100 text-green-800":De.status==="in-progress"?"bg-yellow-100 text-yellow-800":"",children:De.status==="in-progress"?"In Progress":De.status==="resolved"?"Resolved":"Open"}),e.jsx(I,{size:"sm",variant:"ghost",children:"View"})]})]},De.id)),o.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No support tickets found. Create your first ticket above!"})]})})]})]}),e.jsxs(yt,{value:"community",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Community Forum"}),e.jsx("p",{className:"text-muted-foreground",children:"Connect with other UrutiIQ users and share knowledge"})]}),e.jsxs(I,{onClick:()=>_e(!0),children:[e.jsx(La,{className:"mr-2 h-4 w-4"}),"Start Discussion"]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Recent Discussions"}),e.jsx(Vt,{children:"Latest community conversations"})]}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-3",children:c.length>0?c.slice(0,5).map(De=>e.jsxs("div",{className:"p-4 border rounded-lg hover:bg-muted/50 cursor-pointer",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"font-medium",children:De.title}),De.pinned&&e.jsx(Oe,{variant:"default",className:"bg-yellow-100 text-yellow-800",children:"Pinned"})]}),e.jsxs(Oe,{variant:"outline",children:[De.replies," replies"]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["by ",De.userName,"  ",new Date(De.lastActivity).toLocaleDateString()]}),De.tags&&De.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:De.tags.slice(0,3).map((ut,Pe)=>e.jsx(Oe,{variant:"secondary",className:"text-xs",children:ut},Pe))})]},De.id)):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No community discussions yet. Start the first one!"})})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Community Stats"}),e.jsx(Vt,{children:"Real-time community metrics"})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Active Members"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[u.totalMembers.toLocaleString()," users"]})]}),e.jsx(Sa,{className:"h-8 w-8 text-blue-600"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Posts This Month"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[u.postsThisMonth," discussions"]})]}),e.jsx(La,{className:"h-8 w-8 text-green-600"})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Knowledge Base"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[u.knowledgeBaseArticles," articles"]})]}),e.jsx(ml,{className:"h-8 w-8 text-purple-600"})]})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs(I,{className:"w-full",variant:"outline",children:[e.jsx(Sa,{className:"mr-2 h-4 w-4"}),"View All Discussions"]}),e.jsxs(I,{className:"w-full",children:[e.jsx(La,{className:"mr-2 h-4 w-4"}),"Start New Discussion"]})]})]})]})]})]}),e.jsxs(yt,{value:"articles",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Article Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Create, edit, and manage knowledge base articles"})]}),e.jsxs(ts,{open:z,onOpenChange:De=>{U(De),De||qt()},children:[e.jsx(ki,{asChild:!0,children:e.jsxs(I,{children:[e.jsx(Ss,{className:"mr-2 h-4 w-4"}),"Create Article"]})}),e.jsxs(ss,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(as,{children:[e.jsx(is,{children:oe?"Edit Article":"Create New Article"}),e.jsx(Ks,{children:oe?"Update the article details below.":"Fill in the details to create a new knowledge base article."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"title",children:"Title *"}),e.jsx(ge,{id:"title",value:P.title,onChange:De=>q(ut=>({...ut,title:De.target.value})),placeholder:"Enter article title"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"category",children:"Category *"}),e.jsxs(rt,{value:P.category,onValueChange:De=>q(ut=>({...ut,category:De})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select category"})}),e.jsxs(at,{children:[e.jsx(W,{value:"getting-started",children:"Getting Started"}),e.jsx(W,{value:"accounting",children:"Accounting"}),e.jsx(W,{value:"invoicing",children:"Invoicing"}),e.jsx(W,{value:"troubleshooting",children:"Troubleshooting"}),e.jsx(W,{value:"security",children:"Security"}),e.jsx(W,{value:"expenses",children:"Expenses"}),e.jsx(W,{value:"ai-features",children:"AI Features"})]})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"content",children:"Content *"}),e.jsx(Xs,{id:"content",value:P.content,onChange:De=>q(ut=>({...ut,content:De.target.value})),placeholder:"Enter article content",rows:8})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"tags",children:"Tags"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(ge,{id:"tags",value:D,onChange:De=>se(De.target.value),placeholder:"Enter tag and press Add",onKeyPress:De=>De.key==="Enter"&&It()}),e.jsx(I,{type:"button",variant:"outline",onClick:It,children:"Add"})]}),P.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:P.tags.map((De,ut)=>e.jsxs(Oe,{variant:"secondary",className:"cursor-pointer",onClick:()=>Gt(De),children:[De," "]},ut))})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ro,{id:"published",checked:P.isPublished,onCheckedChange:De=>q(ut=>({...ut,isPublished:De}))}),e.jsx(B,{htmlFor:"published",children:"Publish immediately"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(I,{variant:"outline",onClick:()=>{U(!1),qt()},children:"Cancel"}),e.jsx(I,{onClick:oe?ft:Fe,children:oe?"Update Article":"Create Article"})]})]})]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"All Articles"}),e.jsx(Vt,{children:"Manage your knowledge base articles"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[a.map(De=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-blue-100",children:e.jsx(Zt,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:De.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[De.category,"  ",De.views.toLocaleString()," views"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(Oe,{variant:De.helpful?"default":"secondary",children:[De.helpful?e.jsx(ir,{className:"h-3 w-3 mr-1"}):e.jsx(bp,{className:"h-3 w-3 mr-1"}),De.helpful?"Published":"Draft"]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>Je(De),children:e.jsx(ln,{className:"h-4 w-4"})}),e.jsxs($b,{children:[e.jsx(hR,{asChild:!0,children:e.jsx(I,{variant:"outline",size:"sm",children:e.jsx(hn,{className:"h-4 w-4"})})}),e.jsxs(Bb,{children:[e.jsxs(Ub,{children:[e.jsx(qb,{children:"Delete Article"}),e.jsxs(Vb,{children:['Are you sure you want to delete "',De.title,'"? This action cannot be undone.']})]}),e.jsxs(zb,{children:[e.jsx(Hb,{children:"Cancel"}),e.jsx(Wb,{onClick:()=>He(De.id),children:"Delete"})]})]})]})]})]},De.id)),a.length===0&&e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No articles found. Create your first article to get started."})]})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Category Overview"}),e.jsx(Vt,{children:"View articles by category"})]}),e.jsx(ie,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(Lx).map(([De,ut])=>{const Pe=a.filter(bt=>bt.category===De),_t=ut.icon;return e.jsxs("div",{className:"p-4 border rounded-lg hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("div",{className:`flex h-8 w-8 items-center justify-center rounded-lg ${Dj[ut.color]}`,children:e.jsx(_t,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:ut.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[Pe.length," articles"]})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:ut.description}),Pe.length>0&&e.jsxs("div",{className:"space-y-1",children:[Pe.slice(0,3).map(bt=>e.jsx("div",{className:"text-sm text-blue-600 hover:text-blue-800 cursor-pointer",children:bt.title},bt.id)),Pe.length>3&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["+",Pe.length-3," more articles"]})]})]},De)})})})]})]}),e.jsxs(yt,{value:"video-mgmt",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Tutorial Video Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Upload, manage, and stream tutorial videos"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(I,{variant:p?"default":"outline",onClick:()=>g(!p),children:[e.jsx(Ss,{className:"mr-2 h-4 w-4"}),p?"Hide Upload":"Upload Video"]}),e.jsxs(I,{variant:"outline",onClick:()=>xs(),children:[e.jsx(Ts,{className:"mr-2 h-4 w-4"}),"Refresh"]})]})]}),p&&e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:v?"Edit Tutorial Video":"Upload New Tutorial Video"}),e.jsx(Vt,{children:v?"Update the video details below.":"Upload a video file and provide details."})]}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"video-title",children:"Title *"}),e.jsx(ge,{id:"video-title",value:j.title,onChange:De=>b(ut=>({...ut,title:De.target.value})),placeholder:"Enter video title",disabled:F})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"video-duration",children:"Duration (seconds)"}),e.jsx(ge,{id:"video-duration",type:"number",value:j.duration,onChange:De=>b(ut=>({...ut,duration:parseInt(De.target.value)||0})),placeholder:"e.g., 300"})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"video-description",children:"Description"}),e.jsx(Xs,{id:"video-description",value:j.description,onChange:De=>b(ut=>({...ut,description:De.target.value})),placeholder:"Describe what this video covers...",className:"min-h-[100px]"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"video-category",children:"Category *"}),e.jsxs(rt,{value:j.category,onValueChange:De=>b(ut=>({...ut,category:De})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select category"})}),e.jsxs(at,{children:[e.jsx(W,{value:"general",children:"General"}),e.jsx(W,{value:"onboarding",children:"Onboarding"}),e.jsx(W,{value:"feature-guide",children:"Feature Guide"}),e.jsx(W,{value:"troubleshooting",children:"Troubleshooting"}),e.jsx(W,{value:"accounting",children:"Accounting"}),e.jsx(W,{value:"reporting",children:"Reporting"}),e.jsx(W,{value:"invoicing",children:"Invoicing"})]})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"video-difficulty",children:"Difficulty *"}),e.jsxs(rt,{value:j.difficulty,onValueChange:De=>b(ut=>({...ut,difficulty:De})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select difficulty"})}),e.jsxs(at,{children:[e.jsx(W,{value:"beginner",children:"Beginner"}),e.jsx(W,{value:"intermediate",children:"Intermediate"}),e.jsx(W,{value:"advanced",children:"Advanced"})]})]})]})]}),e.jsxs("div",{className:"hidden",children:[e.jsx(B,{htmlFor:"video-thumbnail",children:"Thumbnail URL"}),e.jsx(ge,{id:"video-thumbnail",value:j.thumbnailUrl,onChange:De=>b(ut=>({...ut,thumbnailUrl:De.target.value})),placeholder:"https://example.com/thumbnail.jpg"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"video-tags",children:"Tags"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(ge,{value:w,onChange:De=>N(De.target.value),placeholder:"Add a tag",onKeyPress:De=>De.key==="Enter"&&(De.preventDefault(),Et())}),e.jsx(I,{type:"button",variant:"outline",onClick:Et,children:"Add"})]}),j.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:j.tags.map((De,ut)=>e.jsxs(Oe,{variant:"secondary",className:"flex items-center gap-1",children:[De,e.jsx("button",{onClick:()=>Pt(De),className:"ml-1 hover:bg-gray-300 rounded-full p-0.5",children:""})]},ut))})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ro,{id:"video-published",checked:j.isPublished,onCheckedChange:De=>b(ut=>({...ut,isPublished:De}))}),e.jsx(B,{htmlFor:"video-published",children:"Publish immediately"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"video-file",children:"Video File *"}),e.jsx(ge,{id:"video-file",type:"file",accept:"video/*",onChange:De=>{var Pe;((Pe=De.target.files)==null?void 0:Pe[0])&&j.duration===0&&b(_t=>({..._t,duration:0}))},className:"mt-1",disabled:F})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(I,{variant:"outline",onClick:()=>{g(!1),rs()},disabled:F,children:"Cancel"}),e.jsx(I,{variant:"outline",onClick:()=>{var Pe;const ut=(Pe=document.getElementById("video-file").files)==null?void 0:Pe[0];ut?Ct(ut):s({title:"Error",description:"Please select a video file",variant:"destructive"})},disabled:F,children:"Test Upload"}),e.jsx(I,{onClick:()=>{var Pe;const ut=(Pe=document.getElementById("video-file").files)==null?void 0:Pe[0];ut?ke(ut):s({title:"Error",description:"Please select a video file",variant:"destructive"})},disabled:F,children:F?e.jsxs(e.Fragment,{children:[e.jsx(On,{className:"mr-2 h-4 w-4 animate-spin"}),"Uploading..."]}):v?"Update Video":"Upload Video"})]})]})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{children:["Tutorial Videos (",f.length,")"]}),e.jsx(Vt,{children:"Manage your uploaded tutorial videos"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[f.map(De=>e.jsxs("div",{className:"flex items-center space-x-4 p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex-shrink-0",children:[De.thumbnailUrl?e.jsx("img",{src:De.thumbnailUrl,alt:De.title,className:"w-20 h-12 object-cover rounded",onError:ut=>{const Pe=ut.target;Pe.style.display="none";const _t=Pe.nextElementSibling;_t&&(_t.style.display="flex")}}):null,e.jsx("div",{className:"w-20 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded flex items-center justify-center text-white text-xs font-medium",style:{display:De.thumbnailUrl?"none":"flex"},children:e.jsx(po,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-sm truncate",children:De.title}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:De.description}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(Oe,{variant:"outline",className:"text-xs",children:De.category}),e.jsx(Oe,{variant:"secondary",className:"text-xs",children:De.difficulty}),e.jsx("span",{className:"text-xs text-muted-foreground",children:ms(De.duration)}),De.rating&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(go,{className:"h-3 w-3 text-yellow-500 fill-current"}),e.jsxs("span",{className:"text-xs",children:[De.rating.toFixed(1)," (",De.ratingCount,")"]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>{S(De),k("tutorials")},children:[e.jsx(po,{className:"h-3 w-3 mr-1"}),"Play"]}),e.jsx(I,{size:"sm",variant:"outline",onClick:()=>{y(De),b({title:De.title,description:De.description||"",category:De.category,difficulty:De.difficulty,duration:De.duration,thumbnailUrl:De.thumbnailUrl||"",tags:De.tags||[],isPublished:De.isPublished}),g(!0)},children:e.jsx(ln,{className:"h-3 w-3"})}),e.jsxs($b,{children:[e.jsx(hR,{asChild:!0,children:e.jsx(I,{size:"sm",variant:"outline",children:e.jsx(hn,{className:"h-3 w-3"})})}),e.jsxs(Bb,{children:[e.jsxs(Ub,{children:[e.jsx(qb,{children:"Delete Video"}),e.jsxs(Vb,{children:['Are you sure you want to delete "',De.title,'"? This action cannot be undone.']})]}),e.jsxs(zb,{children:[e.jsx(Hb,{children:"Cancel"}),e.jsx(Wb,{onClick:()=>gt(De.id),children:"Delete"})]})]})]})]})]},De.id)),f.length===0&&e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(po,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No tutorial videos yet"}),e.jsx("p",{className:"text-sm mb-4",children:"Upload your first tutorial video to get started"}),e.jsxs(I,{onClick:()=>g(!0),children:[e.jsx(Ss,{className:"mr-2 h-4 w-4"}),"Upload Your First Video"]})]})]})})]})]}),e.jsx(ts,{open:Ee,onOpenChange:$e,children:e.jsxs(ss,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(as,{children:[e.jsx(is,{children:O==null?void 0:O.title}),e.jsxs(Ks,{children:[O==null?void 0:O.category,"  ",O==null?void 0:O.views.toLocaleString()," views"]})]}),e.jsxs("div",{className:"space-y-4",children:[O&&e.jsxs("div",{className:"prose max-w-none",children:[e.jsx("div",{className:"whitespace-pre-wrap text-sm leading-relaxed",children:O.content}),O.tags&&O.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-6 pt-4 border-t",children:O.tags.map((De,ut)=>e.jsx(Oe,{variant:"secondary",children:De},ut))})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(I,{variant:"outline",onClick:()=>$e(!1),children:"Close"})})]})]})}),e.jsx(ts,{open:re,onOpenChange:le,children:e.jsxs(ss,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(as,{children:[e.jsx(is,{children:Z==null?void 0:Z.title}),e.jsxs(Ks,{children:[Z==null?void 0:Z.category,"  ",Z==null?void 0:Z.difficulty,"  ",Z==null?void 0:Z.duration]})]}),e.jsxs("div",{className:"space-y-4",children:[Z&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(go,{className:"h-4 w-4 text-yellow-500"}),e.jsxs("span",{className:"text-sm",children:[Z.rating," (",Z.reviewCount," reviews)"]})]}),e.jsx(Oe,{variant:"outline",children:Z.category}),e.jsx(Oe,{variant:"secondary",children:Z.difficulty})]}),e.jsxs("div",{className:"prose max-w-none",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Description"}),e.jsx("p",{className:"text-sm leading-relaxed mb-4",children:Z.description}),Z.content&&e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Content"}),e.jsx("div",{className:"whitespace-pre-wrap text-sm leading-relaxed",children:Z.content})]})]}),Z.videoUrl&&e.jsx("div",{className:"pt-4 border-t",children:e.jsxs(I,{onClick:()=>{le(!1),As(Z)},className:"w-full",children:[e.jsx(po,{className:"mr-2 h-4 w-4"}),"Watch Video"]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(I,{variant:"outline",onClick:()=>le(!1),children:"Close"})})]})]})}),e.jsx(ts,{open:he,onOpenChange:be,children:e.jsxs(ss,{className:"max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsx(as,{children:e.jsx(is,{children:pe==null?void 0:pe.title})}),e.jsxs("div",{className:"space-y-4",children:[pe&&e.jsx("div",{className:"aspect-video bg-black rounded-lg overflow-hidden",children:pe.url.includes("youtube.com")||pe.url.includes("youtu.be")?e.jsx("iframe",{src:pe.url.replace("watch?v=","embed/").replace("youtu.be/","youtube.com/embed/"),title:pe.title,className:"w-full h-full",allowFullScreen:!0}):pe.url.includes("vimeo.com")?e.jsx("iframe",{src:pe.url.replace("vimeo.com/","player.vimeo.com/video/"),title:pe.title,className:"w-full h-full",allowFullScreen:!0}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-900",children:e.jsxs("div",{className:"text-center text-white",children:[e.jsx(po,{className:"h-16 w-16 mx-auto mb-4"}),e.jsx("p",{className:"text-lg mb-2",children:"Video not embeddable"}),e.jsx("p",{className:"text-sm text-gray-300 mb-4",children:"Click below to open in new tab"}),e.jsxs(I,{onClick:()=>Ht(pe.url),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(Nm,{className:"mr-2 h-4 w-4"}),"Open Video"]})]})})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(I,{variant:"outline",onClick:()=>be(!1),children:"Close"})})]})]})}),Y&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50",onClick:()=>ue(!1)}),e.jsx("div",{className:"relative bg-white rounded-lg shadow-lg max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Start New Chat Session"}),e.jsx("button",{onClick:()=>ue(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(ma,{className:"h-6 w-6"})})]}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Create a new chat session to get help from our support team"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"chat-category",children:"Category *"}),e.jsxs(rt,{value:qe.category,onValueChange:De=>mt(ut=>({...ut,category:De})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select category"})}),e.jsxs(at,{children:[e.jsx(W,{value:"technical",children:"Technical Support"}),e.jsx(W,{value:"account",children:"Account Questions"}),e.jsx(W,{value:"training",children:"Training & Onboarding"}),e.jsx(W,{value:"billing",children:"Billing & Payments"}),e.jsx(W,{value:"feature",children:"Feature Request"}),e.jsx(W,{value:"other",children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"chat-subject",children:"Subject *"}),e.jsx(ge,{id:"chat-subject",value:qe.subject,onChange:De=>mt(ut=>({...ut,subject:De.target.value})),placeholder:"Brief description of your issue"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"chat-priority",children:"Priority"}),e.jsxs(rt,{value:qe.priority,onValueChange:De=>mt(ut=>({...ut,priority:De})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select priority"})}),e.jsxs(at,{children:[e.jsx(W,{value:"low",children:"Low"}),e.jsx(W,{value:"medium",children:"Medium"}),e.jsx(W,{value:"high",children:"High"}),e.jsx(W,{value:"urgent",children:"Urgent"})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(I,{variant:"outline",onClick:()=>ue(!1),children:"Cancel"}),e.jsx(I,{onClick:er,children:"Start Chat"})]})]})]})})]}),e.jsx(ts,{open:X,onOpenChange:ce,children:e.jsxs(ss,{className:"max-w-4xl max-h-[80vh] flex flex-col",children:[e.jsxs(as,{children:[e.jsx(is,{children:ve==null?void 0:ve.subject}),e.jsxs(Ks,{children:[ve==null?void 0:ve.category,"  ",ve==null?void 0:ve.priority," priority"]})]}),e.jsxs("div",{className:"flex-1 flex flex-col space-y-4",children:[e.jsx("div",{className:"flex-1 overflow-y-auto space-y-4 p-4 border rounded-lg bg-muted/20",children:Me.length>0?Me.map(De=>e.jsx("div",{className:`flex ${De.senderType==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`max-w-[70%] p-3 rounded-lg ${De.senderType==="user"?"bg-blue-600 text-white":"bg-white border"}`,children:[e.jsx("p",{className:"text-sm",children:De.message}),e.jsxs("p",{className:`text-xs mt-1 ${De.senderType==="user"?"text-blue-100":"text-muted-foreground"}`,children:[De.senderName,"  ",new Date(De.timestamp).toLocaleString()]})]})},De.id)):e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No messages yet. Start the conversation!"})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(ge,{value:fe,onChange:De=>ct(De.target.value),placeholder:"Type your message...",onKeyPress:De=>De.key==="Enter"&&jn()}),e.jsx(I,{onClick:jn,disabled:!fe.trim(),children:"Send"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(I,{variant:"outline",onClick:()=>ve&&Hs(ve.id),children:"Close Chat"})})]})]})}),e.jsx(ts,{open:Rt,onOpenChange:De=>{_e(De),De||Yr()},children:e.jsxs(ss,{className:"max-w-2xl",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Start New Discussion"}),e.jsx(Ks,{children:"Share your thoughts and connect with the community"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"discussion-title",children:"Title *"}),e.jsx(ge,{id:"discussion-title",value:Xe.title,onChange:De=>At(ut=>({...ut,title:De.target.value})),placeholder:"What's your discussion about?"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"discussion-category",children:"Category"}),e.jsxs(rt,{value:Xe.category,onValueChange:De=>At(ut=>({...ut,category:De})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select category"})}),e.jsxs(at,{children:[e.jsx(W,{value:"general",children:"General Discussion"}),e.jsx(W,{value:"accounting",children:"Accounting"}),e.jsx(W,{value:"reporting",children:"Reporting"}),e.jsx(W,{value:"invoicing",children:"Invoicing"}),e.jsx(W,{value:"support",children:"Support"}),e.jsx(W,{value:"feature-request",children:"Feature Request"}),e.jsx(W,{value:"tips",children:"Tips & Tricks"})]})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"discussion-content",children:"Content *"}),e.jsx(Xs,{id:"discussion-content",value:Xe.content,onChange:De=>At(ut=>({...ut,content:De.target.value})),placeholder:"Share your thoughts, ask questions, or provide helpful information...",className:"min-h-[120px]"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"discussion-tags",children:"Tags (optional)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(ge,{value:st,onChange:De=>$t(De.target.value),placeholder:"Add a tag",onKeyPress:De=>De.key==="Enter"&&(De.preventDefault(),qn())}),e.jsx(I,{type:"button",variant:"outline",onClick:qn,children:"Add"})]}),Xe.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:Xe.tags.map((De,ut)=>e.jsxs(Oe,{variant:"secondary",className:"flex items-center gap-1",children:[De,e.jsx("button",{type:"button",onClick:()=>In(De),className:"ml-1 hover:text-destructive",children:""})]},ut))})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(I,{variant:"outline",onClick:()=>_e(!1),children:"Cancel"}),e.jsx(I,{onClick:qr,children:"Create Discussion"})]})]})]})}),e.jsx(ts,{open:Ee,onOpenChange:$e,children:e.jsxs(ss,{className:"max-w-6xl w-[95vw] max-h-[95vh] flex flex-col",children:[e.jsx(as,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>$e(!1),children:e.jsx(qw,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx(is,{className:"text-xl",children:O==null?void 0:O.title}),e.jsxs(Ks,{className:"flex items-center space-x-4 mt-1",children:[e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(ir,{className:"h-4 w-4"}),e.jsxs("span",{children:[O==null?void 0:O.views.toLocaleString()," views"]})]}),e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(Cr,{className:"h-4 w-4"}),e.jsxs("span",{children:["Updated ",O!=null&&O.lastUpdated?new Date(O.lastUpdated).toLocaleDateString():"Recently"]})]}),e.jsx(Oe,{variant:"outline",className:`${Dj[($r=Lx[O==null?void 0:O.category])==null?void 0:$r.color]||"bg-gray-100 text-gray-600"}`,children:((Vr=Lx[O==null?void 0:O.category])==null?void 0:Vr.title)||(O==null?void 0:O.category)})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(go,{className:"h-4 w-4 mr-1"}),"Helpful"]}),e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(Nm,{className:"h-4 w-4 mr-1"}),"Share"]})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"prose prose-sm max-w-none p-6",children:[(O==null?void 0:O.tags)&&O.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-6 not-prose",children:O.tags.map((De,ut)=>e.jsx(Oe,{variant:"secondary",className:"text-xs",children:De},ut))}),e.jsx("div",{className:"whitespace-pre-wrap leading-relaxed",children:O==null?void 0:O.content}),e.jsxs("div",{className:"flex items-center justify-between pt-6 mt-6 border-t not-prose",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(I,{variant:O!=null&&O.helpful?"default":"outline",size:"sm",onClick:()=>Vs(O==null?void 0:O.id),children:[e.jsx(go,{className:"h-4 w-4 mr-1"}),O!=null&&O.helpful?"Marked Helpful":"Mark as Helpful"]}),e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(La,{className:"h-4 w-4 mr-1"}),"Ask Question"]})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Was this article helpful?"})]})]})})]})}),e.jsx(ts,{open:re,onOpenChange:le,children:e.jsxs(ss,{className:"max-w-6xl max-h-[90vh] flex flex-col",children:[e.jsx(as,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>le(!1),children:e.jsx(qw,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx(is,{className:"text-xl",children:Z==null?void 0:Z.title}),e.jsxs(Ks,{className:"flex items-center space-x-4 mt-1",children:[e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(po,{className:"h-4 w-4"}),e.jsx("span",{children:Z==null?void 0:Z.duration})]}),e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx(go,{className:"h-4 w-4"}),e.jsxs("span",{children:[Z==null?void 0:Z.rating,"/5 (",Z==null?void 0:Z.reviewCount," reviews)"]})]}),e.jsx(Oe,{variant:"outline",className:`${Dj[(wn=Lx[Z==null?void 0:Z.category])==null?void 0:wn.color]||"bg-gray-100 text-gray-600"}`,children:((Vn=Lx[Z==null?void 0:Z.category])==null?void 0:Vn.title)||(Z==null?void 0:Z.category)}),e.jsx(Oe,{variant:(Z==null?void 0:Z.difficulty)==="beginner"?"default":(Z==null?void 0:Z.difficulty)==="intermediate"?"secondary":"destructive",children:Z==null?void 0:Z.difficulty})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(go,{className:"h-4 w-4 mr-1"}),"Rate"]}),e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(Nm,{className:"h-4 w-4 mr-1"}),"Share"]})]})]})}),e.jsxs("div",{className:"flex-1 flex flex-col lg:flex-row gap-6 overflow-hidden",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"aspect-video bg-black rounded-lg flex items-center justify-center",children:Z!=null&&Z.videoUrl?e.jsxs("video",{controls:!0,className:"w-full h-full rounded-lg",poster:Z==null?void 0:Z.thumbnail,children:[e.jsx("source",{src:Z.videoUrl,type:"video/mp4"}),"Your browser does not support the video tag."]}):e.jsxs("div",{className:"text-white text-center",children:[e.jsx(po,{className:"h-16 w-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Video not available"})]})}),(Z==null?void 0:Z.progress)!==void 0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground mb-2",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[Z.progress,"% complete"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${Z.progress}%`}})})]})]}),e.jsx("div",{className:"lg:w-80 flex flex-col",children:e.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Description"}),e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:(Z==null?void 0:Z.description)||"No description available."})]}),(Z==null?void 0:Z.content)&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Additional Notes"}),e.jsx("div",{className:"text-sm text-muted-foreground leading-relaxed whitespace-pre-wrap",children:Z.content})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsxs(I,{variant:Z!=null&&Z.completed?"default":"outline",size:"sm",className:"flex-1 mr-2",children:[e.jsx(bs,{className:"h-4 w-4 mr-1"}),Z!=null&&Z.completed?"Completed":"Mark Complete"]}),e.jsx(I,{variant:"outline",size:"sm",children:e.jsx(go,{className:"h-4 w-4"})})]})]})})]})]})})]})]})})}function gR(){const[s]=j5(),[t,r]=x.useState(""),[n,a]=x.useState("");return x.useEffect(()=>{const i=s.get("companyId"),o=s.get("report");i&&r(i),o&&a(o)},[s]),e.jsx(sh,{children:e.jsx(Kr,{showBreadcrumbs:!0,children:e.jsx("div",{className:"space-y-6",children:e.jsx(l1,{selectedCompany:t||"",defaultReportType:n||"balance-sheet"})})})})}const BS={},E0={};function Z0(s,t){try{const n=(BS[s]||(BS[s]=new Intl.DateTimeFormat("en-GB",{timeZone:s,hour:"numeric",timeZoneName:"longOffset"}).format))(t).split("GMT")[1]||"";return n in E0?E0[n]:vR(n,n.split(":"))}catch{if(s in E0)return E0[s];const r=s==null?void 0:s.match(CMe);return r?vR(s,r.slice(1)):NaN}}const CMe=/([+-]\d\d):?(\d\d)?/;function vR(s,t){const r=+t[0],n=+(t[1]||0);return E0[s]=r>0?r*60+n:r*60-n}class cu extends Date{constructor(...t){super(),t.length>1&&typeof t[t.length-1]=="string"&&(this.timeZone=t.pop()),this.internal=new Date,isNaN(Z0(this.timeZone,this))?this.setTime(NaN):t.length?typeof t[0]=="number"&&(t.length===1||t.length===2&&typeof t[1]!="number")?this.setTime(t[0]):typeof t[0]=="string"?this.setTime(+new Date(t[0])):t[0]instanceof Date?this.setTime(+t[0]):(this.setTime(+new Date(...t)),WV(this),i5(this)):this.setTime(Date.now())}static tz(t,...r){return r.length?new cu(...r,t):new cu(Date.now(),t)}withTimeZone(t){return new cu(+this,t)}getTimezoneOffset(){return-Z0(this.timeZone,this)}setTime(t){return Date.prototype.setTime.apply(this,arguments),i5(this),+this}[Symbol.for("constructDateFrom")](t){return new cu(+new Date(t),this.timeZone)}}const yR=/^(get|set)(?!UTC)/;Object.getOwnPropertyNames(Date.prototype).forEach(s=>{if(!yR.test(s))return;const t=s.replace(yR,"$1UTC");cu.prototype[t]&&(s.startsWith("get")?cu.prototype[s]=function(){return this.internal[t]()}:(cu.prototype[s]=function(){return Date.prototype[t].apply(this.internal,arguments),AMe(this),+this},cu.prototype[t]=function(){return Date.prototype[t].apply(this,arguments),i5(this),+this}))});function i5(s){s.internal.setTime(+s),s.internal.setUTCMinutes(s.internal.getUTCMinutes()-s.getTimezoneOffset())}function AMe(s){Date.prototype.setFullYear.call(s,s.internal.getUTCFullYear(),s.internal.getUTCMonth(),s.internal.getUTCDate()),Date.prototype.setHours.call(s,s.internal.getUTCHours(),s.internal.getUTCMinutes(),s.internal.getUTCSeconds(),s.internal.getUTCMilliseconds()),WV(s)}function WV(s){const t=Z0(s.timeZone,s),r=new Date(+s);r.setUTCHours(r.getUTCHours()-1);const n=-new Date(+s).getTimezoneOffset(),a=-new Date(+r).getTimezoneOffset(),i=n-a,o=Date.prototype.getHours.apply(s)!==s.internal.getUTCHours();i&&o&&s.internal.setUTCMinutes(s.internal.getUTCMinutes()+i);const l=n-t;l&&Date.prototype.setUTCMinutes.call(s,Date.prototype.getUTCMinutes.call(s)+l);const c=Z0(s.timeZone,s),u=-new Date(+s).getTimezoneOffset()-c,h=c!==t,f=u-l;if(h&&f){Date.prototype.setUTCMinutes.call(s,Date.prototype.getUTCMinutes.call(s)+f);const m=Z0(s.timeZone,s),p=c-m;p&&(s.internal.setUTCMinutes(s.internal.getUTCMinutes()+p),Date.prototype.setUTCMinutes.call(s,Date.prototype.getUTCMinutes.call(s)+p))}}class ul extends cu{static tz(t,...r){return r.length?new ul(...r,t):new ul(Date.now(),t)}toISOString(){const[t,r,n]=this.tzComponents(),a=`${t}${r}:${n}`;return this.internal.toISOString().slice(0,-1)+a}toString(){return`${this.toDateString()} ${this.toTimeString()}`}toDateString(){const[t,r,n,a]=this.internal.toUTCString().split(" ");return`${t==null?void 0:t.slice(0,-1)} ${n} ${r} ${a}`}toTimeString(){const t=this.internal.toUTCString().split(" ")[4],[r,n,a]=this.tzComponents();return`${t} GMT${r}${n}${a} (${EMe(this.timeZone,this)})`}toLocaleString(t,r){return Date.prototype.toLocaleString.call(this,t,{...r,timeZone:(r==null?void 0:r.timeZone)||this.timeZone})}toLocaleDateString(t,r){return Date.prototype.toLocaleDateString.call(this,t,{...r,timeZone:(r==null?void 0:r.timeZone)||this.timeZone})}toLocaleTimeString(t,r){return Date.prototype.toLocaleTimeString.call(this,t,{...r,timeZone:(r==null?void 0:r.timeZone)||this.timeZone})}tzComponents(){const t=this.getTimezoneOffset(),r=t>0?"-":"+",n=String(Math.floor(Math.abs(t)/60)).padStart(2,"0"),a=String(Math.abs(t)%60).padStart(2,"0");return[r,n,a]}withTimeZone(t){return new ul(+this,t)}[Symbol.for("constructDateFrom")](t){return new ul(+new Date(t),this.timeZone)}}function EMe(s,t){return new Intl.DateTimeFormat("en-GB",{timeZone:s,timeZoneName:"long"}).format(t).slice(12)}var Sr;(function(s){s.Root="root",s.Chevron="chevron",s.Day="day",s.DayButton="day_button",s.CaptionLabel="caption_label",s.Dropdowns="dropdowns",s.Dropdown="dropdown",s.DropdownRoot="dropdown_root",s.Footer="footer",s.MonthGrid="month_grid",s.MonthCaption="month_caption",s.MonthsDropdown="months_dropdown",s.Month="month",s.Months="months",s.Nav="nav",s.NextMonthButton="button_next",s.PreviousMonthButton="button_previous",s.Week="week",s.Weeks="weeks",s.Weekday="weekday",s.Weekdays="weekdays",s.WeekNumber="week_number",s.WeekNumberHeader="week_number_header",s.YearsDropdown="years_dropdown"})(Sr||(Sr={}));var bi;(function(s){s.disabled="disabled",s.hidden="hidden",s.outside="outside",s.focused="focused",s.today="today"})(bi||(bi={}));var _d;(function(s){s.range_end="range_end",s.range_middle="range_middle",s.range_start="range_start",s.selected="selected"})(_d||(_d={}));var Nc;(function(s){s.weeks_before_enter="weeks_before_enter",s.weeks_before_exit="weeks_before_exit",s.weeks_after_enter="weeks_after_enter",s.weeks_after_exit="weeks_after_exit",s.caption_after_enter="caption_after_enter",s.caption_after_exit="caption_after_exit",s.caption_before_enter="caption_before_enter",s.caption_before_exit="caption_before_exit"})(Nc||(Nc={}));const jR=5,IMe=4;function PMe(s,t){const r=t.startOfMonth(s),n=r.getDay()>0?r.getDay():7,a=t.addDays(s,-n+1),i=t.addDays(a,jR*7-1);return t.getMonth(s)===t.getMonth(i)?jR:IMe}function HV(s,t){const r=t.startOfMonth(s),n=r.getDay();return n===1?r:n===0?t.addDays(r,-1*6):t.addDays(r,-1*(n-1))}function _Me(s,t){const r=HV(s,t),n=PMe(s,t);return t.addDays(r,n*7-1)}class Ch{constructor(t,r){this.Date=Date,this.today=()=>{var n;return(n=this.overrides)!=null&&n.today?this.overrides.today():this.options.timeZone?ul.tz(this.options.timeZone):new this.Date},this.newDate=(n,a,i)=>{var o;return(o=this.overrides)!=null&&o.newDate?this.overrides.newDate(n,a,i):this.options.timeZone?new ul(n,a,i,this.options.timeZone):new Date(n,a,i)},this.addDays=(n,a)=>{var i;return(i=this.overrides)!=null&&i.addDays?this.overrides.addDays(n,a):l9(n,a)},this.addMonths=(n,a)=>{var i;return(i=this.overrides)!=null&&i.addMonths?this.overrides.addMonths(n,a):c9(n,a)},this.addWeeks=(n,a)=>{var i;return(i=this.overrides)!=null&&i.addWeeks?this.overrides.addWeeks(n,a):xoe(n,a)},this.addYears=(n,a)=>{var i;return(i=this.overrides)!=null&&i.addYears?this.overrides.addYears(n,a):poe(n,a)},this.differenceInCalendarDays=(n,a)=>{var i;return(i=this.overrides)!=null&&i.differenceInCalendarDays?this.overrides.differenceInCalendarDays(n,a):u9(n,a)},this.differenceInCalendarMonths=(n,a)=>{var i;return(i=this.overrides)!=null&&i.differenceInCalendarMonths?this.overrides.differenceInCalendarMonths(n,a):boe(n,a)},this.eachMonthOfInterval=n=>{var a;return(a=this.overrides)!=null&&a.eachMonthOfInterval?this.overrides.eachMonthOfInterval(n):Soe(n)},this.endOfBroadcastWeek=n=>{var a;return(a=this.overrides)!=null&&a.endOfBroadcastWeek?this.overrides.endOfBroadcastWeek(n):_Me(n,this)},this.endOfISOWeek=n=>{var a;return(a=this.overrides)!=null&&a.endOfISOWeek?this.overrides.endOfISOWeek(n):Eoe(n)},this.endOfMonth=n=>{var a;return(a=this.overrides)!=null&&a.endOfMonth?this.overrides.endOfMonth(n):Noe(n)},this.endOfWeek=(n,a)=>{var i;return(i=this.overrides)!=null&&i.endOfWeek?this.overrides.endOfWeek(n,a):f9(n,this.options)},this.endOfYear=n=>{var a;return(a=this.overrides)!=null&&a.endOfYear?this.overrides.endOfYear(n):Aoe(n)},this.format=(n,a,i)=>{var l;const o=(l=this.overrides)!=null&&l.format?this.overrides.format(n,a,this.options):Kn(n,a,this.options);return this.options.numerals&&this.options.numerals!=="latn"?this.replaceDigits(o):o},this.getISOWeek=n=>{var a;return(a=this.overrides)!=null&&a.getISOWeek?this.overrides.getISOWeek(n):x9(n)},this.getMonth=(n,a)=>{var i;return(i=this.overrides)!=null&&i.getMonth?this.overrides.getMonth(n,this.options):Sle(n,this.options)},this.getYear=(n,a)=>{var i;return(i=this.overrides)!=null&&i.getYear?this.overrides.getYear(n,this.options):Cle(n,this.options)},this.getWeek=(n,a)=>{var i;return(i=this.overrides)!=null&&i.getWeek?this.overrides.getWeek(n,this.options):g9(n,this.options)},this.isAfter=(n,a)=>{var i;return(i=this.overrides)!=null&&i.isAfter?this.overrides.isAfter(n,a):Ale(n,a)},this.isBefore=(n,a)=>{var i;return(i=this.overrides)!=null&&i.isBefore?this.overrides.isBefore(n,a):Ele(n,a)},this.isDate=n=>{var a;return(a=this.overrides)!=null&&a.isDate?this.overrides.isDate(n):h9(n)},this.isSameDay=(n,a)=>{var i;return(i=this.overrides)!=null&&i.isSameDay?this.overrides.isSameDay(n,a):yoe(n,a)},this.isSameMonth=(n,a)=>{var i;return(i=this.overrides)!=null&&i.isSameMonth?this.overrides.isSameMonth(n,a):Ile(n,a)},this.isSameYear=(n,a)=>{var i;return(i=this.overrides)!=null&&i.isSameYear?this.overrides.isSameYear(n,a):Ple(n,a)},this.max=n=>{var a;return(a=this.overrides)!=null&&a.max?this.overrides.max(n):goe(n)},this.min=n=>{var a;return(a=this.overrides)!=null&&a.min?this.overrides.min(n):voe(n)},this.setMonth=(n,a)=>{var i;return(i=this.overrides)!=null&&i.setMonth?this.overrides.setMonth(n,a):_le(n,a)},this.setYear=(n,a)=>{var i;return(i=this.overrides)!=null&&i.setYear?this.overrides.setYear(n,a):kle(n,a)},this.startOfBroadcastWeek=(n,a)=>{var i;return(i=this.overrides)!=null&&i.startOfBroadcastWeek?this.overrides.startOfBroadcastWeek(n,this):HV(n,this)},this.startOfDay=n=>{var a;return(a=this.overrides)!=null&&a.startOfDay?this.overrides.startOfDay(n):dv(n)},this.startOfISOWeek=n=>{var a;return(a=this.overrides)!=null&&a.startOfISOWeek?this.overrides.startOfISOWeek(n):cv(n)},this.startOfMonth=n=>{var a;return(a=this.overrides)!=null&&a.startOfMonth?this.overrides.startOfMonth(n):Coe(n)},this.startOfWeek=(n,a)=>{var i;return(i=this.overrides)!=null&&i.startOfWeek?this.overrides.startOfWeek(n,this.options):_p(n,this.options)},this.startOfYear=n=>{var a;return(a=this.overrides)!=null&&a.startOfYear?this.overrides.startOfYear(n):m9(n)},this.options={locale:j3,...t},this.overrides=r}getDigitMap(){const{numerals:t="latn"}=this.options,r=new Intl.NumberFormat("en-US",{numberingSystem:t}),n={};for(let a=0;a<10;a++)n[a.toString()]=r.format(a);return n}replaceDigits(t){const r=this.getDigitMap();return t.replace(/\d/g,n=>r[n]||n)}formatNumber(t){return this.replaceDigits(t.toString())}}const wu=new Ch;class GV{constructor(t,r,n=wu){this.date=t,this.displayMonth=r,this.outside=!!(r&&!n.isSameMonth(t,r)),this.dateLib=n}isEqualTo(t){return this.dateLib.isSameDay(t.date,this.date)&&this.dateLib.isSameMonth(t.displayMonth,this.displayMonth)}}class kMe{constructor(t,r){this.date=t,this.weeks=r}}class TMe{constructor(t,r){this.days=r,this.weekNumber=t}}function eh(s,t,r=!1,n=wu){let{from:a,to:i}=s;const{differenceInCalendarDays:o,isSameDay:l}=n;return a&&i?(o(i,a)<0&&([a,i]=[i,a]),o(t,a)>=(r?1:0)&&o(i,t)>=(r?1:0)):!r&&i?l(i,t):!r&&a?l(a,t):!1}function KV(s){return!!(s&&typeof s=="object"&&"before"in s&&"after"in s)}function zE(s){return!!(s&&typeof s=="object"&&"from"in s)}function YV(s){return!!(s&&typeof s=="object"&&"after"in s)}function JV(s){return!!(s&&typeof s=="object"&&"before"in s)}function XV(s){return!!(s&&typeof s=="object"&&"dayOfWeek"in s)}function QV(s,t){return Array.isArray(s)&&s.every(t.isDate)}function th(s,t,r=wu){const n=Array.isArray(t)?t:[t],{isSameDay:a,differenceInCalendarDays:i,isAfter:o}=r;return n.some(l=>{if(typeof l=="boolean")return l;if(r.isDate(l))return a(s,l);if(QV(l,r))return l.includes(s);if(zE(l))return eh(l,s,!1,r);if(XV(l))return Array.isArray(l.dayOfWeek)?l.dayOfWeek.includes(s.getDay()):l.dayOfWeek===s.getDay();if(KV(l)){const c=i(l.before,s),d=i(l.after,s),u=c>0,h=d<0;return o(l.before,l.after)?h&&u:u||h}return YV(l)?i(s,l.after)>0:JV(l)?i(l.before,s)>0:typeof l=="function"?l(s):!1})}function DMe(s,t,r,n,a){const{disabled:i,hidden:o,modifiers:l,showOutsideDays:c,broadcastCalendar:d,today:u}=t,{isSameDay:h,isSameMonth:f,startOfMonth:m,isBefore:p,endOfMonth:g,isAfter:v}=a,y=r&&m(r),j=n&&g(n),b={[bi.focused]:[],[bi.outside]:[],[bi.disabled]:[],[bi.hidden]:[],[bi.today]:[]},w={};for(const N of s){const{date:C,displayMonth:S}=N,_=!!(S&&!f(C,S)),k=!!(y&&p(C,y)),F=!!(j&&v(C,j)),A=!!(i&&th(C,i,a)),T=!!(o&&th(C,o,a))||k||F||!d&&!c&&_||d&&c===!1&&_,V=h(C,u??a.today());_&&b.outside.push(N),A&&b.disabled.push(N),T&&b.hidden.push(N),V&&b.today.push(N),l&&Object.keys(l).forEach(M=>{const G=l==null?void 0:l[M];G&&th(C,G,a)&&(w[M]?w[M].push(N):w[M]=[N])})}return N=>{const C={[bi.focused]:!1,[bi.disabled]:!1,[bi.hidden]:!1,[bi.outside]:!1,[bi.today]:!1},S={};for(const _ in b){const k=b[_];C[_]=k.some(F=>F===N)}for(const _ in w)S[_]=w[_].some(k=>k===N);return{...C,...S}}}function OMe(s,t,r={}){return Object.entries(s).filter(([,a])=>a===!0).reduce((a,[i])=>(r[i]?a.push(r[i]):t[bi[i]]?a.push(t[bi[i]]):t[_d[i]]&&a.push(t[_d[i]]),a),[t[Sr.Day]])}function RMe(s){return xe.createElement("button",{...s})}function FMe(s){return xe.createElement("span",{...s})}function MMe(s){const{size:t=24,orientation:r="left",className:n}=s;return xe.createElement("svg",{className:n,width:t,height:t,viewBox:"0 0 24 24"},r==="up"&&xe.createElement("polygon",{points:"6.77 17 12.5 11.43 18.24 17 20 15.28 12.5 8 5 15.28"}),r==="down"&&xe.createElement("polygon",{points:"6.77 8 12.5 13.57 18.24 8 20 9.72 12.5 17 5 9.72"}),r==="left"&&xe.createElement("polygon",{points:"16 18.112 9.81111111 12 16 5.87733333 14.0888889 4 6 12 14.0888889 20"}),r==="right"&&xe.createElement("polygon",{points:"8 18.112 14.18888889 12 8 5.87733333 9.91111111 4 18 12 9.91111111 20"}))}function LMe(s){const{day:t,modifiers:r,...n}=s;return xe.createElement("td",{...n})}function $Me(s){const{day:t,modifiers:r,...n}=s,a=xe.useRef(null);return xe.useEffect(()=>{var i;r.focused&&((i=a.current)==null||i.focus())},[r.focused]),xe.createElement("button",{ref:a,...n})}function BMe(s){const{options:t,className:r,components:n,classNames:a,...i}=s,o=[a[Sr.Dropdown],r].join(" "),l=t==null?void 0:t.find(({value:c})=>c===i.value);return xe.createElement("span",{"data-disabled":i.disabled,className:a[Sr.DropdownRoot]},xe.createElement(n.Select,{className:o,...i},t==null?void 0:t.map(({value:c,label:d,disabled:u})=>xe.createElement(n.Option,{key:c,value:c,disabled:u},d))),xe.createElement("span",{className:a[Sr.CaptionLabel],"aria-hidden":!0},l==null?void 0:l.label,xe.createElement(n.Chevron,{orientation:"down",size:18,className:a[Sr.Chevron]})))}function UMe(s){return xe.createElement("div",{...s})}function zMe(s){return xe.createElement("div",{...s})}function qMe(s){const{calendarMonth:t,displayIndex:r,...n}=s;return xe.createElement("div",{...n},s.children)}function VMe(s){const{calendarMonth:t,displayIndex:r,...n}=s;return xe.createElement("div",{...n})}function WMe(s){return xe.createElement("table",{...s})}function HMe(s){return xe.createElement("div",{...s})}const ZV=x.createContext(void 0);function Cy(){const s=x.useContext(ZV);if(s===void 0)throw new Error("useDayPicker() must be used within a custom component.");return s}function GMe(s){const{components:t}=Cy();return xe.createElement(t.Dropdown,{...s})}function KMe(s){const{onPreviousClick:t,onNextClick:r,previousMonth:n,nextMonth:a,...i}=s,{components:o,classNames:l,labels:{labelPrevious:c,labelNext:d}}=Cy(),u=x.useCallback(f=>{a&&(r==null||r(f))},[a,r]),h=x.useCallback(f=>{n&&(t==null||t(f))},[n,t]);return xe.createElement("nav",{...i},xe.createElement(o.PreviousMonthButton,{type:"button",className:l[Sr.PreviousMonthButton],tabIndex:n?void 0:-1,"aria-disabled":n?void 0:!0,"aria-label":c(n),onClick:h},xe.createElement(o.Chevron,{disabled:n?void 0:!0,className:l[Sr.Chevron],orientation:"left"})),xe.createElement(o.NextMonthButton,{type:"button",className:l[Sr.NextMonthButton],tabIndex:a?void 0:-1,"aria-disabled":a?void 0:!0,"aria-label":d(a),onClick:u},xe.createElement(o.Chevron,{disabled:a?void 0:!0,orientation:"right",className:l[Sr.Chevron]})))}function YMe(s){const{components:t}=Cy();return xe.createElement(t.Button,{...s})}function JMe(s){return xe.createElement("option",{...s})}function XMe(s){const{components:t}=Cy();return xe.createElement(t.Button,{...s})}function QMe(s){const{rootRef:t,...r}=s;return xe.createElement("div",{...r,ref:t})}function ZMe(s){return xe.createElement("select",{...s})}function eLe(s){const{week:t,...r}=s;return xe.createElement("tr",{...r})}function tLe(s){return xe.createElement("th",{...s})}function sLe(s){return xe.createElement("thead",{"aria-hidden":!0},xe.createElement("tr",{...s}))}function rLe(s){const{week:t,...r}=s;return xe.createElement("th",{...r})}function nLe(s){return xe.createElement("th",{...s})}function aLe(s){return xe.createElement("tbody",{...s})}function iLe(s){const{components:t}=Cy();return xe.createElement(t.Dropdown,{...s})}const oLe=Object.freeze(Object.defineProperty({__proto__:null,Button:RMe,CaptionLabel:FMe,Chevron:MMe,Day:LMe,DayButton:$Me,Dropdown:BMe,DropdownNav:UMe,Footer:zMe,Month:qMe,MonthCaption:VMe,MonthGrid:WMe,Months:HMe,MonthsDropdown:GMe,Nav:KMe,NextMonthButton:YMe,Option:JMe,PreviousMonthButton:XMe,Root:QMe,Select:ZMe,Week:eLe,WeekNumber:rLe,WeekNumberHeader:nLe,Weekday:tLe,Weekdays:sLe,Weeks:aLe,YearsDropdown:iLe},Symbol.toStringTag,{value:"Module"}));function lLe(s){return{...oLe,...s}}function cLe(s){const t={"data-mode":s.mode??void 0,"data-required":"required"in s?s.required:void 0,"data-multiple-months":s.numberOfMonths&&s.numberOfMonths>1||void 0,"data-week-numbers":s.showWeekNumber||void 0,"data-broadcast-calendar":s.broadcastCalendar||void 0,"data-nav-layout":s.navLayout||void 0};return Object.entries(s).forEach(([r,n])=>{r.startsWith("data-")&&(t[r]=n)}),t}function qE(){const s={};for(const t in Sr)s[Sr[t]]=`rdp-${Sr[t]}`;for(const t in bi)s[bi[t]]=`rdp-${bi[t]}`;for(const t in _d)s[_d[t]]=`rdp-${_d[t]}`;for(const t in Nc)s[Nc[t]]=`rdp-${Nc[t]}`;return s}function eW(s,t,r){return(r??new Ch(t)).format(s,"LLLL y")}const dLe=eW;function uLe(s,t,r){return(r??new Ch(t)).format(s,"d")}function hLe(s,t=wu){return t.format(s,"LLLL")}function mLe(s,t=wu){return s<10?t.formatNumber(`0${s.toLocaleString()}`):t.formatNumber(`${s.toLocaleString()}`)}function fLe(){return""}function xLe(s,t,r){return(r??new Ch(t)).format(s,"cccccc")}function tW(s,t=wu){return t.format(s,"yyyy")}const pLe=tW,gLe=Object.freeze(Object.defineProperty({__proto__:null,formatCaption:eW,formatDay:uLe,formatMonthCaption:dLe,formatMonthDropdown:hLe,formatWeekNumber:mLe,formatWeekNumberHeader:fLe,formatWeekdayName:xLe,formatYearCaption:pLe,formatYearDropdown:tW},Symbol.toStringTag,{value:"Module"}));function vLe(s){return s!=null&&s.formatMonthCaption&&!s.formatCaption&&(s.formatCaption=s.formatMonthCaption),s!=null&&s.formatYearCaption&&!s.formatYearDropdown&&(s.formatYearDropdown=s.formatYearCaption),{...gLe,...s}}function yLe(s,t,r,n,a){const{startOfMonth:i,startOfYear:o,endOfYear:l,eachMonthOfInterval:c,getMonth:d}=a;return c({start:o(s),end:l(s)}).map(f=>{const m=n.formatMonthDropdown(f,a),p=d(f),g=t&&f<i(t)||r&&f>i(r)||!1;return{value:p,label:m,disabled:g}})}function jLe(s,t={},r={}){let n={...t==null?void 0:t[Sr.Day]};return Object.entries(s).filter(([,a])=>a===!0).forEach(([a])=>{n={...n,...r==null?void 0:r[a]}}),n}function bLe(s,t,r){const n=s.today(),a=t?s.startOfISOWeek(n):s.startOfWeek(n),i=[];for(let o=0;o<7;o++){const l=s.addDays(a,o);i.push(l)}return i}function NLe(s,t,r,n){if(!s||!t)return;const{startOfYear:a,endOfYear:i,addYears:o,getYear:l,isBefore:c,isSameYear:d}=n,u=a(s),h=i(t),f=[];let m=u;for(;c(m,h)||d(m,h);)f.push(m),m=o(m,1);return f.map(p=>{const g=r.formatYearDropdown(p,n);return{value:l(p),label:g,disabled:!1}})}function sW(s,t,r){return(r??new Ch(t)).format(s,"LLLL y")}const wLe=sW;function SLe(s,t,r,n){let a=(n??new Ch(r)).format(s,"PPPP");return t!=null&&t.today&&(a=`Today, ${a}`),a}function rW(s,t,r,n){let a=(n??new Ch(r)).format(s,"PPPP");return t.today&&(a=`Today, ${a}`),t.selected&&(a=`${a}, selected`),a}const CLe=rW;function ALe(){return""}function ELe(s){return"Choose the Month"}function ILe(s){return"Go to the Next Month"}function PLe(s){return"Go to the Previous Month"}function _Le(s,t,r){return(r??new Ch(t)).format(s,"cccc")}function kLe(s,t){return`Week ${s}`}function TLe(s){return"Week Number"}function DLe(s){return"Choose the Year"}const OLe=Object.freeze(Object.defineProperty({__proto__:null,labelCaption:wLe,labelDay:CLe,labelDayButton:rW,labelGrid:sW,labelGridcell:SLe,labelMonthDropdown:ELe,labelNav:ALe,labelNext:ILe,labelPrevious:PLe,labelWeekNumber:kLe,labelWeekNumberHeader:TLe,labelWeekday:_Le,labelYearDropdown:DLe},Symbol.toStringTag,{value:"Module"})),Ay=s=>s instanceof HTMLElement?s:null,US=s=>[...s.querySelectorAll("[data-animated-month]")??[]],RLe=s=>Ay(s.querySelector("[data-animated-month]")),zS=s=>Ay(s.querySelector("[data-animated-caption]")),qS=s=>Ay(s.querySelector("[data-animated-weeks]")),FLe=s=>Ay(s.querySelector("[data-animated-nav]")),MLe=s=>Ay(s.querySelector("[data-animated-weekdays]"));function LLe(s,t,{classNames:r,months:n,focused:a,dateLib:i}){const o=x.useRef(null),l=x.useRef(n),c=x.useRef(!1);x.useLayoutEffect(()=>{const d=l.current;if(l.current=n,!t||!s.current||!(s.current instanceof HTMLElement)||n.length===0||d.length===0||n.length!==d.length)return;const u=i.isSameMonth(n[0].date,d[0].date),h=i.isAfter(n[0].date,d[0].date),f=h?r[Nc.caption_after_enter]:r[Nc.caption_before_enter],m=h?r[Nc.weeks_after_enter]:r[Nc.weeks_before_enter],p=o.current,g=s.current.cloneNode(!0);if(g instanceof HTMLElement?(US(g).forEach(b=>{if(!(b instanceof HTMLElement))return;const w=RLe(b);w&&b.contains(w)&&b.removeChild(w);const N=zS(b);N&&N.classList.remove(f);const C=qS(b);C&&C.classList.remove(m)}),o.current=g):o.current=null,c.current||u||a)return;const v=p instanceof HTMLElement?US(p):[],y=US(s.current);if(y&&y.every(j=>j instanceof HTMLElement)&&v&&v.every(j=>j instanceof HTMLElement)){c.current=!0,s.current.style.isolation="isolate";const j=FLe(s.current);j&&(j.style.zIndex="1"),y.forEach((b,w)=>{const N=v[w];if(!N)return;b.style.position="relative",b.style.overflow="hidden";const C=zS(b);C&&C.classList.add(f);const S=qS(b);S&&S.classList.add(m);const _=()=>{c.current=!1,s.current&&(s.current.style.isolation=""),j&&(j.style.zIndex=""),C&&C.classList.remove(f),S&&S.classList.remove(m),b.style.position="",b.style.overflow="",b.contains(N)&&b.removeChild(N)};N.style.pointerEvents="none",N.style.position="absolute",N.style.overflow="hidden",N.setAttribute("aria-hidden","true");const k=MLe(N);k&&(k.style.opacity="0");const F=zS(N);F&&(F.classList.add(h?r[Nc.caption_before_exit]:r[Nc.caption_after_exit]),F.addEventListener("animationend",_));const A=qS(N);A&&A.classList.add(h?r[Nc.weeks_before_exit]:r[Nc.weeks_after_exit]),b.insertBefore(N,b.firstChild)})}})}function $Le(s,t,r,n){const a=s[0],i=s[s.length-1],{ISOWeek:o,fixedWeeks:l,broadcastCalendar:c}=r??{},{addDays:d,differenceInCalendarDays:u,differenceInCalendarMonths:h,endOfBroadcastWeek:f,endOfISOWeek:m,endOfMonth:p,endOfWeek:g,isAfter:v,startOfBroadcastWeek:y,startOfISOWeek:j,startOfWeek:b}=n,w=c?y(a,n):o?j(a):b(a),N=c?f(i):o?m(p(i)):g(p(i)),C=u(N,w),S=h(i,a)+1,_=[];for(let A=0;A<=C;A++){const T=d(w,A);if(t&&v(T,t))break;_.push(T)}const F=(c?35:42)*S;if(l&&_.length<F){const A=F-_.length;for(let T=0;T<A;T++){const V=d(_[_.length-1],1);_.push(V)}}return _}function BLe(s){const t=[];return s.reduce((r,n)=>{const a=n.weeks.reduce((i,o)=>[...i,...o.days],t);return[...r,...a]},t)}function ULe(s,t,r,n){const{numberOfMonths:a=1}=r,i=[];for(let o=0;o<a;o++){const l=n.addMonths(s,o);if(t&&l>t)break;i.push(l)}return i}function bR(s,t,r,n){const{month:a,defaultMonth:i,today:o=n.today(),numberOfMonths:l=1}=s;let c=a||i||o;const{differenceInCalendarMonths:d,addMonths:u,startOfMonth:h}=n;if(r&&d(r,c)<l-1){const f=-1*(l-1);c=u(r,f)}return t&&d(c,t)<0&&(c=t),h(c)}function zLe(s,t,r,n){const{addDays:a,endOfBroadcastWeek:i,endOfISOWeek:o,endOfMonth:l,endOfWeek:c,getISOWeek:d,getWeek:u,startOfBroadcastWeek:h,startOfISOWeek:f,startOfWeek:m}=n,p=s.reduce((g,v)=>{const y=r.broadcastCalendar?h(v,n):r.ISOWeek?f(v):m(v),j=r.broadcastCalendar?i(v):r.ISOWeek?o(l(v)):c(l(v)),b=t.filter(S=>S>=y&&S<=j),w=r.broadcastCalendar?35:42;if(r.fixedWeeks&&b.length<w){const S=t.filter(_=>{const k=w-b.length;return _>j&&_<=a(j,k)});b.push(...S)}const N=b.reduce((S,_)=>{const k=r.ISOWeek?d(_):u(_),F=S.find(T=>T.weekNumber===k),A=new GV(_,v,n);return F?F.days.push(A):S.push(new TMe(k,[A])),S},[]),C=new kMe(v,N);return g.push(C),g},[]);return r.reverseMonths?p.reverse():p}function qLe(s,t){let{startMonth:r,endMonth:n}=s;const{startOfYear:a,startOfDay:i,startOfMonth:o,endOfMonth:l,addYears:c,endOfYear:d,newDate:u,today:h}=t,{fromYear:f,toYear:m,fromMonth:p,toMonth:g}=s;!r&&p&&(r=p),!r&&f&&(r=t.newDate(f,0,1)),!n&&g&&(n=g),!n&&m&&(n=u(m,11,31));const v=s.captionLayout==="dropdown"||s.captionLayout==="dropdown-years";return r?r=o(r):f?r=u(f,0,1):!r&&v&&(r=a(c(s.today??h(),-100))),n?n=l(n):m?n=u(m,11,31):!n&&v&&(n=d(s.today??h())),[r&&i(r),n&&i(n)]}function VLe(s,t,r,n){if(r.disableNavigation)return;const{pagedNavigation:a,numberOfMonths:i=1}=r,{startOfMonth:o,addMonths:l,differenceInCalendarMonths:c}=n,d=a?i:1,u=o(s);if(!t)return l(u,d);if(!(c(t,s)<i))return l(u,d)}function WLe(s,t,r,n){if(r.disableNavigation)return;const{pagedNavigation:a,numberOfMonths:i}=r,{startOfMonth:o,addMonths:l,differenceInCalendarMonths:c}=n,d=a?i??1:1,u=o(s);if(!t)return l(u,-d);if(!(c(u,t)<=0))return l(u,-d)}function HLe(s){const t=[];return s.reduce((r,n)=>[...r,...n.weeks],t)}function jw(s,t){const[r,n]=x.useState(s);return[t===void 0?r:t,n]}function GLe(s,t){const[r,n]=qLe(s,t),{startOfMonth:a,endOfMonth:i}=t,o=bR(s,r,n,t),[l,c]=jw(o,s.month?o:void 0);x.useEffect(()=>{const C=bR(s,r,n,t);c(C)},[s.timeZone]);const d=ULe(l,n,s,t),u=$Le(d,s.endMonth?i(s.endMonth):void 0,s,t),h=zLe(d,u,s,t),f=HLe(h),m=BLe(h),p=WLe(l,r,s,t),g=VLe(l,n,s,t),{disableNavigation:v,onMonthChange:y}=s,j=C=>f.some(S=>S.days.some(_=>_.isEqualTo(C))),b=C=>{if(v)return;let S=a(C);r&&S<a(r)&&(S=a(r)),n&&S>a(n)&&(S=a(n)),c(S),y==null||y(S)};return{months:h,weeks:f,days:m,navStart:r,navEnd:n,previousMonth:p,nextMonth:g,goToMonth:b,goToDay:C=>{j(C)||b(C.date)}}}var Yd;(function(s){s[s.Today=0]="Today",s[s.Selected=1]="Selected",s[s.LastFocused=2]="LastFocused",s[s.FocusedModifier=3]="FocusedModifier"})(Yd||(Yd={}));function NR(s){return!s[bi.disabled]&&!s[bi.hidden]&&!s[bi.outside]}function KLe(s,t,r,n){let a,i=-1;for(const o of s){const l=t(o);NR(l)&&(l[bi.focused]&&i<Yd.FocusedModifier?(a=o,i=Yd.FocusedModifier):n!=null&&n.isEqualTo(o)&&i<Yd.LastFocused?(a=o,i=Yd.LastFocused):r(o.date)&&i<Yd.Selected?(a=o,i=Yd.Selected):l[bi.today]&&i<Yd.Today&&(a=o,i=Yd.Today))}return a||(a=s.find(o=>NR(t(o)))),a}function YLe(s,t,r,n,a,i,o){const{ISOWeek:l,broadcastCalendar:c}=i,{addDays:d,addMonths:u,addWeeks:h,addYears:f,endOfBroadcastWeek:m,endOfISOWeek:p,endOfWeek:g,max:v,min:y,startOfBroadcastWeek:j,startOfISOWeek:b,startOfWeek:w}=o;let C={day:d,week:h,month:u,year:f,startOfWeek:S=>c?j(S,o):l?b(S):w(S),endOfWeek:S=>c?m(S):l?p(S):g(S)}[s](r,t==="after"?1:-1);return t==="before"&&n?C=v([n,C]):t==="after"&&a&&(C=y([a,C])),C}function nW(s,t,r,n,a,i,o,l=0){if(l>365)return;const c=YLe(s,t,r.date,n,a,i,o),d=!!(i.disabled&&th(c,i.disabled,o)),u=!!(i.hidden&&th(c,i.hidden,o)),h=c,f=new GV(c,h,o);return!d&&!u?f:nW(s,t,f,n,a,i,o,l+1)}function JLe(s,t,r,n,a){const{autoFocus:i}=s,[o,l]=x.useState(),c=KLe(t.days,r,n||(()=>!1),o),[d,u]=x.useState(i?c:void 0);return{isFocusTarget:g=>!!(c!=null&&c.isEqualTo(g)),setFocused:u,focused:d,blur:()=>{l(d),u(void 0)},moveFocus:(g,v)=>{if(!d)return;const y=nW(g,v,d,t.navStart,t.navEnd,s,a);y&&(t.goToDay(y),u(y))}}}function XLe(s,t){const{selected:r,required:n,onSelect:a}=s,[i,o]=jw(r,a?r:void 0),l=a?r:i,{isSameDay:c}=t,d=m=>(l==null?void 0:l.some(p=>c(p,m)))??!1,{min:u,max:h}=s;return{selected:l,select:(m,p,g)=>{let v=[...l??[]];if(d(m)){if((l==null?void 0:l.length)===u||n&&(l==null?void 0:l.length)===1)return;v=l==null?void 0:l.filter(y=>!c(y,m))}else(l==null?void 0:l.length)===h?v=[m]:v=[...v,m];return a||o(v),a==null||a(v,m,p,g),v},isSelected:d}}function QLe(s,t,r=0,n=0,a=!1,i=wu){const{from:o,to:l}=t||{},{isSameDay:c,isAfter:d,isBefore:u}=i;let h;if(!o&&!l)h={from:s,to:r>0?void 0:s};else if(o&&!l)c(o,s)?a?h={from:o,to:void 0}:h=void 0:u(s,o)?h={from:s,to:o}:h={from:o,to:s};else if(o&&l)if(c(o,s)&&c(l,s))a?h={from:o,to:l}:h=void 0;else if(c(o,s))h={from:o,to:r>0?void 0:s};else if(c(l,s))h={from:s,to:r>0?void 0:s};else if(u(s,o))h={from:s,to:l};else if(d(s,o))h={from:o,to:s};else if(d(s,l))h={from:o,to:s};else throw new Error("Invalid range");if(h!=null&&h.from&&(h!=null&&h.to)){const f=i.differenceInCalendarDays(h.to,h.from);n>0&&f>n?h={from:s,to:void 0}:r>1&&f<r&&(h={from:s,to:void 0})}return h}function ZLe(s,t,r=wu){const n=Array.isArray(t)?t:[t];let a=s.from;const i=r.differenceInCalendarDays(s.to,s.from),o=Math.min(i,6);for(let l=0;l<=o;l++){if(n.includes(a.getDay()))return!0;a=r.addDays(a,1)}return!1}function wR(s,t,r=wu){return eh(s,t.from,!1,r)||eh(s,t.to,!1,r)||eh(t,s.from,!1,r)||eh(t,s.to,!1,r)}function e7e(s,t,r=wu){const n=Array.isArray(t)?t:[t];if(n.filter(l=>typeof l!="function").some(l=>typeof l=="boolean"?l:r.isDate(l)?eh(s,l,!1,r):QV(l,r)?l.some(c=>eh(s,c,!1,r)):zE(l)?l.from&&l.to?wR(s,{from:l.from,to:l.to},r):!1:XV(l)?ZLe(s,l.dayOfWeek,r):KV(l)?r.isAfter(l.before,l.after)?wR(s,{from:r.addDays(l.after,1),to:r.addDays(l.before,-1)},r):th(s.from,l,r)||th(s.to,l,r):YV(l)||JV(l)?th(s.from,l,r)||th(s.to,l,r):!1))return!0;const o=n.filter(l=>typeof l=="function");if(o.length){let l=s.from;const c=r.differenceInCalendarDays(s.to,s.from);for(let d=0;d<=c;d++){if(o.some(u=>u(l)))return!0;l=r.addDays(l,1)}}return!1}function t7e(s,t){const{disabled:r,excludeDisabled:n,selected:a,required:i,onSelect:o}=s,[l,c]=jw(a,o?a:void 0),d=o?a:l;return{selected:d,select:(f,m,p)=>{const{min:g,max:v}=s,y=f?QLe(f,d,g,v,i,t):void 0;return n&&r&&(y!=null&&y.from)&&y.to&&e7e({from:y.from,to:y.to},r,t)&&(y.from=f,y.to=void 0),o||c(y),o==null||o(y,f,m,p),y},isSelected:f=>d&&eh(d,f,!1,t)}}function s7e(s,t){const{selected:r,required:n,onSelect:a}=s,[i,o]=jw(r,a?r:void 0),l=a?r:i,{isSameDay:c}=t;return{selected:l,select:(h,f,m)=>{let p=h;return!n&&l&&l&&c(h,l)&&(p=void 0),a||o(p),a==null||a(p,h,f,m),p},isSelected:h=>l?c(l,h):!1}}function r7e(s,t){const r=s7e(s,t),n=XLe(s,t),a=t7e(s,t);switch(s.mode){case"single":return r;case"multiple":return n;case"range":return a;default:return}}function n7e(s){var fs;let t=s;t.timeZone&&(t={...s},t.today&&(t.today=new ul(t.today,t.timeZone)),t.month&&(t.month=new ul(t.month,t.timeZone)),t.defaultMonth&&(t.defaultMonth=new ul(t.defaultMonth,t.timeZone)),t.startMonth&&(t.startMonth=new ul(t.startMonth,t.timeZone)),t.endMonth&&(t.endMonth=new ul(t.endMonth,t.timeZone)),t.mode==="single"&&t.selected?t.selected=new ul(t.selected,t.timeZone):t.mode==="multiple"&&t.selected?t.selected=(fs=t.selected)==null?void 0:fs.map(zt=>new ul(zt,t.timeZone)):t.mode==="range"&&t.selected&&(t.selected={from:t.selected.from?new ul(t.selected.from,t.timeZone):void 0,to:t.selected.to?new ul(t.selected.to,t.timeZone):void 0}));const{components:r,formatters:n,labels:a,dateLib:i,locale:o,classNames:l}=x.useMemo(()=>{const zt={...j3,...t.locale};return{dateLib:new Ch({locale:zt,weekStartsOn:t.broadcastCalendar?1:t.weekStartsOn,firstWeekContainsDate:t.firstWeekContainsDate,useAdditionalWeekYearTokens:t.useAdditionalWeekYearTokens,useAdditionalDayOfYearTokens:t.useAdditionalDayOfYearTokens,timeZone:t.timeZone,numerals:t.numerals},t.dateLib),components:lLe(t.components),formatters:vLe(t.formatters),labels:{...OLe,...t.labels},locale:zt,classNames:{...qE(),...t.classNames}}},[t.locale,t.broadcastCalendar,t.weekStartsOn,t.firstWeekContainsDate,t.useAdditionalWeekYearTokens,t.useAdditionalDayOfYearTokens,t.timeZone,t.numerals,t.dateLib,t.components,t.formatters,t.labels,t.classNames]),{captionLayout:c,mode:d,navLayout:u,numberOfMonths:h=1,onDayBlur:f,onDayClick:m,onDayFocus:p,onDayKeyDown:g,onDayMouseEnter:v,onDayMouseLeave:y,onNextClick:j,onPrevClick:b,showWeekNumber:w,styles:N}=t,{formatCaption:C,formatDay:S,formatMonthDropdown:_,formatWeekNumber:k,formatWeekNumberHeader:F,formatWeekdayName:A,formatYearDropdown:T}=n,V=GLe(t,i),{days:M,months:G,navStart:L,navEnd:J,previousMonth:z,nextMonth:U,goToMonth:oe}=V,Q=DMe(M,t,L,J,i),{isSelected:P,select:q,selected:D}=r7e(t,i)??{},{blur:se,focused:he,isFocusTarget:be,moveFocus:pe,setFocused:Ae}=JLe(t,V,Q,P??(()=>!1),i),{labelDayButton:Ee,labelGridcell:$e,labelGrid:O,labelMonthDropdown:te,labelNav:re,labelPrevious:le,labelNext:Z,labelWeekday:K,labelWeekNumber:X,labelWeekNumberHeader:ce,labelYearDropdown:Y}=a,ue=x.useMemo(()=>bLe(i,t.ISOWeek),[i,t.ISOWeek]),ve=d!==void 0||m!==void 0,Le=x.useCallback(()=>{z&&(oe(z),b==null||b(z))},[z,oe,b]),Me=x.useCallback(()=>{U&&(oe(U),j==null||j(U))},[oe,U,j]),tt=x.useCallback((zt,St)=>js=>{js.preventDefault(),js.stopPropagation(),Ae(zt),q==null||q(zt.date,St,js),m==null||m(zt.date,St,js)},[q,m,Ae]),fe=x.useCallback((zt,St)=>js=>{Ae(zt),p==null||p(zt.date,St,js)},[p,Ae]),ct=x.useCallback((zt,St)=>js=>{se(),f==null||f(zt.date,St,js)},[se,f]),dt=x.useCallback((zt,St)=>js=>{const et={ArrowLeft:[js.shiftKey?"month":"day",t.dir==="rtl"?"after":"before"],ArrowRight:[js.shiftKey?"month":"day",t.dir==="rtl"?"before":"after"],ArrowDown:[js.shiftKey?"year":"week","after"],ArrowUp:[js.shiftKey?"year":"week","before"],PageUp:[js.shiftKey?"year":"month","before"],PageDown:[js.shiftKey?"year":"month","after"],Home:["startOfWeek","before"],End:["endOfWeek","after"]};if(et[js.key]){js.preventDefault(),js.stopPropagation();const[lt,Fe]=et[js.key];pe(lt,Fe)}g==null||g(zt.date,St,js)},[pe,g,t.dir]),pt=x.useCallback((zt,St)=>js=>{v==null||v(zt.date,St,js)},[v]),qe=x.useCallback((zt,St)=>js=>{y==null||y(zt.date,St,js)},[y]),mt=x.useCallback(zt=>St=>{const js=Number(St.target.value),et=i.setMonth(i.startOfMonth(zt),js);oe(et)},[i,oe]),Rt=x.useCallback(zt=>St=>{const js=Number(St.target.value),et=i.setYear(i.startOfMonth(zt),js);oe(et)},[i,oe]),{className:_e,style:Xe}=x.useMemo(()=>({className:[l[Sr.Root],t.className].filter(Boolean).join(" "),style:{...N==null?void 0:N[Sr.Root],...t.style}}),[l,t.className,t.style,N]),At=cLe(t),st=x.useRef(null);LLe(st,!!t.animate,{classNames:l,months:G,focused:he,dateLib:i});const $t={dayPickerProps:t,selected:D,select:q,isSelected:P,months:G,nextMonth:U,previousMonth:z,goToMonth:oe,getModifiers:Q,components:r,classNames:l,styles:N,labels:a,formatters:n};return xe.createElement(ZV.Provider,{value:$t},xe.createElement(r.Root,{rootRef:t.animate?st:void 0,className:_e,style:Xe,dir:t.dir,id:t.id,lang:t.lang,nonce:t.nonce,title:t.title,role:t.role,"aria-label":t["aria-label"],...At},xe.createElement(r.Months,{className:l[Sr.Months],style:N==null?void 0:N[Sr.Months]},!t.hideNavigation&&!u&&xe.createElement(r.Nav,{"data-animated-nav":t.animate?"true":void 0,className:l[Sr.Nav],style:N==null?void 0:N[Sr.Nav],"aria-label":re(),onPreviousClick:Le,onNextClick:Me,previousMonth:z,nextMonth:U}),G.map((zt,St)=>{const js=yLe(zt.date,L,J,n,i),et=NLe(L,J,n,i);return xe.createElement(r.Month,{"data-animated-month":t.animate?"true":void 0,className:l[Sr.Month],style:N==null?void 0:N[Sr.Month],key:St,displayIndex:St,calendarMonth:zt},u==="around"&&!t.hideNavigation&&St===0&&xe.createElement(r.PreviousMonthButton,{type:"button",className:l[Sr.PreviousMonthButton],tabIndex:z?void 0:-1,"aria-disabled":z?void 0:!0,"aria-label":le(z),onClick:Le,"data-animated-button":t.animate?"true":void 0},xe.createElement(r.Chevron,{disabled:z?void 0:!0,className:l[Sr.Chevron],orientation:t.dir==="rtl"?"right":"left"})),xe.createElement(r.MonthCaption,{"data-animated-caption":t.animate?"true":void 0,className:l[Sr.MonthCaption],style:N==null?void 0:N[Sr.MonthCaption],calendarMonth:zt,displayIndex:St},c!=null&&c.startsWith("dropdown")?xe.createElement(r.DropdownNav,{className:l[Sr.Dropdowns],style:N==null?void 0:N[Sr.Dropdowns]},c==="dropdown"||c==="dropdown-months"?xe.createElement(r.MonthsDropdown,{className:l[Sr.MonthsDropdown],"aria-label":te(),classNames:l,components:r,disabled:!!t.disableNavigation,onChange:mt(zt.date),options:js,style:N==null?void 0:N[Sr.Dropdown],value:i.getMonth(zt.date)}):xe.createElement("span",null,_(zt.date,i)),c==="dropdown"||c==="dropdown-years"?xe.createElement(r.YearsDropdown,{className:l[Sr.YearsDropdown],"aria-label":Y(i.options),classNames:l,components:r,disabled:!!t.disableNavigation,onChange:Rt(zt.date),options:et,style:N==null?void 0:N[Sr.Dropdown],value:i.getYear(zt.date)}):xe.createElement("span",null,T(zt.date,i)),xe.createElement("span",{role:"status","aria-live":"polite",style:{border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"}},C(zt.date,i.options,i))):xe.createElement(r.CaptionLabel,{className:l[Sr.CaptionLabel],role:"status","aria-live":"polite"},C(zt.date,i.options,i))),u==="around"&&!t.hideNavigation&&St===h-1&&xe.createElement(r.NextMonthButton,{type:"button",className:l[Sr.NextMonthButton],tabIndex:U?void 0:-1,"aria-disabled":U?void 0:!0,"aria-label":Z(U),onClick:Me,"data-animated-button":t.animate?"true":void 0},xe.createElement(r.Chevron,{disabled:U?void 0:!0,className:l[Sr.Chevron],orientation:t.dir==="rtl"?"left":"right"})),St===h-1&&u==="after"&&!t.hideNavigation&&xe.createElement(r.Nav,{"data-animated-nav":t.animate?"true":void 0,className:l[Sr.Nav],style:N==null?void 0:N[Sr.Nav],"aria-label":re(),onPreviousClick:Le,onNextClick:Me,previousMonth:z,nextMonth:U}),xe.createElement(r.MonthGrid,{role:"grid","aria-multiselectable":d==="multiple"||d==="range","aria-label":O(zt.date,i.options,i)||void 0,className:l[Sr.MonthGrid],style:N==null?void 0:N[Sr.MonthGrid]},!t.hideWeekdays&&xe.createElement(r.Weekdays,{"data-animated-weekdays":t.animate?"true":void 0,className:l[Sr.Weekdays],style:N==null?void 0:N[Sr.Weekdays]},w&&xe.createElement(r.WeekNumberHeader,{"aria-label":ce(i.options),className:l[Sr.WeekNumberHeader],style:N==null?void 0:N[Sr.WeekNumberHeader],scope:"col"},F()),ue.map((lt,Fe)=>xe.createElement(r.Weekday,{"aria-label":K(lt,i.options,i),className:l[Sr.Weekday],key:Fe,style:N==null?void 0:N[Sr.Weekday],scope:"col"},A(lt,i.options,i)))),xe.createElement(r.Weeks,{"data-animated-weeks":t.animate?"true":void 0,className:l[Sr.Weeks],style:N==null?void 0:N[Sr.Weeks]},zt.weeks.map((lt,Fe)=>xe.createElement(r.Week,{className:l[Sr.Week],key:lt.weekNumber,style:N==null?void 0:N[Sr.Week],week:lt},w&&xe.createElement(r.WeekNumber,{week:lt,style:N==null?void 0:N[Sr.WeekNumber],"aria-label":X(lt.weekNumber,{locale:o}),className:l[Sr.WeekNumber],scope:"row",role:"rowheader"},k(lt.weekNumber,i)),lt.days.map(ft=>{const{date:He}=ft,Je=Q(ft);if(Je[bi.focused]=!Je.hidden&&!!(he!=null&&he.isEqualTo(ft)),Je[_d.selected]=(P==null?void 0:P(He))||Je.selected,zE(D)){const{from:As,to:Ht}=D;Je[_d.range_start]=!!(As&&Ht&&i.isSameDay(He,As)),Je[_d.range_end]=!!(As&&Ht&&i.isSameDay(He,Ht)),Je[_d.range_middle]=eh(D,He,!0,i)}const It=jLe(Je,N,t.modifiersStyles),Gt=OMe(Je,l,t.modifiersClassNames),qt=!ve&&!Je.hidden?$e(He,Je,i.options,i):void 0;return xe.createElement(r.Day,{key:`${i.format(He,"yyyy-MM-dd")}_${i.format(ft.displayMonth,"yyyy-MM")}`,day:ft,modifiers:Je,className:Gt.join(" "),style:It,role:"gridcell","aria-selected":Je.selected||void 0,"aria-label":qt,"data-day":i.format(He,"yyyy-MM-dd"),"data-month":ft.outside?i.format(He,"yyyy-MM"):void 0,"data-selected":Je.selected||void 0,"data-disabled":Je.disabled||void 0,"data-hidden":Je.hidden||void 0,"data-outside":ft.outside||void 0,"data-focused":Je.focused||void 0,"data-today":Je.today||void 0},!Je.hidden&&ve?xe.createElement(r.DayButton,{className:l[Sr.DayButton],style:N==null?void 0:N[Sr.DayButton],type:"button",day:ft,modifiers:Je,disabled:Je.disabled||void 0,tabIndex:be(ft)?0:-1,"aria-label":Ee(He,Je,i.options,i),onClick:tt(ft,Je),onBlur:ct(ft,Je),onFocus:fe(ft,Je),onKeyDown:dt(ft,Je),onMouseEnter:pt(ft,Je),onMouseLeave:qe(ft,Je)},S(He,i.options,i)):!Je.hidden&&S(ft.date,i.options,i))}))))))})),t.footer&&xe.createElement(r.Footer,{className:l[Sr.Footer],style:N==null?void 0:N[Sr.Footer],role:"status","aria-live":"polite"},t.footer)))}function SR({className:s,classNames:t,showOutsideDays:r=!0,captionLayout:n="label",buttonVariant:a="ghost",formatters:i,components:o,...l}){const c=qE();return e.jsx(n7e,{showOutsideDays:r,className:ns("bg-background group/calendar p-3 [--cell-size:--spacing(8)] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,s),captionLayout:n,formatters:{formatMonthDropdown:d=>d.toLocaleString("default",{month:"short"}),...i},classNames:{root:ns("w-fit",c.root),months:ns("flex gap-4 flex-col md:flex-row relative",c.months),month:ns("flex flex-col w-full gap-4",c.month),nav:ns("flex items-center gap-1 w-full absolute top-0 inset-x-0 justify-between",c.nav),button_previous:ns(rv({variant:a}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",c.button_previous),button_next:ns(rv({variant:a}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",c.button_next),month_caption:ns("flex items-center justify-center h-(--cell-size) w-full px-(--cell-size)",c.month_caption),dropdowns:ns("w-full flex items-center text-sm font-medium justify-center h-(--cell-size) gap-1.5",c.dropdowns),dropdown_root:ns("relative has-focus:border-ring border border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] rounded-md",c.dropdown_root),dropdown:ns("absolute bg-popover inset-0 opacity-0",c.dropdown),caption_label:ns("select-none font-medium",n==="label"?"text-sm":"rounded-md pl-2 pr-1 flex items-center gap-1 text-sm h-8 [&>svg]:text-muted-foreground [&>svg]:size-3.5",c.caption_label),table:"w-full border-collapse",weekdays:ns("flex",c.weekdays),weekday:ns("text-muted-foreground rounded-md flex-1 font-normal text-[0.8rem] select-none",c.weekday),week:ns("flex w-full mt-2",c.week),week_number_header:ns("select-none w-(--cell-size)",c.week_number_header),week_number:ns("text-[0.8rem] select-none text-muted-foreground",c.week_number),day:ns("relative w-full h-full p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md group/day aspect-square select-none",c.day),range_start:ns("rounded-l-md bg-accent",c.range_start),range_middle:ns("rounded-none",c.range_middle),range_end:ns("rounded-r-md bg-accent",c.range_end),today:ns("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",c.today),outside:ns("text-muted-foreground aria-selected:text-muted-foreground",c.outside),disabled:ns("text-muted-foreground opacity-50",c.disabled),hidden:ns("invisible",c.hidden),...t},components:{Root:({className:d,rootRef:u,...h})=>e.jsx("div",{"data-slot":"calendar",ref:u,className:ns(d),...h}),Chevron:({className:d,orientation:u,...h})=>u==="left"?e.jsx(tN,{className:ns("size-4",d),...h}):u==="right"?e.jsx(Tm,{className:ns("size-4",d),...h}):e.jsx(tc,{className:ns("size-4",d),...h}),DayButton:a7e,WeekNumber:({children:d,...u})=>e.jsx("td",{...u,children:e.jsx("div",{className:"flex size-(--cell-size) items-center justify-center text-center",children:d})}),...o},...l})}function a7e({className:s,day:t,modifiers:r,...n}){const a=qE(),i=x.useRef(null);return x.useEffect(()=>{var o;r.focused&&((o=i.current)==null||o.focus())},[r.focused]),e.jsx(I,{ref:i,variant:"ghost",size:"icon","data-day":t.date.toLocaleDateString(),"data-selected-single":r.selected&&!r.range_start&&!r.range_end&&!r.range_middle,"data-range-start":r.range_start,"data-range-end":r.range_end,"data-range-middle":r.range_middle,className:ns("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 dark:hover:text-accent-foreground flex aspect-square size-auto w-full min-w-(--cell-size) flex-col gap-1 leading-none font-normal group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] data-[range-end=true]:rounded-md data-[range-end=true]:rounded-r-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md data-[range-start=true]:rounded-l-md [&>span]:text-xs [&>span]:opacity-70",a.day,s),...n})}const i7e=[{id:"office_expense",title:"Office Expense",description:"Standard office expense with accounts payable",lines:[{accountId:"5000",accountName:"Office Expenses",debit:500,credit:0,memo:"Office supplies purchase"},{accountId:"2100",accountName:"Accounts Payable",debit:0,credit:500,memo:"Amount owed to supplier"}]},{id:"revenue_recognition",title:"Revenue Recognition",description:"Record revenue with accounts receivable",lines:[{accountId:"1120",accountName:"Accounts Receivable",debit:1e3,credit:0,memo:"Customer invoice"},{accountId:"3000",accountName:"Revenue",debit:0,credit:1e3,memo:"Service revenue earned"}]},{id:"depreciation",title:"Depreciation",description:"Monthly depreciation adjustment",lines:[{accountId:"5300",accountName:"Depreciation Expense",debit:250,credit:0,memo:"Depreciation expense"},{accountId:"1400",accountName:"Accumulated Depreciation",debit:0,credit:250,memo:"Accumulated depreciation"}]},{id:"accrual",title:"Accrual",description:"Expense accrual entry",lines:[{accountId:"5200",accountName:"Utilities Expense",debit:300,credit:0,memo:"Accrued utility expense"},{accountId:"2200",accountName:"Accrued Expenses",debit:0,credit:300,memo:"Accrued expenses payable"}]},{id:"inventory",title:"Inventory Adjustment",description:"Adjust inventory levels and COGS",lines:[{accountId:"6000",accountName:"Cost of Goods Sold",debit:750,credit:0,memo:"Cost of goods sold"},{accountId:"1200",accountName:"Inventory",debit:0,credit:750,memo:"Inventory reduction"}]},{id:"payment",title:"Payment Entry",description:"Record payment to supplier",lines:[{accountId:"2100",accountName:"Accounts Payable",debit:1200,credit:0,memo:"Accounts payable payment"},{accountId:"1110",accountName:"Cash",debit:0,credit:1200,memo:"Cash payment"}]},{id:"bank_loan",title:"Bank Loan Received",description:"Receive bank loan (increases liabilities)",lines:[{accountId:"1110",accountName:"Cash",debit:1e4,credit:0,memo:"Loan proceeds received"},{accountId:"2101",accountName:"Bank Loan",debit:0,credit:1e4,memo:"Bank loan liability"}]},{id:"equipment_credit",title:"Equipment Purchase on Credit",description:"Buy equipment on account (increases liabilities)",lines:[{accountId:"1300",accountName:"Equipment",debit:5e3,credit:0,memo:"Equipment purchase"},{accountId:"2100",accountName:"Accounts Payable",debit:0,credit:5e3,memo:"Amount owed to supplier"}]},{id:"customer_prepayment",title:"Customer Prepayment",description:"Customer pays in advance (unearned revenue)",lines:[{accountId:"1110",accountName:"Cash",debit:2e3,credit:0,memo:"Customer advance payment"},{accountId:"2104",accountName:"Unearned Revenue",debit:0,credit:2e3,memo:"Unearned revenue liability"}]},{id:"rent_accrual",title:"Accrue Monthly Rent",description:"Accrue rent expense (increases liabilities)",lines:[{accountId:"5001",accountName:"Rent Expense",debit:1500,credit:0,memo:"Monthly rent expense"},{accountId:"2103",accountName:"Accrued Expenses",debit:0,credit:1500,memo:"Accrued rent payable"}]},{id:"credit_card_purchase",title:"Credit Card Purchase",description:"Make purchase with credit card",lines:[{accountId:"5000",accountName:"Office Expenses",debit:300,credit:0,memo:"Office supplies on credit card"},{accountId:"2102",accountName:"Credit Card Payable",debit:0,credit:300,memo:"Credit card liability"}]}];function o7e(){const s=id(),[t]=j5(),[r]=x.useState(()=>typeof window<"u"&&(localStorage.getItem("company_id")||localStorage.getItem("companyId")||localStorage.getItem("company"))||""),[n,a]=x.useState(new Date),[i,o]=x.useState(new Date),[l,c]=x.useState(""),[d,u]=x.useState(""),[h,f]=x.useState("GENERAL"),[m,p]=x.useState("JE-2025-001"),[g,v]=x.useState([{id:"1",accountId:"",accountName:"",debit:0,credit:0,memo:""},{id:"2",accountId:"",accountName:"",debit:0,credit:0,memo:""}]),[y,j]=x.useState(!1),[b,w]=x.useState([]),[N,C]=x.useState(!0),[S,_]=x.useState([]),[k,F]=x.useState(!1),[A,T]=x.useState(!1),[V,M]=x.useState([]),[G,L]=x.useState([]),[J,z]=x.useState(""),U=x.useRef(3);x.useEffect(()=>{oe(),P(),q(),t.get("success")==="entry-created"&&(z("Journal entry created successfully!"),setTimeout(()=>z(""),5e3))},[g,t]);const oe=async()=>{C(!0);try{await Q();const ce=await de.get(`/api/accounts?companyId=${r}`);console.log("Loaded accounts:",ce);let Y=[];ce!=null&&ce.flat?Y=ce.flat:ce!=null&&ce.data?Y=ce.data:Array.isArray(ce)&&(Y=ce),Y&&Y.length>0?w(Y):(console.log("No accounts found, using fallback"),w([]))}catch(ce){console.error("Failed to load accounts:",ce),w([]),M(["Failed to load accounts. Please check your connection."])}finally{C(!1)}},Q=async()=>{var ce,Y;try{const ue=[{code:"ASSET",name:"Asset"},{code:"LIABILITY",name:"Liability"},{code:"REVENUE",name:"Revenue"},{code:"EXPENSE",name:"Expense"}],ve={};for(const Me of ue)try{const fe=(await de.get(`/api/account-types?companyId=${r}`)).find(ct=>ct.code===Me.code);if(fe)ve[Me.code]=fe.id;else{const ct=await de.post("/api/account-types",{...Me,companyId:r});ve[Me.code]=ct.id}}catch(tt){console.log(`Account type ${Me.name} creation failed:`,tt)}const Le=[{name:"Cash",code:"1110",typeCode:"ASSET"},{name:"Accounts Receivable",code:"1120",typeCode:"ASSET"},{name:"Equipment",code:"1300",typeCode:"ASSET"},{name:"Accounts Payable",code:"2100",typeCode:"LIABILITY"},{name:"Bank Loan",code:"2101",typeCode:"LIABILITY"},{name:"Credit Card Payable",code:"2102",typeCode:"LIABILITY"},{name:"Accrued Expenses",code:"2103",typeCode:"LIABILITY"},{name:"Unearned Revenue",code:"2104",typeCode:"LIABILITY"},{name:"Owner Equity",code:"3000",typeCode:"EQUITY"},{name:"Sales Revenue",code:"4000",typeCode:"REVENUE"},{name:"Office Expenses",code:"5000",typeCode:"EXPENSE"},{name:"Rent Expense",code:"5001",typeCode:"EXPENSE"}];for(const Me of Le)try{const tt=await de.get(`/api/accounts?companyId=${r}`);!(((ce=tt==null?void 0:tt.flat)==null?void 0:ce.find(ct=>ct.code===Me.code))||((Y=tt==null?void 0:tt.data)==null?void 0:Y.find(ct=>ct.code===Me.code)))&&ve[Me.typeCode]&&(await de.post("/api/accounts",{name:Me.name,code:Me.code,typeId:ve[Me.typeCode],companyId:r}),console.log(`Created account: ${Me.name}`))}catch(tt){console.log(`Account ${Me.name} creation failed:`,tt)}}catch(ue){console.error("Failed to create basic accounts:",ue)}},P=async()=>{F(!0);try{const ce=await de.get(`/api/journal?companyId=${r}&page=1&pageSize=5`);console.log("Loaded recent entries:",ce);let Y=[];if(ce!=null&&ce.entries?Y=ce.entries:ce!=null&&ce.data?Y=ce.data:Array.isArray(ce)&&(Y=ce),Y&&Y.length>0){const ue=Y.map(ve=>{var fe,ct;const Le=((fe=ve.lines)==null?void 0:fe.reduce((dt,pt)=>dt+(Number(pt.debit)||0)+(Number(pt.credit)||0),0))||0,Me=ve.id?ve.id.substring(0,8).toUpperCase():"N/A",tt=ve.reference||`JE-${Me}`||`JE-${(ct=ve.id)==null?void 0:ct.substring(0,8)}`;return{id:ve.id,description:ve.memo||ve.description||"Journal Entry",amount:Number(Le)||0,date:ve.date?new Date(ve.date).toISOString().split("T")[0]:ve.createdAt?new Date(ve.createdAt).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],status:ve.status||"Posted",entryNumber:tt,lines:ve.lines||[]}});_(ue)}else _([])}catch(ce){console.error("Failed to load recent entries:",ce),_([])}finally{F(!1)}},q=()=>{const ce=g.reduce((Le,Me)=>Le+(Me.debit||0),0),Y=g.reduce((Le,Me)=>Le+(Me.credit||0),0),ue=ce-Y,ve=[];Math.abs(ue)>.01&&(ue>0?(ve.push("The debit entry suggests an expense transaction. Consider adding a credit to Accounts Payable (2100) to balance the entry."),ve.push(`Based on similar transactions, credit amount should be $${ue.toFixed(2)} to Accounts Payable.`)):ve.push("The credit entry needs a corresponding debit. Consider adding a debit to complete the transaction.")),L(ve)},D=ce=>{c(ce.description||""),z(`Copied details from ${ce.entryNumber}`),setTimeout(()=>z(""),3e3)},se=()=>{const ce=[];l.trim()||ce.push("Please add a description for this transaction");const Y=g.reduce((Le,Me)=>Le+(Me.debit||0),0),ue=g.reduce((Le,Me)=>Le+(Me.credit||0),0);return Math.abs(Y-ue)>.01&&ce.push(`Debits ($${Y.toFixed(2)}) must equal Credits ($${ue.toFixed(2)})`),Y===0&&ue===0&&ce.push("Please enter some amounts for the transaction"),g.filter(Le=>!Le.accountId).length>0&&ce.push("Please select accounts for all transaction lines"),ce},he=(ce,Y)=>{v(ue=>ue.map(ve=>ve.id===ce?{...ve,...Y}:ve)),V.length>0&&M([])},be=()=>{const ce={id:U.current.toString(),accountId:"",debit:0,credit:0,memo:""};v(Y=>[...Y,ce]),U.current++},pe=ce=>{g.length>2&&v(Y=>Y.filter(ue=>ue.id!==ce))},Ae=ce=>{const Y=g.find(ue=>ue.id===ce);if(Y){const ue={...Y,id:U.current.toString(),debit:0,credit:0,memo:""};v(ve=>{const Le=ve.findIndex(Me=>Me.id===ce);return[...ve.slice(0,Le+1),ue,...ve.slice(Le+1)]}),U.current++}},Ee=ce=>{const Y=ce.lines.map((ue,ve)=>{const Le=b.find(Me=>Me.code===ue.accountId||Me.name===ue.accountName);return{id:(ve+1).toString(),accountId:(Le==null?void 0:Le.id)||ue.accountId,accountName:(Le==null?void 0:Le.name)||ue.accountName,debit:ue.debit,credit:ue.credit,memo:ue.memo}});v(Y),c(ce.title),T(!1),U.current=Y.length+1},$e=()=>{const ce=g.reduce((ve,Le)=>ve+(Le.debit||0),0),Y=g.reduce((ve,Le)=>ve+(Le.credit||0),0),ue=ce-Y;if(Math.abs(ue)>.01){const ve=g.find(Le=>!Le.debit&&!Le.credit);ve&&(ue>0?he(ve.id,{credit:ue}):he(ve.id,{debit:Math.abs(ue)}))}},O=()=>{const ce=g.reduce((ve,Le)=>ve+(Le.debit||0),0),Y=g.reduce((ve,Le)=>ve+(Le.credit||0),0),ue=ce-Y;if(Math.abs(ue)>.01){const ve=g.find(Le=>!Le.debit&&!Le.credit);ve&&he(ve.id,{accountId:"2100",accountName:"Accounts Payable",credit:ue,memo:"Auto-balanced by AI suggestion"})}},te=async()=>{var Y;const ce=se();if(ce.length>0){M(ce);return}M([]),j(!0);try{const ue=g.filter(Me=>Me.accountId&&Me.accountId.trim()!==""&&(Me.debit&&Me.debit>0||Me.credit&&Me.credit>0));if(ue.length<2){M(["Please add at least 2 journal entry lines with valid accounts and amounts"]),j(!1);return}const ve={date:Kn(n,"yyyy-MM-dd"),memo:l,reference:d,companyId:r,lines:ue.map(Me=>({accountId:Me.accountId,debit:Me.debit||void 0,credit:Me.credit||void 0,memo:Me.memo||void 0}))};console.log("Posting journal entry:",ve);const Le=await de.postJournalEntry(ve);console.log("Journal entry created successfully:",Le),P(),window.dispatchEvent(new CustomEvent("journalEntryCreated",{detail:{entryId:Le.id,companyId:r}})),s("/dashboard/journal/new?success=entry-created")}catch(ue){console.error("Error creating journal entry:",ue);const ve=ue.message||((Y=ue.error)==null?void 0:Y.message)||"Failed to create journal entry. Please try again.";M([ve])}finally{j(!1)}},re=async()=>{j(!0);try{console.log("Saving draft...")}catch(ce){M([ce.message||"Failed to save draft. Please try again."])}finally{j(!1)}},le=()=>g.reduce((ce,Y)=>ce+(Y.debit||0),0),Z=()=>g.reduce((ce,Y)=>ce+(Y.credit||0),0),K=()=>Math.abs(le()-Z())<.01,X=()=>Math.abs(le()-Z());return e.jsx(Kr,{children:e.jsxs("div",{className:"space-y-6",children:[J&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"font-semibold text-green-800",children:J})]})}),V.length>0&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Is,{className:"w-5 h-5 text-red-600"}),e.jsx("h3",{className:"font-semibold text-red-800",children:"Please fix the following errors:"})]}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:V.map((ce,Y)=>e.jsx("li",{className:"text-red-700 text-sm",children:ce},Y))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(lh,{className:"w-6 h-6"}),"Journal Entries"]}),e.jsx("nav",{className:"text-sm text-gray-500 mt-1",children:"Accounting / Journal Entries / New Entry"})]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(ts,{open:A,onOpenChange:T,children:[e.jsx(ki,{asChild:!0,children:e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(cY,{className:"w-4 h-4 mr-2"}),"Templates"]})}),e.jsxs(ss,{className:"max-w-4xl",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Journal Entry Templates"}),e.jsx(Ks,{children:"Choose a template to quickly create common journal entries"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-4",children:i7e.map(ce=>e.jsx(ne,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>Ee(ce),children:e.jsxs(we,{className:"pb-3",children:[e.jsx(Se,{className:"text-base",children:ce.title}),e.jsx(Vt,{className:"text-sm",children:ce.description})]})},ce.id))})]})]}),e.jsxs(ts,{children:[e.jsx(ki,{asChild:!0,children:e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(tM,{className:"w-4 h-4 mr-2"}),"Recent"]})}),e.jsxs(ss,{className:"max-w-4xl",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Recent Journal Entries"}),e.jsx(Ks,{children:"View and copy from your recent journal entries"})]}),e.jsx("div",{className:"mt-4 max-h-96 overflow-y-auto",children:k?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 animate-spin rounded-full border-2 border-gray-300 border-t-blue-600"}),"Loading recent entries..."]})}):S.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No recent entries found"}):e.jsx("div",{className:"space-y-3",children:S.map(ce=>e.jsx(ne,{className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>D(ce),children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium truncate",title:ce.entryNumber,children:ce.entryNumber.length>15?`${ce.entryNumber.substring(0,15)}...`:ce.entryNumber}),e.jsx(Oe,{variant:"outline",className:"text-xs flex-shrink-0",children:ce.status})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1 truncate",children:ce.description}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(ce.date).toLocaleDateString()})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsxs("span",{className:"font-semibold",children:["$",(Number(ce.amount)||0).toFixed(2)]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Click to copy"})]})]})})},ce.id))})})]})]}),e.jsxs(I,{variant:"outline",size:"lg",onClick:re,disabled:y,children:[e.jsx(Od,{className:"w-4 h-4 mr-2"}),y?"Saving...":"Save Draft"]}),e.jsx(I,{size:"lg",onClick:te,disabled:y||!K(),children:y?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 mr-2 animate-spin rounded-full border-2 border-white border-t-transparent"}),"Posting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(h6,{className:"w-4 h-4 mr-2"}),"Post Entry"]})})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Zt,{className:"w-5 h-5"}),"Entry Information"]})}),e.jsxs(ie,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"entryNumber",children:"Journal Entry Number"}),e.jsx(ge,{id:"entryNumber",value:m,onChange:ce=>p(ce.target.value),readOnly:!0,className:"bg-gray-50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"entryType",children:"Entry Type"}),e.jsxs(rt,{value:h,onValueChange:f,children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"GENERAL",children:"General Journal"}),e.jsx(W,{value:"ADJUSTING",children:"Adjusting Entry"}),e.jsx(W,{value:"CLOSING",children:"Closing Entry"}),e.jsx(W,{value:"REVERSING",children:"Reversing Entry"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"transactionDate",children:"Transaction Date"}),e.jsxs(CC,{children:[e.jsx(AC,{asChild:!0,children:e.jsxs(I,{variant:"outline",className:ns("w-full justify-start text-left font-normal",!n&&"text-muted-foreground"),children:[e.jsx(Qj,{className:"mr-2 h-4 w-4"}),n?Kn(n,"MMM dd, yyyy"):"Pick a date"]})}),e.jsx(EC,{className:"w-auto p-0",align:"start",children:e.jsx(SR,{mode:"single",selected:n,onSelect:ce=>ce&&a(ce),initialFocus:!0})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"postingDate",children:"Posting Date"}),e.jsxs(CC,{children:[e.jsx(AC,{asChild:!0,children:e.jsxs(I,{variant:"outline",className:ns("w-full justify-start text-left font-normal",!i&&"text-muted-foreground"),children:[e.jsx(Qj,{className:"mr-2 h-4 w-4"}),i?Kn(i,"MMM dd, yyyy"):"Pick a date"]})}),e.jsx(EC,{className:"w-auto p-0",align:"start",children:e.jsx(SR,{mode:"single",selected:i,onSelect:ce=>ce&&o(ce),initialFocus:!0})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"reference",children:"Reference Number"}),e.jsx(ge,{id:"reference",placeholder:"External reference",value:d,onChange:ce=>u(ce.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Status"}),e.jsxs(Oe,{variant:"outline",className:"bg-yellow-50 text-yellow-700 border-yellow-200",children:[e.jsx(Zt,{className:"w-3 h-3 mr-1"}),"Draft"]})]})]}),e.jsxs("div",{className:"mt-6 space-y-2",children:[e.jsx(B,{htmlFor:"description",children:"Description"}),e.jsx(ge,{id:"description",placeholder:"Enter journal entry description",value:l,onChange:ce=>c(ce.target.value)})]})]})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Zt,{className:"w-5 h-5"}),"Journal Entry Lines"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:ns("flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium",K()?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"),children:[K()?e.jsx(bs,{className:"w-4 h-4"}):e.jsx(Is,{className:"w-4 h-4"}),K()?"Balanced":`Out of Balance: $${X().toFixed(2)}`]}),e.jsxs(I,{size:"sm",onClick:$e,children:[e.jsx(Np,{className:"w-4 h-4 mr-2"}),"Auto Balance"]})]})]})}),e.jsxs(ie,{className:"p-0",children:[e.jsx("div",{className:"overflow-x-auto max-w-full",children:e.jsxs("table",{className:"w-full min-w-[800px]",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-12",children:"#"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[280px]",children:"Account"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[200px]",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[120px]",children:"Debit"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[120px]",children:"Credit"}),e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider w-32",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:g.map((ce,Y)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-500 text-center",children:Y+1}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs(rt,{value:ce.accountId,onValueChange:ue=>{var Le;const ve=b.find(Me=>Me.id===ue);he(ce.id,{accountId:ue,accountName:ve==null?void 0:ve.name,accountType:typeof(ve==null?void 0:ve.type)=="string"?ve.type:(Le=ve==null?void 0:ve.type)==null?void 0:Le.name})},children:[e.jsx(nt,{className:"w-full",children:e.jsx(it,{placeholder:"Select Account"})}),e.jsx(at,{children:N?e.jsx(W,{value:"loading",disabled:!0,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 animate-spin rounded-full border-2 border-gray-300 border-t-blue-600"}),"Loading accounts..."]})}):b.length===0?e.jsx(W,{value:"no-accounts",disabled:!0,children:"No accounts available"}):b.map(ue=>{var ve;return e.jsx(W,{value:ue.id,children:e.jsx("div",{className:"flex items-center justify-between w-full",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:ue.name}),e.jsxs("span",{className:"text-xs text-gray-500",children:[typeof ue.type=="string"?ue.type:(ve=ue.type)==null?void 0:ve.name," - ",ue.code]})]})})},ue.id)})})]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ge,{placeholder:"Line description",value:ce.memo||"",onChange:ue=>he(ce.id,{memo:ue.target.value}),className:"w-full"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ge,{type:"number",step:"0.01",min:"0",placeholder:"0.00",value:ce.debit||"",onChange:ue=>he(ce.id,{debit:ue.target.value?Number(ue.target.value):0,credit:0}),className:"text-right font-mono"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(ge,{type:"number",step:"0.01",min:"0",placeholder:"0.00",value:ce.credit||"",onChange:ue=>he(ce.id,{credit:ue.target.value?Number(ue.target.value):0,debit:0}),className:"text-right font-mono"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>Ae(ce.id),className:"h-8 w-8 p-0",children:e.jsx(ac,{className:"h-4 w-4"})}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>pe(ce.id),className:"h-8 w-8 p-0 text-red-600 hover:text-red-700",disabled:g.length<=2,children:e.jsx(hn,{className:"h-4 w-4"})})]})})]},ce.id))})]})}),e.jsx("div",{className:"p-4 border-t border-gray-200",children:e.jsxs(I,{variant:"outline",onClick:be,className:"w-full border-dashed border-2 border-gray-300 hover:border-primary-400 hover:bg-primary-50",children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Add New Line"]})})]})]}),e.jsx(ne,{children:e.jsx(ie,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-gray-200",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total Debits:"}),e.jsxs("span",{className:"font-mono font-medium text-green-600",children:["$",le().toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-gray-200",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total Credits:"}),e.jsxs("span",{className:"font-mono font-medium text-red-600",children:["$",Z().toFixed(2)]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center py-3 border-b border-gray-200",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Difference:"}),e.jsxs("span",{className:ns("font-mono font-medium",K()?"text-green-600":"text-red-600"),children:["$",X().toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center py-3",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Status:"}),e.jsx("span",{className:ns("font-medium",K()?"text-green-600":"text-red-600"),children:K()?"Balanced":"Unbalanced"})]})]})]})})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ne,{className:"bg-gradient-to-br from-purple-600 to-blue-600 text-white",children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2 text-white",children:[e.jsx(jp,{className:"w-5 h-5"}),"AI Assistant"]})}),e.jsxs(ie,{className:"space-y-3",children:[G.map((ce,Y)=>e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-3",children:[e.jsxs("div",{className:"text-sm font-medium mb-1",children:[e.jsx("strong",{children:"Suggestion:"})," ",ce]}),e.jsxs("div",{className:"text-xs opacity-80",children:["Confidence: ",92-Y*5,"%"]})]},Y)),e.jsxs(I,{size:"sm",className:"w-full bg-white/20 hover:bg-white/30 text-white border-white/30",onClick:O,children:[e.jsx(Np,{className:"w-4 h-4 mr-2"}),"Apply AI Suggestions"]})]})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Za,{className:"w-5 h-5"}),"Quick Actions"]})}),e.jsxs(ie,{className:"space-y-2",children:[e.jsxs(I,{variant:"outline",size:"sm",className:"w-full justify-start",onClick:$e,children:[e.jsx(wY,{className:"w-4 h-4 mr-2"}),"Auto-Balance Entry"]}),e.jsxs(I,{variant:"outline",size:"sm",className:"w-full justify-start",children:[e.jsx(ac,{className:"w-4 h-4 mr-2"}),"Duplicate Entry"]}),e.jsxs(I,{variant:"outline",size:"sm",className:"w-full justify-start",children:[e.jsx(YF,{className:"w-4 h-4 mr-2"}),"Reverse Entry"]}),e.jsxs(I,{variant:"outline",size:"sm",className:"w-full justify-start",children:[e.jsx(An,{className:"w-4 h-4 mr-2"}),"Export to PDF"]}),e.jsxs(I,{variant:"outline",size:"sm",className:"w-full justify-start",children:[e.jsx(h6,{className:"w-4 h-4 mr-2"}),"Validate Entry"]})]})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Cr,{className:"w-5 h-5"}),"Recent Entries"]})}),e.jsx(ie,{className:"space-y-3",children:k?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 animate-spin rounded-full border-2 border-gray-300 border-t-blue-600"}),"Loading..."]})}):S.length===0?e.jsx("div",{className:"text-center py-4 text-gray-500",children:"No recent entries found"}):S.map(ce=>e.jsxs("div",{className:"p-3 border border-gray-200 rounded-lg cursor-pointer hover:border-primary-300 hover:shadow-sm transition-all",onClick:()=>D(ce),children:[e.jsxs("div",{className:"flex justify-between items-center mb-1 gap-2",children:[e.jsx("span",{className:"font-medium text-gray-900 truncate flex-1 min-w-0",title:ce.entryNumber,children:ce.entryNumber.length>12?`${ce.entryNumber.substring(0,12)}...`:ce.entryNumber}),e.jsxs("span",{className:"font-mono font-medium text-green-600 flex-shrink-0",children:["$",(Number(ce.amount)||0).toFixed(2)]})]}),e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:ce.description}),e.jsx("div",{className:"text-xs text-gray-400",children:ce.date}),e.jsx("div",{className:"text-xs text-blue-600 mt-1",children:"Click to copy"})]},ce.id))})]})]})]})})]})})}const oa=()=>({Authorization:`Bearer ${localStorage.getItem("auth_token")||""}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo"}),vc={getCompanies:async()=>await de.get("/api/companies",{headers:oa()})||[],getDimensions:async s=>await de.get(`/api/budget-management/${s}/dimensions`,{headers:oa()})||[],createDimension:async s=>await de.post(`/api/budget-management/${s.companyId}/dimensions`,s,{headers:oa()}),updateDimension:async(s,t)=>await de.put(`/api/budget-management/${t.companyId}/dimensions/${s}`,t,{headers:oa()}),deleteDimension:async(s,t)=>{await de.delete(`/api/budget-management/${t}/dimensions/${s}`,{headers:oa()})},getScenarios:async s=>await de.get(`/api/budget-management/${s}/scenarios`,{headers:oa()})||[],createScenario:async(s,t)=>(await de.post(`/api/budget-management/${s}/scenarios`,t,{headers:oa()})).data,getPeriods:async s=>await de.get(`/api/budget-management/${s}/periods`,{headers:oa()})||[],createPeriod:async(s,t)=>(await de.post(`/api/budget-management/${s}/periods`,t,{headers:oa()})).data,getBudgets:async s=>await de.get(`/api/budget-management/${s}/budgets`,{headers:oa()})||[],createBudget:async(s,t)=>(await de.post(`/api/budget-management/${s}/budgets`,t,{headers:oa()})).data,updateBudget:async(s,t,r)=>(await de.put(`/api/budget-management/${s}/budgets/${t}`,r,{headers:oa()})).data,approveBudget:async(s,t)=>(await de.post(`/api/budget-management/${s}/budgets/${t}/approve`,{},{headers:oa()})).data,activateBudget:async(s,t)=>(await de.post(`/api/budget-management/${s}/budgets/${t}/activate`,{},{headers:oa()})).data,copyBudget:async(s,t)=>(await de.post(`/api/budget-management/${s}/budgets/${t}/copy`,{},{headers:oa()})).data,getBudgetLineItems:async(s,t)=>(await de.get(`/api/budget-management/${s}/budgets/${t}/line-items`,{headers:oa()})).data||[],createBudgetLineItem:async(s,t,r)=>(await de.post(`/api/budget-management/${s}/budgets/${t}/line-items`,r,{headers:oa()})).data,getVariances:async(s,t)=>await de.get(`/api/budget-management/${s}/budgets/${t}/variances`,{headers:oa()})||[],getRollingForecasts:async s=>await de.get(`/api/budget-management/${s}/rolling-forecasts`,{headers:oa()})||[],createRollingForecast:async s=>await de.post(`/api/budget-management/${s.companyId}/rolling-forecasts`,s,{headers:oa()}),updateRollingForecast:async(s,t)=>await de.put(`/api/budget-management/${t.companyId}/rolling-forecasts/${s}`,t,{headers:oa()}),deleteRollingForecast:async(s,t)=>{await de.delete(`/api/budget-management/${t}/rolling-forecasts/${s}`,{headers:oa()})},generateForecast:async(s,t)=>(await de.post(`/api/budget-management/${s}/rolling-forecasts/${t}/generate`,{},{headers:oa()})).data,getPerformanceMetrics:async(s,t)=>{const r=t?`?period=${t}`:"";return await de.get(`/api/budget-management/${s}/performance-metrics${r}`,{headers:oa()})},getReports:async(s,t)=>{const r=t?`?type=${t}`:"";return(await de.get(`/api/budget-management/${s}/reports${r}`,{headers:oa()})).data}},Oj={getBudgets:async s=>{const t=s?`?companyId=${s}`:"";return await de.get(`/api/budgets${t}`,{headers:oa()})||[]},createBudget:async s=>await de.post("/api/budgets",s,{headers:oa()}),updateBudget:async(s,t)=>await de.put(`/api/budgets/${s}`,t,{headers:oa()}),deleteBudget:async s=>{await de.delete(`/api/budgets/${s}`,{headers:oa()})},getBudgetAnalytics:async s=>{const t=s||zs(),r=t?`?companyId=${t}`:"";return await de.get(`/api/budgets/analytics${r}`,{headers:oa()})},getBudgetAnalysis:async(s,t,r)=>{const n=new URLSearchParams;s&&n.append("companyId",s),t&&n.append("startDate",t),r&&n.append("endDate",r);const a=n.toString()?`?${n.toString()}`:"";return await de.get(`/api/budget-analysis${a}`,{headers:oa()})}};function l7e(){var et,lt;const{ready:s}=gu("budget-management-page"),[t,r]=x.useState([]),[n,a]=x.useState(""),[i,o]=x.useState([]),[l,c]=x.useState([]),[d,u]=x.useState([]),[h,f]=x.useState([]),[m,p]=x.useState([]),[g,v]=x.useState(null),[y,j]=x.useState([]),[b,w]=x.useState(!1),[N,C]=x.useState("overview"),[S,_]=x.useState(null),[k,F]=x.useState([]),[A,T]=x.useState(!1),[V,M]=x.useState(!1),[G,L]=x.useState(!1),[J,z]=x.useState({name:"",description:"",scenarioId:"",periodId:"",amount:"",status:"DRAFT",categoryId:""}),[U,oe]=x.useState(null),[Q,P]=x.useState(null),[q,D]=x.useState({name:"",description:"",basePeriod:"",forecastPeriods:12,frequency:"MONTHLY"}),[se,he]=x.useState(null),[be,pe]=x.useState({name:"",type:"DEPARTMENT"}),[Ae,Ee]=x.useState(null);x.useEffect(()=>{(async()=>{try{const ft=await vc.getCompanies();r(ft),ft&&ft.length>0&&a(ft[0].id)}catch{r([]),ze.error("Failed to load companies")}})()},[]),x.useEffect(()=>{n&&(async()=>{try{const ft=await de.get(`/api/expense-categories?companyId=${n}`);j(ft||[])}catch{j([])}})()},[n]);const $e=async()=>{try{const Fe=await de.post(`/api/expense-categories/seed/${n}`);ze.success("Default categories created successfully");const ft=await de.get(`/api/expense-categories?companyId=${n}`);j(ft||[])}catch{ze.error("Failed to create default categories")}},O=x.useCallback(async()=>{if(n){w(!0);try{const Fe=await de.getDemoToken("user_demo",["admin"]);localStorage.setItem("auth_token",Fe.token),localStorage.setItem("tenant_id","tenant_demo"),await Promise.all([te(),re(),le(),Z(),K(),X()])}catch{ze.error("Failed to load budget data")}finally{w(!1)}}},[n]);x.useEffect(()=>{n&&O()},[n,O]);const te=async()=>{try{const Fe=await vc.getDimensions(n);o(Fe)}catch{o([]),ze.error("Failed to load dimensions")}},re=async()=>{try{const Fe=await vc.getScenarios(n);c(Fe)}catch{c([]),ze.error("Failed to load scenarios")}},le=async()=>{try{const Fe=await vc.getPeriods(n);u(Fe)}catch{u([]),ze.error("Failed to load periods")}},Z=async()=>{try{const Fe=await Oj.getBudgets(n);if(Fe&&Fe.length>0){const ft=Fe.map(He=>({id:He.id,companyId:He.companyId,name:He.name,description:He.description||"",scenarioId:"default",periodId:"default",status:He.isActive?"ACTIVE":"DRAFT",totalPlanned:Number(He.amount),totalActual:Number(He.spentAmount||0),totalVariance:Number(He.amount)-Number(He.spentAmount||0),totalVariancePercent:Number(He.amount)>0?(Number(He.amount)-Number(He.spentAmount||0))/Number(He.amount)*100:0,createdBy:"system",createdAt:He.createdAt,updatedAt:He.updatedAt}));f(ft),ze.success(` Loaded ${ft.length} real budgets from database!`)}else f([]),ze.info("No budgets found for this company")}catch{f([]),ze.error("Failed to load budgets from database")}},K=async()=>{try{const Fe=await vc.getRollingForecasts(n);p(Fe)}catch{p([]),ze.error("Failed to load forecasts")}},X=async()=>{try{const Fe=await vc.getPerformanceMetrics(n);v(Fe)}catch{v({budgetAccuracy:0,varianceTrend:"STABLE",topPerformingDimensions:[],underperformingDimensions:[],recommendations:[]}),ze.error("Failed to load performance metrics")}},ce=async Fe=>{try{_(Fe);const ft=await vc.getVariances(n,Fe.id);F(ft),C("budgets")}catch{F([]),ze.error("Failed to load budget variances")}},Y=()=>{z({name:"",description:"",scenarioId:"",periodId:"",amount:"",status:"DRAFT",categoryId:""}),oe(null)},ue=()=>{D({name:"",description:"",basePeriod:"",forecastPeriods:12,frequency:"MONTHLY"}),he(null)},ve=()=>{pe({name:"",type:"DEPARTMENT"}),Ee(null)},Le=()=>{Y(),T(!0)},Me=Fe=>{oe(Fe),z({name:Fe.name,description:Fe.description||"",scenarioId:Fe.scenarioId||"",periodId:Fe.periodId||"",amount:Fe.totalPlanned.toString(),status:Fe.status,categoryId:""}),T(!0)},tt=Fe=>{P(Fe)},fe=()=>{ue(),M(!0)},ct=Fe=>{he(Fe),D({name:Fe.name,description:Fe.description||"",basePeriod:Fe.basePeriod,forecastPeriods:Fe.forecastPeriods,frequency:Fe.frequency}),M(!0)},dt=()=>{ve(),L(!0)},pt=Fe=>{Ee(Fe),pe({name:Fe.name,type:Fe.type}),L(!0)},qe=async()=>{try{if(!J.name||!J.amount||!J.categoryId){ze.error("Please fill in required fields: name, amount, and category");return}const Fe={name:J.name,description:J.description,amount:parseFloat(J.amount),companyId:n,categoryId:J.categoryId,period:"monthly",startDate:new Date().toISOString().split("T")[0],endDate:new Date(Date.now()+30*24*60*60*1e3).toISOString().split("T")[0],alertThreshold:80,isActive:J.status==="ACTIVE"||J.status==="APPROVED"};U?(await Oj.updateBudget(U.id,Fe),ze.success("Budget updated successfully")):(await Oj.createBudget(Fe),ze.success("Budget created successfully")),T(!1),Y(),await Z()}catch{ze.error("Failed to save budget")}},mt=async Fe=>{if(window.confirm(`Are you sure you want to delete "${Fe.name}"?`))try{await Oj.deleteBudget(Fe.id),ze.success("Budget deleted successfully"),await Z()}catch{ze.error("Failed to delete budget")}},Rt=async()=>{try{if(!q.name||!q.basePeriod){ze.error("Please fill in required fields: name and base period");return}const Fe={name:q.name,description:q.description,basePeriod:q.basePeriod,forecastPeriods:q.forecastPeriods,frequency:q.frequency,companyId:n};se?(await vc.updateRollingForecast(se.id,Fe),ze.success("Forecast updated successfully")):(await vc.createRollingForecast(Fe),ze.success("Forecast created successfully")),M(!1),ue(),await K()}catch{ze.error("Failed to save forecast")}},_e=async()=>{try{if(!be.name){ze.error("Please fill in required fields: name");return}const Fe={name:be.name,type:be.type,companyId:n};Ae?(await vc.updateDimension(Ae.id,Fe),ze.success("Dimension updated successfully")):(await vc.createDimension(Fe),ze.success("Dimension created successfully")),L(!1),ve(),await te()}catch{ze.error("Failed to save dimension")}},Xe=async Fe=>{if(window.confirm(`Are you sure you want to delete "${Fe.name}"?`))try{await vc.deleteRollingForecast(Fe.id,n),ze.success("Forecast deleted successfully"),await K()}catch{ze.error("Failed to delete forecast")}},At=async Fe=>{if(window.confirm(`Are you sure you want to delete "${Fe.name}"?`))try{await vc.deleteDimension(Fe.id,n),ze.success("Dimension deleted successfully"),await te()}catch{ze.error("Failed to delete dimension")}},st=Fe=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Fe),$t=Fe=>`${Fe>=0?"+":""}${Fe.toFixed(1)}%`,fs=Fe=>{switch(Fe){case"DRAFT":return"bg-yellow-100 text-yellow-800";case"APPROVED":return"bg-blue-100 text-blue-800";case"ACTIVE":return"bg-green-100 text-green-800";case"CLOSED":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},zt=Fe=>{switch(Fe){case"IMPROVING":return e.jsx($s,{className:"h-4 w-4 text-green-500"});case"DETERIORATING":return e.jsx($o,{className:"h-4 w-4 text-red-500"});case"STABLE":return e.jsx(lr,{className:"h-4 w-4 text-gray-500"});default:return e.jsx(lr,{className:"h-4 w-4 text-gray-500"})}},St=Fe=>{switch(Fe){case"LOW":return"bg-green-100 text-green-800";case"MEDIUM":return"bg-yellow-100 text-yellow-800";case"HIGH":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},js=Fe=>{switch(Fe){case"DEPARTMENT":return e.jsx(Sa,{className:"h-4 w-4"});case"PROJECT":return e.jsx(wa,{className:"h-4 w-4"});case"COST_CENTER":return e.jsx(Lf,{className:"h-4 w-4"});case"PRODUCT_LINE":return e.jsx(Hr,{className:"h-4 w-4"});case"GEOGRAPHY":return e.jsx(Pa,{className:"h-4 w-4"});case"CUSTOM":return e.jsx(lr,{className:"h-4 w-4"});default:return e.jsx(lr,{className:"h-4 w-4"})}};return s?e.jsx(Kr,{title:"Budget Management",description:"Create budgets, manage forecasts, and track performance",breadcrumbs:[{label:"Finance",href:"/finance"},{label:"Budget Management",href:"/budget-management"}],children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-end",children:e.jsx("div",{className:"flex gap-2",children:e.jsxs(I,{variant:"outline",onClick:O,disabled:b,children:[e.jsx(Ts,{className:`h-4 w-4 mr-2 ${b?"animate-spin":""}`}),"Refresh"]})})}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Company Selection"})}),e.jsx(ie,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx(B,{htmlFor:"company",children:"Company"}),e.jsxs(rt,{value:n,onValueChange:a,children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select company"})}),e.jsx(at,{children:t.map(Fe=>e.jsx(W,{value:Fe.id,children:Fe.name},Fe.id))})]})]})})})]}),e.jsxs(an,{value:N,onValueChange:C,children:[e.jsxs(on,{className:"grid w-full grid-cols-5",children:[e.jsx(vt,{value:"overview",children:"Overview"}),e.jsx(vt,{value:"budgets",children:"Budgets"}),e.jsx(vt,{value:"forecasts",children:"Forecasts"}),e.jsx(vt,{value:"dimensions",children:"Dimensions"}),e.jsx(vt,{value:"reports",children:"Reports"})]}),e.jsxs(yt,{value:"overview",className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Total Budgets"}),e.jsx(lr,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:h.length}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[h.filter(Fe=>Fe.status==="ACTIVE").length," active"]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Total Planned"}),e.jsx(Mr,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:st(h.reduce((Fe,ft)=>Fe+ft.totalPlanned,0))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all budgets"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Total Actual"}),e.jsx(wa,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:st(h.reduce((Fe,ft)=>Fe+ft.totalActual,0))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Actual spending"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Budget Accuracy"}),e.jsx(Eo,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:g?`${g.budgetAccuracy.toFixed(1)}%`:"N/A"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(g==null?void 0:g.varianceTrend)||"N/A"," trend"]})]})]})]}),g&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx($s,{className:"h-5 w-5 text-green-500"}),"Top Performing Dimensions"]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-2",children:g.topPerformingDimensions.map((Fe,ft)=>e.jsxs("div",{className:"flex justify-between items-center p-2 border rounded",children:[e.jsx("span",{className:"font-medium",children:Fe.dimensionName}),e.jsxs(Oe,{variant:"default",children:[Fe.performance.toFixed(1),"%"]})]},ft))})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx($o,{className:"h-5 w-5 text-red-500"}),"Underperforming Dimensions"]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-2",children:g.underperformingDimensions.map((Fe,ft)=>e.jsxs("div",{className:"flex justify-between items-center p-2 border rounded",children:[e.jsx("span",{className:"font-medium",children:Fe.dimensionName}),e.jsxs(Oe,{variant:"destructive",children:[Fe.performance.toFixed(1),"%"]})]},ft))})})]})]}),g&&g.recommendations.length>0&&e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Is,{className:"h-5 w-5 text-yellow-500"}),"Recommendations"]})}),e.jsx(ie,{children:e.jsx("ul",{className:"space-y-2",children:g.recommendations.map((Fe,ft)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),e.jsx("span",{className:"text-sm",children:Fe})]},ft))})})]})]}),e.jsxs(yt,{value:"budgets",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Budgets"}),e.jsxs(ts,{open:A,onOpenChange:Fe=>{T(Fe),Fe||Y()},children:[e.jsx(ki,{asChild:!0,children:e.jsxs(I,{onClick:Le,children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Create Budget"]})}),e.jsxs(ss,{className:"max-w-2xl",children:[e.jsxs(as,{children:[e.jsx(is,{children:U?"Edit Budget":"Create New Budget"}),e.jsx(Ks,{children:U?"Update budget details":"Create a new budget for planning and tracking"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"budget-name",children:"Budget Name *"}),e.jsx(ge,{id:"budget-name",placeholder:"Enter budget name",value:J.name,onChange:Fe=>z(ft=>({...ft,name:Fe.target.value}))})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"budget-description",children:"Description"}),e.jsx(Xs,{id:"budget-description",placeholder:"Enter budget description",value:J.description,onChange:Fe=>z(ft=>({...ft,description:Fe.target.value}))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(B,{htmlFor:"budget-category",children:"Category *"}),y.length===0&&e.jsx(I,{type:"button",variant:"outline",size:"sm",onClick:$e,children:"Create Default Categories"})]}),e.jsxs(rt,{value:J.categoryId,onValueChange:Fe=>z(ft=>({...ft,categoryId:Fe})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:y.length===0?"No categories available":"Select expense category"})}),e.jsx(at,{children:y.map(Fe=>e.jsx(W,{value:Fe.id,children:Fe.name},Fe.id))})]}),y.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:'No expense categories found. Click "Create Default Categories" to add some.'})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"budget-scenario",children:"Scenario"}),e.jsxs(rt,{value:J.scenarioId,onValueChange:Fe=>z(ft=>({...ft,scenarioId:Fe})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select scenario"})}),e.jsx(at,{children:l.map(Fe=>e.jsx(W,{value:Fe.id,children:Fe.name},Fe.id))})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"budget-period",children:"Period"}),e.jsxs(rt,{value:J.periodId,onValueChange:Fe=>z(ft=>({...ft,periodId:Fe})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select period"})}),e.jsx(at,{children:d.map(Fe=>e.jsx(W,{value:Fe.id,children:Fe.name},Fe.id))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"budget-amount",children:"Amount *"}),e.jsx(ge,{id:"budget-amount",type:"number",placeholder:"Enter budget amount",value:J.amount,onChange:Fe=>z(ft=>({...ft,amount:Fe.target.value}))})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"budget-status",children:"Status"}),e.jsxs(rt,{value:J.status,onValueChange:Fe=>z(ft=>({...ft,status:Fe})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select status"})}),e.jsxs(at,{children:[e.jsx(W,{value:"DRAFT",children:"Draft"}),e.jsx(W,{value:"ACTIVE",children:"Active"}),e.jsx(W,{value:"APPROVED",children:"Approved"}),e.jsx(W,{value:"CLOSED",children:"Closed"})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(I,{variant:"outline",onClick:()=>T(!1),children:"Cancel"}),e.jsx(I,{onClick:qe,disabled:!J.name||!J.amount||!J.categoryId,children:U?"Update Budget":"Create Budget"})]})]})]})]}),e.jsx(ts,{open:!!Q,onOpenChange:Fe=>{Fe||P(null)},children:e.jsxs(ss,{className:"max-w-2xl",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Budget Details"}),e.jsx(Ks,{children:"View detailed information about this budget"})]}),Q&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Name"}),e.jsx("p",{className:"text-lg font-semibold",children:Q.name})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Status"}),e.jsx("div",{className:"mt-1",children:e.jsx(Oe,{className:fs(Q.status),children:Q.status})})]})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Description"}),e.jsx("p",{className:"mt-1 text-sm",children:Q.description||"No description provided"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Scenario"}),e.jsx("p",{className:"text-sm",children:((et=l.find(Fe=>Fe.id===Q.scenarioId))==null?void 0:et.name)||"Unknown"})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Period"}),e.jsx("p",{className:"text-sm",children:((lt=d.find(Fe=>Fe.id===Q.periodId))==null?void 0:lt.name)||"Unknown"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Planned Amount"}),e.jsx("p",{className:"text-lg font-semibold text-blue-600",children:st(Q.totalPlanned)})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Actual Amount"}),e.jsx("p",{className:"text-lg font-semibold text-green-600",children:st(Q.totalActual)})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Variance"}),e.jsxs("p",{className:`text-lg font-semibold ${Q.totalVariance<0?"text-red-600":"text-green-600"}`,children:[st(Q.totalVariance)," (",$t(Q.totalVariancePercent),")"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Created"}),e.jsx("p",{className:"text-sm",children:new Date(Q.createdAt).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx(B,{className:"text-sm font-medium text-muted-foreground",children:"Last Updated"}),e.jsx("p",{className:"text-sm",children:new Date(Q.updatedAt).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(I,{variant:"outline",onClick:()=>P(null),children:"Close"}),e.jsx(I,{onClick:()=>{P(null),Me(Q)},children:"Edit Budget"})]})]})]})})]}),e.jsx(ne,{children:e.jsx(ie,{className:"p-0",children:e.jsxs(Ol,{children:[e.jsx(Rl,{children:e.jsxs(Dn,{children:[e.jsx(_s,{children:"Name"}),e.jsx(_s,{children:"Scenario"}),e.jsx(_s,{children:"Period"}),e.jsx(_s,{children:"Status"}),e.jsx(_s,{children:"Planned"}),e.jsx(_s,{children:"Actual"}),e.jsx(_s,{children:"Variance"}),e.jsx(_s,{children:"Actions"})]})}),e.jsx(Fl,{children:h.map(Fe=>{const ft=l.find(Je=>Je.id===Fe.scenarioId),He=d.find(Je=>Je.id===Fe.periodId);return e.jsxs(Dn,{children:[e.jsx(Cs,{className:"font-medium",children:Fe.name}),e.jsx(Cs,{children:(ft==null?void 0:ft.name)||"Unknown"}),e.jsx(Cs,{children:(He==null?void 0:He.name)||"Unknown"}),e.jsx(Cs,{children:e.jsx(Oe,{className:fs(Fe.status),children:Fe.status})}),e.jsx(Cs,{children:st(Fe.totalPlanned)}),e.jsx(Cs,{children:st(Fe.totalActual)}),e.jsxs(Cs,{className:Fe.totalVariance<0?"text-red-600":"text-green-600",children:[st(Fe.totalVariance)," (",$t(Fe.totalVariancePercent),")"]}),e.jsx(Cs,{children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(I,{variant:"outline",size:"sm",onClick:()=>ce(Fe),title:"View Variances",children:e.jsx(lr,{className:"h-4 w-4"})}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>tt(Fe),title:"View Details",children:e.jsx(ir,{className:"h-4 w-4"})}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>Me(Fe),title:"Edit Budget",children:e.jsx(ln,{className:"h-4 w-4"})}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>mt(Fe),title:"Delete Budget",className:"text-red-600 hover:text-red-700",children:e.jsx(Is,{className:"h-4 w-4"})})]})})]},Fe.id)})})]})})}),S&&e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs(Se,{children:["Variances for ",S.name]}),e.jsx(Vt,{children:"Detailed variance analysis for this budget"})]}),e.jsx(I,{variant:"outline",onClick:()=>_(null),children:"Close"})]})}),e.jsx(ie,{className:"p-0",children:e.jsxs(Ol,{children:[e.jsx(Rl,{children:e.jsxs(Dn,{children:[e.jsx(_s,{children:"Account"}),e.jsx(_s,{children:"Dimension"}),e.jsx(_s,{children:"Planned"}),e.jsx(_s,{children:"Actual"}),e.jsx(_s,{children:"Variance"}),e.jsx(_s,{children:"Trend"}),e.jsx(_s,{children:"Risk"})]})}),e.jsx(Fl,{children:k.length>0?k.map((Fe,ft)=>e.jsxs(Dn,{children:[e.jsx(Cs,{className:"font-medium",children:Fe.accountName}),e.jsx(Cs,{children:Fe.dimensionName}),e.jsx(Cs,{children:st(Fe.plannedAmount)}),e.jsx(Cs,{children:st(Fe.actualAmount)}),e.jsxs(Cs,{className:Fe.variance<0?"text-red-600":"text-green-600",children:[st(Fe.variance)," (",$t(Fe.variancePercent),")"]}),e.jsx(Cs,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[zt(Fe.trend),e.jsx("span",{className:"text-sm",children:Fe.trend})]})}),e.jsx(Cs,{children:e.jsx(Oe,{className:St(Fe.riskLevel),children:Fe.riskLevel})})]},ft)):e.jsx(Dn,{children:e.jsx(Cs,{colSpan:7,className:"text-center text-muted-foreground py-8",children:"No variance data available for this budget"})})})]})})]})]}),e.jsxs(yt,{value:"forecasts",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Rolling Forecasts"}),e.jsxs(ts,{open:V,onOpenChange:Fe=>{M(Fe),Fe||ue()},children:[e.jsx(ki,{asChild:!0,children:e.jsxs(I,{onClick:fe,children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Create Forecast"]})}),e.jsxs(ss,{className:"max-w-2xl",children:[e.jsxs(as,{children:[e.jsx(is,{children:se?"Edit Rolling Forecast":"Create Rolling Forecast"}),e.jsx(Ks,{children:se?"Update forecast details":"Create a rolling forecast for future planning"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"forecast-name",children:"Forecast Name *"}),e.jsx(ge,{id:"forecast-name",placeholder:"Enter forecast name",value:q.name,onChange:Fe=>D(ft=>({...ft,name:Fe.target.value}))})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"forecast-description",children:"Description"}),e.jsx(Xs,{id:"forecast-description",placeholder:"Enter forecast description",value:q.description,onChange:Fe=>D(ft=>({...ft,description:Fe.target.value}))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"base-period",children:"Base Period *"}),e.jsx(ge,{id:"base-period",type:"month",value:q.basePeriod,onChange:Fe=>D(ft=>({...ft,basePeriod:Fe.target.value}))})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"forecast-periods",children:"Forecast Periods"}),e.jsx(ge,{id:"forecast-periods",type:"number",placeholder:"12",value:q.forecastPeriods,onChange:Fe=>D(ft=>({...ft,forecastPeriods:parseInt(Fe.target.value)||12}))})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"frequency",children:"Frequency"}),e.jsxs(rt,{value:q.frequency,onValueChange:Fe=>D(ft=>({...ft,frequency:Fe})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select frequency"})}),e.jsxs(at,{children:[e.jsx(W,{value:"MONTHLY",children:"Monthly"}),e.jsx(W,{value:"QUARTERLY",children:"Quarterly"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(I,{variant:"outline",onClick:()=>M(!1),children:"Cancel"}),e.jsx(I,{onClick:Rt,disabled:!q.name||!q.basePeriod,children:se?"Update Forecast":"Create Forecast"})]})]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:m.map(Fe=>e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center justify-between",children:[e.jsx("span",{children:Fe.name}),e.jsx(Oe,{variant:Fe.isActive?"default":"secondary",children:Fe.isActive?"Active":"Inactive"})]}),e.jsx(Vt,{children:Fe.description})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Base Period:"}),e.jsx("span",{className:"text-sm font-medium",children:Fe.basePeriod})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Periods:"}),e.jsx("span",{className:"text-sm font-medium",children:Fe.forecastPeriods})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Frequency:"}),e.jsx("span",{className:"text-sm font-medium",children:Fe.frequency})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Last Updated:"}),e.jsx("span",{className:"text-sm font-medium",children:new Date(Fe.lastUpdated).toLocaleDateString()})]})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsxs(I,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>ct(Fe),children:[e.jsx(ln,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsxs(I,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>Xe(Fe),children:[e.jsx(Is,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]},Fe.id))})]}),e.jsxs(yt,{value:"dimensions",className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Budget Dimensions"}),e.jsxs(ts,{open:G,onOpenChange:Fe=>{L(Fe),Fe||ve()},children:[e.jsx(ki,{asChild:!0,children:e.jsxs(I,{onClick:dt,children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Add Dimension"]})}),e.jsxs(ss,{className:"max-w-lg",children:[e.jsxs(as,{children:[e.jsx(is,{children:Ae?"Edit Budget Dimension":"Add Budget Dimension"}),e.jsx(Ks,{children:Ae?"Update dimension details":"Create a new dimension for budget categorization"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"dimension-name",children:"Dimension Name *"}),e.jsx(ge,{id:"dimension-name",placeholder:"Enter dimension name",value:be.name,onChange:Fe=>pe(ft=>({...ft,name:Fe.target.value}))})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"dimension-type",children:"Type *"}),e.jsxs(rt,{value:be.type,onValueChange:Fe=>pe(ft=>({...ft,type:Fe})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select type"})}),e.jsxs(at,{children:[e.jsx(W,{value:"DEPARTMENT",children:"Department"}),e.jsx(W,{value:"PROJECT",children:"Project"}),e.jsx(W,{value:"COST_CENTER",children:"Cost Center"}),e.jsx(W,{value:"PRODUCT_LINE",children:"Product Line"}),e.jsx(W,{value:"GEOGRAPHY",children:"Geography"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(I,{variant:"outline",onClick:()=>L(!1),children:"Cancel"}),e.jsx(I,{onClick:_e,disabled:!be.name,children:Ae?"Update Dimension":"Add Dimension"})]})]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(Fe=>e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center gap-2",children:[js(Fe.type),Fe.name]})}),e.jsxs(ie,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Type:"}),e.jsx("span",{className:"text-sm font-medium",children:Fe.type})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Status:"}),e.jsx(Oe,{variant:Fe.isActive?"default":"secondary",children:Fe.isActive?"Active":"Inactive"})]})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsxs(I,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>pt(Fe),children:[e.jsx(ln,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsxs(I,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>At(Fe),children:[e.jsx(Is,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]},Fe.id))})]}),e.jsx(yt,{value:"reports",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Budget Reports"}),e.jsx(Vt,{children:"Generate comprehensive budget reports"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(I,{variant:"outline",className:"h-20 flex flex-col gap-2",children:[e.jsx(lr,{className:"h-6 w-6"}),e.jsx("span",{children:"Summary Report"})]}),e.jsxs(I,{variant:"outline",className:"h-20 flex flex-col gap-2",children:[e.jsx(Eo,{className:"h-6 w-6"}),e.jsx("span",{children:"Detailed Report"})]}),e.jsxs(I,{variant:"outline",className:"h-20 flex flex-col gap-2",children:[e.jsx($s,{className:"h-6 w-6"}),e.jsx("span",{children:"Variance Report"})]}),e.jsxs(I,{variant:"outline",className:"h-20 flex flex-col gap-2",children:[e.jsx(eN,{className:"h-6 w-6"}),e.jsx("span",{children:"Forecast Report"})]})]})})]})})]})]})}):e.jsx(Kr,{title:"Budget Management",description:"Create budgets, manage forecasts, and track performance",children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ts,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading budget management..."})]})})})}const c7e=({onSubmit:s,onCancel:t,templates:r})=>{const[n,a]=x.useState({name:"",description:"",category:"",templateId:"",steps:[]}),[i,o]=x.useState({name:"",type:"validation"}),l=h=>{h.preventDefault(),n.name&&n.description&&s(n)},c=()=>{if(i.name){const h={id:Date.now().toString(),name:i.name,type:i.type,order:n.steps.length+1};a(f=>({...f,steps:[...f.steps,h]})),o({name:"",type:"validation"})}},d=h=>{a(f=>({...f,steps:f.steps.filter(m=>m.id!==h)}))},u=h=>{a(f=>({...f,name:h.name,description:h.description,category:h.category,templateId:h.id,steps:h.steps.map((m,p)=>({...m,id:Date.now().toString()+p,order:p+1}))}))};return e.jsxs("form",{onSubmit:l,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(B,{htmlFor:"workflow-name",children:"Workflow Name"}),e.jsx(ge,{id:"workflow-name",value:n.name,onChange:h=>a(f=>({...f,name:h.target.value})),placeholder:"Enter workflow name",required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(B,{htmlFor:"workflow-description",children:"Description"}),e.jsx(Xs,{id:"workflow-description",value:n.description,onChange:h=>a(f=>({...f,description:h.target.value})),placeholder:"Describe what this workflow does",required:!0})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(B,{htmlFor:"workflow-category",children:"Category"}),e.jsxs(rt,{value:n.category,onValueChange:h=>a(f=>({...f,category:h})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select category"})}),e.jsxs(at,{children:[e.jsx(W,{value:"Finance",children:"Finance"}),e.jsx(W,{value:"Legal",children:"Legal"}),e.jsx(W,{value:"AI",children:"AI"}),e.jsx(W,{value:"Operations",children:"Operations"})]})]})]})]}),r.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{children:"Start from Template (Optional)"}),e.jsx("div",{className:"grid gap-2",children:r.map(h=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:h.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:h.description})]}),e.jsx(I,{type:"button",variant:"outline",size:"sm",onClick:()=>u(h),children:"Use Template"})]},h.id))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{children:"Workflow Steps"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ge,{value:i.name,onChange:h=>o(f=>({...f,name:h.target.value})),placeholder:"Step name",className:"flex-1"}),e.jsxs(rt,{value:i.type,onValueChange:h=>o(f=>({...f,type:h})),children:[e.jsx(nt,{className:"w-32",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"validation",children:"Validation"}),e.jsx(W,{value:"approval",children:"Approval"}),e.jsx(W,{value:"action",children:"Action"}),e.jsx(W,{value:"review",children:"Review"}),e.jsx(W,{value:"ai_processing",children:"AI Processing"})]})]}),e.jsx(I,{type:"button",onClick:c,disabled:!i.name,children:"Add Step"})]}),e.jsx("div",{className:"space-y-2",children:n.steps.map(h=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-sm font-medium",children:h.order}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:h.name}),e.jsx("p",{className:"text-sm text-muted-foreground capitalize",children:h.type})]})]}),e.jsx(I,{type:"button",variant:"outline",size:"sm",onClick:()=>d(h.id),children:e.jsx(Is,{className:"h-4 w-4"})})]},h.id))})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(I,{type:"button",variant:"outline",onClick:t,children:"Cancel"}),e.jsx(I,{type:"submit",disabled:!n.name||!n.description,children:"Create Workflow"})]})]})};function d7e(){var Ur,Yi,Ji,rn,Ll,zo,Qo,Xi,_o,qo,$l,Zo,el,ot,qs,Sn,hr,Fn,Rr,$,Xt,ds,Us,H,Ce,Ge,ht,wt,Qt,vs,Js;const{isAuthenticated:s,loginWithDemo:t,isLoading:r}=Ua(),[n,a]=x.useState({totalDocuments:0,storageUsed:"0 GB",pendingApprovals:0,sharedDocuments:0}),[i,o]=x.useState([]),[l,c]=x.useState(!0),[d,u]=x.useState(""),[h,f]=x.useState(!1),[m,p]=x.useState(!1),[g,v]=x.useState("grid"),[y,j]=x.useState("date"),[b,w]=x.useState("desc"),[N,C]=x.useState("all"),[S,_]=x.useState(new Set),[k,F]=x.useState(!1),[A,T]=x.useState(!1),[V,M]=x.useState({displayName:"",description:"",categoryId:"",workspaceId:""}),G=x.useRef(null),[L,J]=x.useState(null),[z,U]=x.useState(null),[oe,Q]=x.useState(!1),[P,q]=x.useState(!1),[D,se]=x.useState(!1),[he,be]=x.useState(null),[pe,Ae]=x.useState(null),[Ee,$e]=x.useState(!1),[O,te]=x.useState(!1),[re,le]=x.useState(!1),[Z,K]=x.useState(null),[X,ce]=x.useState(!1),[Y,ue]=x.useState(!1),[ve,Le]=x.useState(!1),[Me,tt]=x.useState(!1),[fe,ct]=x.useState({activeWorkflows:0,pendingApprovals:0,completedToday:0,averageProcessingTime:0}),[dt,pt]=x.useState([]),[qe,mt]=x.useState([]),[Rt,_e]=x.useState(!1),[Xe,At]=x.useState(null),[st,$t]=x.useState(null),[fs,zt]=x.useState([]),[St,js]=x.useState(null),[et,lt]=x.useState([]),[Fe,ft]=x.useState(null),[He,Je]=x.useState([]),[It,Gt]=x.useState([]),[qt,As]=x.useState(!1),[Ht,xs]=x.useState({totalDocuments:0,analyzedDocuments:0,analyzedPercentage:0,smartTagsCount:0,activeInsights:0,qualityScore:0}),[Ct,ke]=x.useState({completeness:0,clarity:0,compliance:0,accessibility:0}),[gt,us]=x.useState([]),[We,Et]=x.useState([]),[Pt,rs]=x.useState([]),[ms,Bs]=x.useState([]),[Vs,Ws]=x.useState([]),[Ns,er]=x.useState(""),[Ir,jn]=x.useState([]),[Hs,qr]=x.useState(!1),[qn,In]=x.useState(!1);x.useEffect(()=>{r||(s?Yr():t("demo@urutiq.com",["admin"]).catch(console.error))},[s,r,t]),x.useEffect(()=>{s&&!r&&(Yr(),Hi(),Gi())},[s,r]),x.useEffect(()=>{if(s&&!r){const je=setTimeout(()=>{$r()},100);return()=>clearTimeout(je)}},[s,r]);const Yr=async()=>{try{c(!0);const je=await de.get("/api/documents/stats");a(je);const Ot=await de.get("/api/documents?limit=20");o(Ot.documents||[])}catch(je){console.error("Error loading document data:",je),ze.error("Failed to load document data")}finally{c(!1)}},$r=async()=>{try{if(qr(!0),!s)return;try{const je=await de.getAIStats();xs(je)}catch{xs({totalDocuments:0,analyzedDocuments:0,analyzedPercentage:0,smartTagsCount:0,activeInsights:0,qualityScore:0})}try{const je=await de.getQualityAnalysis();ke(je)}catch{ke({completeness:0,clarity:0,compliance:0,accessibility:0})}try{const je=await de.getCategorizationSuggestions();us(je)}catch{us([])}try{const je=await de.getAIInsights();Et(je)}catch{Et([])}try{const je=await de.getAITags();rs(je)}catch{rs([])}try{const je=await de.getAIExtractions();Bs(je)}catch{Bs([])}try{const je=await de.getAISummaries();Ws(je)}catch{Ws([])}}catch(je){je instanceof Error?je.message.includes("Failed to fetch")?ze.error("Unable to connect to AI services. Please check if the server is running."):je.message.includes("401")||je.message.includes("unauthorized")?ze.error("Authentication required for AI services. Please log in again."):ze.error("Failed to load AI intelligence data"):ze.error("Failed to load AI intelligence data")}finally{qr(!1)}},Vr=async()=>{if(Ns.trim())try{qr(!0);const je=await de.searchDocuments(Ns);jn(je.results),In(!0),je.totalResults===0?ze.warning(`No documents found matching "${Ns}". Try a different search term.`):ze.success(`Found ${je.totalResults} documents matching "${Ns}"`)}catch(je){console.error("Error in AI search:",je);const Ot=je instanceof Error?je.message:"Unknown error";ze.error(`AI search failed: ${Ot}`)}finally{qr(!1)}},wn=async je=>{er(je);try{qr(!0);const Ot=await de.searchDocuments(je);jn(Ot.results),In(!0),ze.success(`Found ${Ot.totalResults} documents matching "${je}"`)}catch(Ot){console.error("Error in quick search:",Ot),ze.error("Quick search failed")}finally{qr(!1)}},Vn=()=>{er(""),jn([]),In(!1)},De=async je=>{try{qr(!0);const Ot=await de.generateAISummary(je);Ws(Ds=>[Ot,...Ds]),ze.success("AI summary generated successfully")}catch(Ot){console.error("Error generating summary:",Ot),ze.error("Failed to generate AI summary")}finally{qr(!1)}},ut=async je=>{try{qr(!0),ze.success(`Applied categorization "${je.category}" to ${je.suggestedCount} documents`),await $r()}catch(Ot){console.error("Error applying categorization:",Ot),ze.error("Failed to apply categorization")}finally{qr(!1)}},Pe=async()=>{try{qr(!0),await Promise.all([de.getAIInsights(),de.getAITags(),de.getAIExtractions(),de.getCategorizationSuggestions()]),await $r(),ze.success("Document analysis completed")}catch(je){console.error("Error analyzing documents:",je),ze.error("Failed to analyze documents")}finally{qr(!1)}},_t=async()=>{try{qr(!0);const je=await de.generateAISummary("comprehensive");Ws(Ot=>[je,...Ot]),ze.success("Full AI report generated successfully")}catch(je){console.error("Error generating report:",je),ze.error("Failed to generate full report")}finally{qr(!1)}},bt=async()=>{try{qr(!0),await de.getAIExtractions(),await $r(),ze.success("Metadata extraction completed")}catch(je){console.error("Error extracting metadata:",je),ze.error("Failed to extract metadata")}finally{qr(!1)}},ps=()=>{ze.info("Tag management feature coming soon")},Pr=je=>{ze.info(`Summary: ${je.title}

${je.content}`)},Wr=je=>{const Ot=new Blob([`${je.title}

${je.content}`],{type:"text/plain"}),Ds=URL.createObjectURL(Ot),ar=document.createElement("a");ar.href=Ds,ar.download=`${je.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()}.txt`,document.body.appendChild(ar),ar.click(),document.body.removeChild(ar),URL.revokeObjectURL(Ds),ze.success("Summary exported successfully")},Zs=async je=>{try{ze.success("Document approved successfully")}catch(Ot){console.error("Error approving document:",Ot),ze.error("Failed to approve document")}},wr=async je=>{try{ze.success("Document rejected")}catch(Ot){console.error("Error rejecting document:",Ot),ze.error("Failed to reject document")}},xa=je=>{ze.info(`Using ${je} template - feature coming soon`)},cr=je=>{ze.info(`Viewing workflow ${je} - feature coming soon`)},Zn=async je=>{try{console.log("Creating workflow:",je),await de.createWorkflow(je),ze.success("Workflow created successfully"),ce(!1),await Hi()}catch(Ot){console.error("Error creating workflow:",Ot),ze.error("Failed to create workflow")}},Hi=async()=>{try{console.log(" Loading workflow data..."),_e(!0);try{console.log(" Loading workflow stats...");const je=await de.getWorkflowStats();console.log(" Workflow stats loaded:",je),ct(je)}catch(je){console.error(" Error loading workflow stats:",je),ct({activeWorkflows:0,pendingApprovals:0,completedToday:0,averageProcessingTime:0})}try{console.log(" Loading workflows...");const je=await de.getWorkflows();console.log(" Workflows loaded:",je),pt(je.workflows||[])}catch(je){console.error(" Error loading workflows:",je),pt([])}try{console.log(" Loading workflow templates...");const je=await de.getWorkflowTemplates();console.log(" Workflow templates loaded:",je),mt(je.templates||[])}catch(je){console.error(" Error loading workflow templates:",je),mt([])}}catch(je){console.error(" Error loading workflow data:",je),ze.error("Failed to load workflow data")}finally{_e(!1),console.log(" Workflow data loading completed")}},Gi=async()=>{try{console.log(" Loading security data..."),As(!0);try{const je=await Fa.getOverview();At(je)}catch(je){console.error(" Error loading security overview:",je)}try{const je=await Fa.getAccessControl();$t(je)}catch(je){console.error(" Error loading access control:",je)}try{const je=await Fa.getAuditLogs();zt(je.data||[])}catch(je){console.error(" Error loading audit logs:",je)}try{const je=await Fa.getCompliance();js(je),lt(je.actions||[])}catch(je){console.error(" Error loading compliance:",je)}try{const je=await Fa.getEncryption();ft(je.encryption||null)}catch(je){console.error(" Error loading encryption:",je)}try{const je=await Fa.getSessions();Gt(je.sessions||[])}catch(je){console.error(" Error loading sessions:",je)}}catch(je){console.error(" Error loading security data:",je),ze.error("Failed to load security data")}finally{As(!1),console.log(" Security data loading completed")}},Ti=je=>{if(je===0)return"0 Bytes";const Ot=1024,Ds=["Bytes","KB","MB","GB"],ar=Math.floor(Math.log(je)/Math.log(Ot));return parseFloat((je/Math.pow(Ot,ar)).toFixed(2))+" "+Ds[ar]},Ea=je=>je.startsWith("image/")?dY:je==="application/pdf"?uY:je.includes("spreadsheet")||je.includes("excel")?Yf:Zt,Ki=je=>{const Ot=new Date(je),ar=Math.abs(new Date().getTime()-Ot.getTime()),cn=Math.ceil(ar/(1e3*60*60*24));return cn===0?"Today":cn===1?"Yesterday":cn<7?`${cn} days ago`:Ot.toLocaleDateString()},mi=x.useCallback(je=>{je.preventDefault(),je.stopPropagation(),F(!0)},[]),Da=x.useCallback(je=>{je.preventDefault(),je.stopPropagation(),F(!1)},[]),fi=x.useCallback(je=>{je.preventDefault(),je.stopPropagation()},[]),qa=x.useCallback(je=>{je.preventDefault(),je.stopPropagation(),F(!1);const Ot=Array.from(je.dataTransfer.files);Ot.length>0&&(J(Ot[0]),M(Ds=>({...Ds,displayName:Ot[0].name.replace(/\.[^/.]+$/,"")})),f(!0))},[]),Ne=je=>{const Ot=new Set(S);Ot.has(je)?Ot.delete(je):Ot.add(je),_(Ot)},Dt=()=>{S.size===Be.length?_(new Set):_(new Set(Be.map(je=>je.id)))},ye=async()=>{if(S.size!==0){T(!0);try{for(const je of S)await de.delete(`/api/documents/${je}`);ze.success(`Deleted ${S.size} documents`),_(new Set),Yr()}catch(je){console.error("Error deleting documents:",je),ze.error("Failed to delete some documents")}finally{T(!1)}}},Be=i.filter(je=>{var ar;const Ot=je.displayName.toLowerCase().includes(d.toLowerCase())||je.name.toLowerCase().includes(d.toLowerCase()),Ds=N==="all"||((ar=je.category)==null?void 0:ar.name)===N;return Ot&&Ds}).sort((je,Ot)=>{let Ds=0;switch(y){case"name":Ds=je.displayName.localeCompare(Ot.displayName);break;case"date":Ds=new Date(je.uploadedAt).getTime()-new Date(Ot.uploadedAt).getTime();break;case"size":Ds=je.sizeBytes-Ot.sizeBytes;break;default:Ds=0}return b==="asc"?Ds:-Ds}),Ft=je=>{var Ds;const Ot=(Ds=je.target.files)==null?void 0:Ds[0];Ot&&(J(Ot),M(ar=>({...ar,displayName:Ot.name})))},Kt=async()=>{if(!L){ze.error("Please select a file to upload");return}try{p(!0);const je=new FormData;je.append("file",L),je.append("displayName",V.displayName),je.append("description",V.description),V.categoryId&&V.categoryId!=="none"&&je.append("categoryId",V.categoryId),V.workspaceId&&V.workspaceId!=="none"&&je.append("workspaceId",V.workspaceId),await de.post("/api/documents/upload",je),ze.success("Document uploaded successfully"),f(!1),J(null),M({displayName:"",description:"",categoryId:"",workspaceId:""}),await Yr()}catch{ze.error("Failed to upload document")}finally{p(!1)}},Jt=async je=>{try{const Ot=await fetch(`/api/documents/${je.id}/download`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":localStorage.getItem("company_id")||"cmg0qxjh9003nao3ftbaz1oc1"}});if(!Ot.ok)throw new Error("Download failed");const Ds=await Ot.blob(),ar=window.URL.createObjectURL(Ds),cn=document.createElement("a");cn.href=ar,cn.setAttribute("download",je.name),document.body.appendChild(cn),cn.click(),cn.remove(),window.URL.revokeObjectURL(ar),ze.success("Document downloaded successfully")}catch{ze.error("Failed to download document")}},kt=async je=>{try{q(!0),se(!1);const Ot=`${qi.api.baseUrl}/api/documents/stream/${je.id}?token=${localStorage.getItem("auth_token")}&tenantId=${localStorage.getItem("tenant_id")}&companyId=${localStorage.getItem("company_id")}`,Ds=await fetch(Ot,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":localStorage.getItem("company_id")||"cmg0lhcl3001d89wpa7q33k6y"}});if(!Ds.ok)throw new Error(`HTTP error! status: ${Ds.status}`);const ar=await Ds.blob(),cn=URL.createObjectURL(ar);be(cn),q(!1)}catch{se(!0),q(!1)}},gs=async je=>{try{$e(!0),te(!1);const Ot=`${qi.api.baseUrl}/api/documents/stream/${je.id}?token=${localStorage.getItem("auth_token")}&tenantId=${localStorage.getItem("tenant_id")}&companyId=${localStorage.getItem("company_id")}`,Ds=await fetch(Ot,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"tenant_demo","x-company-id":localStorage.getItem("company_id")||"cmg0lhcl3001d89wpa7q33k6y"}});if(!Ds.ok)throw new Error(`HTTP error! status: ${Ds.status}`);const ar=await Ds.text();Ae(ar),$e(!1)}catch{te(!0),$e(!1)}},fn=je=>{U(je),Q(!0),je.mimeType.startsWith("image/")?kt(je):je.mimeType.startsWith("text/")&&gs(je)},xi=async()=>{if(Z)try{await de.delete(`/api/documents/${Z.id}`),ze.success("Document deleted successfully"),await Yr()}catch{ze.error("Failed to delete document")}finally{le(!1),K(null)}},$n=()=>{he&&(URL.revokeObjectURL(he),be(null)),Q(!1),se(!1),q(!1),Ae(null),te(!1),$e(!1)};return e.jsx(Kr,{children:e.jsxs("div",{className:"flex-1 space-y-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Document Management & Intelligence"}),e.jsx("p",{className:"text-muted-foreground",children:"Enterprise-grade document management with AI-powered insights and advanced workflows"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(I,{variant:"outline",onClick:Yr,children:[e.jsx(or,{className:"mr-2 h-4 w-4"}),"Refresh Data"]}),e.jsxs(ts,{open:h,onOpenChange:f,children:[e.jsx(ki,{asChild:!0,children:e.jsxs(I,{onClick:()=>f(!0),children:[e.jsx(Pl,{className:"mr-2 h-4 w-4"}),"Upload Document"]})}),e.jsxs(ss,{className:"sm:max-w-[500px]",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Upload Document"}),e.jsx(Ks,{children:"Upload a new document to your workspace. Files will be stored securely and processed by AI."})]}),e.jsxs("div",{className:"grid gap-6 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(B,{htmlFor:"file",children:"File"}),e.jsx("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${k?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:mi,onDragLeave:Da,onDragOver:fi,onDrop:qa,children:L?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex items-center justify-center",children:(()=>{const je=Ea(L.type);return e.jsx(je,{className:"h-8 w-8 text-blue-500"})})()}),e.jsx("p",{className:"font-medium",children:L.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[(L.size/1024/1024).toFixed(2)," MB  ",L.type]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>{J(null),M(je=>({...je,displayName:""}))},children:[e.jsx(ma,{className:"mr-2 h-4 w-4"}),"Remove File"]})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(m6,{className:"h-8 w-8 text-gray-400 mx-auto"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:"Drop files here or click to browse"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Supports all file types up to 100MB"})]}),e.jsx(ge,{id:"file",type:"file",ref:G,onChange:Ft,accept:"*/*",className:"hidden"}),e.jsx(I,{type:"button",variant:"outline",size:"sm",onClick:()=>{var je;return(je=G.current)==null?void 0:je.click()},children:"Choose File"})]})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(B,{htmlFor:"displayName",children:"Display Name"}),e.jsx(ge,{id:"displayName",value:V.displayName,onChange:je=>M(Ot=>({...Ot,displayName:je.target.value})),placeholder:"Enter a descriptive name for your document",required:!0}),V.displayName&&V.displayName.length<3&&e.jsx("p",{className:"text-xs text-red-500",children:"Display name must be at least 3 characters"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(B,{htmlFor:"description",children:"Description"}),e.jsx(Xs,{id:"description",value:V.description,onChange:je=>M(Ot=>({...Ot,description:je.target.value})),placeholder:"Describe the document content and purpose...",rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Optional but helps with AI categorization and search"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(B,{htmlFor:"category",children:"Category"}),e.jsxs(rt,{value:V.categoryId,onValueChange:je=>M(Ot=>({...Ot,categoryId:je})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Auto-detect"})}),e.jsxs(at,{children:[e.jsx(W,{value:"auto",children:" Auto-detect with AI"}),e.jsx(W,{value:"none",children:" No specific category"}),e.jsx(W,{value:"financial",children:" Financial Documents"}),e.jsx(W,{value:"legal",children:" Legal & Contracts"}),e.jsx(W,{value:"technical",children:" Technical Documentation"}),e.jsx(W,{value:"invoice",children:" Invoices & Receipts"}),e.jsx(W,{value:"report",children:" Reports & Analytics"}),e.jsx(W,{value:"correspondence",children:" Correspondence"}),e.jsx(W,{value:"marketing",children:" Marketing Materials"}),e.jsx(W,{value:"hr",children:" HR & Personnel"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(B,{htmlFor:"workspace",children:"Workspace"}),e.jsxs(rt,{value:V.workspaceId,onValueChange:je=>M(Ot=>({...Ot,workspaceId:je})),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Default workspace"})}),e.jsxs(at,{children:[e.jsx(W,{value:"default",children:" Default Workspace"}),e.jsx(W,{value:"finance",children:" Finance Team"}),e.jsx(W,{value:"legal",children:" Legal Department"}),e.jsx(W,{value:"operations",children:" Operations"}),e.jsx(W,{value:"shared",children:" Shared Documents"})]})]})]})]}),e.jsxs("div",{className:"space-y-3 p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Za,{className:"h-4 w-4 text-blue-600"}),e.jsx(B,{className:"text-sm font-medium text-blue-800",children:"AI Processing Options"})]}),e.jsxs("div",{className:"grid gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"auto-categorize",defaultChecked:!0,className:"rounded border-gray-300"}),e.jsx(B,{htmlFor:"auto-categorize",className:"text-sm",children:"Auto-categorize with AI analysis"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"extract-text",defaultChecked:!0,className:"rounded border-gray-300"}),e.jsx(B,{htmlFor:"extract-text",className:"text-sm",children:"Extract text and generate summary"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"generate-tags",defaultChecked:!0,className:"rounded border-gray-300"}),e.jsx(B,{htmlFor:"generate-tags",className:"text-sm",children:"Generate smart tags for search"})]})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:L&&e.jsx("span",{children:"File will be processed with AI after upload"})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(I,{variant:"outline",onClick:()=>{f(!1),J(null),M({displayName:"",description:"",categoryId:"",workspaceId:""})},children:"Cancel"}),e.jsx(I,{onClick:Kt,disabled:!L||m||V.displayName.length<3,className:"min-w-24",children:m?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ts,{className:"h-4 w-4 animate-spin"}),"Uploading..."]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pl,{className:"h-4 w-4"}),"Upload & Process"]})})]})]})]})]})]})]}),e.jsxs(an,{defaultValue:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(on,{className:"grid w-full grid-cols-8",children:[e.jsx(vt,{value:"overview",children:"Overview"}),e.jsx(vt,{value:"all",children:"Documents"}),e.jsx(vt,{value:"ai",children:"AI Intelligence"}),e.jsx(vt,{value:"workflows",children:"Workflows"}),e.jsx(vt,{value:"security",children:"Security"}),e.jsx(vt,{value:"compliance",children:"Compliance"}),e.jsx(vt,{value:"analytics",children:"Analytics"}),e.jsx(vt,{value:"settings",children:"Settings"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Rn,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(ge,{placeholder:"Search documents...",className:"pl-10 w-64",value:d,onChange:je=>u(je.target.value)})]}),e.jsxs(tu,{children:[e.jsx(su,{asChild:!0,children:e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(Ic,{className:"mr-2 h-4 w-4"}),"Filter",e.jsx(tc,{className:"ml-2 h-4 w-4"})]})}),e.jsxs(ru,{align:"end",className:"w-48",children:[e.jsx(Pn,{onClick:()=>C("all"),children:"All Documents"}),e.jsx(Pn,{onClick:()=>C("Financial"),children:"Financial"}),e.jsx(Pn,{onClick:()=>C("Legal"),children:"Legal"}),e.jsx(Pn,{onClick:()=>C("Technical"),children:"Technical"})]})]}),e.jsxs(tu,{children:[e.jsx(su,{asChild:!0,children:e.jsxs(I,{variant:"outline",size:"sm",children:[b==="asc"?e.jsx(sY,{className:"mr-2 h-4 w-4"}):e.jsx(tY,{className:"mr-2 h-4 w-4"}),"Sort",e.jsx(tc,{className:"ml-2 h-4 w-4"})]})}),e.jsxs(ru,{align:"end",children:[e.jsx(Pn,{onClick:()=>{j("name"),w("asc")},children:"Name (A-Z)"}),e.jsx(Pn,{onClick:()=>{j("name"),w("desc")},children:"Name (Z-A)"}),e.jsx(Pn,{onClick:()=>{j("date"),w("desc")},children:"Newest First"}),e.jsx(Pn,{onClick:()=>{j("date"),w("asc")},children:"Oldest First"}),e.jsx(Pn,{onClick:()=>{j("size"),w("desc")},children:"Largest First"}),e.jsx(Pn,{onClick:()=>{j("size"),w("asc")},children:"Smallest First"})]})]}),e.jsxs("div",{className:"flex items-center border rounded-md",children:[e.jsx(I,{variant:g==="grid"?"default":"ghost",size:"sm",onClick:()=>v("grid"),className:"rounded-r-none",children:e.jsx(mY,{className:"h-4 w-4"})}),e.jsx(I,{variant:g==="list"?"default":"ghost",size:"sm",onClick:()=>v("list"),className:"rounded-l-none",children:e.jsx(pY,{className:"h-4 w-4"})})]})]})]}),e.jsxs(yt,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(ne,{className:"hover:shadow-md transition-shadow duration-200",children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Total Documents"}),e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Zt,{className:"h-4 w-4 text-blue-600"})})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-3xl font-bold",children:l?e.jsx("div",{className:"animate-pulse bg-gray-200 h-8 w-16 rounded"}):n.totalDocuments.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground flex items-center gap-1 mt-1",children:l?"Loading...":e.jsxs(e.Fragment,{children:[e.jsx($s,{className:"h-3 w-3 text-green-500"}),"Active documents"]})}),!l&&i.length>0&&e.jsx(No,{value:Math.min(n.totalDocuments/1e3*100,100),className:"mt-2"})]})]}),e.jsxs(ne,{className:"hover:shadow-md transition-shadow duration-200",children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Storage Used"}),e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(u6,{className:"h-4 w-4 text-purple-600"})})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-3xl font-bold text-purple-600",children:l?e.jsx("div",{className:"animate-pulse bg-gray-200 h-8 w-16 rounded"}):n.storageUsed}),e.jsx("p",{className:"text-xs text-muted-foreground flex items-center gap-1 mt-1",children:l?"Loading...":e.jsxs(e.Fragment,{children:[e.jsx(e1,{className:"h-3 w-3 text-purple-500"}),"Total storage"]})}),!l&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{children:"Used"}),e.jsx("span",{children:"75% of 10GB"})]}),e.jsx(No,{value:75,className:"h-2"})]})]})]}),e.jsxs(ne,{className:"hover:shadow-md transition-shadow duration-200",children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Pending Approvals"}),e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(Cr,{className:"h-4 w-4 text-yellow-600"})})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-600",children:Rt?e.jsx("div",{className:"animate-pulse bg-gray-200 h-8 w-16 rounded"}):fe.pendingApprovals}),e.jsx("p",{className:"text-xs text-muted-foreground flex items-center gap-1 mt-1",children:Rt?"Loading...":e.jsxs(e.Fragment,{children:[e.jsx(Is,{className:"h-3 w-3 text-yellow-500"}),"Require your review"]})}),!Rt&&fe.pendingApprovals>0&&e.jsx(I,{variant:"outline",size:"sm",className:"mt-2 w-full",children:"Review Now"})]})]}),e.jsxs(ne,{className:"hover:shadow-md transition-shadow duration-200",children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Active Workflows"}),e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(or,{className:"h-4 w-4 text-green-600"})})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:Rt?e.jsx("div",{className:"animate-pulse bg-gray-200 h-8 w-16 rounded"}):fe.activeWorkflows}),e.jsx("p",{className:"text-xs text-muted-foreground flex items-center gap-1 mt-1",children:Rt?"Loading...":e.jsxs(e.Fragment,{children:[e.jsx(Za,{className:"h-3 w-3 text-green-500"}),"Processing documents"]})}),!Rt&&e.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:["Avg. processing: ",fe.averageProcessingTime||0,"min"]})]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Za,{className:"h-5 w-5 text-blue-600"}),"Quick Actions"]}),e.jsx(Vt,{children:"Streamline your document management workflow"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2 hover:bg-blue-50 hover:border-blue-300",onClick:()=>f(!0),children:[e.jsx(Pl,{className:"h-6 w-6 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Upload Documents"})]}),e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2 hover:bg-green-50 hover:border-green-300",children:[e.jsx(hY,{className:"h-6 w-6 text-green-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Create Folder"})]}),e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2 hover:bg-purple-50 hover:border-purple-300",onClick:()=>ce(!0),children:[e.jsx(or,{className:"h-6 w-6 text-purple-600"}),e.jsx("span",{className:"text-sm font-medium",children:"New Workflow"})]}),e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2 hover:bg-orange-50 hover:border-orange-300",children:[e.jsx(Rn,{className:"h-6 w-6 text-orange-600"}),e.jsx("span",{className:"text-sm font-medium",children:"AI Search"})]})]})})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Document Intelligence Health"}),e.jsx(Vt,{children:"AI-powered document processing and analysis status"})]}),e.jsx(ie,{className:"space-y-4",children:Hs?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading AI health data..."})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"AI Processing"}),e.jsxs(Oe,{variant:"default",className:Ht.analyzedPercentage>=80?"bg-green-100 text-green-800":Ht.analyzedPercentage>=50?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800",children:[e.jsx(bs,{className:"mr-1 h-3 w-3"}),Ht.analyzedPercentage>=80?"Active":Ht.analyzedPercentage>=50?"Learning":"Needs Attention"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full",children:e.jsx("div",{className:`h-2 rounded-full ${Ht.analyzedPercentage>=80?"bg-green-500":Ht.analyzedPercentage>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Ht.analyzedPercentage}%`}})}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[Ht.analyzedPercentage,"% of documents processed with AI"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Quality Analysis"}),e.jsxs(Oe,{variant:"default",className:Ht.qualityScore>=80?"bg-green-100 text-green-800":Ht.qualityScore>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800",children:[e.jsx(bs,{className:"mr-1 h-3 w-3"}),Ht.qualityScore>=80?"Excellent":Ht.qualityScore>=60?"Good":"Needs Improvement"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full",children:e.jsx("div",{className:`h-2 rounded-full ${Ht.qualityScore>=80?"bg-green-500":Ht.qualityScore>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Ht.qualityScore}%`}})}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Average quality score: ",Ht.qualityScore,"%"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Smart Tags"}),e.jsxs(Oe,{variant:"default",className:Ht.smartTagsCount>0?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:[e.jsx(bs,{className:"mr-1 h-3 w-3"}),Ht.smartTagsCount>0?"Generated":"None"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full",children:e.jsx("div",{className:`h-2 rounded-full ${Ht.smartTagsCount>0?"bg-blue-500":"bg-gray-400"}`,style:{width:`${Math.min(100,Ht.smartTagsCount/10*100)}%`}})}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[Ht.smartTagsCount," smart tags generated"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Active Insights"}),e.jsxs(Oe,{variant:"secondary",className:Ht.activeInsights>0?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800",children:[e.jsx(or,{className:"mr-1 h-3 w-3"}),Ht.activeInsights>0?"Active":"None"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full",children:e.jsx("div",{className:`h-2 rounded-full ${Ht.activeInsights>0?"bg-purple-500":"bg-gray-400"}`,style:{width:`${Math.min(100,Ht.activeInsights/5*100)}%`}})}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[Ht.activeInsights," active insights available"]})]})]})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Recent AI Insights"}),e.jsx(Vt,{children:"Latest intelligent document analysis and recommendations"})]}),e.jsx(ie,{className:"space-y-4",children:Hs?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading AI insights..."})]}):We.length>0?e.jsx("div",{className:"space-y-3",children:We.slice(0,4).map((je,Ot)=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-green-100",children:e.jsx(Za,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx("p",{className:"text-sm font-medium",children:je.title}),e.jsx("p",{className:"text-xs text-muted-foreground",children:je.description}),e.jsx("p",{className:"text-xs text-muted-foreground",children:je.timestamp?new Date(je.timestamp).toLocaleString():"Recently"})]})]},Ot))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Za,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No AI insights available"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Upload more documents to generate insights"})]})})]})]})]}),e.jsxs(yt,{value:"all",className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Total Documents"}),e.jsx(Zt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:l?"...":n.totalDocuments.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:l?"Loading...":"Active documents"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Storage Used"}),e.jsx(u6,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:l?"...":n.storageUsed}),e.jsx("p",{className:"text-xs text-muted-foreground",children:l?"Loading...":"Total storage"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Pending Approvals"}),e.jsx(Cr,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:l?"...":n.pendingApprovals}),e.jsx("p",{className:"text-xs text-muted-foreground",children:l?"Loading...":"Require your review"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Shared Documents"}),e.jsx(hm,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:l?"...":n.sharedDocuments}),e.jsx("p",{className:"text-xs text-muted-foreground",children:l?"Loading...":"Active collaborations"})]})]})]}),S.size>0&&e.jsx(ne,{className:"border-l-4 border-l-blue-500",children:e.jsx(ie,{className:"pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-sm font-medium",children:[S.size," document",S.size!==1?"s":""," selected"]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>_(new Set),children:"Clear Selection"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(I,{variant:"outline",size:"sm",disabled:A,children:[e.jsx(An,{className:"mr-2 h-4 w-4"}),"Download All"]}),e.jsxs(I,{variant:"outline",size:"sm",disabled:A,children:[e.jsx(hm,{className:"mr-2 h-4 w-4"}),"Share"]}),e.jsxs(I,{variant:"destructive",size:"sm",onClick:ye,disabled:A,children:[A?e.jsx(Ts,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(hn,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Se,{children:"Document Library"}),e.jsxs(Vt,{children:[Be.length," document",Be.length!==1?"s":"",N!=="all"&&` in ${N}`]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:Be.length>0&&e.jsx(I,{variant:"outline",size:"sm",onClick:Dt,children:S.size===Be.length?"Deselect All":"Select All"})})]})}),e.jsxs(ie,{className:`transition-all duration-200 ${k?"bg-blue-50 border-2 border-dashed border-blue-300":""}`,onDragEnter:mi,onDragLeave:Da,onDragOver:fi,onDrop:qa,children:[k&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-blue-50 bg-opacity-90 z-10 rounded-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx(m6,{className:"h-12 w-12 text-blue-500 mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-medium text-blue-700",children:"Drop files here to upload"}),e.jsx("p",{className:"text-sm text-blue-600",children:"Release to start uploading"})]})}),l?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Loading documents..."})]}):Be.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Zt,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-medium text-muted-foreground mb-2",children:i.length===0?"No documents found":"No documents match your filters"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:i.length===0?"Upload your first document to get started":"Try adjusting your search or filter criteria"}),i.length===0&&e.jsxs(I,{onClick:()=>f(!0),children:[e.jsx(Pl,{className:"mr-2 h-4 w-4"}),"Upload Document"]})]}):g==="grid"?e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:Be.map(je=>{const Ot=Ea(je.mimeType),Ds=S.has(je.id);return e.jsx(ne,{className:`group cursor-pointer transition-all duration-200 hover:shadow-md ${Ds?"ring-2 ring-blue-500 bg-blue-50":""}`,onClick:()=>Ne(je.id),children:e.jsxs(ie,{className:"p-4",children:[e.jsxs("div",{className:"aspect-square bg-gray-100 rounded-lg mb-4 relative overflow-hidden",children:[je.mimeType.startsWith("image/")?e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Ot,{className:"h-12 w-12 text-blue-500"})}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(Ot,{className:"h-12 w-12 text-gray-400"})}),e.jsx("div",{className:`absolute top-2 left-2 w-5 h-5 rounded-full border-2 transition-all ${Ds?"bg-blue-500 border-blue-500":"border-gray-300 bg-white opacity-0 group-hover:opacity-100"}`,children:Ds&&e.jsx(bs,{className:"w-full h-full text-white"})}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx(I,{size:"sm",variant:"secondary",className:"h-8 w-8 p-0",onClick:ar=>{ar.stopPropagation(),U(je),Q(!0)},children:e.jsx(ir,{className:"h-3 w-3"})}),e.jsxs(tu,{children:[e.jsx(su,{asChild:!0,onClick:ar=>ar.stopPropagation(),children:e.jsx(I,{size:"sm",variant:"secondary",className:"h-8 w-8 p-0",children:e.jsx(x6,{className:"h-3 w-3"})})}),e.jsxs(ru,{align:"end",children:[e.jsxs(Pn,{onClick:()=>Jt(je),children:[e.jsx(An,{className:"mr-2 h-4 w-4"}),"Download"]}),e.jsxs(Pn,{children:[e.jsx(hm,{className:"mr-2 h-4 w-4"}),"Share"]}),e.jsxs(Pn,{children:[e.jsx(ac,{className:"mr-2 h-4 w-4"}),"Copy Link"]}),e.jsxs(Pn,{children:[e.jsx(ln,{className:"mr-2 h-4 w-4"}),"Rename"]}),e.jsxs(Pn,{onClick:()=>{K(je),le(!0)},className:"text-red-600",children:[e.jsx(hn,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-sm truncate",title:je.displayName,children:je.displayName}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:Ti(je.sizeBytes)}),e.jsx("span",{children:Ki(je.uploadedAt)})]}),je.category&&e.jsx(Oe,{variant:"secondary",className:"text-xs",children:je.category.name}),je.uploader&&e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(Kc,{className:"h-4 w-4",children:e.jsx(Yc,{className:"text-xs",children:je.uploader.name.charAt(0).toUpperCase()})}),e.jsx("span",{className:"truncate",children:je.uploader.name})]})]})]})},je.id)})}):e.jsx("div",{className:"space-y-2",children:Be.map(je=>{const Ot=Ea(je.mimeType),Ds=S.has(je.id);return e.jsx(ne,{className:`transition-all duration-200 hover:shadow-sm ${Ds?"ring-2 ring-blue-500 bg-blue-50":""}`,children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 cursor-pointer flex-1",onClick:()=>Ne(je.id),children:[e.jsx("div",{className:`w-5 h-5 rounded border-2 transition-all ${Ds?"bg-blue-500 border-blue-500":"border-gray-300"}`,children:Ds&&e.jsx(bs,{className:"w-full h-full text-white"})}),e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(Ot,{className:"h-5 w-5 text-gray-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-sm truncate",title:je.displayName,children:je.displayName}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsx("span",{children:Ti(je.sizeBytes)}),e.jsx("span",{children:Ki(je.uploadedAt)}),je.category&&e.jsx(Oe,{variant:"secondary",className:"text-xs",children:je.category.name}),je.uploader&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Kc,{className:"h-4 w-4",children:e.jsx(Yc,{className:"text-xs",children:je.uploader.name.charAt(0).toUpperCase()})}),e.jsx("span",{className:"truncate",children:je.uploader.name})]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{size:"sm",variant:"outline",onClick:()=>{U(je),Q(!0)},children:e.jsx(ir,{className:"h-4 w-4"})}),e.jsx(I,{size:"sm",variant:"outline",onClick:()=>Jt(je),children:e.jsx(An,{className:"h-4 w-4"})}),e.jsxs(tu,{children:[e.jsx(su,{asChild:!0,children:e.jsx(I,{size:"sm",variant:"outline",children:e.jsx(x6,{className:"h-4 w-4"})})}),e.jsxs(ru,{align:"end",children:[e.jsxs(Pn,{children:[e.jsx(hm,{className:"mr-2 h-4 w-4"}),"Share"]}),e.jsxs(Pn,{children:[e.jsx(ac,{className:"mr-2 h-4 w-4"}),"Copy Link"]}),e.jsxs(Pn,{children:[e.jsx(ln,{className:"mr-2 h-4 w-4"}),"Rename"]}),e.jsxs(Pn,{children:[e.jsx(go,{className:"mr-2 h-4 w-4"}),"Add to Favorites"]}),e.jsxs(Pn,{onClick:()=>{K(je),le(!0)},className:"text-red-600",children:[e.jsx(hn,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})]})})},je.id)})})]})]})]}),e.jsxs(yt,{value:"ai",className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"AI Analysis"}),e.jsx(ef,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[Ht.analyzedPercentage,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Documents analyzed"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Smart Tags"}),e.jsx(wa,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:Ht.smartTagsCount.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Auto-generated tags"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Insights"}),e.jsx($s,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:Ht.activeInsights}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Active insights"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Quality Score"}),e.jsx(or,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[Ht.qualityScore,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Average quality"})]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(ef,{className:"h-5 w-5 text-blue-600"}),"AI-Powered Document Analysis"]}),e.jsx(Vt,{children:"Advanced AI search, analysis, and insights for your documents"})]}),e.jsxs(ie,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Rn,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold",children:"AI-Powered Search"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ge,{placeholder:"Ask AI: 'Find contracts expiring this month' or 'Show me all invoices over $10,000'",className:"flex-1",value:Ns,onChange:je=>er(je.target.value),onKeyPress:je=>je.key==="Enter"&&Vr()}),e.jsxs(I,{onClick:Vr,disabled:Hs||!Ns.trim(),children:[e.jsx(ef,{className:"mr-2 h-4 w-4"}),Hs?"Searching...":"AI Search"]}),Ns&&e.jsx(I,{variant:"outline",onClick:Vn,children:"Clear"}),e.jsx(I,{variant:"outline",onClick:()=>wn(""),disabled:Hs,children:"Show All"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(I,{variant:"outline",size:"sm",onClick:()=>wn("contracts"),disabled:Hs,children:"Recent contracts"}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>wn("invoices"),disabled:Hs,children:"High-value invoices"}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>wn("expiring"),disabled:Hs,children:"Expiring documents"}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>wn("legal"),disabled:Hs,children:"Legal documents"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(or,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Document Quality Analysis"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Completeness"}),e.jsxs("span",{children:[Ct.completeness,"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full",children:e.jsx("div",{className:"h-2 bg-green-500 rounded-full",style:{width:`${Ct.completeness}%`}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Clarity"}),e.jsxs("span",{children:[Ct.clarity,"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full",children:e.jsx("div",{className:"h-2 bg-blue-500 rounded-full",style:{width:`${Ct.clarity}%`}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Compliance"}),e.jsxs("span",{children:[Ct.compliance,"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full",children:e.jsx("div",{className:"h-2 bg-purple-500 rounded-full",style:{width:`${Ct.compliance}%`}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Accessibility"}),e.jsxs("span",{children:[Ct.accessibility,"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full",children:e.jsx("div",{className:"h-2 bg-orange-500 rounded-full",style:{width:`${Ct.accessibility}%`}})})]})]})]})]})]}),qn&&e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Rn,{className:"h-5 w-5 text-blue-600"}),"AI Search Results"]}),e.jsxs(Vt,{children:["Found ",Ir.length,' documents matching "',Ns,'"']})]}),e.jsx(I,{variant:"outline",size:"sm",onClick:Vn,children:"Clear Search"})]})}),e.jsx(ie,{children:Ir.length>0?e.jsx("div",{className:"space-y-3",children:Ir.map((je,Ot)=>e.jsx("div",{className:"p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Zt,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("h4",{className:"font-medium",children:je.displayName||je.name}),je.aiScore&&e.jsxs(Oe,{variant:"secondary",className:"text-xs",children:["AI Score: ",Math.round(je.aiScore),"%"]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:je.description||"No description available"}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Type: ",je.mimeType]}),e.jsxs("span",{children:["Size: ",Ti(je.sizeBytes)]}),e.jsxs("span",{children:["Uploaded: ",new Date(je.uploadedAt).toLocaleDateString()]}),je.uploader&&e.jsxs("span",{children:["By: ",je.uploader.name]})]}),je.aiSummary&&e.jsxs("div",{className:"mt-2 p-2 bg-blue-50 rounded text-xs",children:[e.jsx("strong",{children:"AI Summary:"})," ",je.aiSummary]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsx(I,{size:"sm",variant:"outline",onClick:()=>fn(je),children:e.jsx(ir,{className:"h-3 w-3"})}),e.jsx(I,{size:"sm",variant:"outline",onClick:()=>Jt(je),children:e.jsx(An,{className:"h-3 w-3"})})]})]})},je.id||Ot))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Rn,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No documents found matching your search criteria."}),e.jsx(I,{variant:"outline",className:"mt-4",onClick:Vn,children:"Try Different Search"})]})})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(wa,{className:"h-5 w-5 text-green-600"}),"Smart Categorization"]}),e.jsx(Vt,{children:"AI suggestions for better document organization"})]}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[gt.map((je,Ot)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:je.category}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[je.suggestedCount," documents suggested (",Math.round(je.confidence*100),"% confidence)"]})]}),e.jsx(I,{size:"sm",variant:"outline",onClick:()=>ut(je),disabled:Hs,children:"Apply"})]},Ot)),gt.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No categorization suggestions available"})]}),e.jsxs(I,{variant:"outline",className:"w-full",onClick:Pe,disabled:Hs,children:[e.jsx(ef,{className:"mr-2 h-4 w-4"}),Hs?"Analyzing...":"Analyze All Documents"]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx($s,{className:"h-5 w-5 text-purple-600"}),"AI Insights & Recommendations"]}),e.jsx(Vt,{children:"Intelligent insights about your document collection"})]}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[We.map((je,Ot)=>e.jsx("div",{className:`p-3 rounded-lg border ${je.type==="warning"?"bg-amber-50 border-amber-200":je.type==="info"?"bg-blue-50 border-blue-200":je.type==="success"?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"}`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[je.type==="warning"&&e.jsx(Is,{className:"h-4 w-4 text-amber-600 mt-0.5"}),je.type==="info"&&e.jsx(Za,{className:"h-4 w-4 text-blue-600 mt-0.5"}),je.type==="success"&&e.jsx(bs,{className:"h-4 w-4 text-green-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:`font-medium text-sm ${je.type==="warning"?"text-amber-800":je.type==="info"?"text-blue-800":je.type==="success"?"text-green-800":"text-gray-800"}`,children:je.title}),e.jsx("p",{className:`text-xs ${je.type==="warning"?"text-amber-700":je.type==="info"?"text-blue-700":je.type==="success"?"text-green-700":"text-gray-700"}`,children:je.message})]})]})},Ot)),We.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No AI insights available"})]}),e.jsxs(I,{variant:"outline",className:"w-full",onClick:_t,disabled:Hs,children:[e.jsx(or,{className:"mr-2 h-4 w-4"}),Hs?"Generating...":"Generate Full Report"]})]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(wa,{className:"h-5 w-5 text-indigo-600"}),"Automated Tagging & Metadata Extraction"]}),e.jsx(Vt,{children:"AI automatically extracts metadata and suggests tags for better organization"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Recent AI Extractions"}),e.jsxs("div",{className:"space-y-2",children:[ms.map((je,Ot)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Zt,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:je.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[je.status==="completed"?"Extracted:":"Extracting:"," ",je.extractedFields.join(", ")]})]})]}),e.jsx(Oe,{variant:je.status==="completed"?"secondary":"outline",className:je.status==="processing"?"text-blue-600":"",children:je.status==="completed"?"Completed":"Processing"})]},Ot)),ms.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No recent extractions available"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Auto-Generated Tags"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[Pt.map((je,Ot)=>e.jsxs(Oe,{variant:"secondary",className:"text-sm",children:[je.name," (",je.count,")"]},Ot)),Pt.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"No tags available"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{onClick:bt,disabled:Hs,children:[e.jsx(wa,{className:"mr-2 h-4 w-4"}),Hs?"Extracting...":"Extract All Metadata"]}),e.jsxs(I,{variant:"outline",onClick:ps,children:[e.jsx(or,{className:"mr-2 h-4 w-4"}),"Manage Tags"]})]})]})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(ef,{className:"h-5 w-5 text-teal-600"}),"AI Document Summarization"]}),e.jsx(Vt,{children:"Generate intelligent summaries and key insights from your documents"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2",onClick:()=>De("individual"),disabled:Hs,children:[e.jsx(Zt,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Individual Summaries"})]}),e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2",onClick:()=>De("collection"),disabled:Hs,children:[e.jsx(or,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Collection Overview"})]}),e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2",onClick:()=>De("trend"),disabled:Hs,children:[e.jsx($s,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Trend Analysis"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Recent AI Summaries"}),e.jsxs("div",{className:"space-y-3",children:[Vs.map((je,Ot)=>e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h5",{className:"font-medium text-sm",children:je.title}),e.jsx(Oe,{variant:"outline",className:"text-xs",children:new Date(je.createdAt).toLocaleTimeString()})]}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:je.content}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>Pr(je),children:"View Details"}),e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>Wr(je),children:"Export"})]})]},Ot)),Vs.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No AI summaries available"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{onClick:()=>De("general"),disabled:Hs,children:[e.jsx(ef,{className:"mr-2 h-4 w-4"}),Hs?"Generating...":"Generate New Summary"]}),e.jsxs(I,{variant:"outline",onClick:$r,children:[e.jsx(or,{className:"mr-2 h-4 w-4"}),"Refresh Data"]})]})]})})]})]}),e.jsxs(yt,{value:"workflows",className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Active Workflows"}),e.jsx(or,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:Rt?"...":fe.activeWorkflows}),e.jsx("p",{className:"text-xs text-muted-foreground",children:Rt?"Loading...":"Active workflows"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Pending Approvals"}),e.jsx(Cr,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:Rt?"...":fe.pendingApprovals}),e.jsx("p",{className:"text-xs text-muted-foreground",children:Rt?"Loading...":"Awaiting review"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Completed Today"}),e.jsx(bs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:Rt?"...":fe.completedToday}),e.jsx("p",{className:"text-xs text-muted-foreground",children:Rt?"Loading...":"Processed today"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Avg. Processing Time"}),e.jsx(wa,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:Rt?"...":`${fe.averageProcessingTime.toFixed(1)}h`}),e.jsx("p",{className:"text-xs text-muted-foreground",children:Rt?"Loading...":"Average time"})]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(or,{className:"h-5 w-5 text-blue-600"}),"Quick Actions"]}),e.jsx(Vt,{children:"Common workflow operations and shortcuts"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2",onClick:()=>ce(!0),children:[e.jsx(or,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Create Workflow"})]}),e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2",onClick:()=>ue(!0),children:[e.jsx(Cr,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Review Pending"})]}),e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2",onClick:()=>Le(!0),children:[e.jsx(Zt,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Templates"})]}),e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2",onClick:()=>tt(!0),children:[e.jsx($s,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Analytics"})]}),e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2",onClick:Hi,disabled:Rt,children:[e.jsx(or,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:Rt?"Refreshing...":"Refresh"})]})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(or,{className:"h-5 w-5 text-green-600"}),"Active Workflows"]}),e.jsx(Vt,{children:"Currently running document processing workflows"})]}),e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(or,{className:"mr-2 h-4 w-4"}),"View All"]})]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:Rt?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading workflows..."})]}):dt.length>0?dt.map(je=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${je.status==="active"?"bg-green-500":je.status==="paused"?"bg-yellow-500":"bg-gray-400"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:je.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:je.description})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Oe,{variant:je.status==="active"?"secondary":"outline",children:je.status.charAt(0).toUpperCase()+je.status.slice(1)}),e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>cr(je.id),children:e.jsx(ir,{className:"h-4 w-4"})})]})]},je.id)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(or,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No workflows found"}),e.jsx(I,{variant:"outline",className:"mt-4",onClick:()=>ce(!0),children:"Create First Workflow"})]})})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Cr,{className:"h-5 w-5 text-amber-600"}),"Pending Approvals"]}),e.jsx(Vt,{children:"Documents awaiting your review and approval"})]}),e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(Cr,{className:"mr-2 h-4 w-4"}),"View All"]})]})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-3",children:Rt?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading pending approvals..."})]}):(()=>{const je=dt.filter(Ot=>Ot.status==="paused"||Ot.status==="pending");return je.length>0?je.map(Ot=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-amber-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:Ot.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:Ot.description}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Assigned ",new Date(Ot.createdAt).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>Zs(Ot.id),children:[e.jsx(bs,{className:"h-4 w-4 mr-1"}),"Approve"]}),e.jsxs(I,{size:"sm",variant:"outline",onClick:()=>wr(Ot.id),children:[e.jsx(Is,{className:"h-4 w-4 mr-1"}),"Reject"]})]})]},Ot.id)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Cr,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No pending approvals"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"All documents are up to date"})]})})()})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(Zt,{className:"h-5 w-5 text-purple-600"}),"Workflow Templates"]}),e.jsx(Vt,{children:"Pre-built workflow templates for common document processes"})]}),e.jsx(ie,{children:e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:Rt?e.jsxs("div",{className:"col-span-full text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading templates..."})]}):qe.length>0?qe.map(je=>e.jsxs("div",{className:"p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Zt,{className:"h-4 w-4 text-blue-600"}),e.jsx("h4",{className:"font-medium",children:je.name})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:je.description}),e.jsx(I,{size:"sm",variant:"outline",className:"w-full",onClick:()=>xa(je.name),children:"Use Template"})]},je.id)):e.jsxs("div",{className:"col-span-full text-center py-8",children:[e.jsx(Zt,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No templates available"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Workflow templates will appear here when available"})]})})})]})]}),e.jsxs(yt,{value:"security",className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Security Score"}),e.jsx(kn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:`text-2xl font-bold ${Xe!=null&&Xe.securityScore&&Xe.securityScore>=90?"text-green-600":Xe!=null&&Xe.securityScore&&Xe.securityScore>=70?"text-yellow-600":"text-red-600"}`,children:[(Xe==null?void 0:Xe.securityScore)||0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:Xe!=null&&Xe.securityScore&&Xe.securityScore>=90?"Excellent security posture":Xe!=null&&Xe.securityScore&&Xe.securityScore>=70?"Good security posture":"Needs improvement"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Active Sessions"}),e.jsx(Sa,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(Xe==null?void 0:Xe.activeSessions)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Across all users"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Failed Logins"}),e.jsx(Is,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:`text-2xl font-bold ${Xe!=null&&Xe.failedLogins&&Xe.failedLogins>10?"text-red-600":Xe!=null&&Xe.failedLogins&&Xe.failedLogins>5?"text-yellow-600":"text-green-600"}`,children:(Xe==null?void 0:Xe.failedLogins)||0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Last 24 hours"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Compliance Status"}),e.jsx(bs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[(Xe==null?void 0:Xe.complianceStatus)||0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"SOC 2 Type II compliant"})]})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Security Health Check"}),e.jsx(Vt,{children:"Current security status across all systems"})]}),e.jsx(ie,{className:"space-y-4",children:qt?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading security data..."})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Two-Factor Authentication"}),e.jsxs(Oe,{variant:"default",className:(Xe==null?void 0:Xe.mfaPercentage)===100?"bg-green-100 text-green-800":Xe!=null&&Xe.mfaPercentage&&Xe.mfaPercentage>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800",children:[e.jsx(bs,{className:"mr-1 h-3 w-3"}),(Xe==null?void 0:Xe.mfaPercentage)===100?"Enabled":Xe!=null&&Xe.mfaPercentage&&Xe.mfaPercentage>0?"Partial":"Disabled"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${(Xe==null?void 0:Xe.mfaPercentage)||0}%`}})}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(Xe==null?void 0:Xe.mfaEnabled)||0," of ",(Xe==null?void 0:Xe.totalUsers)||0," users have 2FA enabled (",(Xe==null?void 0:Xe.mfaPercentage)||0,"%)"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Data Encryption"}),e.jsxs(Oe,{variant:"default",className:"bg-green-100 text-green-800",children:[e.jsx(bs,{className:"mr-1 h-3 w-3"}),"Active"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full w-full"})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"AES-256 encryption at rest and in transit"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Access Controls"}),e.jsxs(Oe,{variant:"default",className:"bg-green-100 text-green-800",children:[e.jsx(bs,{className:"mr-1 h-3 w-3"}),"Enforced"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full w-full"})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Role-based access control implemented"})]})]})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Recent Security Events"}),e.jsx(Vt,{children:"Latest security activities and alerts"})]}),e.jsx(ie,{children:qt?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading security events..."})]}):fs.length>0?e.jsx("div",{className:"space-y-3",children:fs.slice(0,5).map((je,Ot)=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${je.severity==="high"?"bg-red-500":je.severity==="medium"?"bg-yellow-500":"bg-green-500"}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:je.action}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[je.user,"  ",new Date(je.timestamp).toLocaleString()]})]})]},Ot))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(or,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No recent security events"})]})})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Active Sessions"}),e.jsx(Vt,{children:"Current user sessions and device information"})]}),e.jsx(ie,{children:qt?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading sessions..."})]}):It.length>0?e.jsx("div",{className:"space-y-3",children:It.slice(0,5).map((je,Ot)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(jf,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:je.deviceName||"Unknown Device"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[je.browser||"Unknown Browser","  ",je.location||"Unknown Location"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Last active: ",new Date(je.lastActivity).toLocaleString()]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Oe,{variant:je.isCurrent?"default":"secondary",children:je.isCurrent?"Current":"Active"}),!je.isCurrent&&e.jsx(I,{size:"sm",variant:"outline",children:e.jsx(hn,{className:"h-4 w-4"})})]})]},Ot))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Sa,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No active sessions found"})]})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Quick Security Actions"}),e.jsx(Vt,{children:"Common security management tasks"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2",children:[e.jsx(cf,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Enable 2FA"})]}),e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2",children:[e.jsx(Sa,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Manage Users"})]}),e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2",children:[e.jsx(kn,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Security Settings"})]}),e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2",onClick:Gi,children:[e.jsx(Ts,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:qt?"Refreshing...":"Refresh"})]})]})})]})]}),e.jsxs(yt,{value:"compliance",className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Overall Compliance"}),e.jsx(kn,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:`text-2xl font-bold ${St!=null&&St.overallScore&&St.overallScore>=90?"text-green-600":St!=null&&St.overallScore&&St.overallScore>=70?"text-yellow-600":"text-red-600"}`,children:[(St==null?void 0:St.overallScore)||0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:St!=null&&St.overallScore&&St.overallScore>=90?"Fully Compliant":St!=null&&St.overallScore&&St.overallScore>=70?"Mostly Compliant":"Needs Attention"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"MFA Adoption"}),e.jsx(bs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:`text-2xl font-bold ${(Yi=(Ur=St==null?void 0:St.standards)==null?void 0:Ur[0])!=null&&Yi.score&&St.standards[0].score>=90?"text-green-600":(rn=(Ji=St==null?void 0:St.standards)==null?void 0:Ji[0])!=null&&rn.score&&St.standards[0].score>=50?"text-yellow-600":"text-red-600"}`,children:[((zo=(Ll=St==null?void 0:St.standards)==null?void 0:Ll[0])==null?void 0:zo.score)||0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:((Xi=(Qo=St==null?void 0:St.standards)==null?void 0:Qo[0])==null?void 0:Xi.status)==="certified"?"Fully Certified":((qo=(_o=St==null?void 0:St.standards)==null?void 0:_o[0])==null?void 0:qo.status)==="compliant"?"Compliant":"Non-Compliant"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Security Monitoring"}),e.jsx(or,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:`text-2xl font-bold ${(Zo=($l=St==null?void 0:St.standards)==null?void 0:$l[1])!=null&&Zo.score&&St.standards[1].score>=90?"text-green-600":(ot=(el=St==null?void 0:St.standards)==null?void 0:el[1])!=null&&ot.score&&St.standards[1].score>=70?"text-yellow-600":"text-red-600"}`,children:[((Sn=(qs=St==null?void 0:St.standards)==null?void 0:qs[1])==null?void 0:Sn.score)||0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:((Fn=(hr=St==null?void 0:St.standards)==null?void 0:hr[1])==null?void 0:Fn.status)==="certified"?"Fully Monitored":(($=(Rr=St==null?void 0:St.standards)==null?void 0:Rr[1])==null?void 0:$.status)==="compliant"?"Monitored":"Needs Setup"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Audit Readiness"}),e.jsx(Is,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:`text-2xl font-bold ${(ds=(Xt=St==null?void 0:St.standards)==null?void 0:Xt[2])!=null&&ds.score&&St.standards[2].score>=90?"text-green-600":(H=(Us=St==null?void 0:St.standards)==null?void 0:Us[2])!=null&&H.score&&St.standards[2].score>=70?"text-yellow-600":"text-red-600"}`,children:[((Ge=(Ce=St==null?void 0:St.standards)==null?void 0:Ce[2])==null?void 0:Ge.score)||0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:((wt=(ht=St==null?void 0:St.standards)==null?void 0:ht[2])==null?void 0:wt.status)==="certified"?"Audit Ready":((vs=(Qt=St==null?void 0:St.standards)==null?void 0:Qt[2])==null?void 0:vs.status)==="compliant"?"Mostly Ready":"Needs Work"})]})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Compliance Standards"}),e.jsx(Vt,{children:"Current compliance status across different standards"})]}),e.jsx(ie,{className:"space-y-4",children:qt?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading compliance data..."})]}):St!=null&&St.standards?e.jsx("div",{className:"space-y-3",children:St.standards.map((je,Ot)=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${je.status==="certified"?"bg-green-100":je.status==="compliant"?"bg-blue-100":"bg-yellow-100"}`,children:je.status==="certified"?e.jsx(bs,{className:"h-4 w-4 text-green-600"}):je.status==="compliant"?e.jsx(kn,{className:"h-4 w-4 text-blue-600"}):e.jsx(Is,{className:"h-4 w-4 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:je.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:je.description})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:`text-lg font-bold ${je.score>=90?"text-green-600":je.score>=70?"text-yellow-600":"text-red-600"}`,children:[je.score,"%"]}),e.jsxs(Oe,{variant:"default",className:je.status==="certified"?"bg-green-100 text-green-800":je.status==="compliant"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800",children:[je.status==="certified"?e.jsx(bs,{className:"mr-1 h-3 w-3"}):je.status==="compliant"?e.jsx(kn,{className:"mr-1 h-3 w-3"}):e.jsx(Is,{className:"mr-1 h-3 w-3"}),je.status==="certified"?"Certified":je.status==="compliant"?"Compliant":"Non-Compliant"]})]})]},Ot))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(kn,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No compliance standards found"})]})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Required Actions"}),e.jsx(Vt,{children:"Compliance tasks and recommendations"})]}),e.jsx(ie,{children:qt?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading compliance actions..."})]}):et.length>0?e.jsx("div",{className:"space-y-3",children:et.map((je,Ot)=>e.jsxs("div",{className:`flex items-center space-x-3 p-3 border rounded-lg ${je.priority==="high"?"bg-red-50":je.priority==="medium"?"bg-yellow-50":"bg-blue-50"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${je.priority==="high"?"bg-red-500":je.priority==="medium"?"bg-yellow-500":"bg-blue-500"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium",children:je.title}),e.jsx("p",{className:"text-xs text-muted-foreground",children:je.description}),e.jsx("p",{className:"text-xs text-muted-foreground",children:je.status==="completed"?`Completed: ${new Date(je.dueDate).toLocaleDateString()}`:je.status==="pending"?`Due: ${new Date(je.dueDate).toLocaleDateString()}`:`Status: ${je.status}`})]}),e.jsx("div",{className:"flex items-center space-x-2",children:je.status==="completed"?e.jsxs(Oe,{variant:"default",className:"bg-green-100 text-green-800",children:[e.jsx(bs,{className:"mr-1 h-3 w-3"}),"Done"]}):je.priority==="high"?e.jsx(I,{size:"sm",variant:"destructive",children:"Urgent"}):e.jsx(I,{size:"sm",variant:"outline",children:je.priority==="medium"?"Review":"Schedule"})})]},Ot))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(bs,{className:"h-12 w-12 text-green-500 mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No pending compliance actions"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"All compliance requirements are up to date"})]})})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Compliance Reports"}),e.jsx(Vt,{children:"Generate and download compliance reports based on current data"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{className:"p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(Zt,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Compliance Overview"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Overall compliance status: ",(St==null?void 0:St.overallScore)||0,"%"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Generated: ",new Date().toLocaleDateString()]}),e.jsxs(I,{size:"sm",variant:"outline",children:[e.jsx(An,{className:"h-4 w-4 mr-1"}),"Download"]})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(bs,{className:"h-4 w-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Security Standards"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[((Js=St==null?void 0:St.standards)==null?void 0:Js.length)||0," standards tracked"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Generated: ",new Date().toLocaleDateString()]}),e.jsxs(I,{size:"sm",variant:"outline",children:[e.jsx(An,{className:"h-4 w-4 mr-1"}),"Download"]})]})]}),e.jsxs("div",{className:"p-4 border rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("div",{className:"w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center",children:e.jsx(or,{className:"h-4 w-4 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Action Items"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[et.length," pending actions"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Generated: ",new Date().toLocaleDateString()]}),e.jsxs(I,{size:"sm",variant:"outline",children:[e.jsx(An,{className:"h-4 w-4 mr-1"}),"Download"]})]})]})]})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Quick Compliance Actions"}),e.jsx(Vt,{children:"Common compliance management tasks"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2",children:[e.jsx(Zt,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Generate Report"})]}),e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2",children:[e.jsx(or,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Run Assessment"})]}),e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2",children:[e.jsx(kn,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Update Policies"})]}),e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2",onClick:Gi,children:[e.jsx(Ts,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:qt?"Refreshing...":"Refresh"})]})]})})]})]}),e.jsxs(yt,{value:"analytics",className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Total Documents"}),e.jsx(Zt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.totalDocuments}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"+12% from last month"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Storage Used"}),e.jsx(e1,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n.storageUsed}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[Math.round(parseFloat(n.storageUsed)*.8)," GB available"]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"AI Processed"}),e.jsx(ef,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:Ht.analyzedDocuments}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[Ht.analyzedPercentage,"% of total documents"]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Active Workflows"}),e.jsx(or,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:fe.activeWorkflows}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[fe.pendingApprovals," pending approvals"]})]})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Document Upload Trends"}),e.jsx(Vt,{children:"Document uploads over the last 30 days"})]}),e.jsx(ie,{children:e.jsx("div",{className:"h-[300px] flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx($s,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Upload trends chart"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[i.length," documents uploaded this month"]})]})})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Document Categories"}),e.jsx(Vt,{children:"Distribution of documents by category"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),e.jsx("span",{className:"text-sm",children:"Invoices"})]}),e.jsx("span",{className:"text-sm font-medium",children:"35%"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:"35%"}})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),e.jsx("span",{className:"text-sm",children:"Receipts"})]}),e.jsx("span",{className:"text-sm font-medium",children:"28%"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"28%"}})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),e.jsx("span",{className:"text-sm",children:"Contracts"})]}),e.jsx("span",{className:"text-sm font-medium",children:"20%"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-yellow-500 h-2 rounded-full",style:{width:"20%"}})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-purple-500"}),e.jsx("span",{className:"text-sm",children:"Other"})]}),e.jsx("span",{className:"text-sm font-medium",children:"17%"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-purple-500 h-2 rounded-full",style:{width:"17%"}})})]})})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"AI Performance Metrics"}),e.jsx(Vt,{children:"AI processing efficiency and accuracy"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:[Ht.qualityScore,"%"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Average Quality Score"}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${Ht.qualityScore}%`}})})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:Ht.smartTagsCount}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Smart Tags Generated"}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(100,Ht.smartTagsCount/50*100)}%`}})})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-purple-600",children:Ht.activeInsights}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Insights"}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:e.jsx("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(100,Ht.activeInsights/20*100)}%`}})})]})]})})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Recent Document Activity"}),e.jsx(Vt,{children:"Latest document uploads and modifications"})]}),e.jsx(ie,{children:i.length>0?e.jsx("div",{className:"space-y-3",children:i.slice(0,5).map(je=>{var Ot;return e.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(Zt,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:je.displayName}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Uploaded ",new Date(je.uploadedAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:Ti(je.sizeBytes)}),e.jsx(Oe,{variant:"secondary",className:"text-xs",children:((Ot=je.mimeType.split("/")[1])==null?void 0:Ot.toUpperCase())||"FILE"})]})]},je.id)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Zt,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No recent activity"})]})})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Workflow Performance"}),e.jsx(Vt,{children:"Workflow completion rates and processing times"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Completion Rate"}),e.jsxs("span",{className:"text-sm font-bold text-green-600",children:[fe.completedToday>0?Math.round(fe.completedToday/fe.activeWorkflows*100):0,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${fe.completedToday>0?Math.round(fe.completedToday/fe.activeWorkflows*100):0}%`}})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Avg. Processing Time"}),e.jsxs("span",{className:"text-sm font-bold text-blue-600",children:[fe.averageProcessingTime,"h"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(100,fe.averageProcessingTime/24*100)}%`}})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Pending Approvals"}),e.jsx("span",{className:"text-sm font-bold text-yellow-600",children:fe.pendingApprovals})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-yellow-600 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(100,fe.pendingApprovals/10*100)}%`}})})]})})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Quick Analytics Actions"}),e.jsx(Vt,{children:"Generate reports and export analytics data"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2",children:[e.jsx(Zt,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Export Report"})]}),e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2",children:[e.jsx($s,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"View Trends"})]}),e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2",children:[e.jsx(or,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:"Performance"})]}),e.jsxs(I,{variant:"outline",className:"h-20 flex-col gap-2",onClick:Yr,children:[e.jsx(Ts,{className:"h-6 w-6"}),e.jsx("span",{className:"text-sm",children:l?"Refreshing...":"Refresh"})]})]})})]})]}),e.jsxs(yt,{value:"settings",className:"space-y-6",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"General Settings"}),e.jsx(Vt,{children:"Basic document management preferences"})]}),e.jsxs(ie,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"auto-categorization",children:"Auto-categorization"}),e.jsxs(rt,{defaultValue:"enabled",children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select option"})}),e.jsxs(at,{children:[e.jsx(W,{value:"enabled",children:"Enabled"}),e.jsx(W,{value:"disabled",children:"Disabled"}),e.jsx(W,{value:"manual",children:"Manual Only"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically categorize documents using AI"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"file-size-limit",children:"File Size Limit (MB)"}),e.jsx(ge,{id:"file-size-limit",type:"number",defaultValue:"100",placeholder:"100"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Maximum file size for uploads"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"retention-period",children:"Retention Period (days)"}),e.jsx(ge,{id:"retention-period",type:"number",defaultValue:"365",placeholder:"365"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"How long to keep documents before archiving"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"auto-delete",children:"Auto-delete Drafts"}),e.jsxs(rt,{defaultValue:"30",children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select option"})}),e.jsxs(at,{children:[e.jsx(W,{value:"7",children:"After 7 days"}),e.jsx(W,{value:"30",children:"After 30 days"}),e.jsx(W,{value:"90",children:"After 90 days"}),e.jsx(W,{value:"never",children:"Never"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically delete draft documents"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"notifications",defaultChecked:!0,className:"rounded border-gray-300"}),e.jsx(B,{htmlFor:"notifications",className:"text-sm",children:"Enable email notifications for document processing"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"watermark",defaultChecked:!0,className:"rounded border-gray-300"}),e.jsx(B,{htmlFor:"watermark",className:"text-sm",children:"Add watermarks to downloaded documents"})]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"AI Processing Settings"}),e.jsx(Vt,{children:"Configure AI-powered document analysis and processing"})]}),e.jsxs(ie,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"ai-model",children:"AI Model"}),e.jsxs(rt,{defaultValue:"gemma2:2b",children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select AI model"})}),e.jsxs(at,{children:[e.jsx(W,{value:"gemma2:2b",children:"Gemma 2B (Fast)"}),e.jsx(W,{value:"gemma2:9b",children:"Gemma 9B (Accurate)"}),e.jsx(W,{value:"llama3:8b",children:"Llama 3 8B (Balanced)"}),e.jsx(W,{value:"llama3:70b",children:"Llama 3 70B (Most Accurate)"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Choose the AI model for document processing"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"processing-timeout",children:"Processing Timeout (seconds)"}),e.jsx(ge,{id:"processing-timeout",type:"number",defaultValue:"30",placeholder:"30"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Maximum time for AI processing"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"confidence-threshold",children:"Confidence Threshold (%)"}),e.jsx(ge,{id:"confidence-threshold",type:"number",defaultValue:"80",placeholder:"80",min:"0",max:"100"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Minimum confidence for AI predictions"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"batch-size",children:"Batch Processing Size"}),e.jsx(ge,{id:"batch-size",type:"number",defaultValue:"5",placeholder:"5"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Number of documents to process in parallel"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium",children:"AI Features"}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"auto-tagging",defaultChecked:!0,className:"rounded border-gray-300"}),e.jsx(B,{htmlFor:"auto-tagging",className:"text-sm",children:"Automatic Tagging"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"quality-analysis",defaultChecked:!0,className:"rounded border-gray-300"}),e.jsx(B,{htmlFor:"quality-analysis",className:"text-sm",children:"Quality Analysis"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"metadata-extraction",defaultChecked:!0,className:"rounded border-gray-300"}),e.jsx(B,{htmlFor:"metadata-extraction",className:"text-sm",children:"Metadata Extraction"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"content-summarization",defaultChecked:!0,className:"rounded border-gray-300"}),e.jsx(B,{htmlFor:"content-summarization",className:"text-sm",children:"Content Summarization"})]})]})]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Workflow Settings"}),e.jsx(Vt,{children:"Configure document workflow automation and approval processes"})]}),e.jsxs(ie,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"default-workflow",children:"Default Workflow"}),e.jsxs(rt,{defaultValue:"invoice-processing",children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select default workflow"})}),e.jsxs(at,{children:[e.jsx(W,{value:"invoice-processing",children:"Invoice Processing"}),e.jsx(W,{value:"contract-review",children:"Contract Review"}),e.jsx(W,{value:"document-classification",children:"Document Classification"}),e.jsx(W,{value:"expense-approval",children:"Expense Approval"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Default workflow for new documents"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"approval-timeout",children:"Approval Timeout (hours)"}),e.jsx(ge,{id:"approval-timeout",type:"number",defaultValue:"72",placeholder:"72"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Time before approval requests expire"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"escalation-levels",children:"Escalation Levels"}),e.jsx(ge,{id:"escalation-levels",type:"number",defaultValue:"3",placeholder:"3",min:"1",max:"5"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Number of escalation levels for approvals"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"parallel-approvals",children:"Parallel Approvals"}),e.jsxs(rt,{defaultValue:"enabled",children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select option"})}),e.jsxs(at,{children:[e.jsx(W,{value:"enabled",children:"Enabled"}),e.jsx(W,{value:"disabled",children:"Disabled"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Allow multiple approvers to work in parallel"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Workflow Notifications"}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"workflow-email",defaultChecked:!0,className:"rounded border-gray-300"}),e.jsx(B,{htmlFor:"workflow-email",className:"text-sm",children:"Email Notifications"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"workflow-sms",className:"rounded border-gray-300"}),e.jsx(B,{htmlFor:"workflow-sms",className:"text-sm",children:"SMS Notifications"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"workflow-slack",className:"rounded border-gray-300"}),e.jsx(B,{htmlFor:"workflow-slack",className:"text-sm",children:"Slack Notifications"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"workflow-reminders",defaultChecked:!0,className:"rounded border-gray-300"}),e.jsx(B,{htmlFor:"workflow-reminders",className:"text-sm",children:"Automatic Reminders"})]})]})]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Security Settings"}),e.jsx(Vt,{children:"Configure document security and access controls"})]}),e.jsxs(ie,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"encryption-level",children:"Encryption Level"}),e.jsxs(rt,{defaultValue:"aes-256",children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select encryption level"})}),e.jsxs(at,{children:[e.jsx(W,{value:"aes-128",children:"AES-128"}),e.jsx(W,{value:"aes-256",children:"AES-256"}),e.jsx(W,{value:"aes-512",children:"AES-512"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Document encryption strength"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"session-timeout",children:"Session Timeout (minutes)"}),e.jsx(ge,{id:"session-timeout",type:"number",defaultValue:"60",placeholder:"60"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"User session timeout duration"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"password-policy",children:"Password Policy"}),e.jsxs(rt,{defaultValue:"strong",children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select password policy"})}),e.jsxs(at,{children:[e.jsx(W,{value:"basic",children:"Basic (8+ characters)"}),e.jsx(W,{value:"medium",children:"Medium (12+ characters, mixed case)"}),e.jsx(W,{value:"strong",children:"Strong (16+ characters, special chars)"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Password complexity requirements"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"mfa-required",children:"MFA Requirement"}),e.jsxs(rt,{defaultValue:"optional",children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select MFA requirement"})}),e.jsxs(at,{children:[e.jsx(W,{value:"disabled",children:"Disabled"}),e.jsx(W,{value:"optional",children:"Optional"}),e.jsx(W,{value:"required",children:"Required for All"}),e.jsx(W,{value:"admin-only",children:"Required for Admins"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Multi-factor authentication requirements"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Access Controls"}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"ip-whitelist",className:"rounded border-gray-300"}),e.jsx(B,{htmlFor:"ip-whitelist",className:"text-sm",children:"IP Whitelist"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"audit-logging",defaultChecked:!0,className:"rounded border-gray-300"}),e.jsx(B,{htmlFor:"audit-logging",className:"text-sm",children:"Audit Logging"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"document-watermarking",defaultChecked:!0,className:"rounded border-gray-300"}),e.jsx(B,{htmlFor:"document-watermarking",className:"text-sm",children:"Document Watermarking"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"download-tracking",defaultChecked:!0,className:"rounded border-gray-300"}),e.jsx(B,{htmlFor:"download-tracking",className:"text-sm",children:"Download Tracking"})]})]})]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Save Settings"}),e.jsx(Vt,{children:"Apply your configuration changes"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Changes will be applied immediately and affect all users"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(I,{variant:"outline",children:"Reset to Defaults"}),e.jsx(I,{children:"Save Settings"})]})]})})]})]})]}),e.jsx(ts,{open:oe,onOpenChange:je=>{je||$n()},children:e.jsxs(ss,{className:"max-w-4xl max-h-[85vh] w-full flex flex-col overflow-hidden",children:[e.jsxs(as,{className:"flex-shrink-0",children:[e.jsx(is,{children:"Document Preview"}),e.jsx(Ks,{children:z==null?void 0:z.displayName})]}),z&&e.jsxs("div",{className:"flex-1 min-h-0 flex flex-col space-y-4",children:[e.jsxs("div",{className:"flex-shrink-0 flex items-center space-x-4 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["Type: ",z.mimeType]}),e.jsxs("span",{children:["Size: ",Ti(z.sizeBytes)]}),e.jsxs("span",{children:["Uploaded: ",new Date(z.uploadedAt).toLocaleDateString()]})]}),e.jsx("div",{className:"flex-1 min-h-0 border rounded-lg overflow-hidden",children:z.mimeType.startsWith("image/")?e.jsxs("div",{className:"relative bg-gray-50 h-full flex items-center justify-center overflow-auto",children:[P&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading image..."})]})}),!D&&he?e.jsx("img",{src:he,alt:z.displayName,className:"max-w-full max-h-full object-contain rounded-lg shadow-sm",style:{maxWidth:"100%",maxHeight:"100%",width:"auto",height:"auto",display:"block"}}):e.jsxs("div",{className:"text-center p-8",children:[e.jsx(Zt,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Image preview failed to load"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(I,{onClick:()=>Jt(z),children:[e.jsx(An,{className:"mr-2 h-4 w-4"}),"Download to View"]}),e.jsx(I,{variant:"outline",onClick:()=>{z&&kt(z)},children:"Retry Preview"})]})]})]}):z.mimeType.includes("pdf")?e.jsx("iframe",{src:`${qi.api.baseUrl}/api/documents/stream/${z.id}?token=${localStorage.getItem("auth_token")}&tenantId=${localStorage.getItem("tenant_id")}&companyId=${localStorage.getItem("company_id")}#toolbar=0`,className:"w-full h-full border-0",title:z.displayName}):z.mimeType.startsWith("text/")?e.jsx("div",{className:"w-full h-full overflow-auto",children:Ee?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading text content..."})]})}):O?e.jsx("div",{className:"flex items-center justify-center h-full p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Zt,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Failed to load text content"}),e.jsx(I,{variant:"outline",onClick:()=>{z&&gs(z)},children:"Retry"})]})}):pe?e.jsx("pre",{className:"p-4 text-sm whitespace-pre-wrap font-mono bg-gray-50",children:pe}):null}):e.jsxs("div",{className:"p-8 text-center h-full flex flex-col items-center justify-center",children:[e.jsx(Zt,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Preview not available for this file type"}),e.jsxs(I,{onClick:()=>Jt(z),children:[e.jsx(An,{className:"mr-2 h-4 w-4"}),"Download to View"]})]})}),e.jsxs("div",{className:"flex-shrink-0 flex justify-end space-x-2 pt-4",children:[e.jsx(I,{variant:"outline",onClick:()=>Q(!1),children:"Close"}),e.jsxs(I,{onClick:()=>Jt(z),children:[e.jsx(An,{className:"mr-2 h-4 w-4"}),"Download"]})]})]})]})}),e.jsx(ts,{open:re,onOpenChange:le,children:e.jsxs(ss,{className:"max-w-md",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Delete Document"}),e.jsxs(Ks,{children:['Are you sure you want to delete "',Z==null?void 0:Z.displayName,'"? This action cannot be undone.']})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[e.jsx(I,{variant:"outline",onClick:()=>le(!1),children:"Cancel"}),e.jsx(I,{variant:"destructive",onClick:xi,children:"Delete"})]})]})}),e.jsx(ts,{open:X,onOpenChange:ce,children:e.jsxs(ss,{className:"max-w-2xl",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Create New Workflow"}),e.jsx(Ks,{children:"Set up a new document processing workflow with custom steps and automation rules."})]}),e.jsx(c7e,{onSubmit:Zn,onCancel:()=>ce(!1),templates:qe})]})})]})})}const aW=x.forwardRef(({data:s,className:t=""},r)=>e.jsxs("div",{ref:r,className:`bg-white p-6 max-w-sm mx-auto text-sm font-mono ${t}`,style:{width:"300px"},children:[e.jsxs("div",{className:"text-center border-b border-gray-300 pb-4 mb-4",children:[e.jsx("h1",{className:"text-lg font-bold text-gray-900",children:s.companyInfo.name}),s.companyInfo.address&&e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:s.companyInfo.address}),e.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[s.companyInfo.phone&&e.jsxs("p",{children:["Tel: ",s.companyInfo.phone]}),s.companyInfo.email&&e.jsxs("p",{children:["Email: ",s.companyInfo.email]}),s.companyInfo.website&&e.jsxs("p",{children:["Web: ",s.companyInfo.website]})]})]}),e.jsxs("div",{className:"border-b border-gray-300 pb-2 mb-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Receipt #:"}),e.jsx("span",{children:s.invoiceNumber})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Date:"}),e.jsx("span",{children:s.date})]}),s.customer&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Customer:"}),e.jsx("span",{children:s.customer.name})]}),s.customer.phone&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Phone:"}),e.jsx("span",{children:s.customer.phone})]})]})]}),e.jsx("div",{className:"border-b border-gray-300 pb-2 mb-4",children:e.jsx("div",{className:"space-y-2",children:s.items.map((n,a)=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"truncate pr-2",children:n.name}),e.jsx("span",{children:Fh(n.total)})]}),e.jsxs("div",{className:"text-xs text-gray-600 ml-2",children:[n.quantity,"  ",Fh(n.unitPrice)]})]},a))})}),e.jsxs("div",{className:"space-y-1 mb-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Subtotal:"}),e.jsx("span",{children:Fh(s.subtotal)})]}),s.discountAmount&&s.discountAmount>0&&e.jsxs("div",{className:"flex justify-between text-red-600",children:[e.jsx("span",{children:"Discount:"}),e.jsxs("span",{children:["-",Fh(s.discountAmount)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Tax:"}),e.jsx("span",{children:Fh(s.taxAmount)})]}),e.jsxs("div",{className:"flex justify-between font-bold text-lg border-t border-gray-300 pt-1",children:[e.jsx("span",{children:"TOTAL:"}),e.jsx("span",{children:Fh(s.total)})]})]}),e.jsxs("div",{className:"border-t border-gray-300 pt-2 mb-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Payment:"}),e.jsx("span",{className:"capitalize",children:s.paymentMethod})]}),s.paymentMethod==="cash"&&s.cashReceived&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Cash Received:"}),e.jsx("span",{children:Fh(s.cashReceived)})]}),s.change&&s.change>0&&e.jsxs("div",{className:"flex justify-between font-bold",children:[e.jsx("span",{children:"Change:"}),e.jsx("span",{children:Fh(s.change)})]})]})]}),e.jsxs("div",{className:"text-center text-xs text-gray-600 border-t border-gray-300 pt-4",children:[e.jsx("p",{children:"Thank you for your business!"}),e.jsx("p",{className:"mt-2",children:"Keep your receipt for returns"}),e.jsx("p",{className:"mt-2",children:"Powered by UrutiIQ POS"})]}),e.jsxs("div",{className:"text-center mt-4",children:[e.jsx("div",{className:"inline-block bg-gray-200 p-2",children:e.jsx("div",{className:"w-16 h-16 bg-black bg-opacity-10 flex items-center justify-center text-xs",children:"QR Code"})}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Scan for digital receipt"})]})]}));aW.displayName="Receipt";class CR{static async printReceipt(t,r={}){var n,a;try{if(!window.print)throw new Error("Printing not supported in this environment");const i=window.open("","_blank","width=300,height=600");if(!i)throw new Error("Unable to open print window");const o=t.cloneNode(!0),l=`
        <!DOCTYPE html>
        <html>
        <head>
          <title>Receipt</title>
          <style>
            body { 
              margin: 0; 
              padding: 10px; 
              font-family: 'Courier New', monospace;
              font-size: 12px;
              line-height: 1.4;
            }
            @media print {
              body { margin: 0; }
              .no-print { display: none; }
              @page { 
                margin: 0; 
                size: ${r.paperSize==="thermal_58mm"?"58mm auto":r.paperSize==="thermal_80mm"?"80mm auto":"auto"};
              }
            }
            /* Thermal printer optimizations */
            ${(n=r.paperSize)!=null&&n.includes("thermal")?`
              .thermal-optimized {
                max-width: ${r.paperSize==="thermal_58mm"?"58mm":"80mm"};
                font-size: 11px;
                line-height: 1.2;
              }
            `:""}
          </style>
        </head>
        <body>
          <div class="${(a=r.paperSize)!=null&&a.includes("thermal")?"thermal-optimized":""}">
            ${o.outerHTML}
          </div>
        </body>
        </html>
      `;return i.document.write(l),i.document.close(),i.onload=()=>{i.focus(),i.print(),setTimeout(()=>{i.close()},1e3)},!0}catch(i){return console.error("Print error:",i),!1}}static async generateReceiptPDF(t){try{const[{default:r},{default:n}]=await Promise.all([T0(()=>import("./html2canvas.esm-CBrSDip1.js"),[]),T0(()=>Promise.resolve().then(()=>Bae),void 0)]),a=document.createElement("div");a.style.position="absolute",a.style.left="-9999px",a.style.top="-9999px",a.innerHTML=this.generateReceiptHTML(t),document.body.appendChild(a);const i=await r(a,{backgroundColor:"#ffffff",scale:2,useCORS:!0});document.body.removeChild(a);const o=80,l=i.height*o/i.width,c=new n({orientation:"portrait",unit:"mm",format:[o,l]}),d=i.toDataURL("image/png");return c.addImage(d,"PNG",0,0,o,l),c.output("blob")}catch(r){throw console.error("PDF generation error:",r),r}}static async emailReceipt(t,r){try{const n=await this.generateReceiptPDF(t),a=new FormData;a.append("to",r.to),a.append("subject",r.subject||`Receipt ${t.invoiceNumber}`),a.append("message",r.message||"Thank you for your purchase. Please find your receipt attached."),a.append("receipt",n,`receipt-${t.invoiceNumber}.pdf`);const i=await fetch("/api/pos/email-receipt",{method:"POST",body:a,headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`,"x-tenant-id":localStorage.getItem("tenant_id")||"","x-company-id":localStorage.getItem("company_id")||""}});if(!i.ok){let l=`Email failed: ${i.statusText}`;try{const c=await i.json();c.error&&(l=c.error,c.details&&(l+=` - ${c.details}`))}catch{}throw new Error(l)}const o=await i.json();return console.log(" Email receipt sent successfully:",o),o.warning&&console.warn(" Email warning:",o.warning),!0}catch(n){return console.error("Email receipt error:",n),!1}}static generateReceiptHTML(t){return`
      <div style="background: white; padding: 20px; max-width: 300px; font-family: 'Courier New', monospace; font-size: 12px; line-height: 1.4;">
        <!-- Company Header -->
        <div style="text-align: center; border-bottom: 1px solid #333; padding-bottom: 10px; margin-bottom: 10px;">
          <h1 style="margin: 0; font-size: 16px; font-weight: bold;">${t.companyInfo.name}</h1>
          ${t.companyInfo.address?`<p style="margin: 2px 0; font-size: 10px;">${t.companyInfo.address}</p>`:""}
          ${t.companyInfo.phone?`<p style="margin: 2px 0; font-size: 10px;">Tel: ${t.companyInfo.phone}</p>`:""}
          ${t.companyInfo.email?`<p style="margin: 2px 0; font-size: 10px;">Email: ${t.companyInfo.email}</p>`:""}
        </div>

        <!-- Transaction Info -->
        <div style="border-bottom: 1px solid #333; padding-bottom: 8px; margin-bottom: 10px;">
          <div style="display: flex; justify-content: space-between;">
            <span>Receipt #:</span>
            <span>${t.invoiceNumber}</span>
          </div>
          <div style="display: flex; justify-content: space-between;">
            <span>Date:</span>
            <span>${t.date}</span>
          </div>
          ${t.customer?`
            <div style="margin-top: 5px;">
              <div style="display: flex; justify-content: space-between;">
                <span>Customer:</span>
                <span>${t.customer.name}</span>
              </div>
            </div>
          `:""}
        </div>

        <!-- Items -->
        <div style="border-bottom: 1px solid #333; padding-bottom: 8px; margin-bottom: 10px;">
          ${t.items.map(r=>`
            <div style="margin-bottom: 5px;">
              <div style="display: flex; justify-content: space-between;">
                <span style="flex: 1; margin-right: 10px;">${r.name}</span>
                <span>$${Number(r.total).toFixed(2)}</span>
              </div>
              <div style="font-size: 10px; color: #666; margin-left: 10px;">
                ${r.quantity}  $${Number(r.unitPrice).toFixed(2)}
              </div>
            </div>
          `).join("")}
        </div>

        <!-- Totals -->
        <div style="margin-bottom: 10px;">
          <div style="display: flex; justify-content: space-between;">
            <span>Subtotal:</span>
            <span>$${Number(t.subtotal).toFixed(2)}</span>
          </div>
          ${t.discountAmount&&t.discountAmount>0?`
            <div style="display: flex; justify-content: space-between; color: red;">
              <span>Discount:</span>
              <span>-$${Number(t.discountAmount).toFixed(2)}</span>
            </div>
          `:""}
          <div style="display: flex; justify-content: space-between;">
            <span>Tax:</span>
            <span>$${Number(t.taxAmount).toFixed(2)}</span>
          </div>
          <div style="display: flex; justify-content: space-between; font-weight: bold; font-size: 14px; border-top: 1px solid #333; padding-top: 5px;">
            <span>TOTAL:</span>
            <span>$${Number(t.total).toFixed(2)}</span>
          </div>
        </div>

        <!-- Payment Info -->
        <div style="border-top: 1px solid #333; padding-top: 8px; margin-bottom: 10px;">
          <div style="display: flex; justify-content: space-between;">
            <span>Payment:</span>
            <span style="text-transform: capitalize;">${t.paymentMethod}</span>
          </div>
          ${t.paymentMethod==="cash"&&t.cashReceived?`
            <div style="display: flex; justify-content: space-between;">
              <span>Cash Received:</span>
              <span>$${Number(t.cashReceived).toFixed(2)}</span>
            </div>
            ${t.change&&t.change>0?`
              <div style="display: flex; justify-content: space-between; font-weight: bold;">
                <span>Change:</span>
                <span>$${Number(t.change).toFixed(2)}</span>
              </div>
            `:""}
          `:""}
        </div>

        <!-- Footer -->
        <div style="text-align: center; font-size: 10px; color: #666; border-top: 1px solid #333; padding-top: 8px;">
          <p>Thank you for your business!</p>
          <p style="margin-top: 5px;">Keep your receipt for returns</p>
          <p style="margin-top: 5px;">Powered by UrutiIQ POS</p>
        </div>
      </div>
    `}static async checkPrinterAvailability(){try{return"usb"in navigator||"serial"in navigator?!0:"print"in window}catch(t){return console.error("Printer availability check failed:",t),!1}}static async connectThermalPrinter(){try{if(!("usb"in navigator))throw new Error("WebUSB not supported");const t=[{vendorId:1208},{vendorId:5455},{vendorId:4070},{vendorId:1305}],r=await navigator.usb.requestDevice({filters:t});return await r.open(),r.configuration===null&&await r.selectConfiguration(1),await r.claimInterface(0),r}catch(t){return console.error("Thermal printer connection failed:",t),null}}static async printToThermalPrinter(t,r){try{const n=[];n.push(27,64),n.push(27,116,6),n.push(27,97,1),n.push(27,69,1),n.push(29,33,17),n.push(...this.stringToBytes(r.companyInfo.name)),n.push(10,10),n.push(27,69,0),n.push(29,33,0),r.companyInfo.address&&(n.push(...this.stringToBytes(r.companyInfo.address)),n.push(10)),n.push(...this.stringToBytes("--------------------------------")),n.push(10,10),n.push(27,97,0),n.push(...this.stringToBytes(`Receipt #: ${r.invoiceNumber}`)),n.push(10),n.push(...this.stringToBytes(`Date: ${r.date}`)),n.push(10,10);for(const i of r.items)n.push(...this.stringToBytes(`${i.name}`)),n.push(10),n.push(...this.stringToBytes(`  ${i.quantity} x $${Number(i.unitPrice).toFixed(2)} = $${Number(i.total).toFixed(2)}`)),n.push(10);n.push(10),n.push(...this.stringToBytes("--------------------------------")),n.push(10),n.push(...this.stringToBytes(`Subtotal: $${Number(r.subtotal).toFixed(2)}`)),n.push(10),n.push(...this.stringToBytes(`Tax: $${Number(r.taxAmount).toFixed(2)}`)),n.push(10),n.push(27,69,1),n.push(...this.stringToBytes(`TOTAL: $${Number(r.total).toFixed(2)}`)),n.push(27,69,0),n.push(10,10),n.push(...this.stringToBytes(`Payment: ${r.paymentMethod}`)),n.push(10,10),n.push(27,97,1),n.push(...this.stringToBytes("Thank you for your business!")),n.push(10,10),n.push(29,86,65,16);const a=new Uint8Array(n);return await t.transferOut(1,a),!0}catch(n){return console.error("Thermal printing failed:",n),!1}}static stringToBytes(t){const r=[];for(let n=0;n<t.length;n++){const a=t.charCodeAt(n);if(a<128)r.push(a);else{const i=new TextEncoder().encode(t.charAt(n));r.push(...Array.from(i))}}return r}}function u7e(){var Ne,Dt;const{toast:s}=za(),{isAuthenticated:t,isLoading:r}=Ua(),{ready:n}=gu("pos-page"),a=hi(),[i,o]=x.useState(zs()),[l,c]=x.useState([]),[d,u]=x.useState(null),[h,f]=x.useState(""),[m,p]=x.useState(""),[g,v]=x.useState(""),[y,j]=x.useState(null),[b,w]=x.useState([]),[N,C]=x.useState(!1),[S,_]=x.useState(null),[k,F]=x.useState(""),[A,T]=x.useState(null),[V,M]=x.useState(null);x.useEffect(()=>{const ye=()=>{const Ft=zs();Ft&&Ft!==i&&(console.log(" POS page - Company changed from",i,"to",Ft),o(Ft),c([]),u(null))};window.addEventListener("storage",ye);const Be=Ft=>{const Kt=Ft.detail.companyId;Kt&&Kt!==i&&(console.log(" POS page - Company changed via custom event from",i,"to",Kt),o(Kt),c([]),u(null))};return window.addEventListener("companyChanged",Be),()=>{window.removeEventListener("storage",ye),window.removeEventListener("companyChanged",Be)}},[i]);const[G,L]=x.useState(null),[J,z]=x.useState(!1),[U,oe]=x.useState(!1),[Q,P]=x.useState(!1),[q,D]=x.useState(!1),[se,he]=x.useState(!1),[be,pe]=x.useState(!1),[Ae,Ee]=x.useState(null),[$e,O]=x.useState(!1),[te,re]=x.useState(null),[le,Z]=x.useState({name:"",email:"",currency:"USD"}),[K,X]=x.useState(!1),[ce,Y]=x.useState(null),[ue,ve]=x.useState(!1),[Le,Me]=x.useState(""),[tt,fe]=x.useState(!1),[ct,dt]=x.useState(null),[pt,qe]=x.useState(null),[mt,Rt]=x.useState([]),[_e,Xe]=x.useState(!1),[At,st]=x.useState("card"),[$t,fs]=x.useState(0),[zt,St]=x.useState(!1),[js,et]=x.useState(0),[lt,Fe]=x.useState("percent"),[ft,He]=x.useState(!1),[Je,It]=x.useState(null),[Gt,qt]=x.useState(!1),[As,Ht]=x.useState(""),[xs,Ct]=x.useState(null),[ke,gt]=x.useState(!1);x.useEffect(()=>()=>{S&&S.getTracks().forEach(ye=>ye.stop())},[S]),x.useEffect(()=>{const ye=Be=>{Be.ctrlKey&&Be.key==="b"&&!se&&(Be.preventDefault(),bt()),Be.key==="Escape"&&se&&Zs()};return window.addEventListener("keydown",ye),()=>window.removeEventListener("keydown",ye)},[se]);const{data:us,isLoading:We}=ys({queryKey:["pos-products",i],queryFn:()=>Ra.getProducts({companyId:i,page:1,pageSize:1e3}),enabled:!!i&&t&&!r&&n});x.useEffect(()=>{},[us,i,t,r,n]);const Et=(us==null?void 0:us.items)||[];x.useEffect(()=>{Et.length>0&&Et.reduce((ye,Be)=>(ye[Be.status]=(ye[Be.status]||0)+1,ye),{})},[Et]);const{data:Pt,isLoading:rs}=ys({queryKey:["pos-customers",i],queryFn:()=>de.getCustomers({companyId:i,pageSize:1e3}),enabled:!!i&&t&&!r&&n}),ms=(Pt==null?void 0:Pt.items)||[],{data:Bs,isLoading:Vs}=ys({queryKey:["pos-recent-invoices",i],queryFn:async()=>{const Be=await de.getInvoices({page:1,pageSize:5,companyId:i}),Ft=(Be==null?void 0:Be.items)??(Be==null?void 0:Be.invoices)??(Be==null?void 0:Be.data)??Be;return Array.isArray(Ft)?Ft:[]},enabled:!!i&&t&&!r&&n}),Ws=Bs||[],Ns=Ae,er=Array.isArray(Et)?Et:[],Ir=er.filter(ye=>{var xi,$n;const Be=ye.name.toLowerCase().includes(h.toLowerCase())||ye.sku&&ye.sku.toLowerCase().includes(h.toLowerCase())||ye.barcode&&ye.barcode.toLowerCase().includes(h.toLowerCase())||((xi=ye.categoryObject)==null?void 0:xi.name)&&ye.categoryObject.name.toLowerCase().includes(h.toLowerCase()),Ft=($n=ye.status)==null?void 0:$n.toUpperCase(),Kt=Ft==="ACTIVE"||Ft==="INACTIVE",Jt=!g||ye.categoryId===g,kt=Number(ye.availableQuantity)||0,gs=Number(ye.stockQuantity)||0,fn=kt>0||gs>0;return Be&&Kt&&Jt&&fn});x.useEffect(()=>{},[er,Ir,h,g]);const jn=Array.from(new Set(er.filter(ye=>{var Kt,Jt;const Be=(Kt=ye.status)==null?void 0:Kt.toUpperCase(),Ft=Be==="ACTIVE"||Be==="INACTIVE";return((Jt=ye.categoryObject)==null?void 0:Jt.name)&&ye.categoryId&&Ft}).map(ye=>({id:ye.categoryId,name:ye.categoryObject.name})))).sort((ye,Be)=>ye.name.localeCompare(Be.name)),Hs=er.filter(ye=>{var Kt;const Be=(Kt=ye.status)==null?void 0:Kt.toUpperCase(),Ft=Be==="ACTIVE"||Be==="INACTIVE";return b.includes(ye.id)&&Ft}).slice(0,6),qr=ms.filter(ye=>{const Be=m.toLowerCase();return ye.name.toLowerCase().includes(Be)||ye.email&&ye.email.toLowerCase().includes(Be)||ye.phone&&ye.phone.toLowerCase().includes(Be)}),qn=ms.filter(ye=>mt.includes(ye.id)).slice(0,5),In=l.reduce((ye,Be)=>{const Ft=Be.quantity*Be.unitPrice-Be.discount;if(Be.product.taxInclusive&&Be.product.taxRate&&Be.product.taxRate>0){const Kt=Ft/(1+(Be.product.taxRate||0)/100);return ye+Kt}else return ye+Ft},0),Yr=lt==="percent"?In*js/100:js,$r=l.reduce((ye,Be)=>{const Ft=Be.quantity*Be.unitPrice-Be.discount;if(Be.product.taxInclusive&&Be.product.taxRate&&Be.product.taxRate>0){const Kt=Ft/(1+(Be.product.taxRate||0)/100);return ye+(Ft-Kt)}else return ye+Ft*((Be.product.taxRate||0)/100)},0),Vr=In-Yr+$r,wn=ye=>{const Be=Number(ye.availableQuantity)||0,Ft=Number(ye.stockQuantity)||0,Kt=Be>0?Be:Ft,Jt=l.findIndex(gs=>gs.product.id===ye.id);if((Jt>=0?l[Jt].quantity:0)>=Kt){const gs=Zn(ye);s({title:gs?"Service Unavailable":"Insufficient Stock",description:gs?`No more slots available for ${ye.name}${Kt===0?" (Fully Booked)":""}`:`Only ${Kt} units available for ${ye.name}`,variant:"destructive"});return}if(Jt>=0){const gs=[...l];gs[Jt].quantity+=1,gs[Jt].lineTotal=gs[Jt].quantity*gs[Jt].unitPrice-gs[Jt].discount,c(gs)}else{const gs={product:ye,quantity:1,unitPrice:ye.unitPrice,discount:0,taxRate:ye.taxRate||0,lineTotal:ye.unitPrice};c([...l,gs])}},Vn=(ye,Be)=>{if(Be<=0){De(ye);return}const Ft=l.find(Jt=>Jt.product.id===ye);if(Ft){const Jt=Ft.product.availableQuantity||Ft.product.stockQuantity||0;if(Be>Jt){s({title:"Insufficient Stock",description:`Only ${Jt} units available for ${Ft.product.name}`,variant:"destructive"});return}}const Kt=l.map(Jt=>Jt.product.id===ye?{...Jt,quantity:Be,lineTotal:Be*Jt.unitPrice-Jt.discount}:Jt);c(Kt)},De=ye=>{c(l.filter(Be=>Be.product.id!==ye))},ut=()=>{c([]),u(null),et(0)},Pe=Rs({mutationFn:async()=>{if(!d)throw new Error("Please select a customer");const ye={companyId:i,customerId:d.id,invoiceNumber:`POS-${Date.now()}`,issueDate:new Date().toISOString(),currency:"USD",lines:l.map(Be=>({productId:Be.product.id,description:Be.product.name,quantity:Be.quantity,unitPrice:Be.unitPrice,taxRate:Be.taxRate,discountRate:Be.discount})),subtotal:In,taxAmount:$r,discountAmount:Yr,shippingAmount:0,totalAmount:Vr,balanceDue:Vr,notes:"Created via POS system",terms:"Payment due on receipt",paymentTerms:"Due on Receipt",status:"paid"};return de.createInvoice(ye)},onSuccess:async ye=>{try{const Be={invoiceNumber:ye.invoiceNumber||`POS-${Date.now()}`,date:new Date().toLocaleDateString(),customer:d?{name:d.name,email:d.email,phone:d.phone}:void 0,items:l.map(Ft=>({name:Ft.product.name,quantity:Ft.quantity,unitPrice:Ft.unitPrice,total:Ft.lineTotal})),subtotal:In,taxAmount:$r,discountAmount:Yr,total:Vr,paymentMethod:At,cashReceived:At==="cash"?$t:void 0,change:At==="cash"&&$t>Vr?$t-Vr:void 0,companyInfo:{name:"UrutiIQ Business",address:"123 Business St, City, State 12345",phone:"+1 (555) 123-4567",email:"contact@urutiiq.com",website:"www.urutiiq.com"}};qe(Be),dt(ye),D(!0),s({title:"Sale Completed",description:`Invoice ${ye.invoiceNumber} processed successfully. Stock updated.`}),await Promise.all([a.invalidateQueries({queryKey:["invoices"]}),a.invalidateQueries({queryKey:["pos-recent-invoices"]}),a.invalidateQueries({queryKey:["pos-products",i]}),a.invalidateQueries({queryKey:["products"]}),a.invalidateQueries({queryKey:["inventory-movements"]}),a.invalidateQueries({queryKey:["journal-entries"]})]),await a.refetchQueries({queryKey:["pos-products",i]}),ut(),oe(!1)}catch(Be){console.error("Error in POS success handler:",Be);const Ft={invoiceNumber:ye.invoiceNumber||`POS-${Date.now()}`,date:new Date().toLocaleDateString(),customer:d?{name:d.name,email:d.email,phone:d.phone}:void 0,items:l.map(Kt=>({name:Kt.product.name,quantity:Kt.quantity,unitPrice:Kt.unitPrice,total:Kt.lineTotal})),subtotal:In,taxAmount:$r,discountAmount:Yr,total:Vr,paymentMethod:At,cashReceived:At==="cash"?$t:void 0,change:At==="cash"&&$t>Vr?$t-Vr:void 0,companyInfo:{name:"UrutiIQ Business",address:"123 Business St, City, State 12345",phone:"+1 (555) 123-4567",email:"contact@urutiiq.com",website:"www.urutiiq.com"}};qe(Ft),dt(ye),D(!0),s({title:"Sale Completed",description:`Invoice ${ye.invoiceNumber} created successfully.`}),await Promise.all([a.invalidateQueries({queryKey:["invoices"]}),a.invalidateQueries({queryKey:["pos-products",i]}),a.invalidateQueries({queryKey:["products"]})]),await a.refetchQueries({queryKey:["pos-products",i]}),ut(),oe(!1)}},onError:ye=>{s({title:"Sale Failed",description:ye.message||"Failed to create invoice",variant:"destructive"})}}),_t=()=>{if(At==="cash"&&$t<Vr){s({title:"Insufficient Cash",description:`Need ${cr(Vr-$t)} more`,variant:"destructive"});return}Pe.mutate()},bt=()=>{he(!0),L(null),F("")},ps=async()=>{C(!0),L(null);try{const ye=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:640},height:{ideal:480}}});_(ye),s({title:"Camera Ready",description:"Point camera at barcode or enter manually below"})}catch{L("Unable to access camera. Please use manual input."),C(!1)}},Pr=()=>{S&&(S.getTracks().forEach(ye=>ye.stop()),_(null)),C(!1)},Wr=ye=>{if(!ye.trim())return;const Be=er.find(Ft=>Ft.barcode===ye.trim()||Ft.sku===ye.trim());Be?(wn(Be),s({title:"Product Added",description:`${Be.name} added to cart`}),Zs()):s({title:"Product Not Found",description:"No product found with this barcode",variant:"destructive"})},Zs=()=>{Pr(),he(!1),F(""),L(null)},wr=ye=>{Ee(ye),pe(!0)},xa=ye=>{w(Be=>Be.includes(ye)?Be.filter(Ft=>Ft!==ye):[...Be,ye])},cr=ye=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(ye),Zn=ye=>ye.type==="SERVICE",Hi=ye=>{const Be=ms.find(Ft=>Ft.id===ye.customerId);Be&&(u(Be),s({title:"Customer Selected",description:`${Be.name} selected for checkout. Add items to continue transaction.`}))},Gi=async ye=>{T(ye);try{await de.updateInvoice(ye,{status:"sent"}),a.invalidateQueries({queryKey:["pos-recent-invoices"]}),s({title:"Invoice Updated",description:"Invoice marked as sent successfully"})}catch{s({title:"Error",description:"Failed to update invoice status",variant:"destructive"})}finally{T(null)}},Ti=async ye=>{M(ye);try{const Be=await de.processInvoicePayment(ye);await de.updateInvoice(ye,{status:"paid",balanceDue:0}),a.invalidateQueries({queryKey:["pos-recent-invoices"]}),a.invalidateQueries({queryKey:["journal-entries"]}),a.invalidateQueries({queryKey:["inventory-movements"]}),s({title:"Invoice Paid",description:`Payment processed successfully. Journal Entry: ${Be.journalEntryId}`})}catch(Be){console.error("Error marking invoice as paid:",Be);let Ft="Error",Kt="Failed to mark invoice as paid. Please try again.";Be.message&&(Be.message.includes("Insufficient inventory")?(Ft="Insufficient Inventory",Kt=Be.message):Be.message.includes("Company with ID")&&Be.message.includes("not found")?(Ft="Company Not Found",Kt="The company associated with this invoice could not be found. Please contact support."):Be.message.includes("Failed to create account")?(Ft="Account Setup Required",Kt="Required accounting accounts are missing. Please ensure the company has proper account setup."):Be.message.includes("Transaction already closed")||Be.message.includes("timeout")?(Ft="Processing Timeout",Kt="The payment processing took too long. Please try again or contact support if the issue persists."):Be.message.includes("Failed to process invoice payment")?(Ft="Payment Processing Failed",Kt=Be.message.replace("Failed to process invoice payment: ","")):Kt=Be.message),s({title:Ft,description:Kt,variant:"destructive"})}finally{M(null)}},Ea=async(ye,Be)=>{try{const Ft=Ws.find(kt=>kt.id===ye);if(!Ft){s({title:"Invoice Not Found",description:"Could not find invoice data for PDF generation.",variant:"destructive"});return}const Kt=ms.find(kt=>kt.id===Ft.customerId);await new Pp({invoice:{id:Ft.id,invoiceNumber:Ft.invoiceNumber,issueDate:Ft.issueDate,dueDate:Ft.dueDate,status:Ft.status,totalAmount:Ft.totalAmount,balanceDue:Ft.balanceDue,currency:(Kt==null?void 0:Kt.currency)||"USD",subtotal:Ft.subtotal||Ft.totalAmount,taxAmount:Ft.taxAmount||0,discountAmount:Ft.discountAmount||0,customer:Kt?{name:Kt.name,email:Kt.email,address:Kt.address,phone:Kt.phone,taxId:Kt.taxId}:void 0,lines:Ft.lines||[],notes:Ft.notes,paymentUrl:Ft.paymentUrl},company:{name:"Your Company",logoUrl:void 0,primaryColor:"#009688",secondaryColor:"#1565c0",address:void 0,city:void 0,state:void 0,postalCode:void 0,email:void 0,phone:void 0,website:void 0,fontFamily:"Inter",invoiceTerms:"Payment is due within 30 days of invoice date.",invoiceFooter:"Thank you for your business!"}}).download(),s({title:"PDF Downloaded",description:`Invoice ${Be} has been downloaded successfully.`})}catch(Ft){console.error("Error downloading invoice PDF:",Ft);try{const Kt=await de.getInvoicePdf(ye),Jt=URL.createObjectURL(Kt),kt=document.createElement("a");kt.href=Jt,kt.download=`invoice-${Be}.pdf`,document.body.appendChild(kt),kt.click(),document.body.removeChild(kt),URL.revokeObjectURL(Jt),s({title:"PDF Downloaded",description:`Invoice ${Be} has been downloaded successfully.`})}catch(Kt){console.error("Backend PDF generation also failed:",Kt),s({title:"Download Failed",description:"There was an error downloading the PDF. Please try again.",variant:"destructive"})}}},Ki=async()=>{if(!(!xs||!As)){gt(!0);try{const ye=Ws.find(Jt=>Jt.id===xs);if(!ye){s({title:"Invoice Not Found",description:"Could not find invoice data for email generation.",variant:"destructive"});return}const Be=ms.find(Jt=>Jt.id===ye.customerId),Kt=await new Pp({invoice:{id:ye.id,invoiceNumber:ye.invoiceNumber,issueDate:ye.issueDate,dueDate:ye.dueDate,status:ye.status,totalAmount:ye.totalAmount,balanceDue:ye.balanceDue,currency:(Be==null?void 0:Be.currency)||"USD",subtotal:ye.subtotal||ye.totalAmount,taxAmount:ye.taxAmount||0,discountAmount:ye.discountAmount||0,customer:Be?{name:Be.name,email:Be.email,address:Be.address,phone:Be.phone,taxId:Be.taxId}:void 0,lines:ye.lines||[],notes:ye.notes,paymentUrl:ye.paymentUrl},company:{name:"Your Company",logoUrl:void 0,primaryColor:"#009688",secondaryColor:"#1565c0",address:void 0,city:void 0,state:void 0,postalCode:void 0,email:void 0,phone:void 0,website:void 0,fontFamily:"Inter",invoiceTerms:"Payment is due within 30 days of invoice date.",invoiceFooter:"Thank you for your business!"}}).generate();await de.sendInvoiceEmail(ye.id,{to:As,subject:`Invoice ${ye.invoiceNumber}`,message:`Please find your invoice ${ye.invoiceNumber} attached. Thank you for your business!`,attachPdf:!0,pdfBlob:Kt}),s({title:"Email Sent",description:`Invoice ${ye.invoiceNumber} has been sent to ${As}`}),qt(!1),Ht(""),Ct(null)}catch(ye){console.error("Error sending invoice email:",ye);try{const Be=await de.sendInvoiceEmail(xs,{to:As,attachPdf:!0});Be!=null&&Be.warning?s({title:"Email Queued",description:Be.warning,variant:"default"}):s({title:"Email Sent",description:`Invoice sent to ${As}`}),qt(!1),Ht(""),Ct(null)}catch(Be){console.error("Backend email sending failed:",Be),s({title:"Email Service Unavailable",description:"Email service is not configured. Please contact your administrator to set up SMTP settings.",variant:"destructive"})}}finally{gt(!1)}}},mi=async(ye,Be)=>{try{const Ft=await de.createPaymentLink(ye);await navigator.clipboard.writeText(Ft.url),s({title:"Payment Link Created",description:`Link for ${Be} copied to clipboard`})}catch{s({title:"Link Creation Failed",description:"Unable to create payment link",variant:"destructive"})}},Da=ye=>{const Be=Number(ye.availableQuantity)||0,Ft=Number(ye.stockQuantity)||0,Kt=Be>0?Be:Ft;return Zn(ye)?Kt>=999999?{text:"Available",status:"available"}:Kt>50?{text:`${Kt} slots available`,status:"available"}:Kt>10?{text:`${Kt} slots available`,status:"limited"}:Kt>0?{text:`Only ${Kt} slots left`,status:"low"}:{text:"Fully Booked",status:"unavailable"}:Kt<=0?{text:"Out of Stock",status:"unavailable"}:Kt<=10?{text:`Stock: ${Kt}`,status:"low"}:{text:`Stock: ${Kt}`,status:"available"}},fi=ye=>{var Be,Ft;if(Zn(ye)){const Kt=((Ft=(Be=ye.categoryObject)==null?void 0:Be.name)==null?void 0:Ft.toLowerCase())||"";return Kt.includes("consulting")?"":Kt.includes("technical")?"":Kt.includes("creative")?"":Kt.includes("maintenance")?"":Kt.includes("training")?"":""}return e.jsx(Hr,{className:"w-8 h-8 text-blue-600"})},qa=ye=>{u(ye),z(!1),p(""),Rt(Be=>{const Ft=Be.filter(Kt=>Kt!==ye.id);return[ye.id,...Ft].slice(0,5)})};return x.useEffect(()=>{const ye=Be=>{Be.target instanceof HTMLInputElement||Be.target instanceof HTMLTextAreaElement||((Be.ctrlKey||Be.metaKey)&&Be.key==="c"&&(Be.preventDefault(),z(!0)),(Be.ctrlKey||Be.metaKey)&&Be.key==="Delete"&&(Be.preventDefault(),ut()))};return window.addEventListener("keydown",ye),()=>window.removeEventListener("keydown",ye)},[]),r||!n?e.jsx("div",{className:"bg-slate-50 flex items-center justify-center h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-600 to-blue-700 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(Gu,{className:"w-8 h-8 text-white"})}),e.jsx("h2",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Loading POS System"}),e.jsx("p",{className:"text-slate-600",children:"Initializing point of sale..."})]})}):e.jsxs("div",{className:"bg-slate-50 flex flex-col overflow-hidden h-screen min-h-screen max-h-screen -mt-20 pt-20",style:{height:"100vh",maxHeight:"100vh",minHeight:"100vh"},children:[e.jsxs("div",{className:"bg-white border-b border-slate-200 p-2 flex items-center justify-between flex-shrink-0 h-16",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg flex items-center justify-center",children:e.jsx(Gu,{className:"w-3 h-3 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-slate-900",children:"Point of Sale"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Quick checkout system"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Oe,{variant:"secondary",className:"h-6 text-xs",children:[e.jsx(Cr,{className:"w-3 h-3 mr-1"}),new Date().toLocaleTimeString()]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>z(!0),className:"h-6 text-xs",title:"Select Customer (Ctrl+C)",children:[e.jsx(bo,{className:"w-3 h-3 mr-1"}),"Customer"]}),e.jsxs(I,{variant:"outline",size:"sm",onClick:ut,disabled:l.length===0,className:"h-6 text-xs",title:"Clear Cart (Ctrl+Delete)",children:[e.jsx(hn,{className:"w-3 h-3 mr-1"}),"Clear"]})]})]}),e.jsxs("div",{className:"flex-1 flex min-h-0 max-h-full",children:[e.jsxs("div",{className:"flex-1 flex flex-col min-h-0 max-h-full",children:[e.jsxs("div",{className:"bg-white p-3 border-b border-slate-200 flex-shrink-0",children:[e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Rn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-4 h-4"}),e.jsx(ge,{placeholder:"Search products, SKU, barcode...",value:h,onChange:ye=>f(ye.target.value),className:"pl-9 h-8 text-sm"})]}),e.jsx(I,{variant:"outline",size:"sm",onClick:bt,disabled:N,className:"h-8 px-3",title:"Barcode Scanner (Ctrl+B)",children:e.jsx(Ww,{className:"w-4 h-4"})})]})}),Hs.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(go,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{className:"text-xs font-medium text-slate-700",children:"Quick Add"})]}),e.jsx("div",{className:"flex gap-1 overflow-x-auto pb-1",children:Hs.map(ye=>e.jsx(I,{size:"sm",variant:"outline",onClick:Be=>{Be.stopPropagation(),Be.preventDefault(),wn(ye)},className:"h-6 text-xs whitespace-nowrap flex-shrink-0",children:ye.name},ye.id))})]}),jn.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ic,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{className:"text-xs font-medium text-slate-700",children:"Categories"})]}),e.jsxs("div",{className:"flex gap-1 overflow-x-auto pb-1",children:[e.jsx(I,{size:"sm",variant:g?"outline":"default",onClick:()=>v(""),className:"h-6 text-xs whitespace-nowrap flex-shrink-0",children:"All"}),jn.map(ye=>e.jsx(I,{size:"sm",variant:g===ye.id?"default":"outline",onClick:()=>v(ye.id),className:"h-6 text-xs whitespace-nowrap flex-shrink-0",children:ye.name},ye.id))]})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(Oe,{variant:"secondary",className:"text-xs h-5",children:[Ir.length," available for sale"]}),e.jsx("div",{className:"text-xs text-slate-500",children:"Only showing active products with stock"})]})})]}),e.jsxs("div",{className:"flex-1 p-3 overflow-y-auto bg-slate-50 min-h-0",children:[We?e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-7 gap-2",children:[...Array(14)].map((ye,Be)=>e.jsx("div",{className:"aspect-square bg-slate-200 rounded-md animate-pulse"},Be))}):e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-7 gap-2 pb-2",children:Ir.map(ye=>{const Be=Da(ye);Be.status==="low"||Be.status;const Ft=Be.status==="unavailable",Kt=fi(ye);return e.jsx(ne,{className:`cursor-pointer hover:shadow-md transition-all duration-150 hover:scale-[1.02] group relative ${Ft?"opacity-60 border-red-200 cursor-not-allowed":""}`,onClick:Jt=>{Jt.stopPropagation(),Jt.preventDefault(),!Ft&&wn(ye)},children:e.jsxs(ie,{className:"p-2 aspect-square flex flex-col",children:[e.jsx("div",{className:"flex-1 flex items-center justify-center mb-1",children:e.jsx("div",{className:`w-8 h-8 rounded-md flex items-center justify-center group-hover:scale-105 transition-all duration-150 ${Zn(ye)?"bg-gradient-to-br from-purple-100 to-purple-200":"bg-gradient-to-br from-blue-100 to-blue-200"}`,children:typeof Kt=="string"?e.jsx("span",{className:"text-sm",children:Kt}):e.jsx("div",{className:"w-4 h-4 text-blue-600",children:e.jsx(Hr,{className:"w-full h-full"})})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"font-medium text-slate-900 text-xs leading-tight mb-1 line-clamp-1",children:ye.name}),Zn(ye)&&e.jsx("div",{className:"text-xs bg-purple-50 text-purple-700 rounded px-1 mb-1",children:"Service"}),e.jsx("div",{className:`text-xs font-bold ${Zn(ye)?"text-purple-600":"text-green-600"}`,children:cr(ye.unitPrice)}),e.jsx("div",{className:`text-xs ${Be.status==="unavailable"?"text-red-600":Be.status==="low"||Be.status==="limited"?"text-orange-600":"text-slate-500"}`,children:Be.text})]}),e.jsxs("div",{className:"absolute top-1 left-1 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx(I,{size:"sm",variant:"ghost",onClick:Jt=>{Jt.stopPropagation(),j(ye)},className:"h-5 w-5 p-0 bg-white/80 hover:bg-white",children:e.jsx(Zl,{className:"w-3 h-3"})}),e.jsx(I,{size:"sm",variant:"ghost",onClick:Jt=>{Jt.stopPropagation(),xa(ye.id)},className:`h-5 w-5 p-0 ${b.includes(ye.id)?"bg-amber-100 text-amber-600 hover:bg-amber-200":"bg-white/80 hover:bg-white"}`,children:e.jsx(go,{className:"w-3 h-3",fill:b.includes(ye.id)?"currentColor":"none"})})]}),Be.status==="unavailable"&&e.jsx("div",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"}),Be.status==="low"&&e.jsx("div",{className:"absolute top-1 right-1 w-2 h-2 bg-orange-500 rounded-full"}),Be.status==="limited"&&Zn(ye)&&e.jsx("div",{className:"absolute top-1 right-1 w-2 h-2 bg-yellow-500 rounded-full"})]})},ye.id)})}),!We&&Ir.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-slate-500",children:[e.jsx(Hr,{className:"w-12 h-12 mb-3 text-slate-300"}),e.jsx("h3",{className:"font-medium mb-1",children:"No products found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your search"})]})]}),e.jsx("div",{className:"bg-white border-t border-slate-200 p-3 flex-shrink-0",children:e.jsxs("div",{className:"grid grid-cols-4 gap-3 text-center",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-2",children:[e.jsx("div",{className:"text-lg font-bold text-slate-900",children:Ir.length}),e.jsx("div",{className:"text-xs text-slate-600",children:"Products"})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-2",children:[e.jsx("div",{className:"text-lg font-bold text-blue-700",children:l.length}),e.jsx("div",{className:"text-xs text-blue-600",children:"In Cart"})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-2",children:[e.jsx("div",{className:"text-lg font-bold text-green-700",children:cr(Vr)}),e.jsx("div",{className:"text-xs text-green-600",children:"Total"})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(I,{size:"sm",variant:"outline",onClick:bt,disabled:N,className:"h-6 text-xs",title:"Barcode Scanner (Ctrl+B)",children:e.jsx(Ww,{className:"w-3 h-3"})}),e.jsx(I,{size:"sm",variant:"outline",onClick:()=>z(!0),className:"h-6 text-xs",title:"Select Customer",children:e.jsx(bo,{className:"w-3 h-3"})})]})]})})]}),e.jsxs("div",{className:"w-72 bg-white border-l border-slate-200 flex flex-col min-h-0 max-h-full",children:[e.jsx("div",{className:"p-2 border-b border-slate-200 flex-shrink-0",children:e.jsx(I,{variant:d?"default":"outline",onClick:()=>z(!0),className:"w-full h-auto justify-start text-xs p-2",children:e.jsx("div",{className:"flex items-center gap-2 w-full",children:d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-6 h-6 bg-white rounded-full flex items-center justify-center text-xs font-medium flex-shrink-0",children:d.name.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1 text-left min-w-0",children:[e.jsx("div",{className:"font-medium truncate",children:d.name}),(d.email||d.phone)&&e.jsx("div",{className:"text-xs opacity-75 truncate",children:d.email||d.phone})]}),e.jsx(I,{variant:"ghost",size:"sm",onClick:ye=>{ye.stopPropagation(),u(null)},className:"h-4 w-4 p-0 hover:bg-white/20",children:e.jsx(ma,{className:"w-2 h-2"})})]}):e.jsxs(e.Fragment,{children:[e.jsx(bo,{className:"w-3 h-3"}),e.jsx("span",{className:"truncate",children:"Select Customer"})]})})})}),e.jsx("div",{className:"border-b border-slate-200 flex-shrink-0",children:e.jsxs("div",{className:"p-2",children:[e.jsxs(I,{variant:"ghost",size:"sm",onClick:()=>He(!ft),className:"w-full justify-between h-8 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tM,{className:"w-3 h-3"}),e.jsx("span",{children:"Recent Invoices"}),!Vs&&Ws.length>0&&e.jsx(Oe,{variant:"secondary",className:"h-4 text-xs",children:Ws.length})]}),ft?e.jsx(um,{className:"w-3 h-3"}):e.jsx(tc,{className:"w-3 h-3"})]}),ft&&e.jsx("div",{className:"mt-2 space-y-1",children:Vs?e.jsx("div",{className:"space-y-1",children:[1,2,3].map(ye=>e.jsx("div",{className:"h-12 bg-slate-100 rounded animate-pulse"},ye))}):Ws.length===0?e.jsxs("div",{className:"text-center py-3 text-slate-500",children:[e.jsx(lh,{className:"w-4 h-4 mx-auto mb-1 text-slate-300"}),e.jsx("p",{className:"text-xs",children:"No recent invoices"})]}):Ws.map(ye=>{const Be=ms.find(Jt=>Jt.id===ye.customerId),Ft=ye.dueDate&&new Date(ye.dueDate)<new Date&&ye.balanceDue>0,Kt=Je===ye.id;return e.jsxs("div",{className:"bg-slate-50 rounded-lg p-2 border border-slate-200 hover:bg-slate-100 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-slate-900",children:ye.invoiceNumber}),e.jsx(Oe,{variant:ye.status==="paid"?"default":Ft?"destructive":"secondary",className:"text-xs h-4",children:ye.status.charAt(0).toUpperCase()+ye.status.slice(1)}),Ft&&e.jsx(Oe,{variant:"destructive",className:"text-xs h-4",children:"Overdue"})]}),e.jsx("p",{className:"text-xs text-slate-600 truncate",children:Be?Be.name:"Unknown Customer"}),e.jsxs("p",{className:"text-xs text-slate-500",children:[new Date(ye.issueDate).toLocaleDateString(),ye.dueDate&&e.jsxs("span",{className:"ml-2",children:["Due: ",new Date(ye.dueDate).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"text-right ml-2",children:[e.jsx("p",{className:"text-xs font-semibold text-slate-900",children:cr(ye.totalAmount)}),ye.balanceDue>0&&e.jsxs("p",{className:"text-xs text-amber-600",children:["Due: ",cr(ye.balanceDue)]})]})]}),e.jsxs("div",{className:"flex gap-1 mt-2",children:[e.jsx(I,{variant:"outline",size:"sm",className:"h-6 text-xs flex-1",onClick:()=>{It(Kt?null:ye.id)},children:Kt?e.jsxs(e.Fragment,{children:[e.jsx(um,{className:"w-3 h-3 mr-1"}),"Hide"]}):e.jsxs(e.Fragment,{children:[e.jsx(ir,{className:"w-3 h-3 mr-1"}),"Actions"]})}),ye.status!=="paid"&&e.jsxs(I,{variant:"outline",size:"sm",className:"h-6 text-xs flex-1",onClick:Jt=>{Jt.stopPropagation(),Hi(ye)},children:[e.jsx(Gu,{className:"w-3 h-3 mr-1"}),"Select"]})]}),Kt&&e.jsxs("div",{className:"mt-2 p-2 bg-white rounded border border-slate-200 space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[e.jsxs(I,{variant:"outline",size:"sm",className:"h-7 text-xs",onClick:()=>wr(ye),children:[e.jsx(ir,{className:"w-3 h-3 mr-1"}),"View"]}),e.jsxs(I,{variant:"outline",size:"sm",className:"h-7 text-xs",onClick:()=>Ea(ye.id,ye.invoiceNumber),children:[e.jsx(An,{className:"w-3 h-3 mr-1"}),"PDF"]}),e.jsxs(I,{variant:"outline",size:"sm",className:"h-7 text-xs",onClick:()=>{Ct(ye.id),Ht((Be==null?void 0:Be.email)||""),qt(!0)},children:[e.jsx(wd,{className:"w-3 h-3 mr-1"}),"Email"]}),ye.balanceDue>0&&e.jsxs(I,{variant:"outline",size:"sm",className:"h-7 text-xs",onClick:()=>mi(ye.id,ye.invoiceNumber),children:[e.jsx(ac,{className:"w-3 h-3 mr-1"}),"Link"]})]}),ye.status==="draft"&&e.jsx(I,{variant:"outline",size:"sm",className:"w-full h-7 text-xs",onClick:()=>Gi(ye.id),disabled:A===ye.id,children:A===ye.id?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3 h-3 mr-1 animate-spin rounded-full border-2 border-gray-300 border-t-gray-600"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(wd,{className:"w-3 h-3 mr-1"}),"Mark as Sent"]})}),(ye.status==="sent"||ye.status==="pending")&&e.jsxs("div",{className:"space-y-1",children:[e.jsx(I,{variant:"default",size:"sm",className:"w-full h-7 text-xs bg-green-600 hover:bg-green-700",onClick:()=>Ti(ye.id),disabled:V===ye.id,children:V===ye.id?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-3 h-3 mr-1 animate-spin rounded-full border-2 border-white border-t-transparent"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(bs,{className:"w-3 h-3 mr-1"}),"Mark as Paid"]})}),ye.balanceDue>0&&e.jsx(v7,{invoiceId:ye.id,amount:ye.balanceDue,currency:(Be==null?void 0:Be.currency)||"USD",customerEmail:Be==null?void 0:Be.email,customerName:Be==null?void 0:Be.name,description:`Payment for Invoice ${ye.invoiceNumber}`,onPaymentSuccess:async()=>{try{const Jt=await de.processInvoicePayment(ye.id);a.invalidateQueries({queryKey:["pos-recent-invoices"]}),s({title:"Payment Successful",description:`Payment processed. Journal Entry: ${Jt.journalEntryId}`})}catch(Jt){console.error("Accounting integration error:",Jt),s({title:"Payment Successful",description:"Payment processed but accounting integration failed",variant:"destructive"})}},onPaymentError:Jt=>{console.error("Payment error:",Jt),s({title:"Payment Failed",description:"Payment processing failed",variant:"destructive"})}})]})]})]},ye.id)})})]})}),e.jsx("div",{className:"px-2 py-1 border-b border-slate-200 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium text-sm text-slate-900",children:"Cart"}),e.jsx(Oe,{variant:"secondary",className:"text-xs h-4",children:l.length})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0",children:[e.jsx("div",{className:"p-2 pb-0",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-slate-900",children:"Cart Items"}),e.jsxs(Oe,{variant:"secondary",children:[l.length," items"]})]})}),e.jsx("div",{className:"px-2 pb-2",children:l.length===0?e.jsxs("div",{className:"text-center py-6 text-slate-500",children:[e.jsx(Gu,{className:"w-6 h-6 mx-auto mb-2 text-slate-300"}),e.jsx("p",{className:"text-xs font-medium",children:"Cart is empty"}),e.jsx("p",{className:"text-xs",children:"Add items to start"})]}):e.jsx("div",{className:"space-y-1",children:l.map(ye=>e.jsxs("div",{className:"bg-slate-50 rounded-md p-1.5 border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-xs text-slate-900 truncate",children:ye.product.name}),e.jsxs("p",{className:"text-xs text-slate-500",children:[cr(ye.unitPrice)," each",ye.product.taxInclusive&&ye.product.taxRate&&ye.product.taxRate>0&&e.jsx("span",{className:"ml-1 text-xs text-green-600 font-medium",children:"(tax incl.)"})]})]}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>De(ye.product.id),className:"h-5 w-5 p-0 text-red-600 hover:text-red-700 hover:bg-red-50 ml-1",children:e.jsx(ma,{className:"w-2 h-2"})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(I,{variant:"outline",size:"sm",onClick:()=>Vn(ye.product.id,ye.quantity-1),className:"h-5 w-5 p-0",children:e.jsx(rM,{className:"w-2 h-2"})}),e.jsx("span",{className:"w-5 text-center text-xs font-medium",children:ye.quantity}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>Vn(ye.product.id,ye.quantity+1),className:"h-5 w-5 p-0",children:e.jsx(Ss,{className:"w-2 h-2"})})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"font-semibold text-slate-900 text-xs",children:cr(ye.lineTotal)})})]})]},ye.product.id))})})]}),e.jsx("div",{className:"border-t border-slate-200 p-2 space-y-2 flex-shrink-0 bg-white",children:l.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex gap-1",children:e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>P(!0),className:"flex-1 h-6 text-xs",children:[e.jsx(NY,{className:"w-3 h-3 mr-1"}),"Discount"]})}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-slate-600",children:"Subtotal"}),e.jsx("span",{className:"font-medium",children:cr(In)})]}),Yr>0&&e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-slate-600",children:"Discount"}),e.jsxs("span",{className:"font-medium text-red-600",children:["-",cr(Yr)]})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-slate-600",children:"Tax"}),e.jsx("span",{className:"font-medium",children:cr($r)})]}),e.jsxs("div",{className:"flex justify-between text-xs font-bold border-t border-slate-200 pt-1",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:cr(Vr)})]})]}),e.jsxs(I,{onClick:()=>oe(!0),disabled:!d||l.length===0,className:"w-full h-8 text-xs font-medium bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800",children:[e.jsx($a,{className:"w-3 h-3 mr-1"}),"Checkout ",cr(Vr)]})]}):e.jsxs("div",{className:"text-center py-2 text-slate-400",children:[e.jsx("div",{className:"text-xs",children:"Cart Summary"}),e.jsx("div",{className:"text-xs mt-1",children:"Add items to see totals"})]})})]})]}),e.jsx(ts,{open:J,onOpenChange:z,children:e.jsxs(ss,{className:"max-w-lg max-h-[85vh] flex flex-col",children:[e.jsx(as,{className:"flex-shrink-0",children:e.jsxs(is,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Select Customer"}),e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>{re(null),Z({name:"",email:"",currency:"USD"}),O(!0)},className:"h-7 text-xs",children:[e.jsx(Ss,{className:"w-3 h-3 mr-1"}),"New Customer"]})]})}),e.jsxs("div",{className:"flex flex-col space-y-3 flex-1 overflow-hidden",children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsx(Rn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-4 h-4"}),e.jsx(ge,{placeholder:"Search by name, email, or phone...",value:m,onChange:ye=>p(ye.target.value),className:"pl-9 h-10",autoFocus:!0}),m&&e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>p(""),className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0",children:e.jsx(ma,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>p(""),className:"h-7 text-xs",children:[e.jsx(Sa,{className:"w-3 h-3 mr-1"}),"All Customers"]}),qn.length>0&&e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>{const ye=qn.map(Be=>Be.name).join(" ");p(ye)},className:"h-7 text-xs",children:[e.jsx(Cr,{className:"w-3 h-3 mr-1"}),"Recent (",qn.length,")"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto space-y-1",children:rs?e.jsx("div",{className:"space-y-2",children:[...Array(3)].map((ye,Be)=>e.jsx("div",{className:"h-12 bg-slate-100 rounded-md animate-pulse"},Be))}):qr.length===0?e.jsxs("div",{className:"text-center py-8 text-slate-500",children:[e.jsx(Sa,{className:"w-8 h-8 mx-auto mb-2 text-slate-300"}),e.jsx("p",{className:"text-sm font-medium",children:"No customers found"}),e.jsx("p",{className:"text-xs",children:"Try a different search term"})]}):qr.map(ye=>e.jsx(I,{variant:"ghost",onClick:()=>qa(ye),className:"w-full justify-start h-auto p-3 hover:bg-slate-50",children:e.jsxs("div",{className:"flex items-center gap-3 w-full",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center text-white text-sm font-medium flex-shrink-0",children:ye.name.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1 text-left min-w-0",children:[e.jsx("div",{className:"font-medium text-sm text-slate-900 truncate",children:ye.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-500",children:[ye.email&&e.jsx("span",{className:"truncate",children:ye.email}),ye.phone&&e.jsx("span",{className:"truncate",children:ye.phone})]})]}),(d==null?void 0:d.id)===ye.id&&e.jsx(Ro,{className:"w-4 h-4 text-green-600 flex-shrink-0"})]})},ye.id))}),e.jsxs("div",{className:"flex gap-2 pt-2 border-t border-slate-200 flex-shrink-0",children:[e.jsx(I,{variant:"outline",onClick:()=>z(!1),className:"flex-1 h-8 text-xs",children:"Cancel"}),d&&e.jsx(I,{onClick:()=>{u(null),z(!1)},className:"flex-1 h-8 text-xs",children:"Clear Selection"})]})]})]})}),e.jsx(ts,{open:$e,onOpenChange:O,children:e.jsxs(ss,{children:[e.jsxs(as,{children:[e.jsx(is,{children:te?"Edit Customer":"Add Customer"}),e.jsx(Ks,{children:"Enter customer details below."})]}),ce&&e.jsx("div",{className:"text-red-600 text-sm",children:ce}),e.jsxs("div",{className:"space-y-4 py-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"cust-name",children:"Name"}),e.jsx(ge,{id:"cust-name",value:le.name,onChange:ye=>Z({...le,name:ye.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"cust-email",children:"Email"}),e.jsx(ge,{id:"cust-email",type:"email",value:le.email||"",onChange:ye=>Z({...le,email:ye.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"cust-currency",children:"Currency"}),e.jsx("select",{id:"cust-currency",className:"w-full border rounded px-2 py-2",value:le.currency||"USD",onChange:ye=>Z({...le,currency:ye.target.value}),children:["USD","EUR","GBP","KES","NGN"].map(ye=>e.jsx("option",{value:ye,children:ye},ye))})]})]}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:()=>O(!1),disabled:K,children:"Cancel"}),e.jsx(I,{onClick:async()=>{try{if(X(!0),Y(null),!le.name||le.name.trim()==="")throw new Error("Name is required");if(!i)throw new Error("No company selected");if(te)await de.updateCustomer(te.id,{companyId:i,name:le.name,email:le.email,currency:le.currency}),s({title:"Customer updated",description:`${le.name}`});else{const ye=await de.createCustomer({companyId:i,name:le.name,email:le.email,currency:le.currency});s({title:"Customer created",description:`${le.name}`}),a.setQueryData(["pos-customers",i],Be=>Be&&{...Be,items:[...Be.items||[],ye]})}await a.invalidateQueries({queryKey:["pos-customers",i]}),await a.invalidateQueries({queryKey:["customers"]}),O(!1),z(!1)}catch(ye){Y((ye==null?void 0:ye.message)||"Failed to save customer"),s({title:"Customer save failed",description:(ye==null?void 0:ye.message)||"Failed to save customer",variant:"destructive"})}finally{X(!1)}},disabled:K,children:K?"Saving":te?"Save Changes":"Create Customer"})]})]})}),e.jsx(ts,{open:U,onOpenChange:oe,children:e.jsxs(ss,{className:"max-w-md",children:[e.jsxs(as,{children:[e.jsx(is,{className:"text-lg",children:"Process Payment"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:cr(Vr)})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs(I,{variant:At==="card"?"default":"outline",onClick:()=>st("card"),className:"h-12 flex-col",children:[e.jsx($a,{className:"w-5 h-5 mb-1"}),e.jsx("span",{className:"text-xs",children:"Card"})]}),e.jsxs(I,{variant:At==="cash"?"default":"outline",onClick:()=>st("cash"),className:"h-12 flex-col",children:[e.jsx(P5,{className:"w-5 h-5 mb-1"}),e.jsx("span",{className:"text-xs",children:"Cash"})]}),e.jsxs(I,{variant:At==="mobile"?"default":"outline",onClick:()=>st("mobile"),className:"h-12 flex-col",children:[e.jsx(Sd,{className:"w-5 h-5 mb-1"}),e.jsx("span",{className:"text-xs",children:"Mobile"})]})]}),At==="cash"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(ge,{type:"number",placeholder:"Cash received",value:$t||"",onChange:ye=>fs(parseFloat(ye.target.value)||0),className:"h-10 text-center"}),$t>Vr&&e.jsx("div",{className:"text-center p-2 bg-green-50 rounded-lg",children:e.jsxs("div",{className:"text-green-700 font-medium text-sm",children:["Change: ",cr($t-Vr)]})})]}),e.jsx(I,{onClick:_t,disabled:zt||Pe.isPending,className:"w-full h-10 font-medium",children:zt||Pe.isPending?e.jsx(e.Fragment,{children:"Processing..."}):e.jsxs(e.Fragment,{children:[e.jsx(Ro,{className:"w-4 h-4 mr-2"}),"Complete Sale"]})})]})]})}),e.jsx(ts,{open:Q,onOpenChange:P,children:e.jsxs(ss,{className:"max-w-xs",children:[e.jsx(as,{children:e.jsx(is,{className:"text-base",children:"Apply Discount"})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(I,{variant:lt==="percent"?"default":"outline",onClick:()=>Fe("percent"),size:"sm",children:"Percentage"}),e.jsx(I,{variant:lt==="amount"?"default":"outline",onClick:()=>Fe("amount"),size:"sm",children:"Amount"})]}),e.jsx(ge,{type:"number",placeholder:lt==="percent"?"Discount %":"Discount amount",value:js||"",onChange:ye=>et(parseFloat(ye.target.value)||0),className:"h-10 text-center"}),e.jsx(I,{onClick:()=>P(!1),className:"w-full h-9",size:"sm",children:"Apply Discount"})]})]})}),e.jsx(ts,{open:q,onOpenChange:D,children:e.jsxs(ss,{className:"max-w-md",children:[e.jsx(as,{children:e.jsxs(is,{className:"text-lg flex items-center",children:[e.jsx(lh,{className:"w-5 h-5 mr-2"}),"Transaction Complete"]})}),pt&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"max-h-96 overflow-y-auto border rounded-lg",children:e.jsx(aW,{data:pt,className:"receipt-component"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(I,{onClick:async()=>{try{const ye=document.querySelector(".receipt-component");if(ye){const Be=await CR.printReceipt(ye,{paperSize:"thermal_80mm"});s(Be?{title:"Receipt Printed",description:"Receipt has been sent to printer"}:{title:"Print Failed",description:"Unable to print receipt",variant:"destructive"})}}catch(ye){console.error("Print error:",ye),s({title:"Print Error",description:"Failed to print receipt",variant:"destructive"})}},className:"flex items-center justify-center",children:[e.jsx(k5,{className:"w-4 h-4 mr-2"}),"Print"]}),e.jsxs(I,{variant:"outline",onClick:()=>{var ye;Me(((ye=pt.customer)==null?void 0:ye.email)||""),ve(!0)},className:"flex items-center justify-center",children:[e.jsx(Dd,{className:"w-4 h-4 mr-2"}),"Email"]})]}),e.jsx(I,{onClick:()=>D(!1),className:"w-full",variant:"outline",children:"Close"})]})]})}),e.jsx(ts,{open:!!y,onOpenChange:()=>j(null),children:e.jsxs(ss,{className:"max-w-md",children:[e.jsx(as,{children:e.jsxs(is,{className:"text-lg flex items-center",children:[e.jsx(Zl,{className:"w-5 h-5 mr-2"}),"Product Details"]})}),y&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-lg flex items-center justify-center ${Zn(y)?"bg-gradient-to-br from-purple-100 to-purple-200":"bg-gradient-to-br from-blue-100 to-blue-200"}`,children:typeof fi(y)=="string"?e.jsx("span",{className:"text-xl",children:fi(y)}):e.jsx(Hr,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-slate-900",children:y.name}),e.jsx("p",{className:"text-sm text-slate-600",children:((Ne=y.categoryObject)==null?void 0:Ne.name)||"Uncategorized"}),e.jsx("div",{className:`text-lg font-bold ${Zn(y)?"text-purple-600":"text-green-600"}`,children:cr(y.unitPrice)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600",children:"SKU:"}),e.jsx("div",{className:"font-medium",children:y.sku||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600",children:"Barcode:"}),e.jsx("div",{className:"font-medium",children:y.barcode||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600",children:"Type:"}),e.jsx("div",{className:"font-medium",children:Zn(y)?"Service":"Product"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600",children:"Status:"}),e.jsx("div",{className:"font-medium",children:y.status})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("h4",{className:"font-medium text-slate-900 mb-2",children:Zn(y)?"Availability":"Stock Information"}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:Zn(y)?"Available Slots:":"Current Stock:"}),e.jsx("span",{className:"font-medium",children:y.availableQuantity||y.stockQuantity||0})]}),!Zn(y)&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Minimum Stock:"}),e.jsx("span",{className:"font-medium",children:y.minStockLevel||"Not set"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Unit of Measure:"}),e.jsx("span",{className:"font-medium",children:"Each"})]})]})]})]}),y.description&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-slate-900 mb-2",children:"Description"}),e.jsx("p",{className:"text-sm text-slate-600",children:y.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(I,{onClick:ye=>{ye.stopPropagation(),ye.preventDefault(),wn(y),j(null)},disabled:y.status!=="ACTIVE"||(y.availableQuantity||y.stockQuantity||0)<=0,className:"flex-1",children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Add to Cart"]}),e.jsx(I,{variant:"outline",onClick:()=>xa(y.id),className:b.includes(y.id)?"bg-amber-50 text-amber-600":"",children:e.jsx(go,{className:"w-4 h-4",fill:b.includes(y.id)?"currentColor":"none"})})]})]})]})}),e.jsx(ts,{open:se,onOpenChange:Zs,children:e.jsxs(ss,{className:"sm:max-w-md",children:[e.jsx(as,{children:e.jsxs(is,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ww,{className:"w-5 h-5"}),"Barcode Scanner"]}),e.jsx("div",{className:"text-xs text-slate-500 font-normal",children:"Press Ctrl+B to open  ESC to close"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-slate-100 rounded-lg aspect-video flex items-center justify-center relative overflow-hidden",children:[S?e.jsx("video",{ref:ye=>{ye&&S&&(ye.srcObject=S,ye.play())},className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0,muted:!0}):e.jsx("div",{className:"text-center p-4",children:G?e.jsxs("div",{className:"text-red-600 space-y-2",children:[e.jsx(Ln,{className:"w-12 h-12 mx-auto"}),e.jsx("p",{className:"text-sm",children:G})]}):e.jsxs("div",{className:"text-slate-500 space-y-2",children:[e.jsx(Zj,{className:"w-12 h-12 mx-auto"}),e.jsx("p",{className:"text-sm",children:"Camera not active"})]})}),e.jsx("div",{className:"absolute bottom-2 left-2 right-2 flex gap-2",children:S?e.jsxs(I,{onClick:Pr,variant:"destructive",className:"flex-1",size:"sm",children:[e.jsx(_Y,{className:"w-4 h-4 mr-2"}),"Stop Camera"]}):e.jsxs(I,{onClick:ps,disabled:N,className:"flex-1",size:"sm",children:[e.jsx(kY,{className:"w-4 h-4 mr-2"}),"Start Camera"]})})]}),S&&e.jsx("div",{className:"text-center p-2 bg-blue-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-700 text-sm",children:[e.jsx(Zl,{className:"w-4 h-4"}),"Point camera at barcode to scan automatically"]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-slate-700",children:[e.jsx(pC,{className:"w-4 h-4"}),"Manual Entry"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ge,{placeholder:"Enter barcode or SKU...",value:k,onChange:ye=>F(ye.target.value),onKeyDown:ye=>{ye.key==="Enter"&&Wr(k)},className:"flex-1",autoFocus:!S}),e.jsx(I,{onClick:()=>Wr(k),disabled:!k.trim(),children:e.jsx(Ro,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium text-slate-700",children:"Test Barcodes"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[{code:"1234567890123",name:"Headphones"},{code:"1234567890124",name:"Office Chair"},{code:"1234567890125",name:"USB-C Hub"},{code:"1234567890126",name:"Standing Desk"}].map(ye=>e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{F(ye.code),Wr(ye.code)},className:"h-8 text-xs justify-start",children:e.jsxs("div",{className:"truncate",children:[e.jsx("div",{className:"font-mono",children:ye.code}),e.jsx("div",{className:"text-slate-500",children:ye.name})]})},ye.code))})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx(I,{variant:"outline",onClick:Zs,className:"flex-1",children:"Cancel"}),e.jsx(I,{onClick:()=>{F("");const ye=document.querySelector('input[placeholder*="barcode"]');ye&&ye.focus()},variant:"outline",className:"flex-1",children:"Clear"})]})]})]})}),e.jsx(ts,{open:Gt,onOpenChange:ye=>{qt(ye),ye||(Ct(null),Ht(""),gt(!1))},children:e.jsxs(ss,{className:"sm:max-w-md",children:[e.jsx(as,{children:e.jsxs(is,{className:"flex items-center gap-2",children:[e.jsx(Dd,{className:"w-5 h-5"}),"Send Invoice Email"]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700 mb-1",children:"Email Address"}),e.jsx(ge,{id:"email",type:"email",placeholder:"customer@example.com",value:As,onChange:ye=>Ht(ye.target.value),className:"w-full"})]}),e.jsx("div",{className:"text-xs text-slate-600 bg-slate-50 p-2 rounded",children:"Invoice PDF will be attached to the email automatically."})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(I,{variant:"outline",className:"flex-1",onClick:()=>qt(!1),disabled:ke,children:"Cancel"}),e.jsx(I,{className:"flex-1",onClick:Ki,disabled:ke||!As.trim(),children:ke?e.jsxs(e.Fragment,{children:[e.jsx(kr,{size:"sm",className:"mr-2",color:"teal"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(wd,{className:"w-4 h-4 mr-2"}),"Send Email"]})})]})]})}),e.jsx(ts,{open:be,onOpenChange:ye=>{pe(ye),ye||Ee(null)},children:e.jsxs(ss,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",style:{maxWidth:"calc(100vw - 300px)"},children:[e.jsx(as,{className:"pb-6 border-b border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl flex items-center justify-center",children:e.jsx(ir,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx(is,{className:"text-2xl font-bold text-slate-900",children:"Invoice Details"}),e.jsx(Ks,{className:"text-slate-600 mt-1",children:Ae?`Invoice ${Ae.invoiceNumber}`:"Loading invoice details..."})]})]})}),Ns&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-3",children:"Invoice Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Invoice Number:"}),e.jsx("span",{className:"font-medium",children:Ns.invoiceNumber})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Issue Date:"}),e.jsx("span",{className:"font-medium",children:new Date(Ns.issueDate).toLocaleDateString()})]}),Ns.dueDate&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Due Date:"}),e.jsx("span",{className:"font-medium",children:new Date(Ns.dueDate).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Status:"}),e.jsx(Oe,{variant:Ns.status==="paid"?"default":Ns.dueDate&&new Date(Ns.dueDate)<new Date&&Ns.balanceDue>0?"destructive":"secondary",children:Ns.status.charAt(0).toUpperCase()+Ns.status.slice(1)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Currency:"}),e.jsx("span",{className:"font-medium",children:Ns.currency||"USD"})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-3",children:"Customer Information"}),(()=>{const ye=ms.find(Be=>Be.id===Ns.customerId);return ye?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Name:"}),e.jsx("span",{className:"font-medium",children:ye.name})]}),ye.email&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Email:"}),e.jsx("span",{className:"font-medium",children:ye.email})]}),ye.phone&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Phone:"}),e.jsx("span",{className:"font-medium",children:ye.phone})]}),ye.address&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Address:"}),e.jsx("span",{className:"font-medium",children:ye.address})]})]}):e.jsx("p",{className:"text-slate-500",children:"Customer information not available"})})()]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-3",children:"Financial Summary"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Total Amount:"}),e.jsx("span",{className:"font-semibold text-lg",children:cr(Ns.totalAmount)})]}),Ns.balanceDue>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Balance Due:"}),e.jsx("span",{className:"font-semibold text-amber-600",children:cr(Ns.balanceDue)})]}),Ns.balanceDue===0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Payment Status:"}),e.jsx("span",{className:"font-semibold text-green-600",children:"Fully Paid"})]})]}),e.jsx("div",{className:"space-y-2",children:Ns.dueDate&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Days Until Due:"}),e.jsxs("span",{className:`font-medium ${new Date(Ns.dueDate)<new Date?"text-red-600":"text-slate-900"}`,children:[Math.ceil((new Date(Ns.dueDate).getTime()-new Date().getTime())/(1e3*60*60*24))," days"]})]})})]})]}),Ns.lines&&Ns.lines.length>0?e.jsxs("div",{className:"bg-white border border-slate-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Products & Services"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ol,{children:[e.jsx(Rl,{children:e.jsxs(Dn,{children:[e.jsx(_s,{children:"Product"}),e.jsx(_s,{children:"Quantity"}),e.jsx(_s,{children:"Unit Price"}),e.jsx(_s,{children:"Discount"}),e.jsx(_s,{children:"Tax Rate"}),e.jsx(_s,{className:"text-right",children:"Line Total"})]})}),e.jsx(Fl,{children:Ns.lines.map((ye,Be)=>{var Ft;return e.jsxs(Dn,{children:[e.jsx(Cs,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-100 to-blue-200 rounded-lg flex items-center justify-center",children:e.jsx(Hr,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-slate-900",children:ye.description}),ye.product&&e.jsxs("div",{className:"text-sm text-slate-500",children:["SKU: ",ye.product.sku||"N/A"," | Category: ",((Ft=ye.product.categoryObject)==null?void 0:Ft.name)||"Uncategorized"]})]})]})}),e.jsx(Cs,{children:e.jsx("div",{className:"font-medium",children:Number(ye.quantity)||0})}),e.jsx(Cs,{children:e.jsx("div",{className:"font-medium",children:cr(Number(ye.unitPrice)||0)})}),e.jsx(Cs,{children:e.jsx("div",{className:"text-sm",children:Number(ye.discountRate)>0?e.jsxs("span",{className:"text-green-600 font-medium",children:[Number(ye.discountRate),"%"]}):e.jsx("span",{className:"text-slate-400",children:"No discount"})})}),e.jsx(Cs,{children:e.jsx("div",{className:"text-sm",children:Number(ye.taxRate)>0?e.jsxs("span",{className:"text-blue-600 font-medium",children:[Number(ye.taxRate),"%"]}):e.jsx("span",{className:"text-slate-400",children:"No tax"})})}),e.jsx(Cs,{className:"text-right",children:e.jsx("div",{className:"font-semibold text-slate-900",children:cr(ye.lineTotal||Number(ye.quantity)*Number(ye.unitPrice))})})]},ye.id||Be)})})]})}),e.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Subtotal:"}),e.jsx("span",{className:"font-medium",children:cr(Ns.lines.reduce((ye,Be)=>ye+Number(Be.quantity)*Number(Be.unitPrice),0))})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Total Discount:"}),e.jsxs("span",{className:"font-medium text-green-600",children:["-",cr(Ns.lines.reduce((ye,Be)=>{const Ft=Number(Be.discountRate)||0,Kt=Number(Be.quantity)*Number(Be.unitPrice);return ye+Kt*(Ft/100)},0))]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Total Tax:"}),e.jsx("span",{className:"font-medium text-blue-600",children:cr(Ns.lines.reduce((ye,Be)=>{const Ft=Number(Be.taxRate)||0,Kt=Number(Be.quantity)*Number(Be.unitPrice);return ye+Kt*(Ft/100)},0))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Items Count:"}),e.jsxs("span",{className:"font-medium",children:[Ns.lines.length," items"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-600",children:"Total Quantity:"}),e.jsxs("span",{className:"font-medium",children:[Ns.lines.reduce((ye,Be)=>ye+Number(Be.quantity),0)," units"]})]}),e.jsxs("div",{className:"flex justify-between font-semibold text-lg pt-2 border-t border-slate-200",children:[e.jsx("span",{className:"text-slate-900",children:"Grand Total:"}),e.jsx("span",{className:"text-slate-900",children:cr(Ns.totalAmount)})]})]})]})})]}):e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Hr,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900",children:"Product Details"}),e.jsx("p",{className:"text-blue-700 text-sm",children:'This invoice was created via POS system. Product line items are stored in the invoice but may not be fully loaded in this view. For complete product details, please use the "Open in Sales" button below.'}),e.jsxs("div",{className:"mt-2 text-xs text-blue-600",children:["Debug: Invoice has ",((Dt=Ns.lines)==null?void 0:Dt.length)||0," line items"]})]})]})}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-slate-200",children:[e.jsxs(I,{variant:"outline",onClick:()=>Ea(Ns.id,Ns.invoiceNumber),className:"flex-1",children:[e.jsx(An,{className:"w-4 h-4 mr-2"}),"Download PDF"]}),e.jsxs(I,{variant:"outline",onClick:()=>{const ye=ms.find(Be=>Be.id===Ns.customerId);Ct(Ns.id),Ht((ye==null?void 0:ye.email)||""),qt(!0),pe(!1)},className:"flex-1",children:[e.jsx(wd,{className:"w-4 h-4 mr-2"}),"Send Email"]}),e.jsxs(I,{variant:"outline",onClick:()=>{window.open(`/sales?invoice=${Ns.id}`,"_blank")},className:"flex-1",children:[e.jsx(Nm,{className:"w-4 h-4 mr-2"}),"Open in Sales"]})]})]})]})}),e.jsx(ts,{open:ue,onOpenChange:ye=>{ve(ye),ye||(Me(""),fe(!1))},children:e.jsxs(ss,{className:"max-w-md",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Email Receipt"}),e.jsx(Ks,{children:"Enter the recipient email address to send the receipt."})]}),e.jsxs("div",{className:"space-y-3 py-2",children:[e.jsx(B,{htmlFor:"receipt-email-to",children:"Email Address"}),e.jsx(ge,{id:"receipt-email-to",type:"email",placeholder:"customer@example.com",value:Le,onChange:ye=>Me(ye.target.value)})]}),e.jsxs(Xr,{children:[e.jsx(I,{variant:"outline",onClick:()=>{ve(!1),Me(""),fe(!1)},children:"Cancel"}),e.jsx(I,{disabled:!Le||!pt||tt,onClick:async()=>{if(!(!Le||!pt||tt)){fe(!0);try{await CR.emailReceipt(pt,{to:Le,subject:`Receipt ${pt.invoiceNumber}`,message:"Thank you for your purchase! Your receipt is attached."})?(s({title:"Receipt Emailed",description:`Receipt sent to ${Le}`}),ve(!1),Me("")):s({title:"Email Failed",description:"Unable to send receipt via email",variant:"destructive"})}catch(ye){console.error("Email error:",ye),s({title:"Email Error",description:"Failed to send receipt",variant:"destructive"})}finally{fe(!1)}}},children:tt?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 mr-2 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(wd,{className:"w-4 h-4 mr-2"}),"Send Receipt"]})})]})]})})]})}function h7e({companyId:s,onSuccess:t,onCancel:r,initialData:n,mode:a="create"}){const{toast:i}=za(),{isAuthenticated:o}=Ua(),l=hi(),c=s||zs(),[d,u]=x.useState({date:new Date().toISOString().split("T")[0],reference:"",memo:"",entryTypeId:"",lines:[{accountId:"",debit:0,credit:0,memo:""}]}),[h,f]=x.useState(!1),[m,p]=x.useState([]),{data:g,isLoading:v}=ys({queryKey:["accounts",c],queryFn:()=>de.getAccounts(c),enabled:!!c&&o}),y=(g==null?void 0:g.accounts)||[],{data:j,isLoading:b}=ys({queryKey:["journal-entry-types",c],queryFn:()=>de.getJournalEntryTypes({companyId:c}),enabled:!!c&&o}),w=(j==null?void 0:j.entryTypes)||[],{data:N,isLoading:C}=ys({queryKey:["journal-templates",c],queryFn:()=>de.getJournalTemplates({companyId:c}),enabled:!!c&&o}),S=(N==null?void 0:N.templates)||[];x.useEffect(()=>{n&&u({date:n.date||new Date().toISOString().split("T")[0],reference:n.reference||"",memo:n.memo||"",entryTypeId:n.entryTypeId||"",lines:n.lines||[{accountId:"",debit:0,credit:0,memo:""}]})},[n]),x.useEffect(()=>{const z=d.lines.reduce((Q,P)=>{const q=Number(P.debit)||0;return Q+(isNaN(q)?0:q)},0),U=d.lines.reduce((Q,P)=>{const q=Number(P.credit)||0;return Q+(isNaN(q)?0:q)},0),oe=Math.abs(z-U)<.01;f(oe)},[d.lines]);const _=()=>{const z=[];return d.date||z.push("Date is required"),h||z.push("Journal entry must be balanced (debits = credits)"),d.lines.some(oe=>!oe.accountId||oe.debit===0&&oe.credit===0)&&z.push("All lines must have an account and either debit or credit amount"),p(z),z.length===0},k=Rs({mutationFn:z=>a==="edit"&&(n!=null&&n.id)?de.updateJournalEntry(n.id,z):de.createJournalEntry(z),onSuccess:z=>{i({title:"Success",description:`Journal entry ${a==="edit"?"updated":"created"} successfully`}),l.invalidateQueries({queryKey:["journal-entries"]}),l.invalidateQueries({queryKey:["journal-hub-summary"]}),t&&t(z)},onError:z=>{var U,oe;i({title:"Error",description:((oe=(U=z==null?void 0:z.response)==null?void 0:U.data)==null?void 0:oe.error)||"Failed to save journal entry",variant:"destructive"})}});Rs({mutationFn:z=>de.postJournalEntry(z),onSuccess:()=>{i({title:"Success",description:"Journal entry posted successfully"}),l.invalidateQueries({queryKey:["journal-entries"]}),l.invalidateQueries({queryKey:["journal-hub-summary"]})},onError:z=>{var U,oe;i({title:"Error",description:((oe=(U=z==null?void 0:z.response)==null?void 0:U.data)==null?void 0:oe.error)||"Failed to post journal entry",variant:"destructive"})}});const F=async()=>{if(!_())return;const z={...d,companyId:c,status:"DRAFT"};k.mutate(z)},A=async()=>{if(!_())return;const z={...d,companyId:c,status:"POSTED"};k.mutate(z)},T=()=>{u(z=>({...z,lines:[...z.lines,{accountId:"",debit:0,credit:0,memo:""}]}))},V=z=>{d.lines.length>1&&u(U=>({...U,lines:U.lines.filter((oe,Q)=>Q!==z)}))},M=(z,U,oe)=>{u(Q=>({...Q,lines:Q.lines.map((P,q)=>q===z?{...P,[U]:oe}:P)}))},G=z=>{z.lines&&z.lines.length>0&&(u(U=>({...U,entryTypeId:z.entryTypeId,lines:z.lines.map(oe=>({accountId:oe.accountId,debit:oe.debitFormula?0:oe.debit||0,credit:oe.creditFormula?0:oe.credit||0,memo:oe.memo||"",department:oe.department||"",project:oe.project||"",location:oe.location||""}))})),i({title:"Template Applied",description:`"${z.name}" has been applied successfully`}))},L=d.lines.reduce((z,U)=>{const oe=Number(U.debit)||0;return z+(isNaN(oe)?0:oe)},0),J=d.lines.reduce((z,U)=>{const oe=Number(U.credit)||0;return z+(isNaN(oe)?0:oe)},0);return o?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-white border-b border-gray-200 pb-4",children:e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-600 flex items-center justify-center",children:e.jsx(ml,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:a==="edit"?"Edit Journal Entry":a==="duplicate"?"Duplicate Journal Entry":"New Journal Entry"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Record manual accounting transactions"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"DIFFERENCE"}),e.jsxs("div",{className:`text-lg font-bold ${h?"text-green-600":"text-red-600"}`,children:["$",Math.abs(L-J).toFixed(2)]})]}),e.jsx("div",{className:"w-px h-10 bg-gray-300"}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"DEBITS"}),e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["$",(L||0).toFixed(2)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"CREDITS"}),e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["$",(J||0).toFixed(2)]})]}),h?e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx(bs,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-700",children:"Balanced"})]}):e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx(Ln,{className:"w-5 h-5 text-red-600"}),e.jsx("span",{className:"text-sm font-medium text-red-700",children:"Out of Balance"})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[e.jsxs("div",{className:"col-span-12 lg:col-span-4 space-y-4",children:[e.jsxs(ne,{className:"shadow-sm",children:[e.jsx(we,{className:"pb-3",children:e.jsx(Se,{className:"text-base font-semibold",children:"Entry Details"})}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs(B,{htmlFor:"date",className:"text-xs font-semibold text-gray-700 uppercase tracking-wide mb-2",children:["Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(ge,{id:"date",type:"date",value:d.date,onChange:z=>u(U=>({...U,date:z.target.value})),className:"border-gray-300 focus:border-blue-500 focus:ring-blue-500 mt-1"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"reference",className:"text-xs font-semibold text-gray-700 uppercase tracking-wide mb-2",children:"Journal # (optional)"}),e.jsx(ge,{id:"reference",value:d.reference,onChange:z=>u(U=>({...U,reference:z.target.value})),placeholder:"e.g., JE-2025-001",className:"border-gray-300 focus:border-blue-500 focus:ring-blue-500 mt-1"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Auto-generated if left blank"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"entryType",className:"text-xs font-semibold text-gray-700 uppercase tracking-wide mb-2",children:"Entry Type"}),e.jsxs(rt,{value:d.entryTypeId,onValueChange:z=>u(U=>({...U,entryTypeId:z})),children:[e.jsx(nt,{className:"border-gray-300 focus:border-blue-500 focus:ring-blue-500 mt-1",children:e.jsx(it,{placeholder:"Select type..."})}),e.jsxs(at,{children:[e.jsx(W,{value:"__placeholder__",disabled:!0,children:e.jsx("span",{className:"text-gray-500",children:"No type selected"})}),w.map(z=>e.jsx(W,{value:z.id,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),z.name]})},z.id))]})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"memo",className:"text-xs font-semibold text-gray-700 uppercase tracking-wide mb-2",children:"Description / Memo"}),e.jsx(Xs,{id:"memo",value:d.memo,onChange:z=>u(U=>({...U,memo:z.target.value})),placeholder:"Enter a description for this journal entry...",rows:4,className:"border-gray-300 focus:border-blue-500 focus:ring-blue-500 resize-none mt-1"})]})]})]}),S.length>0&&e.jsxs(ne,{className:"shadow-sm",children:[e.jsx(we,{className:"pb-3",children:e.jsxs(Se,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx(Za,{className:"w-4 h-4 text-amber-500"}),"Quick Templates"]})}),e.jsxs(ie,{className:"space-y-2",children:[C?e.jsx("div",{className:"flex items-center justify-center py-4",children:e.jsx(Ts,{className:"w-4 h-4 animate-spin text-gray-400"})}):S.slice(0,5).map(z=>{var U;return e.jsxs("button",{onClick:()=>G(z),className:"w-full text-left p-3 rounded-lg border border-gray-200 hover:border-blue-500 hover:bg-blue-50 transition-colors group",children:[e.jsx("div",{className:"font-medium text-sm text-gray-900 group-hover:text-blue-600",children:z.name}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[((U=z.lines)==null?void 0:U.length)||0," line items"]})]},z.id)}),S.length>5&&e.jsx("button",{className:"w-full text-center text-xs text-blue-600 hover:text-blue-700 font-medium py-2",children:"View all templates "})]})]})]}),e.jsxs("div",{className:"col-span-12 lg:col-span-8",children:[e.jsxs(ne,{className:"shadow-sm",children:[e.jsx(we,{className:"pb-3 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{className:"text-base font-semibold",children:"Line Items"}),e.jsxs(I,{onClick:T,size:"sm",className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(Ss,{className:"w-4 h-4 mr-1"}),"Add Line"]})]})}),e.jsxs(ie,{className:"p-0",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-4 px-4 py-3 bg-gray-50 border-b border-gray-200 text-xs font-semibold text-gray-700 uppercase tracking-wide",children:[e.jsx("div",{className:"col-span-1",children:"#"}),e.jsx("div",{className:"col-span-4",children:"Account"}),e.jsx("div",{className:"col-span-3",children:"Description"}),e.jsx("div",{className:"col-span-2 text-right",children:"Debit"}),e.jsx("div",{className:"col-span-2 text-right",children:"Credit"})]}),e.jsx("div",{className:"divide-y divide-gray-200",children:d.lines.map((z,U)=>e.jsxs("div",{className:"grid grid-cols-12 gap-4 px-4 py-3 hover:bg-gray-50 group transition-colors",children:[e.jsx("div",{className:"col-span-1 flex items-center",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:U+1}),d.lines.length>1&&e.jsx(I,{size:"sm",variant:"ghost",onClick:()=>V(U),className:"opacity-0 group-hover:opacity-100 transition-opacity h-6 w-6 p-0 hover:bg-red-50 hover:text-red-600",children:e.jsx(hn,{className:"w-3 h-3"})})]})}),e.jsx("div",{className:"col-span-4",children:e.jsxs(rt,{value:z.accountId,onValueChange:oe=>M(U,"accountId",oe),disabled:v,children:[e.jsx(nt,{className:"border-gray-300 focus:border-blue-500 h-9 text-sm",children:e.jsx(it,{placeholder:v?"Loading...":"Select account"})}),e.jsx(at,{className:"max-h-[300px]",children:v?e.jsx(W,{value:"loading",disabled:!0,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ts,{className:"w-3 h-3 animate-spin"}),"Loading accounts..."]})}):y.length===0?e.jsx(W,{value:"no-accounts",disabled:!0,children:e.jsx("span",{className:"text-gray-500",children:"No accounts found"})}):y.map(oe=>{var Q,P;return e.jsx(W,{value:oe.id,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"font-medium",children:[oe.code," - ",oe.name]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[typeof oe.type=="string"?oe.type:((Q=oe.type)==null?void 0:Q.name)||"N/A","  ",typeof oe.category=="string"?oe.category:((P=oe.category)==null?void 0:P.name)||"N/A"]})]})},oe.id)})})]})}),e.jsx("div",{className:"col-span-3",children:e.jsx(ge,{value:z.memo||"",onChange:oe=>M(U,"memo",oe.target.value),placeholder:"Description...",className:"border-gray-300 focus:border-blue-500 h-9 text-sm"})}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm",children:"$"}),e.jsx(ge,{type:"number",step:"0.01",min:"0",value:z.debit||"",onChange:oe=>M(U,"debit",parseFloat(oe.target.value)||0),placeholder:"0.00",className:"border-gray-300 focus:border-blue-500 h-9 text-sm text-right pl-6 font-mono"})]})}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 text-sm",children:"$"}),e.jsx(ge,{type:"number",step:"0.01",min:"0",value:z.credit||"",onChange:oe=>M(U,"credit",parseFloat(oe.target.value)||0),placeholder:"0.00",className:"border-gray-300 focus:border-blue-500 h-9 text-sm text-right pl-6 font-mono"})]})})]},U))}),e.jsxs("div",{className:"grid grid-cols-12 gap-4 px-4 py-4 bg-gray-50 border-t-2 border-gray-300",children:[e.jsx("div",{className:"col-span-8 flex items-center justify-end",children:e.jsx("span",{className:"text-sm font-bold text-gray-900 uppercase",children:"Totals"})}),e.jsx("div",{className:"col-span-2 text-right",children:e.jsxs("div",{className:"text-base font-bold text-gray-900",children:["$",(L||0).toFixed(2)]})}),e.jsx("div",{className:"col-span-2 text-right",children:e.jsxs("div",{className:"text-base font-bold text-gray-900",children:["$",(J||0).toFixed(2)]})})]})]})]}),m.length>0&&e.jsx(ne,{className:"mt-4 border-red-200 bg-red-50 shadow-sm",children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(Ln,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-semibold text-red-800 mb-2",children:"Please fix the following issues:"}),e.jsx("ul",{className:"space-y-1",children:m.map((z,U)=>e.jsxs("li",{className:"text-sm text-red-700 flex items-center gap-2",children:[e.jsx("div",{className:"w-1 h-1 rounded-full bg-red-600"}),z]},U))})]})]})})})]})]}),e.jsx("div",{className:"sticky bottom-0 z-10 bg-white border-t border-gray-200 pt-4 mt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:r&&e.jsxs(I,{variant:"outline",onClick:r,className:"border-gray-300",children:[e.jsx(ma,{className:"w-4 h-4 mr-2"}),"Cancel"]})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(I,{variant:"outline",onClick:F,disabled:k.isPending||!d.date,className:"border-gray-300",children:k.isPending?e.jsxs(e.Fragment,{children:[e.jsx(Ts,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Od,{className:"w-4 h-4 mr-2"}),"Save as Draft"]})}),e.jsx(I,{onClick:A,disabled:k.isPending||!h||m.length>0,className:"bg-blue-600 hover:bg-blue-700 shadow-sm",children:k.isPending?e.jsxs(e.Fragment,{children:[e.jsx(Ts,{className:"w-4 h-4 mr-2 animate-spin"}),"Posting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(bs,{className:"w-4 h-4 mr-2"}),"Save and Post"]})})]})]})})]}):null}function m7e({companyId:s,entries:t,currentFilters:r,onRefresh:n,permissions:a}){const{toast:i}=za(),o=hi(),l=x.useRef(null),[c,d]=x.useState([]),[u,h]=x.useState(!1),[f,m]=x.useState("approve"),[p,g]=x.useState(""),[v,y]=x.useState(""),[j,b]=x.useState(!1),[w,N]=x.useState(!1),[C,S]=x.useState(null),[_,k]=x.useState(""),[F,A]=x.useState({validateBalances:!0,createAsDraft:!0,skipHeaderRow:!0,dateFormat:"YYYY-MM-DD"}),[T,V]=x.useState({format:"detailed",fileFormat:"csv",dateFrom:(r==null?void 0:r.dateFrom)||"",dateTo:(r==null?void 0:r.dateTo)||"",status:(r==null?void 0:r.status)||"all",entryType:(r==null?void 0:r.entryType)||"all"}),[M,G]=x.useState(!1),[L,J]=x.useState(null),[z,U]=x.useState(!1),oe=x.useMemo(()=>{switch(f){case"approve":return t.filter(te=>te.status==="PENDING_APPROVAL");case"post":return t.filter(te=>te.status==="DRAFT");case"reverse":return t.filter(te=>te.status==="POSTED");default:return t}},[t,f]),Q=Rs({mutationFn:te=>de.batchApproveJournalEntries(te),onSuccess:te=>{J(te.data),U(!0),o.invalidateQueries({queryKey:["journal-entries"]}),i({title:"Success",description:`Approved ${te.data.summary.successful} entries`}),n()},onError:te=>{var re,le;i({title:"Error",description:((le=(re=te==null?void 0:te.response)==null?void 0:re.data)==null?void 0:le.message)||"Batch approve failed",variant:"destructive"})}}),P=Rs({mutationFn:te=>de.batchPostJournalEntries(te),onSuccess:te=>{J(te.data),U(!0),o.invalidateQueries({queryKey:["journal-entries"]}),i({title:"Success",description:`Posted ${te.data.summary.successful} entries`}),n()},onError:te=>{var re,le;i({title:"Error",description:((le=(re=te==null?void 0:te.response)==null?void 0:re.data)==null?void 0:le.message)||"Batch post failed",variant:"destructive"})}}),q=Rs({mutationFn:te=>de.batchReverseJournalEntries(te),onSuccess:te=>{J(te.data),U(!0),o.invalidateQueries({queryKey:["journal-entries"]}),i({title:"Success",description:`Reversed ${te.data.summary.successful} entries`}),n()},onError:te=>{var re,le;i({title:"Error",description:((le=(re=te==null?void 0:te.response)==null?void 0:re.data)==null?void 0:le.message)||"Batch reverse failed",variant:"destructive"})}}),D=Rs({mutationFn:te=>de.importJournalEntriesCsv(te),onSuccess:te=>{J(te.data),U(!0),o.invalidateQueries({queryKey:["journal-entries"]}),i({title:"Success",description:`Imported ${te.data.summary.successful} entries`}),n()},onError:te=>{var re,le;i({title:"Error",description:((le=(re=te==null?void 0:te.response)==null?void 0:re.data)==null?void 0:le.message)||"Import failed",variant:"destructive"})}}),se=Rs({mutationFn:te=>de.exportJournalEntriesCsv(te),onSuccess:te=>{const re=window.URL.createObjectURL(te),le=document.createElement("a");le.href=re,le.download=`journal-entries-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(le),le.click(),document.body.removeChild(le),window.URL.revokeObjectURL(re),i({title:"Success",description:"Entries exported successfully"})},onError:te=>{var re,le;i({title:"Error",description:((le=(re=te==null?void 0:te.response)==null?void 0:re.data)==null?void 0:le.message)||"Export failed",variant:"destructive"})}}),he=async()=>{if(c.length===0){i({title:"Error",description:"Please select at least one entry",variant:"destructive"});return}G(!0);try{switch(f){case"approve":await Q.mutateAsync({entryIds:c,comments:p});break;case"post":await P.mutateAsync({entryIds:c});break;case"reverse":if(!v){i({title:"Error",description:"Reason is required for reversal",variant:"destructive"}),G(!1);return}await q.mutateAsync({entryIds:c,reason:v});break}d([]),h(!1)}finally{G(!1)}},be=te=>{d(re=>re.includes(te)?re.filter(le=>le!==te):[...re,te])},pe=()=>{c.length===oe.length?d([]):d(oe.map(te=>te.id))},Ae=te=>{var le;const re=(le=te.target.files)==null?void 0:le[0];if(re){S(re);const Z=new FileReader;Z.onload=K=>{var ce;const X=(ce=K.target)==null?void 0:ce.result;k(X)},Z.readAsText(re)}},Ee=async()=>{if(!_){i({title:"Error",description:"Please select a file to import",variant:"destructive"});return}G(!0);try{await D.mutateAsync({csvData:_,options:F}),b(!1),S(null),k("")}finally{G(!1)}},$e=async()=>{G(!0);try{await se.mutateAsync(T),N(!1)}finally{G(!1)}},O=()=>{const te=`date,reference,memo,account_code,debit,credit,department,project
2024-01-01,JE-001,Sample Entry,1000,1000,0,,
2024-01-01,JE-001,Sample Entry,2000,0,1000,,`,re=new Blob([te],{type:"text/csv"}),le=window.URL.createObjectURL(re),Z=document.createElement("a");Z.href=le,Z.download="journal-entry-template.csv",document.body.appendChild(Z),Z.click(),document.body.removeChild(Z),window.URL.revokeObjectURL(le),i({title:"Success",description:"Template downloaded"})};return e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center gap-2",children:[e.jsx(e1,{className:"w-5 h-5"}),"Data Operations"]}),e.jsx(Vt,{children:"Batch processing, import, and export journal entries"})]}),e.jsxs(ie,{children:[e.jsxs(an,{defaultValue:"batch",className:"w-full",children:[e.jsxs(on,{className:"grid w-full grid-cols-2",children:[e.jsx(vt,{value:"batch",children:"Batch Processing"}),e.jsx(vt,{value:"import-export",children:"Import/Export"})]}),e.jsx(yt,{value:"batch",className:"space-y-4",children:e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(ts,{open:u,onOpenChange:h,children:[e.jsx(ki,{asChild:!0,children:e.jsxs(I,{variant:"outline",onClick:()=>m("approve"),disabled:!a.canApprove,children:[e.jsx(bs,{className:"w-4 h-4 mr-2"}),"Batch Approve"]})}),e.jsxs(ss,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(as,{children:[e.jsxs(is,{children:[f==="approve"&&"Batch Approve Entries",f==="post"&&"Batch Post Entries",f==="reverse"&&"Batch Reverse Entries"]}),e.jsx(Ks,{children:"Select entries to process in batch"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-gray-50 rounded-lg",children:[e.jsx(ka,{id:"select-all",checked:c.length===oe.length&&oe.length>0,onCheckedChange:pe}),e.jsxs(B,{htmlFor:"select-all",className:"cursor-pointer flex-1",children:["Select All (",oe.length," entries)"]}),e.jsxs(Oe,{variant:"secondary",children:[c.length," selected"]})]}),e.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto",children:oe.length===0?e.jsxs(ua,{children:[e.jsx(Zl,{className:"h-4 w-4"}),e.jsxs(ha,{children:["No entries available for ",f]})]}):oe.map(te=>{var re;return e.jsxs("div",{className:"flex items-center space-x-2 p-3 border rounded-lg hover:bg-gray-50",children:[e.jsx(ka,{id:te.id,checked:c.includes(te.id),onCheckedChange:()=>be(te.id)}),e.jsx(B,{htmlFor:te.id,className:"cursor-pointer flex-1",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:te.reference}),e.jsx("div",{className:"text-sm text-gray-600",children:te.memo})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-medium",children:["$",((re=te.totalAmount)==null?void 0:re.toFixed(2))||"0.00"]}),e.jsx(Oe,{variant:te.isBalanced?"default":"destructive",className:"text-xs",children:te.isBalanced?"Balanced":"Unbalanced"})]})]})})]},te.id)})}),f==="approve"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"batch-comments",children:"Comments (optional)"}),e.jsx(Xs,{id:"batch-comments",value:p,onChange:te=>g(te.target.value),placeholder:"Add comments for approval...",rows:3})]}),f==="reverse"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"batch-reason",children:"Reversal Reason *"}),e.jsx(Xs,{id:"batch-reason",value:v,onChange:te=>y(te.target.value),placeholder:"Provide reason for reversal...",rows:3,required:!0})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(I,{variant:"outline",onClick:()=>h(!1),disabled:M,children:"Cancel"}),e.jsx(I,{onClick:he,disabled:c.length===0||M,children:M?e.jsxs(e.Fragment,{children:[e.jsx(On,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:["Process ",c.length," Entries"]})})]})]})]})]}),e.jsxs(I,{variant:"outline",onClick:()=>{m("post"),h(!0)},disabled:!a.canPost,children:[e.jsx(Zt,{className:"w-4 h-4 mr-2"}),"Batch Post"]}),e.jsxs(I,{variant:"outline",onClick:()=>{m("reverse"),h(!0)},disabled:!a.canReverse,children:[e.jsx(gC,{className:"w-4 h-4 mr-2"}),"Batch Reverse"]})]})}),e.jsx(yt,{value:"import-export",className:"space-y-4",children:e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(ts,{open:j,onOpenChange:b,children:[e.jsx(ki,{asChild:!0,children:e.jsxs(I,{variant:"outline",children:[e.jsx(Pl,{className:"w-4 h-4 mr-2"}),"Import Entries"]})}),e.jsxs(ss,{className:"max-w-2xl",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Import Journal Entries"}),e.jsx(Ks,{children:"Upload a CSV file to import multiple journal entries"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"import-file",children:"CSV File"}),e.jsx(ge,{id:"import-file",type:"file",accept:".csv",ref:l,onChange:Ae}),C&&e.jsxs("div",{className:"text-sm text-gray-600",children:["Selected: ",C.name," (",(C.size/1024).toFixed(2)," KB)"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(B,{children:"Import Options"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ka,{id:"validate-balances",checked:F.validateBalances,onCheckedChange:te=>A(re=>({...re,validateBalances:te}))}),e.jsx(B,{htmlFor:"validate-balances",className:"text-sm",children:"Validate entry balances"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ka,{id:"create-draft",checked:F.createAsDraft,onCheckedChange:te=>A(re=>({...re,createAsDraft:te}))}),e.jsx(B,{htmlFor:"create-draft",className:"text-sm",children:"Create entries as drafts"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ka,{id:"skip-header",checked:F.skipHeaderRow,onCheckedChange:te=>A(re=>({...re,skipHeaderRow:te}))}),e.jsx(B,{htmlFor:"skip-header",className:"text-sm",children:"Skip header row"})]})]})]}),e.jsxs(ua,{children:[e.jsx(Zl,{className:"h-4 w-4"}),e.jsxs(ha,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Need a template?"}),e.jsx(I,{variant:"link",size:"sm",onClick:O,children:"Download CSV Template"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(I,{variant:"outline",onClick:()=>b(!1),disabled:M,children:"Cancel"}),e.jsx(I,{onClick:Ee,disabled:!_||M,children:M?e.jsxs(e.Fragment,{children:[e.jsx(On,{className:"w-4 h-4 mr-2 animate-spin"}),"Importing..."]}):e.jsx(e.Fragment,{children:"Import Entries"})})]})]})]})]}),e.jsxs(ts,{open:w,onOpenChange:N,children:[e.jsx(ki,{asChild:!0,children:e.jsxs(I,{variant:"outline",children:[e.jsx(An,{className:"w-4 h-4 mr-2"}),"Export Entries"]})}),e.jsxs(ss,{children:[e.jsxs(as,{children:[e.jsx(is,{children:"Export Journal Entries"}),e.jsx(Ks,{children:"Configure export options and download entries"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"Export Format"}),e.jsxs(rt,{value:T.format,onValueChange:te=>V(re=>({...re,format:te})),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"detailed",children:"Detailed (with all fields)"}),e.jsx(W,{value:"summary",children:"Summary (essential fields only)"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{children:"File Format"}),e.jsxs(rt,{value:T.fileFormat,onValueChange:te=>V(re=>({...re,fileFormat:te})),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"csv",children:"CSV (.csv)"}),e.jsx(W,{value:"excel",children:"Excel (.xlsx)"})]})]})]}),e.jsxs(ua,{children:[e.jsx(Zl,{className:"h-4 w-4"}),e.jsxs(ha,{children:["Export will use current filters: ",(r==null?void 0:r.status)||"all statuses",",",r!=null&&r.dateFrom&&(r!=null&&r.dateTo)?` ${r.dateFrom} to ${r.dateTo}`:" all dates"]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(I,{variant:"outline",onClick:()=>N(!1),disabled:M,children:"Cancel"}),e.jsx(I,{onClick:$e,disabled:M,children:M?e.jsxs(e.Fragment,{children:[e.jsx(On,{className:"w-4 h-4 mr-2 animate-spin"}),"Exporting..."]}):e.jsx(e.Fragment,{children:"Export"})})]})]})]})]})]})})]}),z&&L&&e.jsx(ts,{open:z,onOpenChange:U,children:e.jsxs(ss,{className:"max-w-2xl",children:[e.jsx(as,{children:e.jsx(is,{children:"Operation Results"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:L.summary.total}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:L.summary.successful}),e.jsx("div",{className:"text-sm text-gray-600",children:"Successful"})]}),e.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:L.summary.failed}),e.jsx("div",{className:"text-sm text-gray-600",children:"Failed"})]})]}),L.errors.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-red-600",children:"Errors:"}),e.jsx("div",{className:"max-h-40 overflow-y-auto space-y-1",children:L.errors.map((te,re)=>e.jsxs(ua,{variant:"destructive",children:[e.jsx(nc,{className:"h-4 w-4"}),e.jsx(ha,{children:(te==null?void 0:te.message)||(te==null?void 0:te.toString())||"Unknown error"})]},re))})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(I,{onClick:()=>U(!1),children:"Close"})})]})]})})]})]})}function f7e({companyId:s,onSearchResults:t,onClose:r}){const{toast:n}=za(),a=hi(),[i,o]=x.useState({sortBy:"date",sortOrder:"desc"}),[l,c]=x.useState(!1),[d,u]=x.useState({name:"",description:"",isPublic:!1}),[h,f]=x.useState({basic:!0,advanced:!1,amounts:!1,metadata:!1}),[m,p]=x.useState({}),[g,v]=x.useState(!1),{data:y}=ys({queryKey:["saved-journal-searches",s],queryFn:()=>de.getSavedJournalSearches(!0),enabled:!!s}),j=(y==null?void 0:y.data)||[],{data:b}=ys({queryKey:["journal-entry-types",s],queryFn:()=>de.getJournalEntryTypes(s),enabled:!!s}),{data:w}=ys({queryKey:["accounts",s],queryFn:()=>de.getAccounts(s),enabled:!!s}),N=(b==null?void 0:b.entryTypes)||[],C=(w==null?void 0:w.accounts)||[],S=Rs({mutationFn:z=>de.searchJournalEntriesAdvanced(z),onSuccess:z=>{t(z.data),n({title:"Search Complete",description:`Found ${z.data.entries.length} entries`})},onError:z=>{var U,oe;n({title:"Search Error",description:((oe=(U=z==null?void 0:z.response)==null?void 0:U.data)==null?void 0:oe.message)||"Search failed",variant:"destructive"})}}),_=Rs({mutationFn:z=>de.saveJournalSearch(z),onSuccess:()=>{a.invalidateQueries({queryKey:["saved-journal-searches"]}),n({title:"Success",description:"Search saved successfully"}),c(!1),u({name:"",description:"",isPublic:!1})},onError:z=>{var U,oe;n({title:"Error",description:((oe=(U=z==null?void 0:z.response)==null?void 0:U.data)==null?void 0:oe.message)||"Failed to save search",variant:"destructive"})}}),k=Rs({mutationFn:z=>de.deleteJournalSearch(z),onSuccess:()=>{a.invalidateQueries({queryKey:["saved-journal-searches"]}),n({title:"Success",description:"Search deleted successfully"})},onError:z=>{var U,oe;n({title:"Error",description:((oe=(U=z==null?void 0:z.response)==null?void 0:U.data)==null?void 0:oe.message)||"Failed to delete search",variant:"destructive"})}}),F=()=>{v(!0),S.mutate({companyId:s,...i})},A=()=>{if(!d.name.trim()){n({title:"Error",description:"Search name is required",variant:"destructive"});return}_.mutate({...d,filters:i})},T=z=>{o(z.filters),n({title:"Search Loaded",description:`Loaded "${z.name}"`})},V=z=>{confirm("Are you sure you want to delete this saved search?")&&k.mutate(z)},M=()=>{o({sortBy:"date",sortOrder:"desc"})},G=async(z,U)=>{if(!(U.length<2))try{const oe=await de.getJournalSearchSuggestions(z,U);p(Q=>({...Q,[z]:oe.data}))}catch{}},L=z=>{f(U=>({...U,[z]:!U[z]}))},J=(z,U)=>{o(oe=>({...oe,[z]:U}))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center space-x-2",children:[e.jsx(Rn,{className:"w-5 h-5"}),e.jsx("span",{children:"Advanced Search"})]}),e.jsx(Vt,{children:"Use multiple filters to find specific journal entries"})]}),e.jsxs(ie,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-medium flex items-center space-x-2",children:[e.jsx(Rn,{className:"w-4 h-4"}),e.jsx("span",{children:"Basic Search"})]}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>L("basic"),children:h.basic?e.jsx(um,{className:"w-4 h-4"}):e.jsx(tc,{className:"w-4 h-4"})})]}),h.basic&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"searchTerm",children:"Search Term"}),e.jsx(ge,{id:"searchTerm",placeholder:"Search references, memos...",value:i.searchTerm||"",onChange:z=>J("searchTerm",z.target.value)})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"reference",children:"Reference"}),e.jsx(ge,{id:"reference",placeholder:"Specific reference...",value:i.reference||"",onChange:z=>{J("reference",z.target.value),G("reference",z.target.value)}}),m.reference&&m.reference.length>0&&e.jsx("div",{className:"mt-1 space-y-1",children:m.reference.slice(0,5).map((z,U)=>e.jsx("div",{className:"text-xs text-gray-600 cursor-pointer hover:bg-gray-100 p-1 rounded",onClick:()=>J("reference",z),children:z},U))})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"memo",children:"Memo"}),e.jsx(ge,{id:"memo",placeholder:"Memo text...",value:i.memo||"",onChange:z=>{J("memo",z.target.value),G("memo",z.target.value)}}),m.memo&&m.memo.length>0&&e.jsx("div",{className:"mt-1 space-y-1",children:m.memo.slice(0,5).map((z,U)=>e.jsx("div",{className:"text-xs text-gray-600 cursor-pointer hover:bg-gray-100 p-1 rounded",onClick:()=>J("memo",z),children:z},U))})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"status",children:"Status"}),e.jsxs(rt,{value:i.status||"all",onValueChange:z=>J("status",z==="all"?void 0:z),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Status"}),e.jsx(W,{value:"DRAFT",children:"Draft"}),e.jsx(W,{value:"POSTED",children:"Posted"}),e.jsx(W,{value:"REVERSED",children:"Reversed"}),e.jsx(W,{value:"PENDING_APPROVAL",children:"Pending Approval"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-medium flex items-center space-x-2",children:[e.jsx(Ic,{className:"w-4 h-4"}),e.jsx("span",{children:"Advanced Filters"})]}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>L("advanced"),children:h.advanced?e.jsx(um,{className:"w-4 h-4"}):e.jsx(tc,{className:"w-4 h-4"})})]}),h.advanced&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"dateFrom",children:"Date From"}),e.jsx(ge,{id:"dateFrom",type:"date",value:i.dateFrom||"",onChange:z=>J("dateFrom",z.target.value)})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"dateTo",children:"Date To"}),e.jsx(ge,{id:"dateTo",type:"date",value:i.dateTo||"",onChange:z=>J("dateTo",z.target.value)})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"entryType",children:"Entry Type"}),e.jsxs(rt,{value:i.entryType||"all",onValueChange:z=>J("entryType",z==="all"?void 0:z),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Types"}),N.map(z=>e.jsx(W,{value:z.id,children:z.name},z.id))]})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"accountId",children:"Account"}),e.jsxs(rt,{value:i.accountId||"all",onValueChange:z=>J("accountId",z==="all"?void 0:z),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Accounts"}),C.map(z=>e.jsxs(W,{value:z.id,children:[z.name," (",z.type,")"]},z.id))]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ka,{id:"isBalanced",checked:i.isBalanced===!0,onCheckedChange:z=>J("isBalanced",z?!0:void 0)}),e.jsx(B,{htmlFor:"isBalanced",children:"Only Balanced Entries"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-medium flex items-center space-x-2",children:[e.jsx(Mr,{className:"w-4 h-4"}),e.jsx("span",{children:"Amount Filters"})]}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>L("amounts"),children:h.amounts?e.jsx(um,{className:"w-4 h-4"}):e.jsx(tc,{className:"w-4 h-4"})})]}),h.amounts&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"amountMin",children:"Minimum Amount"}),e.jsx(ge,{id:"amountMin",type:"number",step:"0.01",placeholder:"0.00",value:i.amountMin||"",onChange:z=>J("amountMin",z.target.value?parseFloat(z.target.value):void 0)})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"amountMax",children:"Maximum Amount"}),e.jsx(ge,{id:"amountMax",type:"number",step:"0.01",placeholder:"0.00",value:i.amountMax||"",onChange:z=>J("amountMax",z.target.value?parseFloat(z.target.value):void 0)})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-medium flex items-center space-x-2",children:[e.jsx(wa,{className:"w-4 h-4"}),e.jsx("span",{children:"Metadata Filters"})]}),e.jsx(I,{variant:"ghost",size:"sm",onClick:()=>L("metadata"),children:h.metadata?e.jsx(um,{className:"w-4 h-4"}):e.jsx(tc,{className:"w-4 h-4"})})]}),h.metadata&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"department",children:"Department"}),e.jsx(ge,{id:"department",placeholder:"Department name...",value:i.department||"",onChange:z=>{J("department",z.target.value),G("department",z.target.value)}}),m.department&&m.department.length>0&&e.jsx("div",{className:"mt-1 space-y-1",children:m.department.slice(0,5).map((z,U)=>e.jsx("div",{className:"text-xs text-gray-600 cursor-pointer hover:bg-gray-100 p-1 rounded",onClick:()=>J("department",z),children:z},U))})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"project",children:"Project"}),e.jsx(ge,{id:"project",placeholder:"Project name...",value:i.project||"",onChange:z=>{J("project",z.target.value),G("project",z.target.value)}}),m.project&&m.project.length>0&&e.jsx("div",{className:"mt-1 space-y-1",children:m.project.slice(0,5).map((z,U)=>e.jsx("div",{className:"text-xs text-gray-600 cursor-pointer hover:bg-gray-100 p-1 rounded",onClick:()=>J("project",z),children:z},U))})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"location",children:"Location"}),e.jsx(ge,{id:"location",placeholder:"Location name...",value:i.location||"",onChange:z=>{J("location",z.target.value),G("location",z.target.value)}}),m.location&&m.location.length>0&&e.jsx("div",{className:"mt-1 space-y-1",children:m.location.slice(0,5).map((z,U)=>e.jsx("div",{className:"text-xs text-gray-600 cursor-pointer hover:bg-gray-100 p-1 rounded",onClick:()=>J("location",z),children:z},U))})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium",children:"Sort Options"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"sortBy",children:"Sort By"}),e.jsxs(rt,{value:i.sortBy||"date",onValueChange:z=>J("sortBy",z),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"date",children:"Date"}),e.jsx(W,{value:"reference",children:"Reference"}),e.jsx(W,{value:"amount",children:"Amount"}),e.jsx(W,{value:"status",children:"Status"}),e.jsx(W,{value:"created",children:"Created Date"})]})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"sortOrder",children:"Sort Order"}),e.jsxs(rt,{value:i.sortOrder||"desc",onValueChange:z=>J("sortOrder",z),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"asc",children:"Ascending"}),e.jsx(W,{value:"desc",children:"Descending"})]})]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(I,{onClick:F,disabled:g,className:"flex-1",children:g?e.jsxs(e.Fragment,{children:[e.jsx(On,{className:"w-4 h-4 mr-2 animate-spin"}),"Searching..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Rn,{className:"w-4 h-4 mr-2"}),"Search"]})}),e.jsxs(I,{variant:"outline",onClick:M,children:[e.jsx(ma,{className:"w-4 h-4 mr-2"}),"Clear"]}),e.jsx(ts,{open:l,onOpenChange:c,children:e.jsx(ki,{asChild:!0,children:e.jsxs(I,{variant:"outline",children:[e.jsx(Od,{className:"w-4 h-4 mr-2"}),"Save Search"]})})}),e.jsx(I,{variant:"outline",onClick:r,children:"Close"})]})]})]}),j.length>0&&e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center space-x-2",children:[e.jsx(rY,{className:"w-5 h-5"}),e.jsx("span",{children:"Saved Searches"})]}),e.jsx(Vt,{children:"Load previously saved search queries"})]}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-2",children:j.map(z=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h4",{className:"font-medium",children:z.name}),z.isPublic&&e.jsxs(Oe,{variant:"secondary",className:"text-xs",children:[e.jsx(ir,{className:"w-3 h-3 mr-1"}),"Public"]})]}),z.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:z.description}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Created by ",z.createdBy.name,"  ",new Date(z.createdAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>T(z),children:[e.jsx(Rn,{className:"w-4 h-4 mr-1"}),"Load"]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>V(z.id),children:e.jsx(hn,{className:"w-4 h-4"})})]})]},z.id))})})]}),e.jsx(ts,{open:l,onOpenChange:c,children:e.jsxs(ss,{children:[e.jsxs(as,{children:[e.jsx(is,{children:"Save Search"}),e.jsx(Ks,{children:"Save your current search filters for future use"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"searchName",children:"Search Name"}),e.jsx(ge,{id:"searchName",placeholder:"Enter a name for this search...",value:d.name,onChange:z=>u(U=>({...U,name:z.target.value}))})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"searchDescription",children:"Description (Optional)"}),e.jsx(Xs,{id:"searchDescription",placeholder:"Describe this search...",value:d.description,onChange:z=>u(U=>({...U,description:z.target.value})),rows:3})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ka,{id:"isPublic",checked:d.isPublic,onCheckedChange:z=>u(U=>({...U,isPublic:!!z}))}),e.jsx(B,{htmlFor:"isPublic",children:"Make this search public"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(I,{variant:"outline",onClick:()=>c(!1),children:"Cancel"}),e.jsx(I,{onClick:A,disabled:_.isPending,children:_.isPending?e.jsxs(e.Fragment,{children:[e.jsx(On,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Od,{className:"w-4 h-4 mr-2"}),"Save Search"]})})]})]})]})})]})}function x7e({companyId:s}){const{toast:t}=za(),r=hi(),[n,a]=x.useState({enabled:!1,smtpHost:"smtp.gmail.com",smtpPort:587,smtpSecure:!1,smtpUser:"",smtpFrom:"",approvalRequests:!0,approvalResponses:!0,statusChanges:!0,entryCreated:!1,testEmail:""}),[i,o]=x.useState(!1),[l,c]=x.useState(null),{data:d,isLoading:u}=ys({queryKey:["email-notification-settings",s],queryFn:async()=>({enabled:!1,smtpHost:"smtp.gmail.com",smtpPort:587,smtpSecure:!1,smtpUser:"",smtpFrom:"",approvalRequests:!0,approvalResponses:!0,statusChanges:!0,entryCreated:!1})}),h=Rs({mutationFn:async v=>(await new Promise(y=>setTimeout(y,1e3)),v),onSuccess:()=>{t({title:"Success",description:"Email notification settings saved successfully"}),r.invalidateQueries({queryKey:["email-notification-settings"]})},onError:v=>{t({title:"Error",description:(v==null?void 0:v.message)||"Failed to save settings",variant:"destructive"})}}),f=Rs({mutationFn:async v=>{if(await new Promise(y=>setTimeout(y,2e3)),v.includes("@"))return{success:!0,message:"Test email sent successfully"};throw new Error("Invalid email address")},onSuccess:v=>{c(v),t({title:"Success",description:"Test email sent successfully"})},onError:v=>{c({success:!1,message:(v==null?void 0:v.message)||"Failed to send test email"}),t({title:"Error",description:(v==null?void 0:v.message)||"Failed to send test email",variant:"destructive"})}}),m=()=>{h.mutate(n)},p=()=>{if(!n.testEmail){t({title:"Error",description:"Please enter an email address to test",variant:"destructive"});return}o(!0),c(null),f.mutate(n.testEmail)},g=(v,y)=>{a(j=>({...j,[v]:y}))};return u?e.jsx("div",{className:"text-center py-8",children:"Loading settings..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(ne,{children:e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center space-x-2",children:[e.jsx(Dd,{className:"w-5 h-5"}),e.jsx("span",{children:"Email Notification Settings"})]}),e.jsx(Vt,{children:"Configure email notifications for journal entry activities"})]})}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center space-x-2",children:[e.jsx(en,{className:"w-5 h-5"}),e.jsx("span",{children:"SMTP Configuration"})]}),e.jsx(Vt,{children:"Configure your email server settings"})]}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ro,{id:"enabled",checked:n.enabled,onCheckedChange:v=>g("enabled",v)}),e.jsx(B,{htmlFor:"enabled",children:"Enable Email Notifications"})]}),n.enabled&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"smtpHost",children:"SMTP Host"}),e.jsx(ge,{id:"smtpHost",value:n.smtpHost,onChange:v=>g("smtpHost",v.target.value),placeholder:"smtp.gmail.com"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"smtpPort",children:"SMTP Port"}),e.jsx(ge,{id:"smtpPort",type:"number",value:n.smtpPort,onChange:v=>g("smtpPort",parseInt(v.target.value)),placeholder:"587"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"smtpUser",children:"SMTP Username"}),e.jsx(ge,{id:"smtpUser",value:n.smtpUser,onChange:v=>g("smtpUser",v.target.value),placeholder:"your-email@gmail.com"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"smtpFrom",children:"From Email"}),e.jsx(ge,{id:"smtpFrom",value:n.smtpFrom,onChange:v=>g("smtpFrom",v.target.value),placeholder:"noreply@yourcompany.com"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ro,{id:"smtpSecure",checked:n.smtpSecure,onCheckedChange:v=>g("smtpSecure",v)}),e.jsx(B,{htmlFor:"smtpSecure",children:"Use SSL/TLS"})]}),e.jsxs(ua,{children:[e.jsx(Zl,{className:"w-4 h-4"}),e.jsx(ha,{children:"For Gmail, use smtp.gmail.com with port 587 and enable SSL/TLS. You may need to generate an App Password for authentication."})]})]})]})]}),n.enabled&&e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center space-x-2",children:[e.jsx(Hu,{className:"w-5 h-5"}),e.jsx("span",{children:"Notification Types"})]}),e.jsx(Vt,{children:"Choose which events should trigger email notifications"})]}),e.jsx(ie,{className:"space-y-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"approvalRequests",children:"Approval Requests"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Send emails when journal entries require approval"})]}),e.jsx(ro,{id:"approvalRequests",checked:n.approvalRequests,onCheckedChange:v=>g("approvalRequests",v)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"approvalResponses",children:"Approval Responses"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Send emails when approval requests are approved or rejected"})]}),e.jsx(ro,{id:"approvalResponses",checked:n.approvalResponses,onCheckedChange:v=>g("approvalResponses",v)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"statusChanges",children:"Status Changes"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Send emails when journal entries are posted or reversed"})]}),e.jsx(ro,{id:"statusChanges",checked:n.statusChanges,onCheckedChange:v=>g("statusChanges",v)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"entryCreated",children:"Entry Created"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Send emails when new journal entries are created"})]}),e.jsx(ro,{id:"entryCreated",checked:n.entryCreated,onCheckedChange:v=>g("entryCreated",v)})]})]})})]}),n.enabled&&e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs(Se,{className:"flex items-center space-x-2",children:[e.jsx(g6,{className:"w-5 h-5"}),e.jsx("span",{children:"Test Email Configuration"})]}),e.jsx(Vt,{children:"Send a test email to verify your configuration"})]}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(ge,{placeholder:"Enter email address to test",value:n.testEmail,onChange:v=>g("testEmail",v.target.value),className:"flex-1"}),e.jsx(I,{onClick:p,disabled:i||!n.testEmail,variant:"outline",children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 mr-2 animate-spin rounded-full border-2 border-gray-300 border-t-gray-600"}),"Testing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(g6,{className:"w-4 h-4 mr-2"}),"Send Test"]})})]}),l&&e.jsxs(ua,{className:l.success?"border-green-200 bg-green-50":"border-red-200 bg-red-50",children:[l.success?e.jsx(bs,{className:"w-4 h-4 text-green-600"}):e.jsx(nc,{className:"w-4 h-4 text-red-600"}),e.jsx(ha,{className:l.success?"text-green-800":"text-red-800",children:l.message})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(I,{onClick:m,disabled:h.isPending,className:"min-w-[120px]",children:h.isPending?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 mr-2 animate-spin rounded-full border-2 border-white border-t-transparent"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Od,{className:"w-4 h-4 mr-2"}),"Save Settings"]})})}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Notification Status"})}),e.jsx(ie,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.enabled?"ON":"OFF"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Email Notifications"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:[n.approvalRequests,n.approvalResponses,n.statusChanges,n.entryCreated].filter(Boolean).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Active Types"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:n.smtpHost?"":""}),e.jsx("div",{className:"text-sm text-gray-600",children:"SMTP Configured"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:l!=null&&l.success?"":"?"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Test Status"})]})]})})]})]})}function VE({entryId:s,entryIds:t=[],onClose:r,isOpen:n=!1}){const[a,i]=x.useState(!1),[o,l]=x.useState(!1),[c,d]=x.useState(""),[u,h]=x.useState({includeAuditTrail:!0,includeCompanyHeader:!0,format:"detailed"}),{toast:f}=za(),m=t.length>0,p=m?t:s?[s]:[],g=async()=>{if(p.length!==0){i(!0);try{if(m){const b=await de.generateBatchJournalEntryPDF(p,u);y(b,`journal-entries-${Date.now()}.pdf`),f({title:"PDF Generated",description:`Successfully generated PDF for ${p.length} journal entries`})}else{const b=await de.generateJournalEntryPDF(p[0],u);y(b,`journal-entry-${p[0]}.pdf`),f({title:"PDF Generated",description:"Successfully generated PDF for journal entry"})}}catch(b){console.error("Error generating PDF:",b),f({title:"Error",description:"Failed to generate PDF. Please try again.",variant:"destructive"})}finally{i(!1)}}},v=async()=>{if(!(p.length===0||m)){i(!0);try{const b=await de.getJournalEntryPreview(p[0],u);d(b),l(!0)}catch(b){console.error("Error generating preview:",b),f({title:"Error",description:"Failed to generate preview. Please try again.",variant:"destructive"})}finally{i(!1)}}},y=(b,w)=>{const N=window.URL.createObjectURL(b),C=document.createElement("a");C.href=N,C.download=w,document.body.appendChild(C),C.click(),document.body.removeChild(C),window.URL.revokeObjectURL(N)},j=()=>{if(c){const b=window.open("","_blank");b&&(b.document.write(c),b.document.close(),b.focus(),b.print())}};return e.jsxs(e.Fragment,{children:[e.jsx(ts,{open:n,onOpenChange:r,children:e.jsxs(ss,{className:"max-w-2xl",children:[e.jsxs(as,{children:[e.jsxs(is,{className:"flex items-center space-x-2",children:[e.jsx(Zt,{className:"w-5 h-5"}),e.jsx("span",{children:"Generate PDF"})]}),e.jsx(Ks,{children:m?`Generate PDF for ${t.length} selected journal entries`:"Generate PDF for this journal entry"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center space-x-2",children:[e.jsx(en,{className:"w-4 h-4"}),e.jsx("span",{children:"PDF Options"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"format",children:"Format"}),e.jsxs(rt,{value:u.format,onValueChange:b=>h(w=>({...w,format:b})),children:[e.jsx(nt,{children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"detailed",children:"Detailed"}),e.jsx(W,{value:"summary",children:"Summary"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ka,{id:"includeCompanyHeader",checked:u.includeCompanyHeader,onCheckedChange:b=>h(w=>({...w,includeCompanyHeader:!!b}))}),e.jsx(B,{htmlFor:"includeCompanyHeader",children:"Include Company Header"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ka,{id:"includeAuditTrail",checked:u.includeAuditTrail,onCheckedChange:b=>h(w=>({...w,includeAuditTrail:!!b}))}),e.jsx(B,{htmlFor:"includeAuditTrail",children:"Include Audit Trail"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[!m&&e.jsxs(I,{variant:"outline",onClick:v,disabled:a,className:"flex items-center space-x-2",children:[a?e.jsx(On,{className:"w-4 h-4 animate-spin"}):e.jsx(ir,{className:"w-4 h-4"}),e.jsx("span",{children:"Preview"})]}),e.jsxs(I,{onClick:g,disabled:a||p.length===0,className:"flex items-center space-x-2 flex-1",children:[a?e.jsx(On,{className:"w-4 h-4 animate-spin"}):e.jsx(An,{className:"w-4 h-4"}),e.jsx("span",{children:a?"Generating...":m?`Generate PDF (${t.length} entries)`:"Generate PDF"})]})]}),e.jsxs("div",{className:"text-sm text-muted-foreground space-y-2",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Detailed Format:"})," Includes all line details, memos, departments, projects, and locations."]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Summary Format:"})," Shows only essential information for a concise view."]})]})]})]})}),e.jsx(ts,{open:o,onOpenChange:l,children:e.jsxs(ss,{className:"max-w-6xl max-h-[90vh] overflow-hidden",children:[e.jsx(as,{children:e.jsxs(is,{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center space-x-2",children:[e.jsx(ir,{className:"w-5 h-5"}),e.jsx("span",{children:"PDF Preview"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:j,className:"flex items-center space-x-1",children:[e.jsx(Zt,{className:"w-4 h-4"}),e.jsx("span",{children:"Print"})]}),e.jsxs(I,{size:"sm",onClick:g,disabled:a,className:"flex items-center space-x-1",children:[a?e.jsx(On,{className:"w-4 h-4 animate-spin"}):e.jsx(An,{className:"w-4 h-4"}),e.jsx("span",{children:"Download PDF"})]})]})]})}),e.jsx("div",{className:"overflow-auto max-h-[70vh] border rounded-lg",children:e.jsx("iframe",{srcDoc:c,className:"w-full h-full min-h-[600px] border-0",title:"PDF Preview"})})]})})]})}function p7e({entryId:s,variant:t="icon"}){const[r,n]=x.useState(!1),{toast:a}=za(),i=async()=>{try{const l=await de.generateJournalEntryPDF(s,{includeAuditTrail:!0,includeCompanyHeader:!0,format:"detailed"});o(l,`journal-entry-${s}.pdf`),a({title:"PDF Generated",description:"Successfully generated PDF for journal entry"})}catch(l){console.error("Error generating PDF:",l),a({title:"Error",description:"Failed to generate PDF. Please try again.",variant:"destructive"})}},o=(l,c)=>{const d=window.URL.createObjectURL(l),u=document.createElement("a");u.href=d,u.download=c,document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(d)};return t==="button"?e.jsxs(e.Fragment,{children:[e.jsxs(I,{variant:"outline",size:"sm",onClick:()=>n(!0),className:"flex items-center space-x-1",children:[e.jsx(Zt,{className:"w-4 h-4"}),e.jsx("span",{children:"PDF"})]}),e.jsx(VE,{entryId:s,isOpen:r,onClose:()=>n(!1)})]}):e.jsx(e.Fragment,{children:e.jsx(I,{variant:"ghost",size:"sm",onClick:i,className:"h-8 w-8 p-0",title:"Generate PDF",children:e.jsx(Zt,{className:"w-4 h-4"})})})}function g7e({selectedEntries:s,onClearSelection:t}){const[r,n]=x.useState(!1);return za(),s.length===0?null:e.jsxs(e.Fragment,{children:[e.jsxs(I,{variant:"outline",onClick:()=>n(!0),className:"flex items-center space-x-2",children:[e.jsx(Zt,{className:"w-4 h-4"}),e.jsxs("span",{children:["Generate PDF (",s.length,")"]})]}),e.jsx(VE,{entryIds:s,isOpen:r,onClose:()=>{n(!1),t==null||t()}})]})}function v7e({companyId:s}){var Gt,qt,As,Ht,xs;const{toast:t}=za(),{isAuthenticated:r,user:n}=Ua(),a=hi(),[i,o]=x.useState(""),[l,c]=x.useState("all"),[d,u]=x.useState("all"),[h,f]=x.useState({}),[m,p]=x.useState(null),[g,v]=x.useState(!1),[y,j]=x.useState("create"),[b,w]=x.useState(null),[N,C]=x.useState(!1),[S,_]=x.useState(null),[k,F]=x.useState(!1),[A,T]=x.useState(null),[V,M]=x.useState([]),[G,L]=x.useState(1),[J,z]=x.useState(10);xe.useEffect(()=>{L(1)},[i,l,d,h]);const[U,oe]=x.useState("entries"),[Q,P]=x.useState(!1),[q,D]=x.useState(!1),[se,he]=x.useState(!1),[be,pe]=x.useState(!1),[Ae,Ee]=x.useState({reason:"",reverseDate:""}),[$e,O]=x.useState({adjustments:[],reason:""}),[te,re]=x.useState({approvers:[],comments:""}),{data:le,isLoading:Z,error:K}=ys({queryKey:["journal-entries",s,i,l,d,h,G,J],queryFn:()=>de.getJournalEntries({reference:i||void 0,status:l!=="all"?l:void 0,entryType:d!=="all"?d:void 0,dateFrom:h.from,dateTo:h.to,page:G,pageSize:J}),enabled:!!s&&r,retry:!1,staleTime:0}),{data:X,isLoading:ce}=ys({queryKey:["journal-hub-summary",s],queryFn:()=>de.getJournalSummary({companyId:s}),enabled:!!s&&r}),{data:Y,isLoading:ue}=ys({queryKey:["journal-entry-types",s],queryFn:()=>de.getJournalEntryTypes({companyId:s}),enabled:!!s&&r}),{data:ve,isLoading:Le}=ys({queryKey:["journal-pending-approvals",s],queryFn:()=>de.getPendingApprovals(),enabled:!!s&&r}),{data:Me,isLoading:tt}=ys({queryKey:["journal-metrics",s],queryFn:()=>de.getJournalMetrics({companyId:s}),enabled:!!s&&r}),{data:fe,isLoading:ct}=ys({queryKey:["journal-permissions",n==null?void 0:n.id,s],queryFn:()=>de.getJournalPermissions((n==null?void 0:n.id)||"",s),enabled:!!(n!=null&&n.id)&&!!s&&r}),dt=Rs({mutationFn:({entryId:Ct,data:ke})=>de.reverseJournalEntry(Ct,ke),onSuccess:Ct=>{var gt;a.invalidateQueries({queryKey:["journal-entries"]}),a.invalidateQueries({queryKey:["journal-hub-summary"]});const ke=((gt=Ct==null?void 0:Ct.data)==null?void 0:gt.inventoryMovementsReversed)>0?` and ${Ct.data.inventoryMovementsReversed} inventory movements reversed (${Ct.data.stockRestored} products restored)`:"";t({title:"Success",description:`Journal entry reversed successfully${ke}`}),P(!1)},onError:Ct=>{var ke,gt;t({title:"Error",description:((gt=(ke=Ct==null?void 0:Ct.response)==null?void 0:ke.data)==null?void 0:gt.error)||"Failed to reverse entry",variant:"destructive"})}}),pt=Rs({mutationFn:({entryId:Ct,data:ke})=>de.adjustJournalEntry(Ct,ke),onSuccess:()=>{a.invalidateQueries({queryKey:["journal-entries"]}),a.invalidateQueries({queryKey:["journal-hub-summary"]}),t({title:"Success",description:"Adjustment entry created successfully"}),D(!1)},onError:Ct=>{var ke,gt;t({title:"Error",description:((gt=(ke=Ct==null?void 0:Ct.response)==null?void 0:ke.data)==null?void 0:gt.error)||"Failed to create adjustment",variant:"destructive"})}}),qe=Rs({mutationFn:({entryId:Ct,data:ke})=>de.requestJournalApproval(Ct,ke),onSuccess:()=>{a.invalidateQueries({queryKey:["journal-entries"]}),a.invalidateQueries({queryKey:["journal-pending-approvals"]}),t({title:"Success",description:"Approval request sent successfully"}),he(!1)},onError:Ct=>{var ke,gt;t({title:"Error",description:((gt=(ke=Ct==null?void 0:Ct.response)==null?void 0:ke.data)==null?void 0:gt.error)||"Failed to request approval",variant:"destructive"})}}),mt=Ct=>{v(!1),w(null),a.invalidateQueries({queryKey:["journal-entries"]}),a.invalidateQueries({queryKey:["journal-hub-summary"]}),t({title:"Success",description:"Journal entry created successfully"})},Rt=()=>{v(!1),w(null)},_e=Ct=>{j("edit"),w(Ct),v(!0)},Xe=Ct=>{j("duplicate"),w(Ct),v(!0)},At=Ct=>{p(Ct),Ee({reason:"",reverseDate:""}),P(!0)},st=Ct=>{p(Ct),re({approvers:[],comments:""}),he(!0)},$t=()=>{!m||!Ae.reason||dt.mutate({entryId:m.id,data:Ae})},fs=()=>{!m||!$e.reason||$e.adjustments.length===0||pt.mutate({entryId:m.id,data:$e})},zt=()=>{!m||te.approvers.length===0||qe.mutate({entryId:m.id,data:te})},St=Ct=>{const ke={DRAFT:{color:"bg-gray-100 text-gray-800",icon:Zt},POSTED:{color:"bg-green-100 text-green-800",icon:bs},REVERSED:{color:"bg-red-100 text-red-800",icon:gC},PENDING_APPROVAL:{color:"bg-yellow-100 text-yellow-800",icon:Cr}},gt=ke[Ct]||ke.DRAFT,us=gt.icon;return e.jsxs(Oe,{className:gt.color,children:[e.jsx(us,{className:"w-3 h-3 mr-1"}),Ct.replace("_"," ")]})},js=Ct=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Ct),et=(le==null?void 0:le.entries)||[],lt=(le==null?void 0:le.pagination)||{total:0,page:1,pageSize:10,totalPages:0},Fe=(X==null?void 0:X.summary)||{},ft=(Y==null?void 0:Y.entryTypes)||[],He=(ve==null?void 0:ve.pendingApprovals)||[],Je=(Me==null?void 0:Me.metrics)||{},It=(fe==null?void 0:fe.permissions)||{};return e.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-6 max-w-[1600px]",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Journal Entry Hub"}),e.jsx("p",{className:"text-gray-600",children:"Complete journal entry lifecycle management"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(I,{onClick:()=>pe(!0),variant:"outline",className:"flex items-center space-x-2",children:[e.jsx(lr,{className:"w-4 h-4"}),e.jsx("span",{children:"Metrics"})]}),e.jsxs(I,{onClick:()=>{oe("entries"),j("create"),w(null),v(!0)},className:"flex items-center space-x-2",children:[e.jsx(Ss,{className:"w-4 h-4"}),e.jsx("span",{children:"New Entry"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Entries"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Fe.totalEntries||0})]}),e.jsx(ml,{className:"w-8 h-8 text-blue-600"})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Posted Today"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:Fe.postedToday||0})]}),e.jsx(bs,{className:"w-8 h-8 text-green-600"})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending Approval"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:He.length})]}),e.jsx(Cr,{className:"w-8 h-8 text-yellow-600"})]})})}),e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Success Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[((Gt=Je.successRate)==null?void 0:Gt.toFixed(1))||0,"%"]})]}),e.jsx($s,{className:"w-8 h-8 text-blue-600"})]})})})]}),e.jsxs(an,{value:U,onValueChange:oe,className:"space-y-4",children:[e.jsxs(on,{className:"grid w-full grid-cols-5",children:[e.jsx(vt,{value:"entries",children:"Entries"}),e.jsx(vt,{value:"approvals",children:"Approvals"}),e.jsx(vt,{value:"templates",children:"Templates"}),e.jsx(vt,{value:"metrics",children:"Analytics"}),e.jsx(vt,{value:"settings",children:"Settings"})]}),e.jsxs(yt,{value:"entries",className:"space-y-4",children:[e.jsx(ne,{children:e.jsx(ie,{className:"p-4",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsx("div",{className:"flex-1 min-w-[200px]",children:e.jsx(ge,{placeholder:"Search entries...",value:i,onChange:Ct=>o(Ct.target.value),className:"w-full"})}),e.jsxs(rt,{value:l,onValueChange:c,children:[e.jsx(nt,{className:"w-[150px]",children:e.jsx(it,{placeholder:"Status"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Status"}),e.jsx(W,{value:"DRAFT",children:"Draft"}),e.jsx(W,{value:"POSTED",children:"Posted"}),e.jsx(W,{value:"REVERSED",children:"Reversed"}),e.jsx(W,{value:"PENDING_APPROVAL",children:"Pending Approval"})]})]}),e.jsxs(rt,{value:d,onValueChange:u,children:[e.jsx(nt,{className:"w-[150px]",children:e.jsx(it,{placeholder:"Entry Type"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All Types"}),ft.map(Ct=>e.jsx(W,{value:Ct.id,children:Ct.name},Ct.id))]})]}),e.jsxs(I,{onClick:()=>{j("create"),w(null),v(!0)},className:"flex items-center space-x-2",children:[e.jsx(Ss,{className:"w-4 h-4"}),e.jsx("span",{children:"New Entry"})]}),e.jsxs(I,{variant:"outline",onClick:()=>C(!0),className:"flex items-center space-x-2",children:[e.jsx(Rn,{className:"w-4 h-4"}),e.jsx("span",{children:"Advanced Search"})]})]})})}),e.jsx(m7e,{companyId:s,entries:et,currentFilters:{dateFrom:h.from,dateTo:h.to,status:l!=="all"?l:void 0,entryType:d!=="all"?d:void 0},onRefresh:()=>{a.invalidateQueries({queryKey:["journal-entries"]}),a.invalidateQueries({queryKey:["journal-hub-summary"]})},permissions:It}),e.jsx(g7e,{selectedEntries:V,onClearSelection:()=>M([])}),e.jsx("div",{className:"space-y-4",children:Z?e.jsx("div",{className:"text-center py-8",children:"Loading entries..."}):et.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No journal entries found"}):et.map(Ct=>{var ke,gt,us;return e.jsx(ne,{className:"hover:shadow-md transition-shadow",children:e.jsxs(ie,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[St(Ct.status),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:Ct.reference}),(((ke=Ct.reference)==null?void 0:ke.startsWith("INV-"))||((gt=Ct.reference)==null?void 0:gt.startsWith("POS-")))&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:" Inventory"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:Ct.memo})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-medium text-gray-900",children:js(Ct.totalAmount||0)}),e.jsx("div",{className:"text-xs text-slate-500",children:Ct.isBalanced?"Balanced":"Unbalanced"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[It.canEdit&&Ct.status==="DRAFT"&&e.jsx(I,{size:"sm",variant:"outline",onClick:()=>_e(Ct),children:e.jsx(ln,{className:"w-4 h-4"})}),It.canReverse&&Ct.status==="POSTED"&&e.jsx(I,{size:"sm",variant:"outline",onClick:()=>At(Ct),children:e.jsx(gC,{className:"w-4 h-4"})}),It.canApprove&&Ct.status==="DRAFT"&&e.jsx(I,{size:"sm",variant:"outline",onClick:()=>st(Ct),children:e.jsx(kn,{className:"w-4 h-4"})}),e.jsx(I,{size:"sm",variant:"outline",onClick:()=>Xe(Ct),children:e.jsx(ac,{className:"w-4 h-4"})}),e.jsx(p7e,{entryId:Ct.id,variant:"icon"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Date:"}),e.jsx("div",{className:"font-medium",children:new Date(Ct.date).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Type:"}),e.jsx("div",{className:"font-medium",children:((us=Ct.entryType)==null?void 0:us.name)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Debit:"}),e.jsx("div",{className:"font-medium",children:js(Ct.totalDebit||0)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Credit:"}),e.jsx("div",{className:"font-medium",children:js(Ct.totalCredit||0)})]})]})]})},Ct.id)})}),et.length>0&&lt.totalPages>1&&e.jsxs("div",{className:"flex items-center justify-between mt-6 px-4 py-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-gray-700",children:["Showing ",(lt.page-1)*lt.pageSize+1," to ",Math.min(lt.page*lt.pageSize,lt.total)," of ",lt.total," entries"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{htmlFor:"pageSize",className:"text-sm",children:"Show:"}),e.jsxs(rt,{value:J.toString(),onValueChange:Ct=>{z(Number(Ct)),L(1)},children:[e.jsx(nt,{className:"w-20",children:e.jsx(it,{})}),e.jsxs(at,{children:[e.jsx(W,{value:"5",children:"5"}),e.jsx(W,{value:"10",children:"10"}),e.jsx(W,{value:"25",children:"25"}),e.jsx(W,{value:"50",children:"50"}),e.jsx(W,{value:"100",children:"100"})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{variant:"outline",size:"sm",onClick:()=>L(1),disabled:G===1,children:"First"}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>L(G-1),disabled:G===1,children:"Previous"}),e.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,lt.totalPages)},(Ct,ke)=>{const us=Math.max(1,G-2)+ke;return us>lt.totalPages?null:e.jsx(I,{variant:us===G?"default":"outline",size:"sm",onClick:()=>L(us),className:"w-8 h-8 p-0",children:us},us)})}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>L(G+1),disabled:G===lt.totalPages,children:"Next"}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>L(lt.totalPages),disabled:G===lt.totalPages,children:"Last"})]})]})]}),e.jsx(yt,{value:"approvals",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center space-x-2",children:[e.jsx(kn,{className:"w-5 h-5"}),e.jsx("span",{children:"Pending Approvals"})]})}),e.jsx(ie,{children:Le?e.jsx("div",{className:"text-center py-8",children:"Loading approvals..."}):He.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No pending approvals"}):e.jsx("div",{className:"space-y-4",children:He.map(Ct=>{var ke,gt,us;return e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:(ke=Ct.entry)==null?void 0:ke.reference}),e.jsx("p",{className:"text-sm text-gray-600",children:(gt=Ct.entry)==null?void 0:gt.memo}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Requested by ",(us=Ct.requestedBy)==null?void 0:us.name,"  ",new Date(Ct.requestedAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(I,{size:"sm",className:"bg-green-600 hover:bg-green-700",children:[e.jsx(bs,{className:"w-4 h-4 mr-1"}),"Approve"]}),e.jsxs(I,{size:"sm",variant:"outline",children:[e.jsx(nc,{className:"w-4 h-4 mr-1"}),"Reject"]})]})]},Ct.id)})})})]})}),e.jsx(yt,{value:"templates",className:"space-y-4",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center space-x-2",children:[e.jsx(Zt,{className:"w-5 h-5"}),e.jsx("span",{children:"Journal Templates"})]})}),e.jsx(ie,{children:e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Template management coming soon..."})})]})}),e.jsx(yt,{value:"metrics",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Performance Metrics"})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Success Rate:"}),e.jsxs("span",{className:"font-medium",children:[((qt=Je.successRate)==null?void 0:qt.toFixed(1))||0,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Avg Processing Time:"}),e.jsxs("span",{className:"font-medium",children:[Je.avgProcessingTime||0,"s"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Error Rate:"}),e.jsxs("span",{className:"font-medium text-red-600",children:[((As=Je.errorRate)==null?void 0:As.toFixed(1))||0,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Unbalanced Entries:"}),e.jsx("span",{className:"font-medium text-orange-600",children:Je.unbalancedCount||0})]})]})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Entry Statistics"})}),e.jsx(ie,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Entries:"}),e.jsx("span",{className:"font-medium",children:Je.totalEntries||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Posted Entries:"}),e.jsx("span",{className:"font-medium text-green-600",children:Je.postedEntries||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Draft Entries:"}),e.jsx("span",{className:"font-medium text-gray-600",children:Je.draftEntries||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Pending Approvals:"}),e.jsx("span",{className:"font-medium text-yellow-600",children:Je.pendingApprovals||0})]})]})})]})]})}),e.jsxs(yt,{value:"settings",className:"space-y-4",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs(Se,{className:"flex items-center space-x-2",children:[e.jsx(SY,{className:"w-5 h-5"}),e.jsx("span",{children:"User Permissions"})]})}),e.jsx(ie,{children:ct?e.jsx("div",{className:"text-center py-8",children:"Loading permissions..."}):e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:It.canCreate,disabled:!0}),e.jsx("span",{children:"Create"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:It.canEdit,disabled:!0}),e.jsx("span",{children:"Edit"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:It.canDelete,disabled:!0}),e.jsx("span",{children:"Delete"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:It.canPost,disabled:!0}),e.jsx("span",{children:"Post"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:It.canReverse,disabled:!0}),e.jsx("span",{children:"Reverse"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:It.canApprove,disabled:!0}),e.jsx("span",{children:"Approve"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:It.canViewAll,disabled:!0}),e.jsx("span",{children:"View All"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"Max Approval Amount:"}),e.jsx("span",{className:"font-medium",children:js(It.maxApprovalAmount||0)})]})]})})]}),e.jsx(x7e,{companyId:s})]})]}),g&&e.jsx(ts,{open:g,onOpenChange:v,children:e.jsxs(ss,{className:"!max-w-7xl max-h-[95vh] overflow-y-auto w-[95vw] md:max-h-[90vh] md:w-[90vw]",children:[e.jsx(as,{children:e.jsx(is,{children:y==="create"?"Create New Journal Entry":y==="edit"?"Edit Journal Entry":"Duplicate Journal Entry"})}),e.jsx(h7e,{companyId:s,onSuccess:mt,onCancel:Rt,initialData:b,mode:y})]})}),e.jsx(ts,{open:Q,onOpenChange:P,children:e.jsxs(ss,{children:[e.jsx(as,{children:e.jsx(is,{children:"Reverse Journal Entry"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"reason",children:"Reason for Reversal *"}),e.jsx(Xs,{id:"reason",value:Ae.reason,onChange:Ct=>Ee({...Ae,reason:Ct.target.value}),placeholder:"Enter reason for reversing this entry...",rows:3})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"reverseDate",children:"Reverse Date"}),e.jsx(ge,{id:"reverseDate",type:"date",value:Ae.reverseDate,onChange:Ct=>Ee({...Ae,reverseDate:Ct.target.value})})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(I,{variant:"outline",onClick:()=>P(!1),children:"Cancel"}),e.jsx(I,{onClick:$t,disabled:!Ae.reason||dt.isPending,children:dt.isPending?"Reversing...":"Reverse Entry"})]})]})]})}),e.jsx(ts,{open:q,onOpenChange:D,children:e.jsxs(ss,{children:[e.jsx(as,{children:e.jsx(is,{children:"Create Adjustment Entry"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"adjustmentReason",children:"Reason for Adjustment *"}),e.jsx(Xs,{id:"adjustmentReason",value:$e.reason,onChange:Ct=>O({...$e,reason:Ct.target.value}),placeholder:"Enter reason for adjustment...",rows:3})]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Adjustment entries will be created to correct the original entry."}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(I,{variant:"outline",onClick:()=>D(!1),children:"Cancel"}),e.jsx(I,{onClick:fs,disabled:!$e.reason||pt.isPending,children:pt.isPending?"Creating...":"Create Adjustment"})]})]})]})}),e.jsx(ts,{open:se,onOpenChange:he,children:e.jsxs(ss,{children:[e.jsx(as,{children:e.jsx(is,{children:"Request Approval"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"approvers",children:"Approvers *"}),e.jsx(ge,{id:"approvers",value:te.approvers.join(", "),onChange:Ct=>re({...te,approvers:Ct.target.value.split(",").map(ke=>ke.trim()).filter(Boolean)}),placeholder:"Enter approver IDs separated by commas..."})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"approvalComments",children:"Comments"}),e.jsx(Xs,{id:"approvalComments",value:te.comments,onChange:Ct=>re({...te,comments:Ct.target.value}),placeholder:"Optional comments for approvers...",rows:3})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(I,{variant:"outline",onClick:()=>he(!1),children:"Cancel"}),e.jsx(I,{onClick:zt,disabled:te.approvers.length===0||qe.isPending,children:qe.isPending?"Sending...":"Request Approval"})]})]})]})}),e.jsx(ts,{open:be,onOpenChange:pe,children:e.jsxs(ss,{className:"max-w-2xl",children:[e.jsx(as,{children:e.jsx(is,{children:"Performance Metrics"})}),e.jsx("div",{className:"space-y-4",children:tt?e.jsx("div",{className:"text-center py-8",children:"Loading metrics..."}):e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Processing Metrics"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Success Rate:"}),e.jsxs("span",{className:"font-medium",children:[((Ht=Je.successRate)==null?void 0:Ht.toFixed(1))||0,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Avg Processing Time:"}),e.jsxs("span",{className:"font-medium",children:[Je.avgProcessingTime||0,"s"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Error Rate:"}),e.jsxs("span",{className:"font-medium text-red-600",children:[((xs=Je.errorRate)==null?void 0:xs.toFixed(1))||0,"%"]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Entry Statistics"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Entries:"}),e.jsx("span",{className:"font-medium",children:Je.totalEntries||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Posted:"}),e.jsx("span",{className:"font-medium text-green-600",children:Je.postedEntries||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Drafts:"}),e.jsx("span",{className:"font-medium text-gray-600",children:Je.draftEntries||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Unbalanced:"}),e.jsx("span",{className:"font-medium text-orange-600",children:Je.unbalancedCount||0})]})]})]})]})})]})}),e.jsx(ts,{open:N,onOpenChange:C,children:e.jsxs(ss,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Advanced Search"}),e.jsx(Ks,{children:"Use multiple filters to find specific journal entries"})]}),e.jsx(f7e,{companyId:s,onSearchResults:Ct=>{_(Ct),C(!1),t({title:"Search Complete",description:`Found ${Ct.entries.length} entries matching your criteria`})},onClose:()=>C(!1)})]})}),e.jsx(VE,{entryId:A||void 0,entryIds:V.length>0?V:void 0,isOpen:k,onClose:()=>{F(!1),T(null),M([])}})]})})}function y7e(){const{isAuthenticated:s}=Ua(),[t,r]=x.useState(zs());return x.useEffect(()=>{const n=()=>{const i=zs();i&&i!==t&&(console.log(" Journal Hub page - Company changed from",t,"to",i),r(i))};window.addEventListener("storage",n);const a=i=>{const o=i.detail.companyId;o&&o!==t&&(console.log(" Journal Hub page - Company changed via custom event from",t,"to",o),r(o))};return window.addEventListener("companyChanged",a),()=>{window.removeEventListener("storage",n),window.removeEventListener("companyChanged",a)}},[t]),s?e.jsx(v7e,{companyId:t}):e.jsx("div",{children:"Please log in to access the Journal Hub."})}const $x={getWorkflows:async(s,t)=>{const r=new URLSearchParams({companyId:s,...t}),n=await de.get(`/unified-approvals/approval-workflows?${r}`);return n.data||n||[]},getWorkflow:async s=>{const t=await de.get(`/unified-approvals/approval-workflows/${s}`);return t.data||t},createWorkflow:async s=>{console.log(" API - Creating workflow with data:",s),console.log(" API - Workflow companyId:",s.companyId),console.log(" API - Workflow companyId type:",typeof s.companyId);const t=await de.post("/unified-approvals/approval-workflows",s);return t.data||t},updateWorkflow:async(s,t)=>{const r=await de.put(`/unified-approvals/approval-workflows/${s}`,t);return r.data||r},deleteWorkflow:async s=>{const t=await de.delete(`/unified-approvals/approval-workflows/${s}`);return t.data||t},getApprovalRequests:async(s,t)=>{const r=new URLSearchParams({companyId:s,...t}),n=await de.get(`/unified-approvals/approval-requests?${r}`);return n.data||n||[]},getApprovalRequest:async s=>{const t=await de.get(`/unified-approvals/approval-requests/${s}`);return t.data||t},createApprovalRequest:async s=>{const t=await de.post("/unified-approvals/approval-requests",s);return t.data||t},processApprovalAction:async(s,t,r,n)=>{const a=await de.post(`/unified-approvals/approval-requests/${s}/actions/${t}`,{action:r,...n});return a.data||a},getDashboard:async(s,t)=>{const r=new URLSearchParams({companyId:s,...t}),n=await de.get(`/unified-approvals/approval-dashboard?${r}`);return n?n.data||n:{summary:{totalRequests:0,pendingRequests:0,approvedRequests:0,rejectedRequests:0,escalatedRequests:0,approvalRate:0,avgProcessingTime:0},byEntityType:[],byStatus:[],recentRequests:[]}},getTemplates:async(s,t)=>{const r=new URLSearchParams({companyId:s,...t}),n=await de.get(`/unified-approvals/approval-templates?${r}`);return n.data||n||[]},createTemplate:async s=>{const t=await de.post("/unified-approvals/approval-templates",s);return t.data||t}};function j7e(){const{isAuthenticated:s,isLoading:t,user:r}=Ua(),[n,a]=x.useState(()=>{const Q=zs();return console.log(" Initial state - getCompanyId() returned:",Q),console.log(" Initial state - getCompanyId() type:",typeof Q),Q});x.useEffect(()=>{console.log(" useEffect - Getting company ID...");const Q=zs();console.log(" useEffect - getCompanyId() returned:",Q),console.log(" useEffect - getCompanyId() type:",typeof Q),a(Q)},[r]);const[i,o]=x.useState("dashboard"),[l,c]=x.useState({entityType:"",status:"",requestedBy:""}),[d,u]=x.useState(null),[h,f]=x.useState(!1),[m,p]=x.useState(!1),[g,v]=x.useState({name:"",description:"",entityType:"journal_entry",entitySubType:"",isActive:!0,steps:[],conditions:[],autoApproval:!1,escalationRules:[],priority:"medium"}),y=hi(),{data:j,isLoading:b,error:w}=ys({queryKey:["approval-workflows",n],queryFn:()=>(console.log(" Fetching workflows - Auth state:",{isAuthenticated:s,isLoading:t,companyId:n}),$x.getWorkflows(n)),enabled:!!n&&s&&!t,retry:!1,staleTime:5*60*1e3,cacheTime:10*60*1e3}),{data:N,isLoading:C,error:S}=ys({queryKey:["approval-requests",n,l],queryFn:()=>$x.getApprovalRequests(n,l),enabled:!!n&&s&&!t}),{data:_,isLoading:k,error:F}=ys({queryKey:["approval-dashboard",n],queryFn:()=>$x.getDashboard(n),enabled:!!n&&s&&!t});Rs({mutationFn:$x.createApprovalRequest,onSuccess:()=>{y.invalidateQueries({queryKey:["approval-requests"]}),y.invalidateQueries({queryKey:["approval-dashboard"]}),p(!1)}}),Rs({mutationFn:({requestId:Q,assigneeId:P,action:q,data:D})=>$x.processApprovalAction(Q,P,q,D),onSuccess:()=>{y.invalidateQueries({queryKey:["approval-requests"]}),y.invalidateQueries({queryKey:["approval-dashboard"]}),u(null)}});const A=Rs({mutationFn:Q=>$x.createWorkflow(Q),onSuccess:()=>{y.invalidateQueries({queryKey:["approval-workflows"]}),f(!1),v({name:"",description:"",entityType:"journal_entry",entitySubType:"",isActive:!0,steps:[],conditions:[],autoApproval:!1,escalationRules:[],priority:"medium"})},onError:Q=>{var q,D;console.error(" Create workflow error:",Q);const P=((D=(q=Q==null?void 0:Q.response)==null?void 0:q.data)==null?void 0:D.message)||(Q==null?void 0:Q.message)||"Failed to create workflow";alert(`Error creating workflow: ${P}`)}}),T=Q=>{switch(Q){case"approved":return e.jsx(bs,{className:"h-4 w-4 text-green-500"});case"rejected":return e.jsx(nc,{className:"h-4 w-4 text-red-500"});case"escalated":return e.jsx(Is,{className:"h-4 w-4 text-orange-500"});case"cancelled":return e.jsx(nc,{className:"h-4 w-4 text-gray-500"});default:return e.jsx(Cr,{className:"h-4 w-4 text-yellow-500"})}},V=Q=>{switch(Q){case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";case"escalated":return"bg-orange-100 text-orange-800";case"cancelled":return"bg-gray-100 text-gray-800";default:return"bg-yellow-100 text-yellow-800"}},M=Q=>{switch(Q){case"journal_entry":return e.jsx(Zt,{className:"h-4 w-4"});case"invoice":return e.jsx(lh,{className:"h-4 w-4"});case"purchase_order":return e.jsx(Gu,{className:"h-4 w-4"});case"expense":return e.jsx(Mr,{className:"h-4 w-4"});case"bill":return e.jsx($a,{className:"h-4 w-4"});case"document":return e.jsx(Zt,{className:"h-4 w-4"});case"recurring_invoice":return e.jsx(Xn,{className:"h-4 w-4"});default:return e.jsx(vn,{className:"h-4 w-4"})}},G=Q=>{switch(Q){case"critical":return"bg-red-100 text-red-800";case"high":return"bg-orange-100 text-orange-800";case"medium":return"bg-blue-100 text-blue-800";case"low":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};if(t)return e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("div",{className:"ml-3 text-sm text-gray-600",children:"Loading authentication..."})]});if(!n||n.trim()==="")return e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("div",{className:"ml-3 text-sm text-gray-600",children:"Loading company information..."})]});if(!s)return e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Authentication Required"}),e.jsxs("div",{className:"mt-2 text-sm text-yellow-700",children:[e.jsx("p",{children:"Please log in to access the approval hub."}),e.jsxs("p",{className:"mt-1",children:["Debug: isAuthenticated=",s.toString(),", isLoading=",t.toString()]})]})]})]})})});const L=()=>{if(k)return e.jsx("div",{className:"flex items-center justify-center h-64",children:"Loading dashboard..."});if(F)return e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error loading approval dashboard"}),e.jsxs("div",{className:"mt-2 text-sm text-red-700",children:[e.jsx("p",{children:"Failed to load approval data. Please check your authentication and try again."}),e.jsxs("p",{className:"mt-1",children:["Error: ",(F==null?void 0:F.message)||"Unknown error"]})]})]})]})});const Q=(_==null?void 0:_.summary)||{totalRequests:0,pendingRequests:0,approvedRequests:0,approvalRate:0},P=(_==null?void 0:_.byEntityType)||[],q=(_==null?void 0:_.byStatus)||[],D=(_==null?void 0:_.recentRequests)||[];return _?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Total Requests"}),e.jsx(lr,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(Q==null?void 0:Q.totalRequests)??0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"All time requests"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Pending"}),e.jsx(Cr,{className:"h-4 w-4 text-yellow-500"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:(Q==null?void 0:Q.pendingRequests)??0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Awaiting approval"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Approved"}),e.jsx(bs,{className:"h-4 w-4 text-green-500"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:(Q==null?void 0:Q.approvedRequests)??0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Successfully approved"})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Approval Rate"}),e.jsx($s,{className:"h-4 w-4 text-blue-500"})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[((Q==null?void 0:Q.approvalRate)??0).toFixed(1),"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Success rate"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Requests by Entity Type"})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-2",children:(P??[]).map(se=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[M(se.entityType),e.jsx("span",{className:"text-sm font-medium capitalize",children:se.entityType.replace("_"," ")})]}),e.jsx(Oe,{variant:"secondary",children:se.count})]},se.entityType))})})]}),e.jsxs(ne,{children:[e.jsx(we,{children:e.jsx(Se,{children:"Requests by Status"})}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-2",children:(q??[]).map(se=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[T(se.status),e.jsx("span",{className:"text-sm font-medium capitalize",children:se.status})]}),e.jsx(Oe,{variant:"secondary",children:se.count})]},se.status))})})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Recent Requests"}),e.jsx(Vt,{children:"Latest approval requests across all entities"})]}),e.jsx(ie,{children:e.jsx("div",{className:"space-y-4",children:(D??[]).map(se=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[M(se.entityType),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[se.entityType.replace("_"," ").toUpperCase()," #",se.entityId.slice(-8)]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Requested by ",se.requestedBy,"  ",new Date(se.requestedAt).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Oe,{className:V(se.status),children:se.status}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Step ",se.currentStep," of ",se.totalSteps]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>u(se),children:e.jsx(ir,{className:"h-4 w-4"})})]})]},se.id))})})]})]}):e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"No Dashboard Data"}),e.jsx("div",{className:"mt-2 text-sm text-red-700",children:e.jsx("p",{children:"Dashboard data is completely missing."})})]})]})})})},J=()=>{var Q;return b?e.jsx("div",{className:"flex items-center justify-center h-64",children:"Loading workflows..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Approval Workflows"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage approval workflows for different entity types"})]}),e.jsxs(I,{onClick:()=>f(!0),children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Create Workflow"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:(Q=j==null?void 0:j.workflows)==null?void 0:Q.map(P=>e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Se,{className:"text-lg",children:P.name}),e.jsx(Oe,{className:G(P.priority),children:P.priority})]}),e.jsx(Vt,{children:P.description})]}),e.jsxs(ie,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[M(P.entityType),e.jsx("span",{className:"text-sm font-medium",children:P.entityType.replace("_"," ").toUpperCase()}),P.entitySubType&&e.jsx(Oe,{variant:"outline",children:P.entitySubType})]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[P.steps.length," approval step",P.steps.length!==1?"s":""]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Oe,{variant:P.isActive?"default":"secondary",children:P.isActive?"Active":"Inactive"}),P.autoApproval&&e.jsx(Oe,{variant:"outline",children:"Auto-approval"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-4",children:[e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(ln,{className:"h-4 w-4 mr-2"}),"Edit"]}),e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(ac,{className:"h-4 w-4 mr-2"}),"Copy"]}),e.jsxs(I,{variant:"outline",size:"sm",className:"text-red-600",children:[e.jsx(hn,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]},P.id))})]})},z=()=>{var Q;return C?e.jsx("div",{className:"flex items-center justify-center h-64",children:"Loading requests..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Approval Requests"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage and process approval requests"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(I,{variant:"outline",children:[e.jsx(Ic,{className:"h-4 w-4 mr-2"}),"Filter"]}),e.jsxs(I,{onClick:()=>p(!0),children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"New Request"]})]})]}),e.jsx(ne,{children:e.jsx(ie,{className:"pt-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"entityType",children:"Entity Type"}),e.jsxs(rt,{value:l.entityType||"all",onValueChange:P=>c({...l,entityType:P==="all"?"":P}),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"All types"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All types"}),e.jsx(W,{value:"journal_entry",children:"Journal Entry"}),e.jsx(W,{value:"invoice",children:"Invoice"}),e.jsx(W,{value:"purchase_order",children:"Purchase Order"}),e.jsx(W,{value:"expense",children:"Expense"}),e.jsx(W,{value:"bill",children:"Bill"}),e.jsx(W,{value:"document",children:"Document"}),e.jsx(W,{value:"recurring_invoice",children:"Recurring Invoice"})]})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"status",children:"Status"}),e.jsxs(rt,{value:l.status||"all",onValueChange:P=>c({...l,status:P==="all"?"":P}),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"All statuses"})}),e.jsxs(at,{children:[e.jsx(W,{value:"all",children:"All statuses"}),e.jsx(W,{value:"pending",children:"Pending"}),e.jsx(W,{value:"approved",children:"Approved"}),e.jsx(W,{value:"rejected",children:"Rejected"}),e.jsx(W,{value:"escalated",children:"Escalated"}),e.jsx(W,{value:"cancelled",children:"Cancelled"})]})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"requestedBy",children:"Requested By"}),e.jsx(ge,{placeholder:"Search by user...",value:l.requestedBy,onChange:P=>c({...l,requestedBy:P.target.value})})]})]})})}),e.jsx("div",{className:"space-y-4",children:(Q=N==null?void 0:N.approvalRequests)==null?void 0:Q.map(P=>e.jsx(ne,{children:e.jsxs(ie,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[M(P.entityType),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[P.entityType.replace("_"," ").toUpperCase()," #",P.entityId.slice(-8)]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Requested by ",P.requestedBy,"  ",new Date(P.requestedAt).toLocaleDateString()]}),P.comments&&e.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:P.comments})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-medium",children:["Step ",P.currentStep," of ",P.totalSteps]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[P.completedSteps," completed"]})]}),e.jsx(Oe,{className:V(P.status),children:P.status}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{variant:"outline",size:"sm",onClick:()=>u(P),children:e.jsx(ir,{className:"h-4 w-4"})}),P.status==="pending"&&e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{},children:e.jsx(bs,{className:"h-4 w-4"})})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground mb-2",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[Math.round(P.completedSteps/P.totalSteps*100),"%"]})]}),e.jsx(No,{value:P.completedSteps/P.totalSteps*100,className:"h-2"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"text-sm font-medium mb-2",children:"Approvers"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:P.approvers.map(q=>{var D;return e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[T(q.status),e.jsx("span",{children:((D=q.user)==null?void 0:D.name)||q.userId})]}),e.jsx(Oe,{variant:"outline",className:"text-xs",children:q.stepName})]},q.id)})})]})]})},P.id))})]})},U=()=>d?e.jsx(ts,{open:!!d,onOpenChange:()=>u(null),children:e.jsxs(ss,{className:"max-w-4xl",children:[e.jsxs(as,{children:[e.jsxs(is,{children:[d.entityType.replace("_"," ").toUpperCase()," #",d.entityId.slice(-8)]}),e.jsx(Ks,{children:"Approval request details and processing"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Status"}),e.jsx(Oe,{className:V(d.status),children:d.status})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Progress"}),e.jsxs("div",{className:"text-sm",children:["Step ",d.currentStep," of ",d.totalSteps]})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Requested By"}),e.jsx("div",{className:"text-sm",children:d.requestedBy})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Requested At"}),e.jsx("div",{className:"text-sm",children:new Date(d.requestedAt).toLocaleString()})]})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Approval Steps"}),e.jsx("div",{className:"space-y-2 mt-2",children:d.approvers.map((Q,P)=>{var q;return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[T(Q.status),e.jsx("span",{className:"font-medium",children:((q=Q.user)==null?void 0:q.name)||Q.userId})]}),e.jsx(Oe,{variant:"outline",children:Q.stepName})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:Q.completedAt?`Completed ${new Date(Q.completedAt).toLocaleString()}`:`Assigned ${new Date(Q.assignedAt).toLocaleString()}`})]},Q.id)})})]}),d.comments&&e.jsxs("div",{children:[e.jsx(B,{children:"Comments"}),e.jsx("div",{className:"mt-2 p-3 bg-muted rounded-lg",children:d.comments})]}),d.status==="pending"&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(I,{onClick:()=>{},className:"bg-green-600 hover:bg-green-700",children:[e.jsx(bs,{className:"h-4 w-4 mr-2"}),"Approve"]}),e.jsxs(I,{variant:"outline",onClick:()=>{},className:"text-red-600 border-red-600 hover:bg-red-50",children:[e.jsx(nc,{className:"h-4 w-4 mr-2"}),"Reject"]}),e.jsxs(I,{variant:"outline",onClick:()=>{},className:"text-orange-600 border-orange-600 hover:bg-orange-50",children:[e.jsx(Is,{className:"h-4 w-4 mr-2"}),"Escalate"]})]})]})]})}):null,oe=()=>h?e.jsx(ts,{open:h,onOpenChange:f,children:e.jsxs(ss,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(as,{children:[e.jsx(is,{children:"Create Approval Workflow"}),e.jsx(Ks,{children:"Define a new approval workflow for business processes"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"workflowName",children:"Workflow Name *"}),e.jsx(ge,{id:"workflowName",value:g.name,onChange:Q=>v({...g,name:Q.target.value}),placeholder:"Enter workflow name"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"entityType",children:"Entity Type *"}),e.jsxs(rt,{value:g.entityType,onValueChange:Q=>v({...g,entityType:Q}),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select entity type"})}),e.jsxs(at,{children:[e.jsx(W,{value:"journal_entry",children:"Journal Entry"}),e.jsx(W,{value:"invoice",children:"Invoice"}),e.jsx(W,{value:"purchase_order",children:"Purchase Order"}),e.jsx(W,{value:"expense",children:"Expense"}),e.jsx(W,{value:"bill",children:"Bill"}),e.jsx(W,{value:"document",children:"Document"}),e.jsx(W,{value:"recurring_invoice",children:"Recurring Invoice"})]})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"entitySubType",children:"Entity Sub Type"}),e.jsx(ge,{id:"entitySubType",value:g.entitySubType,onChange:Q=>v({...g,entitySubType:Q.target.value}),placeholder:"e.g., high_value, recurring"})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"priority",children:"Priority"}),e.jsxs(rt,{value:g.priority,onValueChange:Q=>v({...g,priority:Q}),children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select priority"})}),e.jsxs(at,{children:[e.jsx(W,{value:"low",children:"Low"}),e.jsx(W,{value:"medium",children:"Medium"}),e.jsx(W,{value:"high",children:"High"}),e.jsx(W,{value:"critical",children:"Critical"})]})]})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"description",children:"Description"}),e.jsx(Xs,{id:"description",value:g.description,onChange:Q=>v({...g,description:Q.target.value}),placeholder:"Describe the workflow purpose and when it should be used",rows:3})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ka,{id:"isActive",checked:g.isActive,onCheckedChange:Q=>v({...g,isActive:!!Q})}),e.jsx(B,{htmlFor:"isActive",children:"Active"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ka,{id:"autoApproval",checked:g.autoApproval,onCheckedChange:Q=>v({...g,autoApproval:!!Q})}),e.jsx(B,{htmlFor:"autoApproval",children:"Auto Approval"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(B,{children:"Approval Steps"}),e.jsx(I,{type:"button",variant:"outline",size:"sm",onClick:()=>{const Q={id:`step-${g.steps.length+1}`,name:"",approverType:"role",role:"",approverId:"",isRequired:!0,autoApprove:!1};v({...g,steps:[...g.steps,Q]})},children:"Add Step"})]}),e.jsxs("div",{className:"space-y-4 mt-2",children:[g.steps.map((Q,P)=>e.jsx(ne,{children:e.jsxs(ie,{className:"pt-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{children:"Step Name"}),e.jsx(ge,{value:Q.name||"",onChange:q=>{const D=[...g.steps];D[P]={...D[P],name:q.target.value,id:`step-${P+1}`},v({...g,steps:D})},placeholder:"e.g., Manager Approval"})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Approver Type"}),e.jsxs(rt,{value:Q.approverType||"role",onValueChange:q=>{const D=[...g.steps];D[P]={...D[P],approverType:q},v({...g,steps:D})},children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select approver type"})}),e.jsxs(at,{children:[e.jsx(W,{value:"role",children:"Role"}),e.jsx(W,{value:"user",children:"User"}),e.jsx(W,{value:"department",children:"Department"}),e.jsx(W,{value:"amount_based",children:"Amount Based"})]})]})]}),e.jsxs("div",{children:[e.jsx(B,{children:"Role/User"}),e.jsx(ge,{value:Q.role||Q.approverId||"",onChange:q=>{const D=[...g.steps];Q.approverType==="role"?D[P]={...D[P],role:q.target.value}:D[P]={...D[P],approverId:q.target.value},v({...g,steps:D})},placeholder:"e.g., manager, finance_director"})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ka,{checked:Q.isRequired!==!1,onCheckedChange:q=>{const D=[...g.steps];D[P]={...D[P],isRequired:!!q},v({...g,steps:D})}}),e.jsx(B,{children:"Required"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ka,{checked:Q.autoApprove||!1,onCheckedChange:q=>{const D=[...g.steps];D[P]={...D[P],autoApprove:!!q},v({...g,steps:D})}}),e.jsx(B,{children:"Auto Approve"})]})]}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>{const q=g.steps.filter((D,se)=>se!==P);v({...g,steps:q})},className:"text-red-600",children:e.jsx(hn,{className:"h-4 w-4"})})]})]})},P)),g.steps.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500 border-2 border-dashed border-gray-200 rounded-lg",children:[e.jsx("p",{className:"text-sm",children:"No approval steps added yet."}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:'Click "Add Step" to get started.'})]}),e.jsxs(I,{variant:"outline",onClick:()=>{const Q={id:`step-${g.steps.length+1}`,name:"",approverType:"role",isRequired:!0,order:g.steps.length+1,autoApprove:!1};v({...g,steps:[...g.steps,Q]})},className:"w-full",children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Add Approval Step"]})]})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx(I,{variant:"outline",onClick:()=>f(!1),children:"Cancel"}),e.jsx(I,{onClick:()=>{var P,q,D;if(!n||n.trim()===""){alert("Company ID is not available. Please refresh the page and try again.");return}if(!g.name.trim()){alert("Please enter a workflow name");return}if(g.steps.length===0){alert("Please add at least one approval step");return}for(let se=0;se<g.steps.length;se++){const he=g.steps[se];if(!((P=he.name)!=null&&P.trim())){alert(`Please enter a name for step ${se+1}`);return}if(!he.approverType){alert(`Please select an approver type for step ${se+1}`);return}if(he.approverType==="role"&&!((q=he.role)!=null&&q.trim())){alert(`Please enter a role for step ${se+1}`);return}if(he.approverType==="user"&&!((D=he.approverId)!=null&&D.trim())){alert(`Please enter an approver ID for step ${se+1}`);return}}const Q={...g,companyId:n,steps:g.steps.map((se,he)=>({...se,id:se.id||`step-${he+1}`,order:he+1,isRequired:se.isRequired!==!1,autoApprove:se.autoApprove||!1}))};console.log(" Frontend - Workflow data being sent:",Q),console.log(" Frontend - Company ID:",n),console.log(" Frontend - Company ID type:",typeof n),console.log(" Frontend - Company ID length:",n==null?void 0:n.length),A.mutate(Q)},disabled:!n||n.trim()===""||!g.name||g.steps.length===0||A.isPending,children:A.isPending?"Creating...":"Create Workflow"})]})]})]})}):null;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Approval Hub"}),e.jsx("p",{className:"text-muted-foreground",children:"Centralized approval management for all business processes"}),n&&e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Company: ",n]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(I,{variant:"outline",children:[e.jsx(An,{className:"h-4 w-4 mr-2"}),"Export"]}),e.jsxs(I,{variant:"outline",children:[e.jsx(Pl,{className:"h-4 w-4 mr-2"}),"Import"]}),e.jsxs(I,{variant:"outline",children:[e.jsx(en,{className:"h-4 w-4 mr-2"}),"Settings"]})]})]}),e.jsxs(an,{value:i,onValueChange:o,children:[e.jsxs(on,{children:[e.jsxs(vt,{value:"dashboard",children:[e.jsx(lr,{className:"h-4 w-4 mr-2"}),"Dashboard"]}),e.jsxs(vt,{value:"workflows",children:[e.jsx(en,{className:"h-4 w-4 mr-2"}),"Workflows"]}),e.jsxs(vt,{value:"requests",children:[e.jsx(Zt,{className:"h-4 w-4 mr-2"}),"Requests"]})]}),e.jsx(yt,{value:"dashboard",children:L()}),e.jsx(yt,{value:"workflows",children:J()}),e.jsx(yt,{value:"requests",children:z()})]}),U(),oe()]})}function b7e(){return e.jsx(j7e,{})}function N7e(){var u,h,f,m;const{user:s}=Ua(),[t,r]=x.useState("30d"),{data:n,isLoading:a}=ys({queryKey:["supplier-stats",s==null?void 0:s.id,t],queryFn:()=>de.getSupplierStats((s==null?void 0:s.id)||""),enabled:!!(s!=null&&s.id)}),{data:i,isLoading:o}=ys({queryKey:["supplier-activity",s==null?void 0:s.id],queryFn:async()=>{const[p,g]=await Promise.all([de.getSupplierInvoices((s==null?void 0:s.id)||"",{pageSize:5}),de.getSupplierPayments((s==null?void 0:s.id)||"",{pageSize:5})]);return[...p.map(y=>({id:y.id,type:"invoice",title:`Invoice ${y.invoiceNumber}`,amount:y.amount,status:y.status,date:y.invoiceDate,description:y.description})),...g.map(y=>({id:y.id,type:"payment",title:`Payment ${y.paymentNumber}`,amount:y.amount,status:y.status,date:y.paymentDate,description:`Payment for invoice ${y.invoiceNumber}`}))].sort((y,j)=>new Date(j.date).getTime()-new Date(y.date).getTime()).slice(0,10)},enabled:!!(s!=null&&s.id)}),l=p=>{switch(p){case"paid":case"completed":return"bg-green-100 text-green-800";case"sent":case"pending":return"bg-blue-100 text-blue-800";case"overdue":case"failed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},c=p=>{switch(p){case"paid":case"completed":return e.jsx(bs,{className:"h-4 w-4"});case"overdue":case"failed":return e.jsx(Ln,{className:"h-4 w-4"});case"pending":return e.jsx(Cr,{className:"h-4 w-4"});default:return e.jsx(Cr,{className:"h-4 w-4"})}},d=p=>{switch(p){case"up":return e.jsx(Lu,{className:"h-4 w-4 text-green-600"});case"down":return e.jsx(Gh,{className:"h-4 w-4 text-red-600"});default:return e.jsx($s,{className:"h-4 w-4 text-gray-600"})}};return a?e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((p,g)=>e.jsx(ne,{children:e.jsxs(we,{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/2"})]})},g))})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),e.jsx("p",{className:"text-gray-600",children:"Welcome back! Here's what's happening with your account."})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("select",{value:t,onChange:p=>r(p.target.value),className:"px-3 py-2 border border-gray-300 rounded-md text-sm",children:[e.jsx("option",{value:"7d",children:"Last 7 days"}),e.jsx("option",{value:"30d",children:"Last 30 days"}),e.jsx("option",{value:"90d",children:"Last 90 days"}),e.jsx("option",{value:"1y",children:"Last year"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Total Invoices"}),e.jsx(Zt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(n==null?void 0:n.totalInvoices)||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",((u=n==null?void 0:n.totalAmount)==null?void 0:u.toLocaleString())||"0"]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Paid Invoices"}),e.jsx(bs,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:(n==null?void 0:n.paidInvoices)||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",((h=n==null?void 0:n.paidAmount)==null?void 0:h.toLocaleString())||"0"]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Pending Invoices"}),e.jsx(Cr,{className:"h-4 w-4 text-yellow-600"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:(n==null?void 0:n.pendingInvoices)||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",((f=n==null?void 0:n.pendingAmount)==null?void 0:f.toLocaleString())||"0"]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Overdue Invoices"}),e.jsx(Ln,{className:"h-4 w-4 text-red-600"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:(n==null?void 0:n.overdueInvoices)||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",((m=n==null?void 0:n.overdueAmount)==null?void 0:m.toLocaleString())||"0"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Recent Activity"}),e.jsx(Vt,{children:"Your latest invoices and payments"})]}),e.jsx(ie,{children:o?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((p,g)=>e.jsx("div",{className:"animate-pulse",children:e.jsx("div",{className:"h-16 bg-gray-200 rounded"})},g))}):i&&i.length>0?e.jsx("div",{className:"space-y-4",children:i.map(p=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`p-2 rounded-full ${p.type==="invoice"?"bg-blue-100":"bg-green-100"}`,children:p.type==="invoice"?e.jsx(Zt,{className:"h-4 w-4 text-blue-600"}):e.jsx($a,{className:"h-4 w-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:p.title}),e.jsx("p",{className:"text-sm text-gray-500",children:p.description}),e.jsx("p",{className:"text-xs text-gray-400",children:new Date(p.date).toLocaleDateString()})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-semibold",children:["$",p.amount.toLocaleString()]}),e.jsxs(Oe,{className:l(p.status),children:[c(p.status),e.jsx("span",{className:"ml-1 capitalize",children:p.status})]})]})]},p.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Zt,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Recent Activity"}),e.jsx("p",{className:"text-gray-500",children:"Your recent invoices and payments will appear here."})]})})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Payment Performance"}),e.jsx(Vt,{children:"Your payment statistics"})]}),e.jsxs(ie,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Average Payment Days"}),e.jsxs("span",{className:"font-semibold",children:[(n==null?void 0:n.averagePaymentDays)||0," days"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Last Payment"}),e.jsx("span",{className:"font-semibold",children:n!=null&&n.lastPaymentDate?new Date(n.lastPaymentDate).toLocaleDateString():"N/A"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Next Expected"}),e.jsx("span",{className:"font-semibold",children:n!=null&&n.nextPaymentDate?new Date(n.nextPaymentDate).toLocaleDateString():"N/A"})]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Quick Actions"}),e.jsx(Vt,{children:"Common tasks and shortcuts"})]}),e.jsxs(ie,{className:"space-y-2",children:[e.jsxs(I,{variant:"outline",className:"w-full justify-start",children:[e.jsx(Zt,{className:"mr-2 h-4 w-4"}),"View All Invoices"]}),e.jsxs(I,{variant:"outline",className:"w-full justify-start",children:[e.jsx($a,{className:"mr-2 h-4 w-4"}),"View Payment History"]}),e.jsxs(I,{variant:"outline",className:"w-full justify-start",children:[e.jsx(An,{className:"mr-2 h-4 w-4"}),"Download Reports"]}),e.jsxs(I,{variant:"outline",className:"w-full justify-start",children:[e.jsx(vn,{className:"mr-2 h-4 w-4"}),"Update Profile"]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Payment Trend"}),e.jsx(Vt,{children:"This month vs last month"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[d((n==null?void 0:n.paymentTrend)||"stable"),e.jsx("span",{className:"text-2xl font-bold",children:n!=null&&n.monthlyGrowth?`+${n.monthlyGrowth}%`:"0%"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"vs last month"}),e.jsx("p",{className:"text-xs text-gray-500",children:(n==null?void 0:n.paymentTrend)==="up"?"Improving":(n==null?void 0:n.paymentTrend)==="down"?"Declining":"Stable"})]})]})})]})]})]})]})}function w7e(){const{user:s,isAuthenticated:t}=Ua(),[r,n]=x.useState("dashboard"),[a,i]=x.useState(!1),[o,l]=x.useState({}),{data:c,isLoading:d,refetch:u}=ys({queryKey:["supplier-profile",s==null?void 0:s.id],queryFn:()=>de.getSupplierProfile((s==null?void 0:s.id)||""),enabled:!!(s!=null&&s.id)&&t}),{data:h,isLoading:f}=ys({queryKey:["supplier-stats",s==null?void 0:s.id],queryFn:()=>de.getSupplierStats((s==null?void 0:s.id)||""),enabled:!!(s!=null&&s.id)&&t}),{data:m,isLoading:p}=ys({queryKey:["supplier-invoices",s==null?void 0:s.id],queryFn:()=>de.getSupplierInvoices((s==null?void 0:s.id)||""),enabled:!!(s!=null&&s.id)&&t}),{data:g,isLoading:v}=ys({queryKey:["supplier-payments",s==null?void 0:s.id],queryFn:()=>de.getSupplierPayments((s==null?void 0:s.id)||""),enabled:!!(s!=null&&s.id)&&t});x.useEffect(()=>{c&&l(c)},[c]);const y=async()=>{try{await de.updateSupplierProfile((s==null?void 0:s.id)||"",o),i(!1),u()}catch(w){console.error("Failed to update profile:",w)}},j=w=>{switch(w){case"paid":return"bg-green-100 text-green-800";case"sent":return"bg-blue-100 text-blue-800";case"overdue":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-green-100 text-green-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},b=w=>{switch(w){case"paid":case"completed":return e.jsx(bs,{className:"h-4 w-4"});case"overdue":case"failed":return e.jsx(Ln,{className:"h-4 w-4"});case"pending":return e.jsx(Cr,{className:"h-4 w-4"});default:return e.jsx(Cr,{className:"h-4 w-4"})}};return t?e.jsx(Kr,{title:"Supplier Portal",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold",children:["Welcome back, ",(c==null?void 0:c.name)||"Supplier"]}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your invoices, payments, and account information"})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(Oe,{variant:c!=null&&c.isActive?"default":"secondary",children:c!=null&&c.isActive?"Active":"Inactive"})})]}),h&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Total Invoices"}),e.jsx(Zt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold",children:h.totalInvoices}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",h.totalAmount.toLocaleString()]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Paid Invoices"}),e.jsx(bs,{className:"h-4 w-4 text-green-600"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:h.paidInvoices}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",h.paidAmount.toLocaleString()]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Pending Invoices"}),e.jsx(Cr,{className:"h-4 w-4 text-yellow-600"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:h.pendingInvoices}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",h.pendingAmount.toLocaleString()]})]})]}),e.jsxs(ne,{children:[e.jsxs(we,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(Se,{className:"text-sm font-medium",children:"Overdue Invoices"}),e.jsx(Ln,{className:"h-4 w-4 text-red-600"})]}),e.jsxs(ie,{children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:h.overdueInvoices}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",h.overdueAmount.toLocaleString()]})]})]})]}),e.jsxs(an,{value:r,onValueChange:n,className:"space-y-6",children:[e.jsxs(on,{className:"grid w-full grid-cols-4",children:[e.jsx(vt,{value:"dashboard",children:"Dashboard"}),e.jsx(vt,{value:"invoices",children:"Invoices"}),e.jsx(vt,{value:"payments",children:"Payments"}),e.jsx(vt,{value:"profile",children:"Profile"})]}),e.jsx(yt,{value:"dashboard",className:"space-y-6",children:e.jsx(N7e,{})}),e.jsx(yt,{value:"invoices",className:"space-y-6",children:e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Invoice Management"}),e.jsx(Vt,{children:"View and manage all your invoices"})]}),e.jsx(ie,{children:p?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((w,N)=>e.jsx("div",{className:"animate-pulse",children:e.jsx("div",{className:"h-20 bg-gray-200 rounded"})},N))}):m&&m.length>0?e.jsx("div",{className:"space-y-4",children:m.map(w=>e.jsx("div",{className:"border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:w.invoiceNumber}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[w.companyName,"  ",new Date(w.invoiceDate).toLocaleDateString()]})]}),e.jsxs(Oe,{className:j(w.status),children:[b(w.status),e.jsx("span",{className:"ml-1 capitalize",children:w.status})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:w.description}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["Due: ",new Date(w.dueDate).toLocaleDateString()]}),e.jsxs("span",{children:["Terms: ",w.paymentTerms]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",w.amount.toLocaleString()]}),e.jsxs("div",{className:"flex space-x-2 mt-2",children:[e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(ir,{className:"h-4 w-4 mr-1"}),"View"]}),e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(An,{className:"h-4 w-4 mr-1"}),"Download"]})]})]})]})},w.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Zt,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Invoices Found"}),e.jsx("p",{className:"text-muted-foreground",children:"You don't have any invoices yet. Invoices will appear here once they're created."})]})})]})}),e.jsx(yt,{value:"payments",className:"space-y-6",children:e.jsxs(ne,{children:[e.jsxs(we,{children:[e.jsx(Se,{children:"Payment History"}),e.jsx(Vt,{children:"Track all your payments and their status"})]}),e.jsx(ie,{children:v?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((w,N)=>e.jsx("div",{className:"animate-pulse",children:e.jsx("div",{className:"h-20 bg-gray-200 rounded"})},N))}):g&&g.length>0?e.jsx("div",{className:"space-y-4",children:g.map(w=>e.jsx("div",{className:"border rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:w.paymentNumber}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Invoice: ",w.invoiceNumber,"  ",new Date(w.paymentDate).toLocaleDateString()]})]}),e.jsxs(Oe,{className:j(w.status),children:[b(w.status),e.jsx("span",{className:"ml-1 capitalize",children:w.status})]})]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Method: ",w.method.replace("_"," ").toUpperCase()]}),w.notes&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Notes: ",w.notes]}),w.reference&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Reference: ",w.reference]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold",children:["$",w.amount.toLocaleString()]}),e.jsx("div",{className:"flex space-x-2 mt-2",children:e.jsxs(I,{variant:"outline",size:"sm",children:[e.jsx(ir,{className:"h-4 w-4 mr-1"}),"View Details"]})})]})]})},w.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx($a,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Payments Found"}),e.jsx("p",{className:"text-muted-foreground",children:"You don't have any payments yet. Payments will appear here once they're processed."})]})})]})}),e.jsx(yt,{value:"profile",className:"space-y-6",children:e.jsxs(ne,{children:[e.jsx(we,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(Se,{children:"Company Profile"}),e.jsx(Vt,{children:"Manage your company information and settings"})]}),e.jsx(I,{variant:a?"outline":"default",onClick:()=>{a?(l(c||{}),i(!1)):i(!0)},children:a?e.jsxs(e.Fragment,{children:[e.jsx(ma,{className:"h-4 w-4 mr-2"}),"Cancel"]}):e.jsxs(e.Fragment,{children:[e.jsx(ln,{className:"h-4 w-4 mr-2"}),"Edit Profile"]})})]})}),e.jsxs(ie,{children:[d?e.jsx("div",{className:"space-y-4",children:[...Array(8)].map((w,N)=>e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-2"}),e.jsx("div",{className:"h-10 bg-gray-200 rounded"})]},N))}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"name",children:"Company Name"}),e.jsx(ge,{id:"name",value:o.name||"",onChange:w=>l({...o,name:w.target.value}),disabled:!a})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"email",children:"Email"}),e.jsx(ge,{id:"email",type:"email",value:o.email||"",onChange:w=>l({...o,email:w.target.value}),disabled:!a})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"phone",children:"Phone"}),e.jsx(ge,{id:"phone",value:o.phone||"",onChange:w=>l({...o,phone:w.target.value}),disabled:!a})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"website",children:"Website"}),e.jsx(ge,{id:"website",value:o.website||"",onChange:w=>l({...o,website:w.target.value}),disabled:!a})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"taxId",children:"Tax ID"}),e.jsx(ge,{id:"taxId",value:o.taxId||"",onChange:w=>l({...o,taxId:w.target.value}),disabled:!a})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"address",children:"Address"}),e.jsx(Xs,{id:"address",value:o.address||"",onChange:w=>l({...o,address:w.target.value}),disabled:!a})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"city",children:"City"}),e.jsx(ge,{id:"city",value:o.city||"",onChange:w=>l({...o,city:w.target.value}),disabled:!a})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"state",children:"State"}),e.jsx(ge,{id:"state",value:o.state||"",onChange:w=>l({...o,state:w.target.value}),disabled:!a})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(B,{htmlFor:"postalCode",children:"Postal Code"}),e.jsx(ge,{id:"postalCode",value:o.postalCode||"",onChange:w=>l({...o,postalCode:w.target.value}),disabled:!a})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"country",children:"Country"}),e.jsx(ge,{id:"country",value:o.country||"",onChange:w=>l({...o,country:w.target.value}),disabled:!a})]})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"contactPerson",children:"Contact Person"}),e.jsx(ge,{id:"contactPerson",value:o.contactPerson||"",onChange:w=>l({...o,contactPerson:w.target.value}),disabled:!a})]}),e.jsxs("div",{children:[e.jsx(B,{htmlFor:"paymentTerms",children:"Payment Terms"}),e.jsxs(rt,{value:o.paymentTerms||"",onValueChange:w=>l({...o,paymentTerms:w}),disabled:!a,children:[e.jsx(nt,{children:e.jsx(it,{placeholder:"Select payment terms"})}),e.jsxs(at,{children:[e.jsx(W,{value:"net_15",children:"Net 15"}),e.jsx(W,{value:"net_30",children:"Net 30"}),e.jsx(W,{value:"net_45",children:"Net 45"}),e.jsx(W,{value:"net_60",children:"Net 60"}),e.jsx(W,{value:"due_on_receipt",children:"Due on Receipt"})]})]})]})]})]}),a&&e.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[e.jsx(I,{variant:"outline",onClick:()=>i(!1),children:"Cancel"}),e.jsxs(I,{onClick:y,children:[e.jsx(Od,{className:"h-4 w-4 mr-2"}),"Save Changes"]})]})]})]})})]})]})}):e.jsx(Kr,{title:"Supplier Portal",children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx(ne,{className:"w-full max-w-md",children:e.jsxs(we,{children:[e.jsx(Se,{className:"text-center",children:"Access Denied"}),e.jsx(Vt,{className:"text-center",children:"Please log in to access the supplier portal."})]})})})})}const S7e=uh({email:Tr().email("Please enter a valid email address"),password:Tr().min(6,"Password must be at least 6 characters")}),C7e=uh({username:Tr().trim().min(1,"Username is required"),role:dy(["admin","accountant","auditor","employee"])});function A7e(){console.log(" LoginForm: Component rendering...");const[s,t]=x.useState(!1),[r,n]=x.useState(!1),[a,i]=x.useState(""),[o,l]=x.useState(!1),{login:c,loginWithDemo:d}=Ua(),u=id(),{register:h,handleSubmit:f,formState:{errors:m}}=xm({resolver:pm(S7e)}),{register:p,handleSubmit:g,formState:{errors:v}}=xm({resolver:pm(C7e),defaultValues:{username:"",role:"admin"},mode:"onSubmit",reValidateMode:"onChange"}),y=async b=>{console.log(" LoginForm: Form submitted with data:",b),console.log(" LoginForm: Preventing default form submission..."),n(!0),i("");try{console.log(" LoginForm: Starting login process..."),await c(b.email,b.password),console.log(" LoginForm: Login successful, redirecting to dashboard..."),u("/dashboard")}catch(w){console.error(" LoginForm: Login failed:",w),i(w.message||"Invalid email or password. Please try again.")}finally{n(!1)}},j=async b=>{n(!0),i("");try{const w=b.username.trim();await d(w,[b.role]),u("/dashboard")}catch(w){i(w.message||"Demo login failed. Please try again.")}finally{n(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-cyan-50 to-blue-50 p-4",children:e.jsxs(ne,{className:"w-full max-w-md",children:[e.jsxs(we,{className:"text-center space-y-2",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-primary rounded-xl flex items-center justify-center",children:e.jsx(sa,{className:"w-6 h-6 text-primary-foreground"})}),e.jsx(Se,{className:"text-2xl font-bold",children:"Welcome to UrutiIQ"}),e.jsx(Vt,{children:"Sign in to your account to continue"})]}),e.jsxs(ie,{className:"space-y-4",children:[a&&e.jsx(ua,{variant:"destructive",children:e.jsx(ha,{children:a})}),o?e.jsxs("form",{onSubmit:g(j),className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"username",children:"Username"}),e.jsxs("div",{className:"relative",children:[e.jsx(bo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(ge,{id:"username",type:"text",autoComplete:"off",spellCheck:!1,placeholder:"Enter username (e.g., demo_user)",className:"pl-10",...p("username"),disabled:r})]}),v.username&&e.jsx("p",{className:"text-sm text-destructive",children:v.username.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"role",children:"Role"}),e.jsxs("div",{className:"relative",children:[e.jsx(Lf,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsxs("select",{...p("role"),className:"w-full px-3 py-2 border border-input rounded-md bg-background",disabled:r,children:[e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"accountant",children:"Accountant"}),e.jsx("option",{value:"auditor",children:"Auditor"}),e.jsx("option",{value:"employee",children:"Employee"})]})]}),v.role&&e.jsx("p",{className:"text-sm text-destructive",children:v.role.message})]}),e.jsx(I,{type:"submit",className:"w-full",disabled:r,children:r?"Signing in...":"Sign in with Demo"}),e.jsx("div",{className:"text-center",children:e.jsx("button",{type:"button",onClick:()=>l(!1),className:"text-sm text-primary hover:underline",children:"Back to regular login"})})]}):e.jsxs("form",{onSubmit:b=>{console.log(" LoginForm: Form onSubmit event triggered"),b.preventDefault(),console.log(" LoginForm: Default form submission prevented"),f(y)(b)},className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"email",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(Dd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(ge,{id:"email",type:"email",placeholder:"Enter your email",className:"pl-10",...h("email"),disabled:r})]}),m.email&&e.jsx("p",{className:"text-sm text-destructive",children:m.email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(wm,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(ge,{id:"password",type:s?"text":"password",placeholder:"Enter your password",className:"pl-10 pr-10",...h("password"),disabled:r}),e.jsx("button",{type:"button",onClick:()=>t(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground",disabled:r,children:s?e.jsx(bp,{className:"w-4 h-4"}):e.jsx(ir,{className:"w-4 h-4"})})]}),m.password&&e.jsx("p",{className:"text-sm text-destructive",children:m.password.message})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx(yp,{to:"/auth/forgot-password",className:"text-sm text-primary hover:underline",children:"Forgot password?"})}),e.jsx(I,{type:"submit",className:"w-full",disabled:r,children:r?"Signing in...":"Sign in"}),e.jsx("div",{className:"text-center",children:e.jsx("button",{type:"button",onClick:()=>l(!0),className:"text-sm text-primary hover:underline",children:"Try demo login instead"})})]}),e.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:["Don't have an account?"," ",e.jsx(yp,{to:"/register",className:"text-primary hover:underline",children:"Sign up"})]})]})]})})}function E7e(){return e.jsx(A7e,{})}const I7e=uh({firstName:Tr().min(2,"First name must be at least 2 characters"),lastName:Tr().min(2,"Last name must be at least 2 characters"),email:Tr().email("Please enter a valid email address"),companyName:Tr().min(2,"Company name must be at least 2 characters"),phone:Tr().min(10,"Please enter a valid phone number"),password:Tr().min(8,"Password must be at least 8 characters"),confirmPassword:Tr()}).refine(s=>s.password===s.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});function P7e(){const[s,t]=x.useState(!1),[r,n]=x.useState(!1),[a,i]=x.useState(!1),[o,l]=x.useState(""),[c,d]=x.useState(""),u=id(),{register:h,handleSubmit:f,formState:{errors:m},reset:p}=xm({resolver:pm(I7e)}),g=async v=>{var y;i(!0),l(""),d("");try{const j=`${v.firstName} ${v.lastName}`.trim(),b=await de.register({email:v.email,password:v.password,name:j,role:"admin",companyName:v.companyName});if(b.error)throw new Error(((y=b.error)==null?void 0:y.message)||"Registration failed");if(b.companyId)try{localStorage.setItem("company_id",b.companyId),localStorage.setItem("company_name",b.companyName||v.companyName)}catch{}if(b.tenantId)try{localStorage.setItem("tenant_id",b.tenantId)}catch{}d("Account created successfully! You can now sign in."),p(),setTimeout(()=>u("/login"),800)}catch(j){l(j.message||"Failed to create account. Please try again.")}finally{i(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-cyan-50 to-blue-50 p-4",children:e.jsxs(ne,{className:"w-full max-w-lg",children:[e.jsxs(we,{className:"text-center space-y-2",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-primary rounded-xl flex items-center justify-center",children:e.jsx(sa,{className:"w-6 h-6 text-primary-foreground"})}),e.jsx(Se,{className:"text-2xl font-bold",children:"Create your account"}),e.jsx(Vt,{children:"Join UrutiIQ and start managing your accounting with AI"})]}),e.jsxs(ie,{className:"space-y-4",children:[o&&e.jsx(ua,{variant:"destructive",children:e.jsx(ha,{children:o})}),c&&e.jsx(ua,{children:e.jsx(ha,{children:c})}),e.jsxs("form",{onSubmit:f(g),className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"firstName",children:"First Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(bo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(ge,{id:"firstName",placeholder:"John",className:"pl-10",...h("firstName"),disabled:a})]}),m.firstName&&e.jsx("p",{className:"text-sm text-destructive",children:m.firstName.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"lastName",children:"Last Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(bo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(ge,{id:"lastName",placeholder:"Doe",className:"pl-10",...h("lastName"),disabled:a})]}),m.lastName&&e.jsx("p",{className:"text-sm text-destructive",children:m.lastName.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"email",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(Dd,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(ge,{id:"email",type:"email",placeholder:"john@company.com",className:"pl-10",...h("email"),disabled:a})]}),m.email&&e.jsx("p",{className:"text-sm text-destructive",children:m.email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"companyName",children:"Company Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(vn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(ge,{id:"companyName",placeholder:"Acme Corporation",className:"pl-10",...h("companyName"),disabled:a})]}),m.companyName&&e.jsx("p",{className:"text-sm text-destructive",children:m.companyName.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"phone",children:"Phone Number"}),e.jsxs("div",{className:"relative",children:[e.jsx(r1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(ge,{id:"phone",type:"tel",placeholder:"+1 (555) 123-4567",className:"pl-10",...h("phone"),disabled:a})]}),m.phone&&e.jsx("p",{className:"text-sm text-destructive",children:m.phone.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(wm,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(ge,{id:"password",type:s?"text":"password",placeholder:"Create a strong password",className:"pl-10 pr-10",...h("password"),disabled:a}),e.jsx("button",{type:"button",onClick:()=>t(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground",disabled:a,children:s?e.jsx(bp,{className:"w-4 h-4"}):e.jsx(ir,{className:"w-4 h-4"})})]}),m.password&&e.jsx("p",{className:"text-sm text-destructive",children:m.password.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(B,{htmlFor:"confirmPassword",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(wm,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(ge,{id:"confirmPassword",type:r?"text":"password",placeholder:"Confirm your password",className:"pl-10 pr-10",...h("confirmPassword"),disabled:a}),e.jsx("button",{type:"button",onClick:()=>n(!r),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground",disabled:a,children:r?e.jsx(bp,{className:"w-4 h-4"}):e.jsx(ir,{className:"w-4 h-4"})})]}),m.confirmPassword&&e.jsx("p",{className:"text-sm text-destructive",children:m.confirmPassword.message})]}),e.jsx(I,{type:"submit",className:"w-full",disabled:a,children:a?"Creating account...":"Create account"})]}),e.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:["Already have an account?"," ",e.jsx(yp,{to:"/login",className:"text-primary hover:underline",children:"Sign in"})]})]})]})})}function _7e(){return e.jsx(P7e,{})}function k7e(){const s=id();return e.jsx("div",{className:"min-h-[60vh] flex items-center justify-center p-6",children:e.jsxs(ne,{className:"max-w-md w-full",children:[e.jsx(we,{children:e.jsx(Se,{children:"Unauthorized"})}),e.jsxs(ie,{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"You dont have permission to access this page. If you believe this is a mistake, contact an administrator."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{onClick:()=>s(-1),variant:"outline",children:"Go Back"}),e.jsx(I,{onClick:()=>s("/dashboard"),children:"Go to Dashboard"})]})]})]})})}function T7e(){return e.jsx(QG,{children:e.jsx(JG,{children:e.jsxs(XG,{children:[e.jsxs(XH,{children:[e.jsx(Qr,{path:"/login",element:e.jsx(E7e,{})}),e.jsx(Qr,{path:"/register",element:e.jsx(_7e,{})}),e.jsx(Qr,{path:"/unauthorized",element:e.jsx(k7e,{})}),e.jsx(Qr,{path:"/",element:e.jsx(aZ,{})}),e.jsx(Qr,{path:"/reports",element:e.jsx(zI,{to:"/dashboard/reports",replace:!0})}),e.jsx(Qr,{path:"/documents",element:e.jsx(zI,{to:"/dashboard/documents",replace:!0})}),e.jsxs(Qr,{path:"/dashboard",element:e.jsx(nZ,{}),children:[e.jsx(Qr,{index:!0,element:e.jsx(Pee,{})}),e.jsx(Qr,{path:"accounting",element:e.jsx(ose,{})}),e.jsx(Qr,{path:"sales",element:e.jsx(Die,{})}),e.jsx(Qr,{path:"pos",element:e.jsx(u7e,{})}),e.jsx(Qr,{path:"journal-hub",element:e.jsx(y7e,{})}),e.jsx(Qr,{path:"approval-hub",element:e.jsx(b7e,{})}),e.jsx(Qr,{path:"supplier-portal",element:e.jsx(w7e,{})}),e.jsx(Qr,{path:"expenses",element:e.jsx(bce,{})}),e.jsx(Qr,{path:"purchase-orders",element:e.jsx(wce,{})}),e.jsx(Qr,{path:"accounts-payable",element:e.jsx(Sce,{})}),e.jsx(Qr,{path:"enhanced-accounts-payable",element:e.jsx(Lce,{})}),e.jsx(Qr,{path:"banking",element:e.jsx(Wce,{})}),e.jsx(Qr,{path:"inventory",element:e.jsx(Z8e,{})}),e.jsx(Qr,{path:"reports",element:e.jsx(rR,{})}),e.jsx(Qr,{path:"settings",element:e.jsx(yFe,{})}),e.jsx(Qr,{path:"ai-insights",element:e.jsx(wFe,{})}),e.jsx(Qr,{path:"enhanced-transaction-processing",element:e.jsx(CFe,{})}),e.jsx(Qr,{path:"enhanced-journal-management",element:e.jsx(eMe,{})}),e.jsx(Qr,{path:"credit-notes",element:e.jsx(sMe,{})}),e.jsx(Qr,{path:"period-close",element:e.jsx(rMe,{})}),e.jsx(Qr,{path:"revenue-recognition",element:e.jsx(nMe,{})}),e.jsx(Qr,{path:"fixed-assets",element:e.jsx(gMe,{})}),e.jsx(Qr,{path:"llama-ai",element:e.jsx(yMe,{})}),e.jsx(Qr,{path:"tax",element:e.jsx(jMe,{})}),e.jsx(Qr,{path:"tax-calculation",element:e.jsx(bMe,{})}),e.jsx(Qr,{path:"clients",element:e.jsx(NMe,{})}),e.jsx(Qr,{path:"companies",element:e.jsx(SMe,{})}),e.jsx(Qr,{path:"security",element:e.jsx(wMe,{})}),e.jsx(Qr,{path:"help",element:e.jsx(pR,{})}),e.jsx(Qr,{path:"help-support",element:e.jsx(pR,{})}),e.jsx(Qr,{path:"financial-reports",element:e.jsx(gR,{})}),e.jsx(Qr,{path:"financial-reporting",element:e.jsx(gR,{})}),e.jsx(Qr,{path:"budget-management",element:e.jsx(l7e,{})}),e.jsx(Qr,{path:"documents",element:e.jsx(d7e,{})}),e.jsx(Qr,{path:"journal/new",element:e.jsx(o7e,{})}),e.jsx(Qr,{path:"custom-report-builder",element:e.jsx(rR,{})})]})]}),e.jsx(gM,{}),e.jsx(GJ,{position:"top-right"})]})})})}VS.createRoot(document.getElementById("root")).render(e.jsx(xe.StrictMode,{children:e.jsx(VG,{children:e.jsx(aG,{children:e.jsx(WG,{children:e.jsx(T7e,{})})})})}));export{Na as _};
//# sourceMappingURL=index-C4GLRyXc.js.map
